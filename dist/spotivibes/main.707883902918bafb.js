(self.webpackChunkspotivibes=self.webpackChunkspotivibes||[]).push([[179],{89:(tn,Qt,dt)=>{"use strict";var _t=dt(95),mt=dt(703),Ge="value",m="\n  ",re={};function Je(Bt){var Se=Array.isArray(Bt);return function(rt){var He=Xe(re.plainArray,rt);if(He)return He;if(Se&&rt.length!==Bt.length)return"an array with "+Bt.length+" items";for(var Et=0;Et<rt.length;Et++)if(He=Xe(Se?Bt[Et]:Bt,rt[Et]))return[Et].concat(He)}}function Xe(Bt,Se){if(null!=Se||Bt.hasOwnProperty("__required")){var ht=Bt(Se);if(ht)return Array.isArray(ht)?ht:[ht]}}function Ve(Bt,Se){var ht=Bt.length,Ue=Bt[ht-1],rt=Bt.slice(0,ht-1);return 0===rt.length&&(rt=[Ge]),Se=mt(Se,{path:rt}),"function"==typeof Ue?Ue(Se):Kt(Se,function Ft(Bt){return"must be "+function pn(Bt){return/^an? /.test(Bt)?Bt:/^[aeiou]/i.test(Bt)?"an "+Bt:/^[a-z]/i.test(Bt)?"a "+Bt:Bt}(Bt)+"."}(Ue))}function Kt(Bt,Se){return(rn(Bt.path)?"Item at position ":"")+Bt.path.join(".")+" "+Se}function rn(Bt){return"number"==typeof Bt[Bt.length-1]||"number"==typeof Bt[0]}re.assert=function(Bt,Se){return Se=Se||{},function(ht){var Ue=Xe(Bt,ht);if(Ue){var rt=Ve(Ue,Se);throw Se.apiName&&(rt=Se.apiName+": "+rt),new Error(rt)}}},re.shape=function(Se){var ht=function $t(Bt){return Object.keys(Bt||{}).map(function(Se){return{key:Se,value:Bt[Se]}})}(Se);return function(rt){var He=Xe(re.plainObject,rt);if(He)return He;for(var Et,Ot=[],nn=0;nn<ht.length;nn++)(He=Xe(ht[nn].value,rt[Et=ht[nn].key]))&&Ot.push([Et].concat(He));return Ot.length<2?Ot[0]:function(zn){Ot=Ot.map(function(Bn){return"- "+Bn[0]+": "+Ve(Bn,zn).split("\n").join(m)});var ho=zn.path.join(".");return"The following properties"+(ho===Ge?"":" of "+ho)+" have invalid values:"+m+Ot.join(m)}}},re.strictShape=function(Se){var ht=re.shape(Se);return function(rt){var He=ht(rt);if(He)return He;var Et=Object.keys(rt).reduce(function(bt,Ot){return void 0===Se[Ot]&&bt.push(Ot),bt},[]);return 0!==Et.length?function(){return"The following keys are invalid: "+Et.join(", ")}:void 0}},re.arrayOf=function(Se){return Je(Se)},re.tuple=function(){return Je(Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments))},re.required=function(Se){function ht(Ue){return null==Ue?function(rt){return Kt(rt,rn(rt.path)?"cannot be undefined/null.":"is required.")}:Se.apply(this,arguments)}return ht.__required=!0,ht},re.oneOfType=function(){var Se=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(Ue){var rt=Se.map(function(He){return Xe(He,Ue)}).filter(Boolean);if(rt.length===Se.length)return rt.every(function(He){return 1===He.length&&"string"==typeof He[0]})?function Ye(Bt){return Bt.length<2?Bt[0]:2===Bt.length?Bt.join(" or "):Bt.slice(0,-1).join(", ")+", or "+Bt.slice(-1)}(rt.map(function(He){return He[0]})):rt.reduce(function(He,Et){return Et.length>He.length?Et:He})}},re.equal=function(Se){return function(Ue){if(Ue!==Se)return JSON.stringify(Se)}},re.oneOf=function(){var ht=(Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments)).map(function(Ue){return re.equal(Ue)});return re.oneOfType.apply(this,ht)},re.range=function(Se){var ht=Se[0],Ue=Se[1];return function(He){if(Xe(re.number,He)||He<ht||He>Ue)return"number between "+ht+" & "+Ue+" (inclusive)"}},re.any=function(){},re.boolean=function(Se){if("boolean"!=typeof Se)return"boolean"},re.number=function(Se){if("number"!=typeof Se)return"number"},re.plainArray=function(Se){if(!Array.isArray(Se))return"array"},re.plainObject=function(Se){if(!_t(Se))return"object"},re.string=function(Se){if("string"!=typeof Se)return"string"},re.func=function(Se){if("function"!=typeof Se)return"function"},re.validate=Xe,re.processMessage=Ve,tn.exports=re},95:tn=>{"use strict";var Qt=Object.prototype.toString;tn.exports=function(dt){var _t;return"[object Object]"===Qt.call(dt)&&(null===(_t=Object.getPrototypeOf(dt))||_t===Object.getPrototypeOf({}))}},564:(tn,Qt,dt)=>{"use strict";var _t=dt(652).x0;function mt(Ge){this.origin=Ge.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=Ge.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=Ge,this.send=this.send.bind(this),this.countries=Ge.countries?Ge.countries.split(","):null,this.types=Ge.types?Ge.types.split(","):null,this.bbox=Ge.bbox?Ge.bbox:null,this.language=Ge.language?Ge.language.split(","):null,this.limit=Ge.limit?+Ge.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(Ge),this.eventQueue=new Array,this.flushInterval=Ge.flushInterval||1e3,this.maxQueueSize=Ge.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}mt.prototype={select:function(Ge,m){var re=this.getSelectedIndex(Ge,m),Je=this.getEventPayload("search.select",m);if(Je.resultIndex=re,Je.resultPlaceName=Ge.place_name,Je.resultId=Ge.id,(re!==this.lastSentIndex||Je.queryString!==this.lastSentInput)&&-1!=re&&(this.lastSentIndex=re,this.lastSentInput=Je.queryString,Je.queryString))return this.push(Je)},start:function(Ge){var m=this.getEventPayload("search.start",Ge);if(m.queryString)return this.push(m)},keyevent:function(Ge,m){if(Ge.key&&!Ge.metaKey&&-1===[9,27,37,39,13,38,40].indexOf(Ge.keyCode)){var re=this.getEventPayload("search.keystroke",m);if(re.lastAction=Ge.key,re.queryString)return this.push(re)}},send:function(Ge,m){if(!this.enableEventLogging)return m?m():void 0;var re=this.getRequestOptions(Ge);this.request(re,function(Je){return Je?this.handleError(Je,m):m?m():void 0}.bind(this))},getRequestOptions:function(Ge){return Array.isArray(Ge)||(Ge=[Ge]),{method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(Ge)}},getEventPayload:function(Ge,m){var re;re=m.options.proximity?"object"==typeof m.options.proximity?[m.options.proximity.longitude,m.options.proximity.latitude]:"ip"===m.options.proximity?[999,999]:m.options.proximity:null;var Je=m._map?m._map.getZoom():void 0,Xe={event:Ge,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:m.options.autocomplete,fuzzyMatch:m.options.fuzzyMatch,proximity:re,limit:m.options.limit,routing:m.options.routing,worldview:m.options.worldview,mapZoom:Je,keyboardLocale:this.locale};return Xe.queryString="search.select"===Ge?m.inputString:"search.select"!=Ge&&m._inputEl?m._inputEl.value:m.inputString,Xe},request:function(Ge,m){var re=new XMLHttpRequest;for(var Je in re.onreadystatechange=function(){if(4==this.readyState)return m(204==this.status?null:this.statusText)},re.open(Ge.method,Ge.host+"/"+Ge.path,!0),Ge.headers)re.setRequestHeader(Je,Ge.headers[Je]);re.send(Ge.body)},handleError:function(Ge,m){if(m)return m(Ge)},generateSessionID:function(){return _t()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(Ge,m){if(m._typeahead){var Je=Ge.id;return m._typeahead.data.map(function(Ye){return Ye.id}).indexOf(Je)}},shouldEnableLogging:function(Ge){return!(!1===Ge.enableEventLogging||Ge.origin&&"https://api.mapbox.com"!==Ge.origin||Ge.localGeocoder||Ge.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(Ge,m){this.eventQueue.push(Ge),(this.eventQueue.length>=this.maxQueueSize||m)&&this.flush()},remove:function(){this.flush()}},tn.exports=mt},424:tn=>{tn.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}},569:tn=>{function Qt(){}Qt.prototype={isSupport:function(){return Boolean(window.navigator.geolocation)},getCurrentPosition:function(){const dt={enableHighAccuracy:!0};return new Promise(function(_t,mt){window.navigator.geolocation.getCurrentPosition(_t,mt,dt)})}},tn.exports=Qt},545:(tn,Qt,dt)=>{"use strict";var _t=dt(562),mt=dt(82),Ge=dt(703),m=dt(69).EventEmitter,re=dt(424),Je=dt(471),Xe=dt(75),Ve=dt(564),Ye=dt(234),Ft=dt(775),pn=dt(569),Kt=dt(777);function Bt(Se){this._eventEmitter=new m,this.options=Ge({},this.options,Se),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new pn}Bt.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(Se){return Se.place_name},render:function(Se){var ht=Se.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+ht[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+ht.splice(1,ht.length).join(",")+"</div></div>"}},addTo:function(Se){function ht(Ue,rt){if(!document.body.contains(rt))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const He=Ue.onAdd();rt.appendChild(He)}if(Se._controlContainer)Se.addControl(this);else if(Se instanceof HTMLElement)ht(this,Se);else{if("string"!=typeof Se)throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element");{const Ue=document.querySelectorAll(Se);if(0===Ue.length)throw new Error("Element ",Se,"not found.");if(Ue.length>1)throw new Error("Geocoder can only be added to a single html element");ht(this,Ue[0])}}},onAdd:function(Se){if(Se&&"string"!=typeof Se&&(this._map=Se),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=Xe(Je({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new Ve(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var ht=this.container=document.createElement("div");ht.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var Ue=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",mt(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",function(zn){this.eventManager.keyevent(zn,this)}.bind(this));var rt=document.createElement("div");rt.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var He=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(He),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),rt.appendChild(this._clearEl),rt.appendChild(this._loadingEl),ht.appendChild(Ue),ht.appendChild(this._inputEl),ht.appendChild(rt),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var Et=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(Et),rt.appendChild(this._geolocateEl),this._showGeolocateButton()}var bt=this._typeahead=new _t(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),bt.getItemValue=this.options.getItemValue;var Ot=bt.list.draw,nn=this._footerNode=function $t(){var Se=document.createElement("div");return Se.className="mapboxgl-ctrl-geocoder--powered-by",Se.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',Se}();return bt.list.draw=function(){Ot.call(this),nn.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),nn.addEventListener("mouseup",function(){this.selectingListItem=!1}.bind(this)),this.element.appendChild(nn)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),ht},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then(function(Se){this._hideLoadingIcon();const ht={geometry:{type:"Point",coordinates:[Se.coords.longitude,Se.coords.latitude]}};this._handleMarker(ht),this._fly(ht),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(ht),this._showClearButton(),this.fresh=!1;const Ue={limit:1,language:[this.options.language],query:ht.geometry.coordinates,types:["address"]};this.options.localGeocoderOnly?(this._setInputValue(ht.geometry.coordinates[0]+","+ht.geometry.coordinates[1]),this._eventEmitter.emit("result",{result:ht})):this.geocoderService.reverseGeocode(Ue).send().then(function(rt){const He=rt.body.features[0];if(He){const Et=Kt.transformFeatureToGeolocationText(He,this.options.addressAccuracy);this._setInputValue(Et),He.user_coordinates=ht.geometry.coordinates,this._eventEmitter.emit("result",{result:He})}else this._eventEmitter.emit("result",{result:{user_coordinates:ht.geometry.coordinates}})}.bind(this))}.bind(this)).catch(function(Se){1===Se.code?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}.bind(this))},createIcon:function(Se,ht){var Ue=document.createElementNS("http://www.w3.org/2000/svg","svg");return Ue.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+Se),Ue.setAttribute("viewBox","0 0 18 18"),Ue.setAttribute("xml:space","preserve"),Ue.setAttribute("width",18),Ue.setAttribute("height",18),Ue.innerHTML=ht,Ue},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(Se){this._inputEl.value=Se,setTimeout(function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}.bind(this),1)},_onPaste:function(Se){var ht=(Se.clipboardData||window.clipboardData).getData("text");ht.length>=this.options.minLength&&this._geocode(ht)},_onKeyDown:function(Se){var ht=27,Ue=9;if(Se.keyCode===ht&&this.options.clearAndBlurOnEsc)return this._clear(Se),this._inputEl.blur();var rt=Se.target&&Se.target.shadowRoot?Se.target.shadowRoot.activeElement:Se.target;if(!rt||!rt.value)return this.fresh=!0,Se.keyCode!==Ue&&this.clear(Se),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!Se.metaKey&&-1===[Ue,ht,37,39,13,38,40].indexOf(Se.keyCode)&&rt.value.length>=this.options.minLength&&this._geocode(rt.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(Se){this.options.clearOnBlur&&this._clearOnBlur(Se),this.options.collapsed&&this._collapse()},_onChange:function(){var Se=this._typeahead.selected;Se&&JSON.stringify(Se)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(Se),this.options.marker&&this._mapboxgl&&this._handleMarker(Se),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(Se),this._eventEmitter.emit("result",{result:Se}),this.eventManager.select(Se,this))},_fly:function(Se){var ht;if(Se.properties&&re[Se.properties.short_code])ht=Ge({},this.options.flyTo),this._map&&this._map.fitBounds(re[Se.properties.short_code].bbox,ht);else if(Se.bbox){var Ue=Se.bbox;ht=Ge({},this.options.flyTo),this._map&&this._map.fitBounds([[Ue[0],Ue[1]],[Ue[2],Ue[3]]],ht)}else ht=Ge({},{zoom:this.options.zoom},this.options.flyTo),Se.center?ht.center=Se.center:Se.geometry&&Se.geometry.type&&"Point"===Se.geometry.type&&Se.geometry.coordinates&&(ht.center=Se.geometry.coordinates),this._map&&this._map.flyTo(ht)},_requestType:function(Se,ht){return Se.localGeocoderOnly?1:Se.reverseGeocode&&Kt.REVERSE_GEOCODE_COORD_RGX.test(ht)?2:0},_setupConfig:function(Se,ht){const rt=/[\s,]+/;var He=this,Et=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"].reduce(function(Ot,nn){return null==He.options[nn]||(Ot[nn]=["countries","types","language"].indexOf(nn)>-1?He.options[nn].split(rt):He.options[nn],"proximity"===nn&&"number"==typeof He.options[nn].longitude&&"number"==typeof He.options[nn].latitude&&(Ot[nn]=[He.options[nn].longitude,He.options[nn].latitude])),Ot},{});switch(Se){case 2:var bt=ht.split(rt).map(function(Ot){return parseFloat(Ot,10)});He.options.flipCoordinates||bt.reverse(),Et=Ge(Et,{query:bt,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(Ot){Ot in Et&&delete Et[Ot]});break;case 0:{const Ot=ht.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(Ot)&&(ht=ht.replace(/,/g," ")),Et=Ge(Et,{query:ht})}}return Et},_geocode:function(Se){this.inputString=Se,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:Se});const ht=this._requestType(this.options,Se),Ue=this._setupConfig(ht,Se);var rt;switch(ht){case 1:rt=Promise.resolve();break;case 0:rt=this.geocoderService.forwardGeocode(Ue).send();break;case 2:rt=this.geocoderService.reverseGeocode(Ue).send()}var He=this.options.localGeocoder&&this.options.localGeocoder(Se)||[],Et=[],bt=null;return rt.catch(function(Ot){bt=Ot}.bind(this)).then(function(Ot){this._hideLoadingIcon();var nn={};return Ot?"200"==Ot.statusCode&&((nn=Ot.body).request=Ot.request,nn.headers=Ot.headers):nn={type:"FeatureCollection",features:[]},nn.config=Ue,this.fresh&&(this.eventManager.start(this),this.fresh=!1),nn.features=nn.features?He.concat(nn.features):He,this.options.externalGeocoder?(Et=this.options.externalGeocoder(Se,nn.features)||Promise.resolve([])).then(function(zn){return nn.features=nn.features?zn.concat(nn.features):zn,nn},function(){return nn}):nn}.bind(this)).then(function(Ot){if(bt)throw bt;this.options.filter&&Ot.features.length&&(Ot.features=Ot.features.filter(this.options.filter)),Ot.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",Ot),this._typeahead.update(Ot.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",Ot))}.bind(this)).catch(function(Ot){this._hideLoadingIcon(),this._hideAttribution(),He.length&&this.options.localGeocoder||Et.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(He)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:He}),this._eventEmitter.emit("error",{error:Ot})}.bind(this)),rt},_clear:function(Se){Se&&Se.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(Se){this._clear(Se),this._inputEl.focus()},_clearOnBlur:function(Se){Se.relatedTarget&&this._clear(Se)},_onQueryResult:function(Se){var ht=Se.body;if(ht.features.length){var Ue=ht.features[0];this._typeahead.selected=Ue,this._inputEl.value=Ue.place_name,this._onChange()}},_updateProximity:function(){if(this._map&&this.options.trackProximity)if(this._map.getZoom()>9){var Se=this._map.getCenter().wrap();this.setProximity({longitude:Se.lng,latitude:Se.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(Se){return this._geocode(Se).then(this._onQueryResult),this},_renderError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>")},_renderLocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>")},_renderNoResults:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>")},_renderUserDeniedGeolocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>")},_renderMessage:function(Se){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(Se)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var Se=this.options.language.split(",")[0],ht=Ft.language(Se),Ue=Ye.placeholder[ht];if(Ue)return Ue}return"Search"},setInput:function(Se){return this._inputEl.value=Se,this._typeahead.selected=null,this._typeahead.clear(),Se.length>=this.options.minLength&&this._geocode(Se),this},setProximity:function(Se,ht=!0){return this.options.proximity=Se,ht&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(Se){return Se&&"function"==typeof Se&&(this._typeahead.render=Se),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(Se){var ht=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=Se||this.options.language||ht,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(Se){return this.options.zoom=Se,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(Se){return this.options.flyTo=Se,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(Se){return this.placeholder=Se||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(Se){return this.options.bbox=Se,this},getCountries:function(){return this.options.countries},setCountries:function(Se){return this.options.countries=Se,this},getTypes:function(){return this.options.types},setTypes:function(Se){return this.options.types=Se,this},getMinLength:function(){return this.options.minLength},setMinLength:function(Se){return this.options.minLength=Se,this._typeahead&&(this._typeahead.options.minLength=Se),this},getLimit:function(){return this.options.limit},setLimit:function(Se){return this.options.limit=Se,this._typeahead&&(this._typeahead.options.limit=Se),this},getFilter:function(){return this.options.filter},setFilter:function(Se){return this.options.filter=Se,this},setOrigin:function(Se){return this.options.origin=Se,this.geocoderService=Xe(Je({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(Se){return this.options.accessToken=Se,this.geocoderService=Xe(Je({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(Se){return this.options.autocomplete=Se,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(Se){return this.options.fuzzyMatch=Se,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(Se){return this.options.routing=Se,this},getRouting:function(){return this.options.routing},setWorldview:function(Se){return this.options.worldview=Se,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(Se){if(this._map){this._removeMarker();var Ue=Ge({},{color:"#4668F2"},this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(Ue),Se.center?this.mapMarker.setLngLat(Se.center).addTo(this._map):Se.geometry&&Se.geometry.type&&"Point"===Se.geometry.type&&Se.geometry.coordinates&&this.mapMarker.setLngLat(Se.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(Se,ht){return this._eventEmitter.on(Se,ht),this},off:function(Se,ht){return this._eventEmitter.removeListener(Se,ht),this.eventManager.remove(),this}},tn.exports=Bt},234:tn=>{"use strict";tn.exports={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a"}}},777:tn=>{function dt(mt){const Ge=mt.address||"",m=mt.text||"",re=mt.place_name||"",Xe={address:re.split(",")[0],houseNumber:Ge,street:m,placeName:re};return mt.context.forEach(function(Ve){const Ye=Ve.id.split(".")[0];Xe[Ye]=Ve.text}),Xe}tn.exports={transformFeatureToGeolocationText:function Qt(mt,Ge){const m=dt(mt),re=["address","street","place","country"];if("function"==typeof Ge)return Ge(m);const Xe=re.indexOf(Ge);return(-1===Xe?re:re.slice(Xe)).reduce(function(Ve,Ye){return m[Ye]?(""!==Ve&&(Ve+=", "),Ve+m[Ye]):Ve},"")},getAddressInfo:dt,REVERSE_GEOCODE_COORD_RGX:/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/}},471:(tn,Qt,dt)=>{"use strict";var _t=dt(454);tn.exports=_t},454:(tn,Qt,dt)=>{"use strict";var _t=dt(753),mt=dt(176);function Ge(re){mt.call(this,re)}(Ge.prototype=Object.create(mt.prototype)).constructor=Ge,Ge.prototype.sendRequest=_t.browserSend,Ge.prototype.abortRequest=_t.browserAbort,tn.exports=function m(re){return new Ge(re)}},753:(tn,Qt,dt)=>{"use strict";var _t=dt(332),mt=dt(158),Ge=dt(719),m=dt(829),re={};function Ve(Kt){var rn=Kt.total,$t=Kt.loaded;return{total:rn,transferred:$t,percent:100*$t/rn}}function Ye(Kt,rn){return new Promise(function($t,Bt){rn.onprogress=function(Ue){Kt.emitter.emit(Ge.EVENT_PROGRESS_DOWNLOAD,Ve(Ue))};var Se=Kt.file;Se&&(rn.upload.onprogress=function(Ue){Kt.emitter.emit(Ge.EVENT_PROGRESS_UPLOAD,Ve(Ue))}),rn.onerror=function(Ue){Bt(Ue)},rn.onabort=function(){var Ue=new mt({request:Kt,type:Ge.ERROR_REQUEST_ABORTED});Bt(Ue)},rn.onload=function(){if(delete re[Kt.id],rn.status<200||rn.status>=400){var Ue=new mt({request:Kt,body:rn.response,statusCode:rn.status});Bt(Ue)}else $t(rn)};var ht=Kt.body;"string"==typeof ht?rn.send(ht):ht?rn.send(JSON.stringify(ht)):Se?rn.send(Se):rn.send(),re[Kt.id]=rn}).then(function($t){return function Xe(Kt,rn){return new _t(Kt,{body:rn.response,headers:m(rn.getAllResponseHeaders()),statusCode:rn.status})}(Kt,$t)})}function Ft(Kt,rn){var $t=Kt.url(rn),Bt=new window.XMLHttpRequest;return Bt.open(Kt.method,$t),Object.keys(Kt.headers).forEach(function(Se){Bt.setRequestHeader(Se,Kt.headers[Se])}),Bt}tn.exports={browserAbort:function Je(Kt){var rn=re[Kt.id];rn&&(rn.abort(),delete re[Kt.id])},sendRequestXhr:Ye,browserSend:function pn(Kt){return Promise.resolve().then(function(){var rn=Ft(Kt,Kt.client.accessToken);return Ye(Kt,rn)})},createRequestXhr:Ft}},176:(tn,Qt,dt)=>{"use strict";var _t=dt(129),mt=dt(538),Ge=dt(719);function m(re){if(!re||!re.accessToken)throw new Error("Cannot create a client without an access token");_t(re.accessToken),this.accessToken=re.accessToken,this.origin=re.origin||Ge.API_ORIGIN}m.prototype.createRequest=function(Je){return new mt(this,Je)},tn.exports=m},158:(tn,Qt,dt)=>{"use strict";var _t=dt(719);tn.exports=function mt(Ge){var re,m=Ge.type||_t.ERROR_HTTP;if(Ge.body)try{re=JSON.parse(Ge.body)}catch{re=Ge.body}else re=null;var Je=Ge.message||null;Je||("string"==typeof re?Je=re:re&&"string"==typeof re.message?Je=re.message:m===_t.ERROR_REQUEST_ABORTED&&(Je="Request aborted")),this.message=Je,this.type=m,this.statusCode=Ge.statusCode||null,this.request=Ge.request,this.body=re}},538:(tn,Qt,dt)=>{"use strict";var _t=dt(129),mt=dt(703),Ge=dt(661),m=dt(449),re=dt(719),Je=1;function Xe(Ve,Ye){if(!Ve)throw new Error("MapiRequest requires a client");if(!Ye||!Ye.path||!Ye.method)throw new Error("MapiRequest requires an options object with path and method properties");var Ft={};Ye.body&&(Ft["content-type"]="application/json");var pn=mt(Ft,Ye.headers),Kt=Object.keys(pn).reduce(function(rn,$t){return rn[$t.toLowerCase()]=pn[$t],rn},{});this.id=Je++,this._options=Ye,this.emitter=new Ge,this.client=Ve,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=Ye.path,this.method=Ye.method,this.origin=Ye.origin||Ve.origin,this.query=Ye.query||{},this.params=Ye.params||{},this.body=Ye.body||null,this.file=Ye.file||null,this.encoding=Ye.encoding||"utf8",this.sendFileAs=Ye.sendFileAs||null,this.headers=Kt}Xe.prototype.url=function(Ye){var Ft=m.prependOrigin(this.path,this.origin);Ft=m.appendQueryObject(Ft,this.query);var pn=this.params,Kt=Ye??this.client.accessToken;if(Kt){Ft=m.appendQueryParam(Ft,"access_token",Kt);var rn=_t(Kt).user;pn=mt({ownerId:rn},pn)}return m.interpolateRouteParams(Ft,pn)},Xe.prototype.send=function(){var Ye=this;if(Ye.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return Ye.sent=!0,Ye.client.sendRequest(Ye).then(function(Ft){return Ye.response=Ft,Ye.emitter.emit(re.EVENT_RESPONSE,Ft),Ft},function(Ft){throw Ye.error=Ft,Ye.emitter.emit(re.EVENT_ERROR,Ft),Ft})},Xe.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))},Xe.prototype.eachPage=function(Ye){var Ft=this;function pn($t){Ye(null,$t,function Bt(){delete Ft._nextPageRequest;var Se=$t.nextPage();Se&&(Ft._nextPageRequest=Se,rn(Se))})}function Kt($t){Ye($t,null,function(){})}function rn($t){$t.send().then(pn,Kt)}rn(this)},Xe.prototype.clone=function(){return this._extend()},Xe.prototype._extend=function(Ye){var Ft=mt(this._options,Ye);return new Xe(this.client,Ft)},tn.exports=Xe},332:(tn,Qt,dt)=>{"use strict";var _t=dt(699);function mt(Ge,m){this.request=Ge,this.headers=m.headers,this.rawBody=m.body,this.statusCode=m.statusCode;try{this.body=JSON.parse(m.body||"{}")}catch{this.body=m.body}this.links=_t(this.headers.link)}mt.prototype.hasNextPage=function(){return!!this.links.next},mt.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},tn.exports=mt},719:tn=>{"use strict";tn.exports={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}},829:tn=>{"use strict";tn.exports=function dt(_t){var mt={};return _t&&_t.trim().split(/[\r|\n]+/).forEach(function(Ge){var m=function Qt(_t){var mt=_t.indexOf(":");return{name:_t.substring(0,mt).trim().toLowerCase(),value:_t.substring(mt+1).trim()}}(Ge);mt[m.name]=m.value}),mt}},699:tn=>{"use strict";tn.exports=function _t(mt){return mt?mt.split(/,\s*</).reduce(function(Ge,m){var re=function dt(mt){var Ge=mt.match(/<?([^>]*)>(.*)/);if(!Ge)return null;var m=Ge[1],re=Ge[2].split(";"),Je=null,Xe=re.reduce(function(Ve,Ye){var Ft=function Qt(mt){var Ge=mt.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return Ge?{key:Ge[1],value:Ge[2]}:null}(Ye);return Ft?"rel"===Ft.key?(Je||(Je=Ft.value),Ve):(Ve[Ft.key]=Ft.value,Ve):Ve},{});return Je?{url:m,rel:Je,params:Xe}:null}(m);return re?(re.rel.split(/\s+/).forEach(function(Xe){Ge[Xe]||(Ge[Xe]={url:re.url,params:re.params})}),Ge):Ge},{}):{}}},449:tn=>{"use strict";function dt(re){return Array.isArray(re)?function Qt(re){return re.map(encodeURIComponent).join(",")}(re):encodeURIComponent(String(re))}function _t(re,Je,Xe){if(!1===Xe||null===Xe)return re;var Ve=/\?/.test(re)?"&":"?",Ye=encodeURIComponent(Je);return void 0!==Xe&&""!==Xe&&!0!==Xe&&(Ye+="="+dt(Xe)),""+re+Ve+Ye}tn.exports={appendQueryObject:function mt(re,Je){if(!Je)return re;var Xe=re;return Object.keys(Je).forEach(function(Ve){var Ye=Je[Ve];void 0!==Ye&&(Array.isArray(Ye)&&(Ye=Ye.filter(function(Ft){return null!=Ft}).join(",")),Xe=_t(Xe,Ve,Ye))}),Xe},appendQueryParam:_t,prependOrigin:function Ge(re,Je){if(!Je||"http"===re.slice(0,4))return re;var Xe="/"===re[0]?"":"/";return""+Je.replace(/\/$/,"")+Xe+re},interpolateRouteParams:function m(re,Je){return Je?re.replace(/\/:([a-zA-Z0-9]+)/g,function(Xe,Ve){var Ye=Je[Ve];if(void 0===Ye)throw new Error("Unspecified route parameter "+Ve);return"/"+dt(Ye)}):re}}},661:tn=>{"use strict";var Qt=Object.prototype.hasOwnProperty,dt="~";function _t(){}function mt(Je,Xe,Ve){this.fn=Je,this.context=Xe,this.once=Ve||!1}function Ge(Je,Xe,Ve,Ye,Ft){if("function"!=typeof Ve)throw new TypeError("The listener must be a function");var pn=new mt(Ve,Ye||Je,Ft),Kt=dt?dt+Xe:Xe;return Je._events[Kt]?Je._events[Kt].fn?Je._events[Kt]=[Je._events[Kt],pn]:Je._events[Kt].push(pn):(Je._events[Kt]=pn,Je._eventsCount++),Je}function m(Je,Xe){0==--Je._eventsCount?Je._events=new _t:delete Je._events[Xe]}function re(){this._events=new _t,this._eventsCount=0}Object.create&&(_t.prototype=Object.create(null),(new _t).__proto__||(dt=!1)),re.prototype.eventNames=function(){var Ve,Ye,Xe=[];if(0===this._eventsCount)return Xe;for(Ye in Ve=this._events)Qt.call(Ve,Ye)&&Xe.push(dt?Ye.slice(1):Ye);return Object.getOwnPropertySymbols?Xe.concat(Object.getOwnPropertySymbols(Ve)):Xe},re.prototype.listeners=function(Xe){var Ye=this._events[dt?dt+Xe:Xe];if(!Ye)return[];if(Ye.fn)return[Ye.fn];for(var Ft=0,pn=Ye.length,Kt=new Array(pn);Ft<pn;Ft++)Kt[Ft]=Ye[Ft].fn;return Kt},re.prototype.listenerCount=function(Xe){var Ye=this._events[dt?dt+Xe:Xe];return Ye?Ye.fn?1:Ye.length:0},re.prototype.emit=function(Xe,Ve,Ye,Ft,pn,Kt){var rn=dt?dt+Xe:Xe;if(!this._events[rn])return!1;var Se,ht,$t=this._events[rn],Bt=arguments.length;if($t.fn){switch($t.once&&this.removeListener(Xe,$t.fn,void 0,!0),Bt){case 1:return $t.fn.call($t.context),!0;case 2:return $t.fn.call($t.context,Ve),!0;case 3:return $t.fn.call($t.context,Ve,Ye),!0;case 4:return $t.fn.call($t.context,Ve,Ye,Ft),!0;case 5:return $t.fn.call($t.context,Ve,Ye,Ft,pn),!0;case 6:return $t.fn.call($t.context,Ve,Ye,Ft,pn,Kt),!0}for(ht=1,Se=new Array(Bt-1);ht<Bt;ht++)Se[ht-1]=arguments[ht];$t.fn.apply($t.context,Se)}else{var rt,Ue=$t.length;for(ht=0;ht<Ue;ht++)switch($t[ht].once&&this.removeListener(Xe,$t[ht].fn,void 0,!0),Bt){case 1:$t[ht].fn.call($t[ht].context);break;case 2:$t[ht].fn.call($t[ht].context,Ve);break;case 3:$t[ht].fn.call($t[ht].context,Ve,Ye);break;case 4:$t[ht].fn.call($t[ht].context,Ve,Ye,Ft);break;default:if(!Se)for(rt=1,Se=new Array(Bt-1);rt<Bt;rt++)Se[rt-1]=arguments[rt];$t[ht].fn.apply($t[ht].context,Se)}}return!0},re.prototype.on=function(Xe,Ve,Ye){return Ge(this,Xe,Ve,Ye,!1)},re.prototype.once=function(Xe,Ve,Ye){return Ge(this,Xe,Ve,Ye,!0)},re.prototype.removeListener=function(Xe,Ve,Ye,Ft){var pn=dt?dt+Xe:Xe;if(!this._events[pn])return this;if(!Ve)return m(this,pn),this;var Kt=this._events[pn];if(Kt.fn)Kt.fn===Ve&&(!Ft||Kt.once)&&(!Ye||Kt.context===Ye)&&m(this,pn);else{for(var rn=0,$t=[],Bt=Kt.length;rn<Bt;rn++)(Kt[rn].fn!==Ve||Ft&&!Kt[rn].once||Ye&&Kt[rn].context!==Ye)&&$t.push(Kt[rn]);$t.length?this._events[pn]=1===$t.length?$t[0]:$t:m(this,pn)}return this},re.prototype.removeAllListeners=function(Xe){var Ve;return Xe?this._events[Ve=dt?dt+Xe:Xe]&&m(this,Ve):(this._events=new _t,this._eventsCount=0),this},re.prototype.off=re.prototype.removeListener,re.prototype.addListener=re.prototype.on,re.prefixed=dt,re.EventEmitter=re,tn.exports=re},75:(tn,Qt,dt)=>{"use strict";var _t=dt(703),mt=dt(801),Ge=dt(313),m=dt(836),re=dt(497),Je={},Xe=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];Je.forwardGeocode=function(Ve){mt.assertShape({query:mt.required(mt.string),mode:mt.oneOf("mapbox.places","mapbox.places-permanent"),countries:mt.arrayOf(mt.string),proximity:mt.oneOf(mt.coordinates,"ip"),types:mt.arrayOf(mt.oneOf(Xe)),autocomplete:mt.boolean,bbox:mt.arrayOf(mt.number),limit:mt.number,language:mt.arrayOf(mt.string),routing:mt.boolean,fuzzyMatch:mt.boolean,worldview:mt.string})(Ve),Ve.mode=Ve.mode||"mapbox.places";var Ye=m(_t({country:Ve.countries},Ge(Ve,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Ge(Ve,["mode","query"]),query:Ye})},Je.reverseGeocode=function(Ve){mt.assertShape({query:mt.required(mt.coordinates),mode:mt.oneOf("mapbox.places","mapbox.places-permanent"),countries:mt.arrayOf(mt.string),types:mt.arrayOf(mt.oneOf(Xe)),bbox:mt.arrayOf(mt.number),limit:mt.number,language:mt.arrayOf(mt.string),reverseMode:mt.oneOf("distance","score"),routing:mt.boolean,worldview:mt.string})(Ve),Ve.mode=Ve.mode||"mapbox.places";var Ye=m(_t({country:Ve.countries},Ge(Ve,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Ge(Ve,["mode","query"]),query:Ye})},tn.exports=re(Je)},497:(tn,Qt,dt)=>{"use strict";var _t=dt(176),mt=dt(454);tn.exports=function Ge(m){return function(re){var Je;Je=_t.prototype.isPrototypeOf(re)?re:mt(re);var Xe=Object.create(m);return Xe.client=Je,Xe}}},621:tn=>{"use strict";tn.exports=function Qt(dt,_t){return Object.keys(dt).reduce(function(mt,Ge){return mt[Ge]=_t(Ge,dt[Ge]),mt},{})}},313:tn=>{"use strict";tn.exports=function Qt(dt,_t){var mt=function(Ge,m){return-1!==_t.indexOf(Ge)&&void 0!==m};return"function"==typeof _t&&(mt=_t),Object.keys(dt).filter(function(Ge){return mt(Ge,dt[Ge])}).reduce(function(Ge,m){return Ge[m]=dt[m],Ge},{})}},836:(tn,Qt,dt)=>{"use strict";var _t=dt(621);tn.exports=function mt(Ge){return _t(Ge,function(m,re){return"boolean"==typeof re?JSON.stringify(re):re})}},801:(tn,Qt,dt)=>{"use strict";var _t=dt(703),mt=dt(89);tn.exports=_t(mt,{file:function Ge(Xe){return typeof window<"u"?Xe instanceof global.Blob||Xe instanceof global.ArrayBuffer?void 0:"Blob or ArrayBuffer":"string"!=typeof Xe&&void 0===Xe.pipe?"Filename or Readable stream":void 0},date:function re(Xe){var Ve="date";if("boolean"==typeof Xe)return Ve;try{var Ye=new Date(Xe);if(Ye.getTime&&isNaN(Ye.getTime()))return Ve}catch{return Ve}},coordinates:function Je(Xe){return mt.tuple(mt.number,mt.number)(Xe)},assertShape:function m(Xe,Ve){return mt.assert(mt.strictShape(Xe),Ve)}})},129:(tn,Qt,dt)=>{"use strict";var _t=dt(49),mt={};function re(Je,Xe){return Object.prototype.hasOwnProperty.call(Je,Xe)}tn.exports=function Ge(Je){if(mt[Je])return mt[Je];var Xe=Je.split("."),Ve=Xe[0],Ye=Xe[1];if(!Ye)throw new Error("Invalid token");var Ft=function m(Je){try{return JSON.parse(_t.decode(Je))}catch{throw new Error("Invalid token")}}(Ye),pn={usage:Ve,user:Ft.u};return re(Ft,"a")&&(pn.authorization=Ft.a),re(Ft,"exp")&&(pn.expires=1e3*Ft.exp),re(Ft,"iat")&&(pn.created=1e3*Ft.iat),re(Ft,"scopes")&&(pn.scopes=Ft.scopes),re(Ft,"client")&&(pn.client=Ft.client),re(Ft,"ll")&&(pn.lastLogin=Ft.ll),re(Ft,"iu")&&(pn.impersonator=Ft.iu),mt[Je]=pn,pn}},420:(tn,Qt,dt)=>{"use strict";function _t(t){return"function"==typeof t}function mt(t){const e=t(o=>{Error.call(o),o.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const Ge=mt(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((o,r)=>`${r+1}) ${o.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function m(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class re{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:o}=this;if(_t(o))try{o()}catch(s){n=s instanceof Ge?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{Ve(s)}catch(l){n=n??[],l instanceof Ge?n=[...n,...l.errors]:n.push(l)}}if(n)throw new Ge(n)}}add(n){var e;if(n&&n!==this)if(this.closed)Ve(n);else{if(n instanceof re){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&m(e,n)}remove(n){const{_finalizers:e}=this;e&&m(e,n),n instanceof re&&n._removeParent(this)}}re.EMPTY=(()=>{const t=new re;return t.closed=!0,t})();const Je=re.EMPTY;function Xe(t){return t instanceof re||t&&"closed"in t&&_t(t.remove)&&_t(t.add)&&_t(t.unsubscribe)}function Ve(t){_t(t)?t():t.unsubscribe()}const Ye={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ft={setTimeout(t,n,...e){const{delegate:o}=Ft;return o?.setTimeout?o.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=Ft;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function pn(t){Ft.setTimeout(()=>{const{onUnhandledError:n}=Ye;if(!n)throw t;n(t)})}function Kt(){}const rn=Se("C",void 0,void 0);function Se(t,n,e){return{kind:t,value:n,error:e}}let ht=null;function Ue(t){if(Ye.useDeprecatedSynchronousErrorHandling){const n=!ht;if(n&&(ht={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:o}=ht;if(ht=null,e)throw o}}else t()}class He extends re{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Xe(n)&&n.add(this)):this.destination=Bn}static create(n,e,o){return new nn(n,e,o)}next(n){this.isStopped?xo(function Bt(t){return Se("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?xo(function $t(t){return Se("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?xo(rn,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Et=Function.prototype.bind;function bt(t,n){return Et.call(t,n)}class Ot{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(o){zn(o)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(o){zn(o)}else zn(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){zn(e)}}}class nn extends He{constructor(n,e,o){let r;if(super(),_t(n)||!n)r={next:n??void 0,error:e??void 0,complete:o??void 0};else{let s;this&&Ye.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&bt(n.next,s),error:n.error&&bt(n.error,s),complete:n.complete&&bt(n.complete,s)}):r=n}this.destination=new Ot(r)}}function zn(t){Ye.useDeprecatedSynchronousErrorHandling?function rt(t){Ye.useDeprecatedSynchronousErrorHandling&&ht&&(ht.errorThrown=!0,ht.error=t)}(t):pn(t)}function xo(t,n){const{onStoppedNotification:e}=Ye;e&&Ft.setTimeout(()=>e(t,n))}const Bn={closed:!0,next:Kt,error:function ho(t){throw t},complete:Kt},vr="function"==typeof Symbol&&Symbol.observable||"@@observable";function lr(t){return t}function Ps(t){return 0===t.length?lr:1===t.length?t[0]:function(e){return t.reduce((o,r)=>r(o),e)}}let Jn=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const o=new t;return o.source=this,o.operator=e,o}subscribe(e,o,r){const s=function Os(t){return t&&t instanceof He||function Pl(t){return t&&_t(t.next)&&_t(t.error)&&_t(t.complete)}(t)&&Xe(t)}(e)?e:new nn(e,o,r);return Ue(()=>{const{operator:l,source:h}=this;s.add(l?l.call(s,h):h?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(o){e.error(o)}}forEach(e,o){return new(o=fa(o))((r,s)=>{const l=new nn({next:h=>{try{e(h)}catch(g){s(g),l.unsubscribe()}},error:s,complete:r});this.subscribe(l)})}_subscribe(e){var o;return null===(o=this.source)||void 0===o?void 0:o.subscribe(e)}[vr](){return this}pipe(...e){return Ps(e)(this)}toPromise(e){return new(e=fa(e))((o,r)=>{let s;this.subscribe(l=>s=l,l=>r(l),()=>o(s))})}}return t.create=n=>new t(n),t})();function fa(t){var n;return null!==(n=t??Ye.Promise)&&void 0!==n?n:Promise}const ss=mt(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let gi=(()=>{class t extends Jn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const o=new ma(this,this);return o.operator=e,o}_throwIfClosed(){if(this.closed)throw new ss}next(e){Ue(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const o of this.currentObservers)o.next(e)}})}error(e){Ue(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:o}=this;for(;o.length;)o.shift().error(e)}})}complete(){Ue(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:o,isStopped:r,observers:s}=this;return o||r?Je:(this.currentObservers=null,s.push(e),new re(()=>{this.currentObservers=null,m(s,e)}))}_checkFinalizedStatuses(e){const{hasError:o,thrownError:r,isStopped:s}=this;o?e.error(r):s&&e.complete()}asObservable(){const e=new Jn;return e.source=this,e}}return t.create=(n,e)=>new ma(n,e),t})();class ma extends gi{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,o;null===(o=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===o||o.call(e,n)}error(n){var e,o;null===(o=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===o||o.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,o;return null!==(o=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==o?o:Je}}function Rs(t){return _t(t?.lift)}function ji(t){return n=>{if(Rs(n))return n.lift(function(e){try{return t(e,this)}catch(o){this.error(o)}});throw new TypeError("Unable to lift unknown Observable type")}}function Yn(t,n,e,o,r){return new Vo(t,n,e,o,r)}class Vo extends He{constructor(n,e,o,r,s,l){super(n),this.onFinalize=s,this.shouldUnsubscribe=l,this._next=e?function(h){try{e(h)}catch(g){n.error(g)}}:super._next,this._error=r?function(h){try{r(h)}catch(g){n.error(g)}finally{this.unsubscribe()}}:super._error,this._complete=o?function(){try{o()}catch(h){n.error(h)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function Nn(t,n){return ji((e,o)=>{let r=0;e.subscribe(Yn(o,s=>{o.next(t.call(n,s,r++))}))})}function ga(t){return this instanceof ga?(this.v=t,this):new ga(t)}function Id(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function al(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],o=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},o("next"),o("throw"),o("return"),e[Symbol.asyncIterator]=function(){return this},e);function o(s){e[s]=t[s]&&function(l){return new Promise(function(h,g){!function r(s,l,h,g){Promise.resolve(g).then(function(b){s({value:b,done:h})},l)}(h,g,(l=t[s](l)).done,l.value)})}}}const Eu=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Ad(t){return _t(t?.then)}function bc(t){return _t(t[vr])}function Ll(t){return Symbol.asyncIterator&&_t(t?.[Symbol.asyncIterator])}function vs(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Pd=function Fl(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function zl(t){return _t(t?.[Pd])}function me(t){return function Rl(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=e.apply(t,n||[]),s=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(R){o[R]&&(r[R]=function(z){return new Promise(function(W,X){s.push([R,z,W,X])>1||h(R,z)})})}function h(R,z){try{!function g(R){R.value instanceof ga?Promise.resolve(R.value.v).then(b,T):I(s[0][2],R)}(o[R](z))}catch(W){I(s[0][3],W)}}function b(R){h("next",R)}function T(R){h("throw",R)}function I(R,z){R(z),s.shift(),s.length&&h(s[0][0],s[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:o,done:r}=yield ga(e.read());if(r)return yield ga(void 0);yield yield ga(o)}}finally{e.releaseLock()}})}function Y(t){return _t(t?.getReader)}function ne(t){if(t instanceof Jn)return t;if(null!=t){if(bc(t))return function fe(t){return new Jn(n=>{const e=t[vr]();if(_t(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Eu(t))return function Te(t){return new Jn(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(Ad(t))return function Re(t){return new Jn(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,pn)})}(t);if(Ll(t))return We(t);if(zl(t))return function qe(t){return new Jn(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Y(t))return function ze(t){return We(me(t))}(t)}throw vs(t)}function We(t){return new Jn(n=>{(function tt(t,n){var e,o,r,s;return function za(t,n,e,o){return new(e||(e=Promise))(function(s,l){function h(T){try{b(o.next(T))}catch(I){l(I)}}function g(T){try{b(o.throw(T))}catch(I){l(I)}}function b(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(l){l(s)})}(T.value).then(h,g)}b((o=o.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Id(t);!(o=yield e.next()).done;)if(n.next(o.value),n.closed)return}catch(l){r={error:l}}finally{try{o&&!o.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function wt(t,n,e,o=0,r=!1){const s=n.schedule(function(){e(),r?t.add(this.schedule(null,o)):this.unsubscribe()},o);if(t.add(s),!r)return s}function St(t,n,e=1/0){return _t(n)?St((o,r)=>Nn((s,l)=>n(o,s,r,l))(ne(t(o,r))),e):("number"==typeof n&&(e=n),ji((o,r)=>function Xt(t,n,e,o,r,s,l,h){const g=[];let b=0,T=0,I=!1;const R=()=>{I&&!g.length&&!b&&n.complete()},z=X=>b<o?W(X):g.push(X),W=X=>{s&&n.next(X),b++;let ee=!1;ne(e(X,T++)).subscribe(Yn(n,le=>{r?.(le),s?z(le):n.next(le)},()=>{ee=!0},void 0,()=>{if(ee)try{for(b--;g.length&&b<o;){const le=g.shift();l?wt(n,l,()=>W(le)):W(le)}R()}catch(le){n.error(le)}}))};return t.subscribe(Yn(n,z,()=>{I=!0,R()})),()=>{h?.()}}(o,r,t,e)))}function Sn(t=1/0){return St(lr,t)}const dn=new Jn(t=>t.complete());function oi(t){return t&&_t(t.schedule)}function Ri(t){return t[t.length-1]}function On(t){return _t(Ri(t))?t.pop():void 0}function Vi(t){return oi(Ri(t))?t.pop():void 0}function ll(t,n=0){return ji((e,o)=>{e.subscribe(Yn(o,r=>wt(o,t,()=>o.next(r),n),()=>wt(o,t,()=>o.complete(),n),r=>wt(o,t,()=>o.error(r),n)))})}function Ba(t,n=0){return ji((e,o)=>{o.add(t.schedule(()=>e.subscribe(o),n))})}function Tf(t,n){if(!t)throw new Error("Iterable cannot be null");return new Jn(e=>{wt(e,n,()=>{const o=t[Symbol.asyncIterator]();wt(e,n,()=>{o.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Wo(t,n){return n?function Su(t,n){if(null!=t){if(bc(t))return function gt(t,n){return ne(t).pipe(Ba(n),ll(n))}(t,n);if(Eu(t))return function Go(t,n){return new Jn(e=>{let o=0;return n.schedule(function(){o===t.length?e.complete():(e.next(t[o++]),e.closed||this.schedule())})})}(t,n);if(Ad(t))return function cl(t,n){return ne(t).pipe(Ba(n),ll(n))}(t,n);if(Ll(t))return Tf(t,n);if(zl(t))return function Nl(t,n){return new Jn(e=>{let o;return wt(e,n,()=>{o=t[Pd](),wt(e,n,()=>{let r,s;try{({value:r,done:s}=o.next())}catch(l){return void e.error(l)}s?e.complete():e.next(r)},0,!0)}),()=>_t(o?.return)&&o.return()})}(t,n);if(Y(t))return function Va(t,n){return Tf(me(t),n)}(t,n)}throw vs(t)}(t,n):ne(t)}function xc(...t){const n=Vi(t),e=function oo(t,n){return"number"==typeof Ri(t)?t.pop():n}(t,1/0),o=t;return o.length?1===o.length?ne(o[0]):Sn(e)(Wo(o,n)):dn}function Gt(t={}){const{connector:n=(()=>new gi),resetOnError:e=!0,resetOnComplete:o=!0,resetOnRefCountZero:r=!0}=t;return s=>{let l,h,g,b=0,T=!1,I=!1;const R=()=>{h?.unsubscribe(),h=void 0},z=()=>{R(),l=g=void 0,T=I=!1},W=()=>{const X=l;z(),X?.unsubscribe()};return ji((X,ee)=>{b++,!I&&!T&&R();const le=g=g??n();ee.add(()=>{b--,0===b&&!I&&!T&&(h=_i(W,r))}),le.subscribe(ee),!l&&b>0&&(l=new nn({next:ve=>le.next(ve),error:ve=>{I=!0,R(),h=_i(z,e,ve),le.error(ve)},complete:()=>{T=!0,R(),h=_i(z,o),le.complete()}}),ne(X).subscribe(l))})(s)}}function _i(t,n,...e){if(!0===n)return void t();if(!1===n)return;const o=new nn({next:()=>{o.unsubscribe(),t()}});return ne(n(...e)).subscribe(o)}function Cn(t){for(let n in t)if(t[n]===Cn)return n;throw Error("Could not find renamed property on target object.")}function Ks(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function eo(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(eo).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function ci(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const Od=Cn({__forward_ref__:Cn});function xi(t){return t.__forward_ref__=xi,t.toString=function(){return eo(this())},t}function $n(t){return kr(t)?t():t}function kr(t){return"function"==typeof t&&t.hasOwnProperty(Od)&&t.__forward_ref__===xi}function ro(t){return t&&!!t.\u0275providers}const Ar="https://g.co/ng/security#xss";class Dt extends Error{constructor(n,e){super(Ua(n,e)),this.code=n}}function Ua(t,n){return`NG0${Math.abs(t)}${n?": "+n.trim():""}`}function ri(t){return"string"==typeof t?t:null==t?"":String(t)}function Iu(t,n){throw new Dt(-201,!1)}function as(t,n){null==t&&function Ui(t,n,e,o){throw new Error(`ASSERTION ERROR: ${t}`+(null==o?"":` [Expected=> ${e} ${o} ${n} <=Actual]`))}(n,t,null,"!=")}function an(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function wn(t){return{providers:t.providers||[],imports:t.imports||[]}}function zd(t){return wc(t,ls)||wc(t,Df)}function wc(t,n){return t.hasOwnProperty(n)?t[n]:null}function ul(t){return t&&(t.hasOwnProperty(Cc)||t.hasOwnProperty(Cg))?t[Cc]:null}const ls=Cn({\u0275prov:Cn}),Cc=Cn({\u0275inj:Cn}),Df=Cn({ngInjectableDef:Cn}),Cg=Cn({ngInjectorDef:Cn});var Wn=(()=>((Wn=Wn||{})[Wn.Default=0]="Default",Wn[Wn.Host=1]="Host",Wn[Wn.Self=2]="Self",Wn[Wn.SkipSelf=4]="SkipSelf",Wn[Wn.Optional=8]="Optional",Wn))();let Xh;function xs(t){const n=Xh;return Xh=t,n}function Tc(t,n,e){const o=zd(t);return o&&"root"==o.providedIn?void 0===o.value?o.value=o.factory():o.value:e&Wn.Optional?null:void 0!==n?n:void Iu(eo(t))}const bo=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Ai={},Ec="__NG_DI_FLAG__",Au="ngTempTokenPath",Bd="ngTokenPath",Vd=/\n/gm,Yh="\u0275",Ud="__source";let Sc;function dl(t){const n=Sc;return Sc=t,n}function kf(t,n=Wn.Default){if(void 0===Sc)throw new Dt(-203,!1);return null===Sc?Tc(t,void 0,n):Sc.get(t,n&Wn.Optional?null:void 0,n)}function Rt(t,n=Wn.Default){return(function Mf(){return Xh}()||kf)($n(t),n)}function ti(t,n=Wn.Default){return Rt(t,Pu(n))}function Pu(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Si(t){const n=[];for(let e=0;e<t.length;e++){const o=$n(t[e]);if(Array.isArray(o)){if(0===o.length)throw new Dt(900,!1);let r,s=Wn.Default;for(let l=0;l<o.length;l++){const h=o[l],g=Eg(h);"number"==typeof g?-1===g?r=h.token:s|=g:r=h}n.push(Rt(r,s))}else n.push(Rt(o))}return n}function hl(t,n){return t[Ec]=n,t.prototype[Ec]=n,t}function Eg(t){return t[Ec]}function ja(t){return{toString:t}.toString()}var Xs=(()=>((Xs=Xs||{})[Xs.OnPush=0]="OnPush",Xs[Xs.Default=1]="Default",Xs))(),Ys=(()=>{return(t=Ys||(Ys={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",Ys;var t})();const pl={},Hi=[],Ou=Cn({\u0275cmp:Cn}),Ru=Cn({\u0275dir:Cn}),Lu=Cn({\u0275pipe:Cn}),Pf=Cn({\u0275mod:Cn}),Ha=Cn({\u0275fac:Cn}),jd=Cn({__NG_ELEMENT_ID__:Cn});let Hd=0;function on(t){return ja(()=>{const e=!0===t.standalone,o={},r={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:o,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Xs.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&t.dependencies||null,getStandaloneInjector:null,selectors:t.selectors||Hi,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||Ys.Emulated,id:"c"+Hd++,styles:t.styles||Hi,_:null,setInput:null,schemas:t.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=t.dependencies,l=t.features;return r.inputs=Rf(t.inputs,o),r.outputs=Rf(t.outputs),l&&l.forEach(h=>h(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(Fu).filter(Qh):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(Or).filter(Qh):null,r})}function $d(t,n,e){const o=t.\u0275cmp;o.directiveDefs=()=>("function"==typeof n?n():n).map(Fu),o.pipeDefs=()=>("function"==typeof e?e():e).map(Or)}function Fu(t){return Ki(t)||Xr(t)}function Qh(t){return null!==t}function fn(t){return ja(()=>({type:t.type,bootstrap:t.bootstrap||Hi,declarations:t.declarations||Hi,imports:t.imports||Hi,exports:t.exports||Hi,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function Rf(t,n){if(null==t)return pl;const e={};for(const o in t)if(t.hasOwnProperty(o)){let r=t[o],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),e[r]=o,n&&(n[r]=s)}return e}const kn=on;function Pr(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function Ki(t){return t[Ou]||null}function Xr(t){return t[Ru]||null}function Or(t){return t[Lu]||null}function Rr(t,n){const e=t[Pf]||null;if(!e&&!0===n)throw new Error(`Type ${eo(t)} does not have '\u0275mod' property.`);return e}const $a=0,vn=1,Ci=2,Fo=3,_a=4,Ls=5,Lr=6,jl=7,Uo=8,fl=9,Jh=10,Ti=11,ep=12,zu=13,tp=14,Nu=15,br=16,Mc=17,Ic=18,ya=19,Bu=20,np=21,to=22,kc=1,Ac=2,ml=7,Qs=8,gl=9,qn=10;function Fs(t){return Array.isArray(t)&&"object"==typeof t[kc]}function zs(t){return Array.isArray(t)&&!0===t[kc]}function Pc(t){return 0!=(4&t.flags)}function Oc(t){return t.componentOffset>-1}function Wd(t){return 1==(1&t.flags)}function ws(t){return null!==t.template}function Dg(t){return 0!=(256&t[Ci])}function zo(t,n){return t.hasOwnProperty(Ha)?t[Ha]:null}class cp{constructor(n,e,o){this.previousValue=n,this.currentValue=e,this.firstChange=o}isFirstChange(){return this.firstChange}}function ur(){return Bf}function Bf(t){return t.type.prototype.ngOnChanges&&(t.setInput=Vf),up}function up(){const t=Uf(this),n=t?.current;if(n){const e=t.previous;if(e===pl)t.previous=n;else for(let o in n)e[o]=n[o];t.current=null,this.ngOnChanges(n)}}function Vf(t,n,e,o){const r=this.declaredInputs[e],s=Uf(t)||function $u(t,n){return t[Kd]=n}(t,{previous:pl,current:null}),l=s.current||(s.current={}),h=s.previous,g=h[r];l[r]=new cp(g&&g.currentValue,n,h===pl),t[o]=n}ur.ngInherit=!0;const Kd="__ngSimpleChanges__";function Uf(t){return t[Kd]||null}const cs=function(t,n,e){},jf="svg";function dr(t){for(;Array.isArray(t);)t=t[$a];return t}function Rc(t,n){return dr(n[t])}function Fr(t,n){return dr(n[t.index])}function Hf(t,n){return t.data[n]}function Hl(t,n){return t[n]}function Cs(t,n){const e=n[t];return Fs(e)?e:e[$a]}function hr(t){return 64==(64&t[Ci])}function _l(t,n){return null==n?null:t[n]}function Ag(t){t[Ic]=0}function pp(t,n){t[Ls]+=n;let e=t,o=t[Fo];for(;null!==o&&(1===n&&1===e[Ls]||-1===n&&0===e[Ls]);)o[Ls]+=n,e=o,o=o[Fo]}const Kn={lFrame:k(null),bindingsEnabled:!0};function Gf(){return Kn.bindingsEnabled}function Lt(){return Kn.lFrame.lView}function Pi(){return Kn.lFrame.tView}function Ie(t){return Kn.lFrame.contextLView=t,t[Uo]}function Me(t){return Kn.lFrame.contextLView=null,t}function xr(){let t=mp();for(;null!==t&&64===t.type;)t=t.parent;return t}function mp(){return Kn.lFrame.currentTNode}function Ts(t,n){const e=Kn.lFrame;e.currentTNode=t,e.isParent=n}function Wu(){return Kn.lFrame.isParent}function $l(){Kn.lFrame.isParent=!1}function zr(){const t=Kn.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Wa(){return Kn.lFrame.bindingIndex}function Fc(){return Kn.lFrame.bindingIndex++}function ba(t){const n=Kn.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function Og(t,n){const e=Kn.lFrame;e.bindingIndex=e.bindingRootIndex=t,qu(n)}function qu(t){Kn.lFrame.currentDirectiveIndex=t}function zc(t){const n=Kn.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}function y(){return Kn.lFrame.currentQueryIndex}function d(t){Kn.lFrame.currentQueryIndex=t}function f(t){const n=t[vn];return 2===n.type?n.declTNode:1===n.type?t[Lr]:null}function x(t,n,e){if(e&Wn.SkipSelf){let r=n,s=t;for(;!(r=r.parent,null!==r||e&Wn.Host||(r=f(s),null===r||(s=s[Nu],10&r.type))););if(null===r)return!1;n=r,t=s}const o=Kn.lFrame=S();return o.currentTNode=n,o.lView=t,!0}function C(t){const n=S(),e=t[vn];Kn.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function S(){const t=Kn.lFrame,n=null===t?null:t.child;return null===n?k(t):n}function k(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function P(){const t=Kn.lFrame;return Kn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const L=P;function H(){const t=P();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function oe(){return Kn.lFrame.selectedIndex}function ue(t){Kn.lFrame.selectedIndex=t}function ae(){const t=Kn.lFrame;return Hf(t.tView,t.selectedIndex)}function Pe(t,n){for(let e=n.directiveStart,o=n.directiveEnd;e<o;e++){const s=t.data[e].type.prototype,{ngAfterContentInit:l,ngAfterContentChecked:h,ngAfterViewInit:g,ngAfterViewChecked:b,ngOnDestroy:T}=s;l&&(t.contentHooks||(t.contentHooks=[])).push(-e,l),h&&((t.contentHooks||(t.contentHooks=[])).push(e,h),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,h)),g&&(t.viewHooks||(t.viewHooks=[])).push(-e,g),b&&((t.viewHooks||(t.viewHooks=[])).push(e,b),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,b)),null!=T&&(t.destroyHooks||(t.destroyHooks=[])).push(e,T)}}function ke(t,n,e){nt(t,n,3,e)}function Le(t,n,e,o){(3&t[Ci])===e&&nt(t,n,e,o)}function $e(t,n){let e=t[Ci];(3&e)===n&&(e&=2047,e+=1,t[Ci]=e)}function nt(t,n,e,o){const s=o??-1,l=n.length-1;let h=0;for(let g=void 0!==o?65535&t[Ic]:0;g<l;g++)if("number"==typeof n[g+1]){if(h=n[g],null!=o&&h>=o)break}else n[g]<0&&(t[Ic]+=65536),(h<s||-1==s)&&(ot(t,e,n,g),t[Ic]=(4294901760&t[Ic])+g+2),g++}function ot(t,n,e,o){const r=e[o]<0,s=e[o+1],h=t[r?-e[o]:e[o]];if(r){if(t[Ci]>>11<t[Ic]>>16&&(3&t[Ci])===n){t[Ci]+=2048,cs(4,h,s);try{s.call(h)}finally{cs(5,h,s)}}}else{cs(4,h,s);try{s.call(h)}finally{cs(5,h,s)}}}const zt=-1;class Ze{constructor(n,e,o){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=o}}function hn(t,n,e){let o=0;for(;o<e.length;){const r=e[o];if("number"==typeof r){if(0!==r)break;o++;const s=e[o++],l=e[o++],h=e[o++];t.setAttribute(n,l,h,s)}else{const s=r,l=e[++o];cn(s)?t.setProperty(n,s,l):t.setAttribute(n,s,l),o++}}return o}function ni(t){return 3===t||4===t||6===t}function cn(t){return 64===t.charCodeAt(0)}function Zt(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let o=0;o<n.length;o++){const r=n[o];"number"==typeof r?e=r:0===e||bn(t,e,r,null,-1===e||2===e?n[++o]:null)}}return t}function bn(t,n,e,o,r){let s=0,l=t.length;if(-1===n)l=-1;else for(;s<t.length;){const h=t[s++];if("number"==typeof h){if(h===n){l=-1;break}if(h>n){l=s-1;break}}}for(;s<t.length;){const h=t[s];if("number"==typeof h)break;if(h===e){if(null===o)return void(null!==r&&(t[s+1]=r));if(o===t[s+1])return void(t[s+2]=r)}s++,null!==o&&s++,null!==r&&s++}-1!==l&&(t.splice(l,0,n),s=l+1),t.splice(s++,0,e),null!==o&&t.splice(s++,0,o),null!==r&&t.splice(s++,0,r)}function yi(t){return t!==zt}function Tn(t){return 32767&t}function Gi(t,n){let e=function $i(t){return t>>16}(t),o=n;for(;e>0;)o=o[Nu],e--;return o}let so=!0;function Xi(t){const n=so;return so=t,n}const us=255,Js=5;let yl=0;const Ni={};function Di(t,n){const e=Nr(t,n);if(-1!==e)return e;const o=n[vn];o.firstCreatePass&&(t.injectorIndex=n.length,Io(o.data,t),Io(n,null),Io(o.blueprint,null));const r=uo(t,n),s=t.injectorIndex;if(yi(r)){const l=Tn(r),h=Gi(r,n),g=h[vn].data;for(let b=0;b<8;b++)n[s+b]=h[l+b]|g[l+b]}return n[s+8]=r,s}function Io(t,n){t.push(0,0,0,0,0,0,0,0,n)}function Nr(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function uo(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,o=null,r=n;for(;null!==r;){if(o=My(r),null===o)return zt;if(e++,r=r[Nu],-1!==o.injectorIndex)return o.injectorIndex|e<<16}return zt}function wr(t,n,e){!function co(t,n,e){let o;"string"==typeof e?o=e.charCodeAt(0)||0:e.hasOwnProperty(jd)&&(o=e[jd]),null==o&&(o=e[jd]=yl++);const r=o&us;n.data[t+(r>>Js)]|=1<<r}(t,n,e)}function vl(t,n,e){if(e&Wn.Optional||void 0!==t)return t;Iu()}function Nc(t,n,e,o){if(e&Wn.Optional&&void 0===o&&(o=null),!(e&(Wn.Self|Wn.Host))){const r=t[fl],s=xs(void 0);try{return r?r.get(n,o,e&Wn.Optional):Tc(n,o,e&Wn.Optional)}finally{xs(s)}}return vl(o,0,e)}function Es(t,n,e,o=Wn.Default,r){if(null!==t){if(1024&n[Ci]){const l=function E0(t,n,e,o,r){let s=t,l=n;for(;null!==s&&null!==l&&1024&l[Ci]&&!(256&l[Ci]);){const h=Ns(s,l,e,o|Wn.Self,Ni);if(h!==Ni)return h;let g=s.parent;if(!g){const b=l[np];if(b){const T=b.get(e,Ni,o);if(T!==Ni)return T}g=My(l),l=l[Nu]}s=g}return r}(t,n,e,o,Ni);if(l!==Ni)return l}const s=Ns(t,n,e,o,Ni);if(s!==Ni)return s}return Nc(n,e,o,r)}function Ns(t,n,e,o,r){const s=function Zu(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(jd)?t[jd]:void 0;return"number"==typeof n?n>=0?n&us:T0:n}(e);if("function"==typeof s){if(!x(n,t,o))return o&Wn.Host?vl(r,0,o):Nc(n,e,o,r);try{const l=s(o);if(null!=l||o&Wn.Optional)return l;Iu()}finally{L()}}else if("number"==typeof s){let l=null,h=Nr(t,n),g=zt,b=o&Wn.Host?n[br][Lr]:null;for((-1===h||o&Wn.SkipSelf)&&(g=-1===h?uo(t,n):n[h+8],g!==zt&&Lg(o,!1)?(l=n[vn],h=Tn(g),n=Gi(g,n)):h=-1);-1!==h;){const T=n[vn];if(Dy(s,h,T.data)){const I=bl(h,n,e,l,o,b);if(I!==Ni)return I}g=n[h+8],g!==zt&&Lg(o,n[vn].data[h+8]===b)&&Dy(s,h,n)?(l=T,h=Tn(g),n=Gi(g,n)):h=-1}}return r}function bl(t,n,e,o,r,s){const l=n[vn],h=l.data[t+8],T=xa(h,l,e,null==o?Oc(h)&&so:o!=l&&0!=(3&h.type),r&Wn.Host&&s===h);return null!==T?Ss(n,l,T,h):Ni}function xa(t,n,e,o,r){const s=t.providerIndexes,l=n.data,h=1048575&s,g=t.directiveStart,T=s>>20,R=r?h+T:t.directiveEnd;for(let z=o?h:h+T;z<R;z++){const W=l[z];if(z<g&&e===W||z>=g&&W.type===e)return z}if(r){const z=l[g];if(z&&ws(z)&&z.type===e)return g}return null}function Ss(t,n,e,o){let r=t[e];const s=n.data;if(function Ct(t){return t instanceof Ze}(r)){const l=r;l.resolving&&function Rd(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new Dt(-200,`Circular dependency in DI detected for ${t}${e}`)}(function Zi(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():ri(t)}(s[e]));const h=Xi(l.canSeeViewProviders);l.resolving=!0;const g=l.injectImpl?xs(l.injectImpl):null;x(t,o,Wn.Default);try{r=t[e]=l.factory(void 0,s,t,o),n.firstCreatePass&&e>=o.directiveStart&&function Ce(t,n,e){const{ngOnChanges:o,ngOnInit:r,ngDoCheck:s}=n.type.prototype;if(o){const l=Bf(n);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,l),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,l)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,r),s&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,s))}(e,s[e],n)}finally{null!==g&&xs(g),Xi(h),l.resolving=!1,L()}}return r}function Dy(t,n,e){return!!(e[n+(t>>Js)]&1<<t)}function Lg(t,n){return!(t&Wn.Self||t&Wn.Host&&n)}class eh{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,o){return Es(this._tNode,this._lView,n,Pu(o),e)}}function T0(){return new eh(xr(),Lt())}function Cr(t){return ja(()=>{const n=t.prototype.constructor,e=n[Ha]||Fg(n),o=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==o;){const s=r[Ha]||Fg(r);if(s&&s!==e)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Fg(t){return kr(t)?()=>{const n=Fg($n(t));return n&&n()}:zo(t)}function My(t){const n=t[vn],e=n.type;return 2===e?n.declTNode:1===e?t[Lr]:null}function _p(t){return function Yr(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const e=t.attrs;if(e){const o=e.length;let r=0;for(;r<o;){const s=e[r];if(ni(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<o&&"string"==typeof e[r];)r++;else{if(s===n)return e[r+1];r+=2}}}return null}(xr(),t)}const nh="__parameters__";function vp(t,n,e){return ja(()=>{const o=function Bc(t){return function(...e){if(t){const o=t(...e);for(const r in o)this[r]=o[r]}}}(n);function r(...s){if(this instanceof r)return o.apply(this,s),this;const l=new r(...s);return h.annotation=l,h;function h(g,b,T){const I=g.hasOwnProperty(nh)?g[nh]:Object.defineProperty(g,nh,{value:[]})[nh];for(;I.length<=T;)I.push(null);return(I[T]=I[T]||[]).push(l),g}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class sn{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=an({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Bs(t,n){t.forEach(e=>Array.isArray(e)?Bs(e,n):n(e))}function qa(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function xl(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Za(t,n){const e=[];for(let o=0;o<t;o++)e.push(n);return e}function wa(t,n,e){let o=Vc(t,n);return o>=0?t[1|o]=e:(o=~o,function kC(t,n,e,o){let r=t.length;if(r==n)t.push(e,o);else if(1===r)t.push(o,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=o}}(t,o,n,e)),o}function zg(t,n){const e=Vc(t,n);if(e>=0)return t[1|e]}function Vc(t,n){return function I0(t,n,e){let o=0,r=t.length>>e;for(;r!==o;){const s=o+(r-o>>1),l=t[s<<e];if(n===l)return s<<e;l>n?r=s:o=s+1}return~(r<<e)}(t,n,1)}const Wl=hl(vp("Optional"),8),ql=hl(vp("SkipSelf"),4);var wo=(()=>((wo=wo||{})[wo.Important=1]="Important",wo[wo.DashCase=2]="DashCase",wo))();const ta=new Map;let VC=0;const Vy="__ngContext__";function Ur(t,n){Fs(n)?(t[Vy]=n[Bu],function P0(t){ta.set(t[Bu],t)}(n)):t[Vy]=n}let im;function Xg(t,n){return im(t,n)}function om(t){const n=t[Fo];return zs(n)?n[Fo]:n}function Mi(t){return wl(t[zu])}function sm(t){return wl(t[_a])}function wl(t){for(;null!==t&&!zs(t);)t=t[_a];return t}function Vs(t,n,e,o,r){if(null!=o){let s,l=!1;zs(o)?s=o:Fs(o)&&(l=!0,o=o[$a]);const h=dr(o);0===t&&null!==e?null==r?qy(n,e,h):Hc(n,e,h,r||null,!0):1===t&&null!==e?Hc(n,e,h,r||null,!0):2===t?function t_(t,n,e){const o=Dp(t,n);o&&function U0(t,n,e,o){t.removeChild(n,e,o)}(t,o,n,e)}(n,h,l):3===t&&n.destroyNode(h),null!=s&&function $0(t,n,e,o,r){const s=e[ml];s!==dr(e)&&Vs(n,t,o,s,r);for(let h=qn;h<e.length;h++){const g=e[h];dm(g[vn],g,t,n,o,s)}}(n,t,s,e,r)}}function Yg(t,n,e){return t.createElement(n,e)}function B0(t,n){const e=t[gl],o=e.indexOf(n),r=n[Fo];512&n[Ci]&&(n[Ci]&=-513,pp(r,-1)),e.splice(o,1)}function am(t,n){if(t.length<=qn)return;const e=qn+n,o=t[e];if(o){const r=o[Mc];null!==r&&r!==t&&B0(r,o),n>0&&(t[e-1][_a]=o[_a]);const s=xl(t,qn+n);!function Jr(t,n){dm(t,n,n[Ti],2,null,null),n[$a]=null,n[Lr]=null}(o[vn],o);const l=s[ya];null!==l&&l.detachView(s[vn]),o[Fo]=null,o[_a]=null,o[Ci]&=-65}return o}function Gy(t,n){if(!(128&n[Ci])){const e=n[Ti];e.destroyNode&&dm(t,n,e,3,null,null),function Hy(t){let n=t[zu];if(!n)return Wy(t[vn],t);for(;n;){let e=null;if(Fs(n))e=n[zu];else{const o=n[qn];o&&(e=o)}if(!e){for(;n&&!n[_a]&&n!==t;)Fs(n)&&Wy(n[vn],n),n=n[Fo];null===n&&(n=t),Fs(n)&&Wy(n[vn],n),e=n&&n[_a]}n=e}}(n)}}function Wy(t,n){if(!(128&n[Ci])){n[Ci]&=-65,n[Ci]|=128,function hh(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let o=0;o<e.length;o+=2){const r=n[e[o]];if(!(r instanceof Ze)){const s=e[o+1];if(Array.isArray(s))for(let l=0;l<s.length;l+=2){const h=r[s[l]],g=s[l+1];cs(4,h,g);try{g.call(h)}finally{cs(5,h,g)}}else{cs(4,r,s);try{s.call(r)}finally{cs(5,r,s)}}}}}(t,n),function jc(t,n){const e=t.cleanup,o=n[jl];let r=-1;if(null!==e)for(let s=0;s<e.length-1;s+=2)if("string"==typeof e[s]){const l=e[s+3];l>=0?o[r=l]():o[r=-l].unsubscribe(),s+=2}else{const l=o[r=e[s+1]];e[s].call(l)}if(null!==o){for(let s=r+1;s<o.length;s++)(0,o[s])();n[jl]=null}}(t,n),1===n[vn].type&&n[Ti].destroy();const e=n[Mc];if(null!==e&&zs(n[Fo])){e!==n[Fo]&&B0(e,n);const o=n[ya];null!==o&&o.detachView(t)}!function Ny(t){ta.delete(t[Bu])}(n)}}function lm(t,n,e){return function cm(t,n,e){let o=n;for(;null!==o&&40&o.type;)o=(n=o).parent;if(null===o)return e[$a];{const{componentOffset:r}=o;if(r>-1){const{encapsulation:s}=t.data[o.directiveStart+r];if(s===Ys.None||s===Ys.Emulated)return null}return Fr(o,e)}}(t,n.parent,e)}function Hc(t,n,e,o,r){t.insertBefore(n,e,o,r)}function qy(t,n,e){t.appendChild(n,e)}function V0(t,n,e,o,r){null!==o?Hc(t,n,e,o,r):qy(t,n,e)}function Dp(t,n){return t.parentNode(n)}function Qg(t,n,e){return Ky(t,n,e)}let $c,hm,ev,fh,Ky=function Zy(t,n,e){return 40&t.type?Fr(t,e):null};function Jg(t,n,e,o){const r=lm(t,o,n),s=n[Ti],h=Qg(o.parent||n[Lr],o,n);if(null!=r)if(Array.isArray(e))for(let g=0;g<e.length;g++)V0(s,r,e[g],h,!1);else V0(s,r,e,h,!1);void 0!==$c&&$c(s,o,n,e,r)}function Gc(t,n){if(null!==n){const e=n.type;if(3&e)return Fr(n,t);if(4&e)return e_(-1,t[n.index]);if(8&e){const o=n.child;if(null!==o)return Gc(t,o);{const r=t[n.index];return zs(r)?e_(-1,r):dr(r)}}if(32&e)return Xg(n,t)()||dr(t[n.index]);{const o=um(t,n);return null!==o?Array.isArray(o)?o[0]:Gc(om(t[br]),o):Gc(t,n.next)}}return null}function um(t,n){return null!==n?t[br][Lr].projection[n.projection]:null}function e_(t,n){const e=qn+t+1;if(e<n.length){const o=n[e],r=o[vn].firstChild;if(null!==r)return Gc(o,r)}return n[ml]}function Yy(t,n,e,o,r,s,l){for(;null!=e;){const h=o[e.index],g=e.type;if(l&&0===n&&(h&&Ur(dr(h),o),e.flags|=2),32!=(32&e.flags))if(8&g)Yy(t,n,e.child,o,r,s,!1),Vs(n,t,r,h,s);else if(32&g){const b=Xg(e,o);let T;for(;T=b();)Vs(n,t,r,T,s);Vs(n,t,r,h,s)}else 16&g?H0(t,n,o,e,r,s):Vs(n,t,r,h,s);e=l?e.projectionNext:e.next}}function dm(t,n,e,o,r,s){Yy(e,o,t.firstChild,n,r,s,!1)}function H0(t,n,e,o,r,s){const l=e[br],g=l[Lr].projection[o.projection];if(Array.isArray(g))for(let b=0;b<g.length;b++)Vs(n,t,r,g[b],s);else Yy(t,n,g,l[Fo],r,s,!0)}function Qy(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function Jy(t,n,e){const{mergedAttrs:o,classes:r,styles:s}=e;null!==o&&hn(t,n,o),null!==r&&Qy(t,n,r),null!==s&&function $C(t,n,e){t.setAttribute(n,"style",e)}(t,n,s)}function ia(t){return function pm(){if(void 0===hm&&(hm=null,bo.trustedTypes))try{hm=bo.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return hm}()?.createHTML(t)||t}function n_(){if(void 0===fh&&(fh=null,bo.trustedTypes))try{fh=bo.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return fh}function ed(t){return n_()?.createHTML(t)||t}function W0(t){return n_()?.createScriptURL(t)||t}class mh{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ar})`}}class ZC extends mh{getTypeName(){return"HTML"}}class KC extends mh{getTypeName(){return"Style"}}class XC extends mh{getTypeName(){return"Script"}}class YC extends mh{getTypeName(){return"URL"}}class QC extends mh{getTypeName(){return"ResourceURL"}}function Us(t){return t instanceof mh?t.changingThisBreaksApplicationSecurity:t}function Yl(t,n){const e=function Ip(t){return t instanceof mh&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${Ar})`)}return e===n}class mm{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(ia(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class Z0{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=ia(n),e}}const gm=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function kp(t){return(t=String(t)).match(gm)?t:"unsafe:"+t}function Cl(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function _m(...t){const n={};for(const e of t)for(const o in e)e.hasOwnProperty(o)&&(n[o]=!0);return n}const tv=Cl("area,br,col,hr,img,wbr"),Ap=Cl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),X0=Cl("rp,rt"),ym=_m(tv,_m(Ap,Cl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),_m(X0,Cl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),_m(X0,Ap)),Pp=Cl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),J0=_m(Pp,Cl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Cl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),eT=Cl("script,style,template");class tT{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,o=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?o=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,o&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!ym.hasOwnProperty(e))return this.sanitizedSomething=!0,!eT.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const o=n.attributes;for(let r=0;r<o.length;r++){const s=o.item(r),l=s.name,h=l.toLowerCase();if(!J0.hasOwnProperty(h)){this.sanitizedSomething=!0;continue}let g=s.value;Pp[h]&&(g=kp(g)),this.buf.push(" ",l,'="',ex(g),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();ym.hasOwnProperty(e)&&!tv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(ex(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const nT=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,r_=/([^\#-~ |!])/g;function ex(t){return t.replace(/&/g,"&amp;").replace(nT,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(r_,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let vm;function gh(t,n){let e=null;try{vm=vm||function fm(t){const n=new Z0(t);return function K0(){try{return!!(new window.DOMParser).parseFromString(ia(""),"text/html")}catch{return!1}}()?new mm(n):n}(t);let o=n?String(n):"";e=vm.getInertBodyElement(o);let r=5,s=o;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,o=s,s=e.innerHTML,e=vm.getInertBodyElement(o)}while(o!==s);return ia((new tT).sanitizeChildren(nv(e)||e))}finally{if(e){const o=nv(e)||e;for(;o.firstChild;)o.removeChild(o.firstChild)}}}function nv(t){return"content"in t&&function iT(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var po=(()=>((po=po||{})[po.NONE=0]="NONE",po[po.HTML=1]="HTML",po[po.STYLE=2]="STYLE",po[po.SCRIPT=3]="SCRIPT",po[po.URL=4]="URL",po[po.RESOURCE_URL=5]="RESOURCE_URL",po))();function _h(t){const n=Wc();return n?ed(n.sanitize(po.HTML,t)||""):Yl(t,"HTML")?ed(Us(t)):gh(function ph(){return void 0!==ev?ev:typeof document<"u"?document:void 0}(),ri(t))}function Co(t){const n=Wc();return n?n.sanitize(po.URL,t)||"":Yl(t,"URL")?Us(t):kp(ri(t))}function nx(t){const n=Wc();if(n)return W0(n.sanitize(po.RESOURCE_URL,t)||"");if(Yl(t,"ResourceURL"))return W0(Us(t));throw new Dt(904,!1)}function Wc(){const t=Lt();return t&&t[ep]}const bm=new sn("ENVIRONMENT_INITIALIZER"),Op=new sn("INJECTOR",-1),ov=new sn("INJECTOR_DEF_TYPES");class ox{get(n,e=Ai){if(e===Ai){const o=new Error(`NullInjectorError: No provider for ${eo(n)}!`);throw o.name="NullInjectorError",o}return e}}function sx(...t){return{\u0275providers:rv(0,t),\u0275fromNgModule:!0}}function rv(t,...n){const e=[],o=new Set;let r;return Bs(n,s=>{const l=s;c_(l,e,[],o)&&(r||(r=[]),r.push(l))}),void 0!==r&&sv(r,e),e}function sv(t,n){for(let e=0;e<t.length;e++){const{providers:r}=t[e];av(r,s=>{n.push(s)})}}function c_(t,n,e,o){if(!(t=$n(t)))return!1;let r=null,s=ul(t);const l=!s&&Ki(t);if(s||l){if(l&&!l.standalone)return!1;r=t}else{const g=t.ngModule;if(s=ul(g),!s)return!1;r=g}const h=o.has(r);if(l){if(h)return!1;if(o.add(r),l.dependencies){const g="function"==typeof l.dependencies?l.dependencies():l.dependencies;for(const b of g)c_(b,n,e,o)}}else{if(!s)return!1;{if(null!=s.imports&&!h){let b;o.add(r);try{Bs(s.imports,T=>{c_(T,n,e,o)&&(b||(b=[]),b.push(T))})}finally{}void 0!==b&&sv(b,n)}if(!h){const b=zo(r)||(()=>new r);n.push({provide:r,useFactory:b,deps:Hi},{provide:ov,useValue:r,multi:!0},{provide:bm,useValue:()=>Rt(r),multi:!0})}const g=s.providers;null==g||h||av(g,T=>{n.push(T)})}}return r!==t&&void 0!==t.providers}function av(t,n){for(let e of t)ro(e)&&(e=e.\u0275providers),Array.isArray(e)?av(e,n):n(e)}const sT=Cn({provide:String,useValue:Cn});function u_(t){return null!==t&&"object"==typeof t&&sT in t}function nr(t){return"function"==typeof t}const td=new sn("Set Injector scope."),nd={},ax={};let d_;function h_(){return void 0===d_&&(d_=new ox),d_}class Ql{}class lx extends Ql{get destroyed(){return this._destroyed}constructor(n,e,o,r){super(),this.parent=e,this.source=o,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,uv(n,l=>this.processProvider(l)),this.records.set(Op,Rp(void 0,this)),r.has("environment")&&this.records.set(Ql,Rp(void 0,this));const s=this.records.get(td);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(ov.multi,Hi,Wn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();for(const n of this._onDestroyHooks)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(n){this._onDestroyHooks.push(n)}runInContext(n){this.assertNotDestroyed();const e=dl(this),o=xs(void 0);try{return n()}finally{dl(e),xs(o)}}get(n,e=Ai,o=Wn.Default){this.assertNotDestroyed(),o=Pu(o);const r=dl(this),s=xs(void 0);try{if(!(o&Wn.SkipSelf)){let h=this.records.get(n);if(void 0===h){const g=function dx(t){return"function"==typeof t||"object"==typeof t&&t instanceof sn}(n)&&zd(n);h=g&&this.injectableDefInScope(g)?Rp(cv(n),nd):null,this.records.set(n,h)}if(null!=h)return this.hydrate(n,h)}return(o&Wn.Self?h_():this.parent).get(n,e=o&Wn.Optional&&e===Ai?null:e)}catch(l){if("NullInjectorError"===l.name){if((l[Au]=l[Au]||[]).unshift(eo(n)),r)throw l;return function Sg(t,n,e,o){const r=t[Au];throw n[Ud]&&r.unshift(n[Ud]),t.message=function Af(t,n,e,o=null){t=t&&"\n"===t.charAt(0)&&t.charAt(1)==Yh?t.slice(2):t;let r=eo(n);if(Array.isArray(n))r=n.map(eo).join(" -> ");else if("object"==typeof n){let s=[];for(let l in n)if(n.hasOwnProperty(l)){let h=n[l];s.push(l+":"+("string"==typeof h?JSON.stringify(h):eo(h)))}r=`{${s.join(", ")}}`}return`${e}${o?"("+o+")":""}[${r}]: ${t.replace(Vd,"\n  ")}`}("\n"+t.message,r,e,o),t[Bd]=r,t[Au]=null,t}(l,n,"R3InjectorError",this.source)}throw l}finally{xs(s),dl(r)}}resolveInjectorInitializers(){const n=dl(this),e=xs(void 0);try{const o=this.get(bm.multi,Hi,Wn.Self);for(const r of o)r()}finally{dl(n),xs(e)}}toString(){const n=[],e=this.records;for(const o of e.keys())n.push(eo(o));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Dt(205,!1)}processProvider(n){let e=nr(n=$n(n))?n:$n(n&&n.provide);const o=function lT(t){return u_(t)?Rp(void 0,t.useValue):Rp(Cm(t),nd)}(n);if(nr(n)||!0!==n.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=Rp(void 0,nd,!0),r.factory=()=>Si(r.multi),this.records.set(e,r)),e=n,r.multi.push(n)}this.records.set(e,o)}hydrate(n,e){return e.value===nd&&(e.value=ax,e.value=e.factory()),"object"==typeof e.value&&e.value&&function ux(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=$n(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function cv(t){const n=zd(t),e=null!==n?n.factory:zo(t);if(null!==e)return e;if(t instanceof sn)throw new Dt(204,!1);if(t instanceof Function)return function aT(t){const n=t.length;if(n>0)throw Za(n,"?"),new Dt(204,!1);const e=function Vl(t){const n=t&&(t[ls]||t[Df]);return n?(function Kh(t){if(t.hasOwnProperty("name"))return t.name;(""+t).match(/^function\s*([^\s(]+)/)}(t),n):null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new Dt(204,!1)}function Cm(t,n,e){let o;if(nr(t)){const r=$n(t);return zo(r)||cv(r)}if(u_(t))o=()=>$n(t.useValue);else if(function lv(t){return!(!t||!t.useFactory)}(t))o=()=>t.useFactory(...Si(t.deps||[]));else if(function xm(t){return!(!t||!t.useExisting)}(t))o=()=>Rt($n(t.useExisting));else{const r=$n(t&&(t.useClass||t.provide));if(!function cx(t){return!!t.deps}(t))return zo(r)||cv(r);o=()=>new r(...Si(t.deps))}return o}function Rp(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function uv(t,n){for(const e of t)Array.isArray(e)?uv(e,n):e&&ro(e)?uv(e.\u0275providers,n):n(e)}class cT{}class hx{}class hT{resolveComponentFactory(n){throw function uT(t){const n=Error(`No component factory found for ${eo(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let ir=(()=>{class t{}return t.NULL=new hT,t})();function Jl(){return id(xr(),Lt())}function id(t,n){return new si(Fr(t,n))}let si=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=Jl,t})();function Lp(t){return t instanceof si?t.nativeElement:t}class Tm{}let jr=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function Em(){const t=Lt(),e=Cs(xr().index,t);return(Fs(e)?e:t)[Ti]}(),t})(),pT=(()=>{class t{}return t.\u0275prov=an({token:t,providedIn:"root",factory:()=>null}),t})();class yh{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const Sm=new yh("15.2.2"),p_={},f_="ngOriginalError";function Dm(t){return t[f_]}class ec{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&Dm(n);for(;e&&Dm(e);)e=Dm(e);return e||null}}function gx(t){return t.ownerDocument.defaultView}function Zc(t){return t instanceof Function?t():t}function dv(t,n,e){let o=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const s=n.length;if(r+s===o||t.charCodeAt(r+s)<=32)return r}e=r+1}}const _x="ng-template";function yT(t,n,e){let o=0;for(;o<t.length;){let r=t[o++];if(e&&"class"===r){if(r=t[o],-1!==dv(r.toLowerCase(),n,0))return!0}else if(1===r){for(;o<t.length&&"string"==typeof(r=t[o++]);)if(r.toLowerCase()===n)return!0;return!1}}return!1}function yx(t){return 4===t.type&&t.value!==_x}function hv(t,n,e){return n===(4!==t.type||e?t.value:_x)}function pv(t,n,e){let o=4;const r=t.attrs||[],s=function fv(t){for(let n=0;n<t.length;n++)if(ni(t[n]))return n;return t.length}(r);let l=!1;for(let h=0;h<n.length;h++){const g=n[h];if("number"!=typeof g){if(!l)if(4&o){if(o=2|1&o,""!==g&&!hv(t,g,e)||""===g&&1===n.length){if(Ka(o))return!1;l=!0}}else{const b=8&o?g:n[++h];if(8&o&&null!==t.attrs){if(!yT(t.attrs,b,e)){if(Ka(o))return!1;l=!0}continue}const I=Ma(8&o?"class":g,r,yx(t),e);if(-1===I){if(Ka(o))return!1;l=!0;continue}if(""!==b){let R;R=I>s?"":r[I+1].toLowerCase();const z=8&o?R:null;if(z&&-1!==dv(z,b,0)||2&o&&b!==R){if(Ka(o))return!1;l=!0}}}}else{if(!l&&!Ka(o)&&!Ka(g))return!1;if(l&&Ka(g))continue;l=!1,o=g|1&o}}return Ka(o)||l}function Ka(t){return 0==(1&t)}function Ma(t,n,e,o){if(null===n)return-1;let r=0;if(o||!e){let s=!1;for(;r<n.length;){const l=n[r];if(l===t)return r;if(3===l||6===l)s=!0;else{if(1===l||2===l){let h=n[++r];for(;"string"==typeof h;)h=n[++r];continue}if(4===l)break;if(0===l){r+=4;continue}}r+=s?1:2}return-1}return function m_(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const o=t[e];if("number"==typeof o)return-1;if(o===n)return e;e++}return-1}(n,t)}function Np(t,n,e=!1){for(let o=0;o<n.length;o++)if(pv(t,n[o],e))return!0;return!1}function vT(t,n){e:for(let e=0;e<n.length;e++){const o=n[e];if(t.length===o.length){for(let r=0;r<t.length;r++)if(t[r]!==o[r])continue e;return!0}}return!1}function mv(t,n){return t?":not("+n.trim()+")":n}function vx(t){let n=t[0],e=1,o=2,r="",s=!1;for(;e<t.length;){let l=t[e];if("string"==typeof l)if(2&o){const h=t[++e];r+="["+l+(h.length>0?'="'+h+'"':"")+"]"}else 8&o?r+="."+l:4&o&&(r+=" "+l);else""!==r&&!Ka(l)&&(n+=mv(s,r),r=""),o=l,s=s||!Ka(o);e++}return""!==r&&(n+=mv(s,r)),n}const vi={};function j(t){gv(Pi(),Lt(),oe()+t,!1)}function gv(t,n,e,o){if(!o)if(3==(3&n[Ci])){const s=t.preOrderCheckHooks;null!==s&&ke(n,s,e)}else{const s=t.preOrderHooks;null!==s&&Le(n,s,0,e)}ue(e)}function vv(t,n=null,e=null,o){const r=bv(t,n,e,o);return r.resolveInjectorInitializers(),r}function bv(t,n=null,e=null,o,r=new Set){const s=[e||Hi,sx(t)];return o=o||("object"==typeof t?void 0:eo(t)),new lx(s,n||h_(),o||null,r)}let Ds=(()=>{class t{static create(e,o){if(Array.isArray(e))return vv({name:""},o,e,"");{const r=e.name??"";return vv({name:r},e.parent,e.providers,r)}}}return t.THROW_IF_NOT_FOUND=Ai,t.NULL=new ox,t.\u0275prov=an({token:t,providedIn:"any",factory:()=>Rt(Op)}),t.__NG_ELEMENT_ID__=-1,t})();function be(t,n=Wn.Default){const e=Lt();return null===e?Rt(t,n):Es(xr(),e,$n(t),n)}function bh(){throw new Error("invalid")}function jp(t,n){const e=t.contentQueries;if(null!==e)for(let o=0;o<e.length;o+=2){const s=e[o+1];if(-1!==s){const l=t.data[s];d(e[o]),l.contentQueries(2,n[s],s)}}}function b_(t,n,e,o,r,s,l,h,g,b,T){const I=n.blueprint.slice();return I[$a]=r,I[Ci]=76|o,(null!==T||t&&1024&t[Ci])&&(I[Ci]|=1024),Ag(I),I[Fo]=I[Nu]=t,I[Uo]=e,I[Jh]=l||t&&t[Jh],I[Ti]=h||t&&t[Ti],I[ep]=g||t&&t[ep]||null,I[fl]=b||t&&t[fl]||null,I[Lr]=s,I[Bu]=function Zg(){return VC++}(),I[np]=T,I[br]=2==n.type?t[br]:I,I}function Hp(t,n,e,o,r){let s=t.data[n];if(null===s)s=function rd(t,n,e,o,r){const s=mp(),l=Wu(),g=t.data[n]=function w_(t,n,e,o,r,s){return{type:e,index:o,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,l?s:s&&s.parent,e,n,o,r);return null===t.firstChild&&(t.firstChild=g),null!==s&&(l?null==s.child&&null!==g.parent&&(s.child=g):null===s.next&&(s.next=g,g.prev=s)),g}(t,n,e,o,r),function Pg(){return Kn.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=e,s.value=o,s.attrs=r;const l=function Lc(){const t=Kn.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();s.injectorIndex=null===l?-1:l.injectorIndex}return Ts(s,!0),s}function sd(t,n,e,o){if(0===e)return-1;const r=n.length;for(let s=0;s<e;s++)n.push(o),t.blueprint.push(o),t.data.push(null);return r}function Sv(t,n,e){C(n);try{const o=t.viewQuery;null!==o&&D_(1,o,e);const r=t.template;null!==r&&Dv(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&jp(t,n),t.staticViewQueries&&D_(2,t.viewQuery,e);const s=t.components;null!==s&&function v_(t,n){for(let e=0;e<n.length;e++)Rv(t,n[e])}(n,s)}catch(o){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),o}finally{n[Ci]&=-5,H()}}function Lm(t,n,e,o){const r=n[Ci];if(128!=(128&r)){C(n);try{Ag(n),function qf(t){return Kn.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&Dv(t,n,e,2,o);const l=3==(3&r);if(l){const b=t.preOrderCheckHooks;null!==b&&ke(n,b,null)}else{const b=t.preOrderHooks;null!==b&&Le(n,b,0,null),$e(n,0)}if(function Fx(t){for(let n=Mi(t);null!==n;n=sm(n)){if(!n[Ac])continue;const e=n[gl];for(let o=0;o<e.length;o++){const r=e[o];512&r[Ci]||pp(r[Fo],1),r[Ci]|=512}}}(n),function T_(t){for(let n=Mi(t);null!==n;n=sm(n))for(let e=qn;e<n.length;e++){const o=n[e],r=o[vn];hr(o)&&Lm(r,o,r.template,o[Uo])}}(n),null!==t.contentQueries&&jp(t,n),l){const b=t.contentCheckHooks;null!==b&&ke(n,b)}else{const b=t.contentHooks;null!==b&&Le(n,b,1),$e(n,1)}!function Om(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let o=0;o<e.length;o++){const r=e[o];if(r<0)ue(~r);else{const s=r,l=e[++o],h=e[++o];Og(l,s),h(2,n[s])}}}finally{ue(-1)}}(t,n);const h=t.components;null!==h&&function Rm(t,n){for(let e=0;e<n.length;e++)zx(t,n[e])}(n,h);const g=t.viewQuery;if(null!==g&&D_(2,g,o),l){const b=t.viewCheckHooks;null!==b&&ke(n,b)}else{const b=t.viewHooks;null!==b&&Le(n,b,2),$e(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[Ci]&=-41,512&n[Ci]&&(n[Ci]&=-513,pp(n[Fo],-1))}finally{H()}}}function Dv(t,n,e,o,r){const s=oe(),l=2&o;try{ue(-1),l&&n.length>to&&gv(t,n,to,!1),cs(l?2:0,r),e(o,r)}finally{ue(s),cs(l?3:1,r)}}function Mv(t,n,e){if(Pc(n)){const r=n.directiveEnd;for(let s=n.directiveStart;s<r;s++){const l=t.data[s];l.contentQueries&&l.contentQueries(1,e[s],s)}}}function x_(t,n,e){Gf()&&(function LT(t,n,e,o){const r=e.directiveStart,s=e.directiveEnd;Oc(e)&&function Lx(t,n,e){const o=Fr(n,t),r=kv(e),s=t[Jh],l=Bm(t,b_(t,r,null,e.onPush?32:16,o,n,s,s.createRenderer(o,e),null,null,null));t[n.index]=l}(n,e,t.data[r+e.componentOffset]),t.firstCreatePass||Di(e,n),Ur(o,n);const l=e.initialInputs;for(let h=r;h<s;h++){const g=t.data[h],b=Ss(n,t,h,e);Ur(b,n),null!==l&&ad(0,h-r,b,g,0,l),ws(g)&&(Cs(e.index,n)[Uo]=Ss(n,t,h,e))}}(t,n,e,Fr(e,n)),64==(64&e.flags)&&Ox(t,n,e))}function Iv(t,n,e=Fr){const o=n.localNames;if(null!==o){let r=n.index+1;for(let s=0;s<o.length;s+=2){const l=o[s+1],h=-1===l?e(n,t):t[l];t[r++]=h}}}function kv(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=Av(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function Av(t,n,e,o,r,s,l,h,g,b){const T=to+o,I=T+r,R=function kx(t,n){const e=[];for(let o=0;o<n;o++)e.push(o<t?null:vi);return e}(T,I),z="function"==typeof b?b():b;return R[vn]={type:t,blueprint:R,template:e,queries:null,viewQuery:h,declTNode:n,data:R.slice().fill(null,T),bindingStartIndex:T,expandoStartIndex:I,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof l?l():l,firstChild:null,schemas:g,consts:z,incompleteFirstPass:!1}}function Ax(t,n,e,o){const r=Lv(n);null===e?r.push(o):(r.push(e),t.firstCreatePass&&eu(t).push(o,r.length-1))}function Fm(t,n,e,o){for(let r in t)if(t.hasOwnProperty(r)){e=null===e?{}:e;const s=t[r];null===o?zm(e,n,r,s):o.hasOwnProperty(r)&&zm(e,n,o[r],s)}return e}function zm(t,n,e,o){t.hasOwnProperty(e)?t[e].push(n,o):t[e]=[n,o]}function js(t,n,e,o,r,s,l,h){const g=Fr(n,e);let T,b=n.inputs;!h&&null!=b&&(T=b[o])?(zv(t,e,T,o,r),Oc(n)&&Qc(e,n.index)):3&n.type&&(o=function Pv(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(o),r=null!=l?l(r,n.value||"",o):r,s.setProperty(g,o,r))}function Qc(t,n){const e=Cs(n,t);16&e[Ci]||(e[Ci]|=32)}function C_(t,n,e,o){if(Gf()){const r=null===o?null:{"":-1},s=function FT(t,n){const e=t.directiveRegistry;let o=null,r=null;if(e)for(let s=0;s<e.length;s++){const l=e[s];if(Np(n,l.selectors,!1))if(o||(o=[]),ws(l))if(null!==l.findHostDirectiveDefs){const h=[];r=r||new Map,l.findHostDirectiveDefs(l,h,r),o.unshift(...h,l),xh(t,n,h.length)}else o.unshift(l),xh(t,n,0);else r=r||new Map,l.findHostDirectiveDefs?.(l,o,r),o.push(l)}return null===o?null:[o,r]}(t,e);let l,h;null===s?l=h=null:[l,h]=s,null!==l&&Nm(t,n,e,l,r,h),r&&function zT(t,n,e){if(n){const o=t.localNames=[];for(let r=0;r<n.length;r+=2){const s=e[n[r+1]];if(null==s)throw new Dt(-301,!1);o.push(n[r],s)}}}(e,o,r)}e.mergedAttrs=Zt(e.mergedAttrs,e.attrs)}function Nm(t,n,e,o,r,s){for(let b=0;b<o.length;b++)wr(Di(e,n),t,o[b].type);!function Rx(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,o.length);for(let b=0;b<o.length;b++){const T=o[b];T.providersResolver&&T.providersResolver(T)}let l=!1,h=!1,g=sd(t,n,o.length,null);for(let b=0;b<o.length;b++){const T=o[b];e.mergedAttrs=Zt(e.mergedAttrs,T.hostAttrs),BT(t,e,n,g,T),NT(g,T,r),null!==T.contentQueries&&(e.flags|=4),(null!==T.hostBindings||null!==T.hostAttrs||0!==T.hostVars)&&(e.flags|=64);const I=T.type.prototype;!l&&(I.ngOnChanges||I.ngOnInit||I.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),l=!0),!h&&(I.ngOnChanges||I.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),h=!0),g++}!function AT(t,n,e){const r=n.directiveEnd,s=t.data,l=n.attrs,h=[];let g=null,b=null;for(let T=n.directiveStart;T<r;T++){const I=s[T],R=e?e.get(I):null,W=R?R.outputs:null;g=Fm(I.inputs,T,g,R?R.inputs:null),b=Fm(I.outputs,T,b,W);const X=null===g||null===l||yx(n)?null:tc(g,T,l);h.push(X)}null!==g&&(g.hasOwnProperty("class")&&(n.flags|=8),g.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=h,n.inputs=g,n.outputs=b}(t,e,s)}function Ox(t,n,e){const o=e.directiveStart,r=e.directiveEnd,s=e.index,l=function Rg(){return Kn.lFrame.currentDirectiveIndex}();try{ue(s);for(let h=o;h<r;h++){const g=t.data[h],b=n[h];qu(h),(null!==g.hostBindings||0!==g.hostVars||null!==g.hostAttrs)&&Ov(g,b)}}finally{ue(-1),qu(l)}}function Ov(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function xh(t,n,e){n.componentOffset=e,(t.components||(t.components=[])).push(n.index)}function NT(t,n,e){if(e){if(n.exportAs)for(let o=0;o<n.exportAs.length;o++)e[n.exportAs[o]]=t;ws(n)&&(e[""]=t)}}function BT(t,n,e,o,r){t.data[o]=r;const s=r.factory||(r.factory=zo(r.type)),l=new Ze(s,ws(r),be);t.blueprint[o]=l,e[o]=l,function OT(t,n,e,o,r){const s=r.hostBindings;if(s){let l=t.hostBindingOpCodes;null===l&&(l=t.hostBindingOpCodes=[]);const h=~n.index;(function RT(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(l)!=h&&l.push(h),l.push(e,o,s)}}(t,n,o,sd(t,e,r.hostVars,vi),r)}function pr(t,n,e,o,r,s){const l=Fr(t,n);!function Xa(t,n,e,o,r,s,l){if(null==s)t.removeAttribute(n,r,e);else{const h=null==l?ri(s):l(s,o||"",r);t.setAttribute(n,r,h,e)}}(n[Ti],l,s,t.value,e,o,r)}function ad(t,n,e,o,r,s){const l=s[n];if(null!==l){const h=o.setInput;for(let g=0;g<l.length;){const b=l[g++],T=l[g++],I=l[g++];null!==h?o.setInput(e,I,b,T):e[T]=I}}}function tc(t,n,e){let o=null,r=0;for(;r<e.length;){const s=e[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===o&&(o=[]);const l=t[s];for(let h=0;h<l.length;h+=2)if(l[h]===n){o.push(s,l[h+1],e[r+1]);break}}r+=2}else r+=2;else r+=4}return o}function Jc(t,n,e,o){return[t,!0,!1,n,null,0,o,e,null,null]}function zx(t,n){const e=Cs(n,t);if(hr(e)){const o=e[vn];48&e[Ci]?Lm(o,e,o.template,e[Uo]):e[Ls]>0&&E_(e)}}function E_(t){for(let o=Mi(t);null!==o;o=sm(o))for(let r=qn;r<o.length;r++){const s=o[r];if(hr(s))if(512&s[Ci]){const l=s[vn];Lm(l,s,l.template,s[Uo])}else s[Ls]>0&&E_(s)}const e=t[vn].components;if(null!==e)for(let o=0;o<e.length;o++){const r=Cs(e[o],t);hr(r)&&r[Ls]>0&&E_(r)}}function Rv(t,n){const e=Cs(n,t),o=e[vn];(function VT(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(o,e),Sv(o,e,e[Uo])}function Bm(t,n){return t[zu]?t[tp][_a]=n:t[zu]=n,t[tp]=n,n}function S_(t){for(;t;){t[Ci]|=32;const n=om(t);if(Dg(t)&&!n)return t;t=n}return null}function Vm(t,n,e,o=!0){const r=n[Jh];r.begin&&r.begin();try{Lm(t,n,t.template,e)}catch(l){throw o&&Um(n,l),l}finally{r.end&&r.end()}}function D_(t,n,e){d(0),n(t,e)}function Lv(t){return t[jl]||(t[jl]=[])}function eu(t){return t.cleanup||(t.cleanup=[])}function Fv(t,n,e){return(null===t||ws(t))&&(e=function Gu(t){for(;Array.isArray(t);){if("object"==typeof t[kc])return t;t=t[$a]}return null}(e[n.index])),e[Ti]}function Um(t,n){const e=t[fl],o=e?e.get(ec,null):null;o&&o.handleError(n)}function zv(t,n,e,o,r){for(let s=0;s<e.length;){const l=e[s++],h=e[s++],g=n[l],b=t.data[l];null!==b.setInput?b.setInput(g,r,o,h):g[h]=r}}function ra(t,n,e){const o=Rc(n,t);!function na(t,n,e){t.setValue(n,e)}(t[Ti],o,e)}function $p(t,n,e){let o=e?t.styles:null,r=e?t.classes:null,s=0;if(null!==n)for(let l=0;l<n.length;l++){const h=n[l];"number"==typeof h?s=h:1==s?r=ci(r,h):2==s&&(o=ci(o,h+": "+n[++l]+";"))}e?t.styles=o:t.stylesWithoutHost=o,e?t.classes=r:t.classesWithoutHost=r}function Gp(t,n,e,o,r=!1){for(;null!==e;){const s=n[e.index];if(null!==s&&o.push(dr(s)),zs(s))for(let h=qn;h<s.length;h++){const g=s[h],b=g[vn].firstChild;null!==b&&Gp(g[vn],g,b,o)}const l=e.type;if(8&l)Gp(t,n,e.child,o);else if(32&l){const h=Xg(e,n);let g;for(;g=h();)o.push(g)}else if(16&l){const h=um(n,e);if(Array.isArray(h))o.push(...h);else{const g=om(n[br]);Gp(g[vn],g,h,o,!0)}}e=r?e.projectionNext:e.next}return o}class sa{get rootNodes(){const n=this._lView,e=n[vn];return Gp(e,n,e.firstChild,[])}constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Uo]}set context(n){this._lView[Uo]=n}get destroyed(){return 128==(128&this._lView[Ci])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Fo];if(zs(n)){const e=n[Qs],o=e?e.indexOf(this):-1;o>-1&&(am(n,o),xl(e,o))}this._attachedToViewContainer=!1}Gy(this._lView[vn],this._lView)}onDestroy(n){Ax(this._lView[vn],this._lView,null,n)}markForCheck(){S_(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ci]&=-65}reattach(){this._lView[Ci]|=64}detectChanges(){Vm(this._lView[vn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Dt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Sp(t,n){dm(t,n,n[Ti],2,null,null)}(this._lView[vn],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Dt(902,!1);this._appRef=n}}class Nv extends sa{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;Vm(n[vn],n,n[Uo],!1)}checkNoChanges(){}get context(){return null}}class M_ extends ir{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=Ki(n);return new Wp(e,this.ngModule)}}function Ya(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class Nx{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,o){o=Pu(o);const r=this.injector.get(n,p_,o);return r!==p_||e===p_?r:this.parentInjector.get(n,e,o)}}class Wp extends hx{get inputs(){return Ya(this.componentDef.inputs)}get outputs(){return Ya(this.componentDef.outputs)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function bT(t){return t.map(vx).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,o,r){let s=(r=r||this.ngModule)instanceof Ql?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const l=s?new Nx(n,s):n,h=l.get(Tm,null);if(null===h)throw new Dt(407,!1);const g=l.get(pT,null),b=h.createRenderer(null,this.componentDef),T=this.componentDef.selectors[0][0]||"div",I=o?function kT(t,n,e){return t.selectRootElement(n,e===Ys.ShadowDom)}(b,o,this.componentDef.encapsulation):Yg(b,T,function wh(t){const n=t.toLowerCase();return"svg"===n?jf:"math"===n?"math":null}(T)),R=this.componentDef.onPush?288:272,z=Av(0,null,null,1,0,null,null,null,null,null),W=b_(null,z,null,R,null,null,h,b,g,l,null);let X,ee;C(W);try{const le=this.componentDef;let ve,xe=null;le.findHostDirectiveDefs?(ve=[],xe=new Map,le.findHostDirectiveDefs(le,ve,xe),ve.push(le)):ve=[le];const Be=function Bx(t,n){const e=t[vn],o=to;return t[o]=n,Hp(e,o,2,"#host",null)}(W,I),Ke=function Vx(t,n,e,o,r,s,l,h){const g=r[vn];!function HT(t,n,e,o){for(const r of t)n.mergedAttrs=Zt(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&($p(n,n.mergedAttrs,!0),null!==e&&Jy(o,e,n))}(o,t,n,l);const b=s.createRenderer(n,e),T=b_(r,kv(e),null,e.onPush?32:16,r[t.index],t,s,b,h||null,null,null);return g.firstCreatePass&&xh(g,t,o.length-1),Bm(r,T),r[t.index]=T}(Be,I,le,ve,W,h,b);ee=Hf(z,to),I&&function jx(t,n,e,o){if(o)hn(t,e,["ng-version",Sm.full]);else{const{attrs:r,classes:s}=function bx(t){const n=[],e=[];let o=1,r=2;for(;o<t.length;){let s=t[o];if("string"==typeof s)2===r?""!==s&&n.push(s,t[++o]):8===r&&e.push(s);else{if(!Ka(r))break;r=s}o++}return{attrs:n,classes:e}}(n.selectors[0]);r&&hn(t,e,r),s&&s.length>0&&Qy(t,e,s.join(" "))}}(b,le,I,o),void 0!==e&&function $T(t,n,e){const o=t.projection=[];for(let r=0;r<n.length;r++){const s=e[r];o.push(null!=s?Array.from(s):null)}}(ee,this.ngContentSelectors,e),X=function Ux(t,n,e,o,r,s){const l=xr(),h=r[vn],g=Fr(l,r);Nm(h,r,l,e,null,o);for(let T=0;T<e.length;T++)Ur(Ss(r,h,l.directiveStart+T,l),r);Ox(h,r,l),g&&Ur(g,r);const b=Ss(r,h,l.directiveStart+l.componentOffset,l);if(t[Uo]=r[Uo]=b,null!==s)for(const T of s)T(b,n);return Mv(h,l,t),b}(Ke,le,ve,xe,W,[Vv]),Sv(z,W,null)}finally{H()}return new jm(this.componentType,X,id(ee,W),W,ee)}}class jm extends cT{constructor(n,e,o,r,s){super(),this.location=o,this._rootLView=r,this._tNode=s,this.instance=e,this.hostView=this.changeDetectorRef=new Nv(r),this.componentType=n}setInput(n,e){const o=this._tNode.inputs;let r;if(null!==o&&(r=o[n])){const s=this._rootLView;zv(s[vn],s,r,n,e),Qc(s,this._tNode.index)}}get injector(){return new eh(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function Vv(){const t=xr();Pe(Lt()[vn],t)}function Li(t){let n=function Uv(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const o=[t];for(;n;){let r;if(ws(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Dt(903,!1);r=n.\u0275dir}if(r){if(e){o.push(r);const l=t;l.inputs=a(t.inputs),l.declaredInputs=a(t.declaredInputs),l.outputs=a(t.outputs);const h=r.hostBindings;h&&_(t,h);const g=r.viewQuery,b=r.contentQueries;if(g&&u(t,g),b&&p(t,b),Ks(t.inputs,r.inputs),Ks(t.declaredInputs,r.declaredInputs),Ks(t.outputs,r.outputs),ws(r)&&r.data.animation){const T=t.data;T.animation=(T.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let l=0;l<s.length;l++){const h=s[l];h&&h.ngInherit&&h(t),h===Li&&(e=!1)}}n=Object.getPrototypeOf(n)}!function c(t){let n=0,e=null;for(let o=t.length-1;o>=0;o--){const r=t[o];r.hostVars=n+=r.hostVars,r.hostAttrs=Zt(r.hostAttrs,e=Zt(e,r.hostAttrs))}}(o)}function a(t){return t===pl?{}:t===Hi?[]:t}function u(t,n){const e=t.viewQuery;t.viewQuery=e?(o,r)=>{n(o,r),e(o,r)}:n}function p(t,n){const e=t.contentQueries;t.contentQueries=e?(o,r,s)=>{n(o,r,s),e(o,r,s)}:n}function _(t,n){const e=t.hostBindings;t.hostBindings=e?(o,r)=>{n(o,r),e(o,r)}:n}function te(t){return!!De(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function De(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function we(t,n,e){return t[n]=e}function Ae(t,n){return t[n]}function Ee(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function et(t,n,e,o){const r=Ee(t,n,e);return Ee(t,n+1,o)||r}function Qe(t,n,e,o,r){const s=et(t,n,e,o);return Ee(t,n+2,r)||s}function pt(t,n,e,o,r,s){const l=et(t,n,e,o);return et(t,n+2,r,s)||l}function st(t,n,e,o){const r=Lt();return Ee(r,Fc(),n)&&(Pi(),pr(ae(),r,t,n,e,o)),st}function yt(t,n,e,o){return Ee(t,Fc(),e)?n+ri(e)+o:vi}function J(t,n,e,o,r,s,l,h){const g=Lt(),b=Pi(),T=t+to,I=b.firstCreatePass?function ao(t,n,e,o,r,s,l,h,g){const b=n.consts,T=Hp(n,t,4,l||null,_l(b,h));C_(n,e,T,_l(b,g)),Pe(n,T);const I=T.tView=Av(2,T,o,r,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,b);return null!==n.queries&&(n.queries.template(n,T),I.queries=n.queries.embeddedTView(T)),T}(T,b,g,n,e,o,r,s,l):b.data[T];Ts(I,!1);const R=g[Ti].createComment("");Jg(b,g,R,I),Ur(R,g),Bm(g,g[T]=Jc(R,g,R,I)),Wd(I)&&x_(b,g,I),null!=l&&Iv(g,I,h)}function jn(t){return Hl(function gp(){return Kn.lFrame.contextLView}(),to+t)}function B(t,n,e){const o=Lt();return Ee(o,Fc(),n)&&js(Pi(),ae(),o,t,n,o[Ti],e,!1),B}function ko(t,n,e,o,r){const l=r?"class":"style";zv(t,e,n.inputs[l],l,o)}function F(t,n,e,o){const r=Lt(),s=Pi(),l=to+t,h=r[Ti],g=s.firstCreatePass?function Hr(t,n,e,o,r,s){const l=n.consts,g=Hp(n,t,2,o,_l(l,r));return C_(n,e,g,_l(l,s)),null!==g.attrs&&$p(g,g.attrs,!1),null!==g.mergedAttrs&&$p(g,g.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,g),g}(l,s,r,n,e,o):s.data[l],b=r[l]=Yg(h,n,function ge(){return Kn.lFrame.currentNamespace}()),T=Wd(g);return Ts(g,!0),Jy(h,b,g),32!=(32&g.flags)&&Jg(s,r,b,g),0===function Ga(){return Kn.lFrame.elementDepthCount}()&&Ur(b,r),function fp(){Kn.lFrame.elementDepthCount++}(),T&&(x_(s,r,g),Mv(s,g,r)),null!==o&&Iv(r,g),F}function V(){let t=xr();Wu()?$l():(t=t.parent,Ts(t,!1));const n=t;!function ln(){Kn.lFrame.elementDepthCount--}();const e=Pi();return e.firstCreatePass&&(Pe(e,t),Pc(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function je(t){return 0!=(8&t.flags)}(n)&&ko(e,n,Lt(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function lt(t){return 0!=(16&t.flags)}(n)&&ko(e,n,Lt(),n.stylesWithoutHost,!1),V}function Ne(t,n,e,o){return F(t,n,e,o),V(),Ne}function xn(t,n,e){const o=Lt(),r=Pi(),s=t+to,l=r.firstCreatePass?function Bi(t,n,e,o,r){const s=n.consts,l=_l(s,o),h=Hp(n,t,8,"ng-container",l);return null!==l&&$p(h,l,!0),C_(n,e,h,_l(s,r)),null!==n.queries&&n.queries.elementStart(n,h),h}(s,r,o,n,e):r.data[s];Ts(l,!0);const h=o[s]=o[Ti].createComment("");return Jg(r,o,h,l),Ur(h,o),Wd(l)&&(x_(r,o,l),Mv(r,l,o)),null!=e&&Iv(o,l),xn}function In(){let t=xr();const n=Pi();return Wu()?$l():(t=t.parent,Ts(t,!1)),n.firstCreatePass&&(Pe(n,t),Pc(t)&&n.queries.elementEnd(t)),In}function Ht(t,n,e){return xn(t,n,e),In(),Ht}function xt(){return Lt()}function fr(t){return!!t&&"function"==typeof t.then}const mr=function Er(t){return!!t&&"function"==typeof t.subscribe};function Oe(t,n,e,o){const r=Lt(),s=Pi(),l=xr();return Ch(s,r,r[Ti],l,t,n,o),Oe}function gr(t,n){const e=xr(),o=Lt(),r=Pi();return Ch(r,o,Fv(zc(r.data),e,o),e,t,n),gr}function Ch(t,n,e,o,r,s,l){const h=Wd(o),b=t.firstCreatePass&&eu(t),T=n[Uo],I=Lv(n);let R=!0;if(3&o.type||l){const X=Fr(o,n),ee=l?l(X):X,le=I.length,ve=l?Be=>l(dr(Be[o.index])):o.index;let xe=null;if(!l&&h&&(xe=function tu(t,n,e,o){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const l=r[s];if(l===e&&r[s+1]===o){const h=n[jl],g=r[s+2];return h.length>g?h[g]:null}"string"==typeof l&&(s+=2)}return null}(t,n,r,o.index)),null!==xe)(xe.__ngLastListenerFn__||xe).__ngNextListenerFn__=s,xe.__ngLastListenerFn__=s,R=!1;else{s=Zp(o,n,T,s,!1);const Be=e.listen(ee,r,s);I.push(s,Be),b&&b.push(r,ve,le,le+1)}}else s=Zp(o,n,T,s,!1);const z=o.outputs;let W;if(R&&null!==z&&(W=z[r])){const X=W.length;if(X)for(let ee=0;ee<X;ee+=2){const Ke=n[W[ee]][W[ee+1]].subscribe(s),ft=I.length;I.push(s,Ke),b&&b.push(r,o.index,ft,-(ft+1))}}}function qp(t,n,e,o){try{return cs(6,n,e),!1!==e(o)}catch(r){return Um(t,r),!1}finally{cs(7,n,e)}}function Zp(t,n,e,o,r){return function s(l){if(l===Function)return o;S_(t.componentOffset>-1?Cs(t.index,n):n);let g=qp(n,e,o,l),b=s.__ngNextListenerFn__;for(;b;)g=qp(n,e,b,l)&&g,b=b.__ngNextListenerFn__;return r&&!1===g&&(l.preventDefault(),l.returnValue=!1),g}}function q(t=1){return function $(t){return(Kn.lFrame.contextLView=function Q(t,n){for(;t>0;)n=n[Nu],t--;return n}(t,Kn.lFrame.contextLView))[Uo]}(t)}function Hx(t,n){let e=null;const o=function Bp(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const s=n[r];if("*"!==s){if(null===o?Np(t,s,!0):vT(o,s))return r}else e=r}return e}function or(t){const n=Lt()[br][Lr];if(!n.projection){const o=n.projection=Za(t?t.length:1,null),r=o.slice();let s=n.child;for(;null!==s;){const l=t?Hx(s,t):0;null!==l&&(r[l]?r[l].projectionNext=s:o[l]=s,r[l]=s),s=s.next}}}function Qi(t,n=0,e){const o=Lt(),r=Pi(),s=Hp(r,to+t,16,null,e||null);null===s.projection&&(s.projection=n),$l(),32!=(32&s.flags)&&function j0(t,n,e){H0(n[Ti],0,n,e,lm(t,e,n),Qg(e.parent||n[Lr],e,n))}(r,o,s)}function To(t,n,e){return Qa(t,"",n,"",e),To}function Qa(t,n,e,o,r){const s=Lt(),l=yt(s,n,e,o);return l!==vi&&js(Pi(),ae(),s,t,l,s[Ti],r,!1),Qa}function hs(t,n){return t<<17|n<<2}function Ja(t){return t>>17&32767}function iu(t){return 2|t}function Hm(t){return(131068&t)>>2}function GT(t,n){return-131069&t|n<<2}function WT(t){return 1|t}function m2(t,n,e,o,r){const s=t[e+1],l=null===n;let h=o?Ja(s):Hm(s),g=!1;for(;0!==h&&(!1===g||l);){const T=t[h+1];vN(t[h],n)&&(g=!0,t[h+1]=o?WT(T):iu(T)),h=o?Ja(T):Hm(T)}g&&(t[e+1]=o?iu(s):WT(s))}function vN(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&Vc(t,n)>=0}const ps={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function g2(t){return t.substring(ps.key,ps.keyEnd)}function bN(t){return t.substring(ps.value,ps.valueEnd)}function _2(t,n){const e=ps.textEnd;return e===n?-1:(n=ps.keyEnd=function CN(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,ps.key=n,e),P_(t,n,e))}function y2(t,n){const e=ps.textEnd;let o=ps.key=P_(t,n,e);return e===o?-1:(o=ps.keyEnd=function TN(t,n,e){let o;for(;n<e&&(45===(o=t.charCodeAt(n))||95===o||(-33&o)>=65&&(-33&o)<=90||o>=48&&o<=57);)n++;return n}(t,o,e),o=b2(t,o,e),o=ps.value=P_(t,o,e),o=ps.valueEnd=function EN(t,n,e){let o=-1,r=-1,s=-1,l=n,h=l;for(;l<e;){const g=t.charCodeAt(l++);if(59===g)return h;34===g||39===g?h=l=x2(t,g,l,e):n===l-4&&85===s&&82===r&&76===o&&40===g?h=l=x2(t,41,l,e):g>32&&(h=l),s=r,r=o,o=-33&g}return h}(t,o,e),b2(t,o,e))}function v2(t){ps.key=0,ps.keyEnd=0,ps.value=0,ps.valueEnd=0,ps.textEnd=t.length}function P_(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function b2(t,n,e,o){return(n=P_(t,n,e))<e&&n++,n}function x2(t,n,e,o){let r=-1,s=e;for(;s<o;){const l=t.charCodeAt(s++);if(l==n&&92!==r)return s;r=92==l&&92===r?0:l}throw new Error}function aa(t,n,e){return ou(t,n,e,!1),aa}function Mo(t,n){return ou(t,n,null,!0),Mo}function Ao(t){ru(T2,SN,t,!1)}function SN(t,n){for(let e=function wN(t){return v2(t),y2(t,P_(t,0,ps.textEnd))}(n);e>=0;e=y2(n,e))T2(t,g2(n),bN(n))}function Xn(t){ru(wa,cd,t,!0)}function cd(t,n){for(let e=function xN(t){return v2(t),_2(t,P_(t,0,ps.textEnd))}(n);e>=0;e=_2(n,e))wa(t,g2(n),!0)}function ou(t,n,e,o){const r=Lt(),s=Pi(),l=ba(2);s.firstUpdatePass&&C2(s,t,l,o),n!==vi&&Ee(r,l,n)&&E2(s,s.data[oe()],r,r[Ti],t,r[l+1]=function ON(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=eo(Us(t)))),t}(n,e),o,l)}function ru(t,n,e,o){const r=Pi(),s=ba(2);r.firstUpdatePass&&C2(r,null,s,o);const l=Lt();if(e!==vi&&Ee(l,s,e)){const h=r.data[oe()];if(D2(h,o)&&!w2(r,s)){let g=o?h.classesWithoutHost:h.stylesWithoutHost;null!==g&&(e=ci(g,e||"")),ko(r,h,l,e,o)}else!function PN(t,n,e,o,r,s,l,h){r===vi&&(r=Hi);let g=0,b=0,T=0<r.length?r[0]:null,I=0<s.length?s[0]:null;for(;null!==T||null!==I;){const R=g<r.length?r[g+1]:void 0,z=b<s.length?s[b+1]:void 0;let X,W=null;T===I?(g+=2,b+=2,R!==z&&(W=I,X=z)):null===I||null!==T&&T<I?(g+=2,W=T):(b+=2,W=I,X=z),null!==W&&E2(t,n,e,o,W,X,l,h),T=g<r.length?r[g]:null,I=b<s.length?s[b]:null}}(r,h,l,l[Ti],l[s+1],l[s+1]=function AN(t,n,e){if(null==e||""===e)return Hi;const o=[],r=Us(e);if(Array.isArray(r))for(let s=0;s<r.length;s++)t(o,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&t(o,s,r[s]);else"string"==typeof r&&n(o,r);return o}(t,n,e),o,s)}}function w2(t,n){return n>=t.expandoStartIndex}function C2(t,n,e,o){const r=t.data;if(null===r[e+1]){const s=r[oe()],l=w2(t,e);D2(s,o)&&null===n&&!l&&(n=!1),n=function DN(t,n,e,o){const r=zc(t);let s=o?n.residualClasses:n.residualStyles;if(null===r)0===(o?n.classBindings:n.styleBindings)&&(e=$v(e=qT(null,t,n,e,o),n.attrs,o),s=null);else{const l=n.directiveStylingLast;if(-1===l||t[l]!==r)if(e=qT(r,t,n,e,o),null===s){let g=function MN(t,n,e){const o=e?n.classBindings:n.styleBindings;if(0!==Hm(o))return t[Ja(o)]}(t,n,o);void 0!==g&&Array.isArray(g)&&(g=qT(null,t,n,g[1],o),g=$v(g,n.attrs,o),function IN(t,n,e,o){t[Ja(e?n.classBindings:n.styleBindings)]=o}(t,n,o,g))}else s=function kN(t,n,e){let o;const r=n.directiveEnd;for(let s=1+n.directiveStylingLast;s<r;s++)o=$v(o,t[s].hostAttrs,e);return $v(o,n.attrs,e)}(t,n,o)}return void 0!==s&&(o?n.residualClasses=s:n.residualStyles=s),e}(r,s,n,o),function _N(t,n,e,o,r,s){let l=s?n.classBindings:n.styleBindings,h=Ja(l),g=Hm(l);t[o]=e;let T,b=!1;if(Array.isArray(e)?(T=e[1],(null===T||Vc(e,T)>0)&&(b=!0)):T=e,r)if(0!==g){const R=Ja(t[h+1]);t[o+1]=hs(R,h),0!==R&&(t[R+1]=GT(t[R+1],o)),t[h+1]=function Gx(t,n){return 131071&t|n<<17}(t[h+1],o)}else t[o+1]=hs(h,0),0!==h&&(t[h+1]=GT(t[h+1],o)),h=o;else t[o+1]=hs(g,0),0===h?h=o:t[g+1]=GT(t[g+1],o),g=o;b&&(t[o+1]=iu(t[o+1])),m2(t,T,o,!0),m2(t,T,o,!1),function yN(t,n,e,o,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof n&&Vc(s,n)>=0&&(e[o+1]=WT(e[o+1]))}(n,T,t,o,s),l=hs(h,g),s?n.classBindings=l:n.styleBindings=l}(r,s,n,e,l,o)}}function qT(t,n,e,o,r){let s=null;const l=e.directiveEnd;let h=e.directiveStylingLast;for(-1===h?h=e.directiveStart:h++;h<l&&(s=n[h],o=$v(o,s.hostAttrs,r),s!==t);)h++;return null!==t&&(e.directiveStylingLast=h),o}function $v(t,n,e){const o=e?1:2;let r=-1;if(null!==n)for(let s=0;s<n.length;s++){const l=n[s];"number"==typeof l?r=l:r===o&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),wa(t,l,!!e||n[++s]))}return void 0===t?null:t}function T2(t,n,e){wa(t,n,Us(e))}function E2(t,n,e,o,r,s,l,h){if(!(3&n.type))return;const g=t.data,b=g[h+1],T=function gN(t){return 1==(1&t)}(b)?S2(g,n,e,r,Hm(b),l):void 0;Wx(T)||(Wx(s)||function Hv(t){return 2==(2&t)}(b)&&(s=S2(g,null,e,r,h,l)),function HC(t,n,e,o,r){if(n)r?t.addClass(e,o):t.removeClass(e,o);else{let s=-1===o.indexOf("-")?void 0:wo.DashCase;null==r?t.removeStyle(e,o,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=wo.Important),t.setStyle(e,o,r,s))}}(o,l,Rc(oe(),e),r,s))}function S2(t,n,e,o,r,s){const l=null===n;let h;for(;r>0;){const g=t[r],b=Array.isArray(g),T=b?g[1]:g,I=null===T;let R=e[r+1];R===vi&&(R=I?Hi:void 0);let z=I?zg(R,o):T===o?R:void 0;if(b&&!Wx(z)&&(z=zg(g,o)),Wx(z)&&(h=z,l))return h;const W=t[r+1];r=l?Ja(W):Hm(W)}if(null!==n){let g=s?n.residualClasses:n.residualStyles;null!=g&&(h=zg(g,o))}return h}function Wx(t){return void 0!==t}function D2(t,n){return 0!=(t.flags&(n?8:16))}function ce(t,n=""){const e=Lt(),o=Pi(),r=t+to,s=o.firstCreatePass?Hp(o,r,1,n,null):o.data[r],l=e[r]=function Da(t,n){return t.createText(n)}(e[Ti],n);Jg(o,e,l,s),Ts(s,!1)}function Jt(t){return ei("",t,""),Jt}function ei(t,n,e){const o=Lt(),r=yt(o,t,n,e);return r!==vi&&ra(o,oe(),r),ei}function O_(t,n,e,o,r){const s=Lt(),l=function vt(t,n,e,o,r,s){const h=et(t,Wa(),e,r);return ba(2),h?n+ri(e)+o+ri(r)+s:vi}(s,t,n,e,o,r);return l!==vi&&ra(s,oe(),l),O_}function ZT(t,n,e,o,r,s,l){const h=Lt(),g=function It(t,n,e,o,r,s,l,h){const b=Qe(t,Wa(),e,r,l);return ba(3),b?n+ri(e)+o+ri(r)+s+ri(l)+h:vi}(h,t,n,e,o,r,s,l);return g!==vi&&ra(h,oe(),g),ZT}function KT(t,n,e){const o=Lt();if(Ee(o,Fc(),n)){const s=Pi(),l=ae();js(s,l,o,t,n,Fv(zc(s.data),l,o),e,!0)}return KT}const L_="en-US";let W2=L_;function QT(t,n,e,o,r){if(t=$n(t),Array.isArray(t))for(let s=0;s<t.length;s++)QT(t[s],n,e,o,r);else{const s=Pi(),l=Lt();let h=nr(t)?t:$n(t.provide),g=Cm(t);const b=xr(),T=1048575&b.providerIndexes,I=b.directiveStart,R=b.providerIndexes>>20;if(nr(t)||!t.multi){const z=new Ze(g,r,be),W=eE(h,n,r?T:T+R,I);-1===W?(wr(Di(b,l),s,h),JT(s,t,n.length),n.push(h),b.directiveStart++,b.directiveEnd++,r&&(b.providerIndexes+=1048576),e.push(z),l.push(z)):(e[W]=z,l[W]=z)}else{const z=eE(h,n,T+R,I),W=eE(h,n,T,T+R),ee=W>=0&&e[W];if(r&&!ee||!r&&!(z>=0&&e[z])){wr(Di(b,l),s,h);const le=function YB(t,n,e,o,r){const s=new Ze(t,e,be);return s.multi=[],s.index=n,s.componentProviders=0,_I(s,r,o&&!e),s}(r?XB:KB,e.length,r,o,g);!r&&ee&&(e[W].providerFactory=le),JT(s,t,n.length,0),n.push(h),b.directiveStart++,b.directiveEnd++,r&&(b.providerIndexes+=1048576),e.push(le),l.push(le)}else JT(s,t,z>-1?z:W,_I(e[r?W:z],g,!r&&o));!r&&o&&ee&&e[W].componentProviders++}}}function JT(t,n,e,o){const r=nr(n),s=function wm(t){return!!t.useClass}(n);if(r||s){const g=(s?$n(n.useClass):n).prototype.ngOnDestroy;if(g){const b=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const T=b.indexOf(e);-1===T?b.push(e,[o,g]):b[T+1].push(o,g)}else b.push(e,g)}}}function _I(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function eE(t,n,e,o){for(let r=e;r<o;r++)if(n[r]===t)return r;return-1}function KB(t,n,e,o){return tE(this.multi,[])}function XB(t,n,e,o){const r=this.multi;let s;if(this.providerFactory){const l=this.providerFactory.componentProviders,h=Ss(e,e[vn],this.providerFactory.index,o);s=h.slice(0,l),tE(r,s);for(let g=l;g<h.length;g++)s.push(h[g])}else s=[],tE(r,s);return s}function tE(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function Wi(t,n=[]){return e=>{e.providersResolver=(o,r)=>function ZB(t,n,e){const o=Pi();if(o.firstCreatePass){const r=ws(t);QT(e,o.data,o.blueprint,r,!0),QT(n,o.data,o.blueprint,r,!1)}}(o,r?r(t):t,n)}}class F_{}class yI{}class vI extends F_{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new M_(this);const o=Rr(n);this._bootstrapComponents=Zc(o.bootstrap),this._r3Injector=bv(n,e,[{provide:F_,useValue:this},{provide:ir,useValue:this.componentFactoryResolver}],eo(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class nE extends yI{constructor(n){super(),this.moduleType=n}create(n){return new vI(this.moduleType,n)}}class JB extends F_{constructor(n,e,o){super(),this.componentFactoryResolver=new M_(this),this.instance=null;const r=new lx([...n,{provide:F_,useValue:this},{provide:ir,useValue:this.componentFactoryResolver}],e||h_(),o,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function Yx(t,n,e=null){return new JB(t,n,e).injector}let e4=(()=>{class t{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const o=rv(0,e.type),r=o.length>0?Yx([o],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,r)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return t.\u0275prov=an({token:t,providedIn:"environment",factory:()=>new t(Rt(Ql))}),t})();function bI(t){t.getStandaloneInjector=n=>n.get(e4).getOrCreateStandaloneInjector(t)}function ai(t,n,e){const o=zr()+t,r=Lt();return r[o]===vi?we(r,o,e?n.call(e):n()):Ae(r,o)}function An(t,n,e,o){return function MI(t,n,e,o,r,s){const l=n+e;return Ee(t,l,r)?we(t,l+1,s?o.call(s,r):o(r)):Yv(t,l+1)}(Lt(),zr(),t,n,e,o)}function no(t,n,e,o,r){return II(Lt(),zr(),t,n,e,o,r)}function $r(t,n,e,o,r,s){return kI(Lt(),zr(),t,n,e,o,r,s)}function Th(t,n,e,o,r,s,l){return function AI(t,n,e,o,r,s,l,h,g){const b=n+e;return pt(t,b,r,s,l,h)?we(t,b+4,g?o.call(g,r,s,l,h):o(r,s,l,h)):Yv(t,b+4)}(Lt(),zr(),t,n,e,o,r,s,l)}function Xv(t,n,e,o,r,s,l,h){const g=zr()+t,b=Lt(),T=pt(b,g,e,o,r,s);return Ee(b,g+4,l)||T?we(b,g+5,h?n.call(h,e,o,r,s,l):n(e,o,r,s,l)):Ae(b,g+5)}function z_(t,n,e,o,r,s,l,h,g){const b=zr()+t,T=Lt(),I=pt(T,b,e,o,r,s);return et(T,b+4,l,h)||I?we(T,b+6,g?n.call(g,e,o,r,s,l,h):n(e,o,r,s,l,h)):Ae(T,b+6)}function oE(t,n,e,o,r,s,l,h,g,b){const T=zr()+t,I=Lt();let R=pt(I,T,e,o,r,s);return Qe(I,T+4,l,h,g)||R?we(I,T+7,b?n.call(b,e,o,r,s,l,h,g):n(e,o,r,s,l,h,g)):Ae(I,T+7)}function rE(t,n,e,o){return function PI(t,n,e,o,r,s){let l=n+e,h=!1;for(let g=0;g<r.length;g++)Ee(t,l++,r[g])&&(h=!0);return h?we(t,l,o.apply(s,r)):Yv(t,l)}(Lt(),zr(),t,n,e,o)}function Yv(t,n){const e=t[n];return e===vi?void 0:e}function II(t,n,e,o,r,s,l){const h=n+e;return et(t,h,r,s)?we(t,h+2,l?o.call(l,r,s):o(r,s)):Yv(t,h+2)}function kI(t,n,e,o,r,s,l,h){const g=n+e;return Qe(t,g,r,s,l)?we(t,g+3,h?o.call(h,r,s,l):o(r,s,l)):Yv(t,g+3)}function nc(t,n){const e=Pi();let o;const r=t+to;e.firstCreatePass?(o=function u4(t,n){if(n)for(let e=n.length-1;e>=0;e--){const o=n[e];if(t===o.name)return o}}(n,e.pipeRegistry),e.data[r]=o,o.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,o.onDestroy)):o=e.data[r];const s=o.factory||(o.factory=zo(o.type)),l=xs(be);try{const h=Xi(!1),g=s();return Xi(h),function mo(t,n,e,o){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=o}(e,Lt(),r,g),g}finally{xs(l)}}function N_(t,n,e,o){const r=t+to,s=Lt(),l=Hl(s,r);return Qv(s,r)?II(s,zr(),n,l.transform,e,o,l):l.transform(e,o)}function Gm(t,n,e,o,r){const s=t+to,l=Lt(),h=Hl(l,s);return Qv(l,s)?kI(l,zr(),n,h.transform,e,o,r,h):h.transform(e,o,r)}function Qv(t,n){return t[vn].data[n].pure}function sE(t){return n=>{setTimeout(t,void 0,n)}}const Tt=class f4 extends gi{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,o){let r=n,s=e||(()=>null),l=o;if(n&&"object"==typeof n){const g=n;r=g.next?.bind(g),s=g.error?.bind(g),l=g.complete?.bind(g)}this.__isAsync&&(s=sE(s),r&&(r=sE(r)),l&&(l=sE(l)));const h=super.subscribe({next:r,error:s,complete:l});return n instanceof re&&n.add(h),h}};function m4(){return this._results[Symbol.iterator]()}class Qx{get changes(){return this._changes||(this._changes=new Tt)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Qx.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=m4)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const o=this;o.dirty=!1;const r=function ds(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function Kf(t,n,e){if(t.length!==n.length)return!1;for(let o=0;o<t.length;o++){let r=t[o],s=n[o];if(e&&(r=e(r),s=e(s)),s!==r)return!1}return!0}(o._results,r,e))&&(o._results=r,o.length=r.length,o.last=r[this.length-1],o.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let su=(()=>{class t{}return t.__NG_ELEMENT_ID__=y4,t})();const g4=su,_4=class extends g4{constructor(n,e,o){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=o}createEmbeddedView(n,e){const o=this._declarationTContainer.tView,r=b_(this._declarationLView,o,n,16,null,o.declTNode,null,null,null,null,e||null);r[Mc]=this._declarationLView[this._declarationTContainer.index];const l=this._declarationLView[ya];return null!==l&&(r[ya]=l.createEmbeddedView(o)),Sv(o,r,n),new sa(r)}};function y4(){return Jx(xr(),Lt())}function Jx(t,n){return 4&t.type?new _4(n,t,id(t,n)):null}let au=(()=>{class t{}return t.__NG_ELEMENT_ID__=v4,t})();function v4(){return LI(xr(),Lt())}const b4=au,OI=class extends b4{constructor(n,e,o){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=o}get element(){return id(this._hostTNode,this._hostLView)}get injector(){return new eh(this._hostTNode,this._hostLView)}get parentInjector(){const n=uo(this._hostTNode,this._hostLView);if(yi(n)){const e=Gi(n,this._hostLView),o=Tn(n);return new eh(e[vn].data[o+8],e)}return new eh(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=RI(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-qn}createEmbeddedView(n,e,o){let r,s;"number"==typeof o?r=o:null!=o&&(r=o.index,s=o.injector);const l=n.createEmbeddedView(e||{},s);return this.insert(l,r),l}createComponent(n,e,o,r,s){const l=n&&!function ih(t){return"function"==typeof t}(n);let h;if(l)h=e;else{const I=e||{};h=I.index,o=I.injector,r=I.projectableNodes,s=I.environmentInjector||I.ngModuleRef}const g=l?n:new Wp(Ki(n)),b=o||this.parentInjector;if(!s&&null==g.ngModule){const R=(l?b:this.parentInjector).get(Ql,null);R&&(s=R)}const T=g.create(b,r,void 0,s);return this.insert(T.hostView,h),T}insert(n,e){const o=n._lView,r=o[vn];if(function Ey(t){return zs(t[Fo])}(o)){const T=this.indexOf(n);if(-1!==T)this.detach(T);else{const I=o[Fo],R=new OI(I,I[Lr],I[Fo]);R.detach(R.indexOf(n))}}const s=this._adjustIndex(e),l=this._lContainer;!function N0(t,n,e,o){const r=qn+o,s=e.length;o>0&&(e[r-1][_a]=n),o<s-qn?(n[_a]=e[r],qa(e,qn+o,n)):(e.push(n),n[_a]=null),n[Fo]=e;const l=n[Mc];null!==l&&e!==l&&function $y(t,n){const e=t[gl];n[br]!==n[Fo][Fo][br]&&(t[Ac]=!0),null===e?t[gl]=[n]:e.push(n)}(l,n);const h=n[ya];null!==h&&h.insertView(t),n[Ci]|=64}(r,o,l,s);const h=e_(s,l),g=o[Ti],b=Dp(g,l[ml]);return null!==b&&function z0(t,n,e,o,r,s){o[$a]=r,o[Lr]=n,dm(t,o,e,1,r,s)}(r,l[Lr],g,o,b,h),n.attachToViewContainerRef(),qa(aE(l),s,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=RI(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),o=am(this._lContainer,e);o&&(xl(aE(this._lContainer),e),Gy(o[vn],o))}detach(n){const e=this._adjustIndex(n,-1),o=am(this._lContainer,e);return o&&null!=xl(aE(this._lContainer),e)?new sa(o):null}_adjustIndex(n,e=0){return n??this.length+e}};function RI(t){return t[Qs]}function aE(t){return t[Qs]||(t[Qs]=[])}function LI(t,n){let e;const o=n[t.index];if(zs(o))e=o;else{let r;if(8&t.type)r=dr(o);else{const s=n[Ti];r=s.createComment("");const l=Fr(t,n);Hc(s,Dp(s,l),r,function jC(t,n){return t.nextSibling(n)}(s,l),!1)}n[t.index]=e=Jc(o,n,r,t),Bm(n,e)}return new OI(e,t,n)}class lE{constructor(n){this.queryList=n,this.matches=null}clone(){return new lE(this.queryList)}setDirty(){this.queryList.setDirty()}}class cE{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const o=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let s=0;s<o;s++){const l=e.getByIndex(s);r.push(this.queries[l.indexInDeclarationView].clone())}return new cE(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==VI(n,e).matches&&this.queries[e].setDirty()}}class FI{constructor(n,e,o=null){this.predicate=n,this.flags=e,this.read=o}}class uE{constructor(n=[]){this.queries=n}elementStart(n,e){for(let o=0;o<this.queries.length;o++)this.queries[o].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let o=0;o<this.length;o++){const r=null!==e?e.length:0,s=this.getByIndex(o).embeddedTView(n,r);s&&(s.indexInDeclarationView=o,null!==e?e.push(s):e=[s])}return null!==e?new uE(e):null}template(n,e){for(let o=0;o<this.queries.length;o++)this.queries[o].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class dE{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new dE(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let o=n.parent;for(;null!==o&&8&o.type&&o.index!==e;)o=o.parent;return e===(null!==o?o.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const o=this.metadata.predicate;if(Array.isArray(o))for(let r=0;r<o.length;r++){const s=o[r];this.matchTNodeWithReadOption(n,e,x4(e,s)),this.matchTNodeWithReadOption(n,e,xa(e,n,s,!1,!1))}else o===su?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,xa(e,n,o,!1,!1))}matchTNodeWithReadOption(n,e,o){if(null!==o){const r=this.metadata.read;if(null!==r)if(r===si||r===au||r===su&&4&e.type)this.addMatch(e.index,-2);else{const s=xa(e,n,r,!1,!1);null!==s&&this.addMatch(e.index,s)}else this.addMatch(e.index,o)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function x4(t,n){const e=t.localNames;if(null!==e)for(let o=0;o<e.length;o+=2)if(e[o]===n)return e[o+1];return null}function C4(t,n,e,o){return-1===e?function w4(t,n){return 11&t.type?id(t,n):4&t.type?Jx(t,n):null}(n,t):-2===e?function T4(t,n,e){return e===si?id(n,t):e===su?Jx(n,t):e===au?LI(n,t):void 0}(t,n,o):Ss(t,t[vn],e,n)}function zI(t,n,e,o){const r=n[ya].queries[o];if(null===r.matches){const s=t.data,l=e.matches,h=[];for(let g=0;g<l.length;g+=2){const b=l[g];h.push(b<0?null:C4(n,s[b],l[g+1],e.metadata.read))}r.matches=h}return r.matches}function hE(t,n,e,o){const r=t.queries.getByIndex(e),s=r.matches;if(null!==s){const l=zI(t,n,r,e);for(let h=0;h<s.length;h+=2){const g=s[h];if(g>0)o.push(l[h/2]);else{const b=s[h+1],T=n[-g];for(let I=qn;I<T.length;I++){const R=T[I];R[Mc]===R[Fo]&&hE(R[vn],R,b,o)}if(null!==T[gl]){const I=T[gl];for(let R=0;R<I.length;R++){const z=I[R];hE(z[vn],z,b,o)}}}}}return o}function mn(t){const n=Lt(),e=Pi(),o=y();d(o+1);const r=VI(e,o);if(t.dirty&&function hp(t){return 4==(4&t[Ci])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const s=r.crossesNgTemplate?hE(e,n,o,[]):zI(e,n,r,o);t.reset(s,Lp),t.notifyOnChanges()}return!0}return!1}function pi(t,n,e){const o=Pi();o.firstCreatePass&&(BI(o,new FI(t,n,e),-1),2==(2&n)&&(o.staticViewQueries=!0)),NI(o,Lt(),n)}function No(t,n,e,o){const r=Pi();if(r.firstCreatePass){const s=xr();BI(r,new FI(n,e,o),s.index),function S4(t,n){const e=t.contentQueries||(t.contentQueries=[]);n!==(e.length?e[e.length-1]:-1)&&e.push(t.queries.length-1,n)}(r,t),2==(2&e)&&(r.staticContentQueries=!0)}NI(r,Lt(),e)}function gn(){return function E4(t,n){return t[ya].queries[n].queryList}(Lt(),y())}function NI(t,n,e){const o=new Qx(4==(4&e));Ax(t,n,o,o.destroy),null===n[ya]&&(n[ya]=new cE),n[ya].queries.push(new lE(o))}function BI(t,n,e){null===t.queries&&(t.queries=new uE),t.queries.track(new dE(n,e))}function VI(t,n){return t.queries.getByIndex(n)}function ka(t,n){return Jx(t,n)}function t1(...t){}const n1=new sn("Application Initializer");let o1=(()=>{class t{constructor(e){this.appInits=e,this.resolve=t1,this.reject=t1,this.initialized=!1,this.done=!1,this.donePromise=new Promise((o,r)=>{this.resolve=o,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],o=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(fr(s))e.push(s);else if(mr(s)){const l=new Promise((h,g)=>{s.subscribe({complete:h,error:g})});e.push(l)}}Promise.all(e).then(()=>{o()}).catch(r=>{this.reject(r)}),0===e.length&&o(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Rt(n1,8))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const eb=new sn("AppId",{providedIn:"root",factory:function ok(){return`${yE()}${yE()}${yE()}`}});function yE(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const rk=new sn("Platform Initializer"),r1=new sn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),U_=new sn("AnimationModuleType");let W4=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const ud=new sn("LocaleId",{providedIn:"root",factory:()=>ti(ud,Wn.Optional|Wn.SkipSelf)||function q4(){return typeof $localize<"u"&&$localize.locale||L_}()});class K4{constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}}let sk=(()=>{class t{compileModuleSync(e){return new nE(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const o=this.compileModuleSync(e),s=Zc(Rr(e).declarations).reduce((l,h)=>{const g=Ki(h);return g&&l.push(new Wp(g)),l},[]);return new K4(o,s)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Q4=(()=>Promise.resolve(0))();function vE(t){typeof Zone>"u"?Q4.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class fi{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:o=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Tt(!1),this.onMicrotaskEmpty=new Tt(!1),this.onStable=new Tt(!1),this.onError=new Tt(!1),typeof Zone>"u")throw new Dt(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!o&&e,r.shouldCoalesceRunChangeDetection=o,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function J4(){let t=bo.requestAnimationFrame,n=bo.cancelAnimationFrame;if(typeof Zone<"u"&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const o=n[Zone.__symbol__("OriginalDelegate")];o&&(n=o)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function nV(t){const n=()=>{!function tV(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(bo,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,xE(t),t.isCheckStableRunning=!0,bE(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),xE(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,o,r,s,l,h)=>{try{return ck(t),e.invokeTask(r,s,l,h)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&n(),uk(t)}},onInvoke:(e,o,r,s,l,h,g)=>{try{return ck(t),e.invoke(r,s,l,h,g)}finally{t.shouldCoalesceRunChangeDetection&&n(),uk(t)}},onHasTask:(e,o,r,s)=>{e.hasTask(r,s),o===r&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,xE(t),bE(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,o,r,s)=>(e.handleError(r,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!fi.isInAngularZone())throw new Dt(909,!1)}static assertNotInAngularZone(){if(fi.isInAngularZone())throw new Dt(909,!1)}run(n,e,o){return this._inner.run(n,e,o)}runTask(n,e,o,r){const s=this._inner,l=s.scheduleEventTask("NgZoneEvent: "+r,n,eV,t1,t1);try{return s.runTask(l,e,o)}finally{s.cancelTask(l)}}runGuarded(n,e,o){return this._inner.runGuarded(n,e,o)}runOutsideAngular(n){return this._outer.run(n)}}const eV={};function bE(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function xE(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function ck(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function uk(t){t._nesting--,bE(t)}class iV{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Tt,this.onMicrotaskEmpty=new Tt,this.onStable=new Tt,this.onError=new Tt}run(n,e,o){return n.apply(e,o)}runGuarded(n,e,o){return n.apply(e,o)}runOutsideAngular(n){return n()}runTask(n,e,o,r){return n.apply(e,o)}}const dk=new sn(""),s1=new sn("");let TE,wE=(()=>{class t{constructor(e,o,r){this._ngZone=e,this.registry=o,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,TE||(function oV(t){TE=t}(r),r.addToWindow(o)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{fi.assertNotInAngularZone(),vE(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())vE(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(o=>!o.updateCb||!o.updateCb(e)||(clearTimeout(o.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,o,r){let s=-1;o&&o>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(l=>l.timeoutId!==s),e(this._didWork,this.getPendingTasks())},o)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:r})}whenStable(e,o,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,o,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,o,r){return[]}}return t.\u0275fac=function(e){return new(e||t)(Rt(fi),Rt(CE),Rt(s1))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})(),CE=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,o){this._applications.set(e,o)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,o=!0){return TE?.findTestabilityInTree(this,e,o)??null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const Eh=!1;let Kp=null;const hk=new sn("AllowMultipleToken"),EE=new sn("PlatformDestroyListeners"),pk=new sn("appBootstrapListener");class fk{constructor(n,e){this.name=n,this.token=e}}function gk(t,n,e=[]){const o=`Platform: ${n}`,r=new sn(o);return(s=[])=>{let l=SE();if(!l||l.injector.get(hk,!1)){const h=[...e,...s,{provide:r,useValue:!0}];t?t(h):function aV(t){if(Kp&&!Kp.get(hk,!1))throw new Dt(400,!1);Kp=t;const n=t.get(yk);(function mk(t){const n=t.get(rk,null);n&&n.forEach(e=>e())})(t)}(function _k(t=[],n){return Ds.create({name:n,providers:[{provide:td,useValue:"platform"},{provide:EE,useValue:new Set([()=>Kp=null])},...t]})}(h,o))}return function cV(t){const n=SE();if(!n)throw new Dt(401,!1);return n}()}}function SE(){return Kp?.get(yk)??null}let yk=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,o){const r=function bk(t,n){let e;return e="noop"===t?new iV:("zone.js"===t?void 0:t)||new fi(n),e}(o?.ngZone,function vk(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(o)),s=[{provide:fi,useValue:r}];return r.run(()=>{const l=Ds.create({providers:s,parent:this.injector,name:e.moduleType.name}),h=e.create(l),g=h.injector.get(ec,null);if(!g)throw new Dt(402,!1);return r.runOutsideAngular(()=>{const b=r.onError.subscribe({next:T=>{g.handleError(T)}});h.onDestroy(()=>{a1(this._modules,h),b.unsubscribe()})}),function xk(t,n,e){try{const o=e();return fr(o)?o.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):o}catch(o){throw n.runOutsideAngular(()=>t.handleError(o)),o}}(g,r,()=>{const b=h.injector.get(o1);return b.runInitializers(),b.donePromise.then(()=>(function q2(t){as(t,"Expected localeId to be defined"),"string"==typeof t&&(W2=t.toLowerCase().replace(/_/g,"-"))}(h.injector.get(ud,L_)||L_),this._moduleDoBootstrap(h),h))})})}bootstrapModule(e,o=[]){const r=wk({},o);return function rV(t,n,e){const o=new nE(e);return Promise.resolve(o)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(e){const o=e.injector.get(tb);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>o.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new Dt(-403,!1);e.instance.ngDoBootstrap(o)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Dt(404,!1);this._modules.slice().forEach(o=>o.destroy()),this._destroyListeners.forEach(o=>o());const e=this._injector.get(EE,null);e&&(e.forEach(o=>o()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Rt(Ds))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function wk(t,n){return Array.isArray(n)?n.reduce(wk,t):{...t,...n}}let tb=(()=>{class t{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(e,o,r){this._zone=e,this._injector=o,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new Jn(h=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{h.next(this._stable),h.complete()})}),l=new Jn(h=>{let g;this._zone.runOutsideAngular(()=>{g=this._zone.onStable.subscribe(()=>{fi.assertNotInAngularZone(),vE(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,h.next(!0))})})});const b=this._zone.onUnstable.subscribe(()=>{fi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{h.next(!1)}))});return()=>{g.unsubscribe(),b.unsubscribe()}});this.isStable=xc(s,l.pipe(Gt()))}bootstrap(e,o){const r=e instanceof hx;if(!this._injector.get(o1).done){!r&&function Dc(t){const n=Ki(t)||Xr(t)||Or(t);return null!==n&&n.standalone}(e);throw new Dt(405,Eh)}let l;l=r?e:this._injector.get(ir).resolveComponentFactory(e),this.componentTypes.push(l.componentType);const h=function sV(t){return t.isBoundToModule}(l)?void 0:this._injector.get(F_),b=l.create(Ds.NULL,[],o||l.selector,h),T=b.location.nativeElement,I=b.injector.get(dk,null);return I?.registerApplication(T),b.onDestroy(()=>{this.detachView(b.hostView),a1(this.components,b),I?.unregisterApplication(T)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new Dt(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const o=e;this._views.push(o),o.attachToAppRef(this)}detachView(e){const o=e;a1(this._views,o),o.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const o=this._injector.get(pk,[]);o.push(...this._bootstrapListeners),o.forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>a1(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Dt(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(e){return new(e||t)(Rt(fi),Rt(Ql),Rt(ec))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function a1(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let Po=(()=>{class t{}return t.__NG_ELEMENT_ID__=dV,t})();function dV(t){return function hV(t,n,e){if(Oc(t)&&!e){const o=Cs(t.index,n);return new sa(o,o)}return 47&t.type?new sa(n[br],n):null}(xr(),Lt(),16==(16&t))}class Dk{constructor(){}supports(n){return te(n)}create(n){return new yV(n)}}const _V=(t,n)=>n;class yV{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||_V}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,o=this._removalsHead,r=0,s=null;for(;e||o;){const l=!o||e&&e.currentIndex<Ik(o,r,s)?e:o,h=Ik(l,r,s),g=l.currentIndex;if(l===o)r--,o=o._nextRemoved;else if(e=e._next,null==l.previousIndex)r++;else{s||(s=[]);const b=h-r,T=g-r;if(b!=T){for(let R=0;R<b;R++){const z=R<s.length?s[R]:s[R]=0,W=z+R;T<=W&&W<b&&(s[R]=z+1)}s[l.previousIndex]=T-b}}h!==g&&n(l,h,g)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!te(n))throw new Dt(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,s,l,e=this._itHead,o=!1;if(Array.isArray(n)){this.length=n.length;for(let h=0;h<this.length;h++)s=n[h],l=this._trackByFn(h,s),null!==e&&Object.is(e.trackById,l)?(o&&(e=this._verifyReinsertion(e,s,l,h)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,l,h),o=!0),e=e._next}else r=0,function _e(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Symbol.iterator]();let o;for(;!(o=e.next()).done;)n(o.value)}}(n,h=>{l=this._trackByFn(r,h),null!==e&&Object.is(e.trackById,l)?(o&&(e=this._verifyReinsertion(e,h,l,r)),Object.is(e.item,h)||this._addIdentityChange(e,h)):(e=this._mismatch(e,h,l,r),o=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,o,r){let s;return null===n?s=this._itTail:(s=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(o,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,s,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(o,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,s,r)):n=this._addAfter(new vV(e,o),s,r),n}_verifyReinsertion(n,e,o,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(o,null);return null!==s?n=this._reinsertAfter(s,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,o){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,s=n._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(n,e,o),this._addToMoves(n,o),n}_moveAfter(n,e,o){return this._unlink(n),this._insertAfter(n,e,o),this._addToMoves(n,o),n}_addAfter(n,e,o){return this._insertAfter(n,e,o),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,o){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new Mk),this._linkedRecords.put(n),n.currentIndex=o,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,o=n._next;return null===e?this._itHead=o:e._next=o,null===o?this._itTail=e:o._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Mk),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class vV{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class bV{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let o;for(o=this._head;null!==o;o=o._nextDup)if((null===e||e<=o.currentIndex)&&Object.is(o.trackById,n))return o;return null}remove(n){const e=n._prevDup,o=n._nextDup;return null===e?this._head=o:e._nextDup=o,null===o?this._tail=e:o._prevDup=e,null===this._head}}class Mk{constructor(){this.map=new Map}put(n){const e=n.trackById;let o=this.map.get(e);o||(o=new bV,this.map.set(e,o)),o.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Ik(t,n,e){const o=t.previousIndex;if(null===o)return o;let r=0;return e&&o<e.length&&(r=e[o]),o+n+r}class kk{constructor(){}supports(n){return n instanceof Map||De(n)}create(){return new xV}}class xV{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||De(n)))throw new Dt(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(o,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,o),this._appendAfter=e,e=e._next;else{const s=this._getOrCreateRecordForKey(r,o);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let o=e;null!==o;o=o._nextRemoved)o===this._mapHead&&(this._mapHead=null),this._records.delete(o.key),o._nextRemoved=o._next,o.previousValue=o.currentValue,o.currentValue=null,o._prev=null,o._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const o=n._prev;return e._next=n,e._prev=o,n._prev=e,o&&(o._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const s=r._prev,l=r._next;return s&&(s._next=l),l&&(l._prev=s),r._next=null,r._prev=null,r}const o=new wV(n);return this._records.set(n,o),o.currentValue=e,this._addToAdditions(o),o}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(o=>e(n[o],o))}}class wV{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Ak(){return new u1([new Dk])}let u1=(()=>{class t{constructor(e){this.factories=e}static create(e,o){if(null!=o){const r=o.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:o=>t.create(e,o||Ak()),deps:[[t,new ql,new Wl]]}}find(e){const o=this.factories.find(r=>r.supports(e));if(null!=o)return o;throw new Dt(901,!1)}}return t.\u0275prov=an({token:t,providedIn:"root",factory:Ak}),t})();function Pk(){return new nb([new kk])}let nb=(()=>{class t{constructor(e){this.factories=e}static create(e,o){if(o){const r=o.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:o=>t.create(e,o||Pk()),deps:[[t,new ql,new Wl]]}}find(e){const o=this.factories.find(r=>r.supports(e));if(o)return o;throw new Dt(901,!1)}}return t.\u0275prov=an({token:t,providedIn:"root",factory:Pk}),t})();const EV=gk(null,"core",[]);let SV=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(Rt(tb))},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({}),t})();function j_(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let AE=null;function Sh(){return AE}class IV{}const lo=new sn("DocumentToken");let PE=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:function(){return function kV(){return Rt(Ok)}()},providedIn:"platform"}),t})();const AV=new sn("Location Initialized");let Ok=(()=>{class t extends PE{constructor(e){super(),this._doc=e,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Sh().getBaseHref(this._doc)}onPopState(e){const o=Sh().getGlobalEventTarget(this._doc,"window");return o.addEventListener("popstate",e,!1),()=>o.removeEventListener("popstate",e)}onHashChange(e){const o=Sh().getGlobalEventTarget(this._doc,"window");return o.addEventListener("hashchange",e,!1),()=>o.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,o,r){Rk()?this._history.pushState(e,o,r):this._location.hash=r}replaceState(e,o,r){Rk()?this._history.replaceState(e,o,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(Rt(lo))},t.\u0275prov=an({token:t,factory:function(){return function PV(){return new Ok(Rt(lo))}()},providedIn:"platform"}),t})();function Rk(){return!!window.history.pushState}function OE(t,n){if(0==t.length)return n;if(0==n.length)return t;let e=0;return t.endsWith("/")&&e++,n.startsWith("/")&&e++,2==e?t+n.substring(1):1==e?t+n:t+"/"+n}function Lk(t){const n=t.match(/#|\?|$/),e=n&&n.index||t.length;return t.slice(0,e-("/"===t[e-1]?1:0))+t.slice(e)}function Dh(t){return t&&"?"!==t[0]?"?"+t:t}let qm=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:function(){return ti(zk)},providedIn:"root"}),t})();const Fk=new sn("appBaseHref");let zk=(()=>{class t extends qm{constructor(e,o){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=o??this._platformLocation.getBaseHrefFromDOM()??ti(lo).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return OE(this._baseHref,e)}path(e=!1){const o=this._platformLocation.pathname+Dh(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${o}${r}`:o}pushState(e,o,r,s){const l=this.prepareExternalUrl(r+Dh(s));this._platformLocation.pushState(e,o,l)}replaceState(e,o,r,s){const l=this.prepareExternalUrl(r+Dh(s));this._platformLocation.replaceState(e,o,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return t.\u0275fac=function(e){return new(e||t)(Rt(PE),Rt(Fk,8))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),OV=(()=>{class t extends qm{constructor(e,o){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=o&&(this._baseHref=o)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let o=this._platformLocation.hash;return null==o&&(o="#"),o.length>0?o.substring(1):o}prepareExternalUrl(e){const o=OE(this._baseHref,e);return o.length>0?"#"+o:o}pushState(e,o,r,s){let l=this.prepareExternalUrl(r+Dh(s));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(e,o,l)}replaceState(e,o,r,s){let l=this.prepareExternalUrl(r+Dh(s));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(e,o,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return t.\u0275fac=function(e){return new(e||t)(Rt(PE),Rt(Fk,8))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})(),d1=(()=>{class t{constructor(e){this._subject=new Tt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const o=this._locationStrategy.getBaseHref();this._basePath=function FV(t){if(new RegExp("^(https?:)?//").test(t)){const[,e]=t.split(/\/\/[^\/]+/);return e}return t}(Lk(Nk(o))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,o=""){return this.path()==this.normalize(e+Dh(o))}normalize(e){return t.stripTrailingSlash(function LV(t,n){if(!t||!n.startsWith(t))return n;const e=n.substring(t.length);return""===e||["/",";","?","#"].includes(e[0])?e:n}(this._basePath,Nk(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,o="",r=null){this._locationStrategy.pushState(r,"",e,o),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Dh(o)),r)}replaceState(e,o="",r=null){this._locationStrategy.replaceState(r,"",e,o),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Dh(o)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(o=>{this._notifyUrlChangeListeners(o.url,o.state)})),()=>{const o=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(o,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",o){this._urlChangeListeners.forEach(r=>r(e,o))}subscribe(e,o,r){return this._subject.subscribe({next:e,error:o,complete:r})}}return t.normalizeQueryParams=Dh,t.joinWithSlash=OE,t.stripTrailingSlash=Lk,t.\u0275fac=function(e){return new(e||t)(Rt(qm))},t.\u0275prov=an({token:t,factory:function(){return function RV(){return new d1(Rt(qm))}()},providedIn:"root"}),t})();function Nk(t){return t.replace(/\/index.html$/,"")}function qk(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const o=e.indexOf("="),[r,s]=-1==o?[e,""]:[e.slice(0,o),e.slice(o+1)];if(r.trim()===n)return decodeURIComponent(s)}return null}const HE=/\s+/,Zk=[];let Eo=(()=>{class t{constructor(e,o,r,s){this._iterableDiffers=e,this._keyValueDiffers=o,this._ngEl=r,this._renderer=s,this.initialClasses=Zk,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(HE):Zk}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(HE):e}ngDoCheck(){for(const o of this.initialClasses)this._updateState(o,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const o of e)this._updateState(o,!0);else if(null!=e)for(const o of Object.keys(e))this._updateState(o,Boolean(e[o]));this._applyStateDiff()}_updateState(e,o){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==o&&(r.changed=!0,r.enabled=o),r.touched=!0):this.stateMap.set(e,{enabled:o,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const o=e[0],r=e[1];r.changed?(this._toggleClass(o,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(o,!1),this.stateMap.delete(o)),r.touched=!1}}_toggleClass(e,o){(e=e.trim()).length>0&&e.split(HE).forEach(r=>{o?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(be(u1),be(nb),be(si),be(jr))},t.\u0275dir=kn({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),t})();class x5{constructor(n,e,o,r){this.$implicit=n,this.ngForOf=e,this.index=o,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ms=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,o,r){this._viewContainer=e,this._template=o,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const o=this._viewContainer;e.forEachOperation((r,s,l)=>{if(null==r.previousIndex)o.createEmbeddedView(this._template,new x5(r.item,this._ngForOf,-1,-1),null===l?void 0:l);else if(null==l)o.remove(null===s?void 0:s);else if(null!==s){const h=o.get(s);o.move(h,l),Yk(h,r)}});for(let r=0,s=o.length;r<s;r++){const h=o.get(r).context;h.index=r,h.count=s,h.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{Yk(o.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,o){return!0}}return t.\u0275fac=function(e){return new(e||t)(be(au),be(su),be(u1))},t.\u0275dir=kn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function Yk(t,n){t.context.$implicit=n.item}let mi=(()=>{class t{constructor(e,o){this._viewContainer=e,this._context=new C5,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=o}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){Qk("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){Qk("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,o){return!0}}return t.\u0275fac=function(e){return new(e||t)(be(au),be(su))},t.\u0275dir=kn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class C5{constructor(){this.$implicit=null,this.ngIf=null}}function Qk(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${eo(n)}'.`)}let Oo=(()=>{class t{constructor(e,o,r){this._ngEl=e,this._differs=o,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,o){const[r,s]=e.split("."),l=-1===r.indexOf("-")?void 0:wo.DashCase;null!=o?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${o}${s}`:o,l):this._renderer.removeStyle(this._ngEl.nativeElement,r,l)}_applyChanges(e){e.forEachRemovedItem(o=>this._setStyle(o.key,null)),e.forEachAddedItem(o=>this._setStyle(o.key,o.currentValue)),e.forEachChangedItem(o=>this._setStyle(o.key,o.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(nb),be(jr))},t.\u0275dir=kn({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),t})(),Is=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const o=this._viewContainerRef;if(this._viewRef&&o.remove(o.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:l}=this;this._viewRef=o.createEmbeddedView(r,s,l?{injector:l}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(be(au))},t.\u0275dir=kn({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[ur]}),t})();let rb=(()=>{class t{transform(e,o,r){if(null==e)return null;if(!this.supports(e))throw function uu(t,n){return new Dt(2100,!1)}();return e.slice(o,r)}supports(e){return"string"==typeof e||Array.isArray(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=Pr({name:"slice",type:t,pure:!1,standalone:!0}),t})(),Ei=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({}),t})();const tA="browser";let J5=(()=>{class t{}return t.\u0275prov=an({token:t,providedIn:"root",factory:()=>new eU(Rt(lo),window)}),t})();class eU{constructor(n,e){this.document=n,this.window=e,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const e=function tU(t,n){const e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const o=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let r=o.currentNode;for(;r;){const s=r.shadowRoot;if(s){const l=s.getElementById(n)||s.querySelector(`[name="${n}"]`);if(l)return l}r=o.nextNode()}}return null}(this.document,n);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(n){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=n)}}scrollToElement(n){const e=n.getBoundingClientRect(),o=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(o-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const n=nA(this.window.history)||nA(Object.getPrototypeOf(this.window.history));return!(!n||!n.writable&&!n.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function nA(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class iA{}class MU extends IV{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class XE extends MU{static makeCurrent(){!function MV(t){AE||(AE=t)}(new XE)}onAndCancel(n,e,o){return n.addEventListener(e,o,!1),()=>{n.removeEventListener(e,o,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function IU(){return ab=ab||document.querySelector("base"),ab?ab.getAttribute("href"):null}();return null==e?null:function kU(t){C1=C1||document.createElement("a"),C1.setAttribute("href",t);const n=C1.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){ab=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return qk(document.cookie,n)}}let C1,ab=null;const lA=new sn("TRANSITION_ID"),PU=[{provide:n1,useFactory:function AU(t,n,e){return()=>{e.get(o1).donePromise.then(()=>{const o=Sh(),r=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<r.length;s++)o.remove(r[s])})}},deps:[lA,lo,Ds],multi:!0}];let RU=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();const T1=new sn("EventManagerPlugins");let E1=(()=>{class t{constructor(e,o){this._zone=o,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,o,r){return this._findPluginFor(o).addEventListener(e,o,r)}addGlobalEventListener(e,o,r){return this._findPluginFor(o).addGlobalEventListener(e,o,r)}getZone(){return this._zone}_findPluginFor(e){const o=this._eventNameToPlugin.get(e);if(o)return o;const r=this._plugins;for(let s=0;s<r.length;s++){const l=r[s];if(l.supports(e))return this._eventNameToPlugin.set(e,l),l}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(Rt(T1),Rt(fi))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();class cA{constructor(n){this._doc=n}addGlobalEventListener(n,e,o){const r=Sh().getGlobalEventTarget(this._doc,n);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,o)}}let uA=(()=>{class t{constructor(){this.usageCount=new Map}addStyles(e){for(const o of e)1===this.changeUsageCount(o,1)&&this.onStyleAdded(o)}removeStyles(e){for(const o of e)0===this.changeUsageCount(o,-1)&&this.onStyleRemoved(o)}onStyleRemoved(e){}onStyleAdded(e){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(e,o){const r=this.usageCount;let s=r.get(e)??0;return s+=o,s>0?r.set(e,s):r.delete(e),s}ngOnDestroy(){for(const e of this.getAllStyles())this.onStyleRemoved(e);this.usageCount.clear()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})(),lb=(()=>{class t extends uA{constructor(e){super(),this.doc=e,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(e){for(const o of this.hostNodes)this.addStyleToHost(o,e)}onStyleRemoved(e){const o=this.styleRef;o.get(e)?.forEach(s=>s.remove()),o.delete(e)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const o of this.getAllStyles())this.addStyleToHost(e,o)}removeHost(e){this.hostNodes.delete(e)}addStyleToHost(e,o){const r=this.doc.createElement("style");r.textContent=o,e.appendChild(r);const s=this.styleRef.get(o);s?s.push(r):this.styleRef.set(o,[r])}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}}return t.\u0275fac=function(e){return new(e||t)(Rt(lo))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();const YE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},QE=/%COMP%/g,pA=new sn("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function fA(t,n){return n.flat(100).map(e=>e.replace(QE,t))}function mA(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let S1=(()=>{class t{constructor(e,o,r,s){this.eventManager=e,this.sharedStylesHost=o,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new JE(e)}createRenderer(e,o){if(!e||!o)return this.defaultRenderer;const r=this.getOrCreateRenderer(e,o);return r instanceof yA?r.applyToHost(e):r instanceof eS&&r.applyStyles(),r}getOrCreateRenderer(e,o){const r=this.rendererByCompId;let s=r.get(o.id);if(!s){const l=this.eventManager,h=this.sharedStylesHost,g=this.removeStylesOnCompDestory;switch(o.encapsulation){case Ys.Emulated:s=new yA(l,h,o,this.appId,g);break;case Ys.ShadowDom:return new UU(l,h,e,o);default:s=new eS(l,h,o,g)}s.onDestroy=()=>r.delete(o.id),r.set(o.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Rt(E1),Rt(lb),Rt(eb),Rt(pA))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();class JE{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(YE[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){(_A(n)?n.content:n).appendChild(e)}insertBefore(n,e,o){n&&(_A(n)?n.content:n).insertBefore(e,o)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let o="string"==typeof n?document.querySelector(n):n;if(!o)throw new Error(`The selector "${n}" did not match any elements`);return e||(o.textContent=""),o}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,o,r){if(r){e=r+":"+e;const s=YE[r];s?n.setAttributeNS(s,e,o):n.setAttribute(e,o)}else n.setAttribute(e,o)}removeAttribute(n,e,o){if(o){const r=YE[o];r?n.removeAttributeNS(r,e):n.removeAttribute(`${o}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,o,r){r&(wo.DashCase|wo.Important)?n.style.setProperty(e,o,r&wo.Important?"important":""):n.style[e]=o}removeStyle(n,e,o){o&wo.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,o){n[e]=o}setValue(n,e){n.nodeValue=e}listen(n,e,o){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,mA(o)):this.eventManager.addEventListener(n,e,mA(o))}}function _A(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class UU extends JE{constructor(n,e,o,r){super(n),this.sharedStylesHost=e,this.hostEl=o,this.shadowRoot=o.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=fA(r.id,r.styles);for(const l of s){const h=document.createElement("style");h.textContent=l,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,o){return super.insertBefore(this.nodeOrShadowRoot(n),e,o)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class eS extends JE{constructor(n,e,o,r,s=o.id){super(n),this.sharedStylesHost=e,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=fA(s,o.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class yA extends eS{constructor(n,e,o,r,s){const l=r+"-"+o.id;super(n,e,o,s,l),this.contentAttr=function NU(t){return"_ngcontent-%COMP%".replace(QE,t)}(l),this.hostAttr=function BU(t){return"_nghost-%COMP%".replace(QE,t)}(l)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const o=super.createElement(n,e);return super.setAttribute(o,this.contentAttr,""),o}}let jU=(()=>{class t extends cA{constructor(e){super(e)}supports(e){return!0}addEventListener(e,o,r){return e.addEventListener(o,r,!1),()=>this.removeEventListener(e,o,r)}removeEventListener(e,o,r){return e.removeEventListener(o,r)}}return t.\u0275fac=function(e){return new(e||t)(Rt(lo))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();const vA=["alt","control","meta","shift"],HU={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},$U={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let GU=(()=>{class t extends cA{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,o,r){const s=t.parseEventName(o),l=t.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Sh().onAndCancel(e,s.domEventName,l))}static parseEventName(e){const o=e.toLowerCase().split("."),r=o.shift();if(0===o.length||"keydown"!==r&&"keyup"!==r)return null;const s=t._normalizeKey(o.pop());let l="",h=o.indexOf("code");if(h>-1&&(o.splice(h,1),l="code."),vA.forEach(b=>{const T=o.indexOf(b);T>-1&&(o.splice(T,1),l+=b+".")}),l+=s,0!=o.length||0===s.length)return null;const g={};return g.domEventName=r,g.fullKey=l,g}static matchEventFullKeyCode(e,o){let r=HU[e.key]||e.key,s="";return o.indexOf("code.")>-1&&(r=e.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),vA.forEach(l=>{l!==r&&(0,$U[l])(e)&&(s+=l+".")}),s+=r,s===o)}static eventCallback(e,o,r){return s=>{t.matchEventFullKeyCode(s,e)&&r.runGuarded(()=>o(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(Rt(lo))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();const KU=gk(EV,"browser",[{provide:r1,useValue:tA},{provide:rk,useValue:function WU(){XE.makeCurrent()},multi:!0},{provide:lo,useFactory:function ZU(){return function qC(t){ev=t}(document),document},deps:[]}]),wA=new sn(""),CA=[{provide:s1,useClass:class OU{addToWindow(n){bo.getAngularTestability=(o,r=!0)=>{const s=n.findTestabilityInTree(o,r);if(null==s)throw new Error("Could not find testability for element.");return s},bo.getAllAngularTestabilities=()=>n.getAllTestabilities(),bo.getAllAngularRootElements=()=>n.getAllRootElements(),bo.frameworkStabilizers||(bo.frameworkStabilizers=[]),bo.frameworkStabilizers.push(o=>{const r=bo.getAllAngularTestabilities();let s=r.length,l=!1;const h=function(g){l=l||g,s--,0==s&&o(l)};r.forEach(function(g){g.whenStable(h)})})}findTestabilityInTree(n,e,o){return null==e?null:n.getTestability(e)??(o?Sh().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:dk,useClass:wE,deps:[fi,CE,s1]},{provide:wE,useClass:wE,deps:[fi,CE,s1]}],TA=[{provide:td,useValue:"root"},{provide:ec,useFactory:function qU(){return new ec},deps:[]},{provide:T1,useClass:jU,multi:!0,deps:[lo,fi,r1]},{provide:T1,useClass:GU,multi:!0,deps:[lo]},{provide:S1,useClass:S1,deps:[E1,lb,eb,pA]},{provide:Tm,useExisting:S1},{provide:uA,useExisting:lb},{provide:lb,useClass:lb,deps:[lo]},{provide:E1,useClass:E1,deps:[T1,fi]},{provide:iA,useClass:RU,deps:[]},[]];let EA=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:eb,useValue:e.appId},{provide:lA,useExisting:eb},PU]}}}return t.\u0275fac=function(e){return new(e||t)(Rt(wA,12))},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({providers:[...TA,...CA],imports:[Ei,SV]}),t})(),SA=(()=>{class t{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return t.\u0275fac=function(e){return new(e||t)(Rt(lo))},t.\u0275prov=an({token:t,factory:function(e){let o=null;return o=e?new e:function YU(){return new SA(Rt(lo))}(),o},providedIn:"root"}),t})();typeof window<"u"&&window;let D1=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:function(e){let o=null;return o=e?new(e||t):Rt(IA),o},providedIn:"root"}),t})(),IA=(()=>{class t extends D1{constructor(e){super(),this._doc=e}sanitize(e,o){if(null==o)return null;switch(e){case po.NONE:return o;case po.HTML:return Yl(o,"HTML")?Us(o):gh(this._doc,String(o)).toString();case po.STYLE:return Yl(o,"Style")?Us(o):o;case po.SCRIPT:if(Yl(o,"Script"))return Us(o);throw new Error("unsafe value used in a script context");case po.URL:return Yl(o,"URL")?Us(o):kp(String(o));case po.RESOURCE_URL:if(Yl(o,"ResourceURL"))return Us(o);throw new Error(`unsafe value used in a resource URL context (see ${Ar})`);default:throw new Error(`Unexpected SecurityContext ${e} (see ${Ar})`)}}bypassSecurityTrustHtml(e){return function JC(t){return new ZC(t)}(e)}bypassSecurityTrustStyle(e){return function Xo(t){return new KC(t)}(e)}bypassSecurityTrustScript(e){return function i_(t){return new XC(t)}(e)}bypassSecurityTrustUrl(e){return function q0(t){return new YC(t)}(e)}bypassSecurityTrustResourceUrl(e){return function o_(t){return new QC(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)(Rt(lo))},t.\u0275prov=an({token:t,factory:function(e){let o=null;return o=e?new e:function nj(t){return new IA(t.get(lo))}(Rt(Ds)),o},providedIn:"root"}),t})();const{isArray:ij}=Array,{getPrototypeOf:oj,prototype:rj,keys:sj}=Object;function kA(t){if(1===t.length){const n=t[0];if(ij(n))return{args:n,keys:null};if(function aj(t){return t&&"object"==typeof t&&oj(t)===rj}(n)){const e=sj(n);return{args:e.map(o=>n[o]),keys:e}}}return{args:t,keys:null}}const{isArray:lj}=Array;function iS(t){return Nn(n=>function cj(t,n){return lj(n)?t(...n):t(n)}(t,n))}function AA(t,n){return t.reduce((e,o,r)=>(e[o]=n[r],e),{})}function PA(...t){const n=On(t),{args:e,keys:o}=kA(t),r=new Jn(s=>{const{length:l}=e;if(!l)return void s.complete();const h=new Array(l);let g=l,b=l;for(let T=0;T<l;T++){let I=!1;ne(e[T]).subscribe(Yn(s,R=>{I||(I=!0,b--),h[T]=R},()=>g--,void 0,()=>{(!g||!I)&&(b||s.next(o?AA(o,h):h),s.complete())}))}});return n?r.pipe(iS(n)):r}let OA=(()=>{class t{constructor(e,o){this._renderer=e,this._elementRef=o,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,o){this._renderer.setProperty(this._elementRef.nativeElement,e,o)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(be(jr),be(si))},t.\u0275dir=kn({type:t}),t})(),Zm=(()=>{class t extends OA{}return t.\u0275fac=function(){let n;return function(o){return(n||(n=Cr(t)))(o||t)}}(),t.\u0275dir=kn({type:t,features:[Li]}),t})();const ks=new sn("NgValueAccessor"),dj={provide:ks,useExisting:xi(()=>dd),multi:!0},pj=new sn("CompositionEventMode");let dd=(()=>{class t extends OA{constructor(e,o,r){super(e,o),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function hj(){const t=Sh()?Sh().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(be(jr),be(si),be(pj,8))},t.\u0275dir=kn({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,o){1&e&&Oe("input",function(s){return o._handleInput(s.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(s){return o._compositionEnd(s.target.value)})},features:[Wi([dj]),Li]}),t})();const fj=!1;function Yp(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function LA(t){return null!=t&&"number"==typeof t.length}const la=new sn("NgValidators"),Qp=new sn("NgAsyncValidators"),mj=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ms{static min(n){return function FA(t){return n=>{if(Yp(n.value)||Yp(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(n)}static max(n){return function zA(t){return n=>{if(Yp(n.value)||Yp(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(n)}static required(n){return function NA(t){return Yp(t.value)?{required:!0}:null}(n)}static requiredTrue(n){return function BA(t){return!0===t.value?null:{required:!0}}(n)}static email(n){return function VA(t){return Yp(t.value)||mj.test(t.value)?null:{email:!0}}(n)}static minLength(n){return function UA(t){return n=>Yp(n.value)||!LA(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(n)}static maxLength(n){return function jA(t){return n=>LA(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(n)}static pattern(n){return function HA(t){if(!t)return M1;let n,e;return"string"==typeof t?(e="","^"!==t.charAt(0)&&(e+="^"),e+=t,"$"!==t.charAt(t.length-1)&&(e+="$"),n=new RegExp(e)):(e=t.toString(),n=t),o=>{if(Yp(o.value))return null;const r=o.value;return n.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}(n)}static nullValidator(n){return null}static compose(n){return KA(n)}static composeAsync(n){return XA(n)}}function M1(t){return null}function $A(t){return null!=t}function GA(t){const n=fr(t)?Wo(t):t;if(fj&&!mr(n)){let e="Expected async validator to return Promise or Observable.";throw"object"==typeof t&&(e+=" Are you using a synchronous validator where an async validator is expected?"),new Dt(-1101,e)}return n}function WA(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function qA(t,n){return n.map(e=>e(t))}function ZA(t){return t.map(n=>function gj(t){return!t.validate}(n)?n:e=>n.validate(e))}function KA(t){if(!t)return null;const n=t.filter($A);return 0==n.length?null:function(e){return WA(qA(e,n))}}function oS(t){return null!=t?KA(ZA(t)):null}function XA(t){if(!t)return null;const n=t.filter($A);return 0==n.length?null:function(e){return PA(qA(e,n).map(GA)).pipe(Nn(WA))}}function rS(t){return null!=t?XA(ZA(t)):null}function YA(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function QA(t){return t._rawValidators}function JA(t){return t._rawAsyncValidators}function sS(t){return t?Array.isArray(t)?t:[t]:[]}function I1(t,n){return Array.isArray(t)?t.includes(n):t===n}function eP(t,n){const e=sS(n);return sS(t).forEach(r=>{I1(e,r)||e.push(r)}),e}function tP(t,n){return sS(n).filter(e=>!I1(t,e))}class nP{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=oS(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=rS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Pa extends nP{get formDirective(){return null}get path(){return null}}class Jp extends nP{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class iP{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Tl=(()=>{class t extends iP{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(be(Jp,2))},t.\u0275dir=kn({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,o){2&e&&Mo("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[Li]}),t})(),ef=(()=>{class t extends iP{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(be(Pa,10))},t.\u0275dir=kn({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,o){2&e&&Mo("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[Li]}),t})();function oP(t,n){return t?`with name: '${n}'`:`at index: ${n}`}const cS=!1,cb="VALID",A1="INVALID",H_="PENDING",ub="DISABLED";function uS(t){return(P1(t)?t.validators:t)||null}function dS(t,n){return(P1(n)?n.asyncValidators:t)||null}function P1(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}function rP(t,n,e){const o=t.controls;if(!(n?Object.keys(o):o).length)throw new Dt(1e3,cS?function bj(t){return`\n    There are no form controls registered with this ${t?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(n):"");if(!o[e])throw new Dt(1001,cS?function xj(t,n){return`Cannot find form control ${oP(t,n)}`}(n,e):"")}function sP(t,n,e){t._forEachChild((o,r)=>{if(void 0===e[r])throw new Dt(1002,cS?function wj(t,n){return`Must supply a value for form control ${oP(t,n)}`}(n,r):"")})}class O1{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===cb}get invalid(){return this.status===A1}get pending(){return this.status==H_}get disabled(){return this.status===ub}get enabled(){return this.status!==ub}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(eP(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(eP(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(tP(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(tP(n,this._rawAsyncValidators))}hasValidator(n){return I1(this._rawValidators,n)}hasAsyncValidator(n){return I1(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=H_,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=ub,this.errors=null,this._forEachChild(o=>{o.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(o=>o(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=cb,this._forEachChild(o=>{o.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(o=>o(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===cb||this.status===H_)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ub:cb}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=H_,this._hasOwnPendingAsyncValidator=!0;const e=GA(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(o=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(o,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((o,r)=>o&&o._find(r),this)}getError(n,e){const o=e?this.get(e):this;return o&&o.errors?o.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Tt,this.statusChanges=new Tt}_calculateStatus(){return this._allControlsDisabled()?ub:this.errors?A1:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(H_)?H_:this._anyControlsHaveStatus(A1)?A1:cb}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){P1(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function Cj(t){return Array.isArray(t)?oS(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function Tj(t){return Array.isArray(t)?rS(t):t||null}(this._rawAsyncValidators)}}class tl extends O1{constructor(n,e,o){super(uS(e),dS(o,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,o={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,o={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){sP(this,!0,n),Object.keys(n).forEach(o=>{rP(this,!0,o),this.controls[o].setValue(n[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(o=>{const r=this.controls[o];r&&r.patchValue(n[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((o,r)=>{o.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,o)=>(n[o]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,o)=>!!o._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const o=this.controls[e];o&&n(o,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,o]of Object.entries(this.controls))if(this.contains(e)&&n(o))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,o,r)=>((o.enabled||this.disabled)&&(e[r]=o.value),e))}_reduceChildren(n,e){let o=n;return this._forEachChild((r,s)=>{o=e(o,r,s)}),o}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}class aP extends tl{}const Km=new sn("CallSetDisabledState",{providedIn:"root",factory:()=>db}),db="always";function R1(t,n){return[...n.path,t]}function hb(t,n,e=db){hS(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function Sj(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&lP(t,n)})}(t,n),function Mj(t,n){const e=(o,r)=>{n.valueAccessor.writeValue(o),r&&n.viewToModelUpdate(o)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function Dj(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&lP(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function Ej(t,n){if(n.valueAccessor.setDisabledState){const e=o=>{n.valueAccessor.setDisabledState(o)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function L1(t,n,e=!0){const o=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(o),n.valueAccessor.registerOnTouched(o)),z1(t,n),t&&(n._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function F1(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function hS(t,n){const e=QA(t);null!==n.validator?t.setValidators(YA(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const o=JA(t);null!==n.asyncValidator?t.setAsyncValidators(YA(o,n.asyncValidator)):"function"==typeof o&&t.setAsyncValidators([o]);const r=()=>t.updateValueAndValidity();F1(n._rawValidators,r),F1(n._rawAsyncValidators,r)}function z1(t,n){let e=!1;if(null!==t){if(null!==n.validator){const r=QA(t);if(Array.isArray(r)&&r.length>0){const s=r.filter(l=>l!==n.validator);s.length!==r.length&&(e=!0,t.setValidators(s))}}if(null!==n.asyncValidator){const r=JA(t);if(Array.isArray(r)&&r.length>0){const s=r.filter(l=>l!==n.asyncValidator);s.length!==r.length&&(e=!0,t.setAsyncValidators(s))}}}const o=()=>{};return F1(n._rawValidators,o),F1(n._rawAsyncValidators,o),e}function lP(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function fS(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}function mS(t,n){if(!n)return null;let e,o,r;return Array.isArray(n),n.forEach(s=>{s.constructor===dd?e=s:function Aj(t){return Object.getPrototypeOf(t.constructor)===Zm}(s)?o=s:r=s}),r||o||e||null}function dP(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function hP(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const gs=class extends O1{constructor(n=null,e,o){super(uS(e),dS(o,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),P1(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=hP(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(o=>o(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){dP(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){dP(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){hP(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},Fj={provide:Jp,useExisting:xi(()=>hd)},mP=(()=>Promise.resolve())();let hd=(()=>{class t extends Jp{constructor(e,o,r,s,l,h){super(),this._changeDetectorRef=l,this.callSetDisabledState=h,this.control=new gs,this._registered=!1,this.update=new Tt,this._parent=e,this._setValidators(o),this._setAsyncValidators(r),this.valueAccessor=mS(0,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const o=e.name.previousValue;this.formDirective.removeControl({name:o,path:this._getPath(o)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),fS(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){hb(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){mP.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const o=e.isDisabled.currentValue,r=0!==o&&j_(o);mP.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?R1(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(be(Pa,9),be(la,10),be(Qp,10),be(ks,10),be(Po,8),be(Km,8))},t.\u0275dir=kn({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Wi([Fj]),Li,ur]}),t})(),tf=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=kn({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})(),_P=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({}),t})();const _S=new sn("NgModelWithFormControlWarning"),jj={provide:Pa,useExisting:xi(()=>pd)};let pd=(()=>{class t extends Pa{constructor(e,o,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Tt,this._setValidators(e),this._setAsyncValidators(o)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(z1(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const o=this.form.get(e.path);return hb(o,e,this.callSetDisabledState),o.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),o}getControl(e){return this.form.get(e.path)}removeControl(e){L1(e.control||null,e,!1),function Pj(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,o){this.form.get(e.path).setValue(o)}onSubmit(e){return this.submitted=!0,function uP(t,n){t._syncPendingControls(),n.forEach(e=>{const o=e.control;"submit"===o.updateOn&&o._pendingChange&&(e.viewToModelUpdate(o._pendingValue),o._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const o=e.control,r=this.form.get(e.path);o!==r&&(L1(o||null,e),(t=>t instanceof gs)(r)&&(hb(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const o=this.form.get(e.path);(function cP(t,n){hS(t,n)})(o,e),o.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const o=this.form.get(e.path);o&&function Ij(t,n){return z1(t,n)}(o,e)&&o.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){hS(this.form,this),this._oldForm&&z1(this._oldForm,this)}_checkFormPresent(){}}return t.\u0275fac=function(e){return new(e||t)(be(la,10),be(Qp,10),be(Km,8))},t.\u0275dir=kn({type:t,selectors:[["","formGroup",""]],hostBindings:function(e,o){1&e&&Oe("submit",function(s){return o.onSubmit(s)})("reset",function(){return o.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Wi([jj]),Li,ur]}),t})();const Gj={provide:Jp,useExisting:xi(()=>nf)};let nf=(()=>{class t extends Jp{set isDisabled(e){}constructor(e,o,r,s,l){super(),this._ngModelWarningConfig=l,this._added=!1,this.update=new Tt,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(o),this._setAsyncValidators(r),this.valueAccessor=mS(0,s)}ngOnChanges(e){this._added||this._setUpControl(),fS(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return R1(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return t._ngModelWarningSentOnce=!1,t.\u0275fac=function(e){return new(e||t)(be(Pa,13),be(la,10),be(Qp,10),be(ks,10),be(_S,8))},t.\u0275dir=kn({type:t,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Wi([Gj]),Li,ur]}),t})(),OP=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[_P]}),t})();class RP extends O1{constructor(n,e,o){super(uS(e),dS(o,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,e={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,o={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:o.emitEvent})}removeAt(n,e={}){let o=this._adjustIndex(n);o<0&&(o=0),this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),this.controls.splice(o,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,o={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),e&&(this.controls.splice(r,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){sP(this,!1,n),n.forEach((o,r)=>{rP(this,!1,r),this.at(r).setValue(o,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(n.forEach((o,r)=>{this.at(r)&&this.at(r).patchValue(o,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((o,r)=>{o.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((e,o)=>!!o._syncPendingControls()||e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,o)=>{n(e,o)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}}function LP(t){return!!t&&(void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn)}let CS,a6=(()=>{class t{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new t;return e.useNonNullable=!0,e}group(e,o=null){const r=this._reduceControls(e);let s={};return LP(o)?s=o:null!==o&&(s.validators=o.validator,s.asyncValidators=o.asyncValidator),new tl(r,s)}record(e,o=null){const r=this._reduceControls(e);return new aP(r,o)}control(e,o,r){let s={};return this.useNonNullable?(LP(o)?s=o:(s.validators=o,s.asyncValidators=r),new gs(e,{...s,nonNullable:!0})):new gs(e,o,r)}array(e,o,r){const s=e.map(l=>this._createControl(l));return new RP(s,o,r)}_reduceControls(e){const o={};return Object.keys(e).forEach(r=>{o[r]=this._createControl(e[r])}),o}_createControl(e){return e instanceof gs||e instanceof O1?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),$_=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Km,useValue:e.callSetDisabledState??db}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[OP]}),t})(),FP=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:_S,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:Km,useValue:e.callSetDisabledState??db}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[OP]}),t})();try{CS=typeof Intl<"u"&&Intl.v8BreakIterator}catch{CS=!1}let fb,B1,Ym,TS,rc=(()=>{class t{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function Q5(t){return t===tA}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!CS)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.\u0275fac=function(e){return new(e||t)(Rt(r1))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function N1(t){return function l6(){if(null==fb&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>fb=!0}))}finally{fb=fb||!1}return fb}()?t:!!t.capture}function mb(){if("object"!=typeof document||!document)return 0;if(null==B1){const t=document.createElement("div"),n=t.style;t.dir="rtl",n.width="1px",n.overflow="auto",n.visibility="hidden",n.pointerEvents="none",n.position="absolute";const e=document.createElement("div"),o=e.style;o.width="2px",o.height="1px",t.appendChild(e),document.body.appendChild(t),B1=0,0===t.scrollLeft&&(t.scrollLeft=1,B1=0===t.scrollLeft?1:2),t.remove()}return B1}function W_(t){return t.composedPath?t.composedPath()[0]:t.target}class sc extends gi{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:o}=this;if(n)throw e;return this._throwIfClosed(),o}next(n){super.next(this._value=n)}}function Gn(...t){return Wo(t,Vi(t))}function fd(t){return t<=0?()=>dn:ji((n,e)=>{let o=0;n.subscribe(Yn(e,r=>{++o<=t&&(e.next(r),t<=o&&e.complete())}))})}function $s(t,n){return ji((e,o)=>{let r=0;e.subscribe(Yn(o,s=>t.call(n,s,r++)&&o.next(s)))})}function NP(t){return $s((n,e)=>t<=e)}function BP(t,n=lr){return t=t??b6,ji((e,o)=>{let r,s=!0;e.subscribe(Yn(o,l=>{const h=n(l);(s||!t(r,h))&&(s=!1,r=h,o.next(l))}))})}function b6(t,n){return t===n}function ac(t){return ji((n,e)=>{ne(t).subscribe(Yn(e,()=>e.complete(),Kt)),!e.closed&&n.subscribe(e)})}function du(t){return null!=t&&"false"!=`${t}`}function VP(t,n=0){return function x6(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):n}function UP(t){return Array.isArray(t)?t:[t]}function q_(t){return t instanceof si?t.nativeElement:t}function ES(...t){const n=Vi(t),e=On(t),{args:o,keys:r}=kA(t);if(0===o.length)return Wo([],n);const s=new Jn(function w6(t,n,e=lr){return o=>{jP(n,()=>{const{length:r}=t,s=new Array(r);let l=r,h=r;for(let g=0;g<r;g++)jP(n,()=>{const b=Wo(t[g],n);let T=!1;b.subscribe(Yn(o,I=>{s[g]=I,T||(T=!0,h--),h||o.next(e(s.slice()))},()=>{--l||o.complete()}))},o)},o)}}(o,n,r?l=>AA(r,l):lr));return e?s.pipe(iS(e)):s}function jP(t,n,e){t?wt(e,t,n):n()}function V1(...t){return function C6(){return Sn(1)}()(Wo(t,Vi(t)))}class T6 extends re{constructor(n,e){super()}schedule(n,e=0){return this}}const U1={setInterval(t,n,...e){const{delegate:o}=U1;return o?.setInterval?o.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=U1;return(n?.clearInterval||clearInterval)(t)},delegate:void 0};class SS extends T6{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var o;if(this.closed)return this;this.state=n;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,e)),this.pending=!0,this.delay=e,this.id=null!==(o=this.id)&&void 0!==o?o:this.requestAsyncId(s,this.id,e),this}requestAsyncId(n,e,o=0){return U1.setInterval(n.flush.bind(n,this),o)}recycleAsyncId(n,e,o=0){if(null!=o&&this.delay===o&&!1===this.pending)return e;null!=e&&U1.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const o=this._execute(n,e);if(o)return o;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r,o=!1;try{this.work(n)}catch(s){o=!0,r=s||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:o}=e;this.work=this.state=this.scheduler=null,this.pending=!1,m(o,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}const HP={now:()=>(HP.delegate||Date).now(),delegate:void 0};class gb{constructor(n,e=gb.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,o){return new this.schedulerActionCtor(this,n).schedule(o,e)}}gb.now=HP.now;class DS extends gb{constructor(n,e=gb.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let o;this._active=!0;do{if(o=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,o){for(;n=e.shift();)n.unsubscribe();throw o}}}const MS=new DS(SS),E6=MS;function $P(t,n=MS){return ji((e,o)=>{let r=null,s=null,l=null;const h=()=>{if(r){r.unsubscribe(),r=null;const b=s;s=null,o.next(b)}};function g(){const b=l+t,T=n.now();if(T<b)return r=this.schedule(void 0,b-T),void o.add(r);h()}e.subscribe(Yn(o,b=>{s=b,l=n.now(),r||(r=n.schedule(g,t),o.add(r))},()=>{h(),o.complete()},void 0,()=>{s=r=null}))})}function j1(...t){const n=Vi(t);return ji((e,o)=>{(n?V1(t,e,n):V1(t,e)).subscribe(o)})}const GP=new Set;let Z_,S6=(()=>{class t{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):M6}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function D6(t){if(!GP.has(t))try{Z_||(Z_=document.createElement("style"),Z_.setAttribute("type","text/css"),document.head.appendChild(Z_)),Z_.sheet&&(Z_.sheet.insertRule(`@media ${t} {body{ }}`,0),GP.add(t))}catch(n){console.error(n)}}(e),this._matchMedia(e)}}return t.\u0275fac=function(e){return new(e||t)(Rt(rc))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function M6(t){return{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{}}}let I6=(()=>{class t{constructor(e,o){this._mediaMatcher=e,this._zone=o,this._queries=new Map,this._destroySubject=new gi}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return WP(UP(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let s=ES(WP(UP(e)).map(l=>this._registerQuery(l).observable));return s=V1(s.pipe(fd(1)),s.pipe(NP(1),$P(0))),s.pipe(Nn(l=>{const h={matches:!1,breakpoints:{}};return l.forEach(({matches:g,query:b})=>{h.matches=h.matches||g,h.breakpoints[b]=g}),h}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const o=this._mediaMatcher.matchMedia(e),s={observable:new Jn(l=>{const h=g=>this._zone.run(()=>l.next(g));return o.addListener(h),()=>{o.removeListener(h)}}).pipe(j1(o),Nn(({matches:l})=>({query:e,matches:l})),ac(this._destroySubject)),mql:o};return this._queries.set(e,s),s}}return t.\u0275fac=function(e){return new(e||t)(Rt(S6),Rt(fi))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function WP(t){return t.map(n=>n.split(",")).reduce((n,e)=>n.concat(e)).map(n=>n.trim())}let KP=(()=>{class t{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function O6(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const o=function P6(t){try{return t.frameElement}catch{return null}}(function U6(t){return t.ownerDocument&&t.ownerDocument.defaultView||window}(e));if(o&&(-1===YP(o)||!this.isVisible(o)))return!1;let r=e.nodeName.toLowerCase(),s=YP(e);return e.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function B6(t){let n=t.nodeName.toLowerCase(),e="input"===n&&t.type;return"text"===e||"password"===e||"select"===n||"textarea"===n}(e))&&("audio"===r?!!e.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,o){return function V6(t){return!function L6(t){return function z6(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function R6(t){let n=t.nodeName.toLowerCase();return"input"===n||"select"===n||"button"===n||"textarea"===n}(t)||function F6(t){return function N6(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||XP(t))}(e)&&!this.isDisabled(e)&&(o?.ignoreVisibility||this.isVisible(e))}}return t.\u0275fac=function(e){return new(e||t)(Rt(rc))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function XP(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let n=t.getAttribute("tabindex");return!(!n||isNaN(parseInt(n,10)))}function YP(t){if(!XP(t))return null;const n=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(n)?-1:n}class j6{get enabled(){return this._enabled}set enabled(n){this._enabled=n,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}constructor(n,e,o,r,s=!1){this._element=n,this._checker=e,this._ngZone=o,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const n=this._startAnchor,e=this._endAnchor;n&&(n.removeEventListener("focus",this.startAnchorListener),n.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(n)))})}focusFirstTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(n)))})}focusLastTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(n)))})}_getRegionBoundary(n){const e=this._element.querySelectorAll(`[cdk-focus-region-${n}], [cdkFocusRegion${n}], [cdk-focus-${n}]`);return"start"==n?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(n){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const o=this._getFirstTabbableElement(e);return o?.focus(n),!!o}return e.focus(n),!0}return this.focusFirstTabbableElement(n)}focusFirstTabbableElement(n){const e=this._getRegionBoundary("start");return e&&e.focus(n),!!e}focusLastTabbableElement(n){const e=this._getRegionBoundary("end");return e&&e.focus(n),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let o=0;o<e.length;o++){const r=e[o].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[o]):null;if(r)return r}return null}_getLastTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let o=e.length-1;o>=0;o--){const r=e[o].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[o]):null;if(r)return r}return null}_createAnchor(){const n=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,n),n.classList.add("cdk-visually-hidden"),n.classList.add("cdk-focus-trap-anchor"),n.setAttribute("aria-hidden","true"),n}_toggleAnchorTabIndex(n,e){n?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(n){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_executeOnStable(n){this._ngZone.isStable?n():this._ngZone.onStable.pipe(fd(1)).subscribe(n)}}let H6=(()=>{class t{constructor(e,o,r){this._checker=e,this._ngZone=o,this._document=r}create(e,o=!1){return new j6(e,this._checker,this._ngZone,this._document,o)}}return t.\u0275fac=function(e){return new(e||t)(Rt(KP),Rt(fi),Rt(lo))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function QP(t){return 0===t.buttons||0===t.offsetX&&0===t.offsetY}function JP(t){const n=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}const $6=new sn("cdk-input-modality-detector-options"),G6={ignoreKeys:[18,17,224,91,16]},K_=N1({passive:!0,capture:!0});let W6=(()=>{class t{get mostRecentModality(){return this._modality.value}constructor(e,o,r,s){this._platform=e,this._mostRecentTarget=null,this._modality=new sc(null),this._lastTouchMs=0,this._onKeydown=l=>{this._options?.ignoreKeys?.some(h=>h===l.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=W_(l))},this._onMousedown=l=>{Date.now()-this._lastTouchMs<650||(this._modality.next(QP(l)?"keyboard":"mouse"),this._mostRecentTarget=W_(l))},this._onTouchstart=l=>{JP(l)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=W_(l))},this._options={...G6,...s},this.modalityDetected=this._modality.pipe(NP(1)),this.modalityChanged=this.modalityDetected.pipe(BP()),e.isBrowser&&o.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,K_),r.addEventListener("mousedown",this._onMousedown,K_),r.addEventListener("touchstart",this._onTouchstart,K_)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,K_),document.removeEventListener("mousedown",this._onMousedown,K_),document.removeEventListener("touchstart",this._onTouchstart,K_))}}return t.\u0275fac=function(e){return new(e||t)(Rt(rc),Rt(fi),Rt(lo),Rt($6,8))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Z6=new sn("cdk-focus-monitor-default-options"),H1=N1({passive:!0,capture:!0});let tO=(()=>{class t{constructor(e,o,r,s,l){this._ngZone=e,this._platform=o,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new gi,this._rootNodeFocusAndBlurListener=h=>{for(let b=W_(h);b;b=b.parentElement)"focus"===h.type?this._onFocus(h,b):this._onBlur(h,b)},this._document=s,this._detectionMode=l?.detectionMode||0}monitor(e,o=!1){const r=q_(e);if(!this._platform.isBrowser||1!==r.nodeType)return Gn(null);const s=function d6(t){if(function u6(){if(null==TS){const t=typeof document<"u"?document.head:null;TS=!(!t||!t.createShadowRoot&&!t.attachShadow)}return TS}()){const n=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}(r)||this._getDocument(),l=this._elementInfo.get(r);if(l)return o&&(l.checkChildren=!0),l.subject;const h={checkChildren:o,subject:new gi,rootNode:s};return this._elementInfo.set(r,h),this._registerGlobalListeners(h),h.subject}stopMonitoring(e){const o=q_(e),r=this._elementInfo.get(o);r&&(r.subject.complete(),this._setClasses(o),this._elementInfo.delete(o),this._removeGlobalListeners(r))}focusVia(e,o,r){const s=q_(e);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([h,g])=>this._originChanged(h,o,g)):(this._setOrigin(o),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((e,o)=>this.stopMonitoring(o))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,o){e.classList.toggle("cdk-focused",!!o),e.classList.toggle("cdk-touch-focused","touch"===o),e.classList.toggle("cdk-keyboard-focused","keyboard"===o),e.classList.toggle("cdk-mouse-focused","mouse"===o),e.classList.toggle("cdk-program-focused","program"===o)}_setOrigin(e,o=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&o,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,o){const r=this._elementInfo.get(o),s=W_(e);!r||!r.checkChildren&&o!==s||this._originChanged(o,this._getFocusOrigin(s),r)}_onBlur(e,o){const r=this._elementInfo.get(o);!r||r.checkChildren&&e.relatedTarget instanceof Node&&o.contains(e.relatedTarget)||(this._setClasses(o),this._emitOrigin(r,null))}_emitOrigin(e,o){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(o))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const o=e.rootNode,r=this._rootNodeFocusListenerCount.get(o)||0;r||this._ngZone.runOutsideAngular(()=>{o.addEventListener("focus",this._rootNodeFocusAndBlurListener,H1),o.addEventListener("blur",this._rootNodeFocusAndBlurListener,H1)}),this._rootNodeFocusListenerCount.set(o,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ac(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(e){const o=e.rootNode;if(this._rootNodeFocusListenerCount.has(o)){const r=this._rootNodeFocusListenerCount.get(o);r>1?this._rootNodeFocusListenerCount.set(o,r-1):(o.removeEventListener("focus",this._rootNodeFocusAndBlurListener,H1),o.removeEventListener("blur",this._rootNodeFocusAndBlurListener,H1),this._rootNodeFocusListenerCount.delete(o))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,o,r){this._setClasses(e,o),this._emitOrigin(r,o),this._lastFocusOrigin=o}_getClosestElementsInfo(e){const o=[];return this._elementInfo.forEach((r,s)=>{(s===e||r.checkChildren&&s.contains(e))&&o.push([s,r])}),o}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:o,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!o||o===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const s=e.labels;if(s)for(let l=0;l<s.length;l++)if(s[l].contains(o))return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)(Rt(fi),Rt(rc),Rt(W6),Rt(lo,8),Rt(Z6,8))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const nO="cdk-high-contrast-black-on-white",iO="cdk-high-contrast-white-on-black",IS="cdk-high-contrast-active";let K6=(()=>{class t{constructor(e,o){this._platform=e,this._document=o,this._breakpointSubscription=ti(I6).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const o=this._document.defaultView||window,r=o&&o.getComputedStyle?o.getComputedStyle(e):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(IS,nO,iO),this._hasCheckedHighContrastMode=!0;const o=this.getHighContrastMode();1===o?e.add(IS,nO):2===o&&e.add(IS,iO)}}}return t.\u0275fac=function(e){return new(e||t)(Rt(rc),Rt(lo))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const X6=new sn("cdk-dir-doc",{providedIn:"root",factory:function Y6(){return ti(lo)}}),Q6=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let oO=(()=>{class t{constructor(e){this.value="ltr",this.change=new Tt,e&&(this.value=function J6(t){const n=t?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?Q6.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return t.\u0275fac=function(e){return new(e||t)(Rt(X6,8))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),rO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({}),t})();const t8=new sn("mat-sanity-checks",{providedIn:"root",factory:function e8(){return!0}});let lc=(()=>{class t{constructor(e,o,r){this._sanityChecks=o,this._document=r,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!function h6(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return t.\u0275fac=function(e){return new(e||t)(Rt(K6),Rt(t8,8),Rt(lo))},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[rO,rO]}),t})();function n8(t){return class extends t{get disabled(){return this._disabled}set disabled(n){this._disabled=du(n)}constructor(...n){super(...n),this._disabled=!1}}}function kS(t,n){return class extends t{get color(){return this._color}set color(e){const o=e||this.defaultColor;o!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),o&&this._elementRef.nativeElement.classList.add(`mat-${o}`),this._color=o)}constructor(...e){super(...e),this.defaultColor=n,this.color=n}}}function o8(t){return class extends t{get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=du(n)}constructor(...n){super(...n),this._disableRipple=!1}}}class s8{constructor(n,e,o,r=!1){this._renderer=n,this.element=e,this.config=o,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const lO=N1({passive:!0,capture:!0});class a8{constructor(){this._events=new Map,this._delegateEventHandler=n=>{const e=W_(n);e&&this._events.get(n.type)?.forEach((o,r)=>{(r===e||r.contains(e))&&o.forEach(s=>s.handleEvent(n))})}}addHandler(n,e,o,r){const s=this._events.get(e);if(s){const l=s.get(o);l?l.add(r):s.set(o,new Set([r]))}else this._events.set(e,new Map([[o,new Set([r])]])),n.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,lO)})}removeHandler(n,e,o){const r=this._events.get(n);if(!r)return;const s=r.get(e);s&&(s.delete(o),0===s.size&&r.delete(e),0===r.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,lO)))}}const cO={enterDuration:225,exitDuration:150},uO=N1({passive:!0,capture:!0}),dO=["mousedown","touchstart"],hO=["mouseup","mouseleave","touchend","touchcancel"];class yb{constructor(n,e,o,r){this._target=n,this._ngZone=e,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=q_(o))}fadeInRipple(n,e,o={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...cO,...o.animation};o.centered&&(n=r.left+r.width/2,e=r.top+r.height/2);const l=o.radius||function c8(t,n,e){const o=Math.max(Math.abs(t-e.left),Math.abs(t-e.right)),r=Math.max(Math.abs(n-e.top),Math.abs(n-e.bottom));return Math.sqrt(o*o+r*r)}(n,e,r),h=n-r.left,g=e-r.top,b=s.enterDuration,T=document.createElement("div");T.classList.add("mat-ripple-element"),T.style.left=h-l+"px",T.style.top=g-l+"px",T.style.height=2*l+"px",T.style.width=2*l+"px",null!=o.color&&(T.style.backgroundColor=o.color),T.style.transitionDuration=`${b}ms`,this._containerElement.appendChild(T);const I=window.getComputedStyle(T),z=I.transitionDuration,W="none"===I.transitionProperty||"0s"===z||"0s, 0s"===z||0===r.width&&0===r.height,X=new s8(this,T,o,W);T.style.transform="scale3d(1, 1, 1)",X.state=0,o.persistent||(this._mostRecentTransientRipple=X);let ee=null;return!W&&(b||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const le=()=>this._finishRippleTransition(X),ve=()=>this._destroyRipple(X);T.addEventListener("transitionend",le),T.addEventListener("transitioncancel",ve),ee={onTransitionEnd:le,onTransitionCancel:ve}}),this._activeRipples.set(X,ee),(W||!b)&&this._finishRippleTransition(X),X}fadeOutRipple(n){if(2===n.state||3===n.state)return;const e=n.element,o={...cO,...n.config.animation};e.style.transitionDuration=`${o.exitDuration}ms`,e.style.opacity="0",n.state=2,(n._animationForciblyDisabledThroughCss||!o.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const e=q_(n);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,dO.forEach(o=>{yb._eventManager.addHandler(this._ngZone,o,e,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{hO.forEach(e=>{this._triggerElement.addEventListener(e,this,uO)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){0===n.state?this._startFadeOutTransition(n):2===n.state&&this._destroyRipple(n)}_startFadeOutTransition(n){const e=n===this._mostRecentTransientRipple,{persistent:o}=n.config;n.state=1,!o&&(!e||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const e=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=3,null!==e&&(n.element.removeEventListener("transitionend",e.onTransitionEnd),n.element.removeEventListener("transitioncancel",e.onTransitionCancel)),n.element.remove()}_onMousedown(n){const e=QP(n),o=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!o&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!JP(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=n.changedTouches;for(let o=0;o<e.length;o++)this.fadeInRipple(e[o].clientX,e[o].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(1===n.state||n.config.terminateOnPointerUp&&0===n.state)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(dO.forEach(e=>yb._eventManager.removeHandler(e,n,this)),this._pointerUpEventsRegistered&&hO.forEach(e=>n.removeEventListener(e,this,uO)))}}yb._eventManager=new a8;const u8=new sn("mat-ripple-global-options");let AS=(()=>{class t{get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}constructor(e,o,r,s,l){this._elementRef=e,this._animationMode=l,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new yb(this,o,e,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,o=0,r){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,o,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(fi),be(rc),be(u8,8),be(U_,8))},t.\u0275dir=kn({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,o){2&e&&Mo("mat-ripple-unbounded",o.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),t})(),d8=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[lc,lc]}),t})();function X_(t,n){const e=_t(t)?t:()=>t,o=r=>r.error(e());return new Jn(n?r=>n.schedule(o,0,r):o)}function _s(t,n,e){const o=_t(t)||n||e?{next:t,error:n,complete:e}:t;return o?ji((r,s)=>{var l;null===(l=o.subscribe)||void 0===l||l.call(o);let h=!0;r.subscribe(Yn(s,g=>{var b;null===(b=o.next)||void 0===b||b.call(o,g),s.next(g)},()=>{var g;h=!1,null===(g=o.complete)||void 0===g||g.call(o),s.complete()},g=>{var b;h=!1,null===(b=o.error)||void 0===b||b.call(o,g),s.error(g)},()=>{var g,b;h&&(null===(g=o.unsubscribe)||void 0===g||g.call(o)),null===(b=o.finalize)||void 0===b||b.call(o)}))}):lr}function Ih(t){return ji((n,e)=>{let s,o=null,r=!1;o=n.subscribe(Yn(e,void 0,void 0,l=>{s=ne(t(l,Ih(t)(n))),o?(o.unsubscribe(),o=null,s.subscribe(e)):r=!0})),r&&(o.unsubscribe(),o=null,s.subscribe(e))})}function $1(t){return ji((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}function rf(t,n){return _t(n)?St(t,n,1):St(t,1)}class G1{}class PS{}class kh{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?this.lazyInit="string"==typeof n?()=>{this.headers=new Map,n.split("\n").forEach(e=>{const o=e.indexOf(":");if(o>0){const r=e.slice(0,o),s=r.toLowerCase(),l=e.slice(o+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(l):this.headers.set(s,[l])}})}:()=>{this.headers=new Map,Object.keys(n).forEach(e=>{let o=n[e];const r=e.toLowerCase();"string"==typeof o&&(o=[o]),o.length>0&&(this.headers.set(r,o),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof kh?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){const e=new kh;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof kh?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){const e=n.name.toLowerCase();switch(n.op){case"a":case"s":let o=n.value;if("string"==typeof o&&(o=[o]),0===o.length)return;this.maybeSetNormalizedName(n.name,e);const r=("a"===n.op?this.headers.get(e):void 0)||[];r.push(...o),this.headers.set(e,r);break;case"d":const s=n.value;if(s){let l=this.headers.get(e);if(!l)return;l=l.filter(h=>-1===s.indexOf(h)),0===l.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,l)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}}class h8{encodeKey(n){return pO(n)}encodeValue(n){return pO(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const f8=/%(\d[a-f0-9])/gi,m8={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function pO(t){return encodeURIComponent(t).replace(f8,(n,e)=>m8[e]??n)}function W1(t){return`${t}`}class sf{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new h8,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function p8(t,n){const e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[l,h]=-1==s?[n.decodeKey(r),""]:[n.decodeKey(r.slice(0,s)),n.decodeValue(r.slice(s+1))],g=e.get(l)||[];g.push(h),e.set(l,g)}),e}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{const o=n.fromObject[e],r=Array.isArray(o)?o.map(W1):[W1(o)];this.map.set(e,r)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){const e=[];return Object.keys(n).forEach(o=>{const r=n[o];Array.isArray(r)?r.forEach(s=>{e.push({param:o,value:s,op:"a"})}):e.push({param:o,value:r,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const e=this.encoder.encodeKey(n);return this.map.get(n).map(o=>e+"="+this.encoder.encodeValue(o)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const e=new sf({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const e=("a"===n.op?this.map.get(n.param):void 0)||[];e.push(W1(n.value)),this.map.set(n.param,e);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let o=this.map.get(n.param)||[];const r=o.indexOf(W1(n.value));-1!==r&&o.splice(r,1),o.length>0?this.map.set(n.param,o):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class g8{constructor(){this.map=new Map}set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function fO(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function mO(t){return typeof Blob<"u"&&t instanceof Blob}function gO(t){return typeof FormData<"u"&&t instanceof FormData}class vb{constructor(n,e,o,r){let s;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function _8(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==o?o:null,s=r):s=o,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new kh),this.context||(this.context=new g8),this.params){const l=this.params.toString();if(0===l.length)this.urlWithParams=e;else{const h=e.indexOf("?");this.urlWithParams=e+(-1===h?"?":h<e.length-1?"&":"")+l}}else this.params=new sf,this.urlWithParams=e}serializeBody(){return null===this.body?null:fO(this.body)||mO(this.body)||gO(this.body)||function y8(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof sf?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||gO(this.body)?null:mO(this.body)?this.body.type||null:fO(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof sf?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const e=n.method||this.method,o=n.url||this.url,r=n.responseType||this.responseType,s=void 0!==n.body?n.body:this.body,l=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,h=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let g=n.headers||this.headers,b=n.params||this.params;const T=n.context??this.context;return void 0!==n.setHeaders&&(g=Object.keys(n.setHeaders).reduce((I,R)=>I.set(R,n.setHeaders[R]),g)),n.setParams&&(b=Object.keys(n.setParams).reduce((I,R)=>I.set(R,n.setParams[R]),b)),new vb(e,o,s,{params:b,headers:g,context:T,reportProgress:h,responseType:r,withCredentials:l})}}var yr=(()=>((yr=yr||{})[yr.Sent=0]="Sent",yr[yr.UploadProgress=1]="UploadProgress",yr[yr.ResponseHeader=2]="ResponseHeader",yr[yr.DownloadProgress=3]="DownloadProgress",yr[yr.Response=4]="Response",yr[yr.User=5]="User",yr))();class OS{constructor(n,e=200,o="OK"){this.headers=n.headers||new kh,this.status=void 0!==n.status?n.status:e,this.statusText=n.statusText||o,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class RS extends OS{constructor(n={}){super(n),this.type=yr.ResponseHeader}clone(n={}){return new RS({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class q1 extends OS{constructor(n={}){super(n),this.type=yr.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new q1({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class _O extends OS{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function LS(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let Z1=(()=>{class t{constructor(e){this.handler=e}request(e,o,r={}){let s;if(e instanceof vb)s=e;else{let g,b;g=r.headers instanceof kh?r.headers:new kh(r.headers),r.params&&(b=r.params instanceof sf?r.params:new sf({fromObject:r.params})),s=new vb(e,o,void 0!==r.body?r.body:null,{headers:g,context:r.context,params:b,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const l=Gn(s).pipe(rf(g=>this.handler.handle(g)));if(e instanceof vb||"events"===r.observe)return l;const h=l.pipe($s(g=>g instanceof q1));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return h.pipe(Nn(g=>{if(null!==g.body&&!(g.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return g.body}));case"blob":return h.pipe(Nn(g=>{if(null!==g.body&&!(g.body instanceof Blob))throw new Error("Response is not a Blob.");return g.body}));case"text":return h.pipe(Nn(g=>{if(null!==g.body&&"string"!=typeof g.body)throw new Error("Response is not a string.");return g.body}));default:return h.pipe(Nn(g=>g.body))}case"response":return h;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,o={}){return this.request("DELETE",e,o)}get(e,o={}){return this.request("GET",e,o)}head(e,o={}){return this.request("HEAD",e,o)}jsonp(e,o){return this.request("JSONP",e,{params:(new sf).append(o,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,o={}){return this.request("OPTIONS",e,o)}patch(e,o,r={}){return this.request("PATCH",e,LS(r,o))}post(e,o,r={}){return this.request("POST",e,LS(r,o))}put(e,o,r={}){return this.request("PUT",e,LS(r,o))}}return t.\u0275fac=function(e){return new(e||t)(Rt(G1))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();function yO(t,n){return n(t)}function v8(t,n){return(e,o)=>n.intercept(e,{handle:r=>t(r,o)})}const x8=new sn("HTTP_INTERCEPTORS"),bb=new sn("HTTP_INTERCEPTOR_FNS");function w8(){let t=null;return(n,e)=>(null===t&&(t=(ti(x8,{optional:!0})??[]).reduceRight(v8,yO)),t(n,e))}let vO=(()=>{class t extends G1{constructor(e,o){super(),this.backend=e,this.injector=o,this.chain=null}handle(e){if(null===this.chain){const o=Array.from(new Set(this.injector.get(bb)));this.chain=o.reduceRight((r,s)=>function b8(t,n,e){return(o,r)=>e.runInContext(()=>n(o,s=>t(s,r)))}(r,s,this.injector),yO)}return this.chain(e,o=>this.backend.handle(o))}}return t.\u0275fac=function(e){return new(e||t)(Rt(PS),Rt(Ql))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();const S8=/^\)\]\}',?\n/;let xO=(()=>{class t{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Jn(o=>{const r=this.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach((z,W)=>r.setRequestHeader(z,W.join(","))),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const z=e.detectContentTypeHeader();null!==z&&r.setRequestHeader("Content-Type",z)}if(e.responseType){const z=e.responseType.toLowerCase();r.responseType="json"!==z?z:"text"}const s=e.serializeBody();let l=null;const h=()=>{if(null!==l)return l;const z=r.statusText||"OK",W=new kh(r.getAllResponseHeaders()),X=function D8(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(r)||e.url;return l=new RS({headers:W,status:r.status,statusText:z,url:X}),l},g=()=>{let{headers:z,status:W,statusText:X,url:ee}=h(),le=null;204!==W&&(le=typeof r.response>"u"?r.responseText:r.response),0===W&&(W=le?200:0);let ve=W>=200&&W<300;if("json"===e.responseType&&"string"==typeof le){const xe=le;le=le.replace(S8,"");try{le=""!==le?JSON.parse(le):null}catch(Be){le=xe,ve&&(ve=!1,le={error:Be,text:le})}}ve?(o.next(new q1({body:le,headers:z,status:W,statusText:X,url:ee||void 0})),o.complete()):o.error(new _O({error:le,headers:z,status:W,statusText:X,url:ee||void 0}))},b=z=>{const{url:W}=h(),X=new _O({error:z,status:r.status||0,statusText:r.statusText||"Unknown Error",url:W||void 0});o.error(X)};let T=!1;const I=z=>{T||(o.next(h()),T=!0);let W={type:yr.DownloadProgress,loaded:z.loaded};z.lengthComputable&&(W.total=z.total),"text"===e.responseType&&r.responseText&&(W.partialText=r.responseText),o.next(W)},R=z=>{let W={type:yr.UploadProgress,loaded:z.loaded};z.lengthComputable&&(W.total=z.total),o.next(W)};return r.addEventListener("load",g),r.addEventListener("error",b),r.addEventListener("timeout",b),r.addEventListener("abort",b),e.reportProgress&&(r.addEventListener("progress",I),null!==s&&r.upload&&r.upload.addEventListener("progress",R)),r.send(s),o.next({type:yr.Sent}),()=>{r.removeEventListener("error",b),r.removeEventListener("abort",b),r.removeEventListener("load",g),r.removeEventListener("timeout",b),e.reportProgress&&(r.removeEventListener("progress",I),null!==s&&r.upload&&r.upload.removeEventListener("progress",R)),r.readyState!==r.DONE&&r.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(Rt(iA))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();const FS=new sn("XSRF_ENABLED"),wO=new sn("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),CO=new sn("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class TO{}let k8=(()=>{class t{constructor(e,o,r){this.doc=e,this.platform=o,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=qk(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(Rt(lo),Rt(r1),Rt(wO))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();function A8(t,n){const e=t.url.toLowerCase();if(!ti(FS)||"GET"===t.method||"HEAD"===t.method||e.startsWith("http://")||e.startsWith("https://"))return n(t);const o=ti(TO).getToken(),r=ti(CO);return null!=o&&!t.headers.has(r)&&(t=t.clone({headers:t.headers.set(r,o)})),n(t)}var qr=(()=>((qr=qr||{})[qr.Interceptors=0]="Interceptors",qr[qr.LegacyInterceptors=1]="LegacyInterceptors",qr[qr.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",qr[qr.NoXsrfProtection=3]="NoXsrfProtection",qr[qr.JsonpSupport=4]="JsonpSupport",qr[qr.RequestsMadeViaParent=5]="RequestsMadeViaParent",qr))();function Y_(t,n){return{\u0275kind:t,\u0275providers:n}}function P8(...t){const n=[Z1,xO,vO,{provide:G1,useExisting:vO},{provide:PS,useExisting:xO},{provide:bb,useValue:A8,multi:!0},{provide:FS,useValue:!0},{provide:TO,useClass:k8}];for(const e of t)n.push(...e.\u0275providers);return function rx(t){return{\u0275providers:t}}(n)}const EO=new sn("LEGACY_INTERCEPTOR_FN");let R8=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({providers:[P8(Y_(qr.LegacyInterceptors,[{provide:EO,useFactory:w8},{provide:bb,useExisting:EO,multi:!0}]))]}),t})();const L8=["*"];let K1;function xb(t){return function F8(){if(void 0===K1&&(K1=null,typeof window<"u")){const t=window;void 0!==t.trustedTypes&&(K1=t.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return K1}()?.createHTML(t)||t}function SO(t){return Error(`Unable to find icon with the name "${t}"`)}function DO(t){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${t}".`)}function MO(t){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${t}".`)}class Qm{constructor(n,e,o){this.url=n,this.svgText=e,this.options=o}}let X1=(()=>{class t{constructor(e,o,r,s){this._httpClient=e,this._sanitizer=o,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(e,o,r){return this.addSvgIconInNamespace("",e,o,r)}addSvgIconLiteral(e,o,r){return this.addSvgIconLiteralInNamespace("",e,o,r)}addSvgIconInNamespace(e,o,r,s){return this._addSvgIconConfig(e,o,new Qm(r,null,s))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,o,r,s){const l=this._sanitizer.sanitize(po.HTML,r);if(!l)throw MO(r);const h=xb(l);return this._addSvgIconConfig(e,o,new Qm("",h,s))}addSvgIconSet(e,o){return this.addSvgIconSetInNamespace("",e,o)}addSvgIconSetLiteral(e,o){return this.addSvgIconSetLiteralInNamespace("",e,o)}addSvgIconSetInNamespace(e,o,r){return this._addSvgIconSetConfig(e,new Qm(o,null,r))}addSvgIconSetLiteralInNamespace(e,o,r){const s=this._sanitizer.sanitize(po.HTML,o);if(!s)throw MO(o);const l=xb(s);return this._addSvgIconSetConfig(e,new Qm("",l,r))}registerFontClassAlias(e,o=e){return this._fontCssClassesByAlias.set(e,o),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const o=this._sanitizer.sanitize(po.RESOURCE_URL,e);if(!o)throw DO(e);const r=this._cachedIconsByUrl.get(o);return r?Gn(Y1(r)):this._loadSvgIconFromConfig(new Qm(e,null)).pipe(_s(s=>this._cachedIconsByUrl.set(o,s)),Nn(s=>Y1(s)))}getNamedSvgIcon(e,o=""){const r=IO(o,e);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(o,e),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const l=this._iconSetConfigs.get(o);return l?this._getSvgFromIconSetConfigs(e,l):X_(SO(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Gn(Y1(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(Nn(o=>Y1(o)))}_getSvgFromIconSetConfigs(e,o){const r=this._extractIconWithNameFromAnySet(e,o);return r?Gn(r):PA(o.filter(l=>!l.svgText).map(l=>this._loadSvgIconSetFromConfig(l).pipe(Ih(h=>{const b=`Loading icon set URL: ${this._sanitizer.sanitize(po.RESOURCE_URL,l.url)} failed: ${h.message}`;return this._errorHandler.handleError(new Error(b)),Gn(null)})))).pipe(Nn(()=>{const l=this._extractIconWithNameFromAnySet(e,o);if(!l)throw SO(e);return l}))}_extractIconWithNameFromAnySet(e,o){for(let r=o.length-1;r>=0;r--){const s=o[r];if(s.svgText&&s.svgText.toString().indexOf(e)>-1){const l=this._svgElementFromConfig(s),h=this._extractSvgIconFromSet(l,e,s.options);if(h)return h}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(_s(o=>e.svgText=o),Nn(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Gn(null):this._fetchIcon(e).pipe(_s(o=>e.svgText=o))}_extractSvgIconFromSet(e,o,r){const s=e.querySelector(`[id="${o}"]`);if(!s)return null;const l=s.cloneNode(!0);if(l.removeAttribute("id"),"svg"===l.nodeName.toLowerCase())return this._setSvgAttributes(l,r);if("symbol"===l.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(l),r);const h=this._svgElementFromString(xb("<svg></svg>"));return h.appendChild(l),this._setSvgAttributes(h,r)}_svgElementFromString(e){const o=this._document.createElement("DIV");o.innerHTML=e;const r=o.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(e){const o=this._svgElementFromString(xb("<svg></svg>")),r=e.attributes;for(let s=0;s<r.length;s++){const{name:l,value:h}=r[s];"id"!==l&&o.setAttribute(l,h)}for(let s=0;s<e.childNodes.length;s++)e.childNodes[s].nodeType===this._document.ELEMENT_NODE&&o.appendChild(e.childNodes[s].cloneNode(!0));return o}_setSvgAttributes(e,o){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),o&&o.viewBox&&e.setAttribute("viewBox",o.viewBox),e}_fetchIcon(e){const{url:o,options:r}=e,s=r?.withCredentials??!1;if(!this._httpClient)throw function z8(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==o)throw Error(`Cannot fetch icon from URL "${o}".`);const l=this._sanitizer.sanitize(po.RESOURCE_URL,o);if(!l)throw DO(o);const h=this._inProgressUrlFetches.get(l);if(h)return h;const g=this._httpClient.get(l,{responseType:"text",withCredentials:s}).pipe(Nn(b=>xb(b)),$1(()=>this._inProgressUrlFetches.delete(l)),Gt());return this._inProgressUrlFetches.set(l,g),g}_addSvgIconConfig(e,o,r){return this._svgIconConfigs.set(IO(e,o),r),this}_addSvgIconSetConfig(e,o){const r=this._iconSetConfigs.get(e);return r?r.push(o):this._iconSetConfigs.set(e,[o]),this}_svgElementFromConfig(e){if(!e.svgElement){const o=this._svgElementFromString(e.svgText);this._setSvgAttributes(o,e.options),e.svgElement=o}return e.svgElement}_getIconConfigFromResolvers(e,o){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](o,e);if(s)return B8(s)?new Qm(s.url,null,s.options):new Qm(s,null)}}}return t.\u0275fac=function(e){return new(e||t)(Rt(Z1,8),Rt(D1),Rt(lo,8),Rt(ec))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Y1(t){return t.cloneNode(!0)}function IO(t,n){return t+":"+n}function B8(t){return!(!t.url||!t.options)}const V8=kS(class{constructor(t){this._elementRef=t}}),U8=new sn("MAT_ICON_DEFAULT_OPTIONS"),j8=new sn("mat-icon-location",{providedIn:"root",factory:function H8(){const t=ti(lo),n=t?t.location:null;return{getPathname:()=>n?n.pathname+n.search:""}}}),kO=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],$8=kO.map(t=>`[${t}]`).join(", "),G8=/^url\(['"]?#(.*?)['"]?\)$/;let El=(()=>{class t extends V8{get inline(){return this._inline}set inline(e){this._inline=du(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const o=this._cleanupFontValue(e);o!==this._fontSet&&(this._fontSet=o,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const o=this._cleanupFontValue(e);o!==this._fontIcon&&(this._fontIcon=o,this._updateFontIconClasses())}constructor(e,o,r,s,l,h){super(e),this._iconRegistry=o,this._location=s,this._errorHandler=l,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=re.EMPTY,h&&(h.color&&(this.color=this.defaultColor=h.color),h.fontSet&&(this.fontSet=h.fontSet)),r||e.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];const o=e.split(":");switch(o.length){case 1:return["",o[0]];case 2:return o;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const o=this._location.getPathname();o!==this._previousPath&&(this._previousPath=o,this._prependPathToReferences(o))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const o=this._location.getPathname();this._previousPath=o,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(o),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let o=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();o--;){const r=e.childNodes[o];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,o=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>e.classList.remove(r)),o.forEach(r=>e.classList.add(r)),this._previousFontSetClass=o,this.fontIcon!==this._previousFontIconClass&&!o.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const o=this._elementsWithExternalReferences;o&&o.forEach((r,s)=>{r.forEach(l=>{s.setAttribute(l.name,`url('${e}#${l.value}')`)})})}_cacheChildrenWithExternalReferences(e){const o=e.querySelectorAll($8),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<o.length;s++)kO.forEach(l=>{const h=o[s],g=h.getAttribute(l),b=g?g.match(G8):null;if(b){let T=r.get(h);T||(T=[],r.set(h,T)),T.push({name:l,value:b[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[o,r]=this._splitIconName(e);o&&(this._svgNamespace=o),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,o).pipe(fd(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${o}:${r}! ${s.message}`))})}}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(X1),_p("aria-hidden"),be(j8),be(ec),be(U8,8))},t.\u0275cmp=on({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(e,o){2&e&&(st("data-mat-icon-type",o._usingFontIcon()?"font":"svg")("data-mat-icon-name",o._svgName||o.fontIcon)("data-mat-icon-namespace",o._svgNamespace||o.fontSet)("fontIcon",o._usingFontIcon()?o.fontIcon:null),Mo("mat-icon-inline",o.inline)("mat-icon-no-color","primary"!==o.color&&"accent"!==o.color&&"warn"!==o.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Li],ngContentSelectors:L8,decls:1,vars:0,template:function(e,o){1&e&&(or(),Qi(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),t})(),AO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[lc,lc]}),t})();class PO{}class W8{}const Ah="*";function cc(t,n){return{type:7,name:t,definitions:n,options:{}}}function Ho(t,n=null){return{type:4,styles:n,timings:t}}function OO(t,n=null){return{type:2,steps:t,options:n}}function go(t){return{type:6,styles:t,offset:null}}function zS(t,n,e){return{type:0,name:t,styles:n,options:e}}function rr(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function af(t,n=null){return{type:8,animation:t,options:n}}function Q_(t,n=null){return{type:10,animation:t,options:n}}function RO(t){Promise.resolve().then(t)}class wb{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){RO(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(o=>o()),e.length=0}}class LO{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,o=0,r=0;const s=this.players.length;0==s?RO(()=>this._onFinish()):this.players.forEach(l=>{l.onDone(()=>{++e==s&&this._onFinish()}),l.onDestroy(()=>{++o==s&&this._onDestroy()}),l.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((l,h)=>Math.max(l,h.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(o=>{const r=o.totalTime?Math.min(1,e/o.totalTime):1;o.setPosition(r)})}getPosition(){const n=this.players.reduce((e,o)=>null===e||o.totalTime>e.totalTime?o:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(o=>o()),e.length=0}}const NS="!";function FO(t){return new Dt(3e3,!1)}function DH(){return typeof window<"u"&&typeof window.document<"u"}function BS(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function lf(t){switch(t.length){case 0:return new wb;case 1:return t[0];default:return new LO(t)}}function zO(t,n,e,o,r=new Map,s=new Map){const l=[],h=[];let g=-1,b=null;if(o.forEach(T=>{const I=T.get("offset"),R=I==g,z=R&&b||new Map;T.forEach((W,X)=>{let ee=X,le=W;if("offset"!==X)switch(ee=n.normalizePropertyName(ee,l),le){case NS:le=r.get(X);break;case Ah:le=s.get(X);break;default:le=n.normalizeStyleValue(X,ee,le,l)}z.set(ee,le)}),R||h.push(z),b=z,g=I}),l.length)throw function mH(t){return new Dt(3502,!1)}();return h}function VS(t,n,e,o){switch(n){case"start":t.onStart(()=>o(e&&US(e,"start",t)));break;case"done":t.onDone(()=>o(e&&US(e,"done",t)));break;case"destroy":t.onDestroy(()=>o(e&&US(e,"destroy",t)))}}function US(t,n,e){const s=jS(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),l=t._data;return null!=l&&(s._data=l),s}function jS(t,n,e,o,r="",s=0,l){return{element:t,triggerName:n,fromState:e,toState:o,phaseName:r,totalTime:s,disabled:!!l}}function Sl(t,n,e){let o=t.get(n);return o||t.set(n,o=e),o}function NO(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}let HS=(t,n)=>!1,BO=(t,n,e)=>[],VO=null;function $S(t){const n=t.parentNode||t.host;return n===VO?null:n}(BS()||typeof Element<"u")&&(DH()?(VO=(()=>document.documentElement)(),HS=(t,n)=>{for(;n;){if(n===t)return!0;n=$S(n)}return!1}):HS=(t,n)=>t.contains(n),BO=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const o=t.querySelector(n);return o?[o]:[]});let Jm=null,UO=!1;const jO=HS,HO=BO;let $O=(()=>{class t{validateStyleProperty(e){return function IH(t){Jm||(Jm=function kH(){return typeof document<"u"?document.body:null}()||{},UO=!!Jm.style&&"WebkitAppearance"in Jm.style);let n=!0;return Jm.style&&!function MH(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in Jm.style,!n&&UO&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in Jm.style)),n}(e)}matchesElement(e,o){return!1}containsElement(e,o){return jO(e,o)}getParentElement(e){return $S(e)}query(e,o,r){return HO(e,o,r)}computeStyle(e,o,r){return r||""}animate(e,o,r,s,l,h=[],g){return new wb(r,s)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})(),GS=(()=>{class t{}return t.NOOP=new $O,t})();const AH=1e3,WS="ng-enter",Q1="ng-leave",J1="ng-trigger",ew=".ng-trigger",WO="ng-animating",qS=".ng-animating";function Ph(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:ZS(parseFloat(n[1]),n[2])}function ZS(t,n){return"s"===n?t*AH:t}function tw(t,n,e){return t.hasOwnProperty("duration")?t:function OH(t,n,e){let r,s=0,l="";if("string"==typeof t){const h=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===h)return n.push(FO()),{duration:0,delay:0,easing:""};r=ZS(parseFloat(h[1]),h[2]);const g=h[3];null!=g&&(s=ZS(parseFloat(g),h[4]));const b=h[5];b&&(l=b)}else r=t;if(!e){let h=!1,g=n.length;r<0&&(n.push(function q8(){return new Dt(3100,!1)}()),h=!0),s<0&&(n.push(function Z8(){return new Dt(3101,!1)}()),h=!0),h&&n.splice(g,0,FO())}return{duration:r,delay:s,easing:l}}(t,n,e)}function Cb(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function qO(t){const n=new Map;return Object.keys(t).forEach(e=>{n.set(e,t[e])}),n}function cf(t,n=new Map,e){if(e)for(let[o,r]of e)n.set(o,r);for(let[o,r]of t)n.set(o,r);return n}function KO(t,n,e){return e?n+":"+e+";":""}function XO(t){let n="";for(let e=0;e<t.style.length;e++){const o=t.style.item(e);n+=KO(0,o,t.style.getPropertyValue(o))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=KO(0,zH(e),t.style[e]));t.setAttribute("style",n)}function md(t,n,e){t.style&&(n.forEach((o,r)=>{const s=XS(r);e&&!e.has(r)&&e.set(r,t.style[s]),t.style[s]=o}),BS()&&XO(t))}function eg(t,n){t.style&&(n.forEach((e,o)=>{const r=XS(o);t.style[r]=""}),BS()&&XO(t))}function Tb(t){return Array.isArray(t)?1==t.length?t[0]:OO(t):t}const KS=new RegExp("{{\\s*(.+?)\\s*}}","g");function YO(t){let n=[];if("string"==typeof t){let e;for(;e=KS.exec(t);)n.push(e[1]);KS.lastIndex=0}return n}function Eb(t,n,e){const o=t.toString(),r=o.replace(KS,(s,l)=>{let h=n[l];return null==h&&(e.push(function X8(t){return new Dt(3003,!1)}()),h=""),h.toString()});return r==o?t:r}function nw(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const FH=/-+([a-z0-9])/g;function XS(t){return t.replace(FH,(...n)=>n[1].toUpperCase())}function zH(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Dl(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function Y8(t){return new Dt(3004,!1)}()}}function QO(t,n){return window.getComputedStyle(t)[n]}const rw="*";function HH(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(o=>function $H(t,n,e){if(":"==t[0]){const g=function GH(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,o)=>parseFloat(o)>parseFloat(e);case":decrement":return(e,o)=>parseFloat(o)<parseFloat(e);default:return n.push(function dH(t){return new Dt(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof g)return void n.push(g);t=g}const o=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==o||o.length<4)return e.push(function uH(t){return new Dt(3015,!1)}()),n;const r=o[1],s=o[2],l=o[3];n.push(JO(r,l));"<"==s[0]&&!(r==rw&&l==rw)&&n.push(JO(l,r))}(o,e,n)):e.push(t),e}const sw=new Set(["true","1"]),aw=new Set(["false","0"]);function JO(t,n){const e=sw.has(t)||aw.has(t),o=sw.has(n)||aw.has(n);return(r,s)=>{let l=t==rw||t==r,h=n==rw||n==s;return!l&&e&&"boolean"==typeof r&&(l=r?sw.has(t):aw.has(t)),!h&&o&&"boolean"==typeof s&&(h=s?sw.has(n):aw.has(n)),l&&h}}const WH=new RegExp("s*:selfs*,?","g");function YS(t,n,e,o){return new qH(t).build(n,e,o)}class qH{constructor(n){this._driver=n}build(n,e,o){const r=new XH(e);return this._resetContextStyleTimingState(r),Dl(this,Tb(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let o=e.queryCount=0,r=e.depCount=0;const s=[],l=[];return"@"==n.name.charAt(0)&&e.errors.push(function J8(){return new Dt(3006,!1)}()),n.definitions.forEach(h=>{if(this._resetContextStyleTimingState(e),0==h.type){const g=h,b=g.name;b.toString().split(/\s*,\s*/).forEach(T=>{g.name=T,s.push(this.visitState(g,e))}),g.name=b}else if(1==h.type){const g=this.visitTransition(h,e);o+=g.queryCount,r+=g.depCount,l.push(g)}else e.errors.push(function eH(){return new Dt(3007,!1)}())}),{type:7,name:n.name,states:s,transitions:l,queryCount:o,depCount:r,options:null}}visitState(n,e){const o=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(o.containsDynamicStyles){const s=new Set,l=r||{};o.styles.forEach(h=>{h instanceof Map&&h.forEach(g=>{YO(g).forEach(b=>{l.hasOwnProperty(b)||s.add(b)})})}),s.size&&(nw(s.values()),e.errors.push(function tH(t,n){return new Dt(3008,!1)}()))}return{type:0,name:n.name,style:o,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const o=Dl(this,Tb(n.animation),e);return{type:1,matchers:HH(n.expr,e.errors),animation:o,queryCount:e.queryCount,depCount:e.depCount,options:tg(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(o=>Dl(this,o,e)),options:tg(n.options)}}visitGroup(n,e){const o=e.currentTime;let r=0;const s=n.steps.map(l=>{e.currentTime=o;const h=Dl(this,l,e);return r=Math.max(r,e.currentTime),h});return e.currentTime=r,{type:3,steps:s,options:tg(n.options)}}visitAnimate(n,e){const o=function QH(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return QS(tw(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=QS(0,0,"");return s.dynamic=!0,s.strValue=e,s}const r=tw(e,n);return QS(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=o;let r,s=n.styles?n.styles:go({});if(5==s.type)r=this.visitKeyframes(s,e);else{let l=n.styles,h=!1;if(!l){h=!0;const b={};o.easing&&(b.easing=o.easing),l=go(b)}e.currentTime+=o.duration+o.delay;const g=this.visitStyle(l,e);g.isEmptyStep=h,r=g}return e.currentAnimateTimings=null,{type:4,timings:o,style:r,options:null}}visitStyle(n,e){const o=this._makeStyleAst(n,e);return this._validateStyleAst(o,e),o}_makeStyleAst(n,e){const o=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let h of r)"string"==typeof h?h===Ah?o.push(h):e.errors.push(new Dt(3002,!1)):o.push(qO(h));let s=!1,l=null;return o.forEach(h=>{if(h instanceof Map&&(h.has("easing")&&(l=h.get("easing"),h.delete("easing")),!s))for(let g of h.values())if(g.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:o,easing:l,offset:n.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(n,e){const o=e.currentAnimateTimings;let r=e.currentTime,s=e.currentTime;o&&s>0&&(s-=o.duration+o.delay),n.styles.forEach(l=>{"string"!=typeof l&&l.forEach((h,g)=>{const b=e.collectedStyles.get(e.currentQuerySelector),T=b.get(g);let I=!0;T&&(s!=r&&s>=T.startTime&&r<=T.endTime&&(e.errors.push(function iH(t,n,e,o,r){return new Dt(3010,!1)}()),I=!1),s=T.startTime),I&&b.set(g,{startTime:s,endTime:r}),e.options&&function LH(t,n,e){const o=n.params||{},r=YO(t);r.length&&r.forEach(s=>{o.hasOwnProperty(s)||e.push(function K8(t){return new Dt(3001,!1)}())})}(h,e.options,e.errors)})})}visitKeyframes(n,e){const o={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function oH(){return new Dt(3011,!1)}()),o;let s=0;const l=[];let h=!1,g=!1,b=0;const T=n.steps.map(le=>{const ve=this._makeStyleAst(le,e);let xe=null!=ve.offset?ve.offset:function YH(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const o=e;n=parseFloat(o.get("offset")),o.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(ve.styles),Be=0;return null!=xe&&(s++,Be=ve.offset=xe),g=g||Be<0||Be>1,h=h||Be<b,b=Be,l.push(Be),ve});g&&e.errors.push(function rH(){return new Dt(3012,!1)}()),h&&e.errors.push(function sH(){return new Dt(3200,!1)}());const I=n.steps.length;let R=0;s>0&&s<I?e.errors.push(function aH(){return new Dt(3202,!1)}()):0==s&&(R=1/(I-1));const z=I-1,W=e.currentTime,X=e.currentAnimateTimings,ee=X.duration;return T.forEach((le,ve)=>{const xe=R>0?ve==z?1:R*ve:l[ve],Be=xe*ee;e.currentTime=W+X.delay+Be,X.duration=Be,this._validateStyleAst(le,e),le.offset=xe,o.styles.push(le)}),o}visitReference(n,e){return{type:8,animation:Dl(this,Tb(n.animation),e),options:tg(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:tg(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:tg(n.options)}}visitQuery(n,e){const o=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[s,l]=function ZH(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(WH,"")),t=t.replace(/@\*/g,ew).replace(/@\w+/g,e=>ew+"-"+e.slice(1)).replace(/:animating/g,qS),[t,n]}(n.selector);e.currentQuerySelector=o.length?o+" "+s:s,Sl(e.collectedStyles,e.currentQuerySelector,new Map);const h=Dl(this,Tb(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=o,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:l,animation:h,originalSelector:n.selector,options:tg(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function lH(){return new Dt(3013,!1)}());const o="full"===n.timings?{duration:0,delay:0,easing:"full"}:tw(n.timings,e.errors,!0);return{type:12,animation:Dl(this,Tb(n.animation),e),timings:o,options:null}}}class XH{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function tg(t){return t?(t=Cb(t)).params&&(t.params=function KH(t){return t?Cb(t):null}(t.params)):t={},t}function QS(t,n,e){return{duration:t,delay:n,easing:e}}function JS(t,n,e,o,r,s,l=null,h=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:o,duration:r,delay:s,totalTime:r+s,easing:l,subTimeline:h}}class lw{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let o=this._map.get(n);o||this._map.set(n,o=[]),o.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const t$=new RegExp(":enter","g"),i$=new RegExp(":leave","g");function eD(t,n,e,o,r,s=new Map,l=new Map,h,g,b=[]){return(new o$).buildKeyframes(t,n,e,o,r,s,l,h,g,b)}class o${buildKeyframes(n,e,o,r,s,l,h,g,b,T=[]){b=b||new lw;const I=new tD(n,e,b,r,s,T,[]);I.options=g;const R=g.delay?Ph(g.delay):0;I.currentTimeline.delayNextStep(R),I.currentTimeline.setStyles([l],null,I.errors,g),Dl(this,o,I);const z=I.timelines.filter(W=>W.containsAnimation());if(z.length&&h.size){let W;for(let X=z.length-1;X>=0;X--){const ee=z[X];if(ee.element===e){W=ee;break}}W&&!W.allowOnlyTimelineStyles()&&W.setStyles([h],null,I.errors,g)}return z.length?z.map(W=>W.buildKeyframes()):[JS(e,[],[],[],0,R,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const o=e.subInstructions.get(e.element);if(o){const r=e.createSubContext(n.options),s=e.currentTimeline.currentTime,l=this._visitSubInstructions(o,r,r.options);s!=l&&e.transformIntoNewTimeline(l)}e.previousNode=n}visitAnimateRef(n,e){const o=e.createSubContext(n.options);o.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,o),this.visitReference(n.animation,o),e.transformIntoNewTimeline(o.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,o){for(const r of n){const s=r?.delay;if(s){const l="number"==typeof s?s:Ph(Eb(s,r?.params??{},e.errors));o.delayNextStep(l)}}}_visitSubInstructions(n,e,o){let s=e.currentTimeline.currentTime;const l=null!=o.duration?Ph(o.duration):null,h=null!=o.delay?Ph(o.delay):null;return 0!==l&&n.forEach(g=>{const b=e.appendInstructionToTimeline(g,l,h);s=Math.max(s,b.duration+b.delay)}),s}visitReference(n,e){e.updateOptions(n.options,!0),Dl(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const o=e.subContextCount;let r=e;const s=n.options;if(s&&(s.params||s.delay)&&(r=e.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=cw);const l=Ph(s.delay);r.delayNextStep(l)}n.steps.length&&(n.steps.forEach(l=>Dl(this,l,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>o&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const o=[];let r=e.currentTimeline.currentTime;const s=n.options&&n.options.delay?Ph(n.options.delay):0;n.steps.forEach(l=>{const h=e.createSubContext(n.options);s&&h.delayNextStep(s),Dl(this,l,h),r=Math.max(r,h.currentTimeline.currentTime),o.push(h.currentTimeline)}),o.forEach(l=>e.currentTimeline.mergeTimelineCollectedStyles(l)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const o=n.strValue;return tw(e.params?Eb(o,e.params,e.errors):o,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const o=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;o.delay&&(e.incrementTime(o.delay),r.snapshotCurrentStyles());const s=n.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(o.duration),this.visitStyle(s,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const o=e.currentTimeline,r=e.currentAnimateTimings;!r&&o.hasCurrentStyleProperties()&&o.forwardFrame();const s=r&&r.easing||n.easing;n.isEmptyStep?o.applyEmptyStep(s):o.setStyles(n.styles,s,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const o=e.currentAnimateTimings,r=e.currentTimeline.duration,s=o.duration,h=e.createSubContext().currentTimeline;h.easing=o.easing,n.styles.forEach(g=>{h.forwardTime((g.offset||0)*s),h.setStyles(g.styles,g.easing,e.errors,e.options),h.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(h),e.transformIntoNewTimeline(r+s),e.previousNode=n}visitQuery(n,e){const o=e.currentTimeline.currentTime,r=n.options||{},s=r.delay?Ph(r.delay):0;s&&(6===e.previousNode.type||0==o&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=cw);let l=o;const h=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=h.length;let g=null;h.forEach((b,T)=>{e.currentQueryIndex=T;const I=e.createSubContext(n.options,b);s&&I.delayNextStep(s),b===e.element&&(g=I.currentTimeline),Dl(this,n.animation,I),I.currentTimeline.applyStylesToKeyframe(),l=Math.max(l,I.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(l),g&&(e.currentTimeline.mergeTimelineCollectedStyles(g),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const o=e.parentContext,r=e.currentTimeline,s=n.timings,l=Math.abs(s.duration),h=l*(e.currentQueryTotal-1);let g=l*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":g=h-g;break;case"full":g=o.currentStaggerTime}const T=e.currentTimeline;g&&T.delayNextStep(g);const I=T.currentTime;Dl(this,n.animation,e),e.previousNode=n,o.currentStaggerTime=r.currentTime-I+(r.startTime-o.currentTimeline.startTime)}}const cw={};class tD{constructor(n,e,o,r,s,l,h,g){this._driver=n,this.element=e,this.subInstructions=o,this._enterClassName=r,this._leaveClassName=s,this.errors=l,this.timelines=h,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=cw,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=g||new uw(this._driver,e,0),h.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const o=n;let r=this.options;null!=o.duration&&(r.duration=Ph(o.duration)),null!=o.delay&&(r.delay=Ph(o.delay));const s=o.params;if(s){let l=r.params;l||(l=this.options.params={}),Object.keys(s).forEach(h=>{(!e||!l.hasOwnProperty(h))&&(l[h]=Eb(s[h],l,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const o=n.params={};Object.keys(e).forEach(r=>{o[r]=e[r]})}}return n}createSubContext(n=null,e,o){const r=e||this.element,s=new tD(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,o||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(n),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(n){return this.previousNode=cw,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,o){const r={duration:e??n.duration,delay:this.currentTimeline.currentTime+(o??0)+n.delay,easing:""},s=new r$(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,o,r,s,l){let h=[];if(r&&h.push(this.element),n.length>0){n=(n=n.replace(t$,"."+this._enterClassName)).replace(i$,"."+this._leaveClassName);let b=this._driver.query(this.element,n,1!=o);0!==o&&(b=o<0?b.slice(b.length+o,b.length):b.slice(0,o)),h.push(...b)}return!s&&0==h.length&&l.push(function cH(t){return new Dt(3014,!1)}()),h}}class uw{constructor(n,e,o,r){this._driver=n,this.element=e,this.startTime=o,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new uw(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,o]of this._globalTimelineStyles)this._backFill.set(e,o||Ah),this._currentKeyframe.set(e,Ah);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,o,r){e&&this._previousKeyframe.set("easing",e);const s=r&&r.params||{},l=function s$(t,n){const e=new Map;let o;return t.forEach(r=>{if("*"===r){o=o||n.keys();for(let s of o)e.set(s,Ah)}else cf(r,e)}),e}(n,this._globalTimelineStyles);for(let[h,g]of l){const b=Eb(g,s,o);this._pendingStyles.set(h,b),this._localTimelineStyles.has(h)||this._backFill.set(h,this._globalTimelineStyles.get(h)??Ah),this._updateStyle(h,b)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,o)=>{const r=this._styleSummary.get(o);(!r||e.time>r.time)&&this._updateStyle(o,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,o=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((h,g)=>{const b=cf(h,new Map,this._backFill);b.forEach((T,I)=>{T===NS?n.add(I):T===Ah&&e.add(I)}),o||b.set("offset",g/this.duration),r.push(b)});const s=n.size?nw(n.values()):[],l=e.size?nw(e.values()):[];if(o){const h=r[0],g=new Map(h);h.set("offset",0),g.set("offset",1),r=[h,g]}return JS(this.element,r,s,l,this.duration,this.startTime,this.easing,!1)}}class r$ extends uw{constructor(n,e,o,r,s,l,h=!1){super(n,e,l.delay),this.keyframes=o,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=h,this.timings={duration:l.duration,delay:l.delay,easing:l.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:o,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],l=o+e,h=e/l,g=cf(n[0]);g.set("offset",0),s.push(g);const b=cf(n[0]);b.set("offset",nR(h)),s.push(b);const T=n.length-1;for(let I=1;I<=T;I++){let R=cf(n[I]);const z=R.get("offset");R.set("offset",nR((e+z*o)/l)),s.push(R)}o=l,e=0,r="",n=s}return JS(this.element,n,this.preStyleProps,this.postStyleProps,o,e,r,!0)}}function nR(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class nD{}const a$=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class l$ extends nD{normalizePropertyName(n,e){return XS(n)}normalizeStyleValue(n,e,o,r){let s="";const l=o.toString().trim();if(a$.has(e)&&0!==o&&"0"!==o)if("number"==typeof o)s="px";else{const h=o.match(/^[+-]?[\d\.]+([a-z]*)$/);h&&0==h[1].length&&r.push(function Q8(t,n){return new Dt(3005,!1)}())}return l+s}}function iR(t,n,e,o,r,s,l,h,g,b,T,I,R){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:s,toState:o,toStyles:l,timelines:h,queriedElements:g,preStyleProps:b,postStyleProps:T,totalTime:I,errors:R}}const iD={};class oR{constructor(n,e,o){this._triggerName=n,this.ast=e,this._stateStyles=o}match(n,e,o,r){return function c$(t,n,e,o,r){return t.some(s=>s(n,e,o,r))}(this.ast.matchers,n,e,o,r)}buildStyles(n,e,o){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(e,o):new Map}build(n,e,o,r,s,l,h,g,b,T){const I=[],R=this.ast.options&&this.ast.options.params||iD,W=this.buildStyles(o,h&&h.params||iD,I),X=g&&g.params||iD,ee=this.buildStyles(r,X,I),le=new Set,ve=new Map,xe=new Map,Be="void"===r,Ke={params:u$(X,R),delay:this.ast.options?.delay},ft=T?[]:eD(n,e,this.ast.animation,s,l,W,ee,Ke,b,I);let Vt=0;if(ft.forEach(Ut=>{Vt=Math.max(Ut.duration+Ut.delay,Vt)}),I.length)return iR(e,this._triggerName,o,r,Be,W,ee,[],[],ve,xe,Vt,I);ft.forEach(Ut=>{const Pn=Ut.element,Qn=Sl(ve,Pn,new Set);Ut.preStyleProps.forEach(Jo=>Qn.add(Jo));const ki=Sl(xe,Pn,new Set);Ut.postStyleProps.forEach(Jo=>ki.add(Jo)),Pn!==e&&le.add(Pn)});const Nt=nw(le.values());return iR(e,this._triggerName,o,r,Be,W,ee,ft,Nt,ve,xe,Vt)}}function u$(t,n){const e=Cb(n);for(const o in t)t.hasOwnProperty(o)&&null!=t[o]&&(e[o]=t[o]);return e}class d${constructor(n,e,o){this.styles=n,this.defaultParams=e,this.normalizer=o}buildStyles(n,e){const o=new Map,r=Cb(this.defaultParams);return Object.keys(n).forEach(s=>{const l=n[s];null!==l&&(r[s]=l)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((l,h)=>{l&&(l=Eb(l,r,e));const g=this.normalizer.normalizePropertyName(h,e);l=this.normalizer.normalizeStyleValue(h,g,l,e),o.set(h,l)})}),o}}class p${constructor(n,e,o){this.name=n,this.ast=e,this._normalizer=o,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new d$(r.style,r.options&&r.options.params||{},o))}),rR(this.states,"true","1"),rR(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new oR(n,r,this.states))}),this.fallbackTransition=function f$(t,n,e){return new oR(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(l,h)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,o,r){return this.transitionFactories.find(l=>l.match(n,e,o,r))||null}matchStyles(n,e,o){return this.fallbackTransition.buildStyles(n,e,o)}}function rR(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const m$=new lw;class g${constructor(n,e,o){this.bodyNode=n,this._driver=e,this._normalizer=o,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const o=[],r=[],s=YS(this._driver,e,o,r);if(o.length)throw function gH(t){return new Dt(3503,!1)}();this._animations.set(n,s)}_buildPlayer(n,e,o){const r=n.element,s=zO(0,this._normalizer,0,n.keyframes,e,o);return this._driver.animate(r,s,n.duration,n.delay,n.easing,[],!0)}create(n,e,o={}){const r=[],s=this._animations.get(n);let l;const h=new Map;if(s?(l=eD(this._driver,e,s,WS,Q1,new Map,new Map,o,m$,r),l.forEach(T=>{const I=Sl(h,T.element,new Map);T.postStyleProps.forEach(R=>I.set(R,null))})):(r.push(function _H(){return new Dt(3300,!1)}()),l=[]),r.length)throw function yH(t){return new Dt(3504,!1)}();h.forEach((T,I)=>{T.forEach((R,z)=>{T.set(z,this._driver.computeStyle(I,z,Ah))})});const b=lf(l.map(T=>{const I=h.get(T.element);return this._buildPlayer(T,new Map,I)}));return this._playersById.set(n,b),b.onDestroy(()=>this.destroy(n)),this.players.push(b),b}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const o=this.players.indexOf(e);o>=0&&this.players.splice(o,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function vH(t){return new Dt(3301,!1)}();return e}listen(n,e,o,r){const s=jS(e,"","","");return VS(this._getPlayer(n),o,s,r),()=>{}}command(n,e,o,r){if("register"==o)return void this.register(n,r[0]);if("create"==o)return void this.create(n,e,r[0]||{});const s=this._getPlayer(n);switch(o){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const sR="ng-animate-queued",oD="ng-animate-disabled",x$=[],aR={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},w$={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},uc="__ng_removed";class rD{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const o=n&&n.hasOwnProperty("value");if(this.value=function S$(t){return t??null}(o?n.value:n),o){const s=Cb(n);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const o=this.options.params;Object.keys(e).forEach(r=>{null==o[r]&&(o[r]=e[r])})}}}const Sb="void",sD=new rD(Sb);class C${constructor(n,e,o){this.id=n,this.hostElement=e,this._engine=o,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,dc(e,this._hostClassName)}listen(n,e,o,r){if(!this._triggers.has(e))throw function bH(t,n){return new Dt(3302,!1)}();if(null==o||0==o.length)throw function xH(t){return new Dt(3303,!1)}();if(!function D$(t){return"start"==t||"done"==t}(o))throw function wH(t,n){return new Dt(3400,!1)}();const s=Sl(this._elementListeners,n,[]),l={name:e,phase:o,callback:r};s.push(l);const h=Sl(this._engine.statesByElement,n,new Map);return h.has(e)||(dc(n,J1),dc(n,J1+"-"+e),h.set(e,sD)),()=>{this._engine.afterFlush(()=>{const g=s.indexOf(l);g>=0&&s.splice(g,1),this._triggers.has(e)||h.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function CH(t){return new Dt(3401,!1)}();return e}trigger(n,e,o,r=!0){const s=this._getTrigger(e),l=new aD(this.id,e,n);let h=this._engine.statesByElement.get(n);h||(dc(n,J1),dc(n,J1+"-"+e),this._engine.statesByElement.set(n,h=new Map));let g=h.get(e);const b=new rD(o,this.id);if(!(o&&o.hasOwnProperty("value"))&&g&&b.absorbOptions(g.options),h.set(e,b),g||(g=sD),b.value!==Sb&&g.value===b.value){if(!function k$(t,n){const e=Object.keys(t),o=Object.keys(n);if(e.length!=o.length)return!1;for(let r=0;r<e.length;r++){const s=e[r];if(!n.hasOwnProperty(s)||t[s]!==n[s])return!1}return!0}(g.params,b.params)){const X=[],ee=s.matchStyles(g.value,g.params,X),le=s.matchStyles(b.value,b.params,X);X.length?this._engine.reportError(X):this._engine.afterFlush(()=>{eg(n,ee),md(n,le)})}return}const R=Sl(this._engine.playersByElement,n,[]);R.forEach(X=>{X.namespaceId==this.id&&X.triggerName==e&&X.queued&&X.destroy()});let z=s.matchTransition(g.value,b.value,n,b.params),W=!1;if(!z){if(!r)return;z=s.fallbackTransition,W=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:z,fromState:g,toState:b,player:l,isFallbackTransition:W}),W||(dc(n,sR),l.onStart(()=>{J_(n,sR)})),l.onDone(()=>{let X=this.players.indexOf(l);X>=0&&this.players.splice(X,1);const ee=this._engine.playersByElement.get(n);if(ee){let le=ee.indexOf(l);le>=0&&ee.splice(le,1)}}),this.players.push(l),R.push(l),l}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,o)=>{this._elementListeners.set(o,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(o=>o.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const o=this._engine.driver.query(n,ew,!0);o.forEach(r=>{if(r[uc])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(l=>l.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>o.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,o,r){const s=this._engine.statesByElement.get(n),l=new Map;if(s){const h=[];if(s.forEach((g,b)=>{if(l.set(b,g.value),this._triggers.has(b)){const T=this.trigger(n,b,Sb,r);T&&h.push(T)}}),h.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,l),o&&lf(h).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),o=this._engine.statesByElement.get(n);if(e&&o){const r=new Set;e.forEach(s=>{const l=s.name;if(r.has(l))return;r.add(l);const g=this._triggers.get(l).fallbackTransition,b=o.get(l)||sD,T=new rD(Sb),I=new aD(this.id,l,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:l,transition:g,fromState:b,toState:T,player:I,isFallbackTransition:!0})})}}removeNode(n,e){const o=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(o.totalAnimations){const s=o.players.length?o.playersByQueriedElement.get(n):[];if(s&&s.length)r=!0;else{let l=n;for(;l=l.parentNode;)if(o.statesByElement.get(l)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)o.markElementAsRemoved(this.id,n,!1,e);else{const s=n[uc];(!s||s===aR)&&(o.afterFlush(()=>this.clearElementCache(n)),o.destroyInnerAnimations(n),o._onRemovalComplete(n,e))}}insertNode(n,e){dc(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(o=>{const r=o.player;if(r.destroyed)return;const s=o.element,l=this._elementListeners.get(s);l&&l.forEach(h=>{if(h.name==o.triggerName){const g=jS(s,o.triggerName,o.fromState.value,o.toState.value);g._data=n,VS(o.player,h.phase,g,h.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(o)}),this._queue=[],e.sort((o,r)=>{const s=o.transition.ast.depCount,l=r.transition.ast.depCount;return 0==s||0==l?s-l:this._engine.driver.containsElement(o.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(o=>o.element===n)||e,e}}class T${_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,o){this.bodyNode=n,this.driver=e,this._normalizer=o,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(o=>{o.queued&&n.push(o)})}),n}createNamespace(n,e){const o=new C$(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(o,e):(this.newHostElements.set(e,o),this.collectEnterElement(e)),this._namespaceLookup[n]=o}_balanceNamespaceList(n,e){const o=this._namespaceList,r=this.namespacesByHostElement;if(o.length-1>=0){let l=!1,h=this.driver.getParentElement(e);for(;h;){const g=r.get(h);if(g){const b=o.indexOf(g);o.splice(b+1,0,n),l=!0;break}h=this.driver.getParentElement(h)}l||o.unshift(n)}else o.push(n);return r.set(e,n),n}register(n,e){let o=this._namespaceLookup[n];return o||(o=this.createNamespace(n,e)),o}registerTrigger(n,e,o){let r=this._namespaceLookup[n];r&&r.register(e,o)&&this.totalAnimations++}destroy(n,e){if(!n)return;const o=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(o.hostElement),delete this._namespaceLookup[n];const r=this._namespaceList.indexOf(o);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>o.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,o=this.statesByElement.get(n);if(o)for(let r of o.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&e.add(s)}return e}trigger(n,e,o,r){if(dw(e)){const s=this._fetchNamespace(n);if(s)return s.trigger(e,o,r),!0}return!1}insertNode(n,e,o,r){if(!dw(e))return;const s=e[uc];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const l=this.collectedLeaveElements.indexOf(e);l>=0&&this.collectedLeaveElements.splice(l,1)}if(n){const l=this._fetchNamespace(n);l&&l.insertNode(e,o)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),dc(n,oD)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),J_(n,oD))}removeNode(n,e,o,r){if(dw(e)){const s=n?this._fetchNamespace(n):null;if(s?s.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r),o){const l=this.namespacesByHostElement.get(e);l&&l.id!==n&&l.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,o,r,s){this.collectedLeaveElements.push(e),e[uc]={namespaceId:n,setForRemoval:r,hasAnimation:o,removedBeforeQueried:!1,previousTriggersValues:s}}listen(n,e,o,r,s){return dw(e)?this._fetchNamespace(n).listen(e,o,r,s):()=>{}}_buildInstruction(n,e,o,r,s){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,o,r,n.fromState.options,n.toState.options,e,s)}destroyInnerAnimations(n){let e=this.driver.query(n,ew,!0);e.forEach(o=>this.destroyActiveAnimationsForElement(o)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,qS,!0),e.forEach(o=>this.finishActiveQueriedAnimationOnElement(o)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(o=>{o.queued?o.markedForDestroy=!0:o.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(o=>o.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return lf(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[uc];if(e&&e.setForRemoval){if(n[uc]=aR,e.namespaceId){this.destroyInnerAnimations(n);const o=this._fetchNamespace(e.namespaceId);o&&o.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(oD)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(o=>{this.markElementAsDisabled(o,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((o,r)=>this._balanceNamespaceList(o,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let o=0;o<this.collectedEnterElements.length;o++)dc(this.collectedEnterElements[o],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const o=[];try{e=this._flushAnimations(o,n)}finally{for(let r=0;r<o.length;r++)o[r]()}}else for(let o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(o=>o()),this._flushFns=[],this._whenQuietFns.length){const o=this._whenQuietFns;this._whenQuietFns=[],e.length?lf(e).onDone(()=>{o.forEach(r=>r())}):o.forEach(r=>r())}}reportError(n){throw function TH(t){return new Dt(3402,!1)}()}_flushAnimations(n,e){const o=new lw,r=[],s=new Map,l=[],h=new Map,g=new Map,b=new Map,T=new Set;this.disabledNodes.forEach(en=>{T.add(en);const yn=this.driver.query(en,".ng-animate-queued",!0);for(let Hn=0;Hn<yn.length;Hn++)T.add(yn[Hn])});const I=this.bodyNode,R=Array.from(this.statesByElement.keys()),z=uR(R,this.collectedEnterElements),W=new Map;let X=0;z.forEach((en,yn)=>{const Hn=WS+X++;W.set(yn,Hn),en.forEach(li=>dc(li,Hn))});const ee=[],le=new Set,ve=new Set;for(let en=0;en<this.collectedLeaveElements.length;en++){const yn=this.collectedLeaveElements[en],Hn=yn[uc];Hn&&Hn.setForRemoval&&(ee.push(yn),le.add(yn),Hn.hasAnimation?this.driver.query(yn,".ng-star-inserted",!0).forEach(li=>le.add(li)):ve.add(yn))}const xe=new Map,Be=uR(R,Array.from(le));Be.forEach((en,yn)=>{const Hn=Q1+X++;xe.set(yn,Hn),en.forEach(li=>dc(li,Hn))}),n.push(()=>{z.forEach((en,yn)=>{const Hn=W.get(yn);en.forEach(li=>J_(li,Hn))}),Be.forEach((en,yn)=>{const Hn=xe.get(yn);en.forEach(li=>J_(li,Hn))}),ee.forEach(en=>{this.processLeaveNode(en)})});const Ke=[],ft=[];for(let en=this._namespaceList.length-1;en>=0;en--)this._namespaceList[en].drainQueuedTransitions(e).forEach(Hn=>{const li=Hn.player,er=Hn.element;if(Ke.push(li),this.collectedEnterElements.length){const pa=er[uc];if(pa&&pa.setForMove){if(pa.previousTriggersValues&&pa.previousTriggersValues.has(Hn.triggerName)){const bg=pa.previousTriggersValues.get(Hn.triggerName),_c=this.statesByElement.get(Hn.element);if(_c&&_c.has(Hn.triggerName)){const DC=_c.get(Hn.triggerName);DC.value=bg,_c.set(Hn.triggerName,DC)}}return void li.destroy()}}const Oa=!I||!this.driver.containsElement(I,er),rs=xe.get(er),sl=W.get(er),Lo=this._buildInstruction(Hn,o,sl,rs,Oa);if(Lo.errors&&Lo.errors.length)return void ft.push(Lo);if(Oa)return li.onStart(()=>eg(er,Lo.fromStyles)),li.onDestroy(()=>md(er,Lo.toStyles)),void r.push(li);if(Hn.isFallbackTransition)return li.onStart(()=>eg(er,Lo.fromStyles)),li.onDestroy(()=>md(er,Lo.toStyles)),void r.push(li);const Cf=[];Lo.timelines.forEach(pa=>{pa.stretchStartingKeyframe=!0,this.disabledNodes.has(pa.element)||Cf.push(pa)}),Lo.timelines=Cf,o.append(er,Lo.timelines),l.push({instruction:Lo,player:li,element:er}),Lo.queriedElements.forEach(pa=>Sl(h,pa,[]).push(li)),Lo.preStyleProps.forEach((pa,bg)=>{if(pa.size){let _c=g.get(bg);_c||g.set(bg,_c=new Set),pa.forEach((DC,QM)=>_c.add(QM))}}),Lo.postStyleProps.forEach((pa,bg)=>{let _c=b.get(bg);_c||b.set(bg,_c=new Set),pa.forEach((DC,QM)=>_c.add(QM))})});if(ft.length){const en=[];ft.forEach(yn=>{en.push(function EH(t,n){return new Dt(3505,!1)}())}),Ke.forEach(yn=>yn.destroy()),this.reportError(en)}const Vt=new Map,Nt=new Map;l.forEach(en=>{const yn=en.element;o.has(yn)&&(Nt.set(yn,yn),this._beforeAnimationBuild(en.player.namespaceId,en.instruction,Vt))}),r.forEach(en=>{const yn=en.element;this._getPreviousPlayers(yn,!1,en.namespaceId,en.triggerName,null).forEach(li=>{Sl(Vt,yn,[]).push(li),li.destroy()})});const Ut=ee.filter(en=>hR(en,g,b)),Pn=new Map;cR(Pn,this.driver,ve,b,Ah).forEach(en=>{hR(en,g,b)&&Ut.push(en)});const ki=new Map;z.forEach((en,yn)=>{cR(ki,this.driver,new Set(en),g,NS)}),Ut.forEach(en=>{const yn=Pn.get(en),Hn=ki.get(en);Pn.set(en,new Map([...Array.from(yn?.entries()??[]),...Array.from(Hn?.entries()??[])]))});const Jo=[],ha=[],So={};l.forEach(en=>{const{element:yn,player:Hn,instruction:li}=en;if(o.has(yn)){if(T.has(yn))return Hn.onDestroy(()=>md(yn,li.toStyles)),Hn.disabled=!0,Hn.overrideTotalTime(li.totalTime),void r.push(Hn);let er=So;if(Nt.size>1){let rs=yn;const sl=[];for(;rs=rs.parentNode;){const Lo=Nt.get(rs);if(Lo){er=Lo;break}sl.push(rs)}sl.forEach(Lo=>Nt.set(Lo,er))}const Oa=this._buildAnimation(Hn.namespaceId,li,Vt,s,ki,Pn);if(Hn.setRealPlayer(Oa),er===So)Jo.push(Hn);else{const rs=this.playersByElement.get(er);rs&&rs.length&&(Hn.parentPlayer=lf(rs)),r.push(Hn)}}else eg(yn,li.fromStyles),Hn.onDestroy(()=>md(yn,li.toStyles)),ha.push(Hn),T.has(yn)&&r.push(Hn)}),ha.forEach(en=>{const yn=s.get(en.element);if(yn&&yn.length){const Hn=lf(yn);en.setRealPlayer(Hn)}}),r.forEach(en=>{en.parentPlayer?en.syncPlayerEvents(en.parentPlayer):en.destroy()});for(let en=0;en<ee.length;en++){const yn=ee[en],Hn=yn[uc];if(J_(yn,Q1),Hn&&Hn.hasAnimation)continue;let li=[];if(h.size){let Oa=h.get(yn);Oa&&Oa.length&&li.push(...Oa);let rs=this.driver.query(yn,qS,!0);for(let sl=0;sl<rs.length;sl++){let Lo=h.get(rs[sl]);Lo&&Lo.length&&li.push(...Lo)}}const er=li.filter(Oa=>!Oa.destroyed);er.length?M$(this,yn,er):this.processLeaveNode(yn)}return ee.length=0,Jo.forEach(en=>{this.players.push(en),en.onDone(()=>{en.destroy();const yn=this.players.indexOf(en);this.players.splice(yn,1)}),en.play()}),Jo}elementContainsData(n,e){let o=!1;const r=e[uc];return r&&r.setForRemoval&&(o=!0),this.playersByElement.has(e)&&(o=!0),this.playersByQueriedElement.has(e)&&(o=!0),this.statesByElement.has(e)&&(o=!0),this._fetchNamespace(n).elementContainsData(e)||o}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,o,r,s){let l=[];if(e){const h=this.playersByQueriedElement.get(n);h&&(l=h)}else{const h=this.playersByElement.get(n);if(h){const g=!s||s==Sb;h.forEach(b=>{b.queued||!g&&b.triggerName!=r||l.push(b)})}}return(o||r)&&(l=l.filter(h=>!(o&&o!=h.namespaceId||r&&r!=h.triggerName))),l}_beforeAnimationBuild(n,e,o){const s=e.element,l=e.isRemovalTransition?void 0:n,h=e.isRemovalTransition?void 0:e.triggerName;for(const g of e.timelines){const b=g.element,T=b!==s,I=Sl(o,b,[]);this._getPreviousPlayers(b,T,l,h,e.toState).forEach(z=>{const W=z.getRealPlayer();W.beforeDestroy&&W.beforeDestroy(),z.destroy(),I.push(z)})}eg(s,e.fromStyles)}_buildAnimation(n,e,o,r,s,l){const h=e.triggerName,g=e.element,b=[],T=new Set,I=new Set,R=e.timelines.map(W=>{const X=W.element;T.add(X);const ee=X[uc];if(ee&&ee.removedBeforeQueried)return new wb(W.duration,W.delay);const le=X!==g,ve=function I$(t){const n=[];return dR(t,n),n}((o.get(X)||x$).map(Vt=>Vt.getRealPlayer())).filter(Vt=>!!Vt.element&&Vt.element===X),xe=s.get(X),Be=l.get(X),Ke=zO(0,this._normalizer,0,W.keyframes,xe,Be),ft=this._buildPlayer(W,Ke,ve);if(W.subTimeline&&r&&I.add(X),le){const Vt=new aD(n,h,X);Vt.setRealPlayer(ft),b.push(Vt)}return ft});b.forEach(W=>{Sl(this.playersByQueriedElement,W.element,[]).push(W),W.onDone(()=>function E$(t,n,e){let o=t.get(n);if(o){if(o.length){const r=o.indexOf(e);o.splice(r,1)}0==o.length&&t.delete(n)}return o}(this.playersByQueriedElement,W.element,W))}),T.forEach(W=>dc(W,WO));const z=lf(R);return z.onDestroy(()=>{T.forEach(W=>J_(W,WO)),md(g,e.toStyles)}),I.forEach(W=>{Sl(r,W,[]).push(z)}),z}_buildPlayer(n,e,o){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,o):new wb(n.duration,n.delay)}}class aD{constructor(n,e,o){this.namespaceId=n,this.triggerName=e,this.element=o,this._player=new wb,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,o)=>{e.forEach(r=>VS(n,o,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Sl(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function dw(t){return t&&1===t.nodeType}function lR(t,n){const e=t.style.display;return t.style.display=n??"none",e}function cR(t,n,e,o,r){const s=[];e.forEach(g=>s.push(lR(g)));const l=[];o.forEach((g,b)=>{const T=new Map;g.forEach(I=>{const R=n.computeStyle(b,I,r);T.set(I,R),(!R||0==R.length)&&(b[uc]=w$,l.push(b))}),t.set(b,T)});let h=0;return e.forEach(g=>lR(g,s[h++])),l}function uR(t,n){const e=new Map;if(t.forEach(h=>e.set(h,[])),0==n.length)return e;const o=1,r=new Set(n),s=new Map;function l(h){if(!h)return o;let g=s.get(h);if(g)return g;const b=h.parentNode;return g=e.has(b)?b:r.has(b)?o:l(b),s.set(h,g),g}return n.forEach(h=>{const g=l(h);g!==o&&e.get(g).push(h)}),e}function dc(t,n){t.classList?.add(n)}function J_(t,n){t.classList?.remove(n)}function M$(t,n,e){lf(e).onDone(()=>t.processLeaveNode(n))}function dR(t,n){for(let e=0;e<t.length;e++){const o=t[e];o instanceof LO?dR(o.players,n):n.push(o)}}function hR(t,n,e){const o=e.get(t);if(!o)return!1;let r=n.get(t);return r?o.forEach(s=>r.add(s)):n.set(t,o),e.delete(t),!0}class hw{constructor(n,e,o){this.bodyNode=n,this._driver=e,this._normalizer=o,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new T$(n,e,o),this._timelineEngine=new g$(n,e,o),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(n,e,o,r,s){const l=n+"-"+r;let h=this._triggerCache[l];if(!h){const g=[],b=[],T=YS(this._driver,s,g,b);if(g.length)throw function fH(t,n){return new Dt(3404,!1)}();h=function h$(t,n,e){return new p$(t,n,e)}(r,T,this._normalizer),this._triggerCache[l]=h}this._transitionEngine.registerTrigger(e,r,h)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,o,r){this._transitionEngine.insertNode(n,e,o,r)}onRemove(n,e,o,r){this._transitionEngine.removeNode(n,e,r||!1,o)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,o,r){if("@"==o.charAt(0)){const[s,l]=NO(o);this._timelineEngine.command(s,e,l,r)}else this._transitionEngine.trigger(n,e,o,r)}listen(n,e,o,r,s){if("@"==o.charAt(0)){const[l,h]=NO(o);return this._timelineEngine.listen(l,e,h,s)}return this._transitionEngine.listen(n,e,o,r,s)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let P$=(()=>{class t{constructor(e,o,r){this._element=e,this._startStyles=o,this._endStyles=r,this._state=0;let s=t.initialStylesByElement.get(e);s||t.initialStylesByElement.set(e,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&md(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(md(this._element,this._initialStyles),this._endStyles&&(md(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(eg(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(eg(this._element,this._endStyles),this._endStyles=null),md(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function lD(t){let n=null;return t.forEach((e,o)=>{(function O$(t){return"display"===t||"position"===t})(o)&&(n=n||new Map,n.set(o,e))}),n}class pR{constructor(n,e,o,r){this.element=n,this.keyframes=e,this.options=o,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=o.duration,this._delay=o.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(o=>{e.push(Object.fromEntries(o))}),e}_triggerWebAnimation(n,e,o){return n.animate(this._convertKeyframesToObject(e),o)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((o,r)=>{"offset"!==r&&n.set(r,this._finished?o:QO(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(o=>o()),e.length=0}}class R${validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return jO(n,e)}getParentElement(n){return $S(n)}query(n,e,o){return HO(n,e,o)}computeStyle(n,e,o){return window.getComputedStyle(n)[e]}animate(n,e,o,r,s,l=[]){const g={duration:o,delay:r,fill:0==r?"both":"forwards"};s&&(g.easing=s);const b=new Map,T=l.filter(z=>z instanceof pR);(function NH(t,n){return 0===t||0===n})(o,r)&&T.forEach(z=>{z.currentSnapshot.forEach((W,X)=>b.set(X,W))});let I=function RH(t){return t.length?t[0]instanceof Map?t:t.map(n=>qO(n)):[]}(e).map(z=>cf(z));I=function BH(t,n,e){if(e.size&&n.length){let o=n[0],r=[];if(e.forEach((s,l)=>{o.has(l)||r.push(l),o.set(l,s)}),r.length)for(let s=1;s<n.length;s++){let l=n[s];r.forEach(h=>l.set(h,QO(t,h)))}}return n}(n,I,b);const R=function A$(t,n){let e=null,o=null;return Array.isArray(n)&&n.length?(e=lD(n[0]),n.length>1&&(o=lD(n[n.length-1]))):n instanceof Map&&(e=lD(n)),e||o?new P$(t,e,o):null}(n,I);return new pR(n,I,g,R)}}let L$=(()=>{class t extends PO{constructor(e,o){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(o.body,{id:"0",encapsulation:Ys.None,styles:[],data:{animation:[]}})}build(e){const o=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?OO(e):e;return fR(this._renderer,null,o,"register",[r]),new F$(o,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(Rt(Tm),Rt(lo))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();class F$ extends W8{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new z$(this._id,n,e||{},this._renderer)}}class z${constructor(n,e,o,r){this.id=n,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",o)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return fR(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function fR(t,n,e,o,r){return t.setProperty(n,`@@${e}:${o}`,r)}const mR="@.disabled";let N$=(()=>{class t{constructor(e,o,r){this.delegate=e,this.engine=o,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),o.onRemovalComplete=(s,l)=>{const h=l?.parentNode(s);h&&l.removeChild(h,s)}}createRenderer(e,o){const s=this.delegate.createRenderer(e,o);if(!(e&&o&&o.data&&o.data.animation)){let T=this._rendererCache.get(s);return T||(T=new gR("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,T)),T}const l=o.id,h=o.id+"-"+this._currentId;this._currentId++,this.engine.register(h,e);const g=T=>{Array.isArray(T)?T.forEach(g):this.engine.registerTrigger(l,h,e,T.name,T)};return o.data.animation.forEach(g),new B$(this,h,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,o,r){e>=0&&e<this._microtaskId?this._zone.run(()=>o(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[l,h]=s;l(h)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([o,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(Rt(Tm),Rt(hw),Rt(fi))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();class gR{constructor(n,e,o,r){this.namespaceId=n,this.delegate=e,this.engine=o,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>e.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,o,r=!0){this.delegate.insertBefore(n,e,o),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,o){this.engine.onRemove(this.namespaceId,e,this.delegate,o)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,o,r){this.delegate.setAttribute(n,e,o,r)}removeAttribute(n,e,o){this.delegate.removeAttribute(n,e,o)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,o,r){this.delegate.setStyle(n,e,o,r)}removeStyle(n,e,o){this.delegate.removeStyle(n,e,o)}setProperty(n,e,o){"@"==e.charAt(0)&&e==mR?this.disableAnimations(n,!!o):this.delegate.setProperty(n,e,o)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,o){return this.delegate.listen(n,e,o)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class B$ extends gR{constructor(n,e,o,r,s){super(e,o,r,s),this.factory=n,this.namespaceId=e}setProperty(n,e,o){"@"==e.charAt(0)?"."==e.charAt(1)&&e==mR?this.disableAnimations(n,o=void 0===o||!!o):this.engine.process(this.namespaceId,n,e.slice(1),o):this.delegate.setProperty(n,e,o)}listen(n,e,o){if("@"==e.charAt(0)){const r=function V$(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let s=e.slice(1),l="";return"@"!=s.charAt(0)&&([s,l]=function U$(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(s)),this.engine.listen(this.namespaceId,r,s,l,h=>{this.factory.scheduleListenerCallback(h._data||-1,o,h)})}return this.delegate.listen(n,e,o)}}const _R=[{provide:PO,useClass:L$},{provide:nD,useFactory:function H$(){return new l$}},{provide:hw,useClass:(()=>{class t extends hw{constructor(e,o,r,s){super(e.body,o,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(Rt(lo),Rt(GS),Rt(nD),Rt(tb))},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})()},{provide:Tm,useFactory:function $$(t,n,e){return new N$(t,n,e)},deps:[S1,hw,fi]}],cD=[{provide:GS,useFactory:()=>new R$},{provide:U_,useValue:"BrowserAnimations"},..._R],yR=[{provide:GS,useClass:$O},{provide:U_,useValue:"NoopAnimations"},..._R];let vR=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?yR:cD}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({providers:cD,imports:[EA]}),t})();const fw=mt(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function bR(t){return new Jn(n=>{ne(t()).subscribe(n)})}function uD(){return ji((t,n)=>{let e=null;t._refCount++;const o=Yn(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const r=t._connection,s=e;e=null,r&&(!s||r===s)&&r.unsubscribe(),n.unsubscribe()});t.subscribe(o),o.closed||(e=t.connect())})}class xR extends Jn{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Rs(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new re;const e=this.getSubject();n.add(this.source.subscribe(Yn(e,void 0,()=>{this._teardown(),e.complete()},o=>{this._teardown(),e.error(o)},()=>this._teardown()))),n.closed&&(this._connection=null,n=re.EMPTY)}return n}refCount(){return uD()(this)}}function gd(t,n){return ji((e,o)=>{let r=null,s=0,l=!1;const h=()=>l&&!r&&o.complete();e.subscribe(Yn(o,g=>{r?.unsubscribe();let b=0;const T=s++;ne(t(g,T)).subscribe(r=Yn(o,I=>o.next(n?n(g,I,T,b++):I),()=>{r=null,h()}))},()=>{l=!0,h()}))})}function mw(t){return ji((n,e)=>{let o=!1;n.subscribe(Yn(e,r=>{o=!0,e.next(r)},()=>{o||e.next(t),e.complete()}))})}function wR(t=G$){return ji((n,e)=>{let o=!1;n.subscribe(Yn(e,r=>{o=!0,e.next(r)},()=>o?e.complete():e.error(t())))})}function G$(){return new fw}function uf(t,n){const e=arguments.length>=2;return o=>o.pipe(t?$s((r,s)=>t(r,s,o)):lr,fd(1),e?mw(n):wR(()=>new fw))}function CR(t,n){return ji(function W$(t,n,e,o,r){return(s,l)=>{let h=e,g=n,b=0;s.subscribe(Yn(l,T=>{const I=b++;g=h?t(g,T,I):(h=!0,T),o&&l.next(g)},r&&(()=>{h&&l.next(g),l.complete()})))}}(t,n,arguments.length>=2,!0))}function dD(t){return t<=0?()=>dn:ji((n,e)=>{let o=[];n.subscribe(Yn(e,r=>{o.push(r),t<o.length&&o.shift()},()=>{for(const r of o)e.next(r);e.complete()},void 0,()=>{o=null}))})}function TR(t,n){const e=arguments.length>=2;return o=>o.pipe(t?$s((r,s)=>t(r,s,o)):lr,dD(1),e?mw(n):wR(()=>new fw))}function hD(t){return Nn(()=>t)}const Ii="primary",Db=Symbol("RouteTitle");class Z${constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function ey(t){return new Z$(t)}function K$(t,n,e){const o=e.path.split("/");if(o.length>t.length||"full"===e.pathMatch&&(n.hasChildren()||o.length<t.length))return null;const r={};for(let s=0;s<o.length;s++){const l=o[s],h=t[s];if(l.startsWith(":"))r[l.substring(1)]=h;else if(l!==h.path)return null}return{consumed:t.slice(0,o.length),posParams:r}}function _d(t,n){const e=t?Object.keys(t):void 0,o=n?Object.keys(n):void 0;if(!e||!o||e.length!=o.length)return!1;let r;for(let s=0;s<e.length;s++)if(r=e[s],!ER(t[r],n[r]))return!1;return!0}function ER(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;const e=[...t].sort(),o=[...n].sort();return e.every((r,s)=>o[s]===r)}return t===n}function SR(t){return Array.prototype.concat.apply([],t)}function DR(t){return t.length>0?t[t.length-1]:null}function Gs(t,n){for(const e in t)t.hasOwnProperty(e)&&n(t[e],e)}function df(t){return mr(t)?t:fr(t)?Wo(Promise.resolve(t)):Gn(t)}const gw=!1,Y$={exact:function kR(t,n,e){if(!ng(t.segments,n.segments)||!_w(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const o in n.children)if(!t.children[o]||!kR(t.children[o],n.children[o],e))return!1;return!0},subset:AR},MR={exact:function Q$(t,n){return _d(t,n)},subset:function J$(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>ER(t[e],n[e]))},ignored:()=>!0};function IR(t,n,e){return Y$[e.paths](t.root,n.root,e.matrixParams)&&MR[e.queryParams](t.queryParams,n.queryParams)&&!("exact"===e.fragment&&t.fragment!==n.fragment)}function AR(t,n,e){return PR(t,n,n.segments,e)}function PR(t,n,e,o){if(t.segments.length>e.length){const r=t.segments.slice(0,e.length);return!(!ng(r,e)||n.hasChildren()||!_w(r,e,o))}if(t.segments.length===e.length){if(!ng(t.segments,e)||!_w(t.segments,e,o))return!1;for(const r in n.children)if(!t.children[r]||!AR(t.children[r],n.children[r],o))return!1;return!0}{const r=e.slice(0,t.segments.length),s=e.slice(t.segments.length);return!!(ng(t.segments,r)&&_w(t.segments,r,o)&&t.children[Ii])&&PR(t.children[Ii],n,s,o)}}function _w(t,n,e){return n.every((o,r)=>MR[e](t[r].parameters,o.parameters))}class hf{constructor(n=new qi([],{}),e={},o=null){this.root=n,this.queryParams=e,this.fragment=o}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ey(this.queryParams)),this._queryParamMap}toString(){return n7.serialize(this)}}class qi{constructor(n,e){this.segments=n,this.children=e,this.parent=null,Gs(e,(o,r)=>o.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return yw(this)}}class Mb{constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=ey(this.parameters)),this._parameterMap}toString(){return LR(this)}}function ng(t,n){return t.length===n.length&&t.every((e,o)=>e.path===n[o].path)}let Ib=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:function(){return new pD},providedIn:"root"}),t})();class pD{parse(n){const e=new h7(n);return new hf(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){const e=`/${kb(n.root,!0)}`,o=function s7(t){const n=Object.keys(t).map(e=>{const o=t[e];return Array.isArray(o)?o.map(r=>`${vw(e)}=${vw(r)}`).join("&"):`${vw(e)}=${vw(o)}`}).filter(e=>!!e);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${e}${o}${"string"==typeof n.fragment?`#${function o7(t){return encodeURI(t)}(n.fragment)}`:""}`}}const n7=new pD;function yw(t){return t.segments.map(n=>LR(n)).join("/")}function kb(t,n){if(!t.hasChildren())return yw(t);if(n){const e=t.children[Ii]?kb(t.children[Ii],!1):"",o=[];return Gs(t.children,(r,s)=>{s!==Ii&&o.push(`${s}:${kb(r,!1)}`)}),o.length>0?`${e}(${o.join("//")})`:e}{const e=function t7(t,n){let e=[];return Gs(t.children,(o,r)=>{r===Ii&&(e=e.concat(n(o,r)))}),Gs(t.children,(o,r)=>{r!==Ii&&(e=e.concat(n(o,r)))}),e}(t,(o,r)=>r===Ii?[kb(t.children[Ii],!1)]:[`${r}:${kb(o,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Ii]?`${yw(t)}/${e[0]}`:`${yw(t)}/(${e.join("//")})`}}function OR(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function vw(t){return OR(t).replace(/%3B/gi,";")}function fD(t){return OR(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function bw(t){return decodeURIComponent(t)}function RR(t){return bw(t.replace(/\+/g,"%20"))}function LR(t){return`${fD(t.path)}${function r7(t){return Object.keys(t).map(n=>`;${fD(n)}=${fD(t[n])}`).join("")}(t.parameters)}`}const a7=/^[^\/()?;=#]+/;function xw(t){const n=t.match(a7);return n?n[0]:""}const l7=/^[^=?&#]+/,u7=/^[^&#]+/;class h7{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new qi([],{}):new qi([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let o={};return this.peekStartsWith("(")&&(o=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(o[Ii]=new qi(n,e)),o}parseSegment(){const n=xw(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new Dt(4009,gw);return this.capture(n),new Mb(bw(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const e=xw(this.remaining);if(!e)return;this.capture(e);let o="";if(this.consumeOptional("=")){const r=xw(this.remaining);r&&(o=r,this.capture(o))}n[bw(e)]=bw(o)}parseQueryParam(n){const e=function c7(t){const n=t.match(l7);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let o="";if(this.consumeOptional("=")){const l=function d7(t){const n=t.match(u7);return n?n[0]:""}(this.remaining);l&&(o=l,this.capture(o))}const r=RR(e),s=RR(o);if(n.hasOwnProperty(r)){let l=n[r];Array.isArray(l)||(l=[l],n[r]=l),l.push(s)}else n[r]=s}parseParens(n){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const o=xw(this.remaining),r=this.remaining[o.length];if("/"!==r&&")"!==r&&";"!==r)throw new Dt(4010,gw);let s;o.indexOf(":")>-1?(s=o.slice(0,o.indexOf(":")),this.capture(s),this.capture(":")):n&&(s=Ii);const l=this.parseChildren();e[s]=1===Object.keys(l).length?l[Ii]:new qi([],l),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new Dt(4011,gw)}}function mD(t){return t.segments.length>0?new qi([],{[Ii]:t}):t}function ww(t){const n={};for(const o of Object.keys(t.children)){const s=ww(t.children[o]);(s.segments.length>0||s.hasChildren())&&(n[o]=s)}return function p7(t){if(1===t.numberOfChildren&&t.children[Ii]){const n=t.children[Ii];return new qi(t.segments.concat(n.segments),n.children)}return t}(new qi(t.segments,n))}function ig(t){return t instanceof hf}const gD=!1;function f7(t,n,e,o,r){if(0===e.length)return ty(n.root,n.root,n.root,o,r);const s=function VR(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new BR(!0,0,t);let n=0,e=!1;const o=t.reduce((r,s,l)=>{if("object"==typeof s&&null!=s){if(s.outlets){const h={};return Gs(s.outlets,(g,b)=>{h[b]="string"==typeof g?g.split("/"):g}),[...r,{outlets:h}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===l?(s.split("/").forEach((h,g)=>{0==g&&"."===h||(0==g&&""===h?e=!0:".."===h?n++:""!=h&&r.push(h))}),r):[...r,s]},[]);return new BR(e,n,o)}(e);return s.toRoot()?ty(n.root,n.root,new qi([],{}),o,r):function l(g){const b=function g7(t,n,e,o){if(t.isAbsolute)return new ny(n.root,!0,0);if(-1===o)return new ny(e,e===n.root,0);return function UR(t,n,e){let o=t,r=n,s=e;for(;s>r;){if(s-=r,o=o.parent,!o)throw new Dt(4005,gD&&"Invalid number of '../'");r=o.segments.length}return new ny(o,!1,r-s)}(e,o+(Ab(t.commands[0])?0:1),t.numberOfDoubleDots)}(s,n,t.snapshot?._urlSegment,g),T=b.processChildren?iy(b.segmentGroup,b.index,s.commands):_D(b.segmentGroup,b.index,s.commands);return ty(n.root,b.segmentGroup,T,o,r)}(t.snapshot?._lastPathIndex)}function Ab(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Pb(t){return"object"==typeof t&&null!=t&&t.outlets}function ty(t,n,e,o,r){let l,s={};o&&Gs(o,(g,b)=>{s[b]=Array.isArray(g)?g.map(T=>`${T}`):`${g}`}),l=t===n?e:NR(t,n,e);const h=mD(ww(l));return new hf(h,s,r)}function NR(t,n,e){const o={};return Gs(t.children,(r,s)=>{o[s]=r===n?e:NR(r,n,e)}),new qi(t.segments,o)}class BR{constructor(n,e,o){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=o,n&&o.length>0&&Ab(o[0]))throw new Dt(4003,gD&&"Root segment cannot have matrix parameters");const r=o.find(Pb);if(r&&r!==DR(o))throw new Dt(4004,gD&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ny{constructor(n,e,o){this.segmentGroup=n,this.processChildren=e,this.index=o}}function _D(t,n,e){if(t||(t=new qi([],{})),0===t.segments.length&&t.hasChildren())return iy(t,n,e);const o=function y7(t,n,e){let o=0,r=n;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(o>=e.length)return s;const l=t.segments[r],h=e[o];if(Pb(h))break;const g=`${h}`,b=o<e.length-1?e[o+1]:null;if(r>0&&void 0===g)break;if(g&&b&&"object"==typeof b&&void 0===b.outlets){if(!HR(g,b,l))return s;o+=2}else{if(!HR(g,{},l))return s;o++}r++}return{match:!0,pathIndex:r,commandIndex:o}}(t,n,e),r=e.slice(o.commandIndex);if(o.match&&o.pathIndex<t.segments.length){const s=new qi(t.segments.slice(0,o.pathIndex),{});return s.children[Ii]=new qi(t.segments.slice(o.pathIndex),t.children),iy(s,0,r)}return o.match&&0===r.length?new qi(t.segments,{}):o.match&&!t.hasChildren()?yD(t,n,e):o.match?iy(t,0,r):yD(t,n,e)}function iy(t,n,e){if(0===e.length)return new qi(t.segments,{});{const o=function _7(t){return Pb(t[0])?t[0].outlets:{[Ii]:t}}(e),r={};return!o[Ii]&&t.children[Ii]&&1===t.numberOfChildren&&0===t.children[Ii].segments.length?iy(t.children[Ii],n,e):(Gs(o,(s,l)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[l]=_D(t.children[l],n,s))}),Gs(t.children,(s,l)=>{void 0===o[l]&&(r[l]=s)}),new qi(t.segments,r))}}function yD(t,n,e){const o=t.segments.slice(0,n);let r=0;for(;r<e.length;){const s=e[r];if(Pb(s)){const g=v7(s.outlets);return new qi(o,g)}if(0===r&&Ab(e[0])){o.push(new Mb(t.segments[n].path,jR(e[0]))),r++;continue}const l=Pb(s)?s.outlets[Ii]:`${s}`,h=r<e.length-1?e[r+1]:null;l&&h&&Ab(h)?(o.push(new Mb(l,jR(h))),r+=2):(o.push(new Mb(l,{})),r++)}return new qi(o,{})}function v7(t){const n={};return Gs(t,(e,o)=>{"string"==typeof e&&(e=[e]),null!==e&&(n[o]=yD(new qi([],{}),0,e))}),n}function jR(t){const n={};return Gs(t,(e,o)=>n[o]=`${e}`),n}function HR(t,n,e){return t==e.path&&_d(n,e.parameters)}const Ob="imperative";class yd{constructor(n,e){this.id=n,this.url=e}}class vD extends yd{constructor(n,e,o="imperative",r=null){super(n,e),this.type=0,this.navigationTrigger=o,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class og extends yd{constructor(n,e,o){super(n,e),this.urlAfterRedirects=o,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Cw extends yd{constructor(n,e,o,r){super(n,e),this.reason=o,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Tw extends yd{constructor(n,e,o,r){super(n,e),this.reason=o,this.code=r,this.type=16}}class bD extends yd{constructor(n,e,o,r){super(n,e),this.error=o,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class b7 extends yd{constructor(n,e,o,r){super(n,e),this.urlAfterRedirects=o,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class x7 extends yd{constructor(n,e,o,r){super(n,e),this.urlAfterRedirects=o,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class w7 extends yd{constructor(n,e,o,r,s){super(n,e),this.urlAfterRedirects=o,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class C7 extends yd{constructor(n,e,o,r){super(n,e),this.urlAfterRedirects=o,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class T7 extends yd{constructor(n,e,o,r){super(n,e),this.urlAfterRedirects=o,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class E7{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class S7{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class D7{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class M7{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class I7{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class k7{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $R{constructor(n,e,o){this.routerEvent=n,this.position=e,this.anchor=o,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let O7=(()=>{class t{createUrlTree(e,o,r,s,l,h){return f7(e||o.root,r,s,l,h)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})(),L7=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:function(n){return O7.\u0275fac(n)},providedIn:"root"}),t})();class GR{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){const e=xD(n,this._root);return e?e.children.map(o=>o.value):[]}firstChild(n){const e=xD(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){const e=wD(n,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==n)}pathFromRoot(n){return wD(n,this._root).map(e=>e.value)}}function xD(t,n){if(t===n.value)return n;for(const e of n.children){const o=xD(t,e);if(o)return o}return null}function wD(t,n){if(t===n.value)return[n];for(const e of n.children){const o=wD(t,e);if(o.length)return o.unshift(n),o}return[]}class Oh{constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}}function oy(t){const n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}class WR extends GR{constructor(n,e){super(n),this.snapshot=e,CD(this,n)}toString(){return this.snapshot.toString()}}function qR(t,n){const e=function F7(t,n){const l=new Ew([],{},{},"",{},Ii,n,null,t.root,-1,{});return new KR("",new Oh(l,[]))}(t,n),o=new sc([new Mb("",{})]),r=new sc({}),s=new sc({}),l=new sc({}),h=new sc(""),g=new rg(o,r,l,h,s,Ii,n,e.root);return g.snapshot=e.root,new WR(new Oh(g,[]),e)}class rg{constructor(n,e,o,r,s,l,h,g){this.url=n,this.params=e,this.queryParams=o,this.fragment=r,this.data=s,this.outlet=l,this.component=h,this.title=this.data?.pipe(Nn(b=>b[Db]))??Gn(void 0),this._futureSnapshot=g}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Nn(n=>ey(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Nn(n=>ey(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ZR(t,n="emptyOnly"){const e=t.pathFromRoot;let o=0;if("always"!==n)for(o=e.length-1;o>=1;){const r=e[o],s=e[o-1];if(r.routeConfig&&""===r.routeConfig.path)o--;else{if(s.component)break;o--}}return function z7(t){return t.reduce((n,e)=>({params:{...n.params,...e.params},data:{...n.data,...e.data},resolve:{...e.data,...n.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(o))}class Ew{get title(){return this.data?.[Db]}constructor(n,e,o,r,s,l,h,g,b,T,I){this.url=n,this.params=e,this.queryParams=o,this.fragment=r,this.data=s,this.outlet=l,this.component=h,this.routeConfig=g,this._urlSegment=b,this._lastPathIndex=T,this._resolve=I}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ey(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ey(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(o=>o.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class KR extends GR{constructor(n,e){super(e),this.url=n,CD(this,e)}toString(){return XR(this._root)}}function CD(t,n){n.value._routerState=t,n.children.forEach(e=>CD(t,e))}function XR(t){const n=t.children.length>0?` { ${t.children.map(XR).join(", ")} } `:"";return`${t.value}${n}`}function TD(t){if(t.snapshot){const n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,_d(n.queryParams,e.queryParams)||t.queryParams.next(e.queryParams),n.fragment!==e.fragment&&t.fragment.next(e.fragment),_d(n.params,e.params)||t.params.next(e.params),function X$(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!_d(t[e],n[e]))return!1;return!0}(n.url,e.url)||t.url.next(e.url),_d(n.data,e.data)||t.data.next(e.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function ED(t,n){const e=_d(t.params,n.params)&&function e7(t,n){return ng(t,n)&&t.every((e,o)=>_d(e.parameters,n[o].parameters))}(t.url,n.url);return e&&!(!t.parent!=!n.parent)&&(!t.parent||ED(t.parent,n.parent))}function Rb(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){const o=e.value;o._futureSnapshot=n.value;const r=function B7(t,n,e){return n.children.map(o=>{for(const r of e.children)if(t.shouldReuseRoute(o.value,r.value.snapshot))return Rb(t,o,r);return Rb(t,o)})}(t,n,e);return new Oh(o,r)}{if(t.shouldAttach(n.value)){const s=t.retrieve(n.value);if(null!==s){const l=s.route;return l.value._futureSnapshot=n.value,l.children=n.children.map(h=>Rb(t,h)),l}}const o=function V7(t){return new rg(new sc(t.url),new sc(t.params),new sc(t.queryParams),new sc(t.fragment),new sc(t.data),t.outlet,t.component,t)}(n.value),r=n.children.map(s=>Rb(t,s));return new Oh(o,r)}}const SD="ngNavigationCancelingError";function YR(t,n){const{redirectTo:e,navigationBehaviorOptions:o}=ig(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,r=QR(!1,0,n);return r.url=e,r.navigationBehaviorOptions=o,r}function QR(t,n,e){const o=new Error("NavigationCancelingError: "+(t||""));return o[SD]=!0,o.cancellationCode=n,e&&(o.url=e),o}function JR(t){return eL(t)&&ig(t.url)}function eL(t){return t&&t[SD]}class U7{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Lb,this.attachRef=null}}let Lb=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(e,o){const r=this.getOrCreateContext(e);r.outlet=o,this.contexts.set(e,r)}onChildOutletDestroyed(e){const o=this.getContext(e);o&&(o.outlet=null,o.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let o=this.getContext(e);return o||(o=new U7,this.contexts.set(e,o)),o}getContext(e){return this.contexts.get(e)||null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Sw=!1;let Dw=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ii,this.activateEvents=new Tt,this.deactivateEvents=new Tt,this.attachEvents=new Tt,this.detachEvents=new Tt,this.parentContexts=ti(Lb),this.location=ti(au),this.changeDetector=ti(Po),this.environmentInjector=ti(Ql)}ngOnChanges(e){if(e.name){const{firstChange:o,previousValue:r}=e.name;if(o)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Dt(4012,Sw);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Dt(4012,Sw);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Dt(4012,Sw);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,o){this.activated=e,this._activatedRoute=o,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,o){if(this.isActivated)throw new Dt(4013,Sw);this._activatedRoute=e;const r=this.location,l=e.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,g=new j7(e,h,r.injector);if(o&&function H7(t){return!!t.resolveComponentFactory}(o)){const b=o.resolveComponentFactory(l);this.activated=r.createComponent(b,r.length,g)}else this.activated=r.createComponent(l,{index:r.length,injector:g,environmentInjector:o??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=kn({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ur]}),t})();class j7{constructor(n,e,o){this.route=n,this.childContexts=e,this.parent=o}get(n,e){return n===rg?this.route:n===Lb?this.childContexts:this.parent.get(n,e)}}let DD=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["ng-component"]],standalone:!0,features:[bI],decls:1,vars:0,template:function(e,o){1&e&&Ne(0,"router-outlet")},dependencies:[Dw],encapsulation:2}),t})();function tL(t,n){return t.providers&&!t._injector&&(t._injector=Yx(t.providers,n,`Route: ${t.path}`)),t._injector??n}function ID(t){const n=t.children&&t.children.map(ID),e=n?{...t,children:n}:{...t};return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==Ii&&(e.component=DD),e}function hc(t){return t.outlet||Ii}function nL(t,n){const e=t.filter(o=>hc(o)===n);return e.push(...t.filter(o=>hc(o)!==n)),e}function Fb(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let n=t.parent;n;n=n.parent){const e=n.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class Z7{constructor(n,e,o,r){this.routeReuseStrategy=n,this.futureState=e,this.currState=o,this.forwardEvent=r}activate(n){const e=this.futureState._root,o=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,o,n),TD(this.futureState.root),this.activateChildRoutes(e,o,n)}deactivateChildRoutes(n,e,o){const r=oy(e);n.children.forEach(s=>{const l=s.value.outlet;this.deactivateRoutes(s,r[l],o),delete r[l]}),Gs(r,(s,l)=>{this.deactivateRouteAndItsChildren(s,o)})}deactivateRoutes(n,e,o){const r=n.value,s=e?e.value:null;if(r===s)if(r.component){const l=o.getContext(r.outlet);l&&this.deactivateChildRoutes(n,e,l.children)}else this.deactivateChildRoutes(n,e,o);else s&&this.deactivateRouteAndItsChildren(e,o)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){const o=e.getContext(n.value.outlet),r=o&&n.value.component?o.children:e,s=oy(n);for(const l of Object.keys(s))this.deactivateRouteAndItsChildren(s[l],r);if(o&&o.outlet){const l=o.outlet.detach(),h=o.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:l,route:n,contexts:h})}}deactivateRouteAndOutlet(n,e){const o=e.getContext(n.value.outlet),r=o&&n.value.component?o.children:e,s=oy(n);for(const l of Object.keys(s))this.deactivateRouteAndItsChildren(s[l],r);o&&o.outlet&&(o.outlet.deactivate(),o.children.onOutletDeactivated(),o.attachRef=null,o.resolver=null,o.route=null)}activateChildRoutes(n,e,o){const r=oy(e);n.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],o),this.forwardEvent(new k7(s.value.snapshot))}),n.children.length&&this.forwardEvent(new M7(n.value.snapshot))}activateRoutes(n,e,o){const r=n.value,s=e?e.value:null;if(TD(r),r===s)if(r.component){const l=o.getOrCreateContext(r.outlet);this.activateChildRoutes(n,e,l.children)}else this.activateChildRoutes(n,e,o);else if(r.component){const l=o.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const h=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),TD(h.route.value),this.activateChildRoutes(n,null,l.children)}else{const h=Fb(r.snapshot),g=h?.get(ir)??null;l.attachRef=null,l.route=r,l.resolver=g,l.injector=h,l.outlet&&l.outlet.activateWith(r,l.injector),this.activateChildRoutes(n,null,l.children)}}else this.activateChildRoutes(n,null,o)}}class iL{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class Mw{constructor(n,e){this.component=n,this.route=e}}function K7(t,n,e){const o=t._root;return zb(o,n?n._root:null,e,[o.value])}function ry(t,n){const e=Symbol(),o=n.get(t,e);return o===e?"function"!=typeof t||function Nd(t){return null!==zd(t)}(t)?n.get(t):t:o}function zb(t,n,e,o,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=oy(n);return t.children.forEach(l=>{(function Y7(t,n,e,o,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,l=n?n.value:null,h=e?e.getContext(t.value.outlet):null;if(l&&s.routeConfig===l.routeConfig){const g=function Q7(t,n,e){if("function"==typeof e)return e(t,n);switch(e){case"pathParamsChange":return!ng(t.url,n.url);case"pathParamsOrQueryParamsChange":return!ng(t.url,n.url)||!_d(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ED(t,n)||!_d(t.queryParams,n.queryParams);default:return!ED(t,n)}}(l,s,s.routeConfig.runGuardsAndResolvers);g?r.canActivateChecks.push(new iL(o)):(s.data=l.data,s._resolvedData=l._resolvedData),zb(t,n,s.component?h?h.children:null:e,o,r),g&&h&&h.outlet&&h.outlet.isActivated&&r.canDeactivateChecks.push(new Mw(h.outlet.component,l))}else l&&Nb(n,h,r),r.canActivateChecks.push(new iL(o)),zb(t,null,s.component?h?h.children:null:e,o,r)})(l,s[l.value.outlet],e,o.concat([l.value]),r),delete s[l.value.outlet]}),Gs(s,(l,h)=>Nb(l,e.getContext(h),r)),r}function Nb(t,n,e){const o=oy(t),r=t.value;Gs(o,(s,l)=>{Nb(s,r.component?n?n.children.getContext(l):null:n,e)}),e.canDeactivateChecks.push(new Mw(r.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,r))}function Bb(t){return"function"==typeof t}function kD(t){return t instanceof fw||"EmptyError"===t?.name}const Iw=Symbol("INITIAL_VALUE");function sy(){return gd(t=>ES(t.map(n=>n.pipe(fd(1),j1(Iw)))).pipe(Nn(n=>{for(const e of n)if(!0!==e){if(e===Iw)return Iw;if(!1===e||e instanceof hf)return e}return!0}),$s(n=>n!==Iw),fd(1)))}function oL(t){return function qs(...t){return Ps(t)}(_s(n=>{if(ig(n))throw YR(0,n)}),Nn(n=>!0===n))}const AD={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function rL(t,n,e,o,r){const s=PD(t,n,e);return s.matched?function mG(t,n,e,o){const r=n.canMatch;return r&&0!==r.length?Gn(r.map(l=>{const h=ry(l,t);return df(function oG(t){return t&&Bb(t.canMatch)}(h)?h.canMatch(n,e):t.runInContext(()=>h(n,e)))})).pipe(sy(),oL()):Gn(!0)}(o=tL(n,o),n,e).pipe(Nn(l=>!0===l?s:{...AD})):Gn(s)}function PD(t,n,e){if(""===n.path)return"full"===n.pathMatch&&(t.hasChildren()||e.length>0)?{...AD}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const r=(n.matcher||K$)(e,t,n);if(!r)return{...AD};const s={};Gs(r.posParams,(h,g)=>{s[g]=h.path});const l=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:l,positionalParamSegments:r.posParams??{}}}function kw(t,n,e,o){if(e.length>0&&function yG(t,n,e){return e.some(o=>Aw(t,n,o)&&hc(o)!==Ii)}(t,e,o)){const s=new qi(n,function _G(t,n,e,o){const r={};r[Ii]=o,o._sourceSegment=t,o._segmentIndexShift=n.length;for(const s of e)if(""===s.path&&hc(s)!==Ii){const l=new qi([],{});l._sourceSegment=t,l._segmentIndexShift=n.length,r[hc(s)]=l}return r}(t,n,o,new qi(e,t.children)));return s._sourceSegment=t,s._segmentIndexShift=n.length,{segmentGroup:s,slicedSegments:[]}}if(0===e.length&&function vG(t,n,e){return e.some(o=>Aw(t,n,o))}(t,e,o)){const s=new qi(t.segments,function gG(t,n,e,o,r){const s={};for(const l of o)if(Aw(t,e,l)&&!r[hc(l)]){const h=new qi([],{});h._sourceSegment=t,h._segmentIndexShift=n.length,s[hc(l)]=h}return{...r,...s}}(t,n,e,o,t.children));return s._sourceSegment=t,s._segmentIndexShift=n.length,{segmentGroup:s,slicedSegments:e}}const r=new qi(t.segments,t.children);return r._sourceSegment=t,r._segmentIndexShift=n.length,{segmentGroup:r,slicedSegments:e}}function Aw(t,n,e){return(!(t.hasChildren()||n.length>0)||"full"!==e.pathMatch)&&""===e.path}function sL(t,n,e,o){return!!(hc(t)===o||o!==Ii&&Aw(n,e,t))&&("**"===t.path||PD(n,t,e).matched)}function aL(t,n,e){return 0===n.length&&!t.children[e]}const Pw=!1;class Ow{constructor(n){this.segmentGroup=n||null}}class lL{constructor(n){this.urlTree=n}}function Vb(t){return X_(new Ow(t))}function cL(t){return X_(new lL(t))}class CG{constructor(n,e,o,r,s){this.injector=n,this.configLoader=e,this.urlSerializer=o,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const n=kw(this.urlTree.root,[],[],this.config).segmentGroup,e=new qi(n.segments,n.children);return this.expandSegmentGroup(this.injector,this.config,e,Ii).pipe(Nn(s=>this.createUrlTree(ww(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ih(s=>{if(s instanceof lL)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Ow?this.noMatchError(s):s}))}match(n){return this.expandSegmentGroup(this.injector,this.config,n.root,Ii).pipe(Nn(r=>this.createUrlTree(ww(r),n.queryParams,n.fragment))).pipe(Ih(r=>{throw r instanceof Ow?this.noMatchError(r):r}))}noMatchError(n){return new Dt(4002,Pw)}createUrlTree(n,e,o){const r=mD(n);return new hf(r,e,o)}expandSegmentGroup(n,e,o,r){return 0===o.segments.length&&o.hasChildren()?this.expandChildren(n,e,o).pipe(Nn(s=>new qi([],s))):this.expandSegment(n,o,e,o.segments,r,!0)}expandChildren(n,e,o){const r=[];for(const s of Object.keys(o.children))"primary"===s?r.unshift(s):r.push(s);return Wo(r).pipe(rf(s=>{const l=o.children[s],h=nL(e,s);return this.expandSegmentGroup(n,h,l,s).pipe(Nn(g=>({segment:g,outlet:s})))}),CR((s,l)=>(s[l.outlet]=l.segment,s),{}),TR())}expandSegment(n,e,o,r,s,l){return Wo(o).pipe(rf(h=>this.expandSegmentAgainstRoute(n,e,o,h,r,s,l).pipe(Ih(b=>{if(b instanceof Ow)return Gn(null);throw b}))),uf(h=>!!h),Ih((h,g)=>{if(kD(h))return aL(e,r,s)?Gn(new qi([],{})):Vb(e);throw h}))}expandSegmentAgainstRoute(n,e,o,r,s,l,h){return sL(r,e,s,l)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(n,e,r,s,l):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,e,o,r,s,l):Vb(e):Vb(e)}expandSegmentAgainstRouteUsingRedirect(n,e,o,r,s,l){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,o,r,l):this.expandRegularSegmentAgainstRouteUsingRedirect(n,e,o,r,s,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,e,o,r){const s=this.applyRedirectCommands([],o.redirectTo,{});return o.redirectTo.startsWith("/")?cL(s):this.lineralizeSegments(o,s).pipe(St(l=>{const h=new qi(l,{});return this.expandSegment(n,h,e,l,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,e,o,r,s,l){const{matched:h,consumedSegments:g,remainingSegments:b,positionalParamSegments:T}=PD(e,r,s);if(!h)return Vb(e);const I=this.applyRedirectCommands(g,r.redirectTo,T);return r.redirectTo.startsWith("/")?cL(I):this.lineralizeSegments(r,I).pipe(St(R=>this.expandSegment(n,e,o,R.concat(b),l,!1)))}matchSegmentAgainstRoute(n,e,o,r,s){return"**"===o.path?(n=tL(o,n),o.loadChildren?(o._loadedRoutes?Gn({routes:o._loadedRoutes,injector:o._loadedInjector}):this.configLoader.loadChildren(n,o)).pipe(Nn(h=>(o._loadedRoutes=h.routes,o._loadedInjector=h.injector,new qi(r,{})))):Gn(new qi(r,{}))):rL(e,o,r,n).pipe(gd(({matched:l,consumedSegments:h,remainingSegments:g})=>l?this.getChildConfig(n=o._injector??n,o,r).pipe(St(T=>{const I=T.injector??n,R=T.routes,{segmentGroup:z,slicedSegments:W}=kw(e,h,g,R),X=new qi(z.segments,z.children);if(0===W.length&&X.hasChildren())return this.expandChildren(I,R,X).pipe(Nn(xe=>new qi(h,xe)));if(0===R.length&&0===W.length)return Gn(new qi(h,{}));const ee=hc(o)===s;return this.expandSegment(I,X,R,W,ee?Ii:s,!0).pipe(Nn(ve=>new qi(h.concat(ve.segments),ve.children)))})):Vb(e)))}getChildConfig(n,e,o){return e.children?Gn({routes:e.children,injector:n}):e.loadChildren?void 0!==e._loadedRoutes?Gn({routes:e._loadedRoutes,injector:e._loadedInjector}):function fG(t,n,e,o){const r=n.canLoad;return void 0===r||0===r.length?Gn(!0):Gn(r.map(l=>{const h=ry(l,t);return df(function eG(t){return t&&Bb(t.canLoad)}(h)?h.canLoad(n,e):t.runInContext(()=>h(n,e)))})).pipe(sy(),oL())}(n,e,o).pipe(St(r=>r?this.configLoader.loadChildren(n,e).pipe(_s(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):function xG(t){return X_(QR(Pw,3))}())):Gn({routes:[],injector:n})}lineralizeSegments(n,e){let o=[],r=e.root;for(;;){if(o=o.concat(r.segments),0===r.numberOfChildren)return Gn(o);if(r.numberOfChildren>1||!r.children[Ii])return n.redirectTo,X_(new Dt(4e3,Pw));r=r.children[Ii]}}applyRedirectCommands(n,e,o){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),n,o)}applyRedirectCreateUrlTree(n,e,o,r){const s=this.createSegmentGroup(n,e.root,o,r);return new hf(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){const o={};return Gs(n,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const h=r.substring(1);o[s]=e[h]}else o[s]=r}),o}createSegmentGroup(n,e,o,r){const s=this.createSegments(n,e.segments,o,r);let l={};return Gs(e.children,(h,g)=>{l[g]=this.createSegmentGroup(n,h,o,r)}),new qi(s,l)}createSegments(n,e,o,r){return e.map(s=>s.path.startsWith(":")?this.findPosParam(n,s,r):this.findOrReturn(s,o))}findPosParam(n,e,o){const r=o[e.path.substring(1)];if(!r)throw new Dt(4001,Pw);return r}findOrReturn(n,e){let o=0;for(const r of e){if(r.path===n.path)return e.splice(o),r;o++}return n}}class EG{}class MG{constructor(n,e,o,r,s,l,h){this.injector=n,this.rootComponentType=e,this.config=o,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=l,this.urlSerializer=h}recognize(){const n=kw(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,Ii).pipe(Nn(e=>{if(null===e)return null;const o=new Ew([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ii,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Oh(o,e),s=new KR(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(n){const e=n.value,o=ZR(e,this.paramsInheritanceStrategy);e.params=Object.freeze(o.params),e.data=Object.freeze(o.data),n.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(n,e,o,r){return 0===o.segments.length&&o.hasChildren()?this.processChildren(n,e,o):this.processSegment(n,e,o,o.segments,r)}processChildren(n,e,o){return Wo(Object.keys(o.children)).pipe(rf(r=>{const s=o.children[r],l=nL(e,r);return this.processSegmentGroup(n,l,s,r)}),CR((r,s)=>r&&s?(r.push(...s),r):null),function q$(t,n=!1){return ji((e,o)=>{let r=0;e.subscribe(Yn(o,s=>{const l=t(s,r++);(l||n)&&o.next(s),!l&&o.complete()}))})}(r=>null!==r),mw(null),TR(),Nn(r=>{if(null===r)return null;const s=dL(r);return function IG(t){t.sort((n,e)=>n.value.outlet===Ii?-1:e.value.outlet===Ii?1:n.value.outlet.localeCompare(e.value.outlet))}(s),s}))}processSegment(n,e,o,r,s){return Wo(e).pipe(rf(l=>this.processSegmentAgainstRoute(l._injector??n,l,o,r,s)),uf(l=>!!l),Ih(l=>{if(kD(l))return aL(o,r,s)?Gn([]):Gn(null);throw l}))}processSegmentAgainstRoute(n,e,o,r,s){if(e.redirectTo||!sL(e,o,r,s))return Gn(null);let l;if("**"===e.path){const h=r.length>0?DR(r).parameters:{},g=pL(o)+r.length;l=Gn({snapshot:new Ew(r,h,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,fL(e),hc(e),e.component??e._loadedComponent??null,e,hL(o),g,mL(e)),consumedSegments:[],remainingSegments:[]})}else l=rL(o,e,r,n).pipe(Nn(({matched:h,consumedSegments:g,remainingSegments:b,parameters:T})=>{if(!h)return null;const I=pL(o)+g.length;return{snapshot:new Ew(g,T,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,fL(e),hc(e),e.component??e._loadedComponent??null,e,hL(o),I,mL(e)),consumedSegments:g,remainingSegments:b}}));return l.pipe(gd(h=>{if(null===h)return Gn(null);const{snapshot:g,consumedSegments:b,remainingSegments:T}=h;n=e._injector??n;const I=e._loadedInjector??n,R=function kG(t){return t.children?t.children:t.loadChildren?t._loadedRoutes:[]}(e),{segmentGroup:z,slicedSegments:W}=kw(o,b,T,R.filter(ee=>void 0===ee.redirectTo));if(0===W.length&&z.hasChildren())return this.processChildren(I,R,z).pipe(Nn(ee=>null===ee?null:[new Oh(g,ee)]));if(0===R.length&&0===W.length)return Gn([new Oh(g,[])]);const X=hc(e)===s;return this.processSegment(I,R,z,W,X?Ii:s).pipe(Nn(ee=>null===ee?null:[new Oh(g,ee)]))}))}}function AG(t){const n=t.value.routeConfig;return n&&""===n.path&&void 0===n.redirectTo}function dL(t){const n=[],e=new Set;for(const o of t){if(!AG(o)){n.push(o);continue}const r=n.find(s=>o.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...o.children),e.add(r)):n.push(o)}for(const o of e){const r=dL(o.children);n.push(new Oh(o.value,r))}return n.filter(o=>!e.has(o))}function hL(t){let n=t;for(;n._sourceSegment;)n=n._sourceSegment;return n}function pL(t){let n=t,e=n._segmentIndexShift??0;for(;n._sourceSegment;)n=n._sourceSegment,e+=n._segmentIndexShift??0;return e-1}function fL(t){return t.data||{}}function mL(t){return t.resolve||{}}function gL(t){return"string"==typeof t.title||null===t.title}function OD(t){return gd(n=>{const e=t(n);return e?Wo(e).pipe(Nn(()=>n)):Gn(n)})}const ay=new sn("ROUTES");let RD=(()=>{class t{constructor(e,o){this.injector=e,this.compiler=o,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Gn(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const o=df(e.loadComponent()).pipe(Nn(yL),_s(s=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=s}),$1(()=>{this.componentLoaders.delete(e)})),r=new xR(o,()=>new gi).pipe(uD());return this.componentLoaders.set(e,r),r}loadChildren(e,o){if(this.childrenLoaders.get(o))return this.childrenLoaders.get(o);if(o._loadedRoutes)return Gn({routes:o._loadedRoutes,injector:o._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(o);const s=this.loadModuleFactoryOrRoutes(o.loadChildren).pipe(Nn(h=>{this.onLoadEndListener&&this.onLoadEndListener(o);let g,b,T=!1;Array.isArray(h)?b=h:(g=h.create(e).injector,b=SR(g.get(ay,[],Wn.Self|Wn.Optional)));return{routes:b.map(ID),injector:g}}),$1(()=>{this.childrenLoaders.delete(o)})),l=new xR(s,()=>new gi).pipe(uD());return this.childrenLoaders.set(o,l),l}loadModuleFactoryOrRoutes(e){return df(e()).pipe(Nn(yL),St(r=>r instanceof yI||Array.isArray(r)?Gn(r):Wo(this.compiler.compileModuleAsync(r))))}}return t.\u0275fac=function(e){return new(e||t)(Rt(Ds),Rt(sk))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function yL(t){return function VG(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let Lw=(()=>{class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new gi,this.configLoader=ti(RD),this.environmentInjector=ti(Ql),this.urlSerializer=ti(Ib),this.rootContexts=ti(Lb),this.navigationId=0,this.afterPreactivation=()=>Gn(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new S7(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new E7(r))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const o=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:o})}setupNavigations(e){return this.transitions=new sc({id:0,targetPageId:0,currentUrlTree:e.currentUrlTree,currentRawUrl:e.currentUrlTree,extractedUrl:e.urlHandlingStrategy.extract(e.currentUrlTree),urlAfterRedirects:e.urlHandlingStrategy.extract(e.currentUrlTree),rawUrl:e.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ob,restoredState:null,currentSnapshot:e.routerState.snapshot,targetSnapshot:null,currentRouterState:e.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe($s(o=>0!==o.id),Nn(o=>({...o,extractedUrl:e.urlHandlingStrategy.extract(o.rawUrl)})),gd(o=>{let r=!1,s=!1;return Gn(o).pipe(_s(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),gd(l=>{const h=e.browserUrlTree.toString(),g=!e.navigated||l.extractedUrl.toString()!==h||h!==e.currentUrlTree.toString();if(!g&&"reload"!==(l.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const T="";return this.events.next(new Tw(l.id,e.serializeUrl(o.rawUrl),T,0)),e.rawUrlTree=l.rawUrl,l.resolve(null),dn}if(e.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return vL(l.source)&&(e.browserUrlTree=l.extractedUrl),Gn(l).pipe(gd(T=>{const I=this.transitions?.getValue();return this.events.next(new vD(T.id,this.urlSerializer.serialize(T.extractedUrl),T.source,T.restoredState)),I!==this.transitions?.getValue()?dn:Promise.resolve(T)}),function TG(t,n,e,o){return gd(r=>function wG(t,n,e,o,r){return new CG(t,n,e,o,r).apply()}(t,n,e,r.extractedUrl,o).pipe(Nn(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,e.config),_s(T=>{this.currentNavigation={...this.currentNavigation,finalUrl:T.urlAfterRedirects},o.urlAfterRedirects=T.urlAfterRedirects}),function OG(t,n,e,o,r){return St(s=>function DG(t,n,e,o,r,s,l="emptyOnly"){return new MG(t,n,e,o,r,l,s).recognize().pipe(gd(h=>null===h?function SG(t){return new Jn(n=>n.error(t))}(new EG):Gn(h)))}(t,n,e,s.urlAfterRedirects,o.serialize(s.urlAfterRedirects),o,r).pipe(Nn(l=>({...s,targetSnapshot:l}))))}(this.environmentInjector,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),_s(T=>{if(o.targetSnapshot=T.targetSnapshot,"eager"===e.urlUpdateStrategy){if(!T.extras.skipLocationChange){const R=e.urlHandlingStrategy.merge(T.urlAfterRedirects,T.rawUrl);e.setBrowserUrl(R,T)}e.browserUrlTree=T.urlAfterRedirects}const I=new b7(T.id,this.urlSerializer.serialize(T.extractedUrl),this.urlSerializer.serialize(T.urlAfterRedirects),T.targetSnapshot);this.events.next(I)}));if(g&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){const{id:T,extractedUrl:I,source:R,restoredState:z,extras:W}=l,X=new vD(T,this.urlSerializer.serialize(I),R,z);this.events.next(X);const ee=qR(I,this.rootComponentType).snapshot;return Gn(o={...l,targetSnapshot:ee,urlAfterRedirects:I,extras:{...W,skipLocationChange:!1,replaceUrl:!1}})}{const T="";return this.events.next(new Tw(l.id,e.serializeUrl(o.extractedUrl),T,1)),e.rawUrlTree=l.rawUrl,l.resolve(null),dn}}),_s(l=>{const h=new x7(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),Nn(l=>o={...l,guards:K7(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),function sG(t,n){return St(e=>{const{targetSnapshot:o,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:l}}=e;return 0===l.length&&0===s.length?Gn({...e,guardsResult:!0}):function aG(t,n,e,o){return Wo(t).pipe(St(r=>function pG(t,n,e,o,r){const s=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return s&&0!==s.length?Gn(s.map(h=>{const g=Fb(n)??r,b=ry(h,g);return df(function iG(t){return t&&Bb(t.canDeactivate)}(b)?b.canDeactivate(t,n,e,o):g.runInContext(()=>b(t,n,e,o))).pipe(uf())})).pipe(sy()):Gn(!0)}(r.component,r.route,e,n,o)),uf(r=>!0!==r,!0))}(l,o,r,t).pipe(St(h=>h&&function J7(t){return"boolean"==typeof t}(h)?function lG(t,n,e,o){return Wo(n).pipe(rf(r=>V1(function uG(t,n){return null!==t&&n&&n(new D7(t)),Gn(!0)}(r.route.parent,o),function cG(t,n){return null!==t&&n&&n(new I7(t)),Gn(!0)}(r.route,o),function hG(t,n,e){const o=n[n.length-1],s=n.slice(0,n.length-1).reverse().map(l=>function X7(t){const n=t.routeConfig?t.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:t,guards:n}:null}(l)).filter(l=>null!==l).map(l=>bR(()=>Gn(l.guards.map(g=>{const b=Fb(l.node)??e,T=ry(g,b);return df(function nG(t){return t&&Bb(t.canActivateChild)}(T)?T.canActivateChild(o,t):b.runInContext(()=>T(o,t))).pipe(uf())})).pipe(sy())));return Gn(s).pipe(sy())}(t,r.path,e),function dG(t,n,e){const o=n.routeConfig?n.routeConfig.canActivate:null;if(!o||0===o.length)return Gn(!0);const r=o.map(s=>bR(()=>{const l=Fb(n)??e,h=ry(s,l);return df(function tG(t){return t&&Bb(t.canActivate)}(h)?h.canActivate(n,t):l.runInContext(()=>h(n,t))).pipe(uf())}));return Gn(r).pipe(sy())}(t,r.route,e))),uf(r=>!0!==r,!0))}(o,s,t,n):Gn(h)),Nn(h=>({...e,guardsResult:h})))})}(this.environmentInjector,l=>this.events.next(l)),_s(l=>{if(o.guardsResult=l.guardsResult,ig(l.guardsResult))throw YR(0,l.guardsResult);const h=new w7(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),$s(l=>!!l.guardsResult||(e.restoreHistory(l),this.cancelNavigationTransition(l,"",3),!1)),OD(l=>{if(l.guards.canActivateChecks.length)return Gn(l).pipe(_s(h=>{const g=new C7(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(g)}),gd(h=>{let g=!1;return Gn(h).pipe(function RG(t,n){return St(e=>{const{targetSnapshot:o,guards:{canActivateChecks:r}}=e;if(!r.length)return Gn(e);let s=0;return Wo(r).pipe(rf(l=>function LG(t,n,e,o){const r=t.routeConfig,s=t._resolve;return void 0!==r?.title&&!gL(r)&&(s[Db]=r.title),function FG(t,n,e,o){const r=function zG(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}(t);if(0===r.length)return Gn({});const s={};return Wo(r).pipe(St(l=>function NG(t,n,e,o){const r=Fb(n)??o,s=ry(t,r);return df(s.resolve?s.resolve(n,e):r.runInContext(()=>s(n,e)))}(t[l],n,e,o).pipe(uf(),_s(h=>{s[l]=h}))),dD(1),hD(s),Ih(l=>kD(l)?dn:X_(l)))}(s,t,n,o).pipe(Nn(l=>(t._resolvedData=l,t.data=ZR(t,e).resolve,r&&gL(r)&&(t.data[Db]=r.title),null)))}(l.route,o,t,n)),_s(()=>s++),dD(1),St(l=>s===r.length?Gn(e):dn))})}(e.paramsInheritanceStrategy,this.environmentInjector),_s({next:()=>g=!0,complete:()=>{g||(e.restoreHistory(h),this.cancelNavigationTransition(h,"",2))}}))}),_s(h=>{const g=new T7(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(g)}))}),OD(l=>{const h=g=>{const b=[];g.routeConfig?.loadComponent&&!g.routeConfig._loadedComponent&&b.push(this.configLoader.loadComponent(g.routeConfig).pipe(_s(T=>{g.component=T}),Nn(()=>{})));for(const T of g.children)b.push(...h(T));return b};return ES(h(l.targetSnapshot.root)).pipe(mw(),fd(1))}),OD(()=>this.afterPreactivation()),Nn(l=>{const h=function N7(t,n,e){const o=Rb(t,n._root,e?e._root:void 0);return new WR(o,n)}(e.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return o={...l,targetRouterState:h}}),_s(l=>{e.currentUrlTree=l.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(l.urlAfterRedirects,l.rawUrl),e.routerState=l.targetRouterState,"deferred"===e.urlUpdateStrategy&&(l.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,l),e.browserUrlTree=l.urlAfterRedirects)}),((t,n,e)=>Nn(o=>(new Z7(n,o.targetRouterState,o.currentRouterState,e).activate(t),o)))(this.rootContexts,e.routeReuseStrategy,l=>this.events.next(l)),_s({next:l=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,e.navigated=!0,this.events.next(new og(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(e.currentUrlTree))),e.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{r=!0}}),$1(()=>{r||s||this.cancelNavigationTransition(o,"",1),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Ih(l=>{if(s=!0,eL(l)){JR(l)||(e.navigated=!0,e.restoreHistory(o,!0));const h=new Cw(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode);if(this.events.next(h),JR(l)){const g=e.urlHandlingStrategy.merge(l.url,e.rawUrlTree),b={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy||vL(o.source)};e.scheduleNavigation(g,Ob,null,b,{resolve:o.resolve,reject:o.reject,promise:o.promise})}else o.resolve(!1)}else{e.restoreHistory(o,!0);const h=new bD(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0);this.events.next(h);try{o.resolve(e.errorHandler(l))}catch(g){o.reject(g)}}return dn}))}))}cancelNavigationTransition(e,o,r){const s=new Cw(e.id,this.urlSerializer.serialize(e.extractedUrl),o,r);this.events.next(s),e.resolve(!1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function vL(t){return t!==Ob}let bL=(()=>{class t{buildTitle(e){let o,r=e.root;for(;void 0!==r;)o=this.getResolvedTitleForRoute(r)??o,r=r.children.find(s=>s.outlet===Ii);return o}getResolvedTitleForRoute(e){return e.data[Db]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:function(){return ti(UG)},providedIn:"root"}),t})(),UG=(()=>{class t extends bL{constructor(e){super(),this.title=e}updateTitle(e){const o=this.buildTitle(e);void 0!==o&&this.title.setTitle(o)}}return t.\u0275fac=function(e){return new(e||t)(Rt(SA))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),jG=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:function(){return ti($G)},providedIn:"root"}),t})();class HG{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}}let $G=(()=>{class t extends HG{}return t.\u0275fac=function(){let n;return function(o){return(n||(n=Cr(t)))(o||t)}}(),t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Fw=new sn("",{providedIn:"root",factory:()=>({})});let WG=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:function(){return ti(qG)},providedIn:"root"}),t})(),qG=(()=>{class t{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,o){return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ZG(t){throw t}function KG(t,n,e){return n.parse("/")}const XG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},YG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let sr=(()=>{class t{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=ti(W4),this.isNgZoneEnabled=!1,this.options=ti(Fw,{optional:!0})||{},this.errorHandler=this.options.errorHandler||ZG,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||KG,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=ti(WG),this.routeReuseStrategy=ti(jG),this.urlCreationStrategy=ti(L7),this.titleStrategy=ti(bL),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=SR(ti(ay,{optional:!0})??[]),this.navigationTransitions=ti(Lw),this.urlSerializer=ti(Ib),this.location=ti(d1),this.isNgZoneEnabled=ti(fi)instanceof fi&&fi.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new hf,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=qR(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Ob,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const o="popstate"===e.type?"popstate":"hashchange";"popstate"===o&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,o,e.state)},0)}))}navigateToSyncWithBrowser(e,o,r){const s={replaceUrl:!0},l=r?.navigationId?r:null;if(r){const g={...r};delete g.navigationId,delete g.\u0275routerPageId,0!==Object.keys(g).length&&(s.state=g)}const h=this.parseUrl(e);this.scheduleNavigation(h,o,l,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(e){this.config=e.map(ID),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,o={}){const{relativeTo:r,queryParams:s,fragment:l,queryParamsHandling:h,preserveFragment:g}=o,b=g?this.currentUrlTree.fragment:l;let T=null;switch(h){case"merge":T={...this.currentUrlTree.queryParams,...s};break;case"preserve":T=this.currentUrlTree.queryParams;break;default:T=s||null}return null!==T&&(T=this.removeEmptyProps(T)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,e,T,b??null)}navigateByUrl(e,o={skipLocationChange:!1}){const r=ig(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Ob,null,o)}navigate(e,o={skipLocationChange:!1}){return function QG(t){for(let n=0;n<t.length;n++){const e=t[n];if(null==e)throw new Dt(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,o),o)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let o;try{o=this.urlSerializer.parse(e)}catch(r){o=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return o}isActive(e,o){let r;if(r=!0===o?{...XG}:!1===o?{...YG}:o,ig(e))return IR(this.currentUrlTree,e,r);const s=this.parseUrl(e);return IR(this.currentUrlTree,s,r)}removeEmptyProps(e){return Object.keys(e).reduce((o,r)=>{const s=e[r];return null!=s&&(o[r]=s),o},{})}scheduleNavigation(e,o,r,s,l){if(this.disposed)return Promise.resolve(!1);let h,g,b,T;return l?(h=l.resolve,g=l.reject,b=l.promise):b=new Promise((I,R)=>{h=I,g=R}),T="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:T,source:o,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:s,resolve:h,reject:g,promise:b,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),b.catch(I=>Promise.reject(I))}setBrowserUrl(e,o){const r=this.urlSerializer.serialize(e),s={...o.extras.state,...this.generateNgRouterState(o.id,o.targetPageId)};this.location.isCurrentPathEqualTo(r)||o.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(e,o=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(o&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,o){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:o}:{navigationId:e}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),sg=(()=>{class t{constructor(e,o,r,s,l,h){this.router=e,this.route=o,this.tabIndexAttribute=r,this.renderer=s,this.el=l,this.locationStrategy=h,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new gi;const g=l.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===g||"area"===g,this.isAnchorElement?this.subscription=e.events.subscribe(b=>{b instanceof og&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=j_(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=j_(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=j_(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,o,r,s,l){return!!(null===this.urlTree||this.isAnchorElement&&(0!==e||o||r||s||l||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const e=null===this.href?null:function ix(t,n,e){return function a_(t,n){return"src"===n&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===n&&("base"===t||"link"===t)?nx:Co}(n,e)(t)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",e)}applyAttributeValue(e,o){const r=this.renderer,s=this.el.nativeElement;null!==o?r.setAttribute(s,e,o):r.removeAttribute(s,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(rg),_p("tabindex"),be(jr),be(si),be(qm))},t.\u0275dir=kn({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(e,o){1&e&&Oe("click",function(s){return o.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&e&&st("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[ur]}),t})(),xL=(()=>{class t{get isActive(){return this._isActive}constructor(e,o,r,s,l){this.router=e,this.element=o,this.renderer=r,this.cdr=s,this.link=l,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Tt,this.routerEventsSubscription=e.events.subscribe(h=>{h instanceof og&&this.update()})}ngAfterContentInit(){Gn(this.links.changes,Gn(null)).pipe(Sn()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const e=[...this.links.toArray(),this.link].filter(o=>!!o).map(o=>o.onChanges);this.linkInputChangesSubscription=Wo(e).pipe(Sn()).subscribe(o=>{this._isActive!==this.isLinkActive(this.router)(o)&&this.update()})}set routerLinkActive(e){const o=Array.isArray(e)?e:e.split(" ");this.classes=o.filter(r=>!!r)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||Promise.resolve().then(()=>{const e=this.hasActiveLinks();this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.classes.forEach(o=>{e?this.renderer.addClass(this.element.nativeElement,o):this.renderer.removeClass(this.element.nativeElement,o)}),e&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(e))})}isLinkActive(e){const o=function JG(t){return!!t.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>!!r.urlTree&&e.isActive(r.urlTree,o)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(si),be(jr),be(Po),be(sg,8))},t.\u0275dir=kn({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(e,o,r){if(1&e&&No(r,sg,5),2&e){let s;mn(s=gn())&&(o.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[ur]}),t})();class wL{}let e9=(()=>{class t{constructor(e,o,r,s,l){this.router=e,this.injector=r,this.preloadingStrategy=s,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe($s(e=>e instanceof og),rf(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,o){const r=[];for(const s of o){s.providers&&!s._injector&&(s._injector=Yx(s.providers,e,`Route: ${s.path}`));const l=s._injector??e,h=s._loadedInjector??l;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(l,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(h,s.children??s._loadedRoutes))}return Wo(r).pipe(Sn())}preloadConfig(e,o){return this.preloadingStrategy.preload(o,()=>{let r;r=o.loadChildren&&void 0===o.canLoad?this.loader.loadChildren(e,o):Gn(null);const s=r.pipe(St(l=>null===l?Gn(void 0):(o._loadedRoutes=l.routes,o._loadedInjector=l.injector,this.processRoutes(l.injector??e,l.routes))));return o.loadComponent&&!o._loadedComponent?Wo([s,this.loader.loadComponent(o)]).pipe(Sn()):s})}}return t.\u0275fac=function(e){return new(e||t)(Rt(sr),Rt(sk),Rt(Ql),Rt(wL),Rt(RD))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const FD=new sn("");let CL=(()=>{class t{constructor(e,o,r,s,l={}){this.urlSerializer=e,this.transitions=o,this.viewportScroller=r,this.zone=s,this.options=l,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},l.scrollPositionRestoration=l.scrollPositionRestoration||"disabled",l.anchorScrolling=l.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof vD?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof og&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof $R&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,o){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new $R(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,o))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return t.\u0275fac=function(e){bh()},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})();var Ml=(()=>((Ml=Ml||{})[Ml.COMPLETE=0]="COMPLETE",Ml[Ml.FAILED=1]="FAILED",Ml[Ml.REDIRECTING=2]="REDIRECTING",Ml))();const ly=!1;function pf(t,n){return{\u0275kind:t,\u0275providers:n}}const zD=new sn("",{providedIn:"root",factory:()=>!1});function EL(){const t=ti(Ds);return n=>{const e=t.get(tb);if(n!==e.components[0])return;const o=t.get(sr),r=t.get(SL);1===t.get(ND)&&o.initialNavigation(),t.get(DL,null,Wn.Optional)?.setUpPreloading(),t.get(FD,null,Wn.Optional)?.init(),o.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.unsubscribe())}}const SL=new sn(ly?"bootstrap done indicator":"",{factory:()=>new gi}),ND=new sn(ly?"initial navigation":"",{providedIn:"root",factory:()=>1});function s9(){let t=[];return t=ly?[{provide:bm,multi:!0,useFactory:()=>{const n=ti(sr);return()=>n.events.subscribe(e=>{console.group?.(`Router Event: ${e.constructor.name}`),console.log(function A7(t){if(!("type"in t))return`Unknown Router Event: ${t.constructor.name}`;switch(t.type){case 14:return`ActivationEnd(path: '${t.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${t.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${t.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${t.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state}, shouldActivate: ${t.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 2:return`NavigationCancel(id: ${t.id}, url: '${t.url}')`;case 16:return`NavigationSkipped(id: ${t.id}, url: '${t.url}')`;case 1:return`NavigationEnd(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${t.id}, url: '${t.url}', error: ${t.error})`;case 0:return`NavigationStart(id: ${t.id}, url: '${t.url}')`;case 6:return`ResolveEnd(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 5:return`ResolveStart(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 10:return`RouteConfigLoadEnd(path: ${t.route.path})`;case 9:return`RouteConfigLoadStart(path: ${t.route.path})`;case 4:return`RoutesRecognized(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 15:return`Scroll(anchor: '${t.anchor}', position: '${t.position?`${t.position[0]}, ${t.position[1]}`:null}')`}}(e)),console.log(e),console.groupEnd?.()})}}]:[],pf(1,t)}const DL=new sn(ly?"router preloader":"");function a9(t){return pf(0,[{provide:DL,useExisting:e9},{provide:wL,useExisting:t}])}const Ub=!1,ML=new sn(Ub?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),l9=[d1,{provide:Ib,useClass:pD},sr,Lb,{provide:rg,useFactory:function TL(t){return t.routerState.root},deps:[sr]},RD,Ub?{provide:zD,useValue:!0}:[]];function c9(){return new fk("Router",sr)}let pc=(()=>{class t{constructor(e){}static forRoot(e,o){return{ngModule:t,providers:[l9,Ub&&o?.enableTracing?s9().\u0275providers:[],{provide:ay,multi:!0,useValue:e},{provide:ML,useFactory:p9,deps:[[sr,new Wl,new ql]]},{provide:Fw,useValue:o||{}},o?.useHash?{provide:qm,useClass:OV}:{provide:qm,useClass:zk},{provide:FD,useFactory:()=>{const t=ti(J5),n=ti(fi),e=ti(Fw),o=ti(Lw),r=ti(Ib);return e.scrollOffset&&t.setOffset(e.scrollOffset),new CL(r,o,t,n,e)}},o?.preloadingStrategy?a9(o.preloadingStrategy).\u0275providers:[],{provide:fk,multi:!0,useFactory:c9},o?.initialNavigation?f9(o):[],[{provide:IL,useFactory:EL},{provide:pk,multi:!0,useExisting:IL}]]}}static forChild(e){return{ngModule:t,providers:[{provide:ay,multi:!0,useValue:e}]}}}return t.\u0275fac=function(e){return new(e||t)(Rt(ML,8))},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[DD]}),t})();function p9(t){if(Ub&&t)throw new Dt(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function f9(t){return["disabled"===t.initialNavigation?pf(3,[{provide:n1,multi:!0,useFactory:()=>{const n=ti(sr);return()=>{n.setUpLocationChangeListener()}}},{provide:ND,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?pf(2,[{provide:ND,useValue:0},{provide:n1,multi:!0,deps:[Ds],useFactory:n=>{const e=n.get(AV,Promise.resolve());return()=>e.then(()=>new Promise(o=>{const r=n.get(sr),s=n.get(SL);(function t9(t,n){t.events.pipe($s(e=>e instanceof og||e instanceof Cw||e instanceof bD||e instanceof Tw),Nn(e=>e instanceof og||e instanceof Tw?Ml.COMPLETE:e instanceof Cw&&(0===e.code||1===e.code)?Ml.REDIRECTING:Ml.FAILED),$s(e=>e!==Ml.REDIRECTING),fd(1)).subscribe(()=>{n()})})(r,()=>{o(!0)}),n.get(Lw).afterPreactivation=()=>(o(!0),s.closed?Gn(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const IL=new sn(Ub?"Router Initializer":""),g9=["addListener","removeListener"],_9=["addEventListener","removeEventListener"],y9=["on","off"];function jb(t,n,e,o){if(_t(e)&&(o=e,e=void 0),o)return jb(t,n,e).pipe(iS(o));const[r,s]=function x9(t){return _t(t.addEventListener)&&_t(t.removeEventListener)}(t)?_9.map(l=>h=>t[l](n,h,e)):function v9(t){return _t(t.addListener)&&_t(t.removeListener)}(t)?g9.map(kL(t,n)):function b9(t){return _t(t.on)&&_t(t.off)}(t)?y9.map(kL(t,n)):[];if(!r&&Eu(t))return St(l=>jb(l,n,e))(ne(t));if(!r)throw new TypeError("Invalid event target");return new Jn(l=>{const h=(...g)=>l.next(1<g.length?g:g[0]);return r(h),()=>s(h)})}function kL(t,n){return e=>o=>t[e](n,o)}const Hb={schedule(t){let n=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:o}=Hb;o&&(n=o.requestAnimationFrame,e=o.cancelAnimationFrame);const r=n(s=>{e=void 0,t(s)});return new re(()=>e?.(r))},requestAnimationFrame(...t){const{delegate:n}=Hb;return(n?.requestAnimationFrame||requestAnimationFrame)(...t)},cancelAnimationFrame(...t){const{delegate:n}=Hb;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...t)},delegate:void 0};new class C9 extends DS{flush(n){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:o}=this;let r;n=n||o.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=o[0])&&n.id===e&&o.shift());if(this._active=!1,r){for(;(n=o[0])&&n.id===e&&o.shift();)n.unsubscribe();throw r}}}(class w9 extends SS{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,o=0){return null!==o&&o>0?super.requestAsyncId(n,e,o):(n.actions.push(this),n._scheduled||(n._scheduled=Hb.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,e,o=0){var r;if(null!=o?o>0:this.delay>0)return super.recycleAsyncId(n,e,o);const{actions:s}=n;null!=e&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==e&&(Hb.cancelAnimationFrame(e),n._scheduled=void 0)}});let BD,E9=1;const zw={};function AL(t){return t in zw&&(delete zw[t],!0)}const S9={setImmediate(t){const n=E9++;return zw[n]=!0,BD||(BD=Promise.resolve()),BD.then(()=>AL(n)&&t()),n},clearImmediate(t){AL(t)}},{setImmediate:D9,clearImmediate:M9}=S9,Nw={setImmediate(...t){const{delegate:n}=Nw;return(n?.setImmediate||D9)(...t)},clearImmediate(t){const{delegate:n}=Nw;return(n?.clearImmediate||M9)(t)},delegate:void 0};new class k9 extends DS{flush(n){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:o}=this;let r;n=n||o.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=o[0])&&n.id===e&&o.shift());if(this._active=!1,r){for(;(n=o[0])&&n.id===e&&o.shift();)n.unsubscribe();throw r}}}(class I9 extends SS{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,o=0){return null!==o&&o>0?super.requestAsyncId(n,e,o):(n.actions.push(this),n._scheduled||(n._scheduled=Nw.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,e,o=0){var r;if(null!=o?o>0:this.delay>0)return super.recycleAsyncId(n,e,o);const{actions:s}=n;null!=e&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==e&&(Nw.clearImmediate(e),n._scheduled=void 0)}});function PL(t=0,n,e=E6){let o=-1;return null!=n&&(oi(n)?e=n:o=n),new Jn(r=>{let s=function O9(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;s<0&&(s=0);let l=0;return e.schedule(function(){r.closed||(r.next(l++),0<=o?this.schedule(void 0,o):r.complete())},s)})}function OL(t,n=MS){return function P9(t){return ji((n,e)=>{let o=!1,r=null,s=null,l=!1;const h=()=>{if(s?.unsubscribe(),s=null,o){o=!1;const b=r;r=null,e.next(b)}l&&e.complete()},g=()=>{s=null,l&&e.complete()};n.subscribe(Yn(e,b=>{o=!0,r=b,s||ne(t(b)).subscribe(s=Yn(e,h,g))},()=>{l=!0,(!o||!s||s.closed)&&e.complete()}))})}(()=>PL(t,n))}let VD=(()=>{class t{constructor(e,o,r){this._ngZone=e,this._platform=o,this._scrolled=new gi,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const o=this.scrollContainers.get(e);o&&(o.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Jn(o=>{this._globalSubscription||this._addGlobalListener();const r=e>0?this._scrolled.pipe(OL(e)).subscribe(o):this._scrolled.subscribe(o);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Gn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,o)=>this.deregister(o)),this._scrolled.complete()}ancestorScrolled(e,o){const r=this.getAncestorScrollContainers(e);return this.scrolled(o).pipe($s(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(e){const o=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,e)&&o.push(s)}),o}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,o){let r=q_(o),s=e.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>jb(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.\u0275fac=function(e){return new(e||t)(Rt(fi),Rt(rc),Rt(lo,8))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),$b=(()=>{class t{constructor(e,o,r,s){this.elementRef=e,this.scrollDispatcher=o,this.ngZone=r,this.dir=s,this._destroyed=new gi,this._elementScrolled=new Jn(l=>this.ngZone.runOutsideAngular(()=>jb(this.elementRef.nativeElement,"scroll").pipe(ac(this._destroyed)).subscribe(l)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const o=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=r?e.end:e.start),null==e.right&&(e.right=r?e.start:e.end),null!=e.bottom&&(e.top=o.scrollHeight-o.clientHeight-e.bottom),r&&0!=mb()?(null!=e.left&&(e.right=o.scrollWidth-o.clientWidth-e.left),2==mb()?e.left=e.right:1==mb()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=o.scrollWidth-o.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const o=this.elementRef.nativeElement;!function c6(){if(null==Ym){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Ym=!1,Ym;if("scrollBehavior"in document.documentElement.style)Ym=!0;else{const t=Element.prototype.scrollTo;Ym=!!t&&!/\{\s*\[native code\]\s*\}/.test(t.toString())}}return Ym}()?(null!=e.top&&(o.scrollTop=e.top),null!=e.left&&(o.scrollLeft=e.left)):o.scrollTo(e)}measureScrollOffset(e){const o="left",r="right",s=this.elementRef.nativeElement;if("top"==e)return s.scrollTop;if("bottom"==e)return s.scrollHeight-s.clientHeight-s.scrollTop;const l=this.dir&&"rtl"==this.dir.value;return"start"==e?e=l?r:o:"end"==e&&(e=l?o:r),l&&2==mb()?e==o?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:l&&1==mb()?e==o?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:e==o?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(VD),be(fi),be(oO,8))},t.\u0275dir=kn({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),t})(),F9=(()=>{class t{constructor(e,o,r){this._platform=e,this._change=new gi,this._changeListener=s=>{this._change.next(s)},this._document=r,o.runOutsideAngular(()=>{if(e.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:o,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+o,height:r,width:o}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,o=this._getWindow(),r=e.documentElement,s=r.getBoundingClientRect();return{top:-s.top||e.body.scrollTop||o.scrollY||r.scrollTop||0,left:-s.left||e.body.scrollLeft||o.scrollX||r.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(OL(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return t.\u0275fac=function(e){return new(e||t)(Rt(rc),Rt(fi),Rt(lo,8))},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),RL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({}),t})();const Bw=["*"],z9=["content"];function N9(t,n){if(1&t){const e=xt();F(0,"div",2),Oe("click",function(){return Ie(e),Me(q()._onBackdropClicked())}),V()}2&t&&Mo("mat-drawer-shown",q()._isShowingBackdrop())}function B9(t,n){1&t&&(F(0,"mat-drawer-content"),Qi(1,2),V())}const V9=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],U9=["mat-drawer","mat-drawer-content","*"];function j9(t,n){if(1&t){const e=xt();F(0,"div",2),Oe("click",function(){return Ie(e),Me(q()._onBackdropClicked())}),V()}2&t&&Mo("mat-drawer-shown",q()._isShowingBackdrop())}function H9(t,n){1&t&&(F(0,"mat-sidenav-content"),Qi(1,2),V())}const $9=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],G9=["mat-sidenav","mat-sidenav-content","*"],LL={transformDrawer:cc("transform",[zS("open, open-instant",go({transform:"none",visibility:"visible"})),zS("void",go({"box-shadow":"none",visibility:"hidden"})),rr("void => open-instant",Ho("0ms")),rr("void <=> open, open-instant => void",Ho("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},q9=new sn("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Z9(){return!1}}),UD=new sn("MAT_DRAWER_CONTAINER");let Vw=(()=>{class t extends $b{constructor(e,o,r,s,l){super(r,s,l),this._changeDetectorRef=e,this._container=o}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return t.\u0275fac=function(e){return new(e||t)(be(Po),be(xi(()=>zL)),be(si),be(VD),be(fi))},t.\u0275cmp=on({type:t,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(e,o){2&e&&aa("margin-left",o._container._contentMargins.left,"px")("margin-right",o._container._contentMargins.right,"px")},features:[Wi([{provide:$b,useExisting:t}]),Li],ngContentSelectors:Bw,decls:1,vars:0,template:function(e,o){1&e&&(or(),Qi(0))},encapsulation:2,changeDetection:0}),t})(),FL=(()=>{class t{get position(){return this._position}set position(e){(e="end"===e?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(e),this._position=e,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(e){this._disableClose=du(e)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(e){("true"===e||"false"===e||null==e)&&(e=du(e)),this._autoFocus=e}get opened(){return this._opened}set opened(e){this.toggle(du(e))}constructor(e,o,r,s,l,h,g,b){this._elementRef=e,this._focusTrapFactory=o,this._focusMonitor=r,this._platform=s,this._ngZone=l,this._interactivityChecker=h,this._doc=g,this._container=b,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new gi,this._animationEnd=new gi,this._animationState="void",this.openedChange=new Tt(!0),this._openedStream=this.openedChange.pipe($s(T=>T),Nn(()=>{})),this.openedStart=this._animationStarted.pipe($s(T=>T.fromState!==T.toState&&0===T.toState.indexOf("open")),hD(void 0)),this._closedStream=this.openedChange.pipe($s(T=>!T),Nn(()=>{})),this.closedStart=this._animationStarted.pipe($s(T=>T.fromState!==T.toState&&"void"===T.toState),hD(void 0)),this._destroyed=new gi,this.onPositionChanged=new Tt,this._modeChanged=new gi,this.openedChange.subscribe(T=>{T?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{jb(this._elementRef.nativeElement,"keydown").pipe($s(T=>27===T.keyCode&&!this.disableClose&&!function v6(t,...n){return n.length?n.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}(T)),ac(this._destroyed)).subscribe(T=>this._ngZone.run(()=>{this.close(),T.stopPropagation(),T.preventDefault()}))}),this._animationEnd.pipe(BP((T,I)=>T.fromState===I.fromState&&T.toState===I.toState)).subscribe(T=>{const{fromState:I,toState:R}=T;(0===R.indexOf("open")&&"void"===I||"void"===R&&0===I.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(e,o){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{e.removeEventListener("blur",r),e.removeEventListener("mousedown",r),e.removeAttribute("tabindex")};e.addEventListener("blur",r),e.addEventListener("mousedown",r)})),e.focus(o)}_focusByCssSelector(e,o){let r=this._elementRef.nativeElement.querySelector(e);r&&this._forceFocus(r,o)}_takeFocus(){if(!this._focusTrap)return;const e=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(o=>{!o&&"function"==typeof this._elementRef.nativeElement.focus&&e.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(e){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,e):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const e=this._doc.activeElement;return!!e&&this._elementRef.nativeElement.contains(e)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(e){return this.toggle(!0,e)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(e=!this.opened,o){e&&o&&(this._openedVia=o);const r=this._setOpen(e,!e&&this._isFocusWithinDrawer(),this._openedVia||"program");return e||(this._openedVia=null),r}_setOpen(e,o,r){return this._opened=e,e?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",o&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(fd(1)).subscribe(l=>s(l?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(e){const o=this._elementRef.nativeElement,r=o.parentNode;"end"===e?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,o)),r.appendChild(o)):this._anchor&&this._anchor.parentNode.insertBefore(o,this._anchor)}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(H6),be(tO),be(rc),be(fi),be(KP),be(lo,8),be(UD,8))},t.\u0275cmp=on({type:t,selectors:[["mat-drawer"]],viewQuery:function(e,o){if(1&e&&pi(z9,5),2&e){let r;mn(r=gn())&&(o._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(e,o){1&e&&gr("@transform.start",function(s){return o._animationStarted.next(s)})("@transform.done",function(s){return o._animationEnd.next(s)}),2&e&&(st("align",null),KT("@transform",o._animationState),Mo("mat-drawer-end","end"===o.position)("mat-drawer-over","over"===o.mode)("mat-drawer-push","push"===o.mode)("mat-drawer-side","side"===o.mode)("mat-drawer-opened",o.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:Bw,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(e,o){1&e&&(or(),F(0,"div",0,1),Qi(2),V())},dependencies:[$b],encapsulation:2,data:{animation:[LL.transformDrawer]},changeDetection:0}),t})(),zL=(()=>{class t{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(e){this._autosize=du(e)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(e){this._backdropOverride=null==e?null:du(e)}get scrollable(){return this._userContent||this._content}constructor(e,o,r,s,l,h=!1,g){this._dir=e,this._element=o,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=g,this._drawers=new Qx,this.backdropClick=new Tt,this._destroyed=new gi,this._doCheckSubject=new gi,this._contentMargins={left:null,right:null},this._contentMarginChanges=new gi,e&&e.change.pipe(ac(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),l.change().pipe(ac(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=h}ngAfterContentInit(){this._allDrawers.changes.pipe(j1(this._allDrawers),ac(this._destroyed)).subscribe(e=>{this._drawers.reset(e.filter(o=>!o._container||o._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(j1(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(e=>{this._watchDrawerToggle(e),this._watchDrawerPosition(e),this._watchDrawerMode(e)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe($P(10),ac(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(e=>e.open())}close(){this._drawers.forEach(e=>e.close())}updateContentMargins(){let e=0,o=0;if(this._left&&this._left.opened)if("side"==this._left.mode)e+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();e+=r,o-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)o+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();o+=r,e-=r}e=e||null,o=o||null,(e!==this._contentMargins.left||o!==this._contentMargins.right)&&(this._contentMargins={left:e,right:o},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(e){e._animationStarted.pipe($s(o=>o.fromState!==o.toState),ac(this._drawers.changes)).subscribe(o=>{"open-instant"!==o.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==e.mode&&e.openedChange.pipe(ac(this._drawers.changes)).subscribe(()=>this._setContainerClass(e.opened))}_watchDrawerPosition(e){e&&e.onPositionChanged.pipe(ac(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(fd(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(e){e&&e._modeChanged.pipe(ac(xc(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(e){const o=this._element.nativeElement.classList,r="mat-drawer-container-has-open";e?o.add(r):o.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(e=>{"end"==e.position?this._end=e:this._start=e}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(e=>e&&!e.disableClose&&this._canHaveBackdrop(e)).forEach(e=>e._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(e){return"side"!==e.mode||!!this._backdropOverride}_isDrawerOpen(e){return null!=e&&e.opened}}return t.\u0275fac=function(e){return new(e||t)(be(oO,8),be(si),be(fi),be(Po),be(F9),be(q9),be(U_,8))},t.\u0275cmp=on({type:t,selectors:[["mat-drawer-container"]],contentQueries:function(e,o,r){if(1&e&&(No(r,Vw,5),No(r,FL,5)),2&e){let s;mn(s=gn())&&(o._content=s.first),mn(s=gn())&&(o._allDrawers=s)}},viewQuery:function(e,o){if(1&e&&pi(Vw,5),2&e){let r;mn(r=gn())&&(o._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(e,o){2&e&&Mo("mat-drawer-container-explicit-backdrop",o._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Wi([{provide:UD,useExisting:t}])],ngContentSelectors:U9,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,o){1&e&&(or(V9),J(0,N9,1,2,"div",0),Qi(1),Qi(2,1),J(3,B9,2,0,"mat-drawer-content",1)),2&e&&(B("ngIf",o.hasBackdrop),j(3),B("ngIf",!o._content))},dependencies:[mi,Vw],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),t})(),jD=(()=>{class t extends Vw{constructor(e,o,r,s,l){super(e,o,r,s,l)}}return t.\u0275fac=function(e){return new(e||t)(be(Po),be(xi(()=>NL)),be(si),be(VD),be(fi))},t.\u0275cmp=on({type:t,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(e,o){2&e&&aa("margin-left",o._container._contentMargins.left,"px")("margin-right",o._container._contentMargins.right,"px")},features:[Wi([{provide:$b,useExisting:t}]),Li],ngContentSelectors:Bw,decls:1,vars:0,template:function(e,o){1&e&&(or(),Qi(0))},encapsulation:2,changeDetection:0}),t})(),HD=(()=>{class t extends FL{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(e){this._fixedInViewport=du(e)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(e){this._fixedTopGap=VP(e)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(e){this._fixedBottomGap=VP(e)}}return t.\u0275fac=function(){let n;return function(o){return(n||(n=Cr(t)))(o||t)}}(),t.\u0275cmp=on({type:t,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(e,o){2&e&&(st("align",null),aa("top",o.fixedInViewport?o.fixedTopGap:null,"px")("bottom",o.fixedInViewport?o.fixedBottomGap:null,"px"),Mo("mat-drawer-end","end"===o.position)("mat-drawer-over","over"===o.mode)("mat-drawer-push","push"===o.mode)("mat-drawer-side","side"===o.mode)("mat-drawer-opened",o.opened)("mat-sidenav-fixed",o.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[Li],ngContentSelectors:Bw,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(e,o){1&e&&(or(),F(0,"div",0,1),Qi(2),V())},dependencies:[$b],encapsulation:2,data:{animation:[LL.transformDrawer]},changeDetection:0}),t})(),NL=(()=>{class t extends zL{}return t.\u0275fac=function(){let n;return function(o){return(n||(n=Cr(t)))(o||t)}}(),t.\u0275cmp=on({type:t,selectors:[["mat-sidenav-container"]],contentQueries:function(e,o,r){if(1&e&&(No(r,jD,5),No(r,HD,5)),2&e){let s;mn(s=gn())&&(o._content=s.first),mn(s=gn())&&(o._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(e,o){2&e&&Mo("mat-drawer-container-explicit-backdrop",o._backdropOverride)},exportAs:["matSidenavContainer"],features:[Wi([{provide:UD,useExisting:t}]),Li],ngContentSelectors:G9,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,o){1&e&&(or($9),J(0,j9,1,2,"div",0),Qi(1),Qi(2,1),J(3,H9,2,0,"mat-sidenav-content",1)),2&e&&(B("ngIf",o.hasBackdrop),j(3),B("ngIf",!o._content))},dependencies:[mi,jD],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),t})(),K9=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,lc,RL,RL,lc]}),t})();class _n{static equals(n,e,o){return o?this.resolveFieldData(n,o)===this.resolveFieldData(e,o):this.equalsByValue(n,e)}static equalsByValue(n,e){if(n===e)return!0;if(n&&e&&"object"==typeof n&&"object"==typeof e){var s,l,h,o=Array.isArray(n),r=Array.isArray(e);if(o&&r){if((l=n.length)!=e.length)return!1;for(s=l;0!=s--;)if(!this.equalsByValue(n[s],e[s]))return!1;return!0}if(o!=r)return!1;var g=this.isDate(n),b=this.isDate(e);if(g!=b)return!1;if(g&&b)return n.getTime()==e.getTime();var T=n instanceof RegExp,I=e instanceof RegExp;if(T!=I)return!1;if(T&&I)return n.toString()==e.toString();var R=Object.keys(n);if((l=R.length)!==Object.keys(e).length)return!1;for(s=l;0!=s--;)if(!Object.prototype.hasOwnProperty.call(e,R[s]))return!1;for(s=l;0!=s--;)if(!this.equalsByValue(n[h=R[s]],e[h]))return!1;return!0}return n!=n&&e!=e}static resolveFieldData(n,e){if(n&&e){if(this.isFunction(e))return e(n);if(-1==e.indexOf("."))return n[e];{let o=e.split("."),r=n;for(let s=0,l=o.length;s<l;++s){if(null==r)return null;r=r[o[s]]}return r}}return null}static isFunction(n){return!!(n&&n.constructor&&n.call&&n.apply)}static reorderArray(n,e,o){n&&e!==o&&(o>=n.length&&(o%=n.length,e%=n.length),n.splice(o,0,n.splice(e,1)[0]))}static insertIntoOrderedArray(n,e,o,r){if(o.length>0){let s=!1;for(let l=0;l<o.length;l++)if(this.findIndexInList(o[l],r)>e){o.splice(l,0,n),s=!0;break}s||o.push(n)}else o.push(n)}static findIndexInList(n,e){let o=-1;if(e)for(let r=0;r<e.length;r++)if(e[r]==n){o=r;break}return o}static contains(n,e){if(null!=n&&e&&e.length)for(let o of e)if(this.equals(n,o))return!0;return!1}static removeAccents(n){return n&&n.search(/[\xC0-\xFF]/g)>-1&&(n=n.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),n}static isDate(n){return"[object Date]"===Object.prototype.toString.call(n)}static isEmpty(n){return null==n||""===n||Array.isArray(n)&&0===n.length||!this.isDate(n)&&"object"==typeof n&&0===Object.keys(n).length}static isNotEmpty(n){return!this.isEmpty(n)}static compare(n,e,o,r=1){let s=-1;const l=this.isEmpty(n),h=this.isEmpty(e);return s=l&&h?0:l?r:h?-r:"string"==typeof n&&"string"==typeof e?n.localeCompare(e,o,{numeric:!0}):n<e?-1:n>e?1:0,s}static sort(n,e,o=1,r,s=1){return(1===s?o:s)*_n.compare(n,e,r,o)}static merge(n,e){if(null!=n||null!=e)return null!=n&&"object"!=typeof n||null!=e&&"object"!=typeof e?null!=n&&"string"!=typeof n||null!=e&&"string"!=typeof e?e||n:[n||"",e||""].join(" "):{...n||{},...e||{}}}}var BL=0;function cy(){return"pr_id_"+ ++BL}var ns=function X9(){let t=[];const r=s=>s&&parseInt(s.style.zIndex,10)||0;return{get:r,set:(s,l,h)=>{l&&(l.style.zIndex=String(((s,l)=>{let h=t.length>0?t[t.length-1]:{key:s,value:l},g=h.value+(h.key===s?0:l)+1;return t.push({key:s,value:g}),g})(s,h)))},clear:s=>{s&&((s=>{t=t.filter(l=>l.value!==s)})(r(s)),s.style.zIndex="")},getCurrent:()=>t.length>0?t[t.length-1].value:0}}();const VL=["*"];var ff=(()=>{return(t=ff||(ff={}))[t.ACCEPT=0]="ACCEPT",t[t.REJECT=1]="REJECT",t[t.CANCEL=2]="CANCEL",ff;var t})();let Gb=(()=>{class t{constructor(){this.requireConfirmationSource=new gi,this.acceptConfirmationSource=new gi,this.requireConfirmation$=this.requireConfirmationSource.asObservable(),this.accept=this.acceptConfirmationSource.asObservable()}confirm(e){return this.requireConfirmationSource.next(e),this}close(){return this.requireConfirmationSource.next(null),this}onAccept(){this.acceptConfirmationSource.next(null)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})(),Ws=(()=>{class t{}return t.STARTS_WITH="startsWith",t.CONTAINS="contains",t.NOT_CONTAINS="notContains",t.ENDS_WITH="endsWith",t.EQUALS="equals",t.NOT_EQUALS="notEquals",t.IN="in",t.LESS_THAN="lt",t.LESS_THAN_OR_EQUAL_TO="lte",t.GREATER_THAN="gt",t.GREATER_THAN_OR_EQUAL_TO="gte",t.BETWEEN="between",t.IS="is",t.IS_NOT="isNot",t.BEFORE="before",t.AFTER="after",t.DATE_IS="dateIs",t.DATE_IS_NOT="dateIsNot",t.DATE_BEFORE="dateBefore",t.DATE_AFTER="dateAfter",t})(),UL=(()=>{class t{}return t.AND="and",t.OR="or",t})(),$D=(()=>{class t{constructor(){this.filters={startsWith:(e,o,r)=>{if(null==o||""===o.trim())return!0;if(null==e)return!1;let s=_n.removeAccents(o.toString()).toLocaleLowerCase(r);return _n.removeAccents(e.toString()).toLocaleLowerCase(r).slice(0,s.length)===s},contains:(e,o,r)=>{if(null==o||"string"==typeof o&&""===o.trim())return!0;if(null==e)return!1;let s=_n.removeAccents(o.toString()).toLocaleLowerCase(r);return-1!==_n.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(s)},notContains:(e,o,r)=>{if(null==o||"string"==typeof o&&""===o.trim())return!0;if(null==e)return!1;let s=_n.removeAccents(o.toString()).toLocaleLowerCase(r);return-1===_n.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(s)},endsWith:(e,o,r)=>{if(null==o||""===o.trim())return!0;if(null==e)return!1;let s=_n.removeAccents(o.toString()).toLocaleLowerCase(r),l=_n.removeAccents(e.toString()).toLocaleLowerCase(r);return-1!==l.indexOf(s,l.length-s.length)},equals:(e,o,r)=>null==o||"string"==typeof o&&""===o.trim()||null!=e&&(e.getTime&&o.getTime?e.getTime()===o.getTime():_n.removeAccents(e.toString()).toLocaleLowerCase(r)==_n.removeAccents(o.toString()).toLocaleLowerCase(r)),notEquals:(e,o,r)=>!(null==o||"string"==typeof o&&""===o.trim()||null!=e&&(e.getTime&&o.getTime?e.getTime()===o.getTime():_n.removeAccents(e.toString()).toLocaleLowerCase(r)==_n.removeAccents(o.toString()).toLocaleLowerCase(r))),in:(e,o)=>{if(null==o||0===o.length)return!0;for(let r=0;r<o.length;r++)if(_n.equals(e,o[r]))return!0;return!1},between:(e,o)=>null==o||null==o[0]||null==o[1]||null!=e&&(e.getTime?o[0].getTime()<=e.getTime()&&e.getTime()<=o[1].getTime():o[0]<=e&&e<=o[1]),lt:(e,o,r)=>null==o||null!=e&&(e.getTime&&o.getTime?e.getTime()<o.getTime():e<o),lte:(e,o,r)=>null==o||null!=e&&(e.getTime&&o.getTime?e.getTime()<=o.getTime():e<=o),gt:(e,o,r)=>null==o||null!=e&&(e.getTime&&o.getTime?e.getTime()>o.getTime():e>o),gte:(e,o,r)=>null==o||null!=e&&(e.getTime&&o.getTime?e.getTime()>=o.getTime():e>=o),is:(e,o,r)=>this.filters.equals(e,o,r),isNot:(e,o,r)=>this.filters.notEquals(e,o,r),before:(e,o,r)=>this.filters.lt(e,o,r),after:(e,o,r)=>this.filters.gt(e,o,r),dateIs:(e,o)=>null==o||null!=e&&e.toDateString()===o.toDateString(),dateIsNot:(e,o)=>null==o||null!=e&&e.toDateString()!==o.toDateString(),dateBefore:(e,o)=>null==o||null!=e&&e.getTime()<o.getTime(),dateAfter:(e,o)=>null==o||null!=e&&e.getTime()>o.getTime()}}filter(e,o,r,s,l){let h=[];if(e)for(let g of e)for(let b of o){let T=_n.resolveFieldData(g,b);if(this.filters[s](T,r,l)){h.push(g);break}}return h}register(e,o){this.filters[e]=o}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Y9=(()=>{class t{constructor(){this.messageSource=new gi,this.clearSource=new gi,this.messageObserver=this.messageSource.asObservable(),this.clearObserver=this.clearSource.asObservable()}add(e){e&&this.messageSource.next(e)}addAll(e){e&&e.length&&this.messageSource.next(e)}clear(e){this.clearSource.next(e||null)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})(),Wb=(()=>{class t{constructor(){this.clickSource=new gi,this.clickObservable=this.clickSource.asObservable()}add(e){e&&this.clickSource.next(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Il=(()=>{class t{constructor(){this.ripple=!1,this.overlayOptions={},this.filterMatchModeOptions={text:[Ws.STARTS_WITH,Ws.CONTAINS,Ws.NOT_CONTAINS,Ws.ENDS_WITH,Ws.EQUALS,Ws.NOT_EQUALS],numeric:[Ws.EQUALS,Ws.NOT_EQUALS,Ws.LESS_THAN,Ws.LESS_THAN_OR_EQUAL_TO,Ws.GREATER_THAN,Ws.GREATER_THAN_OR_EQUAL_TO],date:[Ws.DATE_IS,Ws.DATE_IS_NOT,Ws.DATE_BEFORE,Ws.DATE_AFTER]},this.translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",emptyFilterMessage:"No results found"},this.zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100},this.translationSource=new gi,this.translationObserver=this.translationSource.asObservable()}getTranslation(e){return this.translation[e]}setTranslation(e){this.translation={...this.translation,...e},this.translationSource.next(this.translation)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),GD=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["p-header"]],ngContentSelectors:VL,decls:1,vars:0,template:function(e,o){1&e&&(or(),Qi(0))},encapsulation:2}),t})(),Uw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["p-footer"]],ngContentSelectors:VL,decls:1,vars:0,template:function(e,o){1&e&&(or(),Qi(0))},encapsulation:2}),t})(),_o=(()=>{class t{constructor(e){this.template=e}getType(){return this.name}}return t.\u0275fac=function(e){return new(e||t)(be(su))},t.\u0275dir=kn({type:t,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}}),t})(),is=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})(),Dr=(()=>{class t{}return t.STARTS_WITH="startsWith",t.CONTAINS="contains",t.NOT_CONTAINS="notContains",t.ENDS_WITH="endsWith",t.EQUALS="equals",t.NOT_EQUALS="notEquals",t.NO_FILTER="noFilter",t.LT="lt",t.LTE="lte",t.GT="gt",t.GTE="gte",t.IS="is",t.IS_NOT="isNot",t.BEFORE="before",t.AFTER="after",t.CLEAR="clear",t.APPLY="apply",t.MATCH_ALL="matchAll",t.MATCH_ANY="matchAny",t.ADD_RULE="addRule",t.REMOVE_RULE="removeRule",t.ACCEPT="accept",t.REJECT="reject",t.CHOOSE="choose",t.UPLOAD="upload",t.CANCEL="cancel",t.DAY_NAMES="dayNames",t.DAY_NAMES_SHORT="dayNamesShort",t.DAY_NAMES_MIN="dayNamesMin",t.MONTH_NAMES="monthNames",t.MONTH_NAMES_SHORT="monthNamesShort",t.FIRST_DAY_OF_WEEK="firstDayOfWeek",t.TODAY="today",t.WEEK_HEADER="weekHeader",t.WEAK="weak",t.MEDIUM="medium",t.STRONG="strong",t.PASSWORD_PROMPT="passwordPrompt",t.EMPTY_MESSAGE="emptyMessage",t.EMPTY_FILTER_MESSAGE="emptyFilterMessage",t})(),WD=(()=>{class t{constructor(e,o){this.primengConfig=e,this.document=o,this.title="spotivibes",this.themeTag="Tema oscuro",this.theme="theme-dark",this.themeIcon="dark_mode"}ngOnInit(){this.primengConfig.ripple=!0,window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{this.changeTheme(!1)}),this.changeTheme(!1)}changeTheme(e){const o=document.body;e?o.classList.contains(this.theme)?(this.themeTag="Tema oscuro",this.themeIcon="dark_mode",o.classList.remove(this.theme),this.document.getElementById("theme").setAttribute("href","assets/themes/saga-blue/theme.css")):(this.themeTag="Tema claro",this.themeIcon="light_mode",o.classList.add(this.theme),this.document.getElementById("theme").setAttribute("href","assets/themes/vela-blue/theme.css")):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?(this.themeTag="Tema claro",this.themeIcon="light_mode",o.classList.add(this.theme),this.document.getElementById("theme").setAttribute("href","assets/themes/vela-blue/theme.css")):(this.theme="theme-dark",this.themeTag="Tema oscuro",this.themeIcon="dark_mode",o.classList.remove(this.theme),this.document.getElementById("theme").setAttribute("href","assets/themes/saga-blue/theme.css"))}}return t.\u0275fac=function(e){return new(e||t)(be(Il),be(lo))},t.\u0275cmp=on({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(e,o){1&e&&Ne(0,"router-outlet")},dependencies:[Dw]}),t})();function Q9(t,n){1&t&&Ne(0,"p-badge",30),2&t&&B("value",q(2).numNotificaciones)}function J9(t,n){if(1&t){const e=xt();F(0,"button",25),Oe("click",function(){const s=Ie(e).$implicit;return Me(q().goToRoute(s.id,s.name,s.route))}),F(1,"div",26)(2,"mat-icon",27),ce(3),V(),F(4,"span",28),ce(5),V(),J(6,Q9,1,1,"p-badge",29),V()()}if(2&t){const e=n.$implicit,o=q();Mo("sidenav-button-selected",o.currentRouteId==e.id),j(2),Mo("material-icons-outlined",o.currentRouteId!=e.id),j(1),Jt(e.icon),j(2),Jt(e.name),j(1),B("ngIf",4==e.id&&o.hayNotificaciones)}}function eW(t,n){if(1&t){const e=xt();F(0,"button",31),Oe("click",function(){return Ie(e),Me(q().showVibeDialog())}),F(1,"span",32),ce(2,"Crear vibe"),V()()}}function tW(t,n){if(1&t){const e=xt();F(0,"p-slideMenu",33),Oe("click",function(r){return Ie(e),Me(q().activeMenu(r))}),V()}2&t&&B("model",q().menuItems)("viewportHeight",135)}function nW(t,n){if(1&t){const e=xt();F(0,"mat-toolbar",34)(1,"button",35),Oe("click",function(){return Ie(e),Me(q().sidenav.toggle())}),F(2,"mat-icon",36),ce(3,"menu"),V()(),F(4,"h2",37),ce(5),V()()}if(2&t){const e=q();j(5),Jt(e.currentRoute)}}const iW=function(){return{"margin-top":"4rem"}},oW=function(){return{"margin-top":"0"}};let nl=(()=>{class t{constructor(e,o,r,s,l,h){this.router=e,this.primengConfig=o,this.confirmationService=r,this.cdRef=s,this.renderer=l,this.appComponent=h,this.title="spotivibes",this.showBar=!1,this.showTitle=!0,this.menuToogled=!1,this.currentRouteId=1,this.currentRoute="Inicio",this.hayNotificaciones=!1,this.displayNewVibeDialog=!1,this.displaySuccess=!1,this.sidenavItems=[],this.isAdmin=!1,this.menuItems=[{icon:"pi pi-fw pi-user",label:"Ver perfil"},{icon:"pi pi-fw pi-times",label:"Cerrar sesi\xf3n"}],this.renderer.listen("window","click",g=>{(null==g.target.attributes.class||"mat-mdc-button-touch-target"!=g.target.attributes.class.nodeValue&&!g.target.attributes.class.nodeValue.includes("p-menuitem")&&!g.target.attributes.class.nodeValue.includes("p-submenu")&&!g.target.attributes.class.nodeValue.includes("p-menuitem-text")&&"ng-tns-c146-3"!=g.target.attributes.class.nodeValue&&!g.target.attributes.class.nodeValue.includes("p-slidemenu-backward"))&&(this.menuToogled=!1)})}ngOnInit(){this.isAdmin=!1,this.user={image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif",name:"Nacho Ortega",email:"nahoortega@me.com",nickname:"pikanachi",publicProfile:!0},this.editName=this.user.name,this.editEmail=this.user.email,this.editNickname=this.user.nickname,this.editPublic=!0,this.sidenavItems=this.isAdmin?[{id:0,name:"Dashboard",icon:"dashboard",route:"admin/dashboard"},{id:1,name:"Usuarios",icon:"home",route:"admin/users"}]:[{id:0,name:"Inicio",icon:"home",route:"home"},{id:1,name:"Playlists",icon:"subscriptions",route:"playlists"},{id:2,name:"Mapa",icon:"map",route:"map"},{id:3,name:"Amigos",icon:"group",route:"friends"},{id:4,name:"Notificaciones",icon:"notifications",route:"notifications"}],this.currentRouteId=this.getCurrentRoute(this.router.url),this.currentRoute=this.sidenavItems[this.currentRouteId].name,window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{console.log(e.matches?"dark":"light"),this.appComponent.changeTheme(!1)}),this.appComponent.changeTheme(!1),this.primengConfig.ripple=!0}ngAfterViewChecked(){window.innerWidth<700?this.showBar=!0:(this.showBar=!1,this.sidenav.open(),this.sidenav.mode="side"),this.user.name.length>12&&(this.user.name=this.user.name.substring(0,12)+"..."),this.user.email.length>18&&(this.user.email=this.user.email.substring(0,18)+"..."),this.cdRef.detectChanges()}onResize(e){e.target.innerWidth<700?(this.sidenav.close(),this.sidenav.mode="over",this.showBar=!0):(this.sidenav.open(),this.sidenav.mode="side",this.showBar=!1)}goToRoute(e,o,r){this.getCurrentRoute(this.router.url),this.currentRouteId=e,this.currentRoute=o,this.showBar&&this.sidenav.close(),this.router.navigateByUrl(r)}showVibeDialog(){this.displayNewVibeDialog=!0}getCurrentRoute(e){return e.includes("/home")||e.includes("/admin/dashboard")?0:e.includes("/playlists")||e.includes("/admin/users")?1:e.includes("/map")?2:e.includes("/friends")?3:e.includes("/notifications")?4:0}toogleMenu(){this.menuToogled=!this.menuToogled}activeMenu(e){console.log("activeMenu"),this.whatchMenuElements("A"===e.target.tagName?e.target.text:e.target.parentNode.text)}whatchMenuElements(e){switch(console.log("whatchElements"),e){case"Ver perfil":console.log("Ver perfil"),this.router.navigate(["/profile/1"]),this.menuToogled=!1,this.showBar&&this.sidenav.close();break;case"Cerrar sesi\xf3n":this.logout()}}logout(){this.confirmationService.confirm({header:"Cerrar sesi\xf3n",message:"\xbfSeguro que deseas cerrar sesi\xf3n? Una vez cerrada deber\xe1 volver a loguearse",acceptLabel:"Cerrar sesi\xf3n",rejectLabel:"Cancelar",accept:()=>{this.router.navigate(["/"]),this.menuToogled=!1}})}onBasicUploadAuto(e){console.log(e)}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(Il),be(Gb),be(Po),be(jr),be(WD))},t.\u0275cmp=on({type:t,selectors:[["app-root"]],viewQuery:function(e,o){if(1&e&&pi(HD,5),2&e){let r;mn(r=gn())&&(o.sidenav=r.first)}},hostBindings:function(e,o){1&e&&Oe("resize",function(s){return o.onResize(s)},0,gx)},features:[Wi([Gb])],decls:41,vars:22,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"autoFocus"],["drawer",""],[1,"flex","flex-column",2,"height","100vh"],[1,"flex-none","flex","p-4"],[1,"mat-sidenav-elements"],["src","assets/images/spotivibes-logo-white.svg","alt","logo"],["mat-button","","class","mat-sidenav-button border-round-xl ",3,"sidenav-button-selected","click",4,"ngFor","ngForOf"],["type","button","class","text-base p-button-text w-full mt-3 border-round-xl h-3rem vibe-btn","style","box-shadow: 0px 1px 5px 0px rgba(0,0,0,0.2) !important;",3,"click",4,"ngIf"],[1,"flex-grow-1","flex"],["mat-button","",1,"border-round-xl","mat-sidenav-button","mb-2",3,"click"],[1,"material-icons-outlined"],[1,"flex","align-content-center","relative","mt-2"],[1,"mx-auto","overflow-hidden",2,"height","40px","width","40px","border-radius","100%","box-shadow","0px 1px 5px 0px rgba(0,0,0,0.2)"],[2,"height","40px","width","40px","object-fit","cover",3,"src","alt"],[1,"ml-2"],[1,"mat-sidenav-user","mt-1"],[1,"mat-sidenav-email"],["mat-icon-button","",3,"click"],[1,"z-1","m-0","absolute",2,"right","0px","bottom","55px"],["menuDiv",""],[3,"model","viewportHeight","click",4,"ngIf"],["color","primary","style","position: fixed; top: 0;",4,"ngIf"],[3,"ngStyle"],["acceptLabel","S\xed","icon","pi pi-exclamation-triangle","acceptButtonStyleClass","mt-4 vibe-btn text-green-500 text-base","rejectButtonStyleClass","mt-4 vibe-btn text-pink-500 text-base"],["mat-button","",1,"mat-sidenav-button","border-round-xl",3,"click"],[1,"flex","align-content-center","justify-content-center"],[1,"flex","align-items-center","align-content-center","justify-content-center"],[1,"flex","align-content-center","justify-content-center","align-items-center","mr-2"],["class","flex align-items-center align-content-center justify-content-center","severity","danger",3,"value",4,"ngIf"],["severity","danger",1,"flex","align-items-center","align-content-center","justify-content-center",3,"value"],["type","button",1,"text-base","p-button-text","w-full","mt-3","border-round-xl","h-3rem","vibe-btn",2,"box-shadow","0px 1px 5px 0px rgba(0,0,0,0.2) !important",3,"click"],[1,"vibe-btn-text"],[3,"model","viewportHeight","click"],["color","primary",2,"position","fixed","top","0"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],[2,"margin-left","1rem","font-weight","900"]],template:function(e,o){1&e&&(F(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2)(3,"div",3)(4,"div",4)(5,"div",5),Ne(6,"img",6),J(7,J9,7,7,"button",7),J(8,eW,3,0,"button",8),V()(),Ne(9,"div",9),F(10,"div",4)(11,"div",5)(12,"button",10),Oe("click",function(){return o.appComponent.changeTheme(!0)}),F(13,"mat-icon",11),ce(14),V(),F(15,"span"),ce(16),V()(),Ne(17,"mat-divider"),F(18,"div",12)(19,"div",13),Ne(20,"img",14),V(),F(21,"div",15)(22,"div",16),ce(23),nc(24,"slice"),V(),F(25,"div",17),ce(26),nc(27,"slice"),V()(),F(28,"div",15)(29,"button",18),Oe("click",function(){return o.toogleMenu()}),F(30,"mat-icon"),ce(31,"more_horiz"),V()()(),F(32,"div",19,20),J(34,tW,1,2,"p-slideMenu",21),V()()()()()(),F(35,"mat-sidenav-content"),J(36,nW,6,1,"mat-toolbar",22),F(37,"div",23),Ne(38,"router-outlet"),V()()(),Ne(39,"p-confirmDialog",24)(40,"app-new-vibe-dialog")),2&e&&(j(1),B("autoFocus",!1),j(6),B("ngForOf",o.sidenavItems),j(1),B("ngIf",!o.isAdmin),j(6),Jt(o.appComponent.themeIcon),j(2),ei(" ",o.appComponent.themeTag," "),j(4),To("src",o.user.image,Co),B("alt",o.user.name),j(3),ei(" ",o.user.name.length>20?Gm(24,12,o.user.name,0,20)+"...":o.user.name," "),j(3),Jt(o.user.email.length>17?Gm(27,16,o.user.email,0,15)+"...":o.user.email),j(8),B("ngIf",o.menuToogled),j(2),B("ngIf",o.showBar),j(1),B("ngStyle",o.showBar?ai(20,iW):ai(21,oW)))},styles:['@font-face{font-family:Material Icons;font-style:normal;font-weight:400;font-display:block;src:url(material-icons.59322316b3fd6063.woff2) format("woff2"),url(material-icons.4ad034d2c499d9b6.woff) format("woff")}.material-icons[_ngcontent-%COMP%]{font-family:Material Icons;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}@font-face{font-family:Material Icons Outlined;font-style:normal;font-weight:400;font-display:block;src:url(material-icons-outlined.f86cb7b0aa53f0fe.woff2) format("woff2"),url(material-icons-outlined.78a93b2079680a08.woff) format("woff")}.material-icons-outlined[_ngcontent-%COMP%]{font-family:Material Icons Outlined;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}@font-face{font-family:Material Icons Round;font-style:normal;font-weight:400;font-display:block;src:url(material-icons-round.b10ec9db5b7fbc74.woff2) format("woff2"),url(material-icons-round.92dc7ca2f4c591e7.woff) format("woff")}.material-icons-round[_ngcontent-%COMP%]{font-family:Material Icons Round;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}@font-face{font-family:Material Icons Sharp;font-style:normal;font-weight:400;font-display:block;src:url(material-icons-sharp.3885863ee4746422.woff2) format("woff2"),url(material-icons-sharp.a71cb2bf66c604de.woff) format("woff")}.material-icons-sharp[_ngcontent-%COMP%]{font-family:Material Icons Sharp;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}@font-face{font-family:Material Icons Two Tone;font-style:normal;font-weight:400;font-display:block;src:url(material-icons-two-tone.675bd578bd14533e.woff2) format("woff2"),url(material-icons-two-tone.588d63134de807a7.woff) format("woff")}.material-icons-two-tone[_ngcontent-%COMP%]{font-family:Material Icons Two Tone;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}.mat-toolbar[_ngcontent-%COMP%]{background-color:var(--containerBackground);color:var(--fontColor);box-shadow:var(--shadows);height:4rem;position:relative;z-index:10}.mat-sidenav[_ngcontent-%COMP%]{width:265px;border-right:none;background:var(--gradientVertical);color:#fff;text-align:center}.mat-sidenav-container[_ngcontent-%COMP%]{transition:var(--transition);background-color:var(--background)}.mat-sidenav-button[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:start;font-size:1rem;color:#fff!important;letter-spacing:normal;margin-top:.3rem;font-family:Lato;height:3rem}.mat-sidenav-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5rem;margin-left:.5rem;font-size:1rem}.mat-sidenav-elements[_ngcontent-%COMP%]{width:228px}.sidenav-button-selected[_ngcontent-%COMP%]{font-weight:bolder;color:#fff;background:rgba(255,255,255,.1568627451)}.mat-sidenav-user[_ngcontent-%COMP%]{text-align:left}.mat-sidenav-email[_ngcontent-%COMP%]{font-size:.8rem;font-weight:400;text-align:left}.top-tar-full[_ngcontent-%COMP%]{background:var(--topBarGradient)}@media (max-width: 767px){.landing-image[_ngcontent-%COMP%]{position:absolute;inset:-9999px;margin:auto}}[_nghost-%COMP%]     .p-dialog{border-radius:1rem}[_nghost-%COMP%]     .p-dialog-header{border-top-left-radius:1rem;border-top-right-radius:1rem}[_nghost-%COMP%]     .p-dialog-footer{border-bottom-left-radius:1rem;border-bottom-right-radius:1rem}']}),t})();function jL(t,n,e,o,r,s,l){try{var h=t[s](l),g=h.value}catch(b){return void e(b)}h.done?n(g):Promise.resolve(g).then(o,r)}function hu(t){return function(){var n=this,e=arguments;return new Promise(function(o,r){var s=t.apply(n,e);function l(g){jL(s,o,r,l,h,"next",g)}function h(g){jL(s,o,r,l,h,"throw",g)}l(void 0)})}}let Fe=(()=>{class t{static addClass(e,o){e&&o&&(e.classList?e.classList.add(o):e.className+=" "+o)}static addMultipleClasses(e,o){if(e&&o)if(e.classList){let r=o.trim().split(" ");for(let s=0;s<r.length;s++)e.classList.add(r[s])}else{let r=o.split(" ");for(let s=0;s<r.length;s++)e.className+=" "+r[s]}}static removeClass(e,o){e&&o&&(e.classList?e.classList.remove(o):e.className=e.className.replace(new RegExp("(^|\\b)"+o.split(" ").join("|")+"(\\b|$)","gi")," "))}static hasClass(e,o){return!(!e||!o)&&(e.classList?e.classList.contains(o):new RegExp("(^| )"+o+"( |$)","gi").test(e.className))}static siblings(e){return Array.prototype.filter.call(e.parentNode.children,function(o){return o!==e})}static find(e,o){return Array.from(e.querySelectorAll(o))}static findSingle(e,o){return e?e.querySelector(o):null}static index(e){let o=e.parentNode.childNodes,r=0;for(var s=0;s<o.length;s++){if(o[s]==e)return r;1==o[s].nodeType&&r++}return-1}static indexWithinGroup(e,o){let r=e.parentNode?e.parentNode.childNodes:[],s=0;for(var l=0;l<r.length;l++){if(r[l]==e)return s;r[l].attributes&&r[l].attributes[o]&&1==r[l].nodeType&&s++}return-1}static appendOverlay(e,o,r="self"){"self"!==r&&e&&o&&this.appendChild(e,o)}static alignOverlay(e,o,r="self",s=!0){e&&o&&(s&&(e.style.minWidth||(e.style.minWidth=t.getOuterWidth(o)+"px")),"self"===r?this.relativePosition(e,o):this.absolutePosition(e,o))}static relativePosition(e,o){const r=X=>{if(X)return"relative"===getComputedStyle(X).getPropertyValue("position")?X:r(X.parentElement)},s=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),l=o.offsetHeight,h=o.getBoundingClientRect(),g=this.getWindowScrollTop(),b=this.getWindowScrollLeft(),T=this.getViewport(),R=r(e)?.getBoundingClientRect()||{top:-1*g,left:-1*b};let z,W;h.top+l+s.height>T.height?(z=h.top-R.top-s.height,e.style.transformOrigin="bottom",h.top+z<0&&(z=-1*h.top)):(z=l+h.top-R.top,e.style.transformOrigin="top"),W=s.width>T.width?-1*(h.left-R.left):h.left-R.left+s.width>T.width?-1*(h.left-R.left+s.width-T.width):h.left-R.left,e.style.top=z+"px",e.style.left=W+"px"}static absolutePosition(e,o){const r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),s=r.height,l=r.width,h=o.offsetHeight,g=o.offsetWidth,b=o.getBoundingClientRect(),T=this.getWindowScrollTop(),I=this.getWindowScrollLeft(),R=this.getViewport();let z,W;b.top+h+s>R.height?(z=b.top+T-s,e.style.transformOrigin="bottom",z<0&&(z=T)):(z=h+b.top+T,e.style.transformOrigin="top"),W=b.left+l>R.width?Math.max(0,b.left+I+g-l):b.left+I,e.style.top=z+"px",e.style.left=W+"px"}static getParents(e,o=[]){return null===e.parentNode?o:this.getParents(e.parentNode,o.concat([e.parentNode]))}static getScrollableParents(e){let o=[];if(e){let r=this.getParents(e);const s=/(auto|scroll)/,l=h=>{let g=window.getComputedStyle(h,null);return s.test(g.getPropertyValue("overflow"))||s.test(g.getPropertyValue("overflowX"))||s.test(g.getPropertyValue("overflowY"))};for(let h of r){let g=1===h.nodeType&&h.dataset.scrollselectors;if(g){let b=g.split(",");for(let T of b){let I=this.findSingle(h,T);I&&l(I)&&o.push(I)}}9!==h.nodeType&&l(h)&&o.push(h)}}return o}static getHiddenElementOuterHeight(e){e.style.visibility="hidden",e.style.display="block";let o=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",o}static getHiddenElementOuterWidth(e){e.style.visibility="hidden",e.style.display="block";let o=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",o}static getHiddenElementDimensions(e){let o={};return e.style.visibility="hidden",e.style.display="block",o.width=e.offsetWidth,o.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",o}static scrollInView(e,o){let r=getComputedStyle(e).getPropertyValue("borderTopWidth"),s=r?parseFloat(r):0,l=getComputedStyle(e).getPropertyValue("paddingTop"),h=l?parseFloat(l):0,g=e.getBoundingClientRect(),T=o.getBoundingClientRect().top+document.body.scrollTop-(g.top+document.body.scrollTop)-s-h,I=e.scrollTop,R=e.clientHeight,z=this.getOuterHeight(o);T<0?e.scrollTop=I+T:T+z>R&&(e.scrollTop=I+T-R+z)}static fadeIn(e,o){e.style.opacity=0;let r=+new Date,s=0,l=function(){s=+e.style.opacity.replace(",",".")+((new Date).getTime()-r)/o,e.style.opacity=s,r=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(l)||setTimeout(l,16))};l()}static fadeOut(e,o){var r=1,h=50/o;let g=setInterval(()=>{(r-=h)<=0&&(r=0,clearInterval(g)),e.style.opacity=r},50)}static getWindowScrollTop(){let e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}static getWindowScrollLeft(){let e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}static matches(e,o){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(l){return-1!==[].indexOf.call(document.querySelectorAll(l),this)}).call(e,o)}static getOuterWidth(e,o){let r=e.offsetWidth;if(o){let s=getComputedStyle(e);r+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return r}static getHorizontalPadding(e){let o=getComputedStyle(e);return parseFloat(o.paddingLeft)+parseFloat(o.paddingRight)}static getHorizontalMargin(e){let o=getComputedStyle(e);return parseFloat(o.marginLeft)+parseFloat(o.marginRight)}static innerWidth(e){let o=e.offsetWidth,r=getComputedStyle(e);return o+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),o}static width(e){let o=e.offsetWidth,r=getComputedStyle(e);return o-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),o}static getInnerHeight(e){let o=e.offsetHeight,r=getComputedStyle(e);return o+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),o}static getOuterHeight(e,o){let r=e.offsetHeight;if(o){let s=getComputedStyle(e);r+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return r}static getHeight(e){let o=e.offsetHeight,r=getComputedStyle(e);return o-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),o}static getWidth(e){let o=e.offsetWidth,r=getComputedStyle(e);return o-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),o}static getViewport(){let e=window,o=document,r=o.documentElement,s=o.getElementsByTagName("body")[0];return{width:e.innerWidth||r.clientWidth||s.clientWidth,height:e.innerHeight||r.clientHeight||s.clientHeight}}static getOffset(e){var o=e.getBoundingClientRect();return{top:o.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:o.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(e,o){let r=e.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(o,e)}static getUserAgent(){return navigator.userAgent}static isIE(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||(e.indexOf("Trident/")>0?(e.indexOf("rv:"),!0):e.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(e,o){if(this.isElement(o))o.appendChild(e);else{if(!o.el||!o.el.nativeElement)throw"Cannot append "+o+" to "+e;o.el.nativeElement.appendChild(e)}}static removeChild(e,o){if(this.isElement(o))o.removeChild(e);else{if(!o.el||!o.el.nativeElement)throw"Cannot remove "+e+" from "+o;o.el.nativeElement.removeChild(e)}}static removeElement(e){"remove"in Element.prototype?e.remove():e.parentNode.removeChild(e)}static isElement(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}static calculateScrollbarWidth(e){if(e){let o=getComputedStyle(e);return e.offsetWidth-e.clientWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let o=document.createElement("div");o.className="p-scrollbar-measure",document.body.appendChild(o);let r=o.offsetWidth-o.clientWidth;return document.body.removeChild(o),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let e=document.createElement("div");e.className="p-scrollbar-measure",document.body.appendChild(e);let o=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),this.calculatedScrollbarWidth=o,o}static invokeElementMethod(e,o,r){e[o].apply(e,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let e=navigator.userAgent.toLowerCase(),o=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:o[1]||"",version:o[2]||"0"}}static isInteger(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}static isHidden(e){return!e||null===e.offsetParent}static isVisible(e){return e&&null!=e.offsetParent}static isExist(e){return null!==e&&typeof e<"u"&&e.nodeName&&e.parentNode}static focus(e,o){e&&document.activeElement!==e&&e.focus(o)}static getFocusableElements(e){let o=t.find(e,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let s of o)(s.offsetWidth||s.offsetHeight||s.getClientRects().length)&&r.push(s);return r}static getNextFocusableElement(e,o=!1){const r=t.getFocusableElements(e);let s=0;if(r&&r.length>0){const l=r.indexOf(r[0].ownerDocument.activeElement);o?s=-1==l||0===l?r.length-1:l-1:-1!=l&&l!==r.length-1&&(s=l+1)}return r[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(e,o){if(!e)return null;switch(e){case"document":return document;case"window":return window;case"@next":return o?.nextElementSibling;case"@prev":return o?.previousElementSibling;case"@parent":return o?.parentElement;case"@grandparent":return o?.parentElement.parentElement;default:const r=typeof e;if("string"===r)return document.querySelector(e);if("object"===r&&e.hasOwnProperty("nativeElement"))return this.isExist(e.nativeElement)?e.nativeElement:void 0;const l=(h=e)&&h.constructor&&h.call&&h.apply?e():e;return l&&9===l.nodeType||this.isExist(l)?l:null}var h}}return t.zindex=1e3,t.calculatedScrollbarWidth=null,t.calculatedScrollbarHeight=null,t})();class qb{constructor(n,e=(()=>{})){this.element=n,this.listener=e}bindScrollListener(){this.scrollableParents=Fe.getScrollableParents(this.element);for(let n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}let vd=(()=>{class t{constructor(e,o,r){this.el=e,this.zone=o,this.config=r}ngAfterViewInit(){this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.onMouseDown.bind(this),this.el.nativeElement.addEventListener("mousedown",this.mouseDownListener)})}onMouseDown(e){let o=this.getInk();if(!o||"none"===getComputedStyle(o,null).display)return;if(Fe.removeClass(o,"p-ink-active"),!Fe.getHeight(o)&&!Fe.getWidth(o)){let h=Math.max(Fe.getOuterWidth(this.el.nativeElement),Fe.getOuterHeight(this.el.nativeElement));o.style.height=h+"px",o.style.width=h+"px"}let r=Fe.getOffset(this.el.nativeElement),s=e.pageX-r.left+document.body.scrollTop-Fe.getWidth(o)/2,l=e.pageY-r.top+document.body.scrollLeft-Fe.getHeight(o)/2;o.style.top=l+"px",o.style.left=s+"px",Fe.addClass(o,"p-ink-active"),this.timeout=setTimeout(()=>{let h=this.getInk();h&&Fe.removeClass(h,"p-ink-active")},401)}getInk(){const e=this.el.nativeElement.children;for(let o=0;o<e.length;o++)if("string"==typeof e[o].className&&-1!==e[o].className.indexOf("p-ink"))return e[o];return null}resetInk(){let e=this.getInk();e&&Fe.removeClass(e,"p-ink-active")}onAnimationEnd(e){this.timeout&&clearTimeout(this.timeout),Fe.removeClass(e.currentTarget,"p-ink-active")}create(){let e=document.createElement("span");e.className="p-ink",this.el.nativeElement.appendChild(e),this.animationListener=this.onAnimationEnd.bind(this),e.addEventListener("animationend",this.animationListener)}remove(){let e=this.getInk();e&&(this.el.nativeElement.removeEventListener("mousedown",this.mouseDownListener),e.removeEventListener("animationend",this.animationListener),Fe.removeElement(e))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(fi),be(Il,8))},t.\u0275dir=kn({type:t,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]}),t})(),il=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();function rW(t,n){1&t&&Ht(0)}const sW=function(t,n,e,o){return{"p-button-icon":!0,"p-button-icon-left":t,"p-button-icon-right":n,"p-button-icon-top":e,"p-button-icon-bottom":o}};function aW(t,n){if(1&t&&Ne(0,"span",4),2&t){const e=q();Xn(e.loading?"p-button-loading-icon "+e.loadingIcon:e.icon),B("ngClass",Th(4,sW,"left"===e.iconPos&&e.label,"right"===e.iconPos&&e.label,"top"===e.iconPos&&e.label,"bottom"===e.iconPos&&e.label)),st("aria-hidden",!0)}}function lW(t,n){if(1&t&&(F(0,"span",5),ce(1),V()),2&t){const e=q();st("aria-hidden",e.icon&&!e.label),j(1),Jt(e.label)}}function cW(t,n){if(1&t&&(F(0,"span",4),ce(1),V()),2&t){const e=q();Xn(e.badgeClass),B("ngClass",e.badgeStyleClass()),j(1),Jt(e.badge)}}const uW=function(t,n,e,o,r){return{"p-button p-component":!0,"p-button-icon-only":t,"p-button-vertical":n,"p-disabled":e,"p-button-loading":o,"p-button-loading-label-only":r}},dW=["*"],ag={button:"p-button",component:"p-component",iconOnly:"p-button-icon-only",disabled:"p-disabled",loading:"p-button-loading",labelOnly:"p-button-loading-label-only"};let os=(()=>{class t{constructor(e){this.el=e,this.iconPos="left",this.loadingIcon="pi pi-spinner pi-spin",this._loading=!1,this._internalClasses=Object.values(ag)}get label(){return this._label}set label(e){this._label=e,this.initialized&&(this.updateLabel(),this.updateIcon(),this.setStyleClass())}get icon(){return this._icon}set icon(e){this._icon=e,this.initialized&&(this.updateIcon(),this.setStyleClass())}get loading(){return this._loading}set loading(e){this._loading=e,this.initialized&&(this.updateIcon(),this.setStyleClass())}get htmlElement(){return this.el.nativeElement}ngAfterViewInit(){Fe.addMultipleClasses(this.htmlElement,this.getStyleClass().join(" ")),this.createIcon(),this.createLabel(),this.initialized=!0}getStyleClass(){const e=[ag.button,ag.component];return this.icon&&!this.label&&_n.isEmpty(this.htmlElement.textContent)&&e.push(ag.iconOnly),this.loading&&(e.push(ag.disabled,ag.loading),!this.icon&&this.label&&e.push(ag.labelOnly)),e}setStyleClass(){const e=this.getStyleClass();this.htmlElement.classList.remove(...this._internalClasses),this.htmlElement.classList.add(...e)}createLabel(){if(this.label){let e=document.createElement("span");this.icon&&!this.label&&e.setAttribute("aria-hidden","true"),e.className="p-button-label",e.appendChild(document.createTextNode(this.label)),this.htmlElement.appendChild(e)}}createIcon(){if(this.icon||this.loading){let e=document.createElement("span");e.className="p-button-icon",e.setAttribute("aria-hidden","true");let o=this.label?"p-button-icon-"+this.iconPos:null;o&&Fe.addClass(e,o);let r=this.getIconClass();r&&Fe.addMultipleClasses(e,r),this.htmlElement.insertBefore(e,this.htmlElement.firstChild)}}updateLabel(){let e=Fe.findSingle(this.htmlElement,".p-button-label");this.label?e?e.textContent=this.label:this.createLabel():e&&this.htmlElement.removeChild(e)}updateIcon(){let e=Fe.findSingle(this.htmlElement,".p-button-icon");this.icon||this.loading?e?e.className=this.iconPos?"p-button-icon p-button-icon-"+this.iconPos+" "+this.getIconClass():"p-button-icon "+this.getIconClass():this.createIcon():e&&this.htmlElement.removeChild(e)}getIconClass(){return this.loading?"p-button-loading-icon "+this.loadingIcon:this._icon}ngOnDestroy(){this.initialized=!1}}return t.\u0275fac=function(e){return new(e||t)(be(si))},t.\u0275dir=kn({type:t,selectors:[["","pButton",""]],hostAttrs:[1,"p-element"],inputs:{iconPos:"iconPos",loadingIcon:"loadingIcon",label:"label",icon:"icon",loading:"loading"}}),t})(),hW=(()=>{class t{constructor(){this.type="button",this.iconPos="left",this.loading=!1,this.loadingIcon="pi pi-spinner pi-spin",this.onClick=new Tt,this.onFocus=new Tt,this.onBlur=new Tt}ngAfterContentInit(){this.templates.forEach(e=>{e.getType(),this.contentTemplate=e.template})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&1===String(this.badge).length}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["p-button"]],contentQueries:function(e,o,r){if(1&e&&No(r,_o,4),2&e){let s;mn(s=gn())&&(o.templates=s)}},hostAttrs:[1,"p-element"],inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:"disabled",loading:"loading",loadingIcon:"loadingIcon",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},ngContentSelectors:dW,decls:6,vars:17,consts:[["pRipple","",3,"ngStyle","disabled","ngClass","click","focus","blur"],[4,"ngTemplateOutlet"],[3,"ngClass","class",4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass"],[1,"p-button-label"]],template:function(e,o){1&e&&(or(),F(0,"button",0),Oe("click",function(s){return o.onClick.emit(s)})("focus",function(s){return o.onFocus.emit(s)})("blur",function(s){return o.onBlur.emit(s)}),Qi(1),J(2,rW,1,0,"ng-container",1),J(3,aW,1,9,"span",2),J(4,lW,2,2,"span",3),J(5,cW,2,4,"span",2),V()),2&e&&(Xn(o.styleClass),B("ngStyle",o.style)("disabled",o.disabled||o.loading)("ngClass",Xv(11,uW,o.icon&&!o.label,("top"===o.iconPos||"bottom"===o.iconPos)&&o.label,o.disabled||o.loading,o.loading,o.loading&&!o.icon&&o.label)),st("type",o.type)("aria-label",o.ariaLabel),j(2),B("ngTemplateOutlet",o.contentTemplate),j(1),B("ngIf",!o.contentTemplate&&(o.icon||o.loading)),j(1),B("ngIf",!o.contentTemplate&&o.label),j(1),B("ngIf",!o.contentTemplate&&o.badge))},dependencies:[Eo,mi,Is,Oo,vd],encapsulation:2,changeDetection:0}),t})(),pu=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,il]}),t})(),fc=(()=>{class t{constructor(e,o,r){this.el=e,this.ngModel=o,this.cd=r}ngAfterViewInit(){this.updateFilledState(),this.cd.detectChanges()}ngDoCheck(){this.updateFilledState()}onInput(e){this.updateFilledState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length||this.ngModel&&this.ngModel.model}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(hd,8),be(Po))},t.\u0275dir=kn({type:t,selectors:[["","pInputText",""]],hostAttrs:[1,"p-inputtext","p-component","p-element"],hostVars:2,hostBindings:function(e,o){1&e&&Oe("input",function(s){return o.onInput(s)}),2&e&&Mo("p-filled",o.filled)}}),t})(),Zb=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();const pW=["container"],fW=["inputfield"],mW=["contentWrapper"];function gW(t,n){if(1&t){const e=xt();F(0,"i",8),Oe("click",function(){return Ie(e),Me(q(2).clear())}),V()}}function _W(t,n){if(1&t){const e=xt();F(0,"button",9),Oe("click",function(r){Ie(e),q();const s=jn(1);return Me(q().onButtonClick(r,s))}),V()}if(2&t){const e=q(2);B("icon",e.icon)("disabled",e.disabled),st("aria-label",e.iconAriaLabel)}}function yW(t,n){if(1&t){const e=xt();F(0,"input",4,5),Oe("focus",function(r){return Ie(e),Me(q().onInputFocus(r))})("keydown",function(r){return Ie(e),Me(q().onInputKeydown(r))})("click",function(){return Ie(e),Me(q().onInputClick())})("blur",function(r){return Ie(e),Me(q().onInputBlur(r))})("input",function(r){return Ie(e),Me(q().onUserInput(r))}),V(),J(2,gW,1,0,"i",6),J(3,_W,1,3,"button",7)}if(2&t){const e=q();Xn(e.inputStyleClass),B("value",e.inputFieldValue)("readonly",e.readonlyInput)("ngStyle",e.inputStyle)("placeholder",e.placeholder||"")("disabled",e.disabled)("ngClass","p-inputtext p-component"),st("id",e.inputId)("name",e.name)("required",e.required)("aria-required",e.required)("tabindex",e.tabindex)("inputmode",e.touchUI?"off":null)("aria-labelledby",e.ariaLabelledBy),j(2),B("ngIf",e.showClear&&!e.disabled&&null!=e.value),j(1),B("ngIf",e.showIcon)}}function vW(t,n){1&t&&Ht(0)}function bW(t,n){if(1&t){const e=xt();F(0,"button",30),Oe("keydown",function(r){return Ie(e),Me(q(4).onContainerButtonKeydown(r))})("click",function(r){return Ie(e),Me(q(4).onPrevButtonClick(r))}),Ne(1,"span",31),V()}}function xW(t,n){if(1&t){const e=xt();F(0,"button",32),Oe("click",function(r){return Ie(e),Me(q(4).switchToMonthView(r))})("keydown",function(r){return Ie(e),Me(q(4).onContainerButtonKeydown(r))}),ce(1),V()}if(2&t){const e=q().$implicit,o=q(3);B("disabled",o.switchViewButtonDisabled()),j(1),ei(" ",o.getMonthName(e.month)," ")}}function wW(t,n){if(1&t){const e=xt();F(0,"button",33),Oe("click",function(r){return Ie(e),Me(q(4).switchToYearView(r))})("keydown",function(r){return Ie(e),Me(q(4).onContainerButtonKeydown(r))}),ce(1),V()}if(2&t){const e=q().$implicit,o=q(3);B("disabled",o.switchViewButtonDisabled()),j(1),ei(" ",o.getYear(e)," ")}}function CW(t,n){if(1&t&&(xn(0),ce(1),In()),2&t){const e=q(5);j(1),O_("",e.yearPickerValues()[0]," - ",e.yearPickerValues()[e.yearPickerValues().length-1],"")}}function TW(t,n){1&t&&Ht(0)}const HL=function(t){return{$implicit:t}};function EW(t,n){if(1&t&&(F(0,"span",34),J(1,CW,2,2,"ng-container",13),J(2,TW,1,0,"ng-container",35),V()),2&t){const e=q(4);j(1),B("ngIf",!e.decadeTemplate),j(1),B("ngTemplateOutlet",e.decadeTemplate)("ngTemplateOutletContext",An(3,HL,e.yearPickerValues))}}function SW(t,n){if(1&t&&(F(0,"th",41)(1,"span"),ce(2),V()()),2&t){const e=q(5);j(2),Jt(e.getTranslation("weekHeader"))}}function DW(t,n){if(1&t&&(F(0,"th",42)(1,"span"),ce(2),V()()),2&t){const e=n.$implicit;j(2),Jt(e)}}function MW(t,n){if(1&t&&(F(0,"td",45)(1,"span",46),ce(2),V()()),2&t){const e=q().index,o=q(2).$implicit;j(2),ei(" ",o.weekNumbers[e]," ")}}function IW(t,n){if(1&t&&(xn(0),ce(1),In()),2&t){const e=q(2).$implicit;j(1),Jt(e.day)}}function kW(t,n){1&t&&Ht(0)}const $L=function(t,n){return{"p-highlight":t,"p-disabled":n}};function AW(t,n){if(1&t){const e=xt();xn(0),F(1,"span",48),Oe("click",function(r){Ie(e);const s=q().$implicit;return Me(q(6).onDateSelect(r,s))})("keydown",function(r){Ie(e);const s=q().$implicit,l=q(3).index;return Me(q(3).onDateCellKeydown(r,s,l))}),J(2,IW,2,1,"ng-container",13),J(3,kW,1,0,"ng-container",35),V(),In()}if(2&t){const e=q().$implicit,o=q(6);j(1),B("ngClass",no(4,$L,o.isSelected(e),!e.selectable)),j(1),B("ngIf",!o.dateTemplate),j(1),B("ngTemplateOutlet",o.dateTemplate)("ngTemplateOutletContext",An(7,HL,e))}}const PW=function(t,n){return{"p-datepicker-other-month":t,"p-datepicker-today":n}};function OW(t,n){if(1&t&&(F(0,"td",47),J(1,AW,4,9,"ng-container",13),V()),2&t){const e=n.$implicit,o=q(6);B("ngClass",no(2,PW,e.otherMonth,e.today)),j(1),B("ngIf",!e.otherMonth||o.showOtherMonths)}}function RW(t,n){if(1&t&&(F(0,"tr"),J(1,MW,3,1,"td",43),J(2,OW,2,5,"td",44),V()),2&t){const e=n.$implicit,o=q(5);j(1),B("ngIf",o.showWeek),j(1),B("ngForOf",e)}}function LW(t,n){if(1&t&&(F(0,"div",36)(1,"table",37)(2,"thead")(3,"tr"),J(4,SW,3,1,"th",38),J(5,DW,3,1,"th",39),V()(),F(6,"tbody"),J(7,RW,3,2,"tr",40),V()()()),2&t){const e=q().$implicit,o=q(3);j(4),B("ngIf",o.showWeek),j(1),B("ngForOf",o.weekDays),j(2),B("ngForOf",e.dates)}}function FW(t,n){if(1&t){const e=xt();F(0,"div",20)(1,"div",21),J(2,bW,2,0,"button",22),F(3,"div",23),J(4,xW,2,2,"button",24),J(5,wW,2,2,"button",25),J(6,EW,3,5,"span",26),V(),F(7,"button",27),Oe("keydown",function(r){return Ie(e),Me(q(3).onContainerButtonKeydown(r))})("click",function(r){return Ie(e),Me(q(3).onNextButtonClick(r))}),Ne(8,"span",28),V()(),J(9,LW,8,3,"div",29),V()}if(2&t){const e=n.index,o=q(3);j(2),B("ngIf",0===e),j(2),B("ngIf","date"===o.currentView),j(1),B("ngIf","year"!==o.currentView),j(1),B("ngIf","year"===o.currentView),j(1),aa("display",1===o.numberOfMonths||e===o.numberOfMonths-1?"inline-flex":"none"),j(2),B("ngIf","date"===o.currentView)}}function zW(t,n){if(1&t){const e=xt();F(0,"span",51),Oe("click",function(r){const l=Ie(e).index;return Me(q(4).onMonthSelect(r,l))})("keydown",function(r){const l=Ie(e).index;return Me(q(4).onMonthCellKeydown(r,l))}),ce(1),V()}if(2&t){const e=n.$implicit,o=n.index,r=q(4);B("ngClass",no(2,$L,r.isMonthSelected(o),r.isMonthDisabled(o))),j(1),ei(" ",e," ")}}function NW(t,n){if(1&t&&(F(0,"div",49),J(1,zW,2,5,"span",50),V()),2&t){const e=q(3);j(1),B("ngForOf",e.monthPickerValues())}}const BW=function(t){return{"p-highlight":t}};function VW(t,n){if(1&t){const e=xt();F(0,"span",54),Oe("click",function(r){const l=Ie(e).$implicit;return Me(q(4).onYearSelect(r,l))})("keydown",function(r){const l=Ie(e).$implicit;return Me(q(4).onYearCellKeydown(r,l))}),ce(1),V()}if(2&t){const e=n.$implicit,o=q(4);B("ngClass",An(2,BW,o.isYearSelected(e))),j(1),ei(" ",e," ")}}function UW(t,n){if(1&t&&(F(0,"div",52),J(1,VW,2,4,"span",53),V()),2&t){const e=q(3);j(1),B("ngForOf",e.yearPickerValues())}}function jW(t,n){if(1&t&&(xn(0),F(1,"div",16),J(2,FW,10,7,"div",17),V(),J(3,NW,2,1,"div",18),J(4,UW,2,1,"div",19),In()),2&t){const e=q(2);j(2),B("ngForOf",e.months),j(1),B("ngIf","month"===e.currentView),j(1),B("ngIf","year"===e.currentView)}}function HW(t,n){1&t&&(xn(0),ce(1,"0"),In())}function $W(t,n){1&t&&(xn(0),ce(1,"0"),In())}function GW(t,n){if(1&t&&(F(0,"div",60)(1,"span"),ce(2),V()()),2&t){const e=q(3);j(2),Jt(e.timeSeparator)}}function WW(t,n){1&t&&(xn(0),ce(1,"0"),In())}function qW(t,n){if(1&t){const e=xt();F(0,"div",65)(1,"button",57),Oe("keydown",function(r){return Ie(e),Me(q(3).onContainerButtonKeydown(r))})("keydown.enter",function(r){return Ie(e),Me(q(3).incrementSecond(r))})("keydown.space",function(r){return Ie(e),Me(q(3).incrementSecond(r))})("mousedown",function(r){return Ie(e),Me(q(3).onTimePickerElementMouseDown(r,2,1))})("mouseup",function(r){return Ie(e),Me(q(3).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return Ie(e),Me(q(3).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return Ie(e),Me(q(3).onTimePickerElementMouseUp(r))})("mouseleave",function(){return Ie(e),Me(q(3).onTimePickerElementMouseLeave())}),Ne(2,"span",58),V(),F(3,"span"),J(4,WW,2,0,"ng-container",13),ce(5),V(),F(6,"button",57),Oe("keydown",function(r){return Ie(e),Me(q(3).onContainerButtonKeydown(r))})("keydown.enter",function(r){return Ie(e),Me(q(3).decrementSecond(r))})("keydown.space",function(r){return Ie(e),Me(q(3).decrementSecond(r))})("mousedown",function(r){return Ie(e),Me(q(3).onTimePickerElementMouseDown(r,2,-1))})("mouseup",function(r){return Ie(e),Me(q(3).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return Ie(e),Me(q(3).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return Ie(e),Me(q(3).onTimePickerElementMouseUp(r))})("mouseleave",function(){return Ie(e),Me(q(3).onTimePickerElementMouseLeave())}),Ne(7,"span",59),V()()}if(2&t){const e=q(3);j(4),B("ngIf",e.currentSecond<10),j(1),Jt(e.currentSecond)}}function ZW(t,n){if(1&t){const e=xt();F(0,"div",66)(1,"button",67),Oe("keydown",function(r){return Ie(e),Me(q(3).onContainerButtonKeydown(r))})("click",function(r){return Ie(e),Me(q(3).toggleAMPM(r))})("keydown.enter",function(r){return Ie(e),Me(q(3).toggleAMPM(r))}),Ne(2,"span",58),V(),F(3,"span"),ce(4),V(),F(5,"button",67),Oe("keydown",function(r){return Ie(e),Me(q(3).onContainerButtonKeydown(r))})("click",function(r){return Ie(e),Me(q(3).toggleAMPM(r))})("keydown.enter",function(r){return Ie(e),Me(q(3).toggleAMPM(r))}),Ne(6,"span",59),V()()}if(2&t){const e=q(3);j(4),Jt(e.pm?"PM":"AM")}}function KW(t,n){if(1&t){const e=xt();F(0,"div",55)(1,"div",56)(2,"button",57),Oe("keydown",function(r){return Ie(e),Me(q(2).onContainerButtonKeydown(r))})("keydown.enter",function(r){return Ie(e),Me(q(2).incrementHour(r))})("keydown.space",function(r){return Ie(e),Me(q(2).incrementHour(r))})("mousedown",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseDown(r,0,1))})("mouseup",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("mouseleave",function(){return Ie(e),Me(q(2).onTimePickerElementMouseLeave())}),Ne(3,"span",58),V(),F(4,"span"),J(5,HW,2,0,"ng-container",13),ce(6),V(),F(7,"button",57),Oe("keydown",function(r){return Ie(e),Me(q(2).onContainerButtonKeydown(r))})("keydown.enter",function(r){return Ie(e),Me(q(2).decrementHour(r))})("keydown.space",function(r){return Ie(e),Me(q(2).decrementHour(r))})("mousedown",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseDown(r,0,-1))})("mouseup",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("mouseleave",function(){return Ie(e),Me(q(2).onTimePickerElementMouseLeave())}),Ne(8,"span",59),V()(),F(9,"div",60)(10,"span"),ce(11),V()(),F(12,"div",61)(13,"button",57),Oe("keydown",function(r){return Ie(e),Me(q(2).onContainerButtonKeydown(r))})("keydown.enter",function(r){return Ie(e),Me(q(2).incrementMinute(r))})("keydown.space",function(r){return Ie(e),Me(q(2).incrementMinute(r))})("mousedown",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseDown(r,1,1))})("mouseup",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("mouseleave",function(){return Ie(e),Me(q(2).onTimePickerElementMouseLeave())}),Ne(14,"span",58),V(),F(15,"span"),J(16,$W,2,0,"ng-container",13),ce(17),V(),F(18,"button",57),Oe("keydown",function(r){return Ie(e),Me(q(2).onContainerButtonKeydown(r))})("keydown.enter",function(r){return Ie(e),Me(q(2).decrementMinute(r))})("keydown.space",function(r){return Ie(e),Me(q(2).decrementMinute(r))})("mousedown",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseDown(r,1,-1))})("mouseup",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return Ie(e),Me(q(2).onTimePickerElementMouseUp(r))})("mouseleave",function(){return Ie(e),Me(q(2).onTimePickerElementMouseLeave())}),Ne(19,"span",59),V()(),J(20,GW,3,1,"div",62),J(21,qW,8,2,"div",63),J(22,ZW,7,1,"div",64),V()}if(2&t){const e=q(2);j(5),B("ngIf",e.currentHour<10),j(1),Jt(e.currentHour),j(5),Jt(e.timeSeparator),j(5),B("ngIf",e.currentMinute<10),j(1),Jt(e.currentMinute),j(3),B("ngIf",e.showSeconds),j(1),B("ngIf",e.showSeconds),j(1),B("ngIf","12"==e.hourFormat)}}const GL=function(t){return[t]};function XW(t,n){if(1&t){const e=xt();F(0,"div",68)(1,"button",69),Oe("keydown",function(r){return Ie(e),Me(q(2).onContainerButtonKeydown(r))})("click",function(r){return Ie(e),Me(q(2).onTodayButtonClick(r))}),V(),F(2,"button",69),Oe("keydown",function(r){return Ie(e),Me(q(2).onContainerButtonKeydown(r))})("click",function(r){return Ie(e),Me(q(2).onClearButtonClick(r))}),V()()}if(2&t){const e=q(2);j(1),B("label",e.getTranslation("today"))("ngClass",An(4,GL,e.todayButtonStyleClass)),j(1),B("label",e.getTranslation("clear"))("ngClass",An(6,GL,e.clearButtonStyleClass))}}function YW(t,n){1&t&&Ht(0)}const QW=function(t,n,e,o,r,s){return{"p-datepicker p-component":!0,"p-datepicker-inline":t,"p-disabled":n,"p-datepicker-timeonly":e,"p-datepicker-multiple-month":o,"p-datepicker-monthpicker":r,"p-datepicker-touch-ui":s}},WL=function(t,n){return{showTransitionParams:t,hideTransitionParams:n}},JW=function(t){return{value:"visibleTouchUI",params:t}},eq=function(t){return{value:"visible",params:t}};function tq(t,n){if(1&t){const e=xt();F(0,"div",10,11),Oe("@overlayAnimation.start",function(r){return Ie(e),Me(q().onOverlayAnimationStart(r))})("@overlayAnimation.done",function(r){return Ie(e),Me(q().onOverlayAnimationDone(r))})("click",function(r){return Ie(e),Me(q().onOverlayClick(r))}),Qi(2),J(3,vW,1,0,"ng-container",12),J(4,jW,5,3,"ng-container",13),J(5,KW,23,8,"div",14),J(6,XW,3,8,"div",15),Qi(7,1),J(8,YW,1,0,"ng-container",12),V()}if(2&t){const e=q();Xn(e.panelStyleClass),B("ngStyle",e.panelStyle)("ngClass",z_(11,QW,e.inline,e.disabled,e.timeOnly,e.numberOfMonths>1,"month"===e.view,e.touchUI))("@overlayAnimation",e.touchUI?An(21,JW,no(18,WL,e.showTransitionOptions,e.hideTransitionOptions)):An(26,eq,no(23,WL,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",!0===e.inline),j(3),B("ngTemplateOutlet",e.headerTemplate),j(1),B("ngIf",!e.timeOnly),j(1),B("ngIf",(e.showTime||e.timeOnly)&&"date"===e.currentView),j(1),B("ngIf",e.showButtonBar),j(2),B("ngTemplateOutlet",e.footerTemplate)}}const nq=[[["p-header"]],[["p-footer"]]],iq=function(t,n,e,o){return{"p-calendar":!0,"p-calendar-w-btn":t,"p-calendar-timeonly":n,"p-calendar-disabled":e,"p-focus":o}},oq=["p-header","p-footer"],rq={provide:ks,useExisting:xi(()=>sq),multi:!0};let sq=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.renderer=o,this.cd=r,this.zone=s,this.config=l,this.overlayService=h,this.multipleSeparator=",",this.rangeSeparator="-",this.inline=!1,this.showOtherMonths=!0,this.icon="pi pi-calendar",this.shortYearCutoff="+10",this.hourFormat="24",this.stepHour=1,this.stepMinute=1,this.stepSecond=1,this.showSeconds=!1,this.showOnFocus=!0,this.showWeek=!1,this.showClear=!1,this.dataType="date",this.selectionMode="single",this.todayButtonStyleClass="p-button-text",this.clearButtonStyleClass="p-button-text",this.autoZIndex=!0,this.baseZIndex=0,this.keepInvalid=!1,this.hideOnDateTimeSelect=!0,this.timeSeparator=":",this.focusTrap=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.onFocus=new Tt,this.onBlur=new Tt,this.onClose=new Tt,this.onSelect=new Tt,this.onClear=new Tt,this.onInput=new Tt,this.onTodayClick=new Tt,this.onClearClick=new Tt,this.onMonthChange=new Tt,this.onYearChange=new Tt,this.onClickOutside=new Tt,this.onShow=new Tt,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.inputFieldValue=null,this.navigationState=null,this._numberOfMonths=1,this._view="date",this.convertTo24Hour=function(g,b){return"12"==this.hourFormat?12===g?b?12:0:b?g+12:g:g}}set content(e){this.contentViewChild=e,this.contentViewChild&&(this.isMonthNavigate?(Promise.resolve(null).then(()=>this.updateFocus()),this.isMonthNavigate=!1):this.focus||this.initFocusableCell())}get view(){return this._view}set view(e){this._view=e,this.currentView=this._view}get defaultDate(){return this._defaultDate}set defaultDate(e){if(this._defaultDate=e,this.initialized){const o=e||new Date;this.currentMonth=o.getMonth(),this.currentYear=o.getFullYear(),this.initTime(o),this.createMonths(this.currentMonth,this.currentYear)}}get minDate(){return this._minDate}set minDate(e){this._minDate=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDates(){return this._disabledDates}set disabledDates(e){this._disabledDates=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDays(){return this._disabledDays}set disabledDays(e){this._disabledDays=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get yearRange(){return this._yearRange}set yearRange(e){if(this._yearRange=e,e){const o=e.split(":"),r=parseInt(o[0]),s=parseInt(o[1]);this.populateYearOptions(r,s)}}get showTime(){return this._showTime}set showTime(e){this._showTime=e,void 0===this.currentHour&&this.initTime(this.value||new Date),this.updateInputfield()}get locale(){return this._locale}get responsiveOptions(){return this._responsiveOptions}set responsiveOptions(e){this._responsiveOptions=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get numberOfMonths(){return this._numberOfMonths}set numberOfMonths(e){this._numberOfMonths=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get firstDayOfWeek(){return this._firstDayOfWeek}set firstDayOfWeek(e){this._firstDayOfWeek=e,this.createWeekDays()}set locale(e){console.warn("Locale property has no effect, use new i18n API instead.")}ngOnInit(){this.attributeSelector=cy();const e=this.defaultDate||new Date;this.createResponsiveStyle(),this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear(),this.currentView=this.view,"date"===this.view&&(this.createWeekDays(),this.initTime(e),this.createMonths(this.currentMonth,this.currentYear),this.ticksTo1970=24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.createWeekDays(),this.cd.markForCheck()}),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"date":default:this.dateTemplate=e.template;break;case"decade":this.decadeTemplate=e.template;break;case"disabledDate":this.disabledDateTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngAfterViewInit(){this.inline&&(this.contentViewChild&&this.contentViewChild.nativeElement.setAttribute(this.attributeSelector,""),this.disabled||(this.initFocusableCell(),1===this.numberOfMonths&&(this.contentViewChild.nativeElement.style.width=Fe.getOuterWidth(this.containerViewChild.nativeElement)+"px")))}getTranslation(e){return this.config.getTranslation(e)}populateYearOptions(e,o){this.yearOptions=[];for(let r=e;r<=o;r++)this.yearOptions.push(r)}createWeekDays(){this.weekDays=[];let e=this.getFirstDateOfWeek(),o=this.getTranslation(Dr.DAY_NAMES_MIN);for(let r=0;r<7;r++)this.weekDays.push(o[e]),e=6==e?0:++e}monthPickerValues(){let e=[];for(let o=0;o<=11;o++)e.push(this.config.getTranslation("monthNamesShort")[o]);return e}yearPickerValues(){let e=[],o=this.currentYear-this.currentYear%10;for(let r=0;r<10;r++)e.push(o+r);return e}createMonths(e,o){this.months=this.months=[];for(let r=0;r<this.numberOfMonths;r++){let s=e+r,l=o;s>11&&(s=s%11-1,l=o+1),this.months.push(this.createMonth(s,l))}}getWeekNumber(e){let o=new Date(e.getTime());o.setDate(o.getDate()+4-(o.getDay()||7));let r=o.getTime();return o.setMonth(0),o.setDate(1),Math.floor(Math.round((r-o.getTime())/864e5)/7)+1}createMonth(e,o){let r=[],s=this.getFirstDayOfMonthIndex(e,o),l=this.getDaysCountInMonth(e,o),h=this.getDaysCountInPrevMonth(e,o),g=1,b=new Date,T=[],I=Math.ceil((l+s)/7);for(let R=0;R<I;R++){let z=[];if(0==R){for(let X=h-s+1;X<=h;X++){let ee=this.getPreviousMonthAndYear(e,o);z.push({day:X,month:ee.month,year:ee.year,otherMonth:!0,today:this.isToday(b,X,ee.month,ee.year),selectable:this.isSelectable(X,ee.month,ee.year,!0)})}let W=7-z.length;for(let X=0;X<W;X++)z.push({day:g,month:e,year:o,today:this.isToday(b,g,e,o),selectable:this.isSelectable(g,e,o,!1)}),g++}else for(let W=0;W<7;W++){if(g>l){let X=this.getNextMonthAndYear(e,o);z.push({day:g-l,month:X.month,year:X.year,otherMonth:!0,today:this.isToday(b,g-l,X.month,X.year),selectable:this.isSelectable(g-l,X.month,X.year,!0)})}else z.push({day:g,month:e,year:o,today:this.isToday(b,g,e,o),selectable:this.isSelectable(g,e,o,!1)});g++}this.showWeek&&T.push(this.getWeekNumber(new Date(z[0].year,z[0].month,z[0].day))),r.push(z)}return{month:e,year:o,dates:r,weekNumbers:T}}initTime(e){this.pm=e.getHours()>11,this.showTime?(this.currentMinute=e.getMinutes(),this.currentSecond=e.getSeconds(),this.setCurrentHourPM(e.getHours())):this.timeOnly&&(this.currentMinute=0,this.currentHour=0,this.currentSecond=0)}navBackward(e){this.disabled?e.preventDefault():(this.isMonthNavigate=!0,"month"===this.currentView?(this.decrementYear(),setTimeout(()=>{this.updateFocus()},1)):"year"===this.currentView?(this.decrementDecade(),setTimeout(()=>{this.updateFocus()},1)):(0===this.currentMonth?(this.currentMonth=11,this.decrementYear()):this.currentMonth--,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)))}navForward(e){this.disabled?e.preventDefault():(this.isMonthNavigate=!0,"month"===this.currentView?(this.incrementYear(),setTimeout(()=>{this.updateFocus()},1)):"year"===this.currentView?(this.incrementDecade(),setTimeout(()=>{this.updateFocus()},1)):(11===this.currentMonth?(this.currentMonth=0,this.incrementYear()):this.currentMonth++,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)))}decrementYear(){if(this.currentYear--,this.yearNavigator&&this.currentYear<this.yearOptions[0]){let e=this.yearOptions[this.yearOptions.length-1]-this.yearOptions[0];this.populateYearOptions(this.yearOptions[0]-e,this.yearOptions[this.yearOptions.length-1]-e)}}decrementDecade(){this.currentYear=this.currentYear-10}incrementDecade(){this.currentYear=this.currentYear+10}incrementYear(){if(this.currentYear++,this.yearNavigator&&this.currentYear>this.yearOptions[this.yearOptions.length-1]){let e=this.yearOptions[this.yearOptions.length-1]-this.yearOptions[0];this.populateYearOptions(this.yearOptions[0]+e,this.yearOptions[this.yearOptions.length-1]+e)}}switchToMonthView(e){this.setCurrentView("month"),e.preventDefault()}switchToYearView(e){this.setCurrentView("year"),e.preventDefault()}onDateSelect(e,o){!this.disabled&&o.selectable?(this.isMultipleSelection()&&this.isSelected(o)?(this.value=this.value.filter((r,s)=>!this.isDateEquals(r,o)),0===this.value.length&&(this.value=null),this.updateModel(this.value)):this.shouldSelectDate(o)&&this.selectDate(o),this.isSingleSelection()&&this.hideOnDateTimeSelect&&setTimeout(()=>{e.preventDefault(),this.hideOverlay(),this.mask&&this.disableModality(),this.cd.markForCheck()},150),this.updateInputfield(),e.preventDefault()):e.preventDefault()}shouldSelectDate(e){return!this.isMultipleSelection()||null==this.maxDateCount||this.maxDateCount>(this.value?this.value.length:0)}onMonthSelect(e,o){"month"===this.view?this.onDateSelect(e,{year:this.currentYear,month:o,day:1,selectable:!0}):(this.currentMonth=o,this.createMonths(this.currentMonth,this.currentYear),this.setCurrentView("date"),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}))}onYearSelect(e,o){"year"===this.view?this.onDateSelect(e,{year:o,month:0,day:1,selectable:!0}):(this.currentYear=o,this.setCurrentView("month"),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}))}updateInputfield(){let e="";if(this.value)if(this.isSingleSelection())e=this.formatDateTime(this.value);else if(this.isMultipleSelection())for(let o=0;o<this.value.length;o++)e+=this.formatDateTime(this.value[o]),o!==this.value.length-1&&(e+=this.multipleSeparator+" ");else if(this.isRangeSelection()&&this.value&&this.value.length){let r=this.value[1];e=this.formatDateTime(this.value[0]),r&&(e+=" "+this.rangeSeparator+" "+this.formatDateTime(r))}this.inputFieldValue=e,this.updateFilledState(),this.inputfieldViewChild&&this.inputfieldViewChild.nativeElement&&(this.inputfieldViewChild.nativeElement.value=this.inputFieldValue)}formatDateTime(e){let o=this.keepInvalid?e:null;return this.isValidDate(e)&&(this.timeOnly?o=this.formatTime(e):(o=this.formatDate(e,this.getDateFormat()),this.showTime&&(o+=" "+this.formatTime(e)))),o}setCurrentHourPM(e){"12"==this.hourFormat?(this.pm=e>11,this.currentHour=e>=12?12==e?12:e-12:0==e?12:e):this.currentHour=e}setCurrentView(e){this.currentView=e,this.cd.detectChanges(),this.alignOverlay()}selectDate(e){let o=new Date(e.year,e.month,e.day);if(this.showTime&&(o.setHours("12"==this.hourFormat?12===this.currentHour?this.pm?12:0:this.pm?this.currentHour+12:this.currentHour:this.currentHour),o.setMinutes(this.currentMinute),o.setSeconds(this.currentSecond)),this.minDate&&this.minDate>o&&(o=this.minDate,this.setCurrentHourPM(o.getHours()),this.currentMinute=o.getMinutes(),this.currentSecond=o.getSeconds()),this.maxDate&&this.maxDate<o&&(o=this.maxDate,this.setCurrentHourPM(o.getHours()),this.currentMinute=o.getMinutes(),this.currentSecond=o.getSeconds()),this.isSingleSelection())this.updateModel(o);else if(this.isMultipleSelection())this.updateModel(this.value?[...this.value,o]:[o]);else if(this.isRangeSelection())if(this.value&&this.value.length){let r=this.value[0],s=this.value[1];!s&&o.getTime()>=r.getTime()?s=o:(r=o,s=null),this.updateModel([r,s])}else this.updateModel([o,null]);this.onSelect.emit(o)}updateModel(e){if(this.value=e,"date"==this.dataType)this.onModelChange(this.value);else if("string"==this.dataType)if(this.isSingleSelection())this.onModelChange(this.formatDateTime(this.value));else{let o=null;this.value&&(o=this.value.map(r=>this.formatDateTime(r))),this.onModelChange(o)}}getFirstDayOfMonthIndex(e,o){let r=new Date;r.setDate(1),r.setMonth(e),r.setFullYear(o);let s=r.getDay()+this.getSundayIndex();return s>=7?s-7:s}getDaysCountInMonth(e,o){return 32-this.daylightSavingAdjust(new Date(o,e,32)).getDate()}getDaysCountInPrevMonth(e,o){let r=this.getPreviousMonthAndYear(e,o);return this.getDaysCountInMonth(r.month,r.year)}getPreviousMonthAndYear(e,o){let r,s;return 0===e?(r=11,s=o-1):(r=e-1,s=o),{month:r,year:s}}getNextMonthAndYear(e,o){let r,s;return 11===e?(r=0,s=o+1):(r=e+1,s=o),{month:r,year:s}}getSundayIndex(){let e=this.getFirstDateOfWeek();return e>0?7-e:0}isSelected(e){if(!this.value)return!1;if(this.isSingleSelection())return this.isDateEquals(this.value,e);if(this.isMultipleSelection()){let o=!1;for(let r of this.value)if(o=this.isDateEquals(r,e),o)break;return o}return this.isRangeSelection()?this.value[1]?this.isDateEquals(this.value[0],e)||this.isDateEquals(this.value[1],e)||this.isDateBetween(this.value[0],this.value[1],e):this.isDateEquals(this.value[0],e):void 0}isComparable(){return null!=this.value&&"string"!=typeof this.value}isMonthSelected(e){if(this.isComparable()&&!this.isMultipleSelection()){const[o,r]=this.isRangeSelection()?this.value:[this.value,this.value],s=new Date(this.currentYear,e,1);return s>=o&&s<=(r??o)}return!1}isMonthDisabled(e){for(let o=1;o<this.getDaysCountInMonth(e,this.currentYear)+1;o++)if(this.isSelectable(o,e,this.currentYear,!1))return!1;return!0}isYearSelected(e){if(this.isComparable()){let o=this.isRangeSelection()?this.value[0]:this.value;return!this.isMultipleSelection()&&o.getFullYear()===e}return!1}isDateEquals(e,o){return!(!e||!_n.isDate(e))&&e.getDate()===o.day&&e.getMonth()===o.month&&e.getFullYear()===o.year}isDateBetween(e,o,r){if(e&&o){let l=new Date(r.year,r.month,r.day);return e.getTime()<=l.getTime()&&o.getTime()>=l.getTime()}return!1}isSingleSelection(){return"single"===this.selectionMode}isRangeSelection(){return"range"===this.selectionMode}isMultipleSelection(){return"multiple"===this.selectionMode}isToday(e,o,r,s){return e.getDate()===o&&e.getMonth()===r&&e.getFullYear()===s}isSelectable(e,o,r,s){let l=!0,h=!0,g=!0,b=!0;return!(s&&!this.selectOtherMonths)&&(this.minDate&&(this.minDate.getFullYear()>r||this.minDate.getFullYear()===r&&(this.minDate.getMonth()>o||this.minDate.getMonth()===o&&this.minDate.getDate()>e))&&(l=!1),this.maxDate&&(this.maxDate.getFullYear()<r||this.maxDate.getFullYear()===r&&(this.maxDate.getMonth()<o||this.maxDate.getMonth()===o&&this.maxDate.getDate()<e))&&(h=!1),this.disabledDates&&(g=!this.isDateDisabled(e,o,r)),this.disabledDays&&(b=!this.isDayDisabled(e,o,r)),l&&h&&g&&b)}isDateDisabled(e,o,r){if(this.disabledDates)for(let s of this.disabledDates)if(s.getFullYear()===r&&s.getMonth()===o&&s.getDate()===e)return!0;return!1}isDayDisabled(e,o,r){if(this.disabledDays){let l=new Date(r,o,e).getDay();return-1!==this.disabledDays.indexOf(l)}return!1}onInputFocus(e){this.focus=!0,this.showOnFocus&&this.showOverlay(),this.onFocus.emit(e)}onInputClick(){this.showOnFocus&&!this.overlayVisible&&this.showOverlay()}onInputBlur(e){this.focus=!1,this.onBlur.emit(e),this.keepInvalid||this.updateInputfield(),this.onModelTouched()}onButtonClick(e,o){this.overlayVisible?this.hideOverlay():(o.focus(),this.showOverlay())}clear(){this.inputFieldValue=null,this.value=null,this.onModelChange(this.value),this.onClear.emit()}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}getMonthName(e){return this.config.getTranslation("monthNames")[e]}getYear(e){return"month"===this.currentView?this.currentYear:e.year}switchViewButtonDisabled(){return this.numberOfMonths>1||this.disabled}onPrevButtonClick(e){this.navigationState={backward:!0,button:!0},this.navBackward(e)}onNextButtonClick(e){this.navigationState={backward:!1,button:!0},this.navForward(e)}onContainerButtonKeydown(e){switch(e.which){case 9:this.inline||this.trapFocus(e);break;case 27:this.overlayVisible=!1,e.preventDefault()}}onInputKeydown(e){this.isKeydown=!0,40===e.keyCode&&this.contentViewChild?this.trapFocus(e):27===e.keyCode||13===e.keyCode?this.overlayVisible&&(this.overlayVisible=!1,e.preventDefault()):9===e.keyCode&&this.contentViewChild&&(Fe.getFocusableElements(this.contentViewChild.nativeElement).forEach(o=>o.tabIndex="-1"),this.overlayVisible&&(this.overlayVisible=!1))}onDateCellKeydown(e,o,r){const s=e.currentTarget,l=s.parentElement;switch(e.which){case 40:{s.tabIndex="-1";let h=Fe.index(l),g=l.parentElement.nextElementSibling;g?Fe.hasClass(g.children[h].children[0],"p-disabled")?(this.navigationState={backward:!1},this.navForward(e)):(g.children[h].children[0].tabIndex="0",g.children[h].children[0].focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 38:{s.tabIndex="-1";let h=Fe.index(l),g=l.parentElement.previousElementSibling;if(g){let b=g.children[h].children[0];Fe.hasClass(b,"p-disabled")?(this.navigationState={backward:!0},this.navBackward(e)):(b.tabIndex="0",b.focus())}else this.navigationState={backward:!0},this.navBackward(e);e.preventDefault();break}case 37:{s.tabIndex="-1";let h=l.previousElementSibling;if(h){let g=h.children[0];Fe.hasClass(g,"p-disabled")||Fe.hasClass(g.parentElement,"p-datepicker-weeknumber")?this.navigateToMonth(!0,r):(g.tabIndex="0",g.focus())}else this.navigateToMonth(!0,r);e.preventDefault();break}case 39:{s.tabIndex="-1";let h=l.nextElementSibling;if(h){let g=h.children[0];Fe.hasClass(g,"p-disabled")?this.navigateToMonth(!1,r):(g.tabIndex="0",g.focus())}else this.navigateToMonth(!1,r);e.preventDefault();break}case 13:case 32:this.onDateSelect(e,o),e.preventDefault();break;case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.inline||this.trapFocus(e)}}onMonthCellKeydown(e,o){const r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var s=r.parentElement.children,l=Fe.index(r);let h=s[40===e.which?l+3:l-3];h&&(h.tabIndex="0",h.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let h=r.previousElementSibling;h?(h.tabIndex="0",h.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let h=r.nextElementSibling;h?(h.tabIndex="0",h.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:this.onMonthSelect(e,o),e.preventDefault();break;case 13:case 32:case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.inline||this.trapFocus(e)}}onYearCellKeydown(e,o){const r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var s=r.parentElement.children,l=Fe.index(r);let h=s[40===e.which?l+2:l-2];h&&(h.tabIndex="0",h.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let h=r.previousElementSibling;h?(h.tabIndex="0",h.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let h=r.nextElementSibling;h?(h.tabIndex="0",h.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:case 32:this.onYearSelect(e,o),e.preventDefault();break;case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.trapFocus(e)}}navigateToMonth(e,o){if(e)if(1===this.numberOfMonths||0===o)this.navigationState={backward:!0},this.navBackward(event);else{let s=Fe.find(this.contentViewChild.nativeElement.children[o-1],".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),l=s[s.length-1];l.tabIndex="0",l.focus()}else if(1===this.numberOfMonths||o===this.numberOfMonths-1)this.navigationState={backward:!1},this.navForward(event);else{let s=Fe.findSingle(this.contentViewChild.nativeElement.children[o+1],".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");s.tabIndex="0",s.focus()}}updateFocus(){let e;if(this.navigationState){if(this.navigationState.button)this.initFocusableCell(),this.navigationState.backward?Fe.findSingle(this.contentViewChild.nativeElement,".p-datepicker-prev").focus():Fe.findSingle(this.contentViewChild.nativeElement,".p-datepicker-next").focus();else{if(this.navigationState.backward){let o;o=Fe.find(this.contentViewChild.nativeElement,"month"===this.currentView?".p-monthpicker .p-monthpicker-month:not(.p-disabled)":"year"===this.currentView?".p-yearpicker .p-yearpicker-year:not(.p-disabled)":".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),o&&o.length>0&&(e=o[o.length-1])}else e=Fe.findSingle(this.contentViewChild.nativeElement,"month"===this.currentView?".p-monthpicker .p-monthpicker-month:not(.p-disabled)":"year"===this.currentView?".p-yearpicker .p-yearpicker-year:not(.p-disabled)":".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");e&&(e.tabIndex="0",e.focus())}this.navigationState=null}else this.initFocusableCell()}initFocusableCell(){const e=this.contentViewChild?.nativeElement;let o;if("month"===this.currentView){let r=Fe.find(e,".p-monthpicker .p-monthpicker-month:not(.p-disabled)"),s=Fe.findSingle(e,".p-monthpicker .p-monthpicker-month.p-highlight");r.forEach(l=>l.tabIndex=-1),o=s||r[0],0===r.length&&Fe.find(e,'.p-monthpicker .p-monthpicker-month.p-disabled[tabindex = "0"]').forEach(h=>h.tabIndex=-1)}else if("year"===this.currentView){let r=Fe.find(e,".p-yearpicker .p-yearpicker-year:not(.p-disabled)"),s=Fe.findSingle(e,".p-yearpicker .p-yearpicker-year.p-highlight");r.forEach(l=>l.tabIndex=-1),o=s||r[0],0===r.length&&Fe.find(e,'.p-yearpicker .p-yearpicker-year.p-disabled[tabindex = "0"]').forEach(h=>h.tabIndex=-1)}else if(o=Fe.findSingle(e,"span.p-highlight"),!o){let r=Fe.findSingle(e,"td.p-datepicker-today span:not(.p-disabled):not(.p-ink)");o=r||Fe.findSingle(e,".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)")}o&&(o.tabIndex="0",!this.preventFocus&&(!this.navigationState||!this.navigationState.button)&&setTimeout(()=>{this.disabled||o.focus()},1),this.preventFocus=!1)}trapFocus(e){let o=Fe.getFocusableElements(this.contentViewChild.nativeElement);if(o&&o.length>0)if(o[0].ownerDocument.activeElement){let r=o.indexOf(o[0].ownerDocument.activeElement);if(e.shiftKey)if(-1==r||0===r)if(this.focusTrap)o[o.length-1].focus();else{if(-1===r)return this.hideOverlay();if(0===r)return}else o[r-1].focus();else if(-1==r||r===o.length-1){if(!this.focusTrap&&-1!=r)return this.hideOverlay();o[0].focus()}else o[r+1].focus()}else o[0].focus();e.preventDefault()}onMonthDropdownChange(e){this.currentMonth=parseInt(e),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}onYearDropdownChange(e){this.currentYear=parseInt(e),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}validateTime(e,o,r,s){let l=this.value;const h=this.convertTo24Hour(e,s);this.isRangeSelection()&&(l=this.value[1]||this.value[0]),this.isMultipleSelection()&&(l=this.value[this.value.length-1]);const g=l?l.toDateString():null;return!(this.minDate&&g&&this.minDate.toDateString()===g&&(this.minDate.getHours()>h||this.minDate.getHours()===h&&(this.minDate.getMinutes()>o||this.minDate.getMinutes()===o&&this.minDate.getSeconds()>r))||this.maxDate&&g&&this.maxDate.toDateString()===g&&(this.maxDate.getHours()<h||this.maxDate.getHours()===h&&(this.maxDate.getMinutes()<o||this.maxDate.getMinutes()===o&&this.maxDate.getSeconds()<r)))}incrementHour(e){let r=this.currentHour+this.stepHour,s=this.pm;"24"==this.hourFormat?r=r>=24?r-24:r:"12"==this.hourFormat&&(this.currentHour<12&&r>11&&(s=!this.pm),r=r>=13?r-12:r),this.validateTime(r,this.currentMinute,this.currentSecond,s)&&(this.currentHour=r,this.pm=s),e.preventDefault()}onTimePickerElementMouseDown(e,o,r){this.disabled||(this.repeat(e,null,o,r),e.preventDefault())}onTimePickerElementMouseUp(e){this.disabled||(this.clearTimePickerTimer(),this.updateTime())}onTimePickerElementMouseLeave(){!this.disabled&&this.timePickerTimer&&(this.clearTimePickerTimer(),this.updateTime())}repeat(e,o,r,s){let l=o||500;switch(this.clearTimePickerTimer(),this.timePickerTimer=setTimeout(()=>{this.repeat(e,100,r,s),this.cd.markForCheck()},l),r){case 0:1===s?this.incrementHour(e):this.decrementHour(e);break;case 1:1===s?this.incrementMinute(e):this.decrementMinute(e);break;case 2:1===s?this.incrementSecond(e):this.decrementSecond(e)}this.updateInputfield()}clearTimePickerTimer(){this.timePickerTimer&&(clearTimeout(this.timePickerTimer),this.timePickerTimer=null)}decrementHour(e){let o=this.currentHour-this.stepHour,r=this.pm;"24"==this.hourFormat?o=o<0?24+o:o:"12"==this.hourFormat&&(12===this.currentHour&&(r=!this.pm),o=o<=0?12+o:o),this.validateTime(o,this.currentMinute,this.currentSecond,r)&&(this.currentHour=o,this.pm=r),e.preventDefault()}incrementMinute(e){let o=this.currentMinute+this.stepMinute;o=o>59?o-60:o,this.validateTime(this.currentHour,o,this.currentSecond,this.pm)&&(this.currentMinute=o),e.preventDefault()}decrementMinute(e){let o=this.currentMinute-this.stepMinute;o=o<0?60+o:o,this.validateTime(this.currentHour,o,this.currentSecond,this.pm)&&(this.currentMinute=o),e.preventDefault()}incrementSecond(e){let o=this.currentSecond+this.stepSecond;o=o>59?o-60:o,this.validateTime(this.currentHour,this.currentMinute,o,this.pm)&&(this.currentSecond=o),e.preventDefault()}decrementSecond(e){let o=this.currentSecond-this.stepSecond;o=o<0?60+o:o,this.validateTime(this.currentHour,this.currentMinute,o,this.pm)&&(this.currentSecond=o),e.preventDefault()}updateTime(){let e=this.value;this.isRangeSelection()&&(e=this.value[1]||this.value[0]),this.isMultipleSelection()&&(e=this.value[this.value.length-1]),e=e?new Date(e.getTime()):new Date,e.setHours("12"==this.hourFormat?12===this.currentHour?this.pm?12:0:this.pm?this.currentHour+12:this.currentHour:this.currentHour),e.setMinutes(this.currentMinute),e.setSeconds(this.currentSecond),this.isRangeSelection()&&(e=this.value[1]?[this.value[0],e]:[e,null]),this.isMultipleSelection()&&(e=[...this.value.slice(0,-1),e]),this.updateModel(e),this.onSelect.emit(e),this.updateInputfield()}toggleAMPM(e){const o=!this.pm;this.validateTime(this.currentHour,this.currentMinute,this.currentSecond,o)&&(this.pm=o,this.updateTime()),e.preventDefault()}onUserInput(e){if(!this.isKeydown)return;this.isKeydown=!1;let o=e.target.value;try{let r=this.parseValueFromString(o);this.isValidSelection(r)&&(this.updateModel(r),this.updateUI())}catch{this.updateModel(this.keepInvalid?o:null)}this.filled=null!=o&&o.length,this.onInput.emit(e)}isValidSelection(e){let o=!0;return this.isSingleSelection()?this.isSelectable(e.getDate(),e.getMonth(),e.getFullYear(),!1)||(o=!1):e.every(r=>this.isSelectable(r.getDate(),r.getMonth(),r.getFullYear(),!1))&&this.isRangeSelection()&&(o=e.length>1&&e[1]>e[0]),o}parseValueFromString(e){if(!e||0===e.trim().length)return null;let o;if(this.isSingleSelection())o=this.parseDateTime(e);else if(this.isMultipleSelection()){let r=e.split(this.multipleSeparator);o=[];for(let s of r)o.push(this.parseDateTime(s.trim()))}else if(this.isRangeSelection()){let r=e.split(" "+this.rangeSeparator+" ");o=[];for(let s=0;s<r.length;s++)o[s]=this.parseDateTime(r[s].trim())}return o}parseDateTime(e){let o,r=e.split(" ");if(this.timeOnly)o=new Date,this.populateTime(o,r[0],r[1]);else{const s=this.getDateFormat();if(this.showTime){let l="12"==this.hourFormat?r.pop():null,h=r.pop();o=this.parseDate(r.join(" "),s),this.populateTime(o,h,l)}else o=this.parseDate(e,s)}return o}populateTime(e,o,r){if("12"==this.hourFormat&&!r)throw"Invalid Time";this.pm="PM"===r||"pm"===r;let s=this.parseTime(o);e.setHours(s.hour),e.setMinutes(s.minute),e.setSeconds(s.second)}isValidDate(e){return _n.isDate(e)&&_n.isNotEmpty(e)}updateUI(){let e=this.value;Array.isArray(e)&&(e=e[0]);let o=this.defaultDate&&this.isValidDate(this.defaultDate)&&!this.value?this.defaultDate:e&&this.isValidDate(e)?e:new Date;this.currentMonth=o.getMonth(),this.currentYear=o.getFullYear(),this.createMonths(this.currentMonth,this.currentYear),(this.showTime||this.timeOnly)&&(this.setCurrentHourPM(o.getHours()),this.currentMinute=o.getMinutes(),this.currentSecond=o.getSeconds())}showOverlay(){this.overlayVisible||(this.updateUI(),this.touchUI||(this.preventFocus=!0),this.overlayVisible=!0)}hideOverlay(){this.overlayVisible=!1,this.clearTimePickerTimer(),this.touchUI&&this.disableModality(),this.cd.markForCheck()}toggle(){this.inline||(this.overlayVisible?this.hideOverlay():(this.showOverlay(),this.inputfieldViewChild.nativeElement.focus()))}onOverlayAnimationStart(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.overlay=e.element,this.overlay.setAttribute(this.attributeSelector,""),this.appendOverlay(),this.updateFocus(),this.autoZIndex&&(this.touchUI?ns.set("modal",this.overlay,this.baseZIndex||this.config.zIndex.modal):ns.set("overlay",this.overlay,this.baseZIndex||this.config.zIndex.overlay)),this.alignOverlay(),this.onShow.emit(e));break;case"void":this.onOverlayHide(),this.onClose.emit(e)}}onOverlayAnimationDone(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener());break;case"void":this.autoZIndex&&ns.clear(e.element)}}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):Fe.appendChild(this.overlay,this.appendTo))}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.el.nativeElement.appendChild(this.overlay)}alignOverlay(){this.touchUI?this.enableModality(this.overlay):this.overlay&&(this.appendTo?("date"===this.view?(this.overlay.style.width=Fe.getOuterWidth(this.overlay)+"px",this.overlay.style.minWidth=Fe.getOuterWidth(this.inputfieldViewChild.nativeElement)+"px"):this.overlay.style.width=Fe.getOuterWidth(this.inputfieldViewChild.nativeElement)+"px",Fe.absolutePosition(this.overlay,this.inputfieldViewChild.nativeElement)):Fe.relativePosition(this.overlay,this.inputfieldViewChild.nativeElement))}enableModality(e){this.mask||this.touchUI||(this.mask=document.createElement("div"),this.mask.style.zIndex=String(parseInt(e.style.zIndex)-1),Fe.addMultipleClasses(this.mask,"p-component-overlay p-datepicker-mask p-datepicker-mask-scrollblocker p-component-overlay p-component-overlay-enter"),this.maskClickListener=this.renderer.listen(this.mask,"click",r=>{this.disableModality()}),document.body.appendChild(this.mask),Fe.addClass(document.body,"p-overflow-hidden"))}disableModality(){this.mask&&(Fe.addClass(this.mask,"p-component-overlay-leave"),this.animationEndListener=this.destroyMask.bind(this),this.mask.addEventListener("animationend",this.animationEndListener))}destroyMask(){if(!this.mask)return;document.body.removeChild(this.mask);let o,e=document.body.children;for(let r=0;r<e.length;r++)if(Fe.hasClass(e[r],"p-datepicker-mask-scrollblocker")){o=!0;break}o||Fe.removeClass(document.body,"p-overflow-hidden"),this.unbindAnimationEndListener(),this.unbindMaskClickListener(),this.mask=null}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.mask.removeEventListener("animationend",this.animationEndListener),this.animationEndListener=null)}writeValue(e){if(this.value=e,this.value&&"string"==typeof this.value)try{this.value=this.parseValueFromString(this.value)}catch{this.keepInvalid&&(this.value=e)}this.updateInputfield(),this.updateUI(),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}getDateFormat(){return this.dateFormat||this.getTranslation("dateFormat")}getFirstDateOfWeek(){return this._firstDayOfWeek||this.getTranslation(Dr.FIRST_DAY_OF_WEEK)}formatDate(e,o){if(!e)return"";let r;const s=T=>{const I=r+1<o.length&&o.charAt(r+1)===T;return I&&r++,I},l=(T,I,R)=>{let z=""+I;if(s(T))for(;z.length<R;)z="0"+z;return z},h=(T,I,R,z)=>s(T)?z[I]:R[I];let g="",b=!1;if(e)for(r=0;r<o.length;r++)if(b)"'"!==o.charAt(r)||s("'")?g+=o.charAt(r):b=!1;else switch(o.charAt(r)){case"d":g+=l("d",e.getDate(),2);break;case"D":g+=h("D",e.getDay(),this.getTranslation(Dr.DAY_NAMES_SHORT),this.getTranslation(Dr.DAY_NAMES));break;case"o":g+=l("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":g+=l("m",e.getMonth()+1,2);break;case"M":g+=h("M",e.getMonth(),this.getTranslation(Dr.MONTH_NAMES_SHORT),this.getTranslation(Dr.MONTH_NAMES));break;case"y":g+=s("y")?e.getFullYear():(e.getFullYear()%100<10?"0":"")+e.getFullYear()%100;break;case"@":g+=e.getTime();break;case"!":g+=1e4*e.getTime()+this.ticksTo1970;break;case"'":s("'")?g+="'":b=!0;break;default:g+=o.charAt(r)}return g}formatTime(e){if(!e)return"";let o="",r=e.getHours(),s=e.getMinutes(),l=e.getSeconds();return"12"==this.hourFormat&&r>11&&12!=r&&(r-=12),o+="12"==this.hourFormat&&0===r?12:r<10?"0"+r:r,o+=":",o+=s<10?"0"+s:s,this.showSeconds&&(o+=":",o+=l<10?"0"+l:l),"12"==this.hourFormat&&(o+=e.getHours()>11?" PM":" AM"),o}parseTime(e){let o=e.split(":");if(o.length!==(this.showSeconds?3:2))throw"Invalid time";let s=parseInt(o[0]),l=parseInt(o[1]),h=this.showSeconds?parseInt(o[2]):null;if(isNaN(s)||isNaN(l)||s>23||l>59||"12"==this.hourFormat&&s>12||this.showSeconds&&(isNaN(h)||h>59))throw"Invalid time";return"12"==this.hourFormat&&(12!==s&&this.pm?s+=12:!this.pm&&12===s&&(s-=12)),{hour:s,minute:l,second:h}}parseDate(e,o){if(null==o||null==e)throw"Invalid arguments";if(""===(e="object"==typeof e?e.toString():e+""))return null;let r,s,l,W,h=0,g="string"!=typeof this.shortYearCutoff?this.shortYearCutoff:(new Date).getFullYear()%100+parseInt(this.shortYearCutoff,10),b=-1,T=-1,I=-1,R=-1,z=!1,X=xe=>{let Be=r+1<o.length&&o.charAt(r+1)===xe;return Be&&r++,Be},ee=xe=>{let Be=X(xe),Ke="@"===xe?14:"!"===xe?20:"y"===xe&&Be?4:"o"===xe?3:2,Vt=new RegExp("^\\d{"+("y"===xe?Ke:1)+","+Ke+"}"),Nt=e.substring(h).match(Vt);if(!Nt)throw"Missing number at position "+h;return h+=Nt[0].length,parseInt(Nt[0],10)},le=(xe,Be,Ke)=>{let ft=-1,Vt=X(xe)?Ke:Be,Nt=[];for(let Ut=0;Ut<Vt.length;Ut++)Nt.push([Ut,Vt[Ut]]);Nt.sort((Ut,Pn)=>-(Ut[1].length-Pn[1].length));for(let Ut=0;Ut<Nt.length;Ut++){let Pn=Nt[Ut][1];if(e.substr(h,Pn.length).toLowerCase()===Pn.toLowerCase()){ft=Nt[Ut][0],h+=Pn.length;break}}if(-1!==ft)return ft+1;throw"Unknown name at position "+h},ve=()=>{if(e.charAt(h)!==o.charAt(r))throw"Unexpected literal at position "+h;h++};for("month"===this.view&&(I=1),r=0;r<o.length;r++)if(z)"'"!==o.charAt(r)||X("'")?ve():z=!1;else switch(o.charAt(r)){case"d":I=ee("d");break;case"D":le("D",this.getTranslation(Dr.DAY_NAMES_SHORT),this.getTranslation(Dr.DAY_NAMES));break;case"o":R=ee("o");break;case"m":T=ee("m");break;case"M":T=le("M",this.getTranslation(Dr.MONTH_NAMES_SHORT),this.getTranslation(Dr.MONTH_NAMES));break;case"y":b=ee("y");break;case"@":W=new Date(ee("@")),b=W.getFullYear(),T=W.getMonth()+1,I=W.getDate();break;case"!":W=new Date((ee("!")-this.ticksTo1970)/1e4),b=W.getFullYear(),T=W.getMonth()+1,I=W.getDate();break;case"'":X("'")?ve():z=!0;break;default:ve()}if(h<e.length&&(l=e.substr(h),!/^\s+/.test(l)))throw"Extra/unparsed characters found in date: "+l;if(-1===b?b=(new Date).getFullYear():b<100&&(b+=(new Date).getFullYear()-(new Date).getFullYear()%100+(b<=g?0:-100)),R>-1)for(T=1,I=R;s=this.getDaysCountInMonth(b,T-1),!(I<=s);)T++,I-=s;if("year"===this.view&&(T=-1===T?1:T,I=-1===I?1:I),W=this.daylightSavingAdjust(new Date(b,T-1,I)),W.getFullYear()!==b||W.getMonth()+1!==T||W.getDate()!==I)throw"Invalid date";return W}daylightSavingAdjust(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null}updateFilledState(){this.filled=this.inputFieldValue&&""!=this.inputFieldValue}onTodayButtonClick(e){let o=new Date,r={day:o.getDate(),month:o.getMonth(),year:o.getFullYear(),otherMonth:o.getMonth()!==this.currentMonth||o.getFullYear()!==this.currentYear,today:!0,selectable:!0};this.onDateSelect(e,r),this.onTodayClick.emit(e)}onClearButtonClick(e){this.updateModel(null),this.updateInputfield(),this.hideOverlay(),this.onClearClick.emit(e)}createResponsiveStyle(){if(this.numberOfMonths>1&&this.responsiveOptions){this.responsiveStyleElement||(this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.body.appendChild(this.responsiveStyleElement));let e="";if(this.responsiveOptions){let o=[...this.responsiveOptions].filter(r=>!(!r.breakpoint||!r.numMonths)).sort((r,s)=>-1*r.breakpoint.localeCompare(s.breakpoint,void 0,{numeric:!0}));for(let r=0;r<o.length;r++){let{breakpoint:s,numMonths:l}=o[r],h=`\n                        .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${l}) .p-datepicker-next {\n                            display: inline-flex !important;\n                        }\n                    `;for(let g=l;g<this.numberOfMonths;g++)h+=`\n                            .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${g+1}) {\n                                display: none !important;\n                            }\n                        `;e+=`\n                        @media screen and (max-width: ${s}) {\n                            ${h}\n                        }\n                    `}}this.responsiveStyleElement.innerHTML=e}}destroyResponsiveStyleElement(){this.responsiveStyleElement&&(this.responsiveStyleElement.remove(),this.responsiveStyleElement=null)}bindDocumentClickListener(){this.documentClickListener||this.zone.runOutsideAngular(()=>{this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","mousedown",o=>{this.isOutsideClicked(o)&&this.overlayVisible&&this.zone.run(()=>{this.hideOverlay(),this.onClickOutside.emit(o),this.cd.markForCheck()})})})}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){!this.documentResizeListener&&!this.touchUI&&(this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener))}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new qb(this.containerViewChild.nativeElement,()=>{this.overlayVisible&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}isOutsideClicked(e){return!(this.el.nativeElement.isSameNode(e.target)||this.isNavIconClicked(e)||this.el.nativeElement.contains(e.target)||this.overlay&&this.overlay.contains(e.target))}isNavIconClicked(e){return Fe.hasClass(e.target,"p-datepicker-prev")||Fe.hasClass(e.target,"p-datepicker-prev-icon")||Fe.hasClass(e.target,"p-datepicker-next")||Fe.hasClass(e.target,"p-datepicker-next-icon")}onWindowResize(){this.overlayVisible&&!Fe.isTouchDevice()&&this.hideOverlay()}onOverlayHide(){this.currentView=this.view,this.mask&&this.destroyMask(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.overlay=null}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.overlay&&this.autoZIndex&&ns.clear(this.overlay),this.destroyResponsiveStyleElement(),this.clearTimePickerTimer(),this.restoreOverlayAppend(),this.onOverlayHide()}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(jr),be(Po),be(fi),be(Il),be(Wb))},t.\u0275cmp=on({type:t,selectors:[["p-calendar"]],contentQueries:function(e,o,r){if(1&e&&No(r,_o,4),2&e){let s;mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(pW,5),pi(fW,5),pi(mW,5)),2&e){let r;mn(r=gn())&&(o.containerViewChild=r.first),mn(r=gn())&&(o.inputfieldViewChild=r.first),mn(r=gn())&&(o.content=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,o){2&e&&Mo("p-inputwrapper-filled",o.filled)("p-inputwrapper-focus",o.focus)("p-calendar-clearable",o.showClear&&!o.disabled)},inputs:{style:"style",styleClass:"styleClass",inputStyle:"inputStyle",inputId:"inputId",name:"name",inputStyleClass:"inputStyleClass",placeholder:"placeholder",ariaLabelledBy:"ariaLabelledBy",iconAriaLabel:"iconAriaLabel",disabled:"disabled",dateFormat:"dateFormat",multipleSeparator:"multipleSeparator",rangeSeparator:"rangeSeparator",inline:"inline",showOtherMonths:"showOtherMonths",selectOtherMonths:"selectOtherMonths",showIcon:"showIcon",icon:"icon",appendTo:"appendTo",readonlyInput:"readonlyInput",shortYearCutoff:"shortYearCutoff",monthNavigator:"monthNavigator",yearNavigator:"yearNavigator",hourFormat:"hourFormat",timeOnly:"timeOnly",stepHour:"stepHour",stepMinute:"stepMinute",stepSecond:"stepSecond",showSeconds:"showSeconds",required:"required",showOnFocus:"showOnFocus",showWeek:"showWeek",showClear:"showClear",dataType:"dataType",selectionMode:"selectionMode",maxDateCount:"maxDateCount",showButtonBar:"showButtonBar",todayButtonStyleClass:"todayButtonStyleClass",clearButtonStyleClass:"clearButtonStyleClass",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",panelStyleClass:"panelStyleClass",panelStyle:"panelStyle",keepInvalid:"keepInvalid",hideOnDateTimeSelect:"hideOnDateTimeSelect",touchUI:"touchUI",timeSeparator:"timeSeparator",focusTrap:"focusTrap",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",tabindex:"tabindex",view:"view",defaultDate:"defaultDate",minDate:"minDate",maxDate:"maxDate",disabledDates:"disabledDates",disabledDays:"disabledDays",yearRange:"yearRange",showTime:"showTime",responsiveOptions:"responsiveOptions",numberOfMonths:"numberOfMonths",firstDayOfWeek:"firstDayOfWeek",locale:"locale"},outputs:{onFocus:"onFocus",onBlur:"onBlur",onClose:"onClose",onSelect:"onSelect",onClear:"onClear",onInput:"onInput",onTodayClick:"onTodayClick",onClearClick:"onClearClick",onMonthChange:"onMonthChange",onYearChange:"onYearChange",onClickOutside:"onClickOutside",onShow:"onShow"},features:[Wi([rq])],ngContentSelectors:oq,decls:4,vars:11,consts:[[3,"ngClass","ngStyle"],["container",""],[3,"ngIf"],[3,"class","ngStyle","ngClass","click",4,"ngIf"],["type","text","autocomplete","off",3,"value","readonly","ngStyle","placeholder","disabled","ngClass","focus","keydown","click","blur","input"],["inputfield",""],["class","p-calendar-clear-icon pi pi-times",3,"click",4,"ngIf"],["type","button","pButton","","pRipple","","class","p-datepicker-trigger","tabindex","0",3,"icon","disabled","click",4,"ngIf"],[1,"p-calendar-clear-icon","pi","pi-times",3,"click"],["type","button","pButton","","pRipple","","tabindex","0",1,"p-datepicker-trigger",3,"icon","disabled","click"],[3,"ngStyle","ngClass","click"],["contentWrapper",""],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-timepicker",4,"ngIf"],["class","p-datepicker-buttonbar",4,"ngIf"],[1,"p-datepicker-group-container"],["class","p-datepicker-group",4,"ngFor","ngForOf"],["class","p-monthpicker",4,"ngIf"],["class","p-yearpicker",4,"ngIf"],[1,"p-datepicker-group"],[1,"p-datepicker-header"],["class","p-datepicker-prev p-link","type","button","pRipple","",3,"keydown","click",4,"ngIf"],[1,"p-datepicker-title"],["type","button","class","p-datepicker-month p-link",3,"disabled","click","keydown",4,"ngIf"],["type","button","class","p-datepicker-year p-link",3,"disabled","click","keydown",4,"ngIf"],["class","p-datepicker-decade",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-next","p-link",3,"keydown","click"],[1,"p-datepicker-next-icon","pi","pi-chevron-right"],["class","p-datepicker-calendar-container",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-prev","p-link",3,"keydown","click"],[1,"p-datepicker-prev-icon","pi","pi-chevron-left"],["type","button",1,"p-datepicker-month","p-link",3,"disabled","click","keydown"],["type","button",1,"p-datepicker-year","p-link",3,"disabled","click","keydown"],[1,"p-datepicker-decade"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-datepicker-calendar-container"],[1,"p-datepicker-calendar"],["class","p-datepicker-weekheader p-disabled",4,"ngIf"],["scope","col",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p-datepicker-weekheader","p-disabled"],["scope","col"],["class","p-datepicker-weeknumber",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"p-datepicker-weeknumber"],[1,"p-disabled"],[3,"ngClass"],["draggable","false","pRipple","",3,"ngClass","click","keydown"],[1,"p-monthpicker"],["class","p-monthpicker-month","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-monthpicker-month",3,"ngClass","click","keydown"],[1,"p-yearpicker"],["class","p-yearpicker-year","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-yearpicker-year",3,"ngClass","click","keydown"],[1,"p-timepicker"],[1,"p-hour-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","keydown.enter","keydown.space","mousedown","mouseup","keyup.enter","keyup.space","mouseleave"],[1,"pi","pi-chevron-up"],[1,"pi","pi-chevron-down"],[1,"p-separator"],[1,"p-minute-picker"],["class","p-separator",4,"ngIf"],["class","p-second-picker",4,"ngIf"],["class","p-ampm-picker",4,"ngIf"],[1,"p-second-picker"],[1,"p-ampm-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","click","keydown.enter"],[1,"p-datepicker-buttonbar"],["type","button","pButton","","pRipple","",3,"label","ngClass","keydown","click"]],template:function(e,o){1&e&&(or(nq),F(0,"span",0,1),J(2,yW,4,17,"ng-template",2),J(3,tq,9,28,"div",3),V()),2&e&&(Xn(o.styleClass),B("ngClass",Th(6,iq,o.showIcon,o.timeOnly,o.disabled,o.focus))("ngStyle",o.style),j(2),B("ngIf",!o.inline),j(1),B("ngIf",o.inline||o.overlayVisible))},dependencies:[Eo,Ms,mi,Is,Oo,os,vd],styles:[".p-calendar{position:relative;display:inline-flex;max-width:100%}.p-calendar .p-inputtext{flex:1 1 auto;width:1%}.p-calendar-w-btn .p-inputtext{border-top-right-radius:0;border-bottom-right-radius:0}.p-calendar-w-btn .p-datepicker-trigger{border-top-left-radius:0;border-bottom-left-radius:0}.p-fluid .p-calendar{display:flex}.p-fluid .p-calendar .p-inputtext{width:1%}.p-calendar .p-datepicker{min-width:100%}.p-datepicker{width:auto;position:absolute;top:0;left:0}.p-datepicker-inline{display:inline-block;position:static;overflow-x:auto}.p-datepicker-header{display:flex;align-items:center;justify-content:space-between}.p-datepicker-header .p-datepicker-title{margin:0 auto}.p-datepicker-prev,.p-datepicker-next{cursor:pointer;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;position:relative}.p-datepicker-multiple-month .p-datepicker-group-container .p-datepicker-group{flex:1 1 auto}.p-datepicker-multiple-month .p-datepicker-group-container{display:flex}.p-datepicker table{width:100%;border-collapse:collapse}.p-datepicker td>span{display:flex;justify-content:center;align-items:center;cursor:pointer;margin:0 auto;overflow:hidden;position:relative}.p-monthpicker-month{width:33.3%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-datepicker-buttonbar{display:flex;justify-content:space-between;align-items:center}.p-timepicker{display:flex;justify-content:center;align-items:center}.p-timepicker button{display:flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-timepicker>div{display:flex;align-items:center;flex-direction:column}.p-datepicker-touch-ui,.p-calendar .p-datepicker-touch-ui{position:fixed;top:50%;left:50%;min-width:80vw;transform:translate(-50%,-50%)}.p-yearpicker-year{width:50%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-calendar-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-calendar-clearable{position:relative}\n"],encapsulation:2,data:{animation:[cc("overlayAnimation",[zS("visibleTouchUI",go({transform:"translate(-50%,-50%)",opacity:1})),rr("void => visible",[go({opacity:0,transform:"scaleY(0.8)"}),Ho("{{showTransitionParams}}",go({opacity:1,transform:"*"}))]),rr("visible => void",[Ho("{{hideTransitionParams}}",go({opacity:0}))]),rr("void => visibleTouchUI",[go({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}),Ho("{{showTransitionParams}}")]),rr("visibleTouchUI => void",[Ho("{{hideTransitionParams}}",go({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}))])])]},changeDetection:0}),t})(),aq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,pu,is,il,pu,is]}),t})(),lq=(()=>{class t{constructor(e){this.host=e,this.focused=!1}ngAfterViewChecked(){if(!this.focused&&this.autofocus){const e=Fe.getFocusableElements(this.host.nativeElement);0===e.length&&this.host.nativeElement.focus(),e.length>0&&e[0].focus(),this.focused=!0}}}return t.\u0275fac=function(e){return new(e||t)(be(si))},t.\u0275dir=kn({type:t,selectors:[["","pAutoFocus",""]],hostAttrs:[1,"p-element"],inputs:{autofocus:"autofocus"}}),t})(),cq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();const uq=["overlay"],dq=["content"];function hq(t,n){1&t&&Ht(0)}const pq=function(t,n,e){return{showTransitionParams:t,hideTransitionParams:n,transform:e}},fq=function(t){return{value:"visible",params:t}},mq=function(t){return{mode:t}},gq=function(t){return{$implicit:t}};function _q(t,n){if(1&t){const e=xt();F(0,"div",1,3),Oe("click",function(r){return Ie(e),Me(q(2).onOverlayContentClick(r))})("@overlayContentAnimation.start",function(r){return Ie(e),Me(q(2).onOverlayContentAnimationStart(r))})("@overlayContentAnimation.done",function(r){return Ie(e),Me(q(2).onOverlayContentAnimationDone(r))}),Qi(2),J(3,hq,1,0,"ng-container",4),V()}if(2&t){const e=q(2);Xn(e.contentStyleClass),B("ngStyle",e.contentStyle)("ngClass","p-overlay-content")("@overlayContentAnimation",An(11,fq,$r(7,pq,e.showTransitionOptions,e.hideTransitionOptions,e.transformOptions[e.modal?e.overlayResponsiveDirection:"default"]))),j(3),B("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",An(15,gq,An(13,mq,e.overlayMode)))}}const yq=function(t,n,e,o,r,s,l,h,g,b,T,I,R,z){return{"p-overlay p-component":!0,"p-overlay-modal p-component-overlay p-component-overlay-enter":t,"p-overlay-center":n,"p-overlay-top":e,"p-overlay-top-start":o,"p-overlay-top-end":r,"p-overlay-bottom":s,"p-overlay-bottom-start":l,"p-overlay-bottom-end":h,"p-overlay-left":g,"p-overlay-left-start":b,"p-overlay-left-end":T,"p-overlay-right":I,"p-overlay-right-start":R,"p-overlay-right-end":z}};function vq(t,n){if(1&t){const e=xt();F(0,"div",1,2),Oe("click",function(r){return Ie(e),Me(q().onOverlayClick(r))}),J(2,_q,4,17,"div",0),V()}if(2&t){const e=q();Xn(e.styleClass),B("ngStyle",e.style)("ngClass",rE(5,yq,[e.modal,e.modal&&"center"===e.overlayResponsiveDirection,e.modal&&"top"===e.overlayResponsiveDirection,e.modal&&"top-start"===e.overlayResponsiveDirection,e.modal&&"top-end"===e.overlayResponsiveDirection,e.modal&&"bottom"===e.overlayResponsiveDirection,e.modal&&"bottom-start"===e.overlayResponsiveDirection,e.modal&&"bottom-end"===e.overlayResponsiveDirection,e.modal&&"left"===e.overlayResponsiveDirection,e.modal&&"left-start"===e.overlayResponsiveDirection,e.modal&&"left-end"===e.overlayResponsiveDirection,e.modal&&"right"===e.overlayResponsiveDirection,e.modal&&"right-start"===e.overlayResponsiveDirection,e.modal&&"right-end"===e.overlayResponsiveDirection])),j(2),B("ngIf",e.visible)}}const bq=["*"],xq={provide:ks,useExisting:xi(()=>qL),multi:!0},wq=af([go({transform:"{{transform}}",opacity:0}),Ho("{{showTransitionParams}}")]),Cq=af([Ho("{{hideTransitionParams}}",go({transform:"{{transform}}",opacity:0}))]);let qL=(()=>{class t{constructor(e,o,r,s,l,h){this.document=e,this.el=o,this.renderer=r,this.config=s,this.overlayService=l,this.zone=h,this.visibleChange=new Tt,this.onBeforeShow=new Tt,this.onShow=new Tt,this.onBeforeHide=new Tt,this.onHide=new Tt,this.onAnimationStart=new Tt,this.onAnimationDone=new Tt,this._visible=!1,this.modalVisible=!1,this.isOverlayClicked=!1,this.isOverlayContentClicked=!1,this.transformOptions={default:"scaleY(0.8)",center:"scale(0.7)",top:"translate3d(0px, -100%, 0px)","top-start":"translate3d(0px, -100%, 0px)","top-end":"translate3d(0px, -100%, 0px)",bottom:"translate3d(0px, 100%, 0px)","bottom-start":"translate3d(0px, 100%, 0px)","bottom-end":"translate3d(0px, 100%, 0px)",left:"translate3d(-100%, 0px, 0px)","left-start":"translate3d(-100%, 0px, 0px)","left-end":"translate3d(-100%, 0px, 0px)",right:"translate3d(100%, 0px, 0px)","right-start":"translate3d(100%, 0px, 0px)","right-end":"translate3d(100%, 0px, 0px)"},this.window=this.document.defaultView}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.modalVisible&&(this.modalVisible=!0)}get mode(){return this._mode||this.overlayOptions?.mode}set mode(e){this._mode=e}get style(){return _n.merge(this._style,this.modal?this.overlayResponsiveOptions?.style:this.overlayOptions?.style)}set style(e){this._style=e}get styleClass(){return _n.merge(this._styleClass,this.modal?this.overlayResponsiveOptions?.styleClass:this.overlayOptions?.styleClass)}set styleClass(e){this._styleClass=e}get contentStyle(){return _n.merge(this._contentStyle,this.modal?this.overlayResponsiveOptions?.contentStyle:this.overlayOptions?.contentStyle)}set contentStyle(e){this._contentStyle=e}get contentStyleClass(){return _n.merge(this._contentStyleClass,this.modal?this.overlayResponsiveOptions?.contentStyleClass:this.overlayOptions?.contentStyleClass)}set contentStyleClass(e){this._contentStyleClass=e}get target(){const e=this._target||this.overlayOptions?.target;return void 0===e?"@prev":e}set target(e){this._target=e}get appendTo(){return this._appendTo||this.overlayOptions?.appendTo}set appendTo(e){this._appendTo=e}get autoZIndex(){const e=this._autoZIndex||this.overlayOptions?.autoZIndex;return void 0===e||e}set autoZIndex(e){this._autoZIndex=e}get baseZIndex(){const e=this._baseZIndex||this.overlayOptions?.baseZIndex;return void 0===e?0:e}set baseZIndex(e){this._baseZIndex=e}get showTransitionOptions(){const e=this._showTransitionOptions||this.overlayOptions?.showTransitionOptions;return void 0===e?".12s cubic-bezier(0, 0, 0.2, 1)":e}set showTransitionOptions(e){this._showTransitionOptions=e}get hideTransitionOptions(){const e=this._hideTransitionOptions||this.overlayOptions?.hideTransitionOptions;return void 0===e?".1s linear":e}set hideTransitionOptions(e){this._hideTransitionOptions=e}get listener(){return this._listener||this.overlayOptions?.listener}set listener(e){this._listener=e}get responsive(){return this._responsive||this.overlayOptions?.responsive}set responsive(e){this._responsive=e}get options(){return this._options}set options(e){this._options=e}get modal(){return"modal"===this.mode||this.overlayResponsiveOptions&&this.window?.matchMedia(this.overlayResponsiveOptions.media?.replace("@media","")||`(max-width: ${this.overlayResponsiveOptions.breakpoint})`).matches}get overlayMode(){return this.mode||(this.modal?"modal":"overlay")}get overlayOptions(){return{...this.config?.overlayOptions,...this.options}}get overlayResponsiveOptions(){return{...this.overlayOptions?.responsive,...this.responsive}}get overlayResponsiveDirection(){return this.overlayResponsiveOptions?.direction||"center"}get overlayEl(){return this.overlayViewChild?.nativeElement}get contentEl(){return this.contentViewChild?.nativeElement}get targetEl(){return Fe.getTargetElement(this.target,this.el?.nativeElement)}ngAfterContentInit(){this.templates?.forEach(e=>{e.getType(),this.contentTemplate=e.template})}show(e,o=!1){this.onVisibleChange(!0),this.handleEvents("onShow",{overlay:e||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),o&&Fe.focus(this.targetEl),this.modal&&Fe.addClass(this.document?.body,"p-overflow-hidden")}hide(e,o=!1){this.visible&&(this.onVisibleChange(!1),this.handleEvents("onHide",{overlay:e||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),o&&Fe.focus(this.targetEl),this.modal&&Fe.removeClass(this.document?.body,"p-overflow-hidden"))}alignOverlay(){!this.modal&&Fe.alignOverlay(this.overlayEl,this.targetEl,this.appendTo)}onVisibleChange(e){this._visible=e,this.visibleChange.emit(e)}onOverlayClick(e){this.isOverlayClicked=!0}onOverlayContentClick(e){this.overlayService.add({originalEvent:e,target:this.targetEl}),this.isOverlayContentClicked=!0}onOverlayContentAnimationStart(e){switch(e.toState){case"visible":this.handleEvents("onBeforeShow",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.autoZIndex&&ns.set(this.overlayMode,this.overlayEl,this.baseZIndex+this.config?.zIndex[this.overlayMode]),Fe.appendOverlay(this.overlayEl,"body"===this.appendTo?this.document.body:this.appendTo,this.appendTo),this.alignOverlay();break;case"void":this.handleEvents("onBeforeHide",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.modal&&Fe.addClass(this.overlayEl,"p-component-overlay-leave")}this.handleEvents("onAnimationStart",e)}onOverlayContentAnimationDone(e){const o=this.overlayEl||e.element.parentElement;switch(e.toState){case"visible":this.show(o,!0),this.bindListeners();break;case"void":this.hide(o,!0),this.unbindListeners(),Fe.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),ns.clear(o),this.modalVisible=!1}this.handleEvents("onAnimationDone",e)}handleEvents(e,o){this[e].emit(o),this.options&&this.options[e]&&this.options[e](o),this.config?.overlayOptions&&this.config?.overlayOptions[e]&&this.config?.overlayOptions[e](o)}bindListeners(){this.bindScrollListener(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindDocumentKeyboardListener()}unbindListeners(){this.unbindScrollListener(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindDocumentKeyboardListener()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new qb(this.targetEl,e=>{(!this.listener||this.listener(e,{type:"scroll",mode:this.overlayMode,valid:!0}))&&this.hide(e,!0)})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.document,"click",e=>{const r=!(this.targetEl&&(this.targetEl.isSameNode(e.target)||!this.isOverlayClicked&&this.targetEl.contains(e.target))||this.isOverlayContentClicked);(this.listener?this.listener(e,{type:"outside",mode:this.overlayMode,valid:3!==e.which&&r}):r)&&this.hide(e),this.isOverlayClicked=this.isOverlayContentClicked=!1}))}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener||(this.documentResizeListener=this.renderer.listen(this.window,"resize",e=>{(this.listener?this.listener(e,{type:"resize",mode:this.overlayMode,valid:!Fe.isTouchDevice()}):!Fe.isTouchDevice())&&this.hide(e,!0)}))}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}bindDocumentKeyboardListener(){this.documentKeyboardListener||this.zone.runOutsideAngular(()=>{this.documentKeyboardListener=this.renderer.listen(this.window,"keydown",e=>{this.overlayOptions.hideOnEscape&&27===e.keyCode&&(this.listener?this.listener(e,{type:"keydown",mode:this.overlayMode,valid:!Fe.isTouchDevice()}):!Fe.isTouchDevice())&&this.zone.run(()=>{this.hide(e,!0)})})})}unbindDocumentKeyboardListener(){this.documentKeyboardListener&&(this.documentKeyboardListener(),this.documentKeyboardListener=null)}ngOnDestroy(){this.hide(this.overlayEl,!0),this.overlayEl&&(Fe.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),ns.clear(this.overlayEl)),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindListeners()}}return t.\u0275fac=function(e){return new(e||t)(be(lo),be(si),be(jr),be(Il),be(Wb),be(fi))},t.\u0275cmp=on({type:t,selectors:[["p-overlay"]],contentQueries:function(e,o,r){if(1&e&&No(r,_o,4),2&e){let s;mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(uq,5),pi(dq,5)),2&e){let r;mn(r=gn())&&(o.overlayViewChild=r.first),mn(r=gn())&&(o.contentViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{visible:"visible",mode:"mode",style:"style",styleClass:"styleClass",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",target:"target",appendTo:"appendTo",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",listener:"listener",responsive:"responsive",options:"options"},outputs:{visibleChange:"visibleChange",onBeforeShow:"onBeforeShow",onShow:"onShow",onBeforeHide:"onBeforeHide",onHide:"onHide",onAnimationStart:"onAnimationStart",onAnimationDone:"onAnimationDone"},features:[Wi([xq])],ngContentSelectors:bq,decls:1,vars:1,consts:[[3,"ngStyle","class","ngClass","click",4,"ngIf"],[3,"ngStyle","ngClass","click"],["overlay",""],["content",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){1&e&&(or(),J(0,vq,3,20,"div",0)),2&e&&B("ngIf",o.modalVisible)},dependencies:[Eo,mi,Is,Oo],styles:[".p-overlay{position:absolute;top:0;left:0}.p-overlay-modal{display:flex;align-items:center;justify-content:center;position:fixed;top:0;left:0;width:100%;height:100%}.p-overlay-content{transform-origin:inherit}.p-overlay-modal>.p-overlay-content{z-index:1;width:90%}.p-overlay-top{align-items:flex-start}.p-overlay-top-start{align-items:flex-start;justify-content:flex-start}.p-overlay-top-end{align-items:flex-start;justify-content:flex-end}.p-overlay-bottom{align-items:flex-end}.p-overlay-bottom-start{align-items:flex-end;justify-content:flex-start}.p-overlay-bottom-end{align-items:flex-end;justify-content:flex-end}.p-overlay-left{justify-content:flex-start}.p-overlay-left-start{justify-content:flex-start;align-items:flex-start}.p-overlay-left-end{justify-content:flex-start;align-items:flex-end}.p-overlay-right{justify-content:flex-end}.p-overlay-right-start{justify-content:flex-end;align-items:flex-start}.p-overlay-right-end{justify-content:flex-end;align-items:flex-end}\n"],encapsulation:2,data:{animation:[cc("overlayContentAnimation",[rr(":enter",[Q_(wq)]),rr(":leave",[Q_(Cq)])])]},changeDetection:0}),t})(),ZL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,is,is]}),t})();const Tq=["element"],Eq=["content"];function Sq(t,n){1&t&&Ht(0)}const qD=function(t,n){return{$implicit:t,options:n}};function Dq(t,n){if(1&t&&(xn(0),J(1,Sq,1,0,"ng-container",7),In()),2&t){const e=q(2);j(1),B("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",no(2,qD,e.loadedItems,e.getContentOptions()))}}function Mq(t,n){1&t&&Ht(0)}function Iq(t,n){if(1&t&&(xn(0),J(1,Mq,1,0,"ng-container",7),In()),2&t){const e=n.$implicit,o=n.index,r=q(3);j(1),B("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",no(2,qD,e,r.getOptions(o)))}}const kq=function(t){return{"p-scroller-loading":t}};function Aq(t,n){if(1&t&&(F(0,"div",8,9),J(2,Iq,2,5,"ng-container",10),V()),2&t){const e=q(2);B("ngClass",An(4,kq,e.d_loading))("ngStyle",e.contentStyle),j(2),B("ngForOf",e.loadedItems)("ngForTrackBy",e._trackBy||e.index)}}function Pq(t,n){1&t&&Ne(0,"div",11),2&t&&B("ngStyle",q(2).spacerStyle)}function Oq(t,n){1&t&&Ht(0)}const Rq=function(t){return{numCols:t}},KL=function(t){return{options:t}};function Lq(t,n){if(1&t&&(xn(0),J(1,Oq,1,0,"ng-container",7),In()),2&t){const e=n.index,o=q(4);j(1),B("ngTemplateOutlet",o.loaderTemplate)("ngTemplateOutletContext",An(4,KL,o.getLoaderOptions(e,o.both&&An(2,Rq,o._numItemsInViewport.cols))))}}function Fq(t,n){if(1&t&&(xn(0),J(1,Lq,2,6,"ng-container",14),In()),2&t){const e=q(3);j(1),B("ngForOf",e.loaderArr)}}function zq(t,n){1&t&&Ht(0)}const Nq=function(){return{styleClass:"p-scroller-loading-icon"}};function Bq(t,n){if(1&t&&(xn(0),J(1,zq,1,0,"ng-container",7),In()),2&t){const e=q(4);j(1),B("ngTemplateOutlet",e.loaderIconTemplate)("ngTemplateOutletContext",An(3,KL,ai(2,Nq)))}}function Vq(t,n){1&t&&Ne(0,"i",16)}function Uq(t,n){if(1&t&&(J(0,Bq,2,5,"ng-container",0),J(1,Vq,1,0,"ng-template",null,15,ka)),2&t){const e=jn(2);B("ngIf",q(3).loaderIconTemplate)("ngIfElse",e)}}const jq=function(t){return{"p-component-overlay":t}};function Hq(t,n){if(1&t&&(F(0,"div",12),J(1,Fq,2,1,"ng-container",0),J(2,Uq,3,2,"ng-template",null,13,ka),V()),2&t){const e=jn(3),o=q(2);B("ngClass",An(3,jq,!o.loaderTemplate)),j(1),B("ngIf",o.loaderTemplate)("ngIfElse",e)}}const $q=function(t,n,e){return{"p-scroller":!0,"p-scroller-inline":t,"p-both-scroll":n,"p-horizontal-scroll":e}};function Gq(t,n){if(1&t){const e=xt();xn(0),F(1,"div",2,3),Oe("scroll",function(r){return Ie(e),Me(q().onContainerScroll(r))}),J(3,Dq,2,5,"ng-container",0),J(4,Aq,3,6,"ng-template",null,4,ka),J(6,Pq,1,1,"div",5),J(7,Hq,4,5,"div",6),V(),In()}if(2&t){const e=jn(5),o=q();j(1),Xn(o._styleClass),B("ngStyle",o._style)("ngClass",$r(10,$q,o.inline,o.both,o.horizontal)),st("id",o._id)("tabindex",o.tabindex),j(2),B("ngIf",o.contentTemplate)("ngIfElse",e),j(3),B("ngIf",o._showSpacer),j(1),B("ngIf",!o.loaderDisabled&&o._showLoader&&o.d_loading)}}function Wq(t,n){1&t&&Ht(0)}const qq=function(t,n){return{rows:t,columns:n}};function Zq(t,n){if(1&t&&(xn(0),J(1,Wq,1,0,"ng-container",7),In()),2&t){const e=q(2);j(1),B("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",no(5,qD,e.items,no(2,qq,e._items,e.loadedColumns)))}}function Kq(t,n){if(1&t&&(Qi(0),J(1,Zq,2,8,"ng-container",17)),2&t){const e=q();j(1),B("ngIf",e.contentTemplate)}}const Xq=["*"];let XL=(()=>{class t{constructor(e,o){this.cd=e,this.zone=o,this.onLazyLoad=new Tt,this.onScroll=new Tt,this.onScrollIndexChange=new Tt,this._tabindex=0,this._itemSize=0,this._orientation="vertical",this._step=0,this._delay=0,this._resizeDelay=10,this._appendOnly=!1,this._inline=!1,this._lazy=!1,this._disabled=!1,this._loaderDisabled=!1,this._showSpacer=!0,this._showLoader=!1,this._autoSize=!1,this.d_loading=!1,this.first=0,this.last=0,this.page=0,this.isRangeChanged=!1,this.numItemsInViewport=0,this.lastScrollPos=0,this.lazyLoadState={},this.loaderArr=[],this.spacerStyle={},this.contentStyle={},this.initialized=!1}get id(){return this._id}set id(e){this._id=e}get style(){return this._style}set style(e){this._style=e}get styleClass(){return this._styleClass}set styleClass(e){this._styleClass=e}get tabindex(){return this._tabindex}set tabindex(e){this._tabindex=e}get items(){return this._items}set items(e){this._items=e}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e}get scrollHeight(){return this._scrollHeight}set scrollHeight(e){this._scrollHeight=e}get scrollWidth(){return this._scrollWidth}set scrollWidth(e){this._scrollWidth=e}get orientation(){return this._orientation}set orientation(e){this._orientation=e}get step(){return this._step}set step(e){this._step=e}get delay(){return this._delay}set delay(e){this._delay=e}get resizeDelay(){return this._resizeDelay}set resizeDelay(e){this._resizeDelay=e}get appendOnly(){return this._appendOnly}set appendOnly(e){this._appendOnly=e}get inline(){return this._inline}set inline(e){this._inline=e}get lazy(){return this._lazy}set lazy(e){this._lazy=e}get disabled(){return this._disabled}set disabled(e){this._disabled=e}get loaderDisabled(){return this._loaderDisabled}set loaderDisabled(e){this._loaderDisabled=e}get columns(){return this._columns}set columns(e){this._columns=e}get showSpacer(){return this._showSpacer}set showSpacer(e){this._showSpacer=e}get showLoader(){return this._showLoader}set showLoader(e){this._showLoader=e}get numToleratedItems(){return this._numToleratedItems}set numToleratedItems(e){this._numToleratedItems=e}get loading(){return this._loading}set loading(e){this._loading=e}get autoSize(){return this._autoSize}set autoSize(e){this._autoSize=e}get trackBy(){return this._trackBy}set trackBy(e){this._trackBy=e}get options(){return this._options}set options(e){this._options=e,e&&"object"==typeof e&&Object.entries(e).forEach(([o,r])=>this[`_${o}`]!==r&&(this[`_${o}`]=r))}get vertical(){return"vertical"===this._orientation}get horizontal(){return"horizontal"===this._orientation}get both(){return"both"===this._orientation}get loadedItems(){return this._items&&!this.d_loading?this.both?this._items.slice(this._appendOnly?0:this.first.rows,this.last.rows).map(e=>this._columns?e:e.slice(this._appendOnly?0:this.first.cols,this.last.cols)):this.horizontal&&this._columns?this._items:this._items.slice(this._appendOnly?0:this.first,this.last):[]}get loadedRows(){return this.d_loading?this._loaderDisabled?this.loaderArr:[]:this.loadedItems}get loadedColumns(){return this._columns&&(this.both||this.horizontal)?this.d_loading&&this._loaderDisabled?this.both?this.loaderArr[0]:this.loaderArr:this._columns.slice(this.both?this.first.cols:this.first,this.both?this.last.cols:this.last):this._columns}get isPageChanged(){return!this._step||this.page!==this.getPageByFirst()}ngOnInit(){this.setInitialState()}ngOnChanges(e){let o=!1;if(e.loading){const{previousValue:r,currentValue:s}=e.loading;this.lazy&&r!==s&&s!==this.d_loading&&(this.d_loading=s,o=!0)}if(e.orientation&&(this.lastScrollPos=this.both?{top:0,left:0}:0),e.numToleratedItems){const{previousValue:r,currentValue:s}=e.numToleratedItems;r!==s&&s!==this.d_numToleratedItems&&(this.d_numToleratedItems=s)}if(e.options){const{previousValue:r,currentValue:s}=e.options;this.lazy&&r?.loading!==s?.loading&&s?.loading!==this.d_loading&&(this.d_loading=s.loading,o=!0),r?.numToleratedItems!==s?.numToleratedItems&&s?.numToleratedItems!==this.d_numToleratedItems&&(this.d_numToleratedItems=s.numToleratedItems)}this.initialized&&!o&&(e.items?.previousValue?.length!==e.items?.currentValue?.length||e.itemSize||e.scrollHeight||e.scrollWidth)&&(this.init(),this.calculateAutoSize())}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;case"item":default:this.itemTemplate=e.template;break;case"loader":this.loaderTemplate=e.template;break;case"loadericon":this.loaderIconTemplate=e.template}})}ngAfterViewInit(){Promise.resolve().then(()=>{this.viewInit()})}ngAfterViewChecked(){this.initialized||this.viewInit()}ngOnDestroy(){this.unbindResizeListener(),this.contentEl=null,this.initialized=!1}viewInit(){Fe.isVisible(this.elementViewChild?.nativeElement)&&(this.setInitialState(),this.setContentEl(this.contentEl),this.init(),this.defaultWidth=Fe.getWidth(this.elementViewChild.nativeElement),this.defaultHeight=Fe.getHeight(this.elementViewChild.nativeElement),this.defaultContentWidth=Fe.getWidth(this.contentEl),this.defaultContentHeight=Fe.getHeight(this.contentEl),this.initialized=!0)}init(){this._disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize(),this.bindResizeListener(),this.cd.detectChanges())}setContentEl(e){this.contentEl=e||this.contentViewChild?.nativeElement||Fe.findSingle(this.elementViewChild?.nativeElement,".p-scroller-content")}setInitialState(){this.first=this.both?{rows:0,cols:0}:0,this.last=this.both?{rows:0,cols:0}:0,this.numItemsInViewport=this.both?{rows:0,cols:0}:0,this.lastScrollPos=this.both?{top:0,left:0}:0,this.d_loading=this._loading||!1,this.d_numToleratedItems=this._numToleratedItems,this.loaderArr=[],this.spacerStyle={},this.contentStyle={}}getElementRef(){return this.elementViewChild}getPageByFirst(){return Math.floor((this.first+4*this.d_numToleratedItems)/(this._step||1))}scrollTo(e){this.lastScrollPos=this.both?{top:0,left:0}:0,this.elementViewChild?.nativeElement?.scrollTo(e)}scrollToIndex(e,o="auto"){const{numToleratedItems:r}=this.calculateNumItems(),s=this.getContentPosition(),l=(T=0,I)=>T<=I?0:T,h=(T,I,R)=>T*I+R,g=(T=0,I=0)=>this.scrollTo({left:T,top:I,behavior:o});let b=0;this.both?(b={rows:l(e[0],r[0]),cols:l(e[1],r[1])},g(h(b.cols,this._itemSize[1],s.left),h(b.rows,this._itemSize[0],s.top))):(b=l(e,r),this.horizontal?g(h(b,this._itemSize,s.left),0):g(0,h(b,this._itemSize,s.top))),this.isRangeChanged=this.first!==b,this.first=b}scrollInView(e,o,r="auto"){if(o){const{first:s,viewport:l}=this.getRenderedRange(),h=(T=0,I=0)=>this.scrollTo({left:T,top:I,behavior:r}),b="to-end"===o;if("to-start"===o){if(this.both)l.first.rows-s.rows>e[0]?h(l.first.cols*this._itemSize[1],(l.first.rows-1)*this._itemSize[0]):l.first.cols-s.cols>e[1]&&h((l.first.cols-1)*this._itemSize[1],l.first.rows*this._itemSize[0]);else if(l.first-s>e){const T=(l.first-1)*this._itemSize;this.horizontal?h(T,0):h(0,T)}}else if(b)if(this.both)l.last.rows-s.rows<=e[0]+1?h(l.first.cols*this._itemSize[1],(l.first.rows+1)*this._itemSize[0]):l.last.cols-s.cols<=e[1]+1&&h((l.first.cols+1)*this._itemSize[1],l.first.rows*this._itemSize[0]);else if(l.last-s<=e+1){const T=(l.first+1)*this._itemSize;this.horizontal?h(T,0):h(0,T)}}else this.scrollToIndex(e,r)}getRenderedRange(){const e=(s,l)=>Math.floor(s/(l||s));let o=this.first,r=0;if(this.elementViewChild?.nativeElement){const{scrollTop:s,scrollLeft:l}=this.elementViewChild.nativeElement;this.both?(o={rows:e(s,this._itemSize[0]),cols:e(l,this._itemSize[1])},r={rows:o.rows+this.numItemsInViewport.rows,cols:o.cols+this.numItemsInViewport.cols}):(o=e(this.horizontal?l:s,this._itemSize),r=o+this.numItemsInViewport)}return{first:this.first,last:this.last,viewport:{first:o,last:r}}}calculateNumItems(){const e=this.getContentPosition(),o=this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetWidth-e.left:0,r=this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetHeight-e.top:0,s=(b,T)=>Math.ceil(b/(T||b)),l=b=>Math.ceil(b/2),h=this.both?{rows:s(r,this._itemSize[0]),cols:s(o,this._itemSize[1])}:s(this.horizontal?o:r,this._itemSize);return{numItemsInViewport:h,numToleratedItems:this.d_numToleratedItems||(this.both?[l(h.rows),l(h.cols)]:l(h))}}calculateOptions(){const{numItemsInViewport:e,numToleratedItems:o}=this.calculateNumItems(),r=(h,g,b,T=!1)=>this.getLast(h+g+(h<b?2:3)*b,T),s=this.first,l=this.both?{rows:r(this.first.rows,e.rows,o[0]),cols:r(this.first.cols,e.cols,o[1],!0)}:r(this.first,e,o);this.last=l,this.numItemsInViewport=e,this.d_numToleratedItems=o,this.showLoader&&(this.loaderArr=this.both?Array.from({length:e.rows}).map(()=>Array.from({length:e.cols})):Array.from({length:e})),this._lazy&&Promise.resolve().then(()=>{this.lazyLoadState={first:this._step?this.both?{rows:0,cols:s.cols}:0:s,last:Math.min(this._step?this._step:this.last,this.items.length)},this.handleEvents("onLazyLoad",this.lazyLoadState)})}calculateAutoSize(){this._autoSize&&!this.d_loading&&Promise.resolve().then(()=>{if(this.contentEl){this.contentEl.style.minHeight=this.contentEl.style.minWidth="auto",this.contentEl.style.position="relative",this.elementViewChild.nativeElement.style.contain="none";const[e,o]=[Fe.getWidth(this.contentEl),Fe.getHeight(this.contentEl)];e!==this.defaultContentWidth&&(this.elementViewChild.nativeElement.style.width=""),o!==this.defaultContentHeight&&(this.elementViewChild.nativeElement.style.height="");const[r,s]=[Fe.getWidth(this.elementViewChild.nativeElement),Fe.getHeight(this.elementViewChild.nativeElement)];(this.both||this.horizontal)&&(this.elementViewChild.nativeElement.style.width=r<this.defaultWidth?r+"px":this._scrollWidth||this.defaultWidth+"px"),(this.both||this.vertical)&&(this.elementViewChild.nativeElement.style.height=s<this.defaultHeight?s+"px":this._scrollHeight||this.defaultHeight+"px"),this.contentEl.style.minHeight=this.contentEl.style.minWidth="",this.contentEl.style.position="",this.elementViewChild.nativeElement.style.contain=""}})}getLast(e=0,o=!1){return this._items?Math.min(o?(this._columns||this._items[0]).length:this._items.length,e):0}getContentPosition(){if(this.contentEl){const e=getComputedStyle(this.contentEl),o=parseFloat(e.paddingLeft)+Math.max(parseFloat(e.left)||0,0),r=parseFloat(e.paddingRight)+Math.max(parseFloat(e.right)||0,0),s=parseFloat(e.paddingTop)+Math.max(parseFloat(e.top)||0,0),l=parseFloat(e.paddingBottom)+Math.max(parseFloat(e.bottom)||0,0);return{left:o,right:r,top:s,bottom:l,x:o+r,y:s+l}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}}setSize(){if(this.elementViewChild?.nativeElement){const e=this.elementViewChild.nativeElement.parentElement.parentElement,o=this._scrollWidth||`${this.elementViewChild.nativeElement.offsetWidth||e.offsetWidth}px`,r=this._scrollHeight||`${this.elementViewChild.nativeElement.offsetHeight||e.offsetHeight}px`,s=(l,h)=>this.elementViewChild.nativeElement.style[l]=h;this.both||this.horizontal?(s("height",r),s("width",o)):s("height",r)}}setSpacerSize(){if(this._items){const e=this.getContentPosition(),o=(r,s,l,h=0)=>this.spacerStyle={...this.spacerStyle,[`${r}`]:(s||[]).length*l+h+"px"};this.both?(o("height",this._items,this._itemSize[0],e.y),o("width",this._columns||this._items[1],this._itemSize[1],e.x)):this.horizontal?o("width",this._columns||this._items,this._itemSize,e.x):o("height",this._items,this._itemSize,e.y)}}setContentPosition(e){if(this.contentEl&&!this._appendOnly){const o=e?e.first:this.first,r=(l,h)=>l*h,s=(l=0,h=0)=>this.contentStyle={...this.contentStyle,transform:`translate3d(${l}px, ${h}px, 0)`};if(this.both)s(r(o.cols,this._itemSize[1]),r(o.rows,this._itemSize[0]));else{const l=r(o,this._itemSize);this.horizontal?s(l,0):s(0,l)}}}onScrollPositionChange(e){const o=e.target,r=this.getContentPosition(),s=(ee,le)=>ee?ee>le?ee-le:ee:0,l=(ee,le)=>Math.floor(ee/(le||ee)),h=(ee,le,ve,xe,Be,Ke)=>ee<=Be?Be:Ke?ve-xe-Be:le+Be-1,g=(ee,le,ve,xe,Be,Ke,ft)=>ee<=Ke?0:Math.max(0,ft?ee<le?ve:ee-Ke:ee>le?ve:ee-2*Ke),b=(ee,le,ve,xe,Be,Ke=!1)=>{let ft=le+xe+2*Be;return ee>=Be&&(ft+=Be+1),this.getLast(ft,Ke)},T=s(o.scrollTop,r.top),I=s(o.scrollLeft,r.left);let R=this.both?{rows:0,cols:0}:0,z=this.last,W=!1,X=this.lastScrollPos;if(this.both){const ee=this.lastScrollPos.top<=T,le=this.lastScrollPos.left<=I;if(!this._appendOnly||this._appendOnly&&(ee||le)){const ve={rows:l(T,this._itemSize[0]),cols:l(I,this._itemSize[1])},xe={rows:h(ve.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],ee),cols:h(ve.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],le)};R={rows:g(ve.rows,xe.rows,this.first.rows,0,0,this.d_numToleratedItems[0],ee),cols:g(ve.cols,xe.cols,this.first.cols,0,0,this.d_numToleratedItems[1],le)},z={rows:b(ve.rows,R.rows,0,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:b(ve.cols,R.cols,0,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},W=R.rows!==this.first.rows||z.rows!==this.last.rows||R.cols!==this.first.cols||z.cols!==this.last.cols||this.isRangeChanged,X={top:T,left:I}}}else{const ee=this.horizontal?I:T,le=this.lastScrollPos<=ee;if(!this._appendOnly||this._appendOnly&&le){const ve=l(ee,this._itemSize);R=g(ve,h(ve,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,le),this.first,0,0,this.d_numToleratedItems,le),z=b(ve,R,0,this.numItemsInViewport,this.d_numToleratedItems),W=R!==this.first||z!==this.last||this.isRangeChanged,X=ee}}return{first:R,last:z,isRangeChanged:W,scrollPos:X}}onScrollChange(e){const{first:o,last:r,isRangeChanged:s,scrollPos:l}=this.onScrollPositionChange(e);if(s){const h={first:o,last:r};if(this.setContentPosition(h),this.first=o,this.last=r,this.lastScrollPos=l,this.handleEvents("onScrollIndexChange",h),this._lazy&&this.isPageChanged){const g={first:this._step?Math.min(this.getPageByFirst()*this._step,this.items.length-this._step):o,last:Math.min(this._step?(this.getPageByFirst()+1)*this._step:r,this.items.length)};(this.lazyLoadState.first!==g.first||this.lazyLoadState.last!==g.last)&&this.handleEvents("onLazyLoad",g),this.lazyLoadState=g}}}onContainerScroll(e){if(this.handleEvents("onScroll",{originalEvent:e}),this._delay&&this.isPageChanged){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){const{isRangeChanged:o}=this.onScrollPositionChange(e);(o||this._step&&this.isPageChanged)&&(this.d_loading=!0,this.cd.detectChanges())}this.scrollTimeout=setTimeout(()=>{this.onScrollChange(e),this.d_loading&&this.showLoader&&(!this._lazy||void 0===this._loading)&&(this.d_loading=!1,this.page=this.getPageByFirst(),this.cd.detectChanges())},this._delay)}else!this.d_loading&&this.onScrollChange(e)}bindResizeListener(){this.windowResizeListener||this.zone.runOutsideAngular(()=>{this.windowResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.windowResizeListener),window.addEventListener("orientationchange",this.windowResizeListener)})}unbindResizeListener(){this.windowResizeListener&&(window.removeEventListener("resize",this.windowResizeListener),window.removeEventListener("orientationchange",this.windowResizeListener),this.windowResizeListener=null)}onWindowResize(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{if(Fe.isVisible(this.elementViewChild?.nativeElement)){const[e,o]=[Fe.getWidth(this.elementViewChild.nativeElement),Fe.getHeight(this.elementViewChild.nativeElement)],[r,s]=[e!==this.defaultWidth,o!==this.defaultHeight];(this.both?r||s:this.horizontal?r:this.vertical&&s)&&this.zone.run(()=>{this.d_numToleratedItems=this._numToleratedItems,this.defaultWidth=e,this.defaultHeight=o,this.defaultContentWidth=Fe.getWidth(this.contentEl),this.defaultContentHeight=Fe.getHeight(this.contentEl),this.init()})}},this._resizeDelay)}handleEvents(e,o){return this.options&&this.options[e]?this.options[e](o):this[e].emit(o)}getContentOptions(){return{contentStyleClass:"p-scroller-content "+(this.d_loading?"p-scroller-loading":""),items:this.loadedItems,getItemOptions:e=>this.getOptions(e),loading:this.d_loading,getLoaderOptions:(e,o)=>this.getLoaderOptions(e,o),itemSize:this._itemSize,rows:this.loadedRows,columns:this.loadedColumns,spacerStyle:this.spacerStyle,contentStyle:this.contentStyle,vertical:this.vertical,horizontal:this.horizontal,both:this.both}}getOptions(e){const o=(this._items||[]).length,r=this.both?this.first.rows+e:this.first+e;return{index:r,count:o,first:0===r,last:r===o-1,even:r%2==0,odd:r%2!=0}}getLoaderOptions(e,o){const r=this.loaderArr.length;return{index:e,count:r,first:0===e,last:e===r-1,even:e%2==0,odd:e%2!=0,...o}}}return t.\u0275fac=function(e){return new(e||t)(be(Po),be(fi))},t.\u0275cmp=on({type:t,selectors:[["p-scroller"]],contentQueries:function(e,o,r){if(1&e&&No(r,_o,4),2&e){let s;mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(Tq,5),pi(Eq,5)),2&e){let r;mn(r=gn())&&(o.elementViewChild=r.first),mn(r=gn())&&(o.contentViewChild=r.first)}},hostAttrs:[1,"p-scroller-viewport","p-element"],inputs:{id:"id",style:"style",styleClass:"styleClass",tabindex:"tabindex",items:"items",itemSize:"itemSize",scrollHeight:"scrollHeight",scrollWidth:"scrollWidth",orientation:"orientation",step:"step",delay:"delay",resizeDelay:"resizeDelay",appendOnly:"appendOnly",inline:"inline",lazy:"lazy",disabled:"disabled",loaderDisabled:"loaderDisabled",columns:"columns",showSpacer:"showSpacer",showLoader:"showLoader",numToleratedItems:"numToleratedItems",loading:"loading",autoSize:"autoSize",trackBy:"trackBy",options:"options"},outputs:{onLazyLoad:"onLazyLoad",onScroll:"onScroll",onScrollIndexChange:"onScrollIndexChange"},features:[ur],ngContentSelectors:Xq,decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["disabledContainer",""],[3,"ngStyle","ngClass","scroll"],["element",""],["buildInContent",""],["class","p-scroller-spacer",3,"ngStyle",4,"ngIf"],["class","p-scroller-loader",3,"ngClass",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-scroller-content",3,"ngClass","ngStyle"],["content",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-scroller-spacer",3,"ngStyle"],[1,"p-scroller-loader",3,"ngClass"],["buildInLoader",""],[4,"ngFor","ngForOf"],["buildInLoaderIcon",""],[1,"p-scroller-loading-icon","pi","pi-spinner","pi-spin"],[4,"ngIf"]],template:function(e,o){if(1&e&&(or(),J(0,Gq,8,14,"ng-container",0),J(1,Kq,2,1,"ng-template",null,1,ka)),2&e){const r=jn(2);B("ngIf",!o._disabled)("ngIfElse",r)}},dependencies:[Eo,Ms,mi,Is,Oo],styles:["p-scroller{flex:1;outline:0 none}.p-scroller{position:relative;overflow:auto;contain:strict;transform:translateZ(0);will-change:scroll-position;outline:0 none}.p-scroller-content{position:absolute;top:0;left:0;min-height:100%;min-width:100%;will-change:transform}.p-scroller-spacer{position:absolute;top:0;left:0;height:1px;width:1px;transform-origin:0 0;pointer-events:none}.p-scroller-loader{position:sticky;top:0;left:0;width:100%;height:100%}.p-scroller-loader.p-component-overlay{display:flex;align-items:center;justify-content:center}.p-scroller-loading-icon{font-size:2rem}.p-scroller-inline .p-scroller-content{position:static}\n"],encapsulation:2}),t})(),jw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})(),YL=(()=>{class t{constructor(e,o,r,s,l){this.el=e,this.zone=o,this.config=r,this.renderer=s,this.changeDetector=l,this.escape=!0,this.autoHide=!0,this.fitContent=!0,this._tooltipOptions={tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",tooltipZIndex:"auto",escape:!0,positionTop:0,positionLeft:0,autoHide:!0}}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this.deactivate()}ngAfterViewInit(){this.zone.runOutsideAngular(()=>{if("hover"===this.getOption("tooltipEvent"))this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onInputClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("click",this.clickListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener);else if("focus"===this.getOption("tooltipEvent")){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let e=this.getTarget(this.el.nativeElement);e.addEventListener("focus",this.focusListener),e.addEventListener("blur",this.blurListener)}})}ngOnChanges(e){e.tooltipPosition&&this.setOption({tooltipPosition:e.tooltipPosition.currentValue}),e.tooltipEvent&&this.setOption({tooltipEvent:e.tooltipEvent.currentValue}),e.appendTo&&this.setOption({appendTo:e.appendTo.currentValue}),e.positionStyle&&this.setOption({positionStyle:e.positionStyle.currentValue}),e.tooltipStyleClass&&this.setOption({tooltipStyleClass:e.tooltipStyleClass.currentValue}),e.tooltipZIndex&&this.setOption({tooltipZIndex:e.tooltipZIndex.currentValue}),e.escape&&this.setOption({escape:e.escape.currentValue}),e.showDelay&&this.setOption({showDelay:e.showDelay.currentValue}),e.hideDelay&&this.setOption({hideDelay:e.hideDelay.currentValue}),e.life&&this.setOption({life:e.life.currentValue}),e.positionTop&&this.setOption({positionTop:e.positionTop.currentValue}),e.positionLeft&&this.setOption({positionLeft:e.positionLeft.currentValue}),e.disabled&&this.setOption({disabled:e.disabled.currentValue}),e.text&&(this.setOption({tooltipLabel:e.text.currentValue}),this.active&&(e.text.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),e.autoHide&&this.setOption({autoHide:e.autoHide.currentValue}),e.tooltipOptions&&(this._tooltipOptions={...this._tooltipOptions,...e.tooltipOptions.currentValue},this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}isAutoHide(){return this.getOption("autoHide")}onMouseEnter(e){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(e){(this.isAutoHide()||!(Fe.hasClass(e.toElement,"p-tooltip")||Fe.hasClass(e.toElement,"p-tooltip-arrow")||Fe.hasClass(e.toElement,"p-tooltip-text")||Fe.hasClass(e.relatedTarget,"p-tooltip")))&&this.deactivate()}onFocus(e){this.activate()}onBlur(e){this.deactivate()}onInputClick(e){this.deactivate()}activate(){if(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life")){let e=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},e)}}deactivate(){this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div");let e=document.createElement("div");e.className="p-tooltip-arrow",this.container.appendChild(e),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),"body"===this.getOption("appendTo")?document.body.appendChild(this.container):"target"===this.getOption("appendTo")?Fe.appendChild(this.container,this.el.nativeElement):Fe.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block",this.fitContent&&(this.container.style.width="fit-content"),this.isAutoHide()||this.bindContainerMouseleaveListener()}bindContainerMouseleaveListener(){this.containerMouseleaveListener||(this.containerMouseleaveListener=this.renderer.listen(this.container??this.container.nativeElement,"mouseleave",o=>{this.deactivate()}))}unbindContainerMouseleaveListener(){this.containerMouseleaveListener&&(this.bindContainerMouseleaveListener(),this.containerMouseleaveListener=null)}show(){!this.getOption("tooltipLabel")||this.getOption("disabled")||(this.create(),this.align(),Fe.fadeIn(this.container,250),"auto"===this.getOption("tooltipZIndex")?ns.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener())}hide(){"auto"===this.getOption("tooltipZIndex")&&ns.clear(this.container),this.remove()}updateText(){this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(this.getOption("tooltipLabel")))):this.tooltipText.innerHTML=this.getOption("tooltipLabel")}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()))}}getHostOffset(){if("body"===this.getOption("appendTo")||"target"===this.getOption("appendTo")){let e=this.el.nativeElement.getBoundingClientRect();return{left:e.left+Fe.getWindowScrollLeft(),top:e.top+Fe.getWindowScrollTop()}}return{left:0,top:0}}alignRight(){this.preAlign("right");let e=this.getHostOffset(),o=e.left+Fe.getOuterWidth(this.el.nativeElement),r=e.top+(Fe.getOuterHeight(this.el.nativeElement)-Fe.getOuterHeight(this.container))/2;this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignLeft(){this.preAlign("left");let e=this.getHostOffset(),o=e.left-Fe.getOuterWidth(this.container),r=e.top+(Fe.getOuterHeight(this.el.nativeElement)-Fe.getOuterHeight(this.container))/2;this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let e=this.getHostOffset(),o=e.left+(Fe.getOuterWidth(this.el.nativeElement)-Fe.getOuterWidth(this.container))/2,r=e.top-Fe.getOuterHeight(this.container);this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let e=this.getHostOffset(),o=e.left+(Fe.getOuterWidth(this.el.nativeElement)-Fe.getOuterWidth(this.container))/2,r=e.top+Fe.getOuterHeight(this.el.nativeElement);this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}setOption(e){this._tooltipOptions={...this._tooltipOptions,...e}}getOption(e){return this._tooltipOptions[e]}getTarget(e){return Fe.hasClass(e,"p-inputwrapper")?Fe.findSingle(e,"input"):e}preAlign(e){this.container.style.left="-999px",this.container.style.top="-999px";let o="p-tooltip p-component p-tooltip-"+e;this.container.className=this.getOption("tooltipStyleClass")?o+" "+this.getOption("tooltipStyleClass"):o}isOutOfBounds(){let e=this.container.getBoundingClientRect(),o=e.top,r=e.left,s=Fe.getOuterWidth(this.container),l=Fe.getOuterHeight(this.container),h=Fe.getViewport();return r+s>h.width||r<0||o<0||o+l>h.height}onWindowResize(e){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new qb(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){if("hover"===this.getOption("tooltipEvent"))this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener);else if("focus"===this.getOption("tooltipEvent")){let e=this.getTarget(this.el.nativeElement);e.removeEventListener("focus",this.focusListener),e.removeEventListener("blur",this.blurListener)}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&("body"===this.getOption("appendTo")?document.body.removeChild(this.container):"target"===this.getOption("appendTo")?this.el.nativeElement.removeChild(this.container):Fe.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.unbindContainerMouseleaveListener(),this.clearTimeouts(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&ns.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(fi),be(Il),be(jr),be(Po))},t.\u0275dir=kn({type:t,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:"escape",showDelay:"showDelay",hideDelay:"hideDelay",life:"life",positionTop:"positionTop",positionLeft:"positionLeft",autoHide:"autoHide",fitContent:"fitContent",text:["pTooltip","text"],disabled:["tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[ur]}),t})(),fu=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();function Yq(t,n){if(1&t&&(F(0,"span"),ce(1),V()),2&t){const e=q();let o;j(1),Jt(null!==(o=e.label)&&void 0!==o?o:"empty")}}function Qq(t,n){1&t&&Ht(0)}const Kb=function(t){return{height:t}},Jq=function(t,n){return{"p-dropdown-item":!0,"p-highlight":t,"p-disabled":n}},ZD=function(t){return{$implicit:t}},eZ=["container"],tZ=["filter"],nZ=["in"],iZ=["editableInput"],oZ=["items"],rZ=["scroller"],sZ=["overlay"];function aZ(t,n){if(1&t&&(xn(0),ce(1),In()),2&t){const e=q(2);j(1),Jt(e.label||"empty")}}function lZ(t,n){1&t&&Ht(0)}const cZ=function(t){return{"p-dropdown-label p-inputtext":!0,"p-dropdown-label-empty":t}};function uZ(t,n){if(1&t&&(F(0,"span",14),J(1,aZ,2,1,"ng-container",15),J(2,lZ,1,0,"ng-container",16),V()),2&t){const e=q();B("ngClass",An(9,cZ,null==e.label||0===e.label.length))("pTooltip",e.tooltip)("tooltipPosition",e.tooltipPosition)("positionStyle",e.tooltipPositionStyle)("tooltipStyleClass",e.tooltipStyleClass),st("id",e.labelId),j(1),B("ngIf",!e.selectedItemTemplate),j(1),B("ngTemplateOutlet",e.selectedItemTemplate)("ngTemplateOutletContext",An(11,ZD,e.selectedOption))}}const dZ=function(t){return{"p-dropdown-label p-inputtext p-placeholder":!0,"p-dropdown-label-empty":t}};function hZ(t,n){if(1&t&&(F(0,"span",17),ce(1),V()),2&t){const e=q();B("ngClass",An(2,dZ,null==e.placeholder||0===e.placeholder.length)),j(1),Jt(e.placeholder||"empty")}}function pZ(t,n){if(1&t){const e=xt();F(0,"input",18,19),Oe("input",function(r){return Ie(e),Me(q().onEditableInputChange(r))})("focus",function(r){return Ie(e),Me(q().onEditableInputFocus(r))})("blur",function(r){return Ie(e),Me(q().onInputBlur(r))}),V()}if(2&t){const e=q();B("disabled",e.disabled),st("maxlength",e.maxlength)("placeholder",e.placeholder)("aria-expanded",e.overlayVisible)}}function fZ(t,n){if(1&t){const e=xt();F(0,"i",20),Oe("click",function(r){return Ie(e),Me(q().clear(r))}),V()}}function mZ(t,n){1&t&&Ht(0)}function gZ(t,n){1&t&&Ht(0)}const QL=function(t){return{options:t}};function _Z(t,n){if(1&t&&(xn(0),J(1,gZ,1,0,"ng-container",16),In()),2&t){const e=q(3);j(1),B("ngTemplateOutlet",e.filterTemplate)("ngTemplateOutletContext",An(2,QL,e.filterOptions))}}function yZ(t,n){if(1&t){const e=xt();F(0,"div",30)(1,"input",31,32),Oe("keydown.enter",function(r){return r.preventDefault()})("keydown",function(r){return Ie(e),Me(q(3).onKeydown(r,!1))})("input",function(r){return Ie(e),Me(q(3).onFilterInputChange(r))}),V(),Ne(3,"span",33),V()}if(2&t){const e=q(3);j(1),B("value",e.filterValue||""),st("placeholder",e.filterPlaceholder)("aria-label",e.ariaFilterLabel)("aria-activedescendant",e.overlayVisible?"p-highlighted-option":e.labelId)}}function vZ(t,n){if(1&t&&(F(0,"div",27),Oe("click",function(o){return o.stopPropagation()}),J(1,_Z,2,4,"ng-container",28),J(2,yZ,4,4,"ng-template",null,29,ka),V()),2&t){const e=jn(3),o=q(2);j(1),B("ngIf",o.filterTemplate)("ngIfElse",e)}}function bZ(t,n){1&t&&Ht(0)}const JL=function(t,n){return{$implicit:t,options:n}};function xZ(t,n){if(1&t&&J(0,bZ,1,0,"ng-container",16),2&t){const e=n.$implicit,o=n.options;q(2),B("ngTemplateOutlet",jn(7))("ngTemplateOutletContext",no(2,JL,e,o))}}function wZ(t,n){1&t&&Ht(0)}function CZ(t,n){if(1&t&&J(0,wZ,1,0,"ng-container",16),2&t){const e=n.options;B("ngTemplateOutlet",q(4).loaderTemplate)("ngTemplateOutletContext",An(2,QL,e))}}function TZ(t,n){1&t&&(xn(0),J(1,CZ,1,4,"ng-template",36),In())}function EZ(t,n){if(1&t){const e=xt();F(0,"p-scroller",34,35),Oe("onLazyLoad",function(r){return Ie(e),Me(q(2).onLazyLoad.emit(r))}),J(2,xZ,1,5,"ng-template",13),J(3,TZ,2,0,"ng-container",15),V()}if(2&t){const e=q(2);Ao(An(8,Kb,e.scrollHeight)),B("items",e.optionsToDisplay)("itemSize",e.virtualScrollItemSize||e._itemSize)("autoSize",!0)("lazy",e.lazy)("options",e.virtualScrollOptions),j(3),B("ngIf",e.loaderTemplate)}}function SZ(t,n){1&t&&Ht(0)}const DZ=function(){return{}};function MZ(t,n){if(1&t&&(xn(0),J(1,SZ,1,0,"ng-container",16),In()),2&t){q();const e=jn(7),o=q();j(1),B("ngTemplateOutlet",e)("ngTemplateOutletContext",no(3,JL,o.optionsToDisplay,ai(2,DZ)))}}function IZ(t,n){if(1&t&&(F(0,"span"),ce(1),V()),2&t){const e=q().$implicit,o=q(4);j(1),Jt(o.getOptionGroupLabel(e)||"empty")}}function kZ(t,n){1&t&&Ht(0)}function AZ(t,n){1&t&&Ht(0)}const eF=function(t,n){return{$implicit:t,selectedOption:n}};function PZ(t,n){if(1&t&&(F(0,"li",42),J(1,IZ,2,1,"span",15),J(2,kZ,1,0,"ng-container",16),V(),J(3,AZ,1,0,"ng-container",16)),2&t){const e=n.$implicit,o=q(2).options,r=jn(5),s=q(2);B("ngStyle",An(6,Kb,o.itemSize+"px")),j(1),B("ngIf",!s.groupTemplate),j(1),B("ngTemplateOutlet",s.groupTemplate)("ngTemplateOutletContext",An(8,ZD,e)),j(1),B("ngTemplateOutlet",r)("ngTemplateOutletContext",no(10,eF,s.getOptionGroupChildren(e),s.selectedOption))}}function OZ(t,n){if(1&t&&(xn(0),J(1,PZ,4,13,"ng-template",41),In()),2&t){const e=q().$implicit;j(1),B("ngForOf",e)}}function RZ(t,n){1&t&&Ht(0)}function LZ(t,n){if(1&t&&(xn(0),J(1,RZ,1,0,"ng-container",16),In()),2&t){const e=q().$implicit,o=jn(5),r=q(2);j(1),B("ngTemplateOutlet",o)("ngTemplateOutletContext",no(2,eF,e,r.selectedOption))}}function FZ(t,n){if(1&t){const e=xt();F(0,"p-dropdownItem",43),Oe("onClick",function(r){return Ie(e),Me(q(4).onItemClick(r))}),V()}if(2&t){const e=n.$implicit,o=q().selectedOption,r=q(3);B("option",e)("selected",o==e)("label",r.getOptionLabel(e))("disabled",r.isOptionDisabled(e))("template",r.itemTemplate)}}function zZ(t,n){1&t&&J(0,FZ,1,5,"ng-template",41),2&t&&B("ngForOf",n.$implicit)}function NZ(t,n){if(1&t&&(xn(0),ce(1),In()),2&t){const e=q(4);j(1),ei(" ",e.emptyFilterMessageLabel," ")}}function BZ(t,n){1&t&&Ht(0,null,45)}function VZ(t,n){if(1&t&&(F(0,"li",44),J(1,NZ,2,1,"ng-container",28),J(2,BZ,2,0,"ng-container",22),V()),2&t){const e=q().options,o=q(2);B("ngStyle",An(4,Kb,e.itemSize+"px")),j(1),B("ngIf",!o.emptyFilterTemplate&&!o.emptyTemplate)("ngIfElse",o.emptyFilter),j(1),B("ngTemplateOutlet",o.emptyFilterTemplate||o.emptyTemplate)}}function UZ(t,n){if(1&t&&(xn(0),ce(1),In()),2&t){const e=q(4);j(1),ei(" ",e.emptyMessageLabel," ")}}function jZ(t,n){1&t&&Ht(0,null,46)}function HZ(t,n){if(1&t&&(F(0,"li",44),J(1,UZ,2,1,"ng-container",28),J(2,jZ,2,0,"ng-container",22),V()),2&t){const e=q().options,o=q(2);B("ngStyle",An(4,Kb,e.itemSize+"px")),j(1),B("ngIf",!o.emptyTemplate)("ngIfElse",o.empty),j(1),B("ngTemplateOutlet",o.emptyTemplate)}}function $Z(t,n){if(1&t&&(F(0,"ul",37,38),J(2,OZ,2,1,"ng-container",15),J(3,LZ,2,5,"ng-container",15),J(4,zZ,1,1,"ng-template",null,39,ka),J(6,VZ,3,6,"li",40),J(7,HZ,3,6,"li",40),V()),2&t){const e=n.options,o=q(2);Ao(e.contentStyle),B("ngClass",e.contentStyleClass),st("id",o.listId),j(2),B("ngIf",o.group),j(1),B("ngIf",!o.group),j(3),B("ngIf",o.filterValue&&o.isEmpty()),j(1),B("ngIf",!o.filterValue&&o.isEmpty())}}function GZ(t,n){1&t&&Ht(0)}function WZ(t,n){if(1&t&&(F(0,"div",21),J(1,mZ,1,0,"ng-container",22),J(2,vZ,4,2,"div",23),F(3,"div",24),J(4,EZ,4,10,"p-scroller",25),J(5,MZ,2,6,"ng-container",15),J(6,$Z,8,8,"ng-template",null,26,ka),V(),J(8,GZ,1,0,"ng-container",22),V()),2&t){const e=q();Xn(e.panelStyleClass),B("ngClass","p-dropdown-panel p-component")("ngStyle",e.panelStyle),j(1),B("ngTemplateOutlet",e.headerTemplate),j(1),B("ngIf",e.filter),j(1),aa("max-height",e.virtualScroll?"auto":e.scrollHeight||"auto"),j(1),B("ngIf",e.virtualScroll),j(1),B("ngIf",!e.virtualScroll),j(3),B("ngTemplateOutlet",e.footerTemplate)}}const qZ=function(t,n,e,o){return{"p-dropdown p-component":!0,"p-disabled":t,"p-dropdown-open":n,"p-focus":e,"p-dropdown-clearable":o}},ZZ={provide:ks,useExisting:xi(()=>KD),multi:!0};let KZ=(()=>{class t{constructor(){this.onClick=new Tt}onOptionClick(e){this.onClick.emit({originalEvent:e,option:this.option})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["p-dropdownItem"]],hostAttrs:[1,"p-element"],inputs:{option:"option",selected:"selected",label:"label",disabled:"disabled",visible:"visible",itemSize:"itemSize",template:"template"},outputs:{onClick:"onClick"},decls:3,vars:15,consts:[["role","option","pRipple","",3,"ngStyle","id","ngClass","click"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){1&e&&(F(0,"li",0),Oe("click",function(s){return o.onOptionClick(s)}),J(1,Yq,2,1,"span",1),J(2,Qq,1,0,"ng-container",2),V()),2&e&&(B("ngStyle",An(8,Kb,o.itemSize+"px"))("id",o.selected?"p-highlighted-option":"")("ngClass",no(10,Jq,o.selected,o.disabled)),st("aria-label",o.label)("aria-selected",o.selected),j(1),B("ngIf",!o.template),j(1),B("ngTemplateOutlet",o.template)("ngTemplateOutletContext",An(13,ZD,o.option)))},dependencies:[Eo,mi,Is,Oo,vd],encapsulation:2}),t})(),KD=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.renderer=o,this.cd=r,this.zone=s,this.filterService=l,this.config=h,this.scrollHeight="200px",this.resetFilterOnHide=!1,this.dropdownIcon="pi pi-chevron-down",this.optionGroupChildren="items",this.autoDisplayFirst=!0,this.emptyFilterMessage="",this.emptyMessage="",this.lazy=!1,this.filterMatchMode="contains",this.tooltip="",this.tooltipPosition="right",this.tooltipPositionStyle="absolute",this.autofocusFilter=!0,this.overlayDirection="end",this.onChange=new Tt,this.onFilter=new Tt,this.onFocus=new Tt,this.onBlur=new Tt,this.onClick=new Tt,this.onShow=new Tt,this.onHide=new Tt,this.onClear=new Tt,this.onLazyLoad=new Tt,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.id=cy()}get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1,this.overlayVisible&&this.hide()),this._disabled=e,this.cd.destroyed||this.cd.detectChanges()}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e,console.warn("The itemSize property is deprecated, use virtualScrollItemSize property instead.")}get autoZIndex(){return this._autoZIndex}set autoZIndex(e){this._autoZIndex=e,console.warn("The autoZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}get baseZIndex(){return this._baseZIndex}set baseZIndex(e){this._baseZIndex=e,console.warn("The baseZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}get showTransitionOptions(){return this._showTransitionOptions}set showTransitionOptions(e){this._showTransitionOptions=e,console.warn("The showTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}get hideTransitionOptions(){return this._hideTransitionOptions}set hideTransitionOptions(e){this._hideTransitionOptions=e,console.warn("The hideTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":default:this.itemTemplate=e.template;break;case"selectedItem":this.selectedItemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"filter":this.filterTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"emptyfilter":this.emptyFilterTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"group":this.groupTemplate=e.template;break;case"loader":this.loaderTemplate=e.template}})}ngOnInit(){this.optionsToDisplay=this.options,this.updateSelectedOption(null),this.labelId=this.id+"_label",this.listId=this.id+"_list",this.filterBy&&(this.filterOptions={filter:e=>this.onFilterInputChange(e),reset:()=>this.resetFilter()})}get options(){return this._options}set options(e){this._options=e,this.optionsToDisplay=this._options,this.updateSelectedOption(this.value),this.selectedOption=this.findOption(this.value,this.optionsToDisplay),!this.selectedOption&&_n.isNotEmpty(this.value)&&!this.editable&&(this.value=null,this.onModelChange(this.value)),this.optionsChanged=!0,this._filterValue&&this._filterValue.length&&this.activateFilter()}get filterValue(){return this._filterValue}set filterValue(e){this._filterValue=e,this.activateFilter()}ngAfterViewInit(){this.editable&&this.updateEditableLabel()}get label(){return"number"==typeof this.selectedOption&&(this.selectedOption=this.selectedOption.toString()),this.selectedOption?this.getOptionLabel(this.selectedOption):null}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(Dr.EMPTY_MESSAGE)}get emptyFilterMessageLabel(){return this.emptyFilterMessage||this.config.getTranslation(Dr.EMPTY_FILTER_MESSAGE)}get filled(){return"string"==typeof this.value?!!this.value:this.value||null!=this.value||null!=this.value}get isVisibleClearIcon(){return null!=this.value&&""!==this.value&&this.showClear&&!this.disabled}updateEditableLabel(){this.editableInputViewChild&&this.editableInputViewChild.nativeElement&&(this.editableInputViewChild.nativeElement.value=this.selectedOption?this.getOptionLabel(this.selectedOption):this.value||"")}getOptionLabel(e){return this.optionLabel?_n.resolveFieldData(e,this.optionLabel):e&&void 0!==e.label?e.label:e}getOptionValue(e){return this.optionValue?_n.resolveFieldData(e,this.optionValue):!this.optionLabel&&e&&void 0!==e.value?e.value:e}isOptionDisabled(e){return this.optionDisabled?_n.resolveFieldData(e,this.optionDisabled):!(!e||void 0===e.disabled)&&e.disabled}getOptionGroupLabel(e){return this.optionGroupLabel?_n.resolveFieldData(e,this.optionGroupLabel):e&&void 0!==e.label?e.label:e}getOptionGroupChildren(e){return this.optionGroupChildren?_n.resolveFieldData(e,this.optionGroupChildren):e.items}onItemClick(e){const o=e.option;this.isOptionDisabled(o)||(this.selectItem(e.originalEvent,o),this.accessibleViewChild.nativeElement.focus({preventScroll:!0})),setTimeout(()=>{this.hide()},1)}selectItem(e,o){this.selectedOption!=o&&(this.selectedOption=o,this.value=this.getOptionValue(o),this.onModelChange(this.value),this.updateEditableLabel(),this.onChange.emit({originalEvent:e,value:this.value}))}ngAfterViewChecked(){if(this.optionsChanged&&this.overlayVisible&&(this.optionsChanged=!1,this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild&&this.overlayViewChild.alignOverlay()},1)})),this.selectedOptionUpdated&&this.itemsWrapper){let e=Fe.findSingle(this.overlayViewChild.overlayViewChild.nativeElement,"li.p-highlight");e&&Fe.scrollInView(this.itemsWrapper,e),this.selectedOptionUpdated=!1}}writeValue(e){this.filter&&this.resetFilter(),this.value=e,this.updateSelectedOption(e),this.updateEditableLabel(),this.cd.markForCheck()}resetFilter(){this._filterValue=null,this.filterViewChild&&this.filterViewChild.nativeElement&&(this.filterViewChild.nativeElement.value=""),this.optionsToDisplay=this.options}updateSelectedOption(e){this.selectedOption=this.findOption(e,this.optionsToDisplay),this.autoDisplayFirst&&!this.placeholder&&!this.selectedOption&&this.optionsToDisplay&&this.optionsToDisplay.length&&!this.editable&&(this.selectedOption=this.group?this.optionsToDisplay[0].items[0]:this.optionsToDisplay[0],this.value=this.getOptionValue(this.selectedOption),this.onModelChange(this.value)),this.selectedOptionUpdated=!0}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onMouseclick(e){this.disabled||this.readonly||this.isInputClick(e)||(this.onClick.emit(e),this.accessibleViewChild.nativeElement.focus({preventScroll:!0}),this.overlayVisible?this.hide():this.show(),this.cd.detectChanges())}isInputClick(e){return Fe.hasClass(e.target,"p-dropdown-clear-icon")||e.target.isSameNode(this.accessibleViewChild.nativeElement)||this.editableInputViewChild&&e.target.isSameNode(this.editableInputViewChild.nativeElement)}isEmpty(){return!this.optionsToDisplay||this.optionsToDisplay&&0===this.optionsToDisplay.length}onEditableInputFocus(e){this.focused=!0,this.hide(),this.onFocus.emit(e)}onEditableInputChange(e){this.value=e.target.value,this.updateSelectedOption(this.value),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value})}show(){this.overlayVisible=!0,this.cd.markForCheck()}onOverlayAnimationStart(e){if("visible"===e.toState){if(this.itemsWrapper=Fe.findSingle(this.overlayViewChild.overlayViewChild.nativeElement,this.virtualScroll?".p-scroller":".p-dropdown-items-wrapper"),this.virtualScroll&&this.scroller.setContentEl(this.itemsViewChild.nativeElement),this.options&&this.options.length)if(this.virtualScroll){const o=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;-1!==o&&this.scroller.scrollToIndex(o)}else{let o=Fe.findSingle(this.itemsWrapper,".p-dropdown-item.p-highlight");o&&o.scrollIntoView({block:"nearest",inline:"center"})}this.filterViewChild&&this.filterViewChild.nativeElement&&(this.preventModelTouched=!0,this.autofocusFilter&&this.filterViewChild.nativeElement.focus()),this.onShow.emit(e)}"void"===e.toState&&(this.itemsWrapper=null,this.onModelTouched(),this.onHide.emit(e))}hide(){this.overlayVisible=!1,this.filter&&this.resetFilterOnHide&&this.resetFilter(),this.cd.markForCheck()}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.onBlur.emit(e),this.preventModelTouched||this.onModelTouched(),this.preventModelTouched=!1}findPrevEnabledOption(e){let o;if(this.optionsToDisplay&&this.optionsToDisplay.length){for(let r=e-1;0<=r;r--){let s=this.optionsToDisplay[r];if(!this.isOptionDisabled(s)){o=s;break}}if(!o)for(let r=this.optionsToDisplay.length-1;r>=e;r--){let s=this.optionsToDisplay[r];if(!this.isOptionDisabled(s)){o=s;break}}}return o}findNextEnabledOption(e){let o;if(this.optionsToDisplay&&this.optionsToDisplay.length){for(let r=e+1;r<this.optionsToDisplay.length;r++){let s=this.optionsToDisplay[r];if(!this.isOptionDisabled(s)){o=s;break}}if(!o)for(let r=0;r<e;r++){let s=this.optionsToDisplay[r];if(!this.isOptionDisabled(s)){o=s;break}}}return o}onKeydown(e,o){if(!this.readonly&&this.optionsToDisplay&&null!==this.optionsToDisplay.length)switch(e.which){case 40:if(!this.overlayVisible&&e.altKey)this.show();else if(this.group){let r=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;if(-1!==r){let s=r.itemIndex+1;s<this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex]).length?(this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex])[s]),this.selectedOptionUpdated=!0):this.optionsToDisplay[r.groupIndex+1]&&(this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex+1])[0]),this.selectedOptionUpdated=!0)}else this.optionsToDisplay&&this.optionsToDisplay.length>0&&this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[0])[0])}else{let r=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1,s=this.findNextEnabledOption(r);s&&(this.selectItem(e,s),this.selectedOptionUpdated=!0)}e.preventDefault();break;case 38:if(this.group){let r=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;if(-1!==r){let s=r.itemIndex-1;if(s>=0)this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex])[s]),this.selectedOptionUpdated=!0;else if(s<0){let l=this.optionsToDisplay[r.groupIndex-1];l&&(this.selectItem(e,this.getOptionGroupChildren(l)[this.getOptionGroupChildren(l).length-1]),this.selectedOptionUpdated=!0)}}}else{let r=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1,s=this.findPrevEnabledOption(r);s&&(this.selectItem(e,s),this.selectedOptionUpdated=!0)}e.preventDefault();break;case 32:o&&(this.overlayVisible?this.hide():this.show(),e.preventDefault());break;case 13:this.overlayVisible&&(!this.filter||this.optionsToDisplay&&this.optionsToDisplay.length>0)?this.hide():this.overlayVisible||this.show(),e.preventDefault();break;case 27:case 9:this.hide();break;default:o&&!e.metaKey&&17!==e.which&&this.search(e)}}search(e){this.searchTimeout&&clearTimeout(this.searchTimeout);const o=e.key;let r;if(this.previousSearchChar=this.currentSearchChar,this.currentSearchChar=o,this.searchValue=this.previousSearchChar===this.currentSearchChar?this.currentSearchChar:this.searchValue?this.searchValue+o:o,this.group){let s=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):{groupIndex:0,itemIndex:0};r=this.searchOptionWithinGroup(s)}else{let s=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;r=this.searchOption(++s)}r&&!this.isOptionDisabled(r)&&(this.selectItem(e,r),this.selectedOptionUpdated=!0),this.searchTimeout=setTimeout(()=>{this.searchValue=null},250)}searchOption(e){let o;return this.searchValue&&(o=this.searchOptionInRange(e,this.optionsToDisplay.length),o||(o=this.searchOptionInRange(0,e))),o}searchOptionInRange(e,o){for(let r=e;r<o;r++){let s=this.optionsToDisplay[r];if(this.getOptionLabel(s).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(s))return s}return null}searchOptionWithinGroup(e){if(this.searchValue){for(let r=e.groupIndex;r<this.optionsToDisplay.length;r++)for(let s=e.groupIndex===r?e.itemIndex+1:0;s<this.getOptionGroupChildren(this.optionsToDisplay[r]).length;s++){let l=this.getOptionGroupChildren(this.optionsToDisplay[r])[s];if(this.getOptionLabel(l).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(l))return l}for(let r=0;r<=e.groupIndex;r++)for(let s=0;s<(e.groupIndex===r?e.itemIndex:this.getOptionGroupChildren(this.optionsToDisplay[r]).length);s++){let l=this.getOptionGroupChildren(this.optionsToDisplay[r])[s];if(this.getOptionLabel(l).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(l))return l}}return null}findOptionIndex(e,o){let r=-1;if(o)for(let s=0;s<o.length;s++)if(null==e&&null==this.getOptionValue(o[s])||_n.equals(e,this.getOptionValue(o[s]),this.dataKey)){r=s;break}return r}findOptionGroupIndex(e,o){let r,s;if(o)for(let l=0;l<o.length&&(r=l,s=this.findOptionIndex(e,this.getOptionGroupChildren(o[l])),-1===s);l++);return-1!==s?{groupIndex:r,itemIndex:s}:-1}findOption(e,o,r){if(this.group&&!r){let s;if(o&&o.length)for(let l of o)if(s=this.findOption(e,this.getOptionGroupChildren(l),!0),s)break;return s}{let s=this.findOptionIndex(e,o);return-1!=s?o[s]:null}}onFilterInputChange(e){let o=e.target.value;o&&o.length?(this._filterValue=o,this.activateFilter()):(this._filterValue=null,this.optionsToDisplay=this.options),this.virtualScroll&&this.scroller.scrollToIndex(0),this.optionsChanged=!0,this.onFilter.emit({originalEvent:e,filter:this._filterValue})}activateFilter(){let e=(this.filterBy||this.optionLabel||"label").split(",");if(this.options&&this.options.length){if(this.group){let o=[];for(let r of this.options){let s=this.filterService.filter(this.getOptionGroupChildren(r),e,this.filterValue,this.filterMatchMode,this.filterLocale);s&&s.length&&o.push({...r,[this.optionGroupChildren]:s})}this.optionsToDisplay=o}else this.optionsToDisplay=this.filterService.filter(this.options,e,this.filterValue,this.filterMatchMode,this.filterLocale);this.optionsChanged=!0}}applyFocus(){this.editable?Fe.findSingle(this.el.nativeElement,".p-dropdown-label.p-inputtext").focus():Fe.findSingle(this.el.nativeElement,"input[readonly]").focus()}focus(){this.applyFocus()}clear(e){this.value=null,this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}),this.updateSelectedOption(this.value),this.updateEditableLabel(),this.onClear.emit(e)}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(jr),be(Po),be(fi),be($D),be(Il))},t.\u0275cmp=on({type:t,selectors:[["p-dropdown"]],contentQueries:function(e,o,r){if(1&e&&No(r,_o,4),2&e){let s;mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(eZ,5),pi(tZ,5),pi(nZ,5),pi(iZ,5),pi(oZ,5),pi(rZ,5),pi(sZ,5)),2&e){let r;mn(r=gn())&&(o.containerViewChild=r.first),mn(r=gn())&&(o.filterViewChild=r.first),mn(r=gn())&&(o.accessibleViewChild=r.first),mn(r=gn())&&(o.editableInputViewChild=r.first),mn(r=gn())&&(o.itemsViewChild=r.first),mn(r=gn())&&(o.scroller=r.first),mn(r=gn())&&(o.overlayViewChild=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:4,hostBindings:function(e,o){2&e&&Mo("p-inputwrapper-filled",o.filled)("p-inputwrapper-focus",o.focused||o.overlayVisible)},inputs:{scrollHeight:"scrollHeight",filter:"filter",name:"name",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",readonly:"readonly",required:"required",editable:"editable",appendTo:"appendTo",tabindex:"tabindex",placeholder:"placeholder",filterPlaceholder:"filterPlaceholder",filterLocale:"filterLocale",inputId:"inputId",selectId:"selectId",dataKey:"dataKey",filterBy:"filterBy",autofocus:"autofocus",resetFilterOnHide:"resetFilterOnHide",dropdownIcon:"dropdownIcon",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",optionGroupLabel:"optionGroupLabel",optionGroupChildren:"optionGroupChildren",autoDisplayFirst:"autoDisplayFirst",group:"group",showClear:"showClear",emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",lazy:"lazy",virtualScroll:"virtualScroll",virtualScrollItemSize:"virtualScrollItemSize",virtualScrollOptions:"virtualScrollOptions",overlayOptions:"overlayOptions",ariaFilterLabel:"ariaFilterLabel",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",filterMatchMode:"filterMatchMode",maxlength:"maxlength",tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",autofocusFilter:"autofocusFilter",overlayDirection:"overlayDirection",disabled:"disabled",itemSize:"itemSize",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",options:"options",filterValue:"filterValue"},outputs:{onChange:"onChange",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onClick:"onClick",onShow:"onShow",onHide:"onHide",onClear:"onClear",onLazyLoad:"onLazyLoad"},features:[Wi([ZZ])],decls:14,vars:32,consts:[[3,"ngClass","ngStyle","click"],["container",""],[1,"p-hidden-accessible"],["type","text","readonly","","aria-haspopup","listbox","aria-haspopup","listbox","pAutoFocus","","role","combobox",3,"disabled","autofocus","focus","blur","keydown"],["in",""],[3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass",4,"ngIf"],[3,"ngClass",4,"ngIf"],["type","text","class","p-dropdown-label p-inputtext","aria-haspopup","listbox",3,"disabled","input","focus","blur",4,"ngIf"],["class","p-dropdown-clear-icon pi pi-times",3,"click",4,"ngIf"],["role","button","aria-label","dropdown trigger","aria-haspopup","listbox",1,"p-dropdown-trigger"],[1,"p-dropdown-trigger-icon",3,"ngClass"],[3,"visible","options","target","appendTo","autoZIndex","baseZIndex","showTransitionOptions","hideTransitionOptions","visibleChange","onAnimationStart","onHide"],["overlay",""],["pTemplate","content"],[3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],["type","text","aria-haspopup","listbox",1,"p-dropdown-label","p-inputtext",3,"disabled","input","focus","blur"],["editableInput",""],[1,"p-dropdown-clear-icon","pi","pi-times",3,"click"],[3,"ngClass","ngStyle"],[4,"ngTemplateOutlet"],["class","p-dropdown-header",3,"click",4,"ngIf"],[1,"p-dropdown-items-wrapper"],[3,"items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],["buildInItems",""],[1,"p-dropdown-header",3,"click"],[4,"ngIf","ngIfElse"],["builtInFilterElement",""],[1,"p-dropdown-filter-container"],["type","text","autocomplete","off",1,"p-dropdown-filter","p-inputtext","p-component",3,"value","keydown.enter","keydown","input"],["filter",""],[1,"p-dropdown-filter-icon","pi","pi-search"],[3,"items","itemSize","autoSize","lazy","options","onLazyLoad"],["scroller",""],["pTemplate","loader"],["role","listbox",1,"p-dropdown-items",3,"ngClass"],["items",""],["itemslist",""],["class","p-dropdown-empty-message",3,"ngStyle",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"p-dropdown-item-group",3,"ngStyle"],[3,"option","selected","label","disabled","template","onClick"],[1,"p-dropdown-empty-message",3,"ngStyle"],["emptyFilter",""],["empty",""]],template:function(e,o){1&e&&(F(0,"div",0,1),Oe("click",function(s){return o.onMouseclick(s)}),F(2,"div",2)(3,"input",3,4),Oe("focus",function(s){return o.onInputFocus(s)})("blur",function(s){return o.onInputBlur(s)})("keydown",function(s){return o.onKeydown(s,!0)}),V()(),J(5,uZ,3,13,"span",5),J(6,hZ,2,4,"span",6),J(7,pZ,2,4,"input",7),J(8,fZ,1,0,"i",8),F(9,"div",9),Ne(10,"span",10),V(),F(11,"p-overlay",11,12),Oe("visibleChange",function(s){return o.overlayVisible=s})("onAnimationStart",function(s){return o.onOverlayAnimationStart(s)})("onHide",function(){return o.hide()}),J(13,WZ,9,11,"ng-template",13),V()()),2&e&&(Xn(o.styleClass),B("ngClass",Th(27,qZ,o.disabled,o.overlayVisible,o.focused,o.showClear&&!o.disabled))("ngStyle",o.style),j(3),B("disabled",o.disabled)("autofocus",o.autofocus),st("id",o.inputId)("placeholder",o.placeholder)("aria-label",o.ariaLabel)("aria-expanded",!1)("aria-labelledby",o.ariaLabelledBy)("tabindex",o.tabindex)("aria-activedescendant",o.overlayVisible?o.labelId:null),j(2),B("ngIf",!o.editable&&null!=o.label),j(1),B("ngIf",!o.editable&&null==o.label),j(1),B("ngIf",o.editable),j(1),B("ngIf",o.isVisibleClearIcon),j(1),st("aria-expanded",o.overlayVisible),j(1),B("ngClass",o.dropdownIcon),j(1),B("visible",o.overlayVisible)("options",o.overlayOptions)("target","@parent")("appendTo",o.appendTo)("autoZIndex",o.autoZIndex)("baseZIndex",o.baseZIndex)("showTransitionOptions",o.showTransitionOptions)("hideTransitionOptions",o.hideTransitionOptions))},dependencies:[Eo,Ms,mi,Is,Oo,qL,_o,YL,XL,lq,KZ],styles:[".p-dropdown{display:inline-flex;cursor:pointer;position:relative;-webkit-user-select:none;user-select:none}.p-dropdown-clear-icon{position:absolute;top:50%;margin-top:-.5rem}.p-dropdown-trigger{display:flex;align-items:center;justify-content:center;flex-shrink:0}.p-dropdown-label{display:block;white-space:nowrap;overflow:hidden;flex:1 1 auto;width:1%;text-overflow:ellipsis;cursor:pointer}.p-dropdown-label-empty{overflow:hidden;visibility:hidden}input.p-dropdown-label{cursor:default}.p-dropdown-items-wrapper{overflow:auto}.p-dropdown-item{cursor:pointer;font-weight:400;white-space:nowrap;position:relative;overflow:hidden}.p-dropdown-items{margin:0;padding:0;list-style-type:none}.p-dropdown-filter{width:100%}.p-dropdown-filter-container{position:relative}.p-dropdown-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-fluid .p-dropdown{display:flex}.p-fluid .p-dropdown .p-dropdown-label{width:1%}\n"],encapsulation:2,changeDetection:0}),t})(),uy=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,ZL,is,fu,il,jw,cq,ZL,is,jw]}),t})();const XZ=["input"];function YZ(t,n){if(1&t){const e=xt();F(0,"i",6),Oe("click",function(){return Ie(e),Me(q().clear())}),V()}}const tF=function(){return{"p-inputnumber-button p-inputnumber-button-up":!0}},nF=function(){return{"p-inputnumber-button p-inputnumber-button-down":!0}};function QZ(t,n){if(1&t){const e=xt();F(0,"span",7)(1,"button",8),Oe("mousedown",function(r){return Ie(e),Me(q().onUpButtonMouseDown(r))})("mouseup",function(){return Ie(e),Me(q().onUpButtonMouseUp())})("mouseleave",function(){return Ie(e),Me(q().onUpButtonMouseLeave())})("keydown",function(r){return Ie(e),Me(q().onUpButtonKeyDown(r))})("keyup",function(){return Ie(e),Me(q().onUpButtonKeyUp())}),V(),F(2,"button",8),Oe("mousedown",function(r){return Ie(e),Me(q().onDownButtonMouseDown(r))})("mouseup",function(){return Ie(e),Me(q().onDownButtonMouseUp())})("mouseleave",function(){return Ie(e),Me(q().onDownButtonMouseLeave())})("keydown",function(r){return Ie(e),Me(q().onDownButtonKeyDown(r))})("keyup",function(){return Ie(e),Me(q().onDownButtonKeyUp())}),V()()}if(2&t){const e=q();j(1),Xn(e.incrementButtonClass),B("ngClass",ai(10,tF))("icon",e.incrementButtonIcon)("disabled",e.disabled),j(1),Xn(e.decrementButtonClass),B("ngClass",ai(11,nF))("icon",e.decrementButtonIcon)("disabled",e.disabled)}}function JZ(t,n){if(1&t){const e=xt();F(0,"button",8),Oe("mousedown",function(r){return Ie(e),Me(q().onUpButtonMouseDown(r))})("mouseup",function(){return Ie(e),Me(q().onUpButtonMouseUp())})("mouseleave",function(){return Ie(e),Me(q().onUpButtonMouseLeave())})("keydown",function(r){return Ie(e),Me(q().onUpButtonKeyDown(r))})("keyup",function(){return Ie(e),Me(q().onUpButtonKeyUp())}),V()}if(2&t){const e=q();Xn(e.incrementButtonClass),B("ngClass",ai(5,tF))("icon",e.incrementButtonIcon)("disabled",e.disabled)}}function eK(t,n){if(1&t){const e=xt();F(0,"button",8),Oe("mousedown",function(r){return Ie(e),Me(q().onDownButtonMouseDown(r))})("mouseup",function(){return Ie(e),Me(q().onDownButtonMouseUp())})("mouseleave",function(){return Ie(e),Me(q().onDownButtonMouseLeave())})("keydown",function(r){return Ie(e),Me(q().onDownButtonKeyDown(r))})("keyup",function(){return Ie(e),Me(q().onDownButtonKeyUp())}),V()}if(2&t){const e=q();Xn(e.decrementButtonClass),B("ngClass",ai(5,nF))("icon",e.decrementButtonIcon)("disabled",e.disabled)}}const tK=function(t,n,e){return{"p-inputnumber p-component":!0,"p-inputnumber-buttons-stacked":t,"p-inputnumber-buttons-horizontal":n,"p-inputnumber-buttons-vertical":e}},nK={provide:ks,useExisting:xi(()=>iF),multi:!0};let iF=(()=>{class t{constructor(e,o){this.el=e,this.cd=o,this.showButtons=!1,this.format=!0,this.buttonLayout="stacked",this.incrementButtonIcon="pi pi-angle-up",this.decrementButtonIcon="pi pi-angle-down",this.readonly=!1,this.step=1,this.allowEmpty=!0,this.mode="decimal",this.useGrouping=!0,this.showClear=!1,this.onInput=new Tt,this.onFocus=new Tt,this.onBlur=new Tt,this.onKeyDown=new Tt,this.onClear=new Tt,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.groupChar="",this.prefixChar="",this.suffixChar=""}get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1),this._disabled=e,this.timer&&this.clearTimer()}ngOnChanges(e){["locale","localeMatcher","mode","currency","currencyDisplay","useGrouping","minFractionDigits","maxFractionDigits","prefix","suffix"].some(r=>!!e[r])&&this.updateConstructParser()}ngOnInit(){this.constructParser(),this.initialized=!0}getOptions(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits}}constructParser(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());const e=[...new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)].reverse(),o=new Map(e.map((r,s)=>[r,s]));this._numeral=new RegExp(`[${e.join("")}]`,"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=r=>o.get(r)}updateConstructParser(){this.initialized&&this.constructParser()}escapeRegExp(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}getDecimalExpression(){const e=new Intl.NumberFormat(this.locale,{...this.getOptions(),useGrouping:!1});return new RegExp(`[${e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,"")}]`,"g")}getGroupingExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp(`[${this.groupChar}]`,"g")}getMinusSignExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp(`[${e.format(-1).trim().replace(this._numeral,"")}]`,"g")}getCurrencyExpression(){if(this.currency){const e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});return new RegExp(`[${e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,"")}]`,"g")}return new RegExp("[]","g")}getPrefixExpression(){if(this.prefix)this.prefixChar=this.prefix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp(`${this.escapeRegExp(this.prefixChar||"")}`,"g")}getSuffixExpression(){if(this.suffix)this.suffixChar=this.suffix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});this.suffixChar=e.format(1).split("1")[1]}return new RegExp(`${this.escapeRegExp(this.suffixChar||"")}`,"g")}formatValue(e){if(null!=e){if("-"===e)return e;if(this.format){let r=new Intl.NumberFormat(this.locale,this.getOptions()).format(e);return this.prefix&&(r=this.prefix+r),this.suffix&&(r+=this.suffix),r}return e.toString()}return""}parseValue(e){let o=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(o){if("-"===o)return o;let r=+o;return isNaN(r)?null:r}return null}repeat(e,o,r){if(this.readonly)return;let s=o||500;this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(e,40,r)},s),this.spin(e,r)}spin(e,o){let r=this.step*o,s=this.parseValue(this.input.nativeElement.value)||0,l=this.validateValue(s+r);this.maxlength&&this.maxlength<this.formatValue(l).length||(this.updateInput(l,null,"spin",null),this.updateModel(e,l),this.handleOnInput(e,s,l))}clear(){this.value=null,this.onModelChange(this.value),this.onClear.emit()}onUpButtonMouseDown(e){this.input.nativeElement.focus(),this.repeat(e,null,1),e.preventDefault()}onUpButtonMouseUp(){this.clearTimer()}onUpButtonMouseLeave(){this.clearTimer()}onUpButtonKeyDown(e){(32===e.keyCode||13===e.keyCode)&&this.repeat(e,null,1)}onUpButtonKeyUp(){this.clearTimer()}onDownButtonMouseDown(e){this.input.nativeElement.focus(),this.repeat(e,null,-1),e.preventDefault()}onDownButtonMouseUp(){this.clearTimer()}onDownButtonMouseLeave(){this.clearTimer()}onDownButtonKeyUp(){this.clearTimer()}onDownButtonKeyDown(e){(32===e.keyCode||13===e.keyCode)&&this.repeat(e,null,-1)}onUserInput(e){this.readonly||(this.isSpecialChar&&(e.target.value=this.lastValue),this.isSpecialChar=!1)}onInputKeyDown(e){if(this.readonly)return;if(this.lastValue=e.target.value,e.shiftKey||e.altKey)return void(this.isSpecialChar=!0);let o=e.target.selectionStart,r=e.target.selectionEnd,s=e.target.value,l=null;switch(e.altKey&&e.preventDefault(),e.which){case 38:this.spin(e,1),e.preventDefault();break;case 40:this.spin(e,-1),e.preventDefault();break;case 37:this.isNumeralChar(s.charAt(o-1))||e.preventDefault();break;case 39:this.isNumeralChar(s.charAt(o))||e.preventDefault();break;case 13:l=this.validateValue(this.parseValue(this.input.nativeElement.value)),this.input.nativeElement.value=this.formatValue(l),this.input.nativeElement.setAttribute("aria-valuenow",l),this.updateModel(e,l);break;case 8:if(e.preventDefault(),o===r){const h=s.charAt(o-1),{decimalCharIndex:g,decimalCharIndexWithoutPrefix:b}=this.getDecimalCharIndexes(s);if(this.isNumeralChar(h)){const T=this.getDecimalLength(s);if(this._group.test(h))this._group.lastIndex=0,l=s.slice(0,o-2)+s.slice(o-1);else if(this._decimal.test(h))this._decimal.lastIndex=0,T?this.input.nativeElement.setSelectionRange(o-1,o-1):l=s.slice(0,o-1)+s.slice(o);else if(g>0&&o>g){const I=this.isDecimalMode()&&(this.minFractionDigits||0)<T?"":"0";l=s.slice(0,o-1)+I+s.slice(o)}else 1===b?(l=s.slice(0,o-1)+"0"+s.slice(o),l=this.parseValue(l)>0?l:""):l=s.slice(0,o-1)+s.slice(o)}this.updateValue(e,l,null,"delete-single")}else l=this.deleteRange(s,o,r),this.updateValue(e,l,null,"delete-range");break;case 46:if(e.preventDefault(),o===r){const h=s.charAt(o),{decimalCharIndex:g,decimalCharIndexWithoutPrefix:b}=this.getDecimalCharIndexes(s);if(this.isNumeralChar(h)){const T=this.getDecimalLength(s);if(this._group.test(h))this._group.lastIndex=0,l=s.slice(0,o)+s.slice(o+2);else if(this._decimal.test(h))this._decimal.lastIndex=0,T?this.input.nativeElement.setSelectionRange(o+1,o+1):l=s.slice(0,o)+s.slice(o+1);else if(g>0&&o>g){const I=this.isDecimalMode()&&(this.minFractionDigits||0)<T?"":"0";l=s.slice(0,o)+I+s.slice(o+1)}else 1===b?(l=s.slice(0,o)+"0"+s.slice(o+1),l=this.parseValue(l)>0?l:""):l=s.slice(0,o)+s.slice(o+1)}this.updateValue(e,l,null,"delete-back-single")}else l=this.deleteRange(s,o,r),this.updateValue(e,l,null,"delete-range")}this.onKeyDown.emit(e)}onInputKeyPress(e){if(this.readonly)return;let o=e.which||e.keyCode,r=String.fromCharCode(o);const s=this.isDecimalSign(r),l=this.isMinusSign(r);13!=o&&e.preventDefault(),(48<=o&&o<=57||l||s)&&this.insert(e,r,{isDecimalSign:s,isMinusSign:l})}onPaste(e){if(!this.disabled&&!this.readonly){e.preventDefault();let o=(e.clipboardData||window.clipboardData).getData("Text");if(o){let r=this.parseValue(o);null!=r&&this.insert(e,r.toString())}}}allowMinusSign(){return null==this.min||this.min<0}isMinusSign(e){return!(!this._minusSign.test(e)&&"-"!==e||(this._minusSign.lastIndex=0,0))}isDecimalSign(e){return!!this._decimal.test(e)&&(this._decimal.lastIndex=0,!0)}isDecimalMode(){return"decimal"===this.mode}getDecimalCharIndexes(e){let o=e.search(this._decimal);this._decimal.lastIndex=0;const s=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:o,decimalCharIndexWithoutPrefix:s}}getCharIndexes(e){const o=e.search(this._decimal);this._decimal.lastIndex=0;const r=e.search(this._minusSign);this._minusSign.lastIndex=0;const s=e.search(this._suffix);this._suffix.lastIndex=0;const l=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:o,minusCharIndex:r,suffixCharIndex:s,currencyCharIndex:l}}insert(e,o,r={isDecimalSign:!1,isMinusSign:!1}){const s=o.search(this._minusSign);if(this._minusSign.lastIndex=0,!this.allowMinusSign()&&-1!==s)return;let l=this.input.nativeElement.selectionStart,h=this.input.nativeElement.selectionEnd,g=this.input.nativeElement.value.trim();const{decimalCharIndex:b,minusCharIndex:T,suffixCharIndex:I,currencyCharIndex:R}=this.getCharIndexes(g);let z;if(r.isMinusSign)0===l&&(z=g,(-1===T||0!==h)&&(z=this.insertText(g,o,0,h)),this.updateValue(e,z,o,"insert"));else if(r.isDecimalSign)b>0&&l===b?this.updateValue(e,g,o,"insert"):(b>l&&b<h||-1===b&&this.maxFractionDigits)&&(z=this.insertText(g,o,l,h),this.updateValue(e,z,o,"insert"));else{const W=this.numberFormat.resolvedOptions().maximumFractionDigits,X=l!==h?"range-insert":"insert";if(b>0&&l>b){if(l+o.length-(b+1)<=W){const ee=R>=l?R-1:I>=l?I:g.length;z=g.slice(0,l)+o+g.slice(l+o.length,ee)+g.slice(ee),this.updateValue(e,z,o,X)}}else z=this.insertText(g,o,l,h),this.updateValue(e,z,o,X)}}insertText(e,o,r,s){if(2===("."===o?o:o.split(".")).length){const h=e.slice(r,s).search(this._decimal);return this._decimal.lastIndex=0,h>0?e.slice(0,r)+this.formatValue(o)+e.slice(s):e||this.formatValue(o)}return s-r===e.length?this.formatValue(o):0===r?o+e.slice(s):s===e.length?e.slice(0,r)+o:e.slice(0,r)+o+e.slice(s)}deleteRange(e,o,r){let s;return s=r-o===e.length?"":0===o?e.slice(r):r===e.length?e.slice(0,o):e.slice(0,o)+e.slice(r),s}initCursor(){let e=this.input.nativeElement.selectionStart,o=this.input.nativeElement.value,r=o.length,s=null,l=(this.prefixChar||"").length;o=o.replace(this._prefix,""),e-=l;let h=o.charAt(e);if(this.isNumeralChar(h))return e+l;let g=e-1;for(;g>=0;){if(h=o.charAt(g),this.isNumeralChar(h)){s=g+l;break}g--}if(null!==s)this.input.nativeElement.setSelectionRange(s+1,s+1);else{for(g=e;g<r;){if(h=o.charAt(g),this.isNumeralChar(h)){s=g+l;break}g++}null!==s&&this.input.nativeElement.setSelectionRange(s,s)}return s||0}onInputClick(){!this.readonly&&this.input.nativeElement.value!==Fe.getSelection()&&this.initCursor()}isNumeralChar(e){return!(1!==e.length||!(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))||(this.resetRegex(),0))}resetRegex(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0}updateValue(e,o,r,s){let l=this.input.nativeElement.value,h=null;null!=o&&(h=this.parseValue(o),h=h||this.allowEmpty?h:0,this.updateInput(h,r,s,o),this.handleOnInput(e,l,h))}handleOnInput(e,o,r){this.isValueChanged(o,r)&&this.onInput.emit({originalEvent:e,value:r,formattedValue:o})}isValueChanged(e,o){return null===o&&null!==e||null!=o&&o!==("string"==typeof e?this.parseValue(e):e)}validateValue(e){return"-"===e||null==e?null:null!=this.min&&e<this.min?this.min:null!=this.max&&e>this.max?this.max:e}updateInput(e,o,r,s){o=o||"";let l=this.input.nativeElement.value,h=this.formatValue(e),g=l.length;if(h!==s&&(h=this.concatValues(h,s)),0===g){this.input.nativeElement.value=h,this.input.nativeElement.setSelectionRange(0,0);const T=this.initCursor()+o.length;this.input.nativeElement.setSelectionRange(T,T)}else{let b=this.input.nativeElement.selectionStart,T=this.input.nativeElement.selectionEnd;if(this.maxlength&&this.maxlength<h.length)return;this.input.nativeElement.value=h;let I=h.length;if("range-insert"===r){const R=this.parseValue((l||"").slice(0,b)),W=(null!==R?R.toString():"").split("").join(`(${this.groupChar})?`),X=new RegExp(W,"g");X.test(h);const ee=o.split("").join(`(${this.groupChar})?`),le=new RegExp(ee,"g");le.test(h.slice(X.lastIndex)),T=X.lastIndex+le.lastIndex,this.input.nativeElement.setSelectionRange(T,T)}else if(I===g)"insert"===r||"delete-back-single"===r?this.input.nativeElement.setSelectionRange(T+1,T+1):"delete-single"===r?this.input.nativeElement.setSelectionRange(T-1,T-1):("delete-range"===r||"spin"===r)&&this.input.nativeElement.setSelectionRange(T,T);else if("delete-back-single"===r){let R=l.charAt(T-1),z=l.charAt(T),W=g-I,X=this._group.test(z);X&&1===W?T+=1:!X&&this.isNumeralChar(R)&&(T+=-1*W+1),this._group.lastIndex=0,this.input.nativeElement.setSelectionRange(T,T)}else if("-"===l&&"insert"===r){this.input.nativeElement.setSelectionRange(0,0);const z=this.initCursor()+o.length+1;this.input.nativeElement.setSelectionRange(z,z)}else T+=I-g,this.input.nativeElement.setSelectionRange(T,T)}this.input.nativeElement.setAttribute("aria-valuenow",e)}concatValues(e,o){if(e&&o){let r=o.search(this._decimal);return this._decimal.lastIndex=0,this.suffixChar?e.replace(this.suffixChar,"").split(this._decimal)[0]+o.replace(this.suffixChar,"").slice(r)+this.suffixChar:-1!==r?e.split(this._decimal)[0]+o.slice(r):e}return e}getDecimalLength(e){if(e){const o=e.split(this._decimal);if(2===o.length)return o[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1;let o=this.validateValue(this.parseValue(this.input.nativeElement.value));this.input.nativeElement.value=this.formatValue(o),this.input.nativeElement.setAttribute("aria-valuenow",o),this.updateModel(e,o),this.onBlur.emit(e)}formattedValue(){return this.formatValue(this.value||this.allowEmpty?this.value:0)}updateModel(e,o){this.value!==o&&(this.value=o,this.onModelChange(o)),this.onModelTouched()}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}get filled(){return null!=this.value&&this.value.toString().length>0}clearTimer(){this.timer&&clearInterval(this.timer)}getFormatter(){return this.numberFormat}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(Po))},t.\u0275cmp=on({type:t,selectors:[["p-inputNumber"]],viewQuery:function(e,o){if(1&e&&pi(XZ,5),2&e){let r;mn(r=gn())&&(o.input=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,o){2&e&&Mo("p-inputwrapper-filled",o.filled)("p-inputwrapper-focus",o.focused)("p-inputnumber-clearable",o.showClear&&"vertical"!=o.buttonLayout)},inputs:{showButtons:"showButtons",format:"format",buttonLayout:"buttonLayout",inputId:"inputId",styleClass:"styleClass",style:"style",placeholder:"placeholder",size:"size",maxlength:"maxlength",tabindex:"tabindex",title:"title",ariaLabel:"ariaLabel",ariaRequired:"ariaRequired",name:"name",required:"required",autocomplete:"autocomplete",min:"min",max:"max",incrementButtonClass:"incrementButtonClass",decrementButtonClass:"decrementButtonClass",incrementButtonIcon:"incrementButtonIcon",decrementButtonIcon:"decrementButtonIcon",readonly:"readonly",step:"step",allowEmpty:"allowEmpty",locale:"locale",localeMatcher:"localeMatcher",mode:"mode",currency:"currency",currencyDisplay:"currencyDisplay",useGrouping:"useGrouping",minFractionDigits:"minFractionDigits",maxFractionDigits:"maxFractionDigits",prefix:"prefix",suffix:"suffix",inputStyle:"inputStyle",inputStyleClass:"inputStyleClass",showClear:"showClear",disabled:"disabled"},outputs:{onInput:"onInput",onFocus:"onFocus",onBlur:"onBlur",onKeyDown:"onKeyDown",onClear:"onClear"},features:[Wi([nK]),ur],decls:7,vars:32,consts:[[3,"ngClass","ngStyle"],["pInputText","","inputmode","decimal",3,"ngClass","ngStyle","value","disabled","readonly","input","keydown","keypress","paste","click","focus","blur"],["input",""],["class","p-inputnumber-clear-icon pi pi-times",3,"click",4,"ngIf"],["class","p-inputnumber-button-group",4,"ngIf"],["type","button","pButton","","tabindex","-1",3,"ngClass","class","icon","disabled","mousedown","mouseup","mouseleave","keydown","keyup",4,"ngIf"],[1,"p-inputnumber-clear-icon","pi","pi-times",3,"click"],[1,"p-inputnumber-button-group"],["type","button","pButton","","tabindex","-1",3,"ngClass","icon","disabled","mousedown","mouseup","mouseleave","keydown","keyup"]],template:function(e,o){1&e&&(F(0,"span",0)(1,"input",1,2),Oe("input",function(s){return o.onUserInput(s)})("keydown",function(s){return o.onInputKeyDown(s)})("keypress",function(s){return o.onInputKeyPress(s)})("paste",function(s){return o.onPaste(s)})("click",function(){return o.onInputClick()})("focus",function(s){return o.onInputFocus(s)})("blur",function(s){return o.onInputBlur(s)}),V(),J(3,YZ,1,0,"i",3),J(4,QZ,3,12,"span",4),J(5,JZ,1,6,"button",5),J(6,eK,1,6,"button",5),V()),2&e&&(Xn(o.styleClass),B("ngClass",$r(28,tK,o.showButtons&&"stacked"===o.buttonLayout,o.showButtons&&"horizontal"===o.buttonLayout,o.showButtons&&"vertical"===o.buttonLayout))("ngStyle",o.style),j(1),Xn(o.inputStyleClass),B("ngClass","p-inputnumber-input")("ngStyle",o.inputStyle)("value",o.formattedValue())("disabled",o.disabled)("readonly",o.readonly),st("placeholder",o.placeholder)("title",o.title)("id",o.inputId)("size",o.size)("name",o.name)("autocomplete",o.autocomplete)("maxlength",o.maxlength)("tabindex",o.tabindex)("aria-label",o.ariaLabel)("aria-required",o.ariaRequired)("required",o.required)("min",o.min)("max",o.max),j(2),B("ngIf","vertical"!=o.buttonLayout&&o.showClear&&o.value),j(1),B("ngIf",o.showButtons&&"stacked"===o.buttonLayout),j(1),B("ngIf",o.showButtons&&"stacked"!==o.buttonLayout),j(1),B("ngIf",o.showButtons&&"stacked"!==o.buttonLayout))},dependencies:[Eo,mi,Oo,fc,os],styles:["p-inputnumber,.p-inputnumber{display:inline-flex}.p-inputnumber-button{display:flex;align-items:center;justify-content:center;flex:0 0 auto}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label{display:none}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up{border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-input{border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down{border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-button-group{display:flex;flex-direction:column}.p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button{flex:1 1 auto}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up{order:3;border-top-left-radius:0;border-bottom-left-radius:0}.p-inputnumber-buttons-horizontal .p-inputnumber-input{order:2;border-radius:0}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down{order:1;border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-vertical{flex-direction:column}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up{order:1;border-bottom-left-radius:0;border-bottom-right-radius:0;width:100%}.p-inputnumber-buttons-vertical .p-inputnumber-input{order:2;border-radius:0;text-align:center}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down{order:3;border-top-left-radius:0;border-top-right-radius:0;width:100%}.p-inputnumber-input{flex:1 1 auto}.p-fluid p-inputnumber,.p-fluid .p-inputnumber{width:100%}.p-fluid .p-inputnumber .p-inputnumber-input{width:1%}.p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input{width:100%}.p-inputnumber-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-inputnumber-clearable{position:relative}\n"],encapsulation:2,changeDetection:0}),t})(),XD=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,Zb,pu]}),t})();function iK(t,n){1&t&&Ht(0)}const YD=function(t){return{$implicit:t}};function oK(t,n){if(1&t&&(F(0,"div",15),J(1,iK,1,0,"ng-container",16),V()),2&t){const e=q(2);j(1),B("ngTemplateOutlet",e.templateLeft)("ngTemplateOutletContext",An(2,YD,e.paginatorState))}}function rK(t,n){if(1&t&&(F(0,"span",17),ce(1),V()),2&t){const e=q(2);j(1),Jt(e.currentPageReport)}}const Hw=function(t){return{"p-disabled":t}};function sK(t,n){if(1&t){const e=xt();F(0,"button",18),Oe("click",function(r){return Ie(e),Me(q(2).changePageToFirst(r))}),Ne(1,"span",19),V()}if(2&t){const e=q(2);B("disabled",e.isFirstPage()||e.empty())("ngClass",An(2,Hw,e.isFirstPage()||e.empty()))}}const aK=function(t){return{"p-highlight":t}};function lK(t,n){if(1&t){const e=xt();F(0,"button",22),Oe("click",function(r){const l=Ie(e).$implicit;return Me(q(3).onPageLinkClick(r,l-1))}),ce(1),V()}if(2&t){const e=n.$implicit,o=q(3);B("ngClass",An(2,aK,e-1==o.getPage())),j(1),ei(" ",e," ")}}function cK(t,n){if(1&t&&(F(0,"span",20),J(1,lK,2,4,"button",21),V()),2&t){const e=q(2);j(1),B("ngForOf",e.pageLinks)}}function uK(t,n){1&t&&ce(0),2&t&&Jt(q(3).currentPageReport)}function dK(t,n){if(1&t){const e=xt();F(0,"p-dropdown",23),Oe("onChange",function(r){return Ie(e),Me(q(2).onPageDropdownChange(r))}),J(1,uK,1,1,"ng-template",24),V()}if(2&t){const e=q(2);B("options",e.pageItems)("ngModel",e.getPage())("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight)}}function hK(t,n){if(1&t){const e=xt();F(0,"button",25),Oe("click",function(r){return Ie(e),Me(q(2).changePageToLast(r))}),Ne(1,"span",26),V()}if(2&t){const e=q(2);B("disabled",e.isLastPage()||e.empty())("ngClass",An(2,Hw,e.isLastPage()||e.empty()))}}function pK(t,n){if(1&t){const e=xt();F(0,"p-inputNumber",27),Oe("ngModelChange",function(r){return Ie(e),Me(q(2).changePage(r-1))}),V()}if(2&t){const e=q(2);B("ngModel",e.currentPage())("disabled",e.empty())}}function fK(t,n){1&t&&Ht(0)}function mK(t,n){if(1&t&&J(0,fK,1,0,"ng-container",16),2&t){const e=n.$implicit;B("ngTemplateOutlet",q(4).dropdownItemTemplate)("ngTemplateOutletContext",An(2,YD,e))}}function gK(t,n){1&t&&(xn(0),J(1,mK,1,4,"ng-template",30),In())}function _K(t,n){if(1&t){const e=xt();F(0,"p-dropdown",28),Oe("ngModelChange",function(r){return Ie(e),Me(q(2).rows=r)})("onChange",function(r){return Ie(e),Me(q(2).onRppChange(r))}),J(1,gK,2,0,"ng-container",29),V()}if(2&t){const e=q(2);B("options",e.rowsPerPageItems)("ngModel",e.rows)("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight),j(1),B("ngIf",e.dropdownItemTemplate)}}function yK(t,n){1&t&&Ht(0)}function vK(t,n){if(1&t&&(F(0,"div",31),J(1,yK,1,0,"ng-container",16),V()),2&t){const e=q(2);j(1),B("ngTemplateOutlet",e.templateRight)("ngTemplateOutletContext",An(2,YD,e.paginatorState))}}function bK(t,n){if(1&t){const e=xt();F(0,"div",1),J(1,oK,2,4,"div",2),J(2,rK,2,1,"span",3),J(3,sK,2,4,"button",4),F(4,"button",5),Oe("click",function(r){return Ie(e),Me(q().changePageToPrev(r))}),Ne(5,"span",6),V(),J(6,cK,2,1,"span",7),J(7,dK,2,5,"p-dropdown",8),F(8,"button",9),Oe("click",function(r){return Ie(e),Me(q().changePageToNext(r))}),Ne(9,"span",10),V(),J(10,hK,2,4,"button",11),J(11,pK,1,2,"p-inputNumber",12),J(12,_K,2,6,"p-dropdown",13),J(13,vK,2,4,"div",14),V()}if(2&t){const e=q();Xn(e.styleClass),B("ngStyle",e.style)("ngClass","p-paginator p-component"),j(1),B("ngIf",e.templateLeft),j(1),B("ngIf",e.showCurrentPageReport),j(1),B("ngIf",e.showFirstLastIcon),j(1),B("disabled",e.isFirstPage()||e.empty())("ngClass",An(17,Hw,e.isFirstPage()||e.empty())),j(2),B("ngIf",e.showPageLinks),j(1),B("ngIf",e.showJumpToPageDropdown),j(1),B("disabled",e.isLastPage()||e.empty())("ngClass",An(19,Hw,e.isLastPage()||e.empty())),j(2),B("ngIf",e.showFirstLastIcon),j(1),B("ngIf",e.showJumpToPageInput),j(1),B("ngIf",e.rowsPerPageOptions),j(1),B("ngIf",e.templateRight)}}let oF=(()=>{class t{constructor(e){this.cd=e,this.pageLinkSize=5,this.onPageChange=new Tt,this.alwaysShow=!0,this.dropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.totalRecords=0,this.rows=0,this.showPageLinks=!0,this._first=0,this._page=0}ngOnInit(){this.updatePaginatorState()}ngOnChanges(e){e.totalRecords&&(this.updatePageLinks(),this.updatePaginatorState(),this.updateFirst(),this.updateRowsPerPageOptions()),e.first&&(this._first=e.first.currentValue,this.updatePageLinks(),this.updatePaginatorState()),e.rows&&(this.updatePageLinks(),this.updatePaginatorState()),e.rowsPerPageOptions&&this.updateRowsPerPageOptions()}get first(){return this._first}set first(e){this._first=e}updateRowsPerPageOptions(){if(this.rowsPerPageOptions){this.rowsPerPageItems=[];for(let e of this.rowsPerPageOptions)"object"==typeof e&&e.showAll?this.rowsPerPageItems.unshift({label:e.showAll,value:this.totalRecords}):this.rowsPerPageItems.push({label:String(e),value:e})}}isFirstPage(){return 0===this.getPage()}isLastPage(){return this.getPage()===this.getPageCount()-1}getPageCount(){return Math.ceil(this.totalRecords/this.rows)}calculatePageLinkBoundaries(){let e=this.getPageCount(),o=Math.min(this.pageLinkSize,e),r=Math.max(0,Math.ceil(this.getPage()-o/2)),s=Math.min(e-1,r+o-1);return r=Math.max(0,r-(this.pageLinkSize-(s-r+1))),[r,s]}updatePageLinks(){this.pageLinks=[];let e=this.calculatePageLinkBoundaries(),r=e[1];for(let s=e[0];s<=r;s++)this.pageLinks.push(s+1);if(this.showJumpToPageDropdown){this.pageItems=[];for(let s=0;s<this.getPageCount();s++)this.pageItems.push({label:String(s+1),value:s})}}changePage(e){var o=this.getPageCount();if(e>=0&&e<o){this._first=this.rows*e;var r={page:e,first:this.first,rows:this.rows,pageCount:o};this.updatePageLinks(),this.onPageChange.emit(r),this.updatePaginatorState()}}updateFirst(){const e=this.getPage();e>0&&this.totalRecords&&this.first>=this.totalRecords&&Promise.resolve(null).then(()=>this.changePage(e-1))}getPage(){return Math.floor(this.first/this.rows)}changePageToFirst(e){this.isFirstPage()||this.changePage(0),e.preventDefault()}changePageToPrev(e){this.changePage(this.getPage()-1),e.preventDefault()}changePageToNext(e){this.changePage(this.getPage()+1),e.preventDefault()}changePageToLast(e){this.isLastPage()||this.changePage(this.getPageCount()-1),e.preventDefault()}onPageLinkClick(e,o){this.changePage(o),e.preventDefault()}onRppChange(e){this.changePage(this.getPage())}onPageDropdownChange(e){this.changePage(e.value)}updatePaginatorState(){this.paginatorState={page:this.getPage(),pageCount:this.getPageCount(),rows:this.rows,first:this.first,totalRecords:this.totalRecords}}empty(){return 0===this.getPageCount()}currentPage(){return this.getPageCount()>0?this.getPage()+1:0}get currentPageReport(){return this.currentPageReportTemplate.replace("{currentPage}",String(this.currentPage())).replace("{totalPages}",String(this.getPageCount())).replace("{first}",String(this.totalRecords>0?this._first+1:0)).replace("{last}",String(Math.min(this._first+this.rows,this.totalRecords))).replace("{rows}",String(this.rows)).replace("{totalRecords}",String(this.totalRecords))}}return t.\u0275fac=function(e){return new(e||t)(be(Po))},t.\u0275cmp=on({type:t,selectors:[["p-paginator"]],hostAttrs:[1,"p-element"],inputs:{pageLinkSize:"pageLinkSize",style:"style",styleClass:"styleClass",alwaysShow:"alwaysShow",templateLeft:"templateLeft",templateRight:"templateRight",dropdownAppendTo:"dropdownAppendTo",dropdownScrollHeight:"dropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showFirstLastIcon:"showFirstLastIcon",totalRecords:"totalRecords",rows:"rows",rowsPerPageOptions:"rowsPerPageOptions",showJumpToPageDropdown:"showJumpToPageDropdown",showJumpToPageInput:"showJumpToPageInput",showPageLinks:"showPageLinks",dropdownItemTemplate:"dropdownItemTemplate",first:"first"},outputs:{onPageChange:"onPageChange"},features:[ur],decls:1,vars:1,consts:[[3,"class","ngStyle","ngClass",4,"ngIf"],[3,"ngStyle","ngClass"],["class","p-paginator-left-content",4,"ngIf"],["class","p-paginator-current",4,"ngIf"],["type","button","pRipple","","class","p-paginator-first p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-prev","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-left"],["class","p-paginator-pages",4,"ngIf"],["styleClass","p-paginator-page-options",3,"options","ngModel","disabled","appendTo","scrollHeight","onChange",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-next","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-right"],["type","button","pRipple","","class","p-paginator-last p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["class","p-paginator-page-input",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["styleClass","p-paginator-rpp-options",3,"options","ngModel","disabled","appendTo","scrollHeight","ngModelChange","onChange",4,"ngIf"],["class","p-paginator-right-content",4,"ngIf"],[1,"p-paginator-left-content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-paginator-current"],["type","button","pRipple","",1,"p-paginator-first","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-double-left"],[1,"p-paginator-pages"],["type","button","class","p-paginator-page p-paginator-element p-link","pRipple","",3,"ngClass","click",4,"ngFor","ngForOf"],["type","button","pRipple","",1,"p-paginator-page","p-paginator-element","p-link",3,"ngClass","click"],["styleClass","p-paginator-page-options",3,"options","ngModel","disabled","appendTo","scrollHeight","onChange"],["pTemplate","selectedItem"],["type","button","pRipple","",1,"p-paginator-last","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-double-right"],[1,"p-paginator-page-input",3,"ngModel","disabled","ngModelChange"],["styleClass","p-paginator-rpp-options",3,"options","ngModel","disabled","appendTo","scrollHeight","ngModelChange","onChange"],[4,"ngIf"],["pTemplate","item"],[1,"p-paginator-right-content"]],template:function(e,o){1&e&&J(0,bK,14,21,"div",0),2&e&&B("ngIf",!!o.alwaysShow||o.pageLinks&&o.pageLinks.length>1)},dependencies:[Eo,Ms,mi,Is,Oo,KD,_o,iF,Tl,hd,vd],styles:[".p-paginator{display:flex;align-items:center;justify-content:center;flex-wrap:wrap}.p-paginator-left-content{margin-right:auto}.p-paginator-right-content{margin-left:auto}.p-paginator-page,.p-paginator-next,.p-paginator-last,.p-paginator-first,.p-paginator-prev,.p-paginator-current{cursor:pointer;display:inline-flex;align-items:center;justify-content:center;line-height:1;-webkit-user-select:none;user-select:none;overflow:hidden;position:relative}.p-paginator-element:focus{z-index:1;position:relative}\n"],encapsulation:2,changeDetection:0}),t})(),rF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,uy,XD,$_,is,il,uy,XD,$_,is]}),t})();function xK(t,n){1&t&&Ne(0,"span",8),2&t&&(Xn(q(2).$implicit.icon),B("ngClass","p-button-icon p-button-icon-left"))}function wK(t,n){if(1&t&&(xn(0),J(1,xK,1,3,"span",6),F(2,"span",7),ce(3),V(),In()),2&t){const e=q().$implicit,o=q();j(1),B("ngIf",e.icon),j(2),Jt(o.getOptionLabel(e))}}function CK(t,n){1&t&&Ht(0)}const TK=function(t,n){return{$implicit:t,index:n}};function EK(t,n){if(1&t&&J(0,CK,1,0,"ng-container",9),2&t){const e=q(),o=e.$implicit,r=e.index;B("ngTemplateOutlet",q().itemTemplate)("ngTemplateOutletContext",no(2,TK,o,r))}}const SK=function(t,n,e){return{"p-highlight":t,"p-disabled":n,"p-button-icon-only":e}};function DK(t,n){if(1&t){const e=xt();F(0,"div",2,3),Oe("click",function(r){const s=Ie(e),l=s.$implicit,h=s.index;return Me(q().onItemClick(r,l,h))})("keydown.enter",function(r){const s=Ie(e),l=s.$implicit,h=s.index;return Me(q().onItemClick(r,l,h))})("blur",function(){return Ie(e),Me(q().onBlur())}),J(2,wK,4,2,"ng-container",4),J(3,EK,1,5,"ng-template",null,5,ka),V()}if(2&t){const e=n.$implicit,o=jn(4),r=q();Xn(e.styleClass),B("ngClass",$r(10,SK,r.isSelected(e),r.disabled||r.isOptionDisabled(e),e.icon&&!r.getOptionLabel(e))),st("aria-pressed",r.isSelected(e))("title",e.title)("aria-label",e.label)("tabindex",r.disabled?null:r.tabindex)("aria-labelledby",r.getOptionLabel(e)),j(2),B("ngIf",!r.itemTemplate)("ngIfElse",o)}}const MK={provide:ks,useExisting:xi(()=>QD),multi:!0};let QD=(()=>{class t{constructor(e){this.cd=e,this.tabindex=0,this.onOptionClick=new Tt,this.onChange=new Tt,this.onModelChange=()=>{},this.onModelTouched=()=>{}}getOptionLabel(e){return this.optionLabel?_n.resolveFieldData(e,this.optionLabel):null!=e.label?e.label:e}getOptionValue(e){return this.optionValue?_n.resolveFieldData(e,this.optionValue):this.optionLabel||void 0===e.value?e:e.value}isOptionDisabled(e){return this.optionDisabled?_n.resolveFieldData(e,this.optionDisabled):void 0!==e.disabled&&e.disabled}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onItemClick(e,o,r){if(!this.disabled&&!this.isOptionDisabled(o)){if(this.multiple)this.isSelected(o)?this.removeOption(o):this.value=[...this.value||[],this.getOptionValue(o)],this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value});else{let s=this.getOptionValue(o);this.value!==s&&(this.value=this.getOptionValue(o),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}))}this.onOptionClick.emit({originalEvent:e,option:o,index:r})}}onBlur(){this.onModelTouched()}removeOption(e){this.value=this.value.filter(o=>!_n.equals(o,this.getOptionValue(e),this.dataKey))}isSelected(e){let o=!1,r=this.getOptionValue(e);if(this.multiple){if(this.value&&Array.isArray(this.value))for(let s of this.value)if(_n.equals(s,r,this.dataKey)){o=!0;break}}else o=_n.equals(this.getOptionValue(e),this.value,this.dataKey);return o}}return t.\u0275fac=function(e){return new(e||t)(be(Po))},t.\u0275cmp=on({type:t,selectors:[["p-selectButton"]],contentQueries:function(e,o,r){if(1&e&&No(r,su,5),2&e){let s;mn(s=gn())&&(o.itemTemplate=s.first)}},hostAttrs:[1,"p-element"],inputs:{options:"options",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",tabindex:"tabindex",multiple:"multiple",style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy",disabled:"disabled",dataKey:"dataKey"},outputs:{onOptionClick:"onOptionClick",onChange:"onChange"},features:[Wi([MK])],decls:2,vars:5,consts:[["role","group",3,"ngClass","ngStyle"],["class","p-button p-component","role","button","pRipple","",3,"class","ngClass","click","keydown.enter","blur",4,"ngFor","ngForOf"],["role","button","pRipple","",1,"p-button","p-component",3,"ngClass","click","keydown.enter","blur"],["btn",""],[4,"ngIf","ngIfElse"],["customcontent",""],[3,"ngClass","class",4,"ngIf"],[1,"p-button-label"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){1&e&&(F(0,"div",0),J(1,DK,5,14,"div",1),V()),2&e&&(Xn(o.styleClass),B("ngClass","p-selectbutton p-buttonset p-component")("ngStyle",o.style),j(1),B("ngForOf",o.options))},dependencies:[Eo,Ms,mi,Is,Oo,vd],styles:['.p-button{margin:0;display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;align-items:center;vertical-align:bottom;text-align:center;overflow:hidden;position:relative}.p-button-label{flex:1 1 auto}.p-button-icon-right{order:1}.p-button:disabled{cursor:default}.p-button-icon-only{justify-content:center}.p-button-icon-only:after{content:"p";visibility:hidden;clip:rect(0 0 0 0);width:0}.p-button-vertical{flex-direction:column}.p-button-icon-bottom{order:2}.p-buttonset .p-button{margin:0}.p-buttonset .p-button:not(:last-child){border-right:0 none}.p-buttonset .p-button:not(:first-of-type):not(:last-of-type){border-radius:0}.p-buttonset .p-button:first-of-type{border-top-right-radius:0;border-bottom-right-radius:0}.p-buttonset .p-button:last-of-type{border-top-left-radius:0;border-bottom-left-radius:0}.p-buttonset .p-button:focus{position:relative;z-index:1}\n'],encapsulation:2,changeDetection:0}),t})(),JD=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,il]}),t})();const IK=function(t,n,e){return{"p-checkbox-label-active":t,"p-disabled":n,"p-checkbox-label-focus":e}};function kK(t,n){if(1&t){const e=xt();F(0,"label",7),Oe("click",function(r){Ie(e);const s=q(),l=jn(3);return Me(s.onClick(r,l))}),ce(1),V()}if(2&t){const e=q();B("ngClass",$r(3,IK,null!=e.value,e.disabled,e.focused)),st("for",e.inputId),j(1),Jt(e.label)}}const AK=function(t,n){return{"p-checkbox p-component":!0,"p-checkbox-disabled":t,"p-checkbox-focused":n}},PK=function(t,n,e){return{"p-highlight":t,"p-disabled":n,"p-focus":e}},OK={provide:ks,useExisting:xi(()=>RK),multi:!0};let RK=(()=>{class t{constructor(e){this.cd=e,this.checkboxTrueIcon="pi pi-check",this.checkboxFalseIcon="pi pi-times",this.onChange=new Tt,this.onModelChange=()=>{},this.onModelTouched=()=>{}}onClick(e,o){!this.disabled&&!this.readonly&&(this.toggle(e),this.focused=!0,o.focus())}onKeydown(e){32==e.keyCode&&e.preventDefault()}onKeyup(e){32==e.keyCode&&!this.readonly&&(this.toggle(e),e.preventDefault())}toggle(e){null==this.value||null==this.value?this.value=!0:1==this.value?this.value=!1:0==this.value&&(this.value=null),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value})}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}writeValue(e){this.value=e,this.cd.markForCheck()}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(be(Po))},t.\u0275cmp=on({type:t,selectors:[["p-triStateCheckbox"]],hostAttrs:[1,"p-element"],inputs:{disabled:"disabled",name:"name",ariaLabelledBy:"ariaLabelledBy",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",label:"label",readonly:"readonly",checkboxTrueIcon:"checkboxTrueIcon",checkboxFalseIcon:"checkboxFalseIcon"},outputs:{onChange:"onChange"},features:[Wi([OK])],decls:7,vars:21,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","text","inputmode","none",3,"name","readonly","disabled","keyup","keydown","focus","blur"],["input",""],["role","checkbox",1,"p-checkbox-box",3,"ngClass","click"],[1,"p-checkbox-icon",3,"ngClass"],["class","p-checkbox-label",3,"ngClass","click",4,"ngIf"],[1,"p-checkbox-label",3,"ngClass","click"]],template:function(e,o){if(1&e){const r=xt();F(0,"div",0)(1,"div",1)(2,"input",2,3),Oe("keyup",function(l){return o.onKeyup(l)})("keydown",function(l){return o.onKeydown(l)})("focus",function(){return o.onFocus()})("blur",function(){return o.onBlur()}),V()(),F(4,"div",4),Oe("click",function(l){Ie(r);const h=jn(3);return Me(o.onClick(l,h))}),Ne(5,"span",5),V()(),J(6,kK,2,7,"label",6)}2&e&&(Xn(o.styleClass),B("ngStyle",o.style)("ngClass",no(14,AK,o.disabled,o.focused)),j(2),B("name",o.name)("readonly",o.readonly)("disabled",o.disabled),st("id",o.inputId)("tabindex",o.tabindex)("aria-labelledby",o.ariaLabelledBy),j(2),B("ngClass",$r(17,PK,null!=o.value,o.disabled,o.focused)),st("aria-checked",!0===o.value),j(1),B("ngClass",!0===o.value?o.checkboxTrueIcon:!1===o.value?o.checkboxFalseIcon:""),j(1),B("ngIf",o.label))},dependencies:[Eo,mi,Oo],encapsulation:2,changeDetection:0}),t})(),LK=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();const FK=["container"],zK=["resizeHelper"],NK=["reorderIndicatorUp"],BK=["reorderIndicatorDown"],VK=["wrapper"],UK=["table"],jK=["thead"],HK=["tfoot"],$K=["scroller"];function GK(t,n){if(1&t&&(F(0,"div",15),Ne(1,"i"),V()),2&t){const e=q();j(1),Xn("p-datatable-loading-icon pi-spin "+e.loadingIcon)}}function WK(t,n){1&t&&Ht(0)}function qK(t,n){if(1&t&&(F(0,"div",16),J(1,WK,1,0,"ng-container",17),V()),2&t){const e=q();j(1),B("ngTemplateOutlet",e.captionTemplate)}}function ZK(t,n){if(1&t){const e=xt();F(0,"p-paginator",18),Oe("onPageChange",function(r){return Ie(e),Me(q().onPageChange(r))}),V()}if(2&t){const e=q();B("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)}}function KK(t,n){1&t&&Ht(0)}const sF=function(t,n){return{$implicit:t,options:n}};function XK(t,n){if(1&t&&J(0,KK,1,0,"ng-container",22),2&t){const e=n.$implicit,o=n.options;q(2),B("ngTemplateOutlet",jn(10))("ngTemplateOutletContext",no(2,sF,e,o))}}const YK=function(t){return{height:t}};function QK(t,n){if(1&t){const e=xt();F(0,"p-scroller",19,20),Oe("onLazyLoad",function(r){return Ie(e),Me(q().onLazyItemLoad(r))}),J(2,XK,1,5,"ng-template",21),V()}if(2&t){const e=q();Ao(An(15,YK,"flex"!==e.scrollHeight?e.scrollHeight:void 0)),B("items",e.processedData)("columns",e.columns)("scrollHeight","flex"!==e.scrollHeight?void 0:"100%")("itemSize",e.virtualScrollItemSize||e._virtualRowHeight)("step",e.rows)("delay",e.lazy?e.virtualScrollDelay:0)("inline",!0)("lazy",e.lazy)("loaderDisabled",!0)("showSpacer",!1)("showLoader",e.loadingBodyTemplate)("options",e.virtualScrollOptions)("autoSize",!0)}}function JK(t,n){1&t&&Ht(0)}const eX=function(t){return{columns:t}};function tX(t,n){if(1&t&&(xn(0),J(1,JK,1,0,"ng-container",22),In()),2&t){const e=q(),o=jn(10);j(1),B("ngTemplateOutlet",o)("ngTemplateOutletContext",no(4,sF,e.processedData,An(2,eX,e.columns)))}}function nX(t,n){1&t&&Ht(0)}function iX(t,n){1&t&&Ht(0)}function oX(t,n){if(1&t&&Ne(0,"tbody",31),2&t){const e=q().options,o=q();B("value",o.frozenValue)("frozenRows",!0)("pTableBody",e.columns)("pTableBodyTemplate",o.frozenBodyTemplate)("frozen",!0)}}function rX(t,n){if(1&t&&Ne(0,"tbody",32),2&t){const e=q().options;Ao("height: calc("+e.spacerStyle.height+" - "+e.rows.length*e.itemSize+"px);")}}function sX(t,n){1&t&&Ht(0)}const Xb=function(t){return{$implicit:t}};function aX(t,n){if(1&t&&(F(0,"tfoot",33,34),J(2,sX,1,0,"ng-container",22),V()),2&t){const e=q().options,o=q();j(2),B("ngTemplateOutlet",o.footerGroupedTemplate||o.footerTemplate)("ngTemplateOutletContext",An(2,Xb,e.columns))}}const lX=function(t,n,e){return{"p-datatable-table":!0,"p-datatable-scrollable-table":t,"p-datatable-resizable-table":n,"p-datatable-resizable-table-fit":e}};function cX(t,n){if(1&t&&(F(0,"table",23,24),J(2,nX,1,0,"ng-container",22),F(3,"thead",25,26),J(5,iX,1,0,"ng-container",22),V(),J(6,oX,1,5,"tbody",27),Ne(7,"tbody",28),J(8,rX,1,2,"tbody",29),J(9,aX,3,4,"tfoot",30),V()),2&t){const e=n.options,o=q();Ao(o.tableStyle),Xn(o.tableStyleClass),B("ngClass",$r(20,lX,o.scrollable,o.resizableColumns,o.resizableColumns&&"fit"===o.columnResizeMode)),st("id",o.id+"-table"),j(2),B("ngTemplateOutlet",o.colGroupTemplate)("ngTemplateOutletContext",An(24,Xb,e.columns)),j(3),B("ngTemplateOutlet",o.headerGroupedTemplate||o.headerTemplate)("ngTemplateOutletContext",An(26,Xb,e.columns)),j(1),B("ngIf",o.frozenValue||o.frozenBodyTemplate),j(1),Ao(e.contentStyle),B("ngClass",e.contentStyleClass)("value",o.dataToRender(e.rows))("pTableBody",e.columns)("pTableBodyTemplate",o.bodyTemplate)("scrollerOptions",e),j(1),B("ngIf",e.spacerStyle),j(1),B("ngIf",o.footerGroupedTemplate||o.footerTemplate)}}function uX(t,n){if(1&t){const e=xt();F(0,"p-paginator",35),Oe("onPageChange",function(r){return Ie(e),Me(q().onPageChange(r))}),V()}if(2&t){const e=q();B("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)}}function dX(t,n){1&t&&Ht(0)}function hX(t,n){if(1&t&&(F(0,"div",36),J(1,dX,1,0,"ng-container",17),V()),2&t){const e=q();j(1),B("ngTemplateOutlet",e.summaryTemplate)}}function pX(t,n){1&t&&Ne(0,"div",37,38)}function fX(t,n){1&t&&Ne(0,"span",39,40)}function mX(t,n){1&t&&Ne(0,"span",41,42)}const gX=function(t,n,e){return{"p-datatable p-component":!0,"p-datatable-hoverable-rows":t,"p-datatable-scrollable":n,"p-datatable-flex-scrollable":e}},_X=function(t){return{maxHeight:t}},yX=["pTableBody",""];function vX(t,n){1&t&&Ht(0)}const eM=function(t,n,e,o,r){return{$implicit:t,rowIndex:n,columns:e,editing:o,frozen:r}};function bX(t,n){if(1&t&&(xn(0,3),J(1,vX,1,0,"ng-container",4),In()),2&t){const e=q(),o=e.$implicit,r=e.index,s=q(2);j(1),B("ngTemplateOutlet",s.dt.groupHeaderTemplate)("ngTemplateOutletContext",Xv(2,eM,o,s.getRowIndex(r),s.columns,"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function xX(t,n){1&t&&Ht(0)}function wX(t,n){if(1&t&&(xn(0),J(1,xX,1,0,"ng-container",4),In()),2&t){const e=q(),o=e.$implicit,r=e.index,s=q(2);j(1),B("ngTemplateOutlet",o?s.template:s.dt.loadingBodyTemplate)("ngTemplateOutletContext",Xv(2,eM,o,s.getRowIndex(r),s.columns,"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function CX(t,n){1&t&&Ht(0)}const TX=function(t,n,e,o,r,s,l){return{$implicit:t,rowIndex:n,columns:e,editing:o,frozen:r,rowgroup:s,rowspan:l}};function EX(t,n){if(1&t&&(xn(0),J(1,CX,1,0,"ng-container",4),In()),2&t){const e=q(),o=e.$implicit,r=e.index,s=q(2);j(1),B("ngTemplateOutlet",o?s.template:s.dt.loadingBodyTemplate)("ngTemplateOutletContext",oE(2,TX,o,s.getRowIndex(r),s.columns,"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen,s.shouldRenderRowspan(s.value,o,r),s.calculateRowGroupSize(s.value,o,r)))}}function SX(t,n){1&t&&Ht(0)}function DX(t,n){if(1&t&&(xn(0,3),J(1,SX,1,0,"ng-container",4),In()),2&t){const e=q(),o=e.$implicit,r=e.index,s=q(2);j(1),B("ngTemplateOutlet",s.dt.groupFooterTemplate)("ngTemplateOutletContext",Xv(2,eM,o,s.getRowIndex(r),s.columns,"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function MX(t,n){if(1&t&&(J(0,bX,2,8,"ng-container",2),J(1,wX,2,8,"ng-container",0),J(2,EX,2,10,"ng-container",0),J(3,DX,2,8,"ng-container",2)),2&t){const e=n.$implicit,o=n.index,r=q(2);B("ngIf",r.dt.groupHeaderTemplate&&!r.dt.virtualScroll&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupHeader(r.value,e,o)),j(1),B("ngIf","rowspan"!==r.dt.rowGroupMode),j(1),B("ngIf","rowspan"===r.dt.rowGroupMode),j(1),B("ngIf",r.dt.groupFooterTemplate&&!r.dt.virtualScroll&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupFooter(r.value,e,o))}}function IX(t,n){if(1&t&&(xn(0),J(1,MX,4,4,"ng-template",1),In()),2&t){const e=q();j(1),B("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function kX(t,n){1&t&&Ht(0)}const $w=function(t,n,e,o,r,s){return{$implicit:t,rowIndex:n,columns:e,expanded:o,editing:r,frozen:s}};function AX(t,n){if(1&t&&(xn(0),J(1,kX,1,0,"ng-container",4),In()),2&t){const e=q(),o=e.$implicit,r=e.index,s=q(2);j(1),B("ngTemplateOutlet",s.template)("ngTemplateOutletContext",z_(2,$w,o,s.getRowIndex(r),s.columns,s.dt.isRowExpanded(o),"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function PX(t,n){1&t&&Ht(0)}function OX(t,n){if(1&t&&(xn(0,3),J(1,PX,1,0,"ng-container",4),In()),2&t){const e=q(),o=e.$implicit,r=e.index,s=q(2);j(1),B("ngTemplateOutlet",s.dt.groupHeaderTemplate)("ngTemplateOutletContext",z_(2,$w,o,s.getRowIndex(r),s.columns,s.dt.isRowExpanded(o),"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function RX(t,n){1&t&&Ht(0)}function LX(t,n){1&t&&Ht(0)}function FX(t,n){if(1&t&&(xn(0,3),J(1,LX,1,0,"ng-container",4),In()),2&t){const e=q(2),o=e.$implicit,r=e.index,s=q(2);j(1),B("ngTemplateOutlet",s.dt.groupFooterTemplate)("ngTemplateOutletContext",z_(2,$w,o,s.getRowIndex(r),s.columns,s.dt.isRowExpanded(o),"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}const aF=function(t,n,e,o){return{$implicit:t,rowIndex:n,columns:e,frozen:o}};function zX(t,n){if(1&t&&(xn(0),J(1,RX,1,0,"ng-container",4),J(2,FX,2,9,"ng-container",2),In()),2&t){const e=q(),o=e.$implicit,r=e.index,s=q(2);j(1),B("ngTemplateOutlet",s.dt.expandedRowTemplate)("ngTemplateOutletContext",Th(3,aF,o,s.getRowIndex(r),s.columns,s.frozen)),j(1),B("ngIf",s.dt.groupFooterTemplate&&"subheader"===s.dt.rowGroupMode&&s.shouldRenderRowGroupFooter(s.value,o,s.getRowIndex(r)))}}function NX(t,n){if(1&t&&(J(0,AX,2,9,"ng-container",0),J(1,OX,2,9,"ng-container",2),J(2,zX,3,8,"ng-container",0)),2&t){const e=n.$implicit,o=n.index,r=q(2);B("ngIf",!r.dt.groupHeaderTemplate),j(1),B("ngIf",r.dt.groupHeaderTemplate&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupHeader(r.value,e,r.getRowIndex(o))),j(1),B("ngIf",r.dt.isRowExpanded(e))}}function BX(t,n){if(1&t&&(xn(0),J(1,NX,3,3,"ng-template",1),In()),2&t){const e=q();j(1),B("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function VX(t,n){1&t&&Ht(0)}function UX(t,n){1&t&&Ht(0)}function jX(t,n){if(1&t&&(xn(0),J(1,UX,1,0,"ng-container",4),In()),2&t){const e=q(),o=e.$implicit,r=e.index,s=q(2);j(1),B("ngTemplateOutlet",s.dt.frozenExpandedRowTemplate)("ngTemplateOutletContext",Th(2,aF,o,s.getRowIndex(r),s.columns,s.frozen))}}function HX(t,n){if(1&t&&(J(0,VX,1,0,"ng-container",4),J(1,jX,2,7,"ng-container",0)),2&t){const e=n.$implicit,o=n.index,r=q(2);B("ngTemplateOutlet",r.template)("ngTemplateOutletContext",z_(3,$w,e,r.getRowIndex(o),r.columns,r.dt.isRowExpanded(e),"row"===r.dt.editMode&&r.dt.isRowEditing(e),r.frozen)),j(1),B("ngIf",r.dt.isRowExpanded(e))}}function $X(t,n){if(1&t&&(xn(0),J(1,HX,2,10,"ng-template",1),In()),2&t){const e=q();j(1),B("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function GX(t,n){1&t&&Ht(0)}const lF=function(t,n){return{$implicit:t,frozen:n}};function WX(t,n){if(1&t&&(xn(0),J(1,GX,1,0,"ng-container",4),In()),2&t){const e=q();j(1),B("ngTemplateOutlet",e.dt.loadingBodyTemplate)("ngTemplateOutletContext",no(2,lF,e.columns,e.frozen))}}function qX(t,n){1&t&&Ht(0)}function ZX(t,n){if(1&t&&(xn(0),J(1,qX,1,0,"ng-container",4),In()),2&t){const e=q();j(1),B("ngTemplateOutlet",e.dt.emptyMessageTemplate)("ngTemplateOutletContext",no(2,lF,e.columns,e.frozen))}}function KX(t,n){if(1&t&&(F(0,"span",2),ce(1),V()),2&t){const e=q();j(1),Jt(e.getBadgeValue())}}const XX=function(t,n,e){return{"pi-sort-amount-up-alt":t,"pi-sort-amount-down":n,"pi-sort-alt":e}};let Gw=(()=>{class t{constructor(){this.sortSource=new gi,this.selectionSource=new gi,this.contextMenuSource=new gi,this.valueSource=new gi,this.totalRecordsSource=new gi,this.columnsSource=new gi,this.resetSource=new gi,this.sortSource$=this.sortSource.asObservable(),this.selectionSource$=this.selectionSource.asObservable(),this.contextMenuSource$=this.contextMenuSource.asObservable(),this.valueSource$=this.valueSource.asObservable(),this.totalRecordsSource$=this.totalRecordsSource.asObservable(),this.columnsSource$=this.columnsSource.asObservable(),this.resetSource$=this.resetSource.asObservable()}onSort(e){this.sortSource.next(e)}onSelectionChange(){this.selectionSource.next(null)}onResetChange(){this.resetSource.next(null)}onContextMenu(e){this.contextMenuSource.next(e)}onValueChange(e){this.valueSource.next(e)}onTotalRecordsChange(e){this.totalRecordsSource.next(e)}onColumnsChange(e){this.columnsSource.next(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=an({token:t,factory:t.\u0275fac}),t})(),bd=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.zone=o,this.tableService=r,this.cd=s,this.filterService=l,this.overlayService=h,this.pageLinks=5,this.alwaysShowPaginator=!0,this.paginatorPosition="bottom",this.paginatorDropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.showPageLinks=!0,this.defaultSortOrder=1,this.sortMode="single",this.resetPageOnSort=!0,this.selectAllChange=new Tt,this.selectionChange=new Tt,this.contextMenuSelectionChange=new Tt,this.contextMenuSelectionMode="separate",this.rowTrackBy=(g,b)=>b,this.lazy=!1,this.lazyLoadOnInit=!0,this.compareSelectionBy="deepEquals",this.csvSeparator=",",this.exportFilename="download",this.filters={},this.filterDelay=300,this.expandedRowKeys={},this.editingRowKeys={},this.rowExpandMode="multiple",this.scrollDirection="vertical",this.virtualScrollDelay=250,this.columnResizeMode="fit",this.loadingIcon="pi pi-spinner",this.showLoader=!0,this.showInitialSortBadge=!0,this.stateStorage="session",this.editMode="cell",this.groupRowsByOrder=1,this.responsiveLayout="scroll",this.breakpoint="960px",this.onRowSelect=new Tt,this.onRowUnselect=new Tt,this.onPage=new Tt,this.onSort=new Tt,this.onFilter=new Tt,this.onLazyLoad=new Tt,this.onRowExpand=new Tt,this.onRowCollapse=new Tt,this.onContextMenuSelect=new Tt,this.onColResize=new Tt,this.onColReorder=new Tt,this.onRowReorder=new Tt,this.onEditInit=new Tt,this.onEditComplete=new Tt,this.onEditCancel=new Tt,this.onHeaderCheckboxToggle=new Tt,this.sortFunction=new Tt,this.firstChange=new Tt,this.rowsChange=new Tt,this.onStateSave=new Tt,this.onStateRestore=new Tt,this._virtualRowHeight=28,this._value=[],this._totalRecords=0,this._first=0,this.selectionKeys={},this._sortOrder=1,this._selectAll=null,this.columnResizing=!1,this.rowGroupHeaderStyleObject={},this.id=cy()}get responsive(){return this._responsive}set responsive(e){this._responsive=e,console.warn("responsive propery is deprecated as table is always responsive with scrollable behavior.")}get virtualRowHeight(){return this._virtualRowHeight}set virtualRowHeight(e){this._virtualRowHeight=e,console.warn("The virtualRowHeight property is deprecated, use virtualScrollItemSize property instead.")}ngOnInit(){this.lazy&&this.lazyLoadOnInit&&(this.virtualScroll||this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.restoringFilter&&(this.restoringFilter=!1)),"stack"===this.responsiveLayout&&!this.scrollable&&this.createResponsiveStyle(),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"caption":this.captionTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"headergrouped":this.headerGroupedTemplate=e.template;break;case"body":this.bodyTemplate=e.template;break;case"loadingbody":this.loadingBodyTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"footergrouped":this.footerGroupedTemplate=e.template;break;case"summary":this.summaryTemplate=e.template;break;case"colgroup":this.colGroupTemplate=e.template;break;case"rowexpansion":this.expandedRowTemplate=e.template;break;case"groupheader":this.groupHeaderTemplate=e.template;break;case"rowspan":this.rowspanTemplate=e.template;break;case"groupfooter":this.groupFooterTemplate=e.template;break;case"frozenrows":this.frozenRowsTemplate=e.template;break;case"frozenheader":this.frozenHeaderTemplate=e.template;break;case"frozenbody":this.frozenBodyTemplate=e.template;break;case"frozenfooter":this.frozenFooterTemplate=e.template;break;case"frozencolgroup":this.frozenColGroupTemplate=e.template;break;case"frozenrowexpansion":this.frozenExpandedRowTemplate=e.template;break;case"emptymessage":this.emptyMessageTemplate=e.template;break;case"paginatorleft":this.paginatorLeftTemplate=e.template;break;case"paginatorright":this.paginatorRightTemplate=e.template;break;case"paginatordropdownitem":this.paginatorDropdownItemTemplate=e.template}})}ngAfterViewInit(){this.isStateful()&&this.resizableColumns&&this.restoreColumnWidths()}ngOnChanges(e){e.value&&(this.isStateful()&&!this.stateRestored&&this.restoreState(),this._value=e.value.currentValue,this.lazy||(this.totalRecords=this._value?this._value.length:0,"single"==this.sortMode&&(this.sortField||this.groupRowsBy)?this.sortSingle():"multiple"==this.sortMode&&(this.multiSortMeta||this.groupRowsBy)?this.sortMultiple():this.hasFilter()&&this._filter()),this.tableService.onValueChange(e.value.currentValue)),e.columns&&(this._columns=e.columns.currentValue,this.tableService.onColumnsChange(e.columns.currentValue),this._columns&&this.isStateful()&&this.reorderableColumns&&!this.columnOrderStateRestored&&this.restoreColumnOrder()),e.sortField&&(this._sortField=e.sortField.currentValue,(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle()),e.groupRowsBy&&(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle(),e.sortOrder&&(this._sortOrder=e.sortOrder.currentValue,(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle()),e.groupRowsByOrder&&(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle(),e.multiSortMeta&&(this._multiSortMeta=e.multiSortMeta.currentValue,"multiple"===this.sortMode&&(this.initialized||!this.lazy&&!this.virtualScroll)&&this.sortMultiple()),e.selection&&(this._selection=e.selection.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange()),this.preventSelectionSetterPropagation=!1),e.selectAll&&(this._selectAll=e.selectAll.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()),this.preventSelectionSetterPropagation=!1)}get value(){return this._value}set value(e){this._value=e}get columns(){return this._columns}set columns(e){this._columns=e}get first(){return this._first}set first(e){this._first=e}get rows(){return this._rows}set rows(e){this._rows=e}get totalRecords(){return this._totalRecords}set totalRecords(e){this._totalRecords=e,this.tableService.onTotalRecordsChange(this._totalRecords)}get sortField(){return this._sortField}set sortField(e){this._sortField=e}get sortOrder(){return this._sortOrder}set sortOrder(e){this._sortOrder=e}get multiSortMeta(){return this._multiSortMeta}set multiSortMeta(e){this._multiSortMeta=e}get selection(){return this._selection}set selection(e){this._selection=e}get selectAll(){return this._selection}set selectAll(e){this._selection=e}get processedData(){return this.filteredValue||this.value||[]}dataToRender(e){const o=e||this.processedData;if(o&&this.paginator){const r=this.lazy?0:this.first;return o.slice(r,r+this.rows)}return o}updateSelectionKeys(){if(this.dataKey&&this._selection)if(this.selectionKeys={},Array.isArray(this._selection))for(let e of this._selection)this.selectionKeys[String(_n.resolveFieldData(e,this.dataKey))]=1;else this.selectionKeys[String(_n.resolveFieldData(this._selection,this.dataKey))]=1}onPageChange(e){this.first=e.first,this.rows=e.rows,this.onPage.emit({first:this.first,rows:this.rows}),this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.firstChange.emit(this.first),this.rowsChange.emit(this.rows),this.tableService.onValueChange(this.value),this.isStateful()&&this.saveState(),this.anchorRowIndex=null,this.scrollable&&this.resetScrollTop()}sort(e){let o=e.originalEvent;if("single"===this.sortMode&&(this._sortOrder=this.sortField===e.field?-1*this.sortOrder:this.defaultSortOrder,this._sortField=e.field,this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop()),this.sortSingle()),"multiple"===this.sortMode){let r=o.metaKey||o.ctrlKey,s=this.getSortMeta(e.field);s?r?s.order=-1*s.order:(this._multiSortMeta=[{field:e.field,order:-1*s.order}],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop())):((!r||!this.multiSortMeta)&&(this._multiSortMeta=[],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first))),this._multiSortMeta.push({field:e.field,order:this.defaultSortOrder})),this.sortMultiple()}this.isStateful()&&this.saveState(),this.anchorRowIndex=null}sortSingle(){let e=this.sortField||this.groupRowsBy,o=this.sortField?this.sortOrder:this.groupRowsByOrder;if(this.groupRowsBy&&this.sortField&&this.groupRowsBy!==this.sortField)return this._multiSortMeta=[this.getGroupRowsMeta(),{field:this.sortField,order:this.sortOrder}],void this.sortMultiple();if(e&&o){this.restoringSort&&(this.restoringSort=!1),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,field:e,order:o}):(this.value.sort((s,l)=>{let h=_n.resolveFieldData(s,e),g=_n.resolveFieldData(l,e),b=null;return b=null==h&&null!=g?-1:null!=h&&null==g?1:null==h&&null==g?0:"string"==typeof h&&"string"==typeof g?h.localeCompare(g):h<g?-1:h>g?1:0,o*b}),this._value=[...this.value]),this.hasFilter()&&this._filter());let r={field:e,order:o};this.onSort.emit(r),this.tableService.onSort(r)}}sortMultiple(){this.groupRowsBy&&(this._multiSortMeta?this.multiSortMeta[0].field!==this.groupRowsBy&&(this._multiSortMeta=[this.getGroupRowsMeta(),...this._multiSortMeta]):this._multiSortMeta=[this.getGroupRowsMeta()]),this.multiSortMeta&&(this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,multiSortMeta:this.multiSortMeta}):(this.value.sort((e,o)=>this.multisortField(e,o,this.multiSortMeta,0)),this._value=[...this.value]),this.hasFilter()&&this._filter()),this.onSort.emit({multisortmeta:this.multiSortMeta}),this.tableService.onSort(this.multiSortMeta))}multisortField(e,o,r,s){const l=_n.resolveFieldData(e,r[s].field),h=_n.resolveFieldData(o,r[s].field);return 0===_n.compare(l,h,this.filterLocale)?r.length-1>s?this.multisortField(e,o,r,s+1):0:this.compareValuesOnSort(l,h,r[s].order)}compareValuesOnSort(e,o,r){return _n.sort(e,o,r,this.filterLocale,this.sortOrder)}getSortMeta(e){if(this.multiSortMeta&&this.multiSortMeta.length)for(let o=0;o<this.multiSortMeta.length;o++)if(this.multiSortMeta[o].field===e)return this.multiSortMeta[o];return null}isSorted(e){if("single"===this.sortMode)return this.sortField&&this.sortField===e;if("multiple"===this.sortMode){let o=!1;if(this.multiSortMeta)for(let r=0;r<this.multiSortMeta.length;r++)if(this.multiSortMeta[r].field==e){o=!0;break}return o}}handleRowClick(e){let o=e.originalEvent.target,r=o.nodeName,s=o.parentElement&&o.parentElement.nodeName;if("INPUT"!=r&&"BUTTON"!=r&&"A"!=r&&"INPUT"!=s&&"BUTTON"!=s&&"A"!=s&&!Fe.hasClass(e.originalEvent.target,"p-clickable")){if(this.selectionMode){let l=e.rowData,h=e.rowIndex;if(this.preventSelectionSetterPropagation=!0,this.isMultipleSelectionMode()&&e.originalEvent.shiftKey&&null!=this.anchorRowIndex)Fe.clearSelection(),null!=this.rangeRowIndex&&this.clearSelectionRange(e.originalEvent),this.rangeRowIndex=h,this.selectRange(e.originalEvent,h);else{let g=this.isSelected(l);if(!g&&!this.isRowSelectable(l,h))return;let b=!this.rowTouched&&this.metaKeySelection,T=this.dataKey?String(_n.resolveFieldData(l,this.dataKey)):null;if(this.anchorRowIndex=h,this.rangeRowIndex=h,b){let I=e.originalEvent.metaKey||e.originalEvent.ctrlKey;if(g&&I){if(this.isSingleSelectionMode())this._selection=null,this.selectionKeys={},this.selectionChange.emit(null);else{let R=this.findIndexInSelection(l);this._selection=this.selection.filter((z,W)=>W!=R),this.selectionChange.emit(this.selection),T&&delete this.selectionKeys[T]}this.onRowUnselect.emit({originalEvent:e.originalEvent,data:l,type:"row"})}else this.isSingleSelectionMode()?(this._selection=l,this.selectionChange.emit(l),T&&(this.selectionKeys={},this.selectionKeys[T]=1)):this.isMultipleSelectionMode()&&(I?this._selection=this.selection||[]:(this._selection=[],this.selectionKeys={}),this._selection=[...this.selection,l],this.selectionChange.emit(this.selection),T&&(this.selectionKeys[T]=1)),this.onRowSelect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h})}else if("single"===this.selectionMode)g?(this._selection=null,this.selectionKeys={},this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h})):(this._selection=l,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h}),T&&(this.selectionKeys={},this.selectionKeys[T]=1));else if("multiple"===this.selectionMode)if(g){let I=this.findIndexInSelection(l);this._selection=this.selection.filter((R,z)=>z!=I),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h}),T&&delete this.selectionKeys[T]}else this._selection=this.selection?[...this.selection,l]:[l],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h}),T&&(this.selectionKeys[T]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}this.rowTouched=!1}}handleRowTouchEnd(e){this.rowTouched=!0}handleRowRightClick(e){if(this.contextMenu){const o=e.rowData,r=e.rowIndex;if("separate"===this.contextMenuSelectionMode)this.contextMenuSelection=o,this.contextMenuSelectionChange.emit(o),this.onContextMenuSelect.emit({originalEvent:e.originalEvent,data:o,index:e.rowIndex}),this.contextMenu.show(e.originalEvent),this.tableService.onContextMenu(o);else if("joint"===this.contextMenuSelectionMode){this.preventSelectionSetterPropagation=!0;let s=this.isSelected(o),l=this.dataKey?String(_n.resolveFieldData(o,this.dataKey)):null;if(!s){if(!this.isRowSelectable(o,r))return;this.isSingleSelectionMode()?(this.selection=o,this.selectionChange.emit(o),l&&(this.selectionKeys={},this.selectionKeys[l]=1)):this.isMultipleSelectionMode()&&(this._selection=this.selection?[...this.selection,o]:[o],this.selectionChange.emit(this.selection),l&&(this.selectionKeys[l]=1))}this.tableService.onSelectionChange(),this.contextMenu.show(e.originalEvent),this.onContextMenuSelect.emit({originalEvent:e,data:o,index:e.rowIndex})}}}selectRange(e,o){let r,s;this.anchorRowIndex>o?(r=o,s=this.anchorRowIndex):this.anchorRowIndex<o?(r=this.anchorRowIndex,s=o):(r=o,s=o),this.lazy&&this.paginator&&(r-=this.first,s-=this.first);let l=[];for(let h=r;h<=s;h++){let g=this.filteredValue?this.filteredValue[h]:this.value[h];if(!this.isSelected(g)){if(!this.isRowSelectable(g,o))continue;l.push(g),this._selection=[...this.selection,g];let b=this.dataKey?String(_n.resolveFieldData(g,this.dataKey)):null;b&&(this.selectionKeys[b]=1)}}this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e,data:l,type:"row"})}clearSelectionRange(e){let o,r;this.rangeRowIndex>this.anchorRowIndex?(o=this.anchorRowIndex,r=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(o=this.rangeRowIndex,r=this.anchorRowIndex):(o=this.rangeRowIndex,r=this.rangeRowIndex);for(let s=o;s<=r;s++){let l=this.value[s],h=this.findIndexInSelection(l);this._selection=this.selection.filter((b,T)=>T!=h);let g=this.dataKey?String(_n.resolveFieldData(l,this.dataKey)):null;g&&delete this.selectionKeys[g],this.onRowUnselect.emit({originalEvent:e,data:l,type:"row"})}}isSelected(e){return!(!e||!this.selection)&&(this.dataKey?void 0!==this.selectionKeys[_n.resolveFieldData(e,this.dataKey)]:Array.isArray(this.selection)?this.findIndexInSelection(e)>-1:this.equals(e,this.selection))}findIndexInSelection(e){let o=-1;if(this.selection&&this.selection.length)for(let r=0;r<this.selection.length;r++)if(this.equals(e,this.selection[r])){o=r;break}return o}isRowSelectable(e,o){return!(this.rowSelectable&&!this.rowSelectable({data:e,index:o}))}toggleRowWithRadio(e,o){if(this.preventSelectionSetterPropagation=!0,this.selection!=o){if(!this.isRowSelectable(o,e.rowIndex))return;this._selection=o,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:o,type:"radiobutton"}),this.dataKey&&(this.selectionKeys={},this.selectionKeys[String(_n.resolveFieldData(o,this.dataKey))]=1)}else this._selection=null,this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:o,type:"radiobutton"});this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowWithCheckbox(e,o){this.selection=this.selection||[];let r=this.isSelected(o),s=this.dataKey?String(_n.resolveFieldData(o,this.dataKey)):null;if(this.preventSelectionSetterPropagation=!0,r){let l=this.findIndexInSelection(o);this._selection=this.selection.filter((h,g)=>g!=l),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:o,type:"checkbox"}),s&&delete this.selectionKeys[s]}else{if(!this.isRowSelectable(o,e.rowIndex))return;this._selection=this.selection?[...this.selection,o]:[o],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:o,type:"checkbox"}),s&&(this.selectionKeys[s]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowsWithCheckbox(e,o){if(null!==this._selectAll)this.selectAllChange.emit({originalEvent:e,checked:o});else{const r=this.selectionPageOnly?this.dataToRender(this.processedData):this.processedData;let s=this.selectionPageOnly&&this._selection?this._selection.filter(l=>!r.some(h=>this.equals(l,h))):[];o&&(s=this.frozenValue?[...s,...this.frozenValue,...r]:[...s,...r],s=this.rowSelectable?s.filter((l,h)=>this.rowSelectable({data:l,index:h})):s),this._selection=s,this.preventSelectionSetterPropagation=!0,this.updateSelectionKeys(),this.selectionChange.emit(this._selection),this.tableService.onSelectionChange(),this.onHeaderCheckboxToggle.emit({originalEvent:e,checked:o}),this.isStateful()&&this.saveState()}}equals(e,o){return"equals"===this.compareSelectionBy?e===o:_n.equals(e,o,this.dataKey)}filter(e,o,r){this.filterTimeout&&clearTimeout(this.filterTimeout),this.isFilterBlank(e)?this.filters[o]&&delete this.filters[o]:this.filters[o]={value:e,matchMode:r},this.filterTimeout=setTimeout(()=>{this._filter(),this.filterTimeout=null},this.filterDelay),this.anchorRowIndex=null}filterGlobal(e,o){this.filter(e,"global",o)}isFilterBlank(e){return null==e||!!("string"==typeof e&&0==e.trim().length||Array.isArray(e)&&0==e.length)}_filter(){if(this.restoringFilter||(this.first=0,this.firstChange.emit(this.first)),this.lazy)this.onLazyLoad.emit(this.createLazyLoadMetadata());else{if(!this.value)return;if(this.hasFilter()){let e;if(this.filters.global){if(!this.columns&&!this.globalFilterFields)throw new Error("Global filtering requires dynamic columns or globalFilterFields to be defined.");e=this.globalFilterFields||this.columns}this.filteredValue=[];for(let o=0;o<this.value.length;o++){let h,r=!0,s=!1,l=!1;for(let g in this.filters)if(this.filters.hasOwnProperty(g)&&"global"!==g){l=!0;let b=g,T=this.filters[b];if(Array.isArray(T)){for(let I of T)if(r=this.executeLocalFilter(b,this.value[o],I),I.operator===UL.OR&&r||I.operator===UL.AND&&!r)break}else r=this.executeLocalFilter(b,this.value[o],T);if(!r)break}if(this.filters.global&&!s&&e)for(let g=0;g<e.length&&(s=this.filterService.filters[this.filters.global.matchMode](_n.resolveFieldData(this.value[o],e[g].field||e[g]),this.filters.global.value,this.filterLocale),!s);g++);h=this.filters.global?l?l&&r&&s:s:l&&r,h&&this.filteredValue.push(this.value[o])}this.filteredValue.length===this.value.length&&(this.filteredValue=null),this.paginator&&(this.totalRecords=this.filteredValue?this.filteredValue.length:this.value?this.value.length:0)}else this.filteredValue=null,this.paginator&&(this.totalRecords=this.value?this.value.length:0)}this.onFilter.emit({filters:this.filters,filteredValue:this.filteredValue||this.value}),this.tableService.onValueChange(this.value),this.isStateful()&&!this.restoringFilter&&this.saveState(),this.restoringFilter&&(this.restoringFilter=!1),this.cd.markForCheck(),this.scrollable&&this.resetScrollTop()}executeLocalFilter(e,o,r){let s=r.value,l=r.matchMode||Ws.STARTS_WITH,h=_n.resolveFieldData(o,e);return(0,this.filterService.filters[l])(h,s,this.filterLocale)}hasFilter(){let e=!0;for(let o in this.filters)if(this.filters.hasOwnProperty(o)){e=!1;break}return!e}createLazyLoadMetadata(){return{first:this.first,rows:this.rows,sortField:this.sortField,sortOrder:this.sortOrder,filters:this.filters,globalFilter:this.filters&&this.filters.global?this.filters.global.value:null,multiSortMeta:this.multiSortMeta,forceUpdate:()=>this.cd.detectChanges()}}clear(){this._sortField=null,this._sortOrder=this.defaultSortOrder,this._multiSortMeta=null,this.tableService.onSort(null),this.filters.global&&(this.filters.global.value=null),this.filteredValue=null,this.tableService.onResetChange(),this.first=0,this.firstChange.emit(this.first),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.totalRecords=this._value?this._value.length:0}reset(){this.clear()}getExportHeader(e){return e[this.exportHeader]||e.header||e.field}exportCSV(e){let o,r="",s=this.columns;e&&e.selectionOnly?o=this.selection||[]:e&&e.allValues?o=this.value||[]:(o=this.filteredValue||this.value,this.frozenValue&&(o=o?[...this.frozenValue,...o]:this.frozenValue));for(let g=0;g<s.length;g++){let b=s[g];!1!==b.exportable&&b.field&&(r+='"'+this.getExportHeader(b)+'"',g<s.length-1&&(r+=this.csvSeparator))}o.forEach((g,b)=>{r+="\n";for(let T=0;T<s.length;T++){let I=s[T];if(!1!==I.exportable&&I.field){let R=_n.resolveFieldData(g,I.field);R=null!=R?this.exportFunction?this.exportFunction({data:R,field:I.field}):String(R).replace(/"/g,'""'):"",r+='"'+R+'"',T<s.length-1&&(r+=this.csvSeparator)}}});let l=new Blob([r],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a");h.style.display="none",document.body.appendChild(h),void 0!==h.download?(h.setAttribute("href",URL.createObjectURL(l)),h.setAttribute("download",this.exportFilename+".csv"),h.click()):(r="data:text/csv;charset=utf-8,"+r,window.open(encodeURI(r))),document.body.removeChild(h)}onLazyItemLoad(e){this.onLazyLoad.emit({...this.createLazyLoadMetadata(),...e,rows:e.last-e.first})}resetScrollTop(){this.virtualScroll?this.scrollToVirtualIndex(0):this.scrollTo({top:0})}scrollToVirtualIndex(e){this.virtualScroll&&this.scroller.scrollToIndex(e)}scrollTo(e){this.virtualScroll?this.scroller.scrollTo(e):this.wrapperViewChild&&this.wrapperViewChild.nativeElement&&(this.wrapperViewChild.nativeElement.scrollTo?this.wrapperViewChild.nativeElement.scrollTo(e):(this.wrapperViewChild.nativeElement.scrollLeft=e.left,this.wrapperViewChild.nativeElement.scrollTop=e.top))}updateEditingCell(e,o,r,s){this.editingCell=e,this.editingCellData=o,this.editingCellField=r,this.editingCellRowIndex=s,this.bindDocumentEditListener()}isEditingCellValid(){return this.editingCell&&0===Fe.find(this.editingCell,".ng-invalid.ng-dirty").length}bindDocumentEditListener(){this.documentEditListener||(this.documentEditListener=e=>{this.editingCell&&!this.selfClick&&this.isEditingCellValid()&&(Fe.removeClass(this.editingCell,"p-cell-editing"),this.editingCell=null,this.onEditComplete.emit({field:this.editingCellField,data:this.editingCellData,originalEvent:e,index:this.editingCellRowIndex}),this.editingCellField=null,this.editingCellData=null,this.editingCellRowIndex=null,this.unbindDocumentEditListener(),this.cd.markForCheck(),this.overlaySubscription&&this.overlaySubscription.unsubscribe()),this.selfClick=!1},document.addEventListener("click",this.documentEditListener))}unbindDocumentEditListener(){this.documentEditListener&&(document.removeEventListener("click",this.documentEditListener),this.documentEditListener=null)}initRowEdit(e){let o=String(_n.resolveFieldData(e,this.dataKey));this.editingRowKeys[o]=!0}saveRowEdit(e,o){if(0===Fe.find(o,".ng-invalid.ng-dirty").length){let r=String(_n.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[r]}}cancelRowEdit(e){let o=String(_n.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[o]}toggleRow(e,o){if(!this.dataKey)throw new Error("dataKey must be defined to use row expansion");let r=String(_n.resolveFieldData(e,this.dataKey));null!=this.expandedRowKeys[r]?(delete this.expandedRowKeys[r],this.onRowCollapse.emit({originalEvent:o,data:e})):("single"===this.rowExpandMode&&(this.expandedRowKeys={}),this.expandedRowKeys[r]=!0,this.onRowExpand.emit({originalEvent:o,data:e})),o&&o.preventDefault(),this.isStateful()&&this.saveState()}isRowExpanded(e){return!0===this.expandedRowKeys[String(_n.resolveFieldData(e,this.dataKey))]}isRowEditing(e){return!0===this.editingRowKeys[String(_n.resolveFieldData(e,this.dataKey))]}isSingleSelectionMode(){return"single"===this.selectionMode}isMultipleSelectionMode(){return"multiple"===this.selectionMode}onColumnResizeBegin(e){let o=Fe.getOffset(this.containerViewChild.nativeElement).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizerHelperX=e.pageX-o+this.containerViewChild.nativeElement.scrollLeft,this.onColumnResize(e),e.preventDefault()}onColumnResize(e){let o=Fe.getOffset(this.containerViewChild.nativeElement).left;Fe.addClass(this.containerViewChild.nativeElement,"p-unselectable-text"),this.resizeHelperViewChild.nativeElement.style.height=this.containerViewChild.nativeElement.offsetHeight+"px",this.resizeHelperViewChild.nativeElement.style.top="0px",this.resizeHelperViewChild.nativeElement.style.left=e.pageX-o+this.containerViewChild.nativeElement.scrollLeft+"px",this.resizeHelperViewChild.nativeElement.style.display="block"}onColumnResizeEnd(){let e=this.resizeHelperViewChild.nativeElement.offsetLeft-this.lastResizerHelperX,r=this.resizeColumnElement.offsetWidth+e;if(r>=(this.resizeColumnElement.style.minWidth.replace(/[^\d.]/g,"")||15)){if("fit"===this.columnResizeMode){let h=this.resizeColumnElement.nextElementSibling.offsetWidth-e;r>15&&h>15&&this.resizeTableCells(r,h)}else"expand"===this.columnResizeMode&&(this.setResizeTableWidth(this.tableViewChild.nativeElement.offsetWidth+e+"px"),this.resizeTableCells(r,null));this.onColResize.emit({element:this.resizeColumnElement,delta:e}),this.isStateful()&&this.saveState()}this.resizeHelperViewChild.nativeElement.style.display="none",Fe.removeClass(this.containerViewChild.nativeElement,"p-unselectable-text")}resizeTableCells(e,o){let r=Fe.index(this.resizeColumnElement),s=[];const l=Fe.findSingle(this.containerViewChild.nativeElement,".p-datatable-thead");Fe.find(l,"tr > th").forEach(b=>s.push(Fe.getOuterWidth(b))),this.destroyStyleElement(),this.createStyleElement();let g="";s.forEach((b,T)=>{let I=T===r?e:o&&T===r+1?o:b;g+=`\n                #${this.id}-table > .p-datatable-thead > tr > th:nth-child(${T+1}),\n                #${this.id}-table > .p-datatable-tbody > tr > td:nth-child(${T+1}),\n                #${this.id}-table > .p-datatable-tfoot > tr > td:nth-child(${T+1}) {\n                    width: ${I}px !important; max-width: ${I}px !important;\n                }\n            `}),this.styleElement.innerHTML=g}onColumnDragStart(e,o){this.reorderIconWidth=Fe.getHiddenElementOuterWidth(this.reorderIndicatorUpViewChild.nativeElement),this.reorderIconHeight=Fe.getHiddenElementOuterHeight(this.reorderIndicatorDownViewChild.nativeElement),this.draggedColumn=o,e.dataTransfer.setData("text","b")}onColumnDragEnter(e,o){if(this.reorderableColumns&&this.draggedColumn&&o){e.preventDefault();let r=Fe.getOffset(this.containerViewChild.nativeElement),s=Fe.getOffset(o);if(this.draggedColumn!=o){Fe.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),Fe.indexWithinGroup(o,"preorderablecolumn");let g=s.left-r.left,T=s.left+o.offsetWidth/2;this.reorderIndicatorUpViewChild.nativeElement.style.top=s.top-r.top-(this.reorderIconHeight-1)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.top=s.top-r.top+o.offsetHeight+"px",e.pageX>T?(this.reorderIndicatorUpViewChild.nativeElement.style.left=g+o.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=g+o.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=1):(this.reorderIndicatorUpViewChild.nativeElement.style.left=g-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=g-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=-1),this.reorderIndicatorUpViewChild.nativeElement.style.display="block",this.reorderIndicatorDownViewChild.nativeElement.style.display="block"}else e.dataTransfer.dropEffect="none"}}onColumnDragLeave(e){this.reorderableColumns&&this.draggedColumn&&e.preventDefault()}onColumnDrop(e,o){if(e.preventDefault(),this.draggedColumn){let r=Fe.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),s=Fe.indexWithinGroup(o,"preorderablecolumn"),l=r!=s;l&&(s-r==1&&-1===this.dropPosition||r-s==1&&1===this.dropPosition)&&(l=!1),l&&s<r&&1===this.dropPosition&&(s+=1),l&&s>r&&-1===this.dropPosition&&(s-=1),l&&(_n.reorderArray(this.columns,r,s),this.onColReorder.emit({dragIndex:r,dropIndex:s,columns:this.columns}),this.isStateful()&&this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.saveState()})})),this.reorderIndicatorUpViewChild.nativeElement.style.display="none",this.reorderIndicatorDownViewChild.nativeElement.style.display="none",this.draggedColumn.draggable=!1,this.draggedColumn=null,this.dropPosition=null}}onRowDragStart(e,o){this.rowDragging=!0,this.draggedRowIndex=o,e.dataTransfer.setData("text","b")}onRowDragOver(e,o,r){if(this.rowDragging&&this.draggedRowIndex!==o){let s=Fe.getOffset(r).top+Fe.getWindowScrollTop(),l=e.pageY,h=s+Fe.getOuterHeight(r)/2,g=r.previousElementSibling;l<h?(Fe.removeClass(r,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=o,g?Fe.addClass(g,"p-datatable-dragpoint-bottom"):Fe.addClass(r,"p-datatable-dragpoint-top")):(g?Fe.removeClass(g,"p-datatable-dragpoint-bottom"):Fe.addClass(r,"p-datatable-dragpoint-top"),this.droppedRowIndex=o+1,Fe.addClass(r,"p-datatable-dragpoint-bottom"))}}onRowDragLeave(e,o){let r=o.previousElementSibling;r&&Fe.removeClass(r,"p-datatable-dragpoint-bottom"),Fe.removeClass(o,"p-datatable-dragpoint-bottom"),Fe.removeClass(o,"p-datatable-dragpoint-top")}onRowDragEnd(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null}onRowDrop(e,o){if(null!=this.droppedRowIndex){let r=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:0===this.droppedRowIndex?0:this.droppedRowIndex-1;_n.reorderArray(this.value,this.draggedRowIndex,r),this.virtualScroll&&(this._value=[...this._value]),this.onRowReorder.emit({dragIndex:this.draggedRowIndex,dropIndex:r})}this.onRowDragLeave(e,o),this.onRowDragEnd(e)}isEmpty(){let e=this.filteredValue||this.value;return null==e||0==e.length}getBlockableElement(){return this.el.nativeElement.children[0]}getStorage(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}}isStateful(){return null!=this.stateKey}saveState(){const e=this.getStorage();let o={};this.paginator&&(o.first=this.first,o.rows=this.rows),this.sortField&&(o.sortField=this.sortField,o.sortOrder=this.sortOrder),this.multiSortMeta&&(o.multiSortMeta=this.multiSortMeta),this.hasFilter()&&(o.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(o),this.reorderableColumns&&this.saveColumnOrder(o),this.selection&&(o.selection=this.selection),Object.keys(this.expandedRowKeys).length&&(o.expandedRowKeys=this.expandedRowKeys),e.setItem(this.stateKey,JSON.stringify(o)),this.onStateSave.emit(o)}clearState(){const e=this.getStorage();this.stateKey&&e.removeItem(this.stateKey)}restoreState(){const o=this.getStorage().getItem(this.stateKey),r=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/;if(o){let l=JSON.parse(o,function(l,h){return"string"==typeof h&&r.test(h)?new Date(h):h});this.paginator&&(void 0!==this.first&&(this.first=l.first,this.firstChange.emit(this.first)),void 0!==this.rows&&(this.rows=l.rows,this.rowsChange.emit(this.rows))),l.sortField&&(this.restoringSort=!0,this._sortField=l.sortField,this._sortOrder=l.sortOrder),l.multiSortMeta&&(this.restoringSort=!0,this._multiSortMeta=l.multiSortMeta),l.filters&&(this.restoringFilter=!0,this.filters=l.filters),this.resizableColumns&&(this.columnWidthsState=l.columnWidths,this.tableWidthState=l.tableWidth),l.expandedRowKeys&&(this.expandedRowKeys=l.expandedRowKeys),l.selection&&Promise.resolve(null).then(()=>this.selectionChange.emit(l.selection)),this.stateRestored=!0,this.onStateRestore.emit(l)}}saveColumnWidths(e){let o=[];Fe.find(this.containerViewChild.nativeElement,".p-datatable-thead > tr > th").forEach(s=>o.push(Fe.getOuterWidth(s))),e.columnWidths=o.join(","),"expand"===this.columnResizeMode&&(e.tableWidth=Fe.getOuterWidth(this.tableViewChild.nativeElement))}setResizeTableWidth(e){this.tableViewChild.nativeElement.style.width=e,this.tableViewChild.nativeElement.style.minWidth=e}restoreColumnWidths(){if(this.columnWidthsState){let e=this.columnWidthsState.split(",");if("expand"===this.columnResizeMode&&this.tableWidthState&&this.setResizeTableWidth(this.tableWidthState+"px"),_n.isNotEmpty(e)){this.createStyleElement();let o="";e.forEach((r,s)=>{o+=`\n                        #${this.id}-table > .p-datatable-thead > tr > th:nth-child(${s+1}),\n                        #${this.id}-table > .p-datatable-tbody > tr > td:nth-child(${s+1}),\n                        #${this.id}-table > .p-datatable-tfoot > tr > td:nth-child(${s+1}) {\n                            width: ${r}px !important; max-width: ${r}px !important\n                        }\n                    `}),this.styleElement.innerHTML=o}}}saveColumnOrder(e){if(this.columns){let o=[];this.columns.map(r=>{o.push(r.field||r.key)}),e.columnOrder=o}}restoreColumnOrder(){const o=this.getStorage().getItem(this.stateKey);if(o){let s=JSON.parse(o).columnOrder;if(s){let l=[];s.map(h=>{let g=this.findColumnByKey(h);g&&l.push(g)}),this.columnOrderStateRestored=!0,this.columns=l}}}findColumnByKey(e){if(!this.columns)return null;for(let o of this.columns)if(o.key===e||o.field===e)return o}createStyleElement(){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement)}getGroupRowsMeta(){return{field:this.groupRowsBy,order:this.groupRowsByOrder}}createResponsiveStyle(){this.responsiveStyleElement||(this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.head.appendChild(this.responsiveStyleElement),this.responsiveStyleElement.innerHTML=`\n@media screen and (max-width: ${this.breakpoint}) {\n    #${this.id}-table > .p-datatable-thead > tr > th,\n    #${this.id}-table > .p-datatable-tfoot > tr > td {\n        display: none !important;\n    }\n\n    #${this.id}-table > .p-datatable-tbody > tr > td {\n        display: flex;\n        width: 100% !important;\n        align-items: center;\n        justify-content: space-between;\n    }\n\n    #${this.id}-table > .p-datatable-tbody > tr > td:not(:last-child) {\n        border: 0 none;\n    }\n\n    #${this.id}.p-datatable-gridlines > .p-datatable-wrapper > .p-datatable-table > .p-datatable-tbody > tr > td:last-child {\n        border-top: 0;\n        border-right: 0;\n        border-left: 0;\n    }\n\n    #${this.id}-table > .p-datatable-tbody > tr > td > .p-column-title {\n        display: block;\n    }\n}\n`)}destroyResponsiveStyle(){this.responsiveStyleElement&&(document.head.removeChild(this.responsiveStyleElement),this.responsiveStyleElement=null)}destroyStyleElement(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.unbindDocumentEditListener(),this.editingCell=null,this.initialized=null,this.destroyStyleElement(),this.destroyResponsiveStyle()}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(fi),be(Gw),be(Po),be($D),be(Wb))},t.\u0275cmp=on({type:t,selectors:[["p-table"]],contentQueries:function(e,o,r){if(1&e&&No(r,_o,4),2&e){let s;mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(FK,5),pi(zK,5),pi(NK,5),pi(BK,5),pi(VK,5),pi(UK,5),pi(jK,5),pi(HK,5),pi($K,5)),2&e){let r;mn(r=gn())&&(o.containerViewChild=r.first),mn(r=gn())&&(o.resizeHelperViewChild=r.first),mn(r=gn())&&(o.reorderIndicatorUpViewChild=r.first),mn(r=gn())&&(o.reorderIndicatorDownViewChild=r.first),mn(r=gn())&&(o.wrapperViewChild=r.first),mn(r=gn())&&(o.tableViewChild=r.first),mn(r=gn())&&(o.tableHeaderViewChild=r.first),mn(r=gn())&&(o.tableFooterViewChild=r.first),mn(r=gn())&&(o.scroller=r.first)}},hostAttrs:[1,"p-element"],inputs:{frozenColumns:"frozenColumns",frozenValue:"frozenValue",style:"style",styleClass:"styleClass",tableStyle:"tableStyle",tableStyleClass:"tableStyleClass",paginator:"paginator",pageLinks:"pageLinks",rowsPerPageOptions:"rowsPerPageOptions",alwaysShowPaginator:"alwaysShowPaginator",paginatorPosition:"paginatorPosition",paginatorDropdownAppendTo:"paginatorDropdownAppendTo",paginatorDropdownScrollHeight:"paginatorDropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showJumpToPageDropdown:"showJumpToPageDropdown",showJumpToPageInput:"showJumpToPageInput",showFirstLastIcon:"showFirstLastIcon",showPageLinks:"showPageLinks",defaultSortOrder:"defaultSortOrder",sortMode:"sortMode",resetPageOnSort:"resetPageOnSort",selectionMode:"selectionMode",selectionPageOnly:"selectionPageOnly",contextMenuSelection:"contextMenuSelection",contextMenuSelectionMode:"contextMenuSelectionMode",dataKey:"dataKey",metaKeySelection:"metaKeySelection",rowSelectable:"rowSelectable",rowTrackBy:"rowTrackBy",lazy:"lazy",lazyLoadOnInit:"lazyLoadOnInit",compareSelectionBy:"compareSelectionBy",csvSeparator:"csvSeparator",exportFilename:"exportFilename",filters:"filters",globalFilterFields:"globalFilterFields",filterDelay:"filterDelay",filterLocale:"filterLocale",expandedRowKeys:"expandedRowKeys",editingRowKeys:"editingRowKeys",rowExpandMode:"rowExpandMode",scrollable:"scrollable",scrollDirection:"scrollDirection",rowGroupMode:"rowGroupMode",scrollHeight:"scrollHeight",virtualScroll:"virtualScroll",virtualScrollItemSize:"virtualScrollItemSize",virtualScrollOptions:"virtualScrollOptions",virtualScrollDelay:"virtualScrollDelay",frozenWidth:"frozenWidth",responsive:"responsive",contextMenu:"contextMenu",resizableColumns:"resizableColumns",columnResizeMode:"columnResizeMode",reorderableColumns:"reorderableColumns",loading:"loading",loadingIcon:"loadingIcon",showLoader:"showLoader",rowHover:"rowHover",customSort:"customSort",showInitialSortBadge:"showInitialSortBadge",autoLayout:"autoLayout",exportFunction:"exportFunction",exportHeader:"exportHeader",stateKey:"stateKey",stateStorage:"stateStorage",editMode:"editMode",groupRowsBy:"groupRowsBy",groupRowsByOrder:"groupRowsByOrder",responsiveLayout:"responsiveLayout",breakpoint:"breakpoint",virtualRowHeight:"virtualRowHeight",value:"value",columns:"columns",first:"first",rows:"rows",totalRecords:"totalRecords",sortField:"sortField",sortOrder:"sortOrder",multiSortMeta:"multiSortMeta",selection:"selection",selectAll:"selectAll"},outputs:{selectAllChange:"selectAllChange",selectionChange:"selectionChange",contextMenuSelectionChange:"contextMenuSelectionChange",onRowSelect:"onRowSelect",onRowUnselect:"onRowUnselect",onPage:"onPage",onSort:"onSort",onFilter:"onFilter",onLazyLoad:"onLazyLoad",onRowExpand:"onRowExpand",onRowCollapse:"onRowCollapse",onContextMenuSelect:"onContextMenuSelect",onColResize:"onColResize",onColReorder:"onColReorder",onRowReorder:"onRowReorder",onEditInit:"onEditInit",onEditComplete:"onEditComplete",onEditCancel:"onEditCancel",onHeaderCheckboxToggle:"onHeaderCheckboxToggle",sortFunction:"sortFunction",firstChange:"firstChange",rowsChange:"rowsChange",onStateSave:"onStateSave",onStateRestore:"onStateRestore"},features:[Wi([Gw]),ur],decls:16,vars:22,consts:[[3,"ngStyle","ngClass"],["container",""],["class","p-datatable-loading-overlay p-component-overlay",4,"ngIf"],["class","p-datatable-header",4,"ngIf"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange",4,"ngIf"],[1,"p-datatable-wrapper",3,"ngStyle"],["wrapper",""],[3,"items","columns","style","scrollHeight","itemSize","step","delay","inline","lazy","loaderDisabled","showSpacer","showLoader","options","autoSize","onLazyLoad",4,"ngIf"],[4,"ngIf"],["buildInTable",""],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange",4,"ngIf"],["class","p-datatable-footer",4,"ngIf"],["class","p-column-resizer-helper","style","display:none",4,"ngIf"],["class","pi pi-arrow-down p-datatable-reorder-indicator-up","style","display: none;",4,"ngIf"],["class","pi pi-arrow-up p-datatable-reorder-indicator-down","style","display: none;",4,"ngIf"],[1,"p-datatable-loading-overlay","p-component-overlay"],[1,"p-datatable-header"],[4,"ngTemplateOutlet"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange"],[3,"items","columns","scrollHeight","itemSize","step","delay","inline","lazy","loaderDisabled","showSpacer","showLoader","options","autoSize","onLazyLoad"],["scroller",""],["pTemplate","content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["role","table",3,"ngClass"],["table",""],[1,"p-datatable-thead"],["thead",""],["class","p-datatable-tbody p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen",4,"ngIf"],[1,"p-datatable-tbody",3,"ngClass","value","pTableBody","pTableBodyTemplate","scrollerOptions"],["class","p-datatable-scroller-spacer",3,"style",4,"ngIf"],["class","p-datatable-tfoot",4,"ngIf"],[1,"p-datatable-tbody","p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen"],[1,"p-datatable-scroller-spacer"],[1,"p-datatable-tfoot"],["tfoot",""],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange"],[1,"p-datatable-footer"],[1,"p-column-resizer-helper",2,"display","none"],["resizeHelper",""],[1,"pi","pi-arrow-down","p-datatable-reorder-indicator-up",2,"display","none"],["reorderIndicatorUp",""],[1,"pi","pi-arrow-up","p-datatable-reorder-indicator-down",2,"display","none"],["reorderIndicatorDown",""]],template:function(e,o){1&e&&(F(0,"div",0,1),J(2,GK,2,2,"div",2),J(3,qK,2,1,"div",3),J(4,ZK,1,17,"p-paginator",4),F(5,"div",5,6),J(7,QK,3,17,"p-scroller",7),J(8,tX,2,7,"ng-container",8),J(9,cX,10,28,"ng-template",null,9,ka),V(),J(11,uX,1,17,"p-paginator",10),J(12,hX,2,1,"div",11),J(13,pX,2,0,"div",12),J(14,fX,2,0,"span",13),J(15,mX,2,0,"span",14),V()),2&e&&(Xn(o.styleClass),B("ngStyle",o.style)("ngClass",$r(16,gX,o.rowHover||o.selectionMode,o.scrollable,o.scrollable&&"flex"===o.scrollHeight)),st("id",o.id),j(2),B("ngIf",o.loading&&o.showLoader),j(1),B("ngIf",o.captionTemplate),j(1),B("ngIf",o.paginator&&("top"===o.paginatorPosition||"both"==o.paginatorPosition)),j(1),B("ngStyle",An(20,_X,o.virtualScroll?"":o.scrollHeight)),j(2),B("ngIf",o.virtualScroll),j(1),B("ngIf",!o.virtualScroll),j(3),B("ngIf",o.paginator&&("bottom"===o.paginatorPosition||"both"==o.paginatorPosition)),j(1),B("ngIf",o.summaryTemplate),j(1),B("ngIf",o.resizableColumns),j(1),B("ngIf",o.reorderableColumns),j(1),B("ngIf",o.reorderableColumns))},dependencies:function(){return[Eo,mi,Is,Oo,oF,_o,XL,xY]},styles:[".p-datatable{position:relative}.p-datatable>.p-datatable-wrapper{overflow:auto}.p-datatable-table{border-spacing:0px;width:100%}.p-datatable .p-sortable-column{cursor:pointer;-webkit-user-select:none;user-select:none}.p-datatable .p-sortable-column .p-column-title,.p-datatable .p-sortable-column .p-sortable-column-icon,.p-datatable .p-sortable-column .p-sortable-column-badge{vertical-align:middle}.p-datatable .p-sortable-column .p-sortable-column-badge{display:inline-flex;align-items:center;justify-content:center}.p-datatable-hoverable-rows .p-selectable-row{cursor:pointer}.p-datatable-scrollable>.p-datatable-wrapper{position:relative}.p-datatable-scrollable-table>.p-datatable-thead{position:sticky;top:0;z-index:1}.p-datatable-scrollable-table>.p-datatable-frozen-tbody{position:sticky;z-index:1}.p-datatable-scrollable-table>.p-datatable-tfoot{position:sticky;bottom:0;z-index:1}.p-datatable-scrollable .p-frozen-column{position:sticky;background:inherit}.p-datatable-scrollable th.p-frozen-column{z-index:1}.p-datatable-flex-scrollable{display:flex;flex-direction:column;height:100%}.p-datatable-flex-scrollable>.p-datatable-wrapper{display:flex;flex-direction:column;flex:1;height:100%}.p-datatable-scrollable-table>.p-datatable-tbody>.p-rowgroup-header{position:sticky;z-index:1}.p-datatable-resizable-table>.p-datatable-thead>tr>th,.p-datatable-resizable-table>.p-datatable-tfoot>tr>td,.p-datatable-resizable-table>.p-datatable-tbody>tr>td{overflow:hidden;white-space:nowrap}.p-datatable-resizable-table>.p-datatable-thead>tr>th.p-resizable-column:not(.p-frozen-column){background-clip:padding-box;position:relative}.p-datatable-resizable-table-fit>.p-datatable-thead>tr>th.p-resizable-column:last-child .p-column-resizer{display:none}.p-datatable .p-column-resizer{display:block;position:absolute!important;top:0;right:0;margin:0;width:.5rem;height:100%;padding:0;cursor:col-resize;border:1px solid transparent}.p-datatable .p-column-resizer-helper{width:1px;position:absolute;z-index:10;display:none}.p-datatable .p-row-editor-init,.p-datatable .p-row-editor-save,.p-datatable .p-row-editor-cancel,.p-datatable .p-row-toggler{display:inline-flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-datatable-reorder-indicator-up,.p-datatable-reorder-indicator-down{position:absolute}.p-datatable-reorderablerow-handle,[pReorderableColumn]{cursor:move}.p-datatable .p-datatable-loading-overlay{position:absolute;display:flex;align-items:center;justify-content:center;z-index:2}.p-column-filter-row{display:flex;align-items:center;width:100%}.p-column-filter-menu{display:inline-flex}.p-column-filter-row p-columnfilterformelement{flex:1 1 auto;width:1%}.p-column-filter-menu-button,.p-column-filter-clear-button{display:inline-flex;justify-content:center;align-items:center;cursor:pointer;text-decoration:none;overflow:hidden;position:relative}.p-column-filter-overlay{position:absolute;top:0;left:0}.p-column-filter-row-items{margin:0;padding:0;list-style:none}.p-column-filter-row-item{cursor:pointer}.p-column-filter-add-button,.p-column-filter-remove-button{justify-content:center}.p-column-filter-add-button .p-button-label,.p-column-filter-remove-button .p-button-label{flex-grow:0}.p-column-filter-buttonbar{display:flex;align-items:center;justify-content:space-between}.p-column-filter-buttonbar .p-button{width:auto}.p-datatable-tbody>tr>td>.p-column-title{display:none}.p-datatable-scroller-spacer{display:flex}.p-datatable .p-scroller .p-scroller-loading{transform:none!important;min-height:0;position:sticky;top:0;left:0}\n"],encapsulation:2}),t})(),xY=(()=>{class t{constructor(e,o,r,s){this.dt=e,this.tableService=o,this.cd=r,this.el=s,this.subscription=this.dt.tableService.valueSource$.subscribe(()=>{this.dt.virtualScroll&&this.cd.detectChanges()})}get value(){return this._value}set value(e){this._value=e,this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&"subheader"===this.dt.rowGroupMode&&this.updateFrozenRowGroupHeaderStickyPosition()}ngAfterViewInit(){this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&"subheader"===this.dt.rowGroupMode&&this.updateFrozenRowGroupHeaderStickyPosition()}shouldRenderRowGroupHeader(e,o,r){let s=_n.resolveFieldData(o,this.dt.groupRowsBy),l=e[r-1];return!l||s!==_n.resolveFieldData(l,this.dt.groupRowsBy)}shouldRenderRowGroupFooter(e,o,r){let s=_n.resolveFieldData(o,this.dt.groupRowsBy),l=e[r+1];return!l||s!==_n.resolveFieldData(l,this.dt.groupRowsBy)}shouldRenderRowspan(e,o,r){let s=_n.resolveFieldData(o,this.dt.groupRowsBy),l=e[r-1];return!l||s!==_n.resolveFieldData(l,this.dt.groupRowsBy)}calculateRowGroupSize(e,o,r){let s=_n.resolveFieldData(o,this.dt.groupRowsBy),l=s,h=0;for(;s===l;){h++;let g=e[++r];if(!g)break;l=_n.resolveFieldData(g,this.dt.groupRowsBy)}return 1===h?null:h}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}updateFrozenRowStickyPosition(){this.el.nativeElement.style.top=Fe.getOuterHeight(this.el.nativeElement.previousElementSibling)+"px"}updateFrozenRowGroupHeaderStickyPosition(){if(this.el.nativeElement.previousElementSibling){let e=Fe.getOuterHeight(this.el.nativeElement.previousElementSibling);this.dt.rowGroupHeaderStyleObject.top=e+"px"}}getScrollerOption(e,o){return this.dt.virtualScroll&&(o=o||this.scrollerOptions)?o[e]:null}getRowIndex(e){const o=this.dt.paginator?this.dt.first+e:e,r=this.getScrollerOption("getItemOptions");return r?r(o).index:o}}return t.\u0275fac=function(e){return new(e||t)(be(bd),be(Gw),be(Po),be(si))},t.\u0275cmp=on({type:t,selectors:[["","pTableBody",""]],hostAttrs:[1,"p-element"],inputs:{columns:["pTableBody","columns"],template:["pTableBodyTemplate","template"],value:"value",frozen:"frozen",frozenRows:"frozenRows",scrollerOptions:"scrollerOptions"},attrs:yX,decls:5,vars:5,consts:[[4,"ngIf"],["ngFor","",3,"ngForOf","ngForTrackBy"],["role","row",4,"ngIf"],["role","row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){1&e&&(J(0,IX,2,2,"ng-container",0),J(1,BX,2,2,"ng-container",0),J(2,$X,2,2,"ng-container",0),J(3,WX,2,5,"ng-container",0),J(4,ZX,2,5,"ng-container",0)),2&e&&(B("ngIf",!o.dt.expandedRowTemplate),j(1),B("ngIf",o.dt.expandedRowTemplate&&!(o.frozen&&o.dt.frozenExpandedRowTemplate)),j(1),B("ngIf",o.dt.frozenExpandedRowTemplate&&o.frozen),j(1),B("ngIf",o.dt.loading),j(1),B("ngIf",o.dt.isEmpty()&&!o.dt.loading))},dependencies:[Ms,mi,Is],encapsulation:2}),t})(),Yb=(()=>{class t{constructor(e){this.dt=e,this.isEnabled()&&(this.subscription=this.dt.tableService.sortSource$.subscribe(o=>{this.updateSortState()}))}ngOnInit(){this.isEnabled()&&this.updateSortState()}updateSortState(){this.sorted=this.dt.isSorted(this.field),this.sortOrder=this.sorted?1===this.dt.sortOrder?"ascending":"descending":"none"}onClick(e){this.isEnabled()&&!this.isFilterElement(e.target)&&(this.updateSortState(),this.dt.sort({originalEvent:e,field:this.field}),Fe.clearSelection())}onEnterKey(e){this.onClick(e)}isEnabled(){return!0!==this.pSortableColumnDisabled}isFilterElement(e){return Fe.hasClass(e,"pi-filter-icon")||Fe.hasClass(e,"p-column-filter-menu-button")}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(be(bd))},t.\u0275dir=kn({type:t,selectors:[["","pSortableColumn",""]],hostAttrs:[1,"p-element"],hostVars:7,hostBindings:function(e,o){1&e&&Oe("click",function(s){return o.onClick(s)})("keydown.enter",function(s){return o.onEnterKey(s)}),2&e&&(st("tabindex",o.isEnabled()?"0":null)("role","columnheader")("aria-sort",o.sortOrder),Mo("p-sortable-column",o.isEnabled())("p-highlight",o.sorted))},inputs:{field:["pSortableColumn","field"],pSortableColumnDisabled:"pSortableColumnDisabled"}}),t})(),Ww=(()=>{class t{constructor(e,o){this.dt=e,this.cd=o,this.subscription=this.dt.tableService.sortSource$.subscribe(r=>{this.updateSortState()})}ngOnInit(){this.updateSortState()}onClick(e){e.preventDefault()}updateSortState(){if("single"===this.dt.sortMode)this.sortOrder=this.dt.isSorted(this.field)?this.dt.sortOrder:0;else if("multiple"===this.dt.sortMode){let e=this.dt.getSortMeta(this.field);this.sortOrder=e?e.order:0}this.cd.markForCheck()}getMultiSortMetaIndex(){let e=this.dt._multiSortMeta,o=-1;if(e&&"multiple"===this.dt.sortMode&&(this.dt.showInitialSortBadge||e.length>1))for(let r=0;r<e.length;r++){let s=e[r];if(s.field===this.field||s.field===this.field){o=r;break}}return o}getBadgeValue(){let e=this.getMultiSortMetaIndex();return this.dt.groupRowsBy&&e>-1?e:e+1}isMultiSorted(){return"multiple"===this.dt.sortMode&&this.getMultiSortMetaIndex()>-1}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(be(bd),be(Po))},t.\u0275cmp=on({type:t,selectors:[["p-sortIcon"]],hostAttrs:[1,"p-element"],inputs:{field:"field"},decls:2,vars:6,consts:[[1,"p-sortable-column-icon","pi","pi-fw",3,"ngClass"],["class","p-sortable-column-badge",4,"ngIf"],[1,"p-sortable-column-badge"]],template:function(e,o){1&e&&(Ne(0,"i",0),J(1,KX,2,1,"span",1)),2&e&&(B("ngClass",$r(2,XX,1===o.sortOrder,-1===o.sortOrder,0===o.sortOrder)),j(1),B("ngIf",o.isMultiSorted()))},dependencies:[Eo,mi],encapsulation:2,changeDetection:0}),t})(),cF=(()=>{class t{constructor(e,o){this.dt=e,this.tableService=o,this.isEnabled()&&(this.subscription=this.dt.tableService.selectionSource$.subscribe(()=>{this.selected=this.dt.isSelected(this.data)}))}ngOnInit(){this.isEnabled()&&(this.selected=this.dt.isSelected(this.data))}onClick(e){this.isEnabled()&&this.dt.handleRowClick({originalEvent:e,rowData:this.data,rowIndex:this.index})}onTouchEnd(e){this.isEnabled()&&this.dt.handleRowTouchEnd(e)}onArrowDownKeyDown(e){if(!this.isEnabled())return;const r=this.findNextSelectableRow(e.currentTarget);r&&r.focus(),e.preventDefault()}onArrowUpKeyDown(e){if(!this.isEnabled())return;const r=this.findPrevSelectableRow(e.currentTarget);r&&r.focus(),e.preventDefault()}onEnterKeyDown(e){this.isEnabled()&&this.dt.handleRowClick({originalEvent:e,rowData:this.data,rowIndex:this.index})}onPageDownKeyDown(){this.dt.virtualScroll&&this.dt.scroller.elementViewChild.nativeElement.focus()}onSpaceKeydown(){this.dt.virtualScroll&&!this.dt.editingCell&&this.dt.scroller.elementViewChild.nativeElement.focus()}findNextSelectableRow(e){let o=e.nextElementSibling;return o?Fe.hasClass(o,"p-selectable-row")?o:this.findNextSelectableRow(o):null}findPrevSelectableRow(e){let o=e.previousElementSibling;return o?Fe.hasClass(o,"p-selectable-row")?o:this.findPrevSelectableRow(o):null}isEnabled(){return!0!==this.pSelectableRowDisabled}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(be(bd),be(Gw))},t.\u0275dir=kn({type:t,selectors:[["","pSelectableRow",""]],hostAttrs:[1,"p-element"],hostVars:5,hostBindings:function(e,o){1&e&&Oe("click",function(s){return o.onClick(s)})("touchend",function(s){return o.onTouchEnd(s)})("keydown.arrowdown",function(s){return o.onArrowDownKeyDown(s)})("keydown.arrowup",function(s){return o.onArrowUpKeyDown(s)})("keydown.enter",function(s){return o.onEnterKeyDown(s)})("keydown.shift.enter",function(s){return o.onEnterKeyDown(s)})("keydown.meta.enter",function(s){return o.onEnterKeyDown(s)})("keydown.pagedown",function(){return o.onPageDownKeyDown()})("keydown.pageup",function(){return o.onPageDownKeyDown()})("keydown.home",function(){return o.onPageDownKeyDown()})("keydown.end",function(){return o.onPageDownKeyDown()})("keydown.space",function(){return o.onSpaceKeydown()}),2&e&&(st("tabindex",o.isEnabled()?0:void 0),Mo("p-selectable-row",o.isEnabled())("p-highlight",o.selected))},inputs:{data:["pSelectableRow","data"],index:["pSelectableRowIndex","index"],pSelectableRowDisabled:"pSelectableRowDisabled"}}),t})(),uF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,rF,Zb,uy,$_,pu,JD,aq,XD,LK,jw,is,jw]}),t})();function wY(t,n){if(1&t){const e=xt();F(0,"div",8)(1,"div",9)(2,"div",10)(3,"h4",11),ce(4," Usuarios encontrados "),V(),F(5,"div",12)(6,"span",13),Ne(7,"i",14),F(8,"input",15),Oe("input",function(r){Ie(e);const s=q();return Me(jn(4).filterGlobal(s.getEventValue(r),"contains"))}),V()()()()()()}}function CY(t,n){1&t&&(F(0,"tr")(1,"th",16)(2,"div",17),ce(3," Nombre "),Ne(4,"p-sortIcon",18),V()(),F(5,"th",19)(6,"div",17),ce(7," Usuario "),Ne(8,"p-sortIcon",20),V()(),F(9,"th",21)(10,"div",22),ce(11," Enviar "),V()()())}function TY(t,n){if(1&t&&(F(0,"tr")(1,"td",23)(2,"div",24)(3,"div",25),Ne(4,"img",26),V(),F(5,"div",27),ce(6),V()()(),F(7,"td",28),ce(8),V(),F(9,"td",23)(10,"div",29)(11,"button",30)(12,"span",31),ce(13," Enviar "),V()()()()()),2&t){const e=n.$implicit;j(4),To("src",e.image,Co),B("alt",e.name),j(2),Jt(e.name),j(2),ei("@",e.nickname,"")}}function EY(t,n){1&t&&(F(0,"tr")(1,"td",32),ce(2,"No customers found."),V()())}const SY=function(){return["name","nickname"]},DY=function(){return[10,25,50]};let MY=(()=>{class t{constructor(){this.loading=!0}ngOnInit(){}getEventValue(e){return e.target.value}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-friends-table"]],inputs:{friends:"friends",loading:"loading"},decls:9,vars:10,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers"],["currentPageReportTemplate","{first} a {last}",3,"value","paginator","rows","loading","rowHover","showCurrentPageReport","globalFilterFields","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"md:m-0","mb-3","text-center","md:text-left"],[1,"flex","align-items-center","justify-content-center"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center","name-size"],["field","name"],["pSortableColumn","nickname"],["field","nickname"],["pSortableColumn","boton"],[1,"flex","justify-content-between","align-items-center","margin-td-right",2,"float","right"],[1,"padding-td"],[2,"display","flex","align-items","flex-start"],[1,"round-images-size"],[1,"round-images","round-images-size",3,"src","alt"],[1,"ml-3","name-size",2,"height","40px","text-align","start","display","flex","align-items","center"],[1,"padding-td","name-size"],[1,"margin-td-right",2,"float","right"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient"],[1,"vibe-btn-text-white","font-normal","text-xs"],["colspan","8"]],template:function(e,o){1&e&&(F(0,"h3",0),ce(1," Usuarios encontrados "),V(),F(2,"div",1)(3,"p-table",2,3),J(5,wY,9,0,"ng-template",4),J(6,CY,12,0,"ng-template",5),J(7,TY,14,4,"ng-template",6),J(8,EY,3,0,"ng-template",7),V()()),2&e&&(j(3),B("value",o.friends)("paginator",!0)("rows",10)("loading",o.loading)("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",ai(8,SY))("rowsPerPageOptions",ai(9,DY)))},dependencies:[os,_o,fc,bd,Yb,Ww],styles:[".padding-td[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important;padding-left:1rem!important;padding-right:0!important}.margin-td-right[_ngcontent-%COMP%]{margin-right:1rem!important}.name-size[_ngcontent-%COMP%]{font-size:1rem!important}@media (max-width: 710px){.padding-td[_ngcontent-%COMP%]{padding-top:.75rem!important;padding-bottom:.75rem!important;padding-left:.75rem!important;padding-right:0!important}.margin-td-right[_ngcontent-%COMP%]{margin-right:.75rem!important}}@media (max-width: 600px){.name-size[_ngcontent-%COMP%]{font-size:.9rem!important}}"]}),t})();const IY=["itemsContainer"];function kY(t,n){1&t&&Ht(0)}function AY(t,n){if(1&t&&(F(0,"div",11),Qi(1),J(2,kY,1,0,"ng-container",12),V()),2&t){const e=q();j(2),B("ngTemplateOutlet",e.headerTemplate)}}const PY=function(t){return{"p-carousel-prev p-link":!0,"p-disabled":t}},OY=function(t,n){return{"p-carousel-prev-icon pi":!0,"pi-chevron-left":t,"pi-chevron-up":n}};function RY(t,n){if(1&t){const e=xt();F(0,"button",13),Oe("click",function(r){return Ie(e),Me(q().navBackward(r))}),Ne(1,"span",2),V()}if(2&t){const e=q();B("ngClass",An(3,PY,e.isBackwardNavDisabled()))("disabled",e.isBackwardNavDisabled()),j(1),B("ngClass",no(5,OY,!e.isVertical(),e.isVertical()))}}function LY(t,n){1&t&&Ht(0)}const dF=function(t,n,e){return{"p-carousel-item p-carousel-item-cloned":!0,"p-carousel-item-active":t,"p-carousel-item-start":n,"p-carousel-item-end":e}},tM=function(t){return{$implicit:t}};function FY(t,n){if(1&t&&(F(0,"div",2),J(1,LY,1,0,"ng-container",14),V()),2&t){const e=n.$implicit,o=n.index,r=q();B("ngClass",$r(3,dF,-1*r.totalShiftedItems===r.value.length,0===o,r.clonedItemsForStarting.length-1===o)),j(1),B("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",An(7,tM,e))}}function zY(t,n){1&t&&Ht(0)}const NY=function(t,n,e){return{"p-carousel-item":!0,"p-carousel-item-active":t,"p-carousel-item-start":n,"p-carousel-item-end":e}};function BY(t,n){if(1&t&&(F(0,"div",2),J(1,zY,1,0,"ng-container",14),V()),2&t){const e=n.$implicit,o=n.index,r=q();B("ngClass",$r(3,NY,r.firstIndex()<=o&&r.lastIndex()>=o,r.firstIndex()===o,r.lastIndex()===o)),j(1),B("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",An(7,tM,e))}}function VY(t,n){1&t&&Ht(0)}function UY(t,n){if(1&t&&(F(0,"div",2),J(1,VY,1,0,"ng-container",14),V()),2&t){const e=n.$implicit,o=n.index,r=q();B("ngClass",$r(3,dF,-1*r.totalShiftedItems===r.numVisible,0===o,r.clonedItemsForFinishing.length-1===o)),j(1),B("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",An(7,tM,e))}}const jY=function(t){return{"p-carousel-next p-link":!0,"p-disabled":t}},HY=function(t,n){return{"p-carousel-prev-icon pi":!0,"pi-chevron-right":t,"pi-chevron-down":n}};function $Y(t,n){if(1&t){const e=xt();F(0,"button",13),Oe("click",function(r){return Ie(e),Me(q().navForward(r))}),Ne(1,"span",2),V()}if(2&t){const e=q();B("ngClass",An(3,jY,e.isForwardNavDisabled()))("disabled",e.isForwardNavDisabled()),j(1),B("ngClass",no(5,HY,!e.isVertical(),e.isVertical()))}}const GY=function(t){return{"p-carousel-indicator":!0,"p-highlight":t}};function WY(t,n){if(1&t){const e=xt();F(0,"li",2)(1,"button",15),Oe("click",function(r){const l=Ie(e).index;return Me(q(2).onDotClick(r,l))}),V()()}if(2&t){const e=n.index,o=q(2);B("ngClass",An(5,GY,o._page===e)),j(1),Xn(o.indicatorStyleClass),B("ngClass","p-link")("ngStyle",o.indicatorStyle)}}function qY(t,n){if(1&t&&(F(0,"ul",0),J(1,WY,2,7,"li",8),V()),2&t){const e=q();Xn(e.indicatorsContentClass),B("ngClass","p-carousel-indicators p-reset")("ngStyle",e.indicatorsContentStyle),j(1),B("ngForOf",e.totalDotsArray())}}function ZY(t,n){1&t&&Ht(0)}function KY(t,n){if(1&t&&(F(0,"div",16),Qi(1,1),J(2,ZY,1,0,"ng-container",12),V()),2&t){const e=q();j(2),B("ngTemplateOutlet",e.footerTemplate)}}const XY=[[["p-header"]],[["p-footer"]]],YY=function(t,n){return{"p-carousel p-component":!0,"p-carousel-vertical":t,"p-carousel-horizontal":n}},QY=function(t){return{height:t}},JY=["p-header","p-footer"];let hF=(()=>{class t{constructor(e,o,r,s,l){this.el=e,this.zone=o,this.cd=r,this.renderer=s,this.document=l,this.orientation="horizontal",this.verticalViewPortHeight="300px",this.contentClass="",this.indicatorsContentClass="",this.indicatorStyleClass="",this.circular=!1,this.showIndicators=!0,this.showNavigators=!0,this.autoplayInterval=0,this.onPage=new Tt,this._numVisible=1,this._numScroll=1,this._oldNumScroll=0,this.prevState={numScroll:0,numVisible:0,value:[]},this.defaultNumScroll=1,this.defaultNumVisible=1,this._page=0,this.isRemainingItemsAdded=!1,this.remainingItems=0,this.swipeThreshold=20,this.totalShiftedItems=this.page*this.numScroll*-1}get page(){return this._page}set page(e){this.isCreated&&e!==this._page&&(this.autoplayInterval&&(this.stopAutoplay(),this.allowAutoplay=!1),e>this._page&&e<=this.totalDots()-1?this.step(-1,e):e<this._page&&this.step(1,e)),this._page=e}get numVisible(){return this._numVisible}set numVisible(e){this._numVisible=e}get numScroll(){return this._numVisible}set numScroll(e){this._numScroll=e}get value(){return this._value}set value(e){this._value=e}ngOnChanges(e){e.value&&this.circular&&this._value&&this.setCloneItems(),this.isCreated&&(e.numVisible&&(this.responsiveOptions&&(this.defaultNumVisible=this.numVisible),this.isCircular()&&this.setCloneItems(),this.createStyle(),this.calculatePosition()),e.numScroll&&this.responsiveOptions&&(this.defaultNumScroll=this.numScroll))}ngAfterContentInit(){this.id=cy(),this.allowAutoplay=!!this.autoplayInterval,this.circular&&this.setCloneItems(),this.responsiveOptions&&(this.defaultNumScroll=this._numScroll,this.defaultNumVisible=this._numVisible),this.createStyle(),this.calculatePosition(),this.responsiveOptions&&this.bindDocumentListeners(),this.templates.forEach(e=>{switch(e.getType()){case"item":default:this.itemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngAfterContentChecked(){const e=this.isCircular();let o=this.totalShiftedItems;if(this.value&&this.itemsContainer&&(this.prevState.numScroll!==this._numScroll||this.prevState.numVisible!==this._numVisible||this.prevState.value.length!==this.value.length)){this.autoplayInterval&&this.stopAutoplay(),this.remainingItems=(this.value.length-this._numVisible)%this._numScroll;let r=this._page;0!==this.totalDots()&&r>=this.totalDots()&&(r=this.totalDots()-1,this._page=r,this.onPage.emit({page:this.page})),o=r*this._numScroll*-1,e&&(o-=this._numVisible),r===this.totalDots()-1&&this.remainingItems>0?(o+=-1*this.remainingItems+this._numScroll,this.isRemainingItemsAdded=!0):this.isRemainingItemsAdded=!1,o!==this.totalShiftedItems&&(this.totalShiftedItems=o),this._oldNumScroll=this._numScroll,this.prevState.numScroll=this._numScroll,this.prevState.numVisible=this._numVisible,this.prevState.value=[...this._value],this.totalDots()>0&&this.itemsContainer.nativeElement&&(this.itemsContainer.nativeElement.style.transform=this.isVertical()?`translate3d(0, ${o*(100/this._numVisible)}%, 0)`:`translate3d(${o*(100/this._numVisible)}%, 0, 0)`),this.isCreated=!0,this.autoplayInterval&&this.isAutoplay()&&this.startAutoplay()}e&&(0===this.page?o=-1*this._numVisible:0===o&&(o=-1*this.value.length,this.remainingItems>0&&(this.isRemainingItemsAdded=!0)),o!==this.totalShiftedItems&&(this.totalShiftedItems=o))}createStyle(){this.carouselStyle||(this.carouselStyle=this.renderer.createElement("style"),this.carouselStyle.type="text/css",this.renderer.appendChild(this.document.head,this.carouselStyle));let e=`\n            #${this.id} .p-carousel-item {\n\t\t\t\tflex: 1 0 ${100/this.numVisible}%\n\t\t\t}\n        `;if(this.responsiveOptions){this.responsiveOptions.sort((o,r)=>{const s=o.breakpoint,l=r.breakpoint;let h=null;return h=null==s&&null!=l?-1:null!=s&&null==l?1:null==s&&null==l?0:"string"==typeof s&&"string"==typeof l?s.localeCompare(l,void 0,{numeric:!0}):s<l?-1:s>l?1:0,-1*h});for(let o=0;o<this.responsiveOptions.length;o++){let r=this.responsiveOptions[o];e+=`\n                    @media screen and (max-width: ${r.breakpoint}) {\n                        #${this.id} .p-carousel-item {\n                            flex: 1 0 ${100/r.numVisible}%\n                        }\n                    }\n                `}}this.carouselStyle.innerHTML=e}calculatePosition(){if(this.responsiveOptions){let e={numVisible:this.defaultNumVisible,numScroll:this.defaultNumScroll};if(typeof window<"u"){let o=window.innerWidth;for(let r=0;r<this.responsiveOptions.length;r++){let s=this.responsiveOptions[r];parseInt(s.breakpoint,10)>=o&&(e=s)}}if(this._numScroll!==e.numScroll){let o=this._page;o=Math.floor(o*this._numScroll/e.numScroll);let r=e.numScroll*this.page*-1;this.isCircular()&&(r-=e.numVisible),this.totalShiftedItems=r,this._numScroll=e.numScroll,this._page=o,this.onPage.emit({page:this.page})}this._numVisible!==e.numVisible&&(this._numVisible=e.numVisible,this.setCloneItems()),this.cd.markForCheck()}}setCloneItems(){this.clonedItemsForStarting=[],this.clonedItemsForFinishing=[],this.isCircular()&&(this.clonedItemsForStarting.push(...this.value.slice(-1*this._numVisible)),this.clonedItemsForFinishing.push(...this.value.slice(0,this._numVisible)))}firstIndex(){return this.isCircular()?-1*(this.totalShiftedItems+this.numVisible):-1*this.totalShiftedItems}lastIndex(){return this.firstIndex()+this.numVisible-1}totalDots(){return this.value?.length?Math.ceil((this.value.length-this._numVisible)/this._numScroll)+1:0}totalDotsArray(){const e=this.totalDots();return e<=0?[]:Array(e).fill(0)}isVertical(){return"vertical"===this.orientation}isCircular(){return this.circular&&this.value&&this.value.length>=this.numVisible}isAutoplay(){return this.autoplayInterval&&this.allowAutoplay}isForwardNavDisabled(){return this.isEmpty()||this._page>=this.totalDots()-1&&!this.isCircular()}isBackwardNavDisabled(){return this.isEmpty()||this._page<=0&&!this.isCircular()}isEmpty(){return!this.value||0===this.value.length}navForward(e,o){(this.isCircular()||this._page<this.totalDots()-1)&&this.step(-1,o),this.autoplayInterval&&(this.stopAutoplay(),this.allowAutoplay=!1),e&&e.cancelable&&e.preventDefault()}navBackward(e,o){(this.isCircular()||0!==this._page)&&this.step(1,o),this.autoplayInterval&&(this.stopAutoplay(),this.allowAutoplay=!1),e&&e.cancelable&&e.preventDefault()}onDotClick(e,o){let r=this._page;this.autoplayInterval&&(this.stopAutoplay(),this.allowAutoplay=!1),o>r?this.navForward(e,o):o<r&&this.navBackward(e,o)}step(e,o){let r=this.totalShiftedItems;const s=this.isCircular();null!=o?(r=this._numScroll*o*-1,s&&(r-=this._numVisible),this.isRemainingItemsAdded=!1):(r+=this._numScroll*e,this.isRemainingItemsAdded&&(r+=this.remainingItems-this._numScroll*e,this.isRemainingItemsAdded=!1),o=Math.abs(Math.floor((s?r+this._numVisible:r)/this._numScroll))),s&&this.page===this.totalDots()-1&&-1===e?(r=-1*(this.value.length+this._numVisible),o=0):s&&0===this.page&&1===e?(r=0,o=this.totalDots()-1):o===this.totalDots()-1&&this.remainingItems>0&&(r+=-1*this.remainingItems-this._numScroll*e,this.isRemainingItemsAdded=!0),this.itemsContainer&&(this.itemsContainer.nativeElement.style.transform=this.isVertical()?`translate3d(0, ${r*(100/this._numVisible)}%, 0)`:`translate3d(${r*(100/this._numVisible)}%, 0, 0)`,this.itemsContainer.nativeElement.style.transition="transform 500ms ease 0s"),this.totalShiftedItems=r,this._page=o,this.onPage.emit({page:this.page})}startAutoplay(){this.interval=setInterval(()=>{this.totalDots()>0&&(this.page===this.totalDots()-1?this.step(-1,0):this.step(-1,this.page+1))},this.autoplayInterval)}stopAutoplay(){this.interval&&clearInterval(this.interval)}onTransitionEnd(){this.itemsContainer&&(this.itemsContainer.nativeElement.style.transition="",(0===this.page||this.page===this.totalDots()-1)&&this.isCircular()&&(this.itemsContainer.nativeElement.style.transform=this.isVertical()?`translate3d(0, ${this.totalShiftedItems*(100/this._numVisible)}%, 0)`:`translate3d(${this.totalShiftedItems*(100/this._numVisible)}%, 0, 0)`))}onTouchStart(e){let o=e.changedTouches[0];this.startPos={x:o.pageX,y:o.pageY}}onTouchMove(e){e.cancelable&&e.preventDefault()}onTouchEnd(e){let o=e.changedTouches[0];this.isVertical()?this.changePageOnTouch(e,o.pageY-this.startPos.y):this.changePageOnTouch(e,o.pageX-this.startPos.x)}changePageOnTouch(e,o){Math.abs(o)>this.swipeThreshold&&(o<0?this.navForward(e):this.navBackward(e))}bindDocumentListeners(){!this.documentResizeListener&&typeof window<"u"&&(this.documentResizeListener=e=>{this.calculatePosition()},window.addEventListener("resize",this.documentResizeListener))}unbindDocumentListeners(){this.documentResizeListener&&typeof window<"u"&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}ngOnDestroy(){this.responsiveOptions&&this.unbindDocumentListeners(),this.autoplayInterval&&this.stopAutoplay()}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(fi),be(Po),be(jr),be(lo))},t.\u0275cmp=on({type:t,selectors:[["p-carousel"]],contentQueries:function(e,o,r){if(1&e&&(No(r,GD,5),No(r,Uw,5),No(r,_o,4)),2&e){let s;mn(s=gn())&&(o.headerFacet=s.first),mn(s=gn())&&(o.footerFacet=s.first),mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&pi(IY,5),2&e){let r;mn(r=gn())&&(o.itemsContainer=r.first)}},hostAttrs:[1,"p-element"],inputs:{page:"page",numVisible:"numVisible",numScroll:"numScroll",responsiveOptions:"responsiveOptions",orientation:"orientation",verticalViewPortHeight:"verticalViewPortHeight",contentClass:"contentClass",indicatorsContentClass:"indicatorsContentClass",indicatorsContentStyle:"indicatorsContentStyle",indicatorStyleClass:"indicatorStyleClass",indicatorStyle:"indicatorStyle",value:"value",circular:"circular",showIndicators:"showIndicators",showNavigators:"showNavigators",autoplayInterval:"autoplayInterval",style:"style",styleClass:"styleClass"},outputs:{onPage:"onPage"},features:[ur],ngContentSelectors:JY,decls:14,vars:22,consts:[[3,"ngClass","ngStyle"],["class","p-carousel-header",4,"ngIf"],[3,"ngClass"],[1,"p-carousel-container"],["type","button","pRipple","",3,"ngClass","disabled","click",4,"ngIf"],[1,"p-carousel-items-content",3,"ngStyle"],[1,"p-carousel-items-container",3,"transitionend","touchend","touchstart","touchmove"],["itemsContainer",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass","class","ngStyle",4,"ngIf"],["class","p-carousel-footer",4,"ngIf"],[1,"p-carousel-header"],[4,"ngTemplateOutlet"],["type","button","pRipple","",3,"ngClass","disabled","click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button",3,"ngClass","ngStyle","click"],[1,"p-carousel-footer"]],template:function(e,o){1&e&&(or(XY),F(0,"div",0),J(1,AY,3,1,"div",1),F(2,"div",2)(3,"div",3),J(4,RY,2,8,"button",4),F(5,"div",5)(6,"div",6,7),Oe("transitionend",function(){return o.onTransitionEnd()})("touchend",function(s){return o.onTouchEnd(s)})("touchstart",function(s){return o.onTouchStart(s)})("touchmove",function(s){return o.onTouchMove(s)}),J(8,FY,2,9,"div",8),J(9,BY,2,9,"div",8),J(10,UY,2,9,"div",8),V()(),J(11,$Y,2,8,"button",4),V(),J(12,qY,2,5,"ul",9),V(),J(13,KY,3,1,"div",10),V()),2&e&&(Xn(o.styleClass),B("ngClass",no(17,YY,o.isVertical(),!o.isVertical()))("ngStyle",o.style),st("id",o.id),j(1),B("ngIf",o.headerFacet||o.headerTemplate),j(1),Xn(o.contentClass),B("ngClass","p-carousel-content"),j(2),B("ngIf",o.showNavigators),j(1),B("ngStyle",An(20,QY,o.isVertical()?o.verticalViewPortHeight:"auto")),j(3),B("ngForOf",o.clonedItemsForStarting),j(1),B("ngForOf",o.value),j(1),B("ngForOf",o.clonedItemsForFinishing),j(1),B("ngIf",o.showNavigators),j(1),B("ngIf",o.showIndicators),j(1),B("ngIf",o.footerFacet||o.footerTemplate))},dependencies:[Eo,Ms,mi,Is,Oo,vd],styles:[".p-carousel{display:flex;flex-direction:column}.p-carousel-content{display:flex;flex-direction:column;overflow:auto}.p-carousel-prev,.p-carousel-next{align-self:center;flex-grow:0;flex-shrink:0;display:flex;justify-content:center;align-items:center;overflow:hidden;position:relative}.p-carousel-container{display:flex;flex-direction:row}.p-carousel-items-content{overflow:hidden;width:100%}.p-carousel-items-container{display:flex;flex-direction:row}.p-carousel-indicators{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap}.p-carousel-indicator>button{display:flex;align-items:center;justify-content:center}.p-carousel-vertical .p-carousel-container{flex-direction:column}.p-carousel-vertical .p-carousel-items-container{flex-direction:column;height:100%}.p-items-hidden .p-carousel-item{visibility:hidden}.p-items-hidden .p-carousel-item.p-carousel-item-active{visibility:visible}\n"],encapsulation:2,changeDetection:0}),t})(),pF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,is,il,Ei,is]}),t})();function eQ(t,n){1&t&&(F(0,"h3",6),ce(1," Mis amigos "),V())}function tQ(t,n){if(1&t&&(F(0,"div",7)(1,"div",8)(2,"div",9),Ne(3,"img",10),V(),F(4,"div")(5,"h4",11),ce(6),V()(),F(7,"div")(8,"h5",12),ce(9),V()(),F(10,"div")(11,"button",13)(12,"span",14),ce(13," Ver perfil "),V()()()()()),2&t){const e=n.$implicit;j(3),To("src",e.image,Co),B("alt",e.name),j(3),Jt(e.name),j(3),Jt(e.nickname)}}function nQ(t,n){if(1&t&&(F(0,"p-carousel",3),J(1,eQ,2,0,"ng-template",4),J(2,tQ,14,4,"ng-template",5),V()),2&t){const e=q();B("value",e.friends)("numVisible",7)("numScroll",7)("circular",!0)("responsiveOptions",e.responsiveOptions)("showIndicators",!0)}}let fF=(()=>{class t{constructor(){this.responsiveOptions=[{breakpoint:"2200px",numVisible:5,numScroll:5},{breakpoint:"1800px",numVisible:4,numScroll:4},{breakpoint:"1600px",numVisible:3,numScroll:3},{breakpoint:"1400px",numVisible:2,numScroll:2},{breakpoint:"950px",numVisible:1,numScroll:1},{breakpoint:"699px",numVisible:2,numScroll:2},{breakpoint:"600px",numVisible:1,numScroll:1}]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-friends-carousel"]],inputs:{friends:"friends"},decls:4,vars:1,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers-carousel"],[3,"value","numVisible","numScroll","circular","responsiveOptions","showIndicators",4,"ngIf"],[3,"value","numVisible","numScroll","circular","responsiveOptions","showIndicators"],["pTemplate","header"],["pTemplate","item"],[1,"mb-4","ml-3","show-titles-sm"],[1,"product-item"],[1,"product-item-content",2,"display","flex","flex-direction","column","align-items","center"],[1,"mb-3","mx-auto","mt-2","overflow-hidden",2,"height","180px","width","180px","border-radius","100%","box-shadow","var(--shadows)"],[2,"height","180px","width","180px","object-fit","cover",3,"src","alt"],[1,"mb-1"],[1,"mt-0","mb-3","font-normal"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient","mb-2"],[1,"vibe-btn-text-white","font-normal","text-xs"]],template:function(e,o){1&e&&(F(0,"h3",0),ce(1," Mis amigos "),V(),F(2,"div",1),J(3,nQ,3,6,"p-carousel",2),V()),2&e&&(j(3),B("ngIf",0!=(null==o.friends?null:o.friends.length)))},dependencies:[mi,os,hF,_o]}),t})();function iQ(t,n){if(1&t&&(F(0,"div",22)(1,"h1",23),ce(2),V()()),2&t){const e=q();j(2),ei(" ",e.appLayout.currentRoute," ")}}function oQ(t,n){1&t&&(F(0,"div",24)(1,"span",25),ce(2,"Introduzca un nombre de usuario"),V()())}function rQ(t,n){if(1&t&&Ne(0,"app-friends-table",26),2&t){const e=q();B("@onEnterDisolve",void 0)("friends",e.misAmigos)("loading",e.loading)}}const sQ=function(t,n){return{"elastic-height":t,"elastic-height-active":n}};let aQ=(()=>{class t{constructor(e,o){this.router=e,this.appLayout=o,this.loading=!0,this.showFriendsTable=!1,this.searchForm=new tl({})}getImage(){return"assets/images/"+Math.floor(5*Math.random())+".png"}ngOnInit(){this.searchForm=new tl({nickname:new gs(this.nickname,[ms.required])}),this.image=this.getImage(),this.misAmigos=[{name:"Pilar Ester",nickname:"pichula",image:"https://media.licdn.com/dms/image/C4D03AQGhTmQp0J-eUw/profile-displayphoto-shrink_200_200/0/1646170721207?e=1684368000&v=beta&t=GrPpweOwHS4uTOiwQ9Vvg3pwY4crqQq7yKPf2DZas7g"},{name:"Jaime Roncal",nickname:"jaima",image:"https://media.licdn.com/dms/image/D4D03AQGlULIm-un43A/profile-displayphoto-shrink_800_800/0/1670712145849?e=2147483647&v=beta&t=LRBX_xAxtl7jymxEzR16l_88BGRmIGIchXsKn1rT3RY"},{name:"Loreto Matinero",nickname:"loretixx",image:"https://media.tenor.com/XSCFKXi06sAAAAAC/felix-argyle-cute.gif"},{name:"Nacho Ortega",nickname:"pikanachi",image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif"}]}onSubmit(e){var o=this;return hu(function*(){o.loading=!0,console.log("Valid?",e.valid),o.showFriendsTable=!0,yield new Promise(r=>setTimeout(r,5e3)),o.loading=!1})()}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-friends"]],decls:25,vars:11,consts:[["class","route-name",4,"ngIf"],[1,"content"],[1,"card","w-full","container-image"],[1,"grid","grid-nogutter","min-height"],[1,"col-12","lg:col-6","p-5","flex","align-items-center"],[1,"h-14rem","grid","w-full","m-0"],[1,"w-full","text-aligment"],[1,"mt-0","mb-2","text-gradient","w-fit","margin-text-gradient","search-friends-text"],[1,"mt-0","mb-2","font-semibold"],[1,"mt-0","mb-4","font-light","text-base"],[2,"max-width","600px",3,"formGroup","ngSubmit"],[1,"p-inputgroup"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-users"],["id","nickname","name","nickname","formControlName","nickname","placeholder","Nombre de usuario","type","text","pInputText","",1,"form-control","h-3rem"],["type","submit","pButton","","pRipple","","icon","pi pi-search","styleClass","p-button-danger",1,"button-gradient-45","w-3rem",2,"border-top-left-radius","0 !important","border-bottom-left-radius","0 !important",3,"disabled"],["class","mb-2 flex",4,"ngIf"],[1,"col-12","lg:col-6","overflow-hidden"],["alt","Spotivibes",1,"md:ml-auto","block","h-full","w-full","poligon-clip",2,"object-fit","cover",3,"src"],[3,"ngClass"],[3,"friends","loading",4,"ngIf"],[3,"friends"],[1,"route-name"],[1,"current-route"],[1,"mb-2","flex"],[1,"text-base","mt-2",2,"color","var(--validationErrors)"],[3,"friends","loading"]],template:function(e,o){if(1&e&&(J(0,iQ,3,1,"div",0),F(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"section",5)(6,"div",6)(7,"h1",7),ce(8," Buscar amigos"),V(),F(9,"h3",8),ce(10," Tus vibes suenan mejor con amigos"),V(),F(11,"h3",9),ce(12," B\xfascalos aqu\xed"),V(),F(13,"form",10),Oe("ngSubmit",function(){return o.onSubmit(o.searchForm)}),F(14,"div",11)(15,"span",12),Ne(16,"i",13),V(),Ne(17,"input",14)(18,"button",15),V(),J(19,oQ,3,0,"div",16),V()()()(),F(20,"div",17),Ne(21,"img",18),V()()(),F(22,"div",19),J(23,rQ,1,3,"app-friends-table",20),V(),Ne(24,"app-friends-carousel",21),V()),2&e){let r;B("ngIf",!o.appLayout.showBar),j(13),B("formGroup",o.searchForm),j(5),B("disabled",!o.searchForm.valid),j(1),B("ngIf",(null==(r=o.searchForm.get("nickname"))?null:r.hasError("required"))&&(o.searchForm.controls.nickname.dirty||o.searchForm.controls.nickname.touched)),j(2),To("src",o.image,Co),j(1),B("ngClass",no(8,sQ,!o.showFriendsTable,o.showFriendsTable)),j(1),B("ngIf",o.showFriendsTable),j(1),B("friends",o.misAmigos)}},dependencies:[Eo,mi,tf,dd,Tl,ef,pd,nf,os,fc,MY,fF],styles:["[_nghost-%COMP%]{width:100%}.poligon-clip[_ngcontent-%COMP%]{transition:var(--transition);clip-path:polygon(15% 0,100% 0,100% 100%,0 100%);border-top-right-radius:10px;border-bottom-right-radius:10px}.container-image[_ngcontent-%COMP%]{transition:var(--transition);border-radius:10px;background-color:var(--containerBackground);margin-bottom:3rem}.elastic-height[_ngcontent-%COMP%]{transition:var(--transition);transition:all 3s;max-height:0px}.elastic-height-active[_ngcontent-%COMP%]{transition:all 3s;max-height:5000px}.min-height[_ngcontent-%COMP%]{min-height:500px}.text-aligment[_ngcontent-%COMP%]{text-align:left}.search-friends-text[_ngcontent-%COMP%]{transition:var(--transition);font-size:3rem}@media (max-width: 1200px){.container-image[_ngcontent-%COMP%]{margin-bottom:1.5rem}}@media (max-width: 900px){.container-image[_ngcontent-%COMP%]{margin-bottom:16px}}@media (max-width: 991px){.poligon-clip[_ngcontent-%COMP%]{clip-path:polygon(0 0,100% 0,100% 100%,0 100%);border-top-right-radius:0;border-bottom-right-radius:10px;border-bottom-left-radius:10px}.min-height[_ngcontent-%COMP%]{min-height:300px}.text-aligment[_ngcontent-%COMP%]{text-align:center}.margin-text-gradient[_ngcontent-%COMP%]{margin:auto!important;margin-bottom:.5rem!important}.search-friends-text[_ngcontent-%COMP%]{transition:var(--transition);font-size:2.5rem}}"],data:{animation:[cc("onEnterDisolve",[rr(":enter",[go({opacity:0,animation:"disolve 0.8s"}),Ho(1e3)])])]}}),t})();var xd=dt(898),cQ=dt(545);let uQ=(()=>{class t{constructor(e){this.el=e}onkeydown(e){if(!0!==this.pFocusTrapDisabled){e.preventDefault();const o=Fe.getNextFocusableElement(this.el.nativeElement,e.shiftKey);o&&(o.focus(),o.select?.())}}}return t.\u0275fac=function(e){return new(e||t)(be(si))},t.\u0275dir=kn({type:t,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],hostBindings:function(e,o){1&e&&Oe("keydown.tab",function(s){return o.onkeydown(s)})("keydown.shift.tab",function(s){return o.onkeydown(s)})},inputs:{pFocusTrapDisabled:"pFocusTrapDisabled"}}),t})(),dQ=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();const hQ=["titlebar"],pQ=["content"],fQ=["footer"];function mQ(t,n){if(1&t){const e=xt();F(0,"div",11),Oe("mousedown",function(r){return Ie(e),Me(q(3).initResize(r))}),V()}}function gQ(t,n){if(1&t&&(F(0,"span",18),ce(1),V()),2&t){const e=q(4);st("id",e.id+"-label"),j(1),Jt(e.header)}}function _Q(t,n){1&t&&(F(0,"span",18),Qi(1,1),V()),2&t&&st("id",q(4).id+"-label")}function yQ(t,n){1&t&&Ht(0)}const vQ=function(){return{"p-dialog-header-icon p-dialog-header-maximize p-link":!0}};function bQ(t,n){if(1&t){const e=xt();F(0,"button",19),Oe("click",function(){return Ie(e),Me(q(4).maximize())})("keydown.enter",function(){return Ie(e),Me(q(4).maximize())}),Ne(1,"span",20),V()}if(2&t){const e=q(4);B("ngClass",ai(2,vQ)),j(1),B("ngClass",e.maximized?e.minimizeIcon:e.maximizeIcon)}}const xQ=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function wQ(t,n){if(1&t){const e=xt();F(0,"button",21),Oe("click",function(r){return Ie(e),Me(q(4).close(r))})("keydown.enter",function(r){return Ie(e),Me(q(4).close(r))}),Ne(1,"span",22),V()}if(2&t){const e=q(4);B("ngClass",ai(4,xQ)),st("aria-label",e.closeAriaLabel)("tabindex",e.closeTabindex),j(1),B("ngClass",e.closeIcon)}}function CQ(t,n){if(1&t){const e=xt();F(0,"div",12,13),Oe("mousedown",function(r){return Ie(e),Me(q(3).initDrag(r))}),J(2,gQ,2,2,"span",14),J(3,_Q,2,1,"span",14),J(4,yQ,1,0,"ng-container",9),F(5,"div",15),J(6,bQ,2,3,"button",16),J(7,wQ,2,5,"button",17),V()()}if(2&t){const e=q(3);j(2),B("ngIf",!e.headerFacet&&!e.headerTemplate),j(1),B("ngIf",e.headerFacet),j(1),B("ngTemplateOutlet",e.headerTemplate),j(2),B("ngIf",e.maximizable),j(1),B("ngIf",e.closable)}}function TQ(t,n){1&t&&Ht(0)}function EQ(t,n){1&t&&Ht(0)}function SQ(t,n){if(1&t&&(F(0,"div",23,24),Qi(2,2),J(3,EQ,1,0,"ng-container",9),V()),2&t){const e=q(3);j(3),B("ngTemplateOutlet",e.footerTemplate)}}const DQ=function(t,n,e,o){return{"p-dialog p-component":!0,"p-dialog-rtl":t,"p-dialog-draggable":n,"p-dialog-resizable":e,"p-dialog-maximized":o}},MQ=function(t,n){return{transform:t,transition:n}},IQ=function(t){return{value:"visible",params:t}};function kQ(t,n){if(1&t){const e=xt();F(0,"div",3,4),Oe("@animation.start",function(r){return Ie(e),Me(q(2).onAnimationStart(r))})("@animation.done",function(r){return Ie(e),Me(q(2).onAnimationEnd(r))}),J(2,mQ,1,0,"div",5),J(3,CQ,8,5,"div",6),F(4,"div",7,8),Qi(6),J(7,TQ,1,0,"ng-container",9),V(),J(8,SQ,4,1,"div",10),V()}if(2&t){const e=q(2);Xn(e.styleClass),B("ngClass",Th(15,DQ,e.rtl,e.draggable,e.resizable,e.maximized))("ngStyle",e.style)("pFocusTrapDisabled",!1===e.focusTrap)("@animation",An(23,IQ,no(20,MQ,e.transformOptions,e.transitionOptions))),st("aria-labelledby",e.id+"-label"),j(2),B("ngIf",e.resizable),j(1),B("ngIf",e.showHeader),j(1),Xn(e.contentStyleClass),B("ngClass","p-dialog-content")("ngStyle",e.contentStyle),j(3),B("ngTemplateOutlet",e.contentTemplate),j(1),B("ngIf",e.footerFacet||e.footerTemplate)}}const AQ=function(t,n,e,o,r,s,l,h,g,b){return{"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":t,"p-dialog-mask-scrollblocker":n,"p-dialog-left":e,"p-dialog-right":o,"p-dialog-top":r,"p-dialog-top-left":s,"p-dialog-top-right":l,"p-dialog-bottom":h,"p-dialog-bottom-left":g,"p-dialog-bottom-right":b}};function PQ(t,n){if(1&t&&(F(0,"div",1),J(1,kQ,9,25,"div",2),V()),2&t){const e=q();Xn(e.maskStyleClass),B("ngClass",rE(4,AQ,[e.modal,e.modal||e.blockScroll,"left"===e.position,"right"===e.position,"top"===e.position,"topleft"===e.position||"top-left"===e.position,"topright"===e.position||"top-right"===e.position,"bottom"===e.position,"bottomleft"===e.position||"bottom-left"===e.position,"bottomright"===e.position||"bottom-right"===e.position])),j(1),B("ngIf",e.visible)}}const OQ=["*",[["p-header"]],[["p-footer"]]],RQ=["*","p-header","p-footer"],LQ=af([go({transform:"{{transform}}",opacity:0}),Ho("{{transition}}")]),FQ=af([Ho("{{transition}}",go({transform:"{{transform}}",opacity:0}))]);let mu=(()=>{class t{constructor(e,o,r,s,l){this.el=e,this.renderer=o,this.zone=r,this.cd=s,this.config=l,this.draggable=!0,this.resizable=!0,this.closeOnEscape=!0,this.closable=!0,this.showHeader=!0,this.blockScroll=!1,this.autoZIndex=!0,this.baseZIndex=0,this.minX=0,this.minY=0,this.focusOnShow=!0,this.keepInViewport=!0,this.focusTrap=!0,this.transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)",this.closeIcon="pi pi-times",this.closeTabindex="-1",this.minimizeIcon="pi pi-window-minimize",this.maximizeIcon="pi pi-window-maximize",this.onShow=new Tt,this.onHide=new Tt,this.visibleChange=new Tt,this.onResizeInit=new Tt,this.onResizeEnd=new Tt,this.onDragEnd=new Tt,this.onMaximize=new Tt,this.id=cy(),this._style={},this._position="center",this.transformOptions="scale(0.7)"}get positionLeft(){return 0}set positionLeft(e){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(e){console.log("positionTop property is deprecated.")}get responsive(){return!1}set responsive(e){console.log("Responsive property is deprecated.")}get breakpoint(){return 649}set breakpoint(e){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"content":default:this.contentTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngOnInit(){this.breakpoints&&this.createStyle()}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(e){e&&(this._style={...e},this.originalStyle=e)}get position(){return this._position}set position(e){switch(this._position=e,e){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}focus(){let e=Fe.findSingle(this.container,"[autofocus]");e&&this.zone.runOutsideAngular(()=>{setTimeout(()=>e.focus(),5)})}close(e){this.visibleChange.emit(!1),e.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.close(e)})),this.modal&&Fe.addClass(document.body,"p-overflow-hidden")}disableModality(){this.wrapper&&(this.dismissableMask&&this.unbindMaskClickListener(),this.modal&&Fe.removeClass(document.body,"p-overflow-hidden"),this.cd.destroyed||this.cd.detectChanges())}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?Fe.addClass(document.body,"p-overflow-hidden"):Fe.removeClass(document.body,"p-overflow-hidden")),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(ns.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if(!this.styleElement){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement);let e="";for(let o in this.breakpoints)e+=`\n                    @media screen and (max-width: ${o}) {\n                        .p-dialog[${this.id}] {\n                            width: ${this.breakpoints[o]} !important;\n                        }\n                    }\n                `;this.styleElement.innerHTML=e}}initDrag(e){Fe.hasClass(e.target,"p-dialog-header-icon")||Fe.hasClass(e.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,this.container.style.margin="0",Fe.addClass(document.body,"p-unselectable-text"))}onKeydown(e){if(this.focusTrap&&9===e.which){e.preventDefault();let o=Fe.getFocusableElements(this.container);if(o&&o.length>0)if(o[0].ownerDocument.activeElement){let r=o.indexOf(o[0].ownerDocument.activeElement);e.shiftKey?-1==r||0===r?o[o.length-1].focus():o[r-1].focus():-1==r||r===o.length-1?o[0].focus():o[r+1].focus()}else o[0].focus()}}onDrag(e){if(this.dragging){let o=Fe.getOuterWidth(this.container),r=Fe.getOuterHeight(this.container),s=e.pageX-this.lastPageX,l=e.pageY-this.lastPageY,h=this.container.getBoundingClientRect(),g=h.left+s,b=h.top+l,T=Fe.getViewport();this.container.style.position="fixed",this.keepInViewport?(g>=this.minX&&g+o<T.width&&(this._style.left=g+"px",this.lastPageX=e.pageX,this.container.style.left=g+"px"),b>=this.minY&&b+r<T.height&&(this._style.top=b+"px",this.lastPageY=e.pageY,this.container.style.top=b+"px")):(this.lastPageX=e.pageX,this.container.style.left=g+"px",this.lastPageY=e.pageY,this.container.style.top=b+"px")}}endDrag(e){this.dragging&&(this.dragging=!1,Fe.removeClass(document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(e))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(e){this.resizable&&(this.resizing=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,Fe.addClass(document.body,"p-unselectable-text"),this.onResizeInit.emit(e))}onResize(e){if(this.resizing){let o=e.pageX-this.lastPageX,r=e.pageY-this.lastPageY,s=Fe.getOuterWidth(this.container),l=Fe.getOuterHeight(this.container),h=Fe.getOuterHeight(this.contentViewChild.nativeElement),g=s+o,b=l+r,T=this.container.style.minWidth,I=this.container.style.minHeight,R=this.container.getBoundingClientRect(),z=Fe.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(g+=o,b+=r),(!T||g>parseInt(T))&&R.left+g<z.width&&(this._style.width=g+"px",this.container.style.width=this._style.width),(!I||b>parseInt(I))&&R.top+b<z.height&&(this.contentViewChild.nativeElement.style.height=h+b-l+"px",this._style.height&&(this._style.height=b+"px",this.container.style.height=this._style.height)),this.lastPageX=e.pageX,this.lastPageY=e.pageY}}resizeEnd(e){this.resizing&&(this.resizing=!1,Fe.removeClass(document.body,"p-unselectable-text"),this.onResizeEnd.emit(e))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.zone.runOutsideAngular(()=>{this.documentDragListener=this.onDrag.bind(this),window.document.addEventListener("mousemove",this.documentDragListener)})}unbindDocumentDragListener(){this.documentDragListener&&(window.document.removeEventListener("mousemove",this.documentDragListener),this.documentDragListener=null)}bindDocumentDragEndListener(){this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.endDrag.bind(this),window.document.addEventListener("mouseup",this.documentDragEndListener)})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(window.document.removeEventListener("mouseup",this.documentDragEndListener),this.documentDragEndListener=null)}bindDocumentResizeListeners(){this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.onResize.bind(this),this.documentResizeEndListener=this.resizeEnd.bind(this),window.document.addEventListener("mousemove",this.documentResizeListener),window.document.addEventListener("mouseup",this.documentResizeEndListener)})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(window.document.removeEventListener("mousemove",this.documentResizeListener),window.document.removeEventListener("mouseup",this.documentResizeEndListener),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",o=>{27==o.which&&this.close(o)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.wrapper):Fe.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.wrapper=this.container.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&Fe.addClass(document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&Fe.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(e){switch(e.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({})}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(Fe.removeClass(document.body,"p-overflow-hidden"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&Fe.removeClass(document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&ns.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?{...this.originalStyle}:{}}destroyStyle(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(jr),be(fi),be(Po),be(Il))},t.\u0275cmp=on({type:t,selectors:[["p-dialog"]],contentQueries:function(e,o,r){if(1&e&&(No(r,GD,5),No(r,Uw,5),No(r,_o,4)),2&e){let s;mn(s=gn())&&(o.headerFacet=s.first),mn(s=gn())&&(o.footerFacet=s.first),mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(hQ,5),pi(pQ,5),pi(fQ,5)),2&e){let r;mn(r=gn())&&(o.headerViewChild=r.first),mn(r=gn())&&(o.contentViewChild=r.first),mn(r=gn())&&(o.footerViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:"draggable",resizable:"resizable",positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:"modal",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",rtl:"rtl",closable:"closable",responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",showHeader:"showHeader",breakpoint:"breakpoint",blockScroll:"blockScroll",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",minX:"minX",minY:"minY",focusOnShow:"focusOnShow",maximizable:"maximizable",keepInViewport:"keepInViewport",focusTrap:"focusTrap",transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},ngContentSelectors:RQ,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],["container",""],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["content",""],[4,"ngTemplateOutlet"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["titlebar",""],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],["type","button","pRipple","",3,"ngClass","click","keydown.enter"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"],["footer",""]],template:function(e,o){1&e&&(or(OQ),J(0,PQ,2,15,"div",0)),2&e&&B("ngIf",o.maskVisible)},dependencies:[Eo,mi,Is,Oo,uQ,vd],styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[cc("animation",[rr("void => visible",[Q_(LQ)]),rr("visible => void",[Q_(FQ)])])]},changeDetection:0}),t})(),nM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,dQ,il,is]}),t})();function zQ(t,n){1&t&&(F(0,"div",11)(1,"h2",12),ce(2,"A\xf1adir a playlist"),V()())}function NQ(t,n){if(1&t&&(F(0,"div",14)(1,"div"),ce(2),V()()),2&t){const e=q(2);j(2),Jt(e.selectedPlaylist.name)}}function BQ(t,n){1&t&&J(0,NQ,3,1,"div",13),2&t&&B("ngIf",q().selectedPlaylist)}const VQ=function(){return{width:"600px",transition:"all 500ms"}},UQ=function(){return{"650px":"95vw"}};let mF=(()=>{class t{constructor(){this.hide=new Tt}ngOnInit(){this.playlists=[{id:1,name:"Lo mejor de 2020"},{id:2,name:"De paseo por el campo"},{id:3,name:"Para el gimnasio"},{id:4,name:"Para el coche"},{id:5,name:"Para la ducha"},{id:6,name:"De camino a la EINA"},{id:7,name:"Viaje a Tokyo"},{id:8,name:"Road trip por Espa\xf1ita"}]}onCancel(){this.hide.emit(!1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-add-to-playlist-dialog"]],inputs:{display:"display"},outputs:{hide:"hide"},decls:20,vars:12,consts:[[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[1,""],[1,"mt-3"],["optionLabel","name","filterBy","name","emptyMessage","Ning\xfan resultado","emptyFilterMessage","Ning\xfan resultado","placeholder","Selecciona una Playlist",3,"options","ngModel","filter","showClear","ngModelChange"],["pTemplate","selectedItem"],["pButton","","pRipple","",1,"mt-3","mb-5","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"],["pButton","","pRipple","",1,"mt-3","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"],["class","country-item country-item-value",4,"ngIf"],[1,"country-item","country-item-value"]],template:function(e,o){1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.display=s})("onHide",function(){return o.onCancel()}),J(1,zQ,3,0,"ng-template",1),F(2,"div",2)(3,"label"),ce(4,"A\xf1ade el vibe a una playlist existente:"),V(),F(5,"div",3)(6,"p-dropdown",4),Oe("ngModelChange",function(s){return o.selectedPlaylist=s}),J(7,BQ,1,1,"ng-template",5),V()(),F(8,"button",6)(9,"div",7)(10,"span",8)(11,"p",9),ce(12," A\xf1adir a playlist "),V()()()(),F(13,"label"),ce(14,"O crea una nueva playlist:"),V(),F(15,"button",10)(16,"div",7)(17,"span",8)(18,"p",9),ce(19," Crear nueva playlist "),V()()()()()()),2&e&&(Ao(ai(10,VQ)),B("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",ai(11,UQ)),j(6),B("options",o.playlists)("ngModel",o.selectedPlaylist)("filter",!0)("showClear",!0))},dependencies:[mi,KD,_o,mu,Tl,hd,os],styles:["[_nghost-%COMP%]     .p-dialog-content{overflow:visible}[_nghost-%COMP%]     .p-dropdown{width:100%}[_nghost-%COMP%]     .p-dialog .p-dialog-content{padding-top:0}[_nghost-%COMP%]     .p-component{width:100%!important;box-shadow:none!important}[_nghost-%COMP%]     .p-overlay-content{width:100%}[_nghost-%COMP%]     .p-dropdown-panel{display:block!important}[_nghost-%COMP%]     .p-dropdown-label{width:100%}[_nghost-%COMP%]     .p-dropdown-panel{border-radius:10px!important}[_nghost-%COMP%]     .p-dropdown-filter{border-radius:10px!important}[_nghost-%COMP%]     .p-dropdown{border-radius:10px!important}[_nghost-%COMP%]     .p-button:last-of-type{border-radius:10px!important}p[_ngcontent-%COMP%]{margin:0}"]}),t})(),iM=(()=>{class t{constructor(e,o){this.router=e,this.appLayout=o,this.playlistToAdd=-1,this.displayDialog=!1}ngAfterViewInit(){if(xd.accessToken="pk.eyJ1IjoibG9yZXRvbWF0aW5lcm8iLCJhIjoiY2xnNDE5MGZqMGFhMzNqbTI1azMycjN1NCJ9.EICwhWtdvj6MTYYXbftHow",this.mapa=new xd.Map({container:this.id,style:"mapbox://styles/mapbox/streets-v12",center:[-.9102102,41.6731606],zoom:11.15,cooperativeGestures:!0}),this.showLocationButton&&this.mapa.addControl(new xd.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),this.showSearchBar){const e=new cQ({accessToken:xd.accessToken,placeholder:"Buscar",mapboxgl:xd,marker:!1,enableGeolocation:!0});this.mapa.addControl(e,"top-left")}this.mapa.addControl(new xd.NavigationControl,"bottom-right"),this.mapa.on("load",()=>{for(const e of this.vibes)this.crearMarcadorPersonalizado(e.id,e.private,e.lng,e.lat,e.title,e.author,e.image,e.creator,e.description,e.fecha)})}hideDialogPlaylist(e){this.displayDialog=e}addToPlaylist(e){console.log("Add to playlist",e),this.displayDialog=!0}crearMarcador(e,o){const r=(new xd.Popup).setHTML("<h3>Mi ubicacion</h3><p> Esta es mi ubicacion con mapbox</p>"),s=new xd.Marker({draggable:!1,color:"purple"}).setLngLat([e,o]).setPopup(r).addTo(this.mapa);s.on("drag",()=>{console.log(s.getLngLat())})}crearMarcadorPersonalizado(e,o,r,s,l,h,g,b,T,I){const R=document.createElement("div");R.style.display="flex",R.style.maxWidth="100%";const z=document.createElement("div");z.style.display="flex",z.style.height="auto",z.style.width="209px";const W=document.createElement("img");W.src=g,W.style.height="209px",W.style.width="209px",W.style.borderRadius="5px",W.style.boxShadow="var(--shadowsMapBtn)",W.style.objectFit="cover",z.appendChild(W),R.appendChild(z);const X=document.createElement("div");X.style.flex="2",X.style.display="flex",X.style.flexDirection="column",X.style.height="auto",X.style.marginLeft="20px";const ee=document.createElement("h4");ee.style.marginRight="20px",ee.textContent=l,X.appendChild(ee);const le=document.createElement("h4");if(le.textContent=h,le.style.fontWeight="normal",le.style.marginTop="5px",X.appendChild(le),3==o){const Ut=document.createElement("input");Ut.type="text",Ut.value=T,Ut.style.marginTop="5px",Ut.style.fontWeight="normal",X.appendChild(Ut)}else{const Ut=document.createElement("h5");Ut.textContent=T,Ut.style.marginTop="5px",Ut.style.fontWeight="normal",X.appendChild(Ut)}const ve=document.createElement("h5");ve.textContent=b+" \xb7 "+I+" \xb7 3 likes",ve.style.fontWeight="normal",ve.style.marginTop="5px",X.appendChild(ve);const xe=document.createElement("div");xe.style.display="grid",xe.style.marginTop="5px";const Be=document.createElement("button");Be.textContent="Escuchar en Spotify",Be.className="spotybtn",Be.style.marginTop="10px",Be.style.marginRight="0px",Be.style.height="35px",Be.style.fontSize="var(--buttonsFontSize)",Be.style.boxShadow="var(--shadowsMapBtn)",Be.onclick=function(){},xe.appendChild(Be);const Ke=document.createElement("button");Ke.textContent="A\xf1adir a playlist",Ke.className="playlistbtn",Ke.style.marginTop="10px",Ke.style.height="35px",Ke.style.marginRight="0px",Ke.style.fontSize="var(--buttonsFontSize)",Ke.style.boxShadow="var(--shadowsMapBtn)",Ke.addEventListener("click",Ut=>{console.log("Button clicked"),this.addToPlaylist(e)}),xe.appendChild(Ke),X.appendChild(xe),R.appendChild(X);const ft=new xd.Popup({offset:25}).setDOMContent(R);ft.setMaxWidth("auto");const Vt=document.createElement("div");Vt.style.backgroundImage='url("/../../assets/images/spotivibesLogo.png")',Vt.style.width="40px",Vt.style.height="50px",Vt.style.backgroundSize="100%",console.log("el=",Vt);const Nt=new xd.Marker(Vt).setLngLat([r,s]).setPopup(ft).addTo(this.mapa);console.log(Nt.getLngLat())}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-map-vibes"]],inputs:{vibes:"vibes",id:"id",mapHeight:"mapHeight",showSearchBar:"showSearchBar",showLocationButton:"showLocationButton"},decls:2,vars:4,consts:[[1,"body-map",3,"id"],[3,"display","hide"]],template:function(e,o){1&e&&(Ne(0,"div",0),F(1,"app-add-to-playlist-dialog",1),Oe("hide",function(s){return o.hideDialogPlaylist(s)}),V()),2&e&&(aa("height",o.mapHeight),To("id",o.id),j(1),B("display",o.displayDialog))},dependencies:[mF],styles:[".marker[_ngcontent-%COMP%]{width:40px;height:40px;background-size:cover;background-repeat:no-repeat;background-position:center}.body-map[_ngcontent-%COMP%]{width:100%;border-radius:10px;box-shadow:var(--shadows)!important}[_nghost-%COMP%]     .mapboxgl-popup{width:auto}[_nghost-%COMP%]     .mapboxgl-popup-content{background:var(--frostedBackground)!important;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)!important;border-radius:10px;width:500px;padding:20px;box-shadow:var(--shadowsMap)}  .mapboxgl-popup-anchor-top   .mapboxgl-popup-tip{border-bottom-color:var(--MapTip)}  .mapboxgl-popup-anchor-bottom   .mapboxgl-popup-tip{border-top-color:var(--MapTip)}  .mapboxgl-popup-anchor-left   .mapboxgl-popup-tip{border-right-color:var(--MapTip)}  .mapboxgl-popup-anchor-right   .mapboxgl-popup-tip{border-left-color:var(--MapTip)}  .mapboxgl-popup-anchor-top-left   .mapboxgl-popup-tip{display:none}  .mapboxgl-popup-anchor-bottom-left   .mapboxgl-popup-tip{display:none}  .mapboxgl-popup-anchor-top-right   .mapboxgl-popup-tip{display:none}  .mapboxgl-popup-anchor-bottom-right   .mapboxgl-popup-tip{display:none}  .mapboxgl-ctrl{display:flex;align-items:center}  a.mapboxgl-ctrl-logo{display:none}  .mapboxgl-ctrl-attrib-inner{display:none}  .mapboxgl-popup-close-button{height:30px;width:30px;font-size:1.25rem;margin:15px;display:flex;align-items:center;justify-content:center;border-radius:100%;color:var(--fontColor)}  .mapboxgl-ctrl-zoom-out{border:none!important}  .mapboxgl-ctrl-compass{border:none!important}  .mapboxgl-map{border-radius:10px!important;-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC)}  .mapboxgl-ctrl-geocoder   .mapboxgl-ctrl-geocoder--pin-right>*{top:auto}  .mapboxgl-ctrl-geocoder--pin-right{display:flex;align-items:center}  .mapboxgl-ctrl-attrib{display:none!important}  .mapboxgl-ctrl-geocoder--powered-by{display:none!important}"]}),t})();function jQ(t,n){if(1&t&&(F(0,"div",10)(1,"div",11)(2,"div",3),Ne(3,"img",12),V(),F(4,"div",5)(5,"div",13),ce(6),F(7,"div",14),ce(8),V()(),F(9,"p",15),ce(10),V()()()()),2&t){const e=n.$implicit;j(3),To("src",e.image,Co),To("alt",e.name),j(3),ei(" ",e.name,"\xa0 "),j(2),ei(" \xb7 ",e.time," "),j(2),Jt(e.comment)}}let gF=(()=>{class t{constructor(){this.newComment=""}sendComment(){console.log(this.newComment);const e=document.getElementById("chat");var o=new Date;this.messages.push({id:this.messages.length+1,name:"Yotsuba Nakano",image:"https://media.tenor.com/yQ_zLRi6zUkAAAAd/yotsuba-nakano.gif",time:o.getHours()+":"+o.getMinutes(),comment:this.newComment}),this.newComment="",setTimeout(()=>{e.scroll({top:e.scrollHeight,behavior:"smooth"})},1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-comments"]],inputs:{messages:"messages"},decls:10,vars:3,consts:[["id","chat",1,"h-20rem",2,"overflow-y","scroll","overflow-x","hidden"],["id","message","key","index",4,"ngFor","ngForOf"],[1,"flex","text-center","align-content-center","align-items-center","mt-4","p-1"],[1,"image-column"],["src","https://media.tenor.com/yQ_zLRi6zUkAAAAd/yotsuba-nakano.gif","alt","profile",1,"round-images","round-images-size"],[1,"text-column"],[1,"flex","font-bold","w-full","relative"],["id","name","name","name","placeholder","Comentario","type","text","pInputText","",1,"w-full",2,"height","50px",3,"ngModel","ngModelChange"],[1,"absolute","image-column"],["pButton","","pRipple","","icon","pi pi-send","type","button",1,"p-button-raised","p-button-text","round-button",3,"disabled","click"],["id","message","key","index"],[1,"activity-container","mt-3","p-1"],[1,"round-images","round-images-size",2,"box-shadow","0px 1px 5px 0px rgba(0,0,0,0.2)",3,"src","alt"],[1,"flex","font-bold","mb-1",2,"color","var(--fontColor)"],[1,"text-600","font-normal"],[1,""]],template:function(e,o){1&e&&(F(0,"div",0),J(1,jQ,11,5,"div",1),V(),F(2,"div",2)(3,"div",3),Ne(4,"img",4),V(),F(5,"div",5)(6,"div",6)(7,"input",7),Oe("ngModelChange",function(s){return o.newComment=s}),V(),F(8,"div",8)(9,"button",9),Oe("click",function(){return o.sendComment()}),V()()()()()),2&e&&(j(1),B("ngForOf",o.messages),j(6),B("ngModel",o.newComment),j(2),B("disabled",""==o.newComment))},dependencies:[Ms,dd,Tl,os,fc,hd],styles:["p[_ngcontent-%COMP%]{margin:0}.image-column[_ngcontent-%COMP%]{width:50px;height:100%;align-items:start;right:0;top:7px}.text-column[_ngcontent-%COMP%]{margin-left:1rem;flex-grow:1;width:100%;height:100%;justify-content:center;align-items:start}.activity-container[_ngcontent-%COMP%]{transition:var(--transition);width:100%;display:flex;padding-bottom:1.5rem}.round-button[_ngcontent-%COMP%]{width:35px;height:35px;background:var(--gradient45);border-radius:100px!important;right:0;color:#fff}.round-button[_ngcontent-%COMP%]:hover{background:var(--gradient45Hover)!important;color:#fff!important;cursor:pointer}[_nghost-%COMP%]     .p-inputtext{border-radius:100px!important;padding-left:1rem;padding-right:3rem}"]}),t})();function HQ(t,n){1&t&&(F(0,"div",3)(1,"h2",4),ce(2,"Comentarios"),V()())}const $Q=function(){return{width:"600px",transition:"all 500ms"}},GQ=function(){return{"650px":"95vw"}};let WQ=(()=>{class t{constructor(){this.hide=new Tt,this.messages=[]}ngOnInit(){this.messages=[{id:1,name:"Ichika Nakano",image:"https://media.tenor.com/qNaWdxRxMBYAAAAC/ichika-ichika-nakano.gif",time:"12:00",comment:"Hola caracola"},{id:2,name:"Nino Nakano",image:"https://media.tenor.com/Hci64uKJMaMAAAAd/nino-nakano.gif",time:"12:00",comment:"Hola caracola"},{id:3,name:"Miku Nakano",image:"https://media.tenor.com/oPYlDzjkgUoAAAAC/answer-me-the-quintessential-quintuplets.gif",time:"12:00",comment:"Hola caracola mensaje muy largo para ver como se comporta el chat"},{id:4,name:"Yotsuba Nakano",image:"https://media.tenor.com/yQ_zLRi6zUkAAAAd/yotsuba-nakano.gif",time:"12:00",comment:"Hola caracola"},{id:5,name:"Itsuki Nakano",image:"https://media.tenor.com/j0URHc6S_PYAAAAd/i-dont-like-him-the-quintessential-quintuplets.gif",time:"12:00",comment:"Hola caracola"}]}onCancel(){this.hide.emit(!1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-comments-dialog"]],inputs:{display:"display"},outputs:{hide:"hide"},decls:3,vars:9,consts:[[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[3,"messages"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"]],template:function(e,o){1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.display=s})("onHide",function(){return o.onCancel()}),J(1,HQ,3,0,"ng-template",1),Ne(2,"app-comments",2),V()),2&e&&(Ao(ai(7,$Q)),B("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",ai(8,GQ)),j(2),B("messages",o.messages))},dependencies:[_o,mu,gF],styles:["[_nghost-%COMP%]     .p-dialog .p-dialog-content{padding-top:0}"]}),t})();function qQ(t,n){if(1&t&&(F(0,"div",25)(1,"div",26)(2,"div",27),Ne(3,"img",28),V(),F(4,"h3",29),ce(5,"Road trip al espacio"),V(),F(6,"p",30),ce(7),V()()()),2&t){const e=q().$implicit;j(7),ei(" De ",e.name," ")}}function ZQ(t,n){1&t&&(F(0,"div",31)(1,"mat-icon",18),ce(2,"subscriptions"),V(),F(3,"div",32),ce(4," Playlist a\xf1adida "),V()()),2&t&&B("@fadeInOut",void 0)}function KQ(t,n){1&t&&(F(0,"div",31)(1,"mat-icon",18),ce(2,"link"),V(),F(3,"div",32),ce(4," Enlace copiado "),V()()),2&t&&B("@fadeInOut",void 0)}function XQ(t,n){1&t&&(F(0,"mat-icon",18),ce(1,"favorite_border"),V())}function YQ(t,n){1&t&&(F(0,"mat-icon",33),ce(1,"favorite"),V())}function QQ(t,n){if(1&t){const e=xt();F(0,"div",2)(1,"div",3),Ne(2,"img",4),V(),F(3,"div",5)(4,"div",6)(5,"mat-icon",7),ce(6),V(),F(7,"div",8),ce(8),F(9,"div",9),ce(10),V()()(),F(11,"p",10),ce(12),V(),F(13,"p",11),ce(14),V(),F(15,"div",12),Ne(16,"app-map-vibes",13),J(17,qQ,8,1,"div",14),V(),F(18,"div",15)(19,"div",16)(20,"div",17),Oe("click",function(){const s=Ie(e).$implicit;return Me(q().addComent(s.id))}),F(21,"mat-icon",18),ce(22,"maps_ugc"),V(),F(23,"div",19),ce(24),V()()(),F(25,"div",16)(26,"div",20),Oe("click",function(){const s=Ie(e).$implicit;return Me(q().addToPlaylist(s.id,s.type))}),F(27,"div",21)(28,"mat-icon",18),ce(29,"add"),V(),F(30,"div",19),ce(31),V(),J(32,ZQ,5,1,"div",22),V()()(),F(33,"div",16)(34,"div",20),Oe("click",function(){const s=Ie(e).$implicit;return Me(q().copy(s.id))}),F(35,"div",21)(36,"mat-icon",18),ce(37,"share"),V(),F(38,"div",19),ce(39," Compartir "),V(),J(40,KQ,5,1,"div",22),V()()(),F(41,"div",16)(42,"div",17),Oe("click",function(){const s=Ie(e).$implicit;return Me(q().addLike(s.id))}),J(43,XQ,2,0,"mat-icon",23),J(44,YQ,2,0,"mat-icon",24),F(45,"div",19),ce(46),V()()()()()()}if(2&t){const e=n.$implicit,o=q();j(2),To("src",e.image,Co),j(4),Jt(e.icon),j(2),ei(" ",e.activityDescription,"\xa0 "),j(2),ei(" ",e.type,"\xa0 "),j(2),ei(" ",e.name," "),j(2),ei(" ",e.description," "),j(2),B("id","activity"+e.id)("vibes",o.vibes)("showSearchBar",!1)("showLocationButton",!0),j(1),B("ngIf","playlist"==e.type),j(7),Jt(1!=e.comments?e.comments+" Comentarios":e.comments+" Comentario"),j(7),ei(" ","vibe"==e.type?"A\xf1adir a playlist":"A\xf1adir playlist"," "),j(1),B("ngIf",o.playlistToAdd==e.id),j(8),B("ngIf",o.copyLink==e.id),j(3),B("ngIf",!e.favorite),j(1),B("ngIf",e.favorite),j(2),Jt(1!=e.likes?e.likes+" Likes":e.likes+" Like")}}let JQ=(()=>{class t{constructor(){this.mapPublico="mapPublico",this.mapPrivado="mapPrivado",this.copyLink=-1,this.playlistToAdd=-1,this.displayCommentsDialog=!1,this.displayAddToPlaylistDialog=!1}ngOnInit(){this.activities=[{id:1,name:"Rem (\u30ec\u30e0, Remu)",image:"https://media.tenor.com/a1V-3ctKdQ0AAAAC/rem-rezero.gif",description:"Este vibe me record\xf3 a cuando Natsuki me invit\xf3 a su casa para hacer galletas. \xa1Qu\xe9 tiempos!",icon:"favorite",activityDescription:"A Loreto Matinero le ha gustado este",type:"vibe",date:"Hace 5 minutos",favorite:!1,comments:1,likes:0},{id:2,name:"Ram (\u30e9\u30e0, Ramu)",image:"https://media.tenor.com/7WbRvUKO9JUAAAAi/ram-png.gif",description:"\xa1Qu\xe9 buen vibe! Me encant\xf3 la canci\xf3n que pusiste.",icon:"favorite",activityDescription:"A Loreto Matinero le ha gustado esta",type:"playlist",date:"Hace 10 minutos",favorite:!0,comments:0,likes:3},{id:3,name:"Emilia (\u30a8\u30df\u30ea\u30a2, Emiria)",image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif",description:"\xa1Qu\xe9 buen vibe! Me encant\xf3 la canci\xf3n que pusiste.",icon:"add_circle",activityDescription:"Nuevo",type:"vibe",date:"Hace 1 hora",favorite:!1,comments:3,likes:9},{id:4,name:"Felix Argyle (\u30d5\u30a7\u30ea\u30c3\u30af\u30b9\u30fb\u30a2\u30fc\u30ac\u30a4\u30eb)",image:"https://media.tenor.com/XSCFKXi06sAAAAAC/felix-argyle-cute.gif",description:"\xa1Qu\xe9 buen vibe! Me encant\xf3 la canci\xf3n que pusiste.",icon:"playlist_add_circle",activityDescription:"Nueva",type:"playlist",date:"Hace 10 horas",favorite:!1,comments:1,likes:13}],this.vibes=[{id:1,lng:-.889872,lat:41.669628,title:"D\xedas de enero lluvioso",author:"Shakira",creator:"Jaime Roncal",description:"Una canci\xf3n que escuche morreandome con mi novio",fecha:"12/03/23",image:"/../../assets/images/3.png",private:2}],this.vibes2=[{id:2,lng:-.888328,lat:41.683411,title:"D\xedas de enero lluvioso lllueve",author:"Shakira",creator:"Pilar Ester",description:"De chill",fecha:"14/05/23",image:"/../../assets/images/2.png",private:1}]}addLike(e){for(let o=0;o<this.activities.length;o++)this.activities[o].id===e&&(this.activities[o].favorite?this.activities[o].likes--:this.activities[o].likes++,this.activities[o].favorite=!this.activities[o].favorite)}copy(e){var o=this;return hu(function*(){o.copyLink=e,yield new Promise(r=>setTimeout(r,3e3)),o.copyLink=-1})()}addComent(e){this.displayCommentsDialog=!0}addToPlaylist(e,o){var r=this;return hu(function*(){console.log("Add to playlist",e),"vibe"===o?r.displayAddToPlaylistDialog=!0:(r.playlistToAdd=e,yield new Promise(s=>setTimeout(s,3e3)),r.playlistToAdd=-1)})()}hideDialog(e){this.displayCommentsDialog=e}hideDialogPlaylist(e){this.displayAddToPlaylistDialog=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-home-activity"]],decls:3,vars:3,consts:[["class","activity-container",4,"ngFor","ngForOf"],[3,"display","hide"],[1,"activity-container"],[1,"image-column",2,"margin-top","38px"],["alt","profile",1,"round-images","round-images-size",3,"src"],[1,"text-column"],[1,"flex","mb-2","align-content-center"],[1,"text-600","text-lg","flex","align-items-center"],[1,"text-600","flex","align-items-center"],[1,"text-gradient","font-bold"],[1,"mb-2","font-bold"],[1,"mb-2"],[1,"mb-4","body-map","relative"],["mapHeight","400px !important",3,"id","vibes","showSearchBar","showLocationButton"],["class","z-1 absolute h-full w-15rem flex align-items-center justify-content-center playlist-background","style","border-top-left-radius: 10px; border-bottom-left-radius: 10px;",4,"ngIf"],[1,"flex","text-600"],[1,"w-3","flex"],[1,"bottom-icons","m-auto","text-600","flex","align-content-center","align-items-center",3,"click"],[1,"mr-1","material-icons-outlined"],[1,"bottom-icons-text"],[1,"relative","w-full","flex",3,"click"],[1,"bottom-icons","m-auto","text-600","flex","align-content-center","align-items-center"],["class","z-1 absolute w-fit h-2rem p-3 text-center flex align-items-center align-content-center popup","style","top: 30px; border-radius: 15px; box-shadow: var(--shadows);",4,"ngIf"],["class","mr-1 material-icons-outlined",4,"ngIf"],["class","mr-1","style","background: var(--gradient45); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;",4,"ngIf"],[1,"z-1","absolute","h-full","w-15rem","flex","align-items-center","justify-content-center","playlist-background",2,"border-top-left-radius","10px","border-bottom-left-radius","10px"],[1,"m-auto"],[1,"h-auto","w-full","px-6","mb-1"],["src","https://media.tenor.com/2roX3uxz_68AAAAC/cat-space.gif",1,"w-full","border-round-lg"],[1,"text-center","mb-2","px-3",2,"overflow","hidden","text-overflow","ellipsis"],[1,"text-center","px-3"],[1,"z-1","absolute","w-fit","h-2rem","p-3","text-center","flex","align-items-center","align-content-center","popup",2,"top","30px","border-radius","15px","box-shadow","var(--shadows)"],[1,"w-8rem","h-2rem","flex","justify-content-center","align-items-center"],[1,"mr-1",2,"background","var(--gradient45)","-webkit-background-clip","text","-moz-background-clip","text","background-clip","text","-webkit-text-fill-color","transparent"]],template:function(e,o){1&e&&(J(0,QQ,47,18,"div",0),F(1,"app-comments-dialog",1),Oe("hide",function(s){return o.hideDialog(s)}),V(),F(2,"app-add-to-playlist-dialog",1),Oe("hide",function(s){return o.hideDialogPlaylist(s)}),V()),2&e&&(B("ngForOf",o.activities),j(1),B("display",o.displayCommentsDialog),j(1),B("display",o.displayAddToPlaylistDialog))},dependencies:[Ms,mi,El,iM,mF,WQ],styles:["p[_ngcontent-%COMP%]{margin:0;transition:none}.activity-container[_ngcontent-%COMP%]{border-bottom:solid 1px var(--separationLine);width:100%;display:flex;padding:1.5rem}.image-column[_ngcontent-%COMP%]{width:50px;height:100%;align-items:start}.text-column[_ngcontent-%COMP%]{margin-left:1rem;flex-grow:1;width:100%;height:100%;justify-content:center;align-items:start}.bottom-icons[_ngcontent-%COMP%]:hover{color:var(--primary-color)!important;cursor:pointer}.bottom-icons-text[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.clipboard-position[_ngcontent-%COMP%]{right:40px}.body-map[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;justify-content:flex-end;border-radius:10px;height:400px;box-shadow:var(--shadows)!important}.playlist-background[_ngcontent-%COMP%]{background:var(--gradientVerticalAlpha);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}.popup[_ngcontent-%COMP%]{color:var(--primary-color);background-color:var(--frostedBackground);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:none}@media (max-width: 1450px){.bottom-icons-text[_ngcontent-%COMP%]{width:90px}.clipboard-position[_ngcontent-%COMP%]{right:10px}}@media (max-width: 1300px){.bottom-icons-text[_ngcontent-%COMP%]{width:68px}.clipboard-position[_ngcontent-%COMP%]{right:0}}@media (max-width: 1200px){.bottom-icons-text[_ngcontent-%COMP%]{width:120px}.clipboard-position[_ngcontent-%COMP%]{right:40px}}@media (max-width: 1050px){.bottom-icons-text[_ngcontent-%COMP%]{width:100px}.clipboard-position[_ngcontent-%COMP%]{right:20px}}@media (max-width: 950px){.bottom-icons-text[_ngcontent-%COMP%]{width:90px}.clipboard-position[_ngcontent-%COMP%]{right:0}}@media (max-width: 910px){.bottom-icons-text[_ngcontent-%COMP%]{display:none}}"],data:{animation:[cc("fadeInOut",[rr(":enter",[go({opacity:0}),Ho("500ms",go({opacity:1}))]),rr(":leave",[Ho("500ms",go({opacity:0}))])])]}}),t})();function eJ(t,n){1&t&&(F(0,"div",9)(1,"h1",10),ce(2," Actividad reciente "),V()())}function tJ(t,n){if(1&t&&(F(0,"div",11)(1,"div",12),Ne(2,"img",13),V(),F(3,"div",14)(4,"div")(5,"p",15),ce(6),nc(7,"slice"),V(),F(8,"p",16),ce(9),V()()(),F(10,"div",17)(11,"button",18)(12,"span",19),ce(13," Conectar "),V()()()()),2&t){const e=n.$implicit;j(2),To("src",e.image,Co),j(4),ei(" ",e.name.length>20?Gm(7,3,e.name,0,18)+"...":e.name," "),j(3),ei(" @",e.nickname," ")}}function nJ(t,n){if(1&t){const e=xt();F(0,"div",20),Oe("click",function(){const s=Ie(e).$implicit;return Me(q().route(s.id,s.name,s.image))}),F(1,"div",21),Ne(2,"img",22),V(),F(3,"div",14)(4,"div")(5,"p",15),ce(6),V(),F(7,"p",16),ce(8),V()()()()}if(2&t){const e=n.$implicit;j(2),To("src",e.image,Co),j(4),ei(" ",e.name," "),j(2),ei(" de ",e.from," ")}}let iJ=(()=>{class t{constructor(e,o){this.router=e,this.appLayout=o}ngOnInit(){console.log("INIT"),this.followSuggestions=[{id:1,name:"Rem (\u30ec\u30e0, Remu)",image:"https://media.tenor.com/a1V-3ctKdQ0AAAAC/rem-rezero.gif",nickname:"Rem-chan"},{id:2,name:"Ram (\u30e9\u30e0, Ramu)",image:"https://media.tenor.com/7WbRvUKO9JUAAAAi/ram-png.gif",nickname:"Ram-chan"},{id:3,name:"Emilia (\u30a8\u30df\u30ea\u30a2, Emiria)",image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif",nickname:"Emilia-chan"},{id:4,name:"Felix Argyle (\u30d5\u30a7\u30ea\u30c3\u30af\u30b9\u30fb\u30a2\u30fc\u30ac\u30a4\u30eb)",image:"https://media.tenor.com/XSCFKXi06sAAAAAC/felix-argyle-cute.gif",nickname:"Ferris-san"},{id:5,name:"Beatrice (\u30d9\u30a2\u30c8\u30ea\u30b9\u30fb\u30f4\u30a1\u30eb\u30cf\u30e9, Beatorisu Varuhara)",image:"https://media.tenor.com/I-2_kJDfAIUAAAAd/re-zero-beatrice.gif",nickname:"Bea-chan"},{id:6,name:"Hatsune Miku (\u521d\u97f3\u30df\u30af)",image:"https://media.tenor.com/4mGl-qVGALAAAAAd/miku-anime.gif",nickname:"Miku-chan"},{id:7,name:"Megumin (\u30e1\u30b0\u30df\u30f3)",image:"https://media.tenor.com/LPv6mAowVb8AAAAC/megumin-anime.gif",nickname:"Megumin-chan"},{id:8,name:"Aqua (\u30a2\u30af\u30a2)",image:"https://media.tenor.com/aySvKBn5tAgAAAAC/anime.gif",nickname:"Aqua-chan"},{id:9,name:"Darkness (\u30c0\u30fc\u30af\u30cd\u30b9)",image:"https://media.tenor.com/2YgvgnVKzpgAAAAC/darkness-dance.gif",nickname:"Darkness-chan"}],this.yourPaylists=[{id:1,name:"Lo mejor de los 2000",from:"Pilar Ester",image:"https://media.tenor.com/a1V-3ctKdQ0AAAAC/rem-rezero.gif"},{id:2,name:"De paseo por el parque con el perro mirando al cielo",from:"Jaime Roncal",image:"https://media.tenor.com/7WbRvUKO9JUAAAAi/ram-png.gif"},{id:3,name:"Para bailar",from:"Loreto Matinero",image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif"},{id:4,name:"Para relajarse",from:"Pilar Ester",image:"https://media.tenor.com/XSCFKXi06sAAAAAC/felix-argyle-cute.gif"},{id:5,name:"Para estudiar",from:"Jaime Roncal",image:"https://media.tenor.com/I-2_kJDfAIUAAAAd/re-zero-beatrice.gif"},{id:6,name:"Para dormir",from:"Loreto Matinero",image:"https://media.tenor.com/4mGl-qVGALAAAAAd/miku-anime.gif"},{id:7,name:"Para relajarse",from:"Pilar Ester",image:"https://media.tenor.com/XSCFKXi06sAAAAAC/felix-argyle-cute.gif"}]}route(e,o,r){this.router.navigate(["/playlists",e,o,r])}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-home"]],decls:14,vars:3,consts:[[1,"home-main-container"],[1,"home-primary-column"],["class","route-name sticky-topbar",4,"ngIf"],[1,"primary-column-content","pb-6"],[1,"home-secondary-column"],[1,"secondary-column-continer"],[1,"mb-2"],["class","flex align-items-center w-full mt-3",4,"ngFor","ngForOf"],["class","grow flex align-items-center w-full mt-1 hover-item p-2",3,"click",4,"ngFor","ngForOf"],[1,"route-name","sticky-topbar"],[1,"current-route"],[1,"flex","align-items-center","w-full","mt-3"],[1,"round-images-size","mr-3"],["alt","suggestion.name",1,"round-images","round-images-size",3,"src"],[1,"flex-grow-1","flex","mr-3"],[1,"p-0","m-0"],[1,"p-0","m-0","text-500"],[1,"margin-td-right",2,"float","right"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient"],[1,"vibe-btn-text-white","font-normal","text-xs"],[1,"grow","flex","align-items-center","w-full","mt-1","hover-item","p-2",3,"click"],[1,"mr-3",2,"height","60px","width","60px","border-radius","5px"],["alt","suggestion.name",2,"height","60px","width","60px","object-fit","cover","border-radius","5px","box-shadow","var(--shadows)",3,"src"]],template:function(e,o){1&e&&(F(0,"div",0)(1,"div",1),J(2,eJ,3,0,"div",2),F(3,"div",3),Ne(4,"app-home-activity"),V()(),F(5,"div",4)(6,"div",5)(7,"h2",6),ce(8," A qui\xe9n seguir "),V(),J(9,tJ,14,7,"div",7),V(),F(10,"div",5)(11,"h2",6),ce(12," Tus playlists "),V(),J(13,nJ,9,3,"div",8),V()()()),2&e&&(j(2),B("ngIf",!o.appLayout.showBar),j(7),B("ngForOf",o.followSuggestions),j(4),B("ngForOf",o.yourPaylists))},dependencies:[Ms,mi,os,JQ,rb],styles:["[_nghost-%COMP%]{width:100%}.home-main-container[_ngcontent-%COMP%]{display:flex}.home-primary-column[_ngcontent-%COMP%]{flex-grow:1;width:100%;height:100vh;overflow:scroll}.primary-column-content[_ngcontent-%COMP%]{border-right:solid 1px var(--separationLine);padding-top:1rem}.home-secondary-column[_ngcontent-%COMP%]{width:500px;height:100vh;overflow:scroll;padding:1.5rem}.secondary-column-continer[_ngcontent-%COMP%]{background:var(--containerBackground);border-radius:10px;padding:1rem;margin-bottom:1.5rem}.sticky-topbar[_ngcontent-%COMP%]{position:sticky;z-index:1000;position:-webkit-sticky;top:0;box-shadow:var(--shadows);background:var(--frostedBackground);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}.hover-item[_ngcontent-%COMP%]{transition:var(--transition)}.hover-item[_ngcontent-%COMP%]:hover{transition:var(--transition);border-radius:10px;background:var(--surface-hover);cursor:pointer}.hover-item[_ngcontent-%COMP%]:active{border-radius:10px;background:var(--surface-300);transition:var(--transition)}@media (max-width: 1200px){.home-main-container[_ngcontent-%COMP%]{display:grid}.home-primary-column[_ngcontent-%COMP%]{transition:var(--transition);height:100%}.home-secondary-column[_ngcontent-%COMP%]{height:100%;width:100%}.primary-column-content[_ngcontent-%COMP%]{transition:var(--transition);border:none}}"]}),t})();function oJ(t,n){1&t&&Ne(0,"p-progressSpinner",28)}let oM=(()=>{class t{constructor(e,o){this.appComponent=e,this.router=o,this.displayFirstLogin=!1,this.displaySuccess=!1,this.loadingSpotify=!1,this.loadingSpotifyText="Iniciar sesi\xf3n con Spotify",this.newAccount=!1,this.isAdmin=!1}ngOnInit(){this.image=this.getImage()}getImage(){return"assets/images/"+Math.floor(5*Math.random())+".png"}connectSpotify(){var e=this;return hu(function*(){e.loadingSpotify=!0,e.loadingSpotifyText="Conectando...",yield new Promise(o=>setTimeout(o,5e3)),e.newAccount=!0,e.isAdmin=!1,e.loadingSpotifyText="Iniciar sesi\xf3n con Spotify",e.loadingSpotify=!1,e.newAccount?e.displayFirstLogin=!0:(e.newAccount&&!e.isAdmin||console.log("Enrutar al al Admin al dashboard"),e.router.navigate(["/home"]))})()}}return t.\u0275fac=function(e){return new(e||t)(be(WD),be(sr))},t.\u0275cmp=on({type:t,selectors:[["app-landing-page"]],decls:69,vars:4,consts:[[1,"content-wrapper"],[1,"grid","grid-nogutter","containers-image","sombra","text-800","overflow-hidden",2,"transition","var(--transition)"],[1,"col-whidth","p-6","text-center","md:text-left","flex","align-items-center"],[1,"grid","align-items-center","align-content-center","min-height",2,"max-width","800px"],["alt","logo",1,"logo"],[1,"mt-2","mb-4","text-700","line-height-3"],["pButton","","pRipple","","type","button",1,"spoty-btn","h-3rem","w-17rem","button-margin",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],["strokeWidth","5","class","mr-3",4,"ngIf"],["src","assets/images/spotify-white.svg","width","20","height","20","alt","logo",1,"spoty-icon","mr-2"],[1,"vibe-btn-text-white","w-full"],[1,"col-whidth","overflow-hidden"],["alt","Spotivibes",1,"md:ml-auto","block","h-full","w-full","poligon-clip",2,"object-fit","cover",3,"src"],["id","features",1,"p-7"],[1,"grid","justify-content-center"],[1,"col-12","text-center","mb-6"],[1,"text-900","font-normal","mb-2"],[1,"text-600","text-2xl"],[1,"col-12","md:col-6","lg:col-3","p-0","lg:pr-5","lg:pb-5","mt-4","lg:mt-0"],[1,"flex","align-items-center","justify-content-center","mb-3","sombra",2,"width","10rem","height","10rem","border-radius","100%","background","var(--gradientVertical)"],[1,"flex","align-items-center","justify-content-center","bg-white",2,"width","8rem","height","8rem","border-radius","100%"],[1,"pi","pi-fw","pi-users","gradient-btn-text",2,"font-size","4rem"],[1,"text-center"],[1,"font-bold"],[1,"pi","pi-fw","pi-thumbs-up","gradient-btn-text",2,"font-size","4rem"],[1,"pi","pi-fw","pi-comment","gradient-btn-text",2,"font-size","4rem"],[1,"pi","pi-fw","pi-heart","gradient-btn-text",2,"font-size","4rem"],["strokeWidth","5",1,"mr-3"]],template:function(e,o){1&e&&(F(0,"div",0)(1,"div",1)(2,"div",2)(3,"section",3),Ne(4,"img",4),F(5,"p",5),ce(6,"Crea tus vibes poniendo en el mapa las canciones que te recuerdan a cada uno de tus lugares favoritos. Haz playlits y comp\xe1rtelas con tus amigos."),V(),F(7,"button",6),Oe("click",function(){return o.connectSpotify()}),F(8,"div",7)(9,"span",8),J(10,oJ,1,0,"p-progressSpinner",9),Ne(11,"img",10),F(12,"p",11),ce(13),V()()()()()(),F(14,"div",12),Ne(15,"img",13),V()(),F(16,"div",14)(17,"div",15)(18,"div",16)(19,"h2",17),ce(20,"\xbfQu\xe9 puedes hacer en Spotivibes?"),V(),F(21,"span",18),ce(22,"Spotivibes te ofrece todo esto \xa1Y m\xe1s!"),V()(),F(23,"div",19)(24,"div",8)(25,"div",20)(26,"div",21),Ne(27,"i",22),V()()(),F(28,"div",23)(29,"p",24),ce(30,"Placeholder text"),V()(),F(31,"div",23)(32,"p"),ce(33,"More placeholder text"),V()()(),F(34,"div",19)(35,"div",8)(36,"div",20)(37,"div",21),Ne(38,"i",25),V()()(),F(39,"div",23)(40,"p",24),ce(41,"Placeholder text"),V()(),F(42,"div",23)(43,"p"),ce(44,"More placeholder text"),V()()(),F(45,"div",19)(46,"div",8)(47,"div",20)(48,"div",21),Ne(49,"i",26),V()()(),F(50,"div",23)(51,"p",24),ce(52,"Placeholder text"),V()(),F(53,"div",23)(54,"p"),ce(55,"More placeholder text"),V()()(),F(56,"div",19)(57,"div",8)(58,"div",20)(59,"div",21),Ne(60,"i",27),V()()(),F(61,"div",23)(62,"p",24),ce(63,"Placeholder text"),V()(),F(64,"div",23)(65,"p"),ce(66,"More placeholder text"),V()()()()()(),Ne(67,"app-footer")(68,"app-login-dialog")),2&e&&(j(7),B("disabled",o.loadingSpotify),j(3),B("ngIf",o.loadingSpotify),j(3),Jt(o.loadingSpotifyText),j(2),To("src",o.image,Co))},styles:[".logo[_ngcontent-%COMP%]{content:var(--logo);background-size:cover;background-repeat:no-repeat;background-position:center;color:red;width:100%}.col-whidth[_ngcontent-%COMP%]{width:50%}.min-height[_ngcontent-%COMP%]{min-height:500px}.poligon-clip[_ngcontent-%COMP%]{transition:var(--transition);clip-path:polygon(15% 0,100% 0,100% 100%,0 100%)}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:#fff!important}[_nghost-%COMP%]     .p-progress-spinner{height:30px;width:30px}@media (max-width: 767px){.poligon-clip[_ngcontent-%COMP%]{clip-path:polygon(0 0,100% 0,100% 100%,0 100%)}.button-margin[_ngcontent-%COMP%]{margin:auto}.col-whidth[_ngcontent-%COMP%]{width:100%}.min-height[_ngcontent-%COMP%]{min-height:300px}}.sombra[_ngcontent-%COMP%]{box-shadow:var(--shadows)}.gradient-btn-text[_ngcontent-%COMP%]{background-image:var(--gradientVertical);font-weight:700;font-size:larger;width:100%;background-size:100%;background-clip:border-box;-webkit-background-clip:text;-moz-background-clip:text;-webkit-text-fill-color:transparent;-moz-text-fill-color:transparent}[_nghost-%COMP%]     .p-dialog{border-radius:1rem}[_nghost-%COMP%]     .p-dialog-header{border-top-left-radius:1rem;border-top-right-radius:1rem}[_nghost-%COMP%]     .p-dialog-footer{border-bottom-left-radius:1rem;border-bottom-right-radius:1rem}"]}),t})();function rJ(t,n){if(1&t){const e=xt();F(0,"div",5)(1,"h1",6),ce(2),V(),F(3,"p-selectButton",7),Oe("ngModelChange",function(r){return Ie(e),Me(q().selectedButton=r)})("ngModelChange",function(){return Ie(e),Me(q().filtrarVibes())}),V()()}if(2&t){const e=q();j(2),ei(" ",e.appLayout.currentRoute," "),j(1),B("options",e.options)("ngModel",e.selectedButton)}}function sJ(t,n){if(1&t&&Ne(0,"app-map-vibes",8),2&t){const e=q();B("mapHeight",e.mapHeight)("id",e.mapPublico)("vibes",e.vibesPublicos)("showSearchBar",!0)("showLocationButton",!1)}}function aJ(t,n){if(1&t&&Ne(0,"app-map-vibes",8),2&t){const e=q();B("mapHeight",e.mapHeight)("id",e.mapAmigos)("vibes",e.vibesAmigos)("showSearchBar",!0)("showLocationButton",!1)}}function lJ(t,n){if(1&t&&Ne(0,"app-map-vibes",8),2&t){const e=q();B("mapHeight",e.mapHeight)("id",e.mapPrivado)("vibes",e.vibesPrivados)("showSearchBar",!0)("showLocationButton",!1)}}let cJ=(()=>{class t{constructor(e,o){this.router=e,this.appLayout=o,this.vibesAmigos=[],this.vibesPublicos=[],this.vibesPrivados=[],this.mapPublico="mapPublico",this.mapPrivado="mapPrivado",this.mapAmigos="mapAmigos",this.mapHeight="calc(100vh)",this.selectedButton=1,this.amigos=0,this.publicos=0,this.privados=0,this.i=0,this.options=[{name:"Todos los vibes",value:1},{name:"Vibes de mis amigos",value:2},{name:"Mis vibes",value:3}]}ngOnInit(){this.vibes=[{id:1,lng:-.889872,lat:41.669628,title:"D\xedas de enero lluvioso",author:"Shakira",creator:"Jaime Roncal",description:"Una canci\xf3n que escuche morreandome con mi novio",fecha:"12/03/23",image:"/../../assets/images/3.png",private:2},{id:2,lng:-.888328,lat:41.683411,title:"D\xedas de enero lluvioso lllueve",author:"Shakira",creator:"Pilar Ester",description:"De chill",fecha:"14/05/23",image:"/../../assets/images/2.png",private:1},{id:3,lng:-.897586,lat:41.644493,title:"D\xedas de enero lluvioso llueve",author:"Shakira",creator:"Nacho Ortega",description:"De chill",fecha:"14/05/23",image:"/../../assets/images/4.png",private:3}],this.filtrarVibes()}ngAfterViewChecked(){window.innerWidth>=1400?this.mapHeight="calc(100vh - 200px)":window.innerWidth<1400&&window.innerWidth>=1e3?this.mapHeight="calc(100vh - 175px)":window.innerWidth<1e3&&window.innerWidth>=900?this.mapHeight="calc(100vh - 230px)":window.innerWidth<900&&window.innerWidth>=700?this.mapHeight="calc(100vh - 215px)":window.innerWidth<700&&(this.mapHeight="calc(100vh - 160px)")}filtrarVibes(){this.amigos=0,this.publicos=0,this.privados=0,this.i=0;for(const e of this.vibes)console.log("Lng:",e.lng),console.log("Lat:",e.lat),console.log("Title:",e.title),console.log("Author:",e.author),console.log("Creator:",e.creator),console.log("Description:",e.description),console.log("Fecha:",e.fecha),console.log("Image:",e.image),1===this.selectedButton&&1==e.private?(this.vibesPublicos[this.publicos]=this.vibes[this.i],this.publicos++,console.log(this.vibesPublicos)):2===this.selectedButton&&2==e.private?(this.vibesAmigos[this.amigos]=this.vibes[this.i],this.amigos++,console.log(this.vibesAmigos)):3===this.selectedButton&&3==e.private&&(this.vibesPrivados[this.amigos]=this.vibes[this.i],this.amigos++,console.log(this.vibesPrivados)),this.i++}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-map"]],decls:7,vars:6,consts:[["class","route-name flex align-items-center",4,"ngIf"],[1,"content",2,"transition","none !important"],["optionLabel","name","optionValue","value",1,"diaplay-buttons-sm",3,"options","ngModel","ngModelChange"],["id","map",1,"map-container"],[3,"mapHeight","id","vibes","showSearchBar","showLocationButton",4,"ngIf"],[1,"route-name","flex","align-items-center"],[1,"current-route","w-full"],["optionLabel","name","optionValue","value",1,"hide-buttons-lg",3,"options","ngModel","ngModelChange"],[3,"mapHeight","id","vibes","showSearchBar","showLocationButton"]],template:function(e,o){1&e&&(J(0,rJ,4,3,"div",0),F(1,"div",1)(2,"p-selectButton",2),Oe("ngModelChange",function(s){return o.selectedButton=s})("ngModelChange",function(){return o.filtrarVibes()}),V(),F(3,"div",3),J(4,sJ,1,5,"app-map-vibes",4),J(5,aJ,1,5,"app-map-vibes",4),J(6,lJ,1,5,"app-map-vibes",4),V()()),2&e&&(B("ngIf",!o.appLayout.showBar),j(2),B("options",o.options)("ngModel",o.selectedButton),j(2),B("ngIf",1==o.selectedButton),j(1),B("ngIf",2==o.selectedButton),j(1),B("ngIf",3==o.selectedButton))},dependencies:[mi,Tl,hd,QD,iM],styles:["[_nghost-%COMP%]{width:100%}.mapboxgl-popup[_ngcontent-%COMP%]{max-width:400px;font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif}.map-container[_ngcontent-%COMP%]{box-shadow:var(--shadows);border-radius:10px}[_nghost-%COMP%]     .p-component{display:flex;width:max-content;box-shadow:0 1px 5px #0003;border-radius:10px}[_nghost-%COMP%]     .p-buttonset .p-button:first-of-type{border-radius:10px 0 0 10px!important}[_nghost-%COMP%]     .p-buttonset .p-button:not(:first-of-type):not(:last-of-type){border-radius:0!important}[_nghost-%COMP%]     .p-button:last-of-type{border-top-left-radius:0!important;border-bottom-left-radius:0!important;box-shadow:none!important}[_nghost-%COMP%]     .p-component{border-radius:1rem}.hide-buttons-lg[_ngcontent-%COMP%]{display:grid}.diaplay-buttons-sm[_ngcontent-%COMP%]{display:none}@media (max-width: 1000px){.hide-buttons-lg[_ngcontent-%COMP%]{display:none}.diaplay-buttons-sm[_ngcontent-%COMP%]{display:grid}[_nghost-%COMP%]     .p-button .p-button-label{font-size:.9rem}[_nghost-%COMP%]     .p-component{width:100%;margin-bottom:1rem}}"]}),t})();function uJ(t,n){if(1&t&&(F(0,"div",4)(1,"h1",5),ce(2),V()()),2&t){const e=q();j(2),ei(" ",e.appLayout.currentRoute," ")}}let rM=(()=>{class t{constructor(e,o){this.router=e,this.appLayout=o,this.loading=!0}ngOnInit(){this.solicitudes=[{id:1,name:"Pilar Ester",nickname:"pichula",image:"https://media.licdn.com/dms/image/C4D03AQGhTmQp0J-eUw/profile-displayphoto-shrink_200_200/0/1646170721207?e=1684368000&v=beta&t=GrPpweOwHS4uTOiwQ9Vvg3pwY4crqQq7yKPf2DZas7g"},{id:2,name:"Jaime Roncal",nickname:"jaima",image:"https://media.licdn.com/dms/image/D4D03AQGlULIm-un43A/profile-displayphoto-shrink_800_800/0/1670712145849?e=2147483647&v=beta&t=LRBX_xAxtl7jymxEzR16l_88BGRmIGIchXsKn1rT3RY"},{id:3,name:"Loreto Matinero",nickname:"loretixx",image:"https://media.licdn.com/dms/image/C4D03AQEyfmX8LO-Zmg/profile-displayphoto-shrink_200_200/0/1645292647881?e=1683763200&v=beta&t=pSULLPcdGGGjd3EE_mw8LybUc367aLw7Atv8EKo5sqY"},{id:4,name:"Nacho Ortega",nickname:"pikanachi",image:"https://media.licdn.com/dms/image/C5603AQGsKPEdVPEMmw/profile-displayphoto-shrink_800_800/0/1529959821632?e=2147483647&v=beta&t=DSD8Q52k8Wv9KqYzFoxzA-HjGsmIut7fW6DHqF0tTiM"}],this.appLayout.numNotificaciones=this.solicitudes.length.toString(),this.appLayout.hayNotificaciones=this.solicitudes.length>0,this.loading=!1,this.notificaciones=[{name:"Pilar Ester",action:"ha empezado a seguir tu playlist",image:"https://media.licdn.com/dms/image/C4D03AQGhTmQp0J-eUw/profile-displayphoto-shrink_200_200/0/1646170721207?e=1684368000&v=beta&t=GrPpweOwHS4uTOiwQ9Vvg3pwY4crqQq7yKPf2DZas7g",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Loreto Matinero",action:"ha empezado a seguir tu playlist",image:"https://media.licdn.com/dms/image/C4D03AQEyfmX8LO-Zmg/profile-displayphoto-shrink_200_200/0/1645292647881?e=1683763200&v=beta&t=pSULLPcdGGGjd3EE_mw8LybUc367aLw7Atv8EKo5sqY",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Jaime Roncal",action:"le ha gustado tu vibe",image:"https://media.licdn.com/dms/image/D4D03AQGlULIm-un43A/profile-displayphoto-shrink_800_800/0/1670712145849?e=2147483647&v=beta&t=LRBX_xAxtl7jymxEzR16l_88BGRmIGIchXsKn1rT3RY",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Nacho Ortega",action:"ha empezado a seguir tu playlist",image:"https://media.licdn.com/dms/image/C5603AQGsKPEdVPEMmw/profile-displayphoto-shrink_800_800/0/1529959821632?e=2147483647&v=beta&t=DSD8Q52k8Wv9KqYzFoxzA-HjGsmIut7fW6DHqF0tTiM",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Rihanna",action:"ha empezado a seguir tu playlist",image:"https://hips.hearstapps.com/hmg-prod.s3.amazonaws.com/images/rihanna-embarazo-polo-rayas-firma-espanola-elle-2-64135e70d3e21.jpg?crop=0.739xw:0.493xh;0.125xw,0.0394xh&resize=980:*",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Andres Calamaro",action:"le ha gustado tu vibe",image:"https://estaticosgn-cdn.deia.eus/clip/03590ed0-0710-4e8d-a71e-19c6c818c6c3_16-9-aspect-ratio_default_0.jpg",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Andres Calamaro",action:"le ha gustado tu vibe",image:"https://estaticosgn-cdn.deia.eus/clip/03590ed0-0710-4e8d-a71e-19c6c818c6c3_16-9-aspect-ratio_default_0.jpg",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Andres Calamaro",action:"le ha gustado tu vibe",image:"https://estaticosgn-cdn.deia.eus/clip/03590ed0-0710-4e8d-a71e-19c6c818c6c3_16-9-aspect-ratio_default_0.jpg",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Andres Calamaro",action:"le ha gustado tu vibe",image:"https://estaticosgn-cdn.deia.eus/clip/03590ed0-0710-4e8d-a71e-19c6c818c6c3_16-9-aspect-ratio_default_0.jpg",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Andres Calamaro",action:"le ha gustado tu vibe",image:"https://estaticosgn-cdn.deia.eus/clip/03590ed0-0710-4e8d-a71e-19c6c818c6c3_16-9-aspect-ratio_default_0.jpg",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Andres Calamaro",action:"le ha gustado tu vibe",image:"https://estaticosgn-cdn.deia.eus/clip/03590ed0-0710-4e8d-a71e-19c6c818c6c3_16-9-aspect-ratio_default_0.jpg",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"},{name:"Andres Calamaro",action:"le ha gustado tu vibe",image:"https://estaticosgn-cdn.deia.eus/clip/03590ed0-0710-4e8d-a71e-19c6c818c6c3_16-9-aspect-ratio_default_0.jpg",object:"Love crazy",objectImage:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",objectAuthor:"De Pilar Ester"}]}aceptarSolicitud(e){for(let o=0;o<this.solicitudes.length;o++)if(this.solicitudes[o].id==e){this.solicitudes.splice(o,1);break}}cancelarSolicitud(e){for(let o=0;o<this.solicitudes.length;o++)if(this.solicitudes[o].id==e){this.solicitudes.splice(o,1);break}}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-notifications"]],decls:4,vars:5,consts:[["class","route-name",4,"ngIf"],[1,"content"],[3,"solicitudes","loading"],[3,"notificaciones","loading"],[1,"route-name"],[1,"current-route"]],template:function(e,o){1&e&&(J(0,uJ,3,1,"div",0),F(1,"div",1),Ne(2,"app-notifications-table",2)(3,"app-notifications-list",3),V()),2&e&&(B("ngIf",!o.appLayout.showBar),j(2),B("solicitudes",o.solicitudes)("loading",o.loading),j(1),B("notificaciones",o.notificaciones)("loading",o.loading))},styles:["[_nghost-%COMP%]{width:100%}"]}),t})(),mf=(()=>{class t{constructor(){this.strokeWidth="2",this.fill="none",this.animationDuration="2s"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["p-progressSpinner"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",strokeWidth:"strokeWidth",fill:"fill",animationDuration:"animationDuration"},decls:3,vars:6,consts:[["role","alert","aria-busy","true",1,"p-progress-spinner",3,"ngStyle","ngClass"],["viewBox","25 25 50 50",1,"p-progress-spinner-svg"],["cx","50","cy","50","r","20","stroke-miterlimit","10",1,"p-progress-spinner-circle"]],template:function(e,o){1&e&&(F(0,"div",0),function de(){Kn.lFrame.currentNamespace=jf}(),F(1,"svg",1),Ne(2,"circle",2),V()()),2&e&&(B("ngStyle",o.style)("ngClass",o.styleClass),j(1),aa("animation-duration",o.animationDuration),j(1),st("fill",o.fill)("stroke-width",o.strokeWidth))},dependencies:[Eo,Oo],styles:['.p-progress-spinner{position:relative;margin:0 auto;width:100px;height:100px;display:inline-block}.p-progress-spinner:before{content:"";display:block;padding-top:100%}.p-progress-spinner-svg{animation:p-progress-spinner-rotate 2s linear infinite;height:100%;transform-origin:center center;width:100%;position:absolute;inset:0;margin:auto}.p-progress-spinner-circle{stroke-dasharray:89,200;stroke-dashoffset:0;stroke:#d62d20;animation:p-progress-spinner-dash 1.5s ease-in-out infinite,p-progress-spinner-color 6s ease-in-out infinite;stroke-linecap:round}@keyframes p-progress-spinner-rotate{to{transform:rotate(360deg)}}@keyframes p-progress-spinner-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35px}to{stroke-dasharray:89,200;stroke-dashoffset:-124px}}@keyframes p-progress-spinner-color{to,0%{stroke:#d62d20}40%{stroke:#0057e7}66%{stroke:#008744}80%,90%{stroke:#ffa700}}\n'],encapsulation:2,changeDetection:0}),t})(),_F=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();function dJ(t,n){if(1&t){const e=xt();F(0,"div",3)(1,"button",4),Oe("click",function(){return Ie(e),Me(q().onCancel())}),F(2,"div",5)(3,"span",6)(4,"p",7),ce(5,"Aceptar"),V()()()()()}}const hJ=function(){return{width:"500px"}},pJ=function(){return{"500px":"95vw"}};let qw=(()=>{class t{constructor(){this.showDialog=new Tt}onCancel(){this.showDialog.emit(!1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-success-dialog-edit"]],inputs:{display:"display",message:"message",title:"title"},outputs:{showDialog:"showDialog"},decls:6,vars:10,consts:[[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],[1,"text-center"],["pTemplate","footer"],[1,"p-3"],["pButton","","pRipple","","type","submit",1,"p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"]],template:function(e,o){1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.display=s})("onHide",function(){return o.onCancel()}),F(1,"h3",1),ce(2),V(),F(3,"p",1),ce(4),V(),J(5,dJ,6,0,"ng-template",2),V()),2&e&&(Ao(ai(8,hJ)),B("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",ai(9,pJ)),j(2),ei(" ",o.title," "),j(2),ei(" ",o.message," "))},dependencies:[os,_o,mu]}),t})();function fJ(t,n){if(1&t){const e=xt();F(0,"button",8),Oe("click",function(){return Ie(e),Me(q(2).showFirstPage=!0)}),F(1,"mat-icon"),ce(2,"arrow_back"),V()()}2&t&&B("disabled",q(2).uploadingPlaylist)}function mJ(t,n){if(1&t&&(F(0,"div",5),J(1,fJ,3,1,"button",6),F(2,"h2",7),ce(3),V()()),2&t){const e=q();j(1),B("ngIf",!e.showFirstPage),j(2),Jt(e.newPLaylist?"Crear playlist":"A\xf1adir vibes")}}function gJ(t,n){1&t&&(F(0,"p",17),ce(1,"Introduce un t\xedtulo para tu playlist"),V())}function _J(t,n){1&t&&(F(0,"p",23),ce(1,"Introduce una descripci\xf3n para tu playlist"),V())}function yJ(t,n){if(1&t&&(F(0,"form",18)(1,"div",19),Ne(2,"input",20),V(),J(3,_J,2,0,"p",21),Ne(4,"textarea",22),V()),2&t){const e=q(2);B("formGroup",e.searchForm),j(3),B("ngIf",e.newPLaylist)}}function vJ(t,n){if(1&t){const e=xt();F(0,"div")(1,"div",9)(2,"div",10)(3,"div"),J(4,gJ,2,0,"p",11),V()()(),J(5,yJ,5,2,"form",12),F(6,"button",13),Oe("click",function(){return Ie(e),Me(q().continue())}),F(7,"div",14)(8,"span",15)(9,"p",16),ce(10," Continuar "),V()()()()()}if(2&t){const e=q();j(4),B("ngIf",e.newPLaylist),j(1),B("ngIf",e.newPLaylist),j(1),B("disabled",!e.searchForm.valid&&e.newPLaylist||(e.newPLaylist||e.uploadingPlaylist||0==e.selectedVibes.length)&&!e.newPLaylist)}}function bJ(t,n){if(1&t){const e=xt();F(0,"div",33)(1,"div",34)(2,"div",35)(3,"h4",36),ce(4," Tus vibes "),V(),F(5,"div",15)(6,"span",37),Ne(7,"i",38),F(8,"input",39),Oe("input",function(r){Ie(e),q();const s=jn(4),l=q();return Me(s.filterGlobal(l.getEventValue(r),"contains"))}),V()()()()()()}}function xJ(t,n){1&t&&(F(0,"tr")(1,"th",40)(2,"div",41),ce(3," T\xedtulo "),Ne(4,"p-sortIcon",42),V()(),F(5,"th",43)(6,"div",41),ce(7," Lugar "),Ne(8,"p-sortIcon",44),V()(),F(9,"th",45)(10,"div",46),ce(11," Duraci\xf3n "),Ne(12,"p-sortIcon",47),V()()())}function wJ(t,n){if(1&t&&(F(0,"tr",48)(1,"td",49)(2,"div",50),Ne(3,"img",51),F(4,"div",52)(5,"p",53),ce(6),V(),F(7,"p",54),ce(8),V()()()(),F(9,"td",55),ce(10),V(),F(11,"td",49)(12,"div",56)(13,"div",57),ce(14),V()()()()),2&t){const e=n.$implicit,o=n.rowIndex;B("pSelectableRow",e)("pSelectableRowIndex",o),j(3),To("src",e.image,Co),B("alt",e.name),j(3),Jt(e.name),j(2),ei(" ",e.album," "),j(2),Jt(e.place),j(4),Jt(e.time)}}function CJ(t,n){1&t&&(F(0,"tr")(1,"td",58),ce(2,"No se ha encontrado ning\xfan vibe"),V()())}function TJ(t,n){if(1&t&&(F(0,"div",59),ce(1),V()),2&t){const e=q(2);j(1),ei(" ",e.vibes.length," vibes encontrados ")}}function EJ(t,n){1&t&&Ne(0,"p-progressSpinner",60)}const SJ=function(){return["name","album"]},DJ=function(){return[10,25,50]};function MJ(t,n){if(1&t){const e=xt();F(0,"div")(1,"p",24),ce(2,"Selecciona vibes"),V(),F(3,"p-table",25,26),Oe("selectionChange",function(r){return Ie(e),Me(q().selectedVibes=r)}),J(5,bJ,9,0,"ng-template",27),J(6,xJ,13,0,"ng-template",28),J(7,wJ,15,8,"ng-template",29),J(8,CJ,3,0,"ng-template",30),J(9,TJ,2,1,"ng-template",31),V(),F(10,"button",13),Oe("click",function(){return Ie(e),Me(q().uploadPlaylist())}),F(11,"div",14)(12,"span",15),J(13,EJ,1,0,"p-progressSpinner",32),F(14,"p",16),ce(15),V()()()()()}if(2&t){const e=q();j(3),B("value",e.vibes)("scrollable",!0)("selection",e.selectedVibes)("loading",e.loading)("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",ai(11,SJ))("rowsPerPageOptions",ai(12,DJ)),j(7),B("disabled",(!e.searchForm.valid||e.uploadingPlaylist||0==e.selectedVibes.length)&&e.newPLaylist||(e.newPLaylist||e.uploadingPlaylist||0==e.selectedVibes.length)&&!e.newPLaylist),j(3),B("ngIf",e.uploadingPlaylist),j(2),ei(" ",e.buttonTitle,"")}}const IJ=function(){return{width:"700px"}},kJ=function(){return{"700px":"95vw"}},AJ=function(t,n,e,o,r,s,l){return{"h-410":t,"h-0":n,"h-1":e,"h-2":o,"h-3":r,"h-4":s,"h-5":l}};let yF=(()=>{class t{constructor(){this.showDialog=new Tt,this.showFirstPage=!0,this.uploadingPlaylist=!1,this.displayTable=!1,this.loading=!1,this.creatingPlaylist="Crear playlist",this.displaySuccess=!1,this.selectedVibes=[]}ngOnInit(){this.searchForm=new tl({playlistTitle:new gs(this.playlistTitle,[ms.required]),playlistDescription:new gs(this.playlistDescription,[])}),this.vibes=[{id:1,name:"Guren no Yumiya",album:"Shingeki no Kiseki",place:"Tokyo",image:"https://media.tenor.com/zBc1XhcbTSoAAAAC/nyan-cat-rainbow.gif",time:"5:11"},{id:2,name:"the WORLD",album:"the WORLD Ruler",place:"Osaka",image:"https://media.tenor.com/_j7XP1twrFYAAAAC/nyan-cat-halloween.gif",time:"3:48"},{id:3,name:"the WORLD",album:"the WORLD Ruler",place:"Kyoto",image:"https://media.tenor.com/v9sdELSzVw4AAAAC/nyan-cat-kawaii.gif",time:"3:48"}]}cancel(){this.buttonTitle="Crear playlist",this.newPLaylist?this.showFirstPage=!0:this.buttonTitle="A\xf1adir vibes",this.uploadingPlaylist=!1,this.selectedVibes=[],this.searchForm.reset(),this.showDialog.emit(!1)}getEventValue(e){return e.target.value}uploadPlaylist(){var e=this;return hu(function*(){e.buttonTitle=e.newPLaylist?"Creando playlist...":"A\xf1adiendo vibes...",e.uploadingPlaylist=!0,e.newPLaylist&&(console.log(e.searchForm.value.playlistTitle),console.log(e.searchForm.value.playlistDescription));for(let o=0;o<e.selectedVibes.length;o++)console.log(e.selectedVibes[o]);yield new Promise(o=>setTimeout(o,5e3)),e.showDialog.emit(!1),e.newPLaylist?(e.successTitle="Playlist creada",e.successMessage="La playlist se ha creado correctamente"):(e.successTitle="Playlist actualizada",e.successMessage="Se han a\xf1adido los vibes correctamente"),e.displaySuccess=!0})()}onHide(e){this.displaySuccess=e}continue(){this.showFirstPage=!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-new-playlist-dialog"]],inputs:{display:"display",newPLaylist:"newPLaylist",buttonTitle:"buttonTitle"},outputs:{showDialog:"showDialog"},decls:6,vars:23,consts:[[3,"visible","closable","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[1,"animation","h-120","pt-2",3,"ngClass"],[4,"ngIf"],[3,"display","title","message","showDialog"],[1,"flex","align-items-center","mb-1"],["class","back-buttons flex align-items-center justify-content-center mr-2","type","button",3,"disabled","click",4,"ngIf"],[1,"p-dialog-title"],["type","button",1,"back-buttons","flex","align-items-center","justify-content-center","mr-2",3,"disabled","click"],[1,"flex","justify-content-between","flex-wrap","card-container"],[1,"flex"],["class","mt-2","style","margin-bottom: 15px;",4,"ngIf"],[3,"formGroup",4,"ngIf"],["pButton","","pRipple","",1,"mt-4","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"],[1,"mt-2",2,"margin-bottom","15px"],[3,"formGroup"],[1,"p-inputgroup","h-fit"],["id","playlistTitle","name","playlistTitle","formControlName","playlistTitle","placeholder","Nombre de la playlist","type","text","pInputText","",1,"form-control","h-3rem"],["style","margin-bottom: 15px; margin-top: 15px;",4,"ngIf"],["id","playlistDescription","name","playlistDescription","formControlName","playlistDescription","placeholder","A\xf1adir descripci\xf3n",1,"w-full","h-10rem","border-none","p-3",2,"resize","none","border-radius","10px","font-family","Lato","color","var(--fontColor)","background","var(--frostedBackground)","outline","0.15rem solid #93cbf9"],[2,"margin-bottom","15px","margin-top","15px"],[1,"mt-4",2,"margin-bottom","15px"],["dataKey","id","selectionMode","multiple","styleClass","p-datatable-sm","scrollHeight","330px","currentPageReportTemplate","{first} a {last}",3,"value","scrollable","selection","loading","rowHover","showCurrentPageReport","globalFilterFields","rowsPerPageOptions","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],["strokeWidth","5","class","mr-3",4,"ngIf"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"md:m-0","mb-3","text-center","md:text-left"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Filtrar",3,"input"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center","name-size"],["field","name"],["pSortableColumn","album"],["field","album"],["pSortableColumn","time"],[1,"flex","justify-content-between","align-items-center","margin-td-right",2,"float","right"],["field","time"],[3,"pSelectableRow","pSelectableRowIndex"],[1,"padding-td"],[1,"flex","align-items-center","justify-content-start","w-auto","h-auto"],[1,"h-3rem","w-3rem","border-round-sm","mr-3",3,"src","alt"],[1,"text-left"],[1,"text-lg","mb-1"],[1,"text-sm","text-color-secondary","mb-1"],[1,"padding-td","name-size"],[1,"margin-td-right",2,"float","right"],[1,"ml-3","name-size",2,"height","40px","text-align","start","display","flex","align-items","center"],["colspan","8"],[1,"flex","align-items-center","justify-content-between"],["strokeWidth","5",1,"mr-3"]],template:function(e,o){1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.display=s})("onHide",function(){return o.cancel()}),J(1,mJ,4,2,"ng-template",1),F(2,"div",2),J(3,vJ,11,3,"div",3),J(4,MJ,16,13,"div",3),V()(),F(5,"app-success-dialog-edit",4),Oe("showDialog",function(s){return o.onHide(s)}),V()),2&e&&(Ao(ai(13,IJ)),B("visible",o.display)("closable",!o.uploadingPlaylist)("modal",!0)("draggable",!1)("breakpoints",ai(14,kJ)),j(2),B("ngClass",oE(15,AJ,o.showFirstPage&&o.newPLaylist,!(0!=o.vibes.length||o.showFirstPage&&o.newPLaylist),!(1!=o.vibes.length||o.showFirstPage&&o.newPLaylist),!(2!=o.vibes.length||o.showFirstPage&&o.newPLaylist),!(3!=o.vibes.length||o.showFirstPage&&o.newPLaylist),!(4!=o.vibes.length||o.showFirstPage&&o.newPLaylist),o.vibes.length>=5&&(!o.showFirstPage||!o.newPLaylist))),j(1),B("ngIf",o.showFirstPage&&o.newPLaylist),j(1),B("ngIf",!o.showFirstPage||!o.newPLaylist),j(1),B("display",o.displaySuccess)("title",o.successTitle)("message",o.successMessage))},dependencies:[Eo,mi,tf,dd,Tl,ef,pd,nf,os,_o,fc,bd,Yb,cF,Ww,mu,El,mf,qw],styles:["p[_ngcontent-%COMP%]{margin:0}.vibe-container[_ngcontent-%COMP%]{width:100%;display:flex}.image-column[_ngcontent-%COMP%]{width:50px;height:100%;align-items:start;right:0;top:7px}.text-column[_ngcontent-%COMP%]{margin-left:1rem;flex-grow:1;width:100%;height:100%;justify-content:center;align-items:start}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:#fff!important}[_nghost-%COMP%]     .p-progress-spinner{height:30px;width:30px}[_nghost-%COMP%]     .p-dialog .p-dialog-header{padding-bottom:0}[_nghost-%COMP%]     .p-datatable.p-datatable-sm .p-datatable-footer{border-bottom-left-radius:10px!important;border-bottom-right-radius:10px}[_nghost-%COMP%]     .p-dialog .p-dialog-content{padding-top:0}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr:focus{outline:.15rem solid #93cbf9;outline-offset:-.15rem}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr.p-highlight{background:var(--selectedItemTable)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr{background:var(--frostedTable)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background:var(--selectedItemTable)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-header{background:var(--selectedItem)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-footer{background:var(--selectedItem)!important;border-width:0px 1px 1px 1px}[_nghost-%COMP%]     .p-datatable.p-datatable-scrollable>.p-datatable-wrapper>.p-datatable-table>.p-datatable-thead{background:var(--selectedItem)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{background:var(--frostedTable)!important}.animation[_ngcontent-%COMP%]{transition:var(--transition)}.h-120[_ngcontent-%COMP%]{height:150px}.h-410[_ngcontent-%COMP%]{height:380px}.h-0[_ngcontent-%COMP%]{height:305px!important}.h-1[_ngcontent-%COMP%]{height:335px!important}.h-2[_ngcontent-%COMP%]{height:395px!important}.h-3[_ngcontent-%COMP%]{height:460px!important}.h-4[_ngcontent-%COMP%]{height:525px!important}.h-5[_ngcontent-%COMP%]{height:560px!important}.h-460[_ngcontent-%COMP%]{height:300px!important}.h-thirdPage[_ngcontent-%COMP%]{height:470px!important}"]}),t})();function PJ(t,n){if(1&t&&(F(0,"div",10)(1,"div",11),Ne(2,"i"),V()()),2&t){const e=q();j(2),Xn("p-dataview-loading-icon pi-spin "+e.loadingIcon)}}function OJ(t,n){1&t&&Ht(0)}function RJ(t,n){if(1&t&&(F(0,"div",12),Qi(1),J(2,OJ,1,0,"ng-container",13),V()),2&t){const e=q();j(2),B("ngTemplateOutlet",e.headerTemplate)}}function LJ(t,n){if(1&t){const e=xt();F(0,"p-paginator",14),Oe("onPageChange",function(r){return Ie(e),Me(q().paginate(r))}),V()}if(2&t){const e=q();B("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showPageLinks",e.showPageLinks)}}function FJ(t,n){1&t&&Ht(0)}const zJ=function(t,n){return{$implicit:t,rowIndex:n}};function NJ(t,n){if(1&t&&J(0,FJ,1,0,"ng-container",15),2&t){const e=n.$implicit,o=n.index;B("ngTemplateOutlet",q().itemTemplate)("ngTemplateOutletContext",no(2,zJ,e,o))}}function BJ(t,n){if(1&t&&(xn(0),ce(1),In()),2&t){const e=q(2);j(1),ei(" ",e.emptyMessageLabel," ")}}function VJ(t,n){1&t&&Ht(0,null,19)}function UJ(t,n){if(1&t&&(F(0,"div",16)(1,"div",17),J(2,BJ,2,1,"ng-container",18),J(3,VJ,2,0,"ng-container",13),V()()),2&t){const e=q();j(2),B("ngIf",!e.emptyMessageTemplate)("ngIfElse",e.emptyFilter),j(1),B("ngTemplateOutlet",e.emptyMessageTemplate)}}function jJ(t,n){if(1&t){const e=xt();F(0,"p-paginator",20),Oe("onPageChange",function(r){return Ie(e),Me(q().paginate(r))}),V()}if(2&t){const e=q();B("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showPageLinks",e.showPageLinks)}}function HJ(t,n){1&t&&Ht(0)}function $J(t,n){if(1&t&&(F(0,"div",21),Qi(1,1),J(2,HJ,1,0,"ng-container",13),V()),2&t){const e=q();j(2),B("ngTemplateOutlet",e.footerTemplate)}}const GJ=[[["p-header"]],[["p-footer"]]],WJ=function(t,n){return{"p-dataview p-component":!0,"p-dataview-list":t,"p-dataview-grid":n}},qJ=["p-header","p-footer"],vF=function(t){return{"p-highlight":t}};let bF=(()=>{class t{constructor(e,o,r,s){this.el=e,this.cd=o,this.filterService=r,this.config=s,this.pageLinks=5,this.paginatorPosition="bottom",this.alwaysShowPaginator=!0,this.paginatorDropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.showPageLinks=!0,this.emptyMessage="",this.onLazyLoad=new Tt,this.gridStyleClass="",this.trackBy=(l,h)=>h,this.loadingIcon="pi pi-spinner",this.first=0,this.onPage=new Tt,this.onSort=new Tt,this.onChangeLayout=new Tt,this._layout="list"}get layout(){return this._layout}set layout(e){this._layout=e,this.initialized&&this.changeLayout(e)}ngOnInit(){this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()}),this.initialized=!0}ngOnChanges(e){e.value&&(this._value=e.value.currentValue,this.updateTotalRecords(),!this.lazy&&this.hasFilter()&&this.filter(this.filterValue)),(e.sortField||e.sortOrder)&&(!this.lazy||this.initialized)&&this.sort()}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"listItem":this.listItemTemplate=e.template;break;case"gridItem":this.gridItemTemplate=e.template;break;case"paginatorleft":this.paginatorLeftTemplate=e.template;break;case"paginatorright":this.paginatorRightTemplate=e.template;break;case"paginatordropdownitem":this.paginatorDropdownItemTemplate=e.template;break;case"empty":this.emptyMessageTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}}),this.updateItemTemplate()}updateItemTemplate(){switch(this.layout){case"list":this.itemTemplate=this.listItemTemplate;break;case"grid":this.itemTemplate=this.gridItemTemplate}}changeLayout(e){this._layout=e,this.onChangeLayout.emit({layout:this.layout}),this.updateItemTemplate(),this.cd.markForCheck()}updateTotalRecords(){this.totalRecords=this.lazy?this.totalRecords:this._value?this._value.length:0}paginate(e){this.first=e.first,this.rows=e.rows,this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.onPage.emit({first:this.first,rows:this.rows})}sort(){this.first=0,this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.value.sort((e,o)=>{let r=_n.resolveFieldData(e,this.sortField),s=_n.resolveFieldData(o,this.sortField),l=null;return l=null==r&&null!=s?-1:null!=r&&null==s?1:null==r&&null==s?0:"string"==typeof r&&"string"==typeof s?r.localeCompare(s):r<s?-1:r>s?1:0,this.sortOrder*l}),this.hasFilter()&&this.filter(this.filterValue)),this.onSort.emit({sortField:this.sortField,sortOrder:this.sortOrder})}isEmpty(){let e=this.filteredValue||this.value;return null==e||0==e.length}createLazyLoadMetadata(){return{first:this.first,rows:this.rows,sortField:this.sortField,sortOrder:this.sortOrder}}getBlockableElement(){return this.el.nativeElement.children[0]}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(Dr.EMPTY_MESSAGE)}filter(e,o="contains"){if(this.filterValue=e,this.value&&this.value.length){let r=this.filterBy.split(",");this.filteredValue=this.filterService.filter(this.value,r,e,o,this.filterLocale),this.filteredValue.length===this.value.length&&(this.filteredValue=null),this.paginator&&(this.first=0,this.totalRecords=this.filteredValue?this.filteredValue.length:this.value?this.value.length:0),this.cd.markForCheck()}}hasFilter(){return this.filterValue&&this.filterValue.trim().length>0}ngOnDestroy(){this.translationSubscription&&this.translationSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(Po),be($D),be(Il))},t.\u0275cmp=on({type:t,selectors:[["p-dataView"]],contentQueries:function(e,o,r){if(1&e&&(No(r,GD,5),No(r,Uw,5),No(r,_o,4)),2&e){let s;mn(s=gn())&&(o.header=s.first),mn(s=gn())&&(o.footer=s.first),mn(s=gn())&&(o.templates=s)}},hostAttrs:[1,"p-element"],inputs:{paginator:"paginator",rows:"rows",totalRecords:"totalRecords",pageLinks:"pageLinks",rowsPerPageOptions:"rowsPerPageOptions",paginatorPosition:"paginatorPosition",alwaysShowPaginator:"alwaysShowPaginator",paginatorDropdownAppendTo:"paginatorDropdownAppendTo",paginatorDropdownScrollHeight:"paginatorDropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showJumpToPageDropdown:"showJumpToPageDropdown",showFirstLastIcon:"showFirstLastIcon",showPageLinks:"showPageLinks",lazy:"lazy",emptyMessage:"emptyMessage",style:"style",styleClass:"styleClass",gridStyleClass:"gridStyleClass",trackBy:"trackBy",filterBy:"filterBy",filterLocale:"filterLocale",loading:"loading",loadingIcon:"loadingIcon",first:"first",sortField:"sortField",sortOrder:"sortOrder",value:"value",layout:"layout"},outputs:{onLazyLoad:"onLazyLoad",onPage:"onPage",onSort:"onSort",onChangeLayout:"onChangeLayout"},features:[ur],ngContentSelectors:qJ,decls:11,vars:20,consts:[[3,"ngClass","ngStyle"],["class","p-dataview-loading",4,"ngIf"],["class","p-dataview-header",4,"ngIf"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","dropdownAppendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","onPageChange",4,"ngIf"],[1,"p-dataview-content"],[1,"p-grid","p-nogutter","grid","grid-nogutter",3,"ngClass"],["ngFor","",3,"ngForOf","ngForTrackBy"],["class","p-col col",4,"ngIf"],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","dropdownAppendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","onPageChange",4,"ngIf"],["class","p-dataview-footer",4,"ngIf"],[1,"p-dataview-loading"],[1,"p-dataview-loading-overlay","p-component-overlay"],[1,"p-dataview-header"],[4,"ngTemplateOutlet"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","dropdownAppendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","onPageChange"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-col","col"],[1,"p-dataview-emptymessage"],[4,"ngIf","ngIfElse"],["emptyFilter",""],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","dropdownAppendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"p-dataview-footer"]],template:function(e,o){1&e&&(or(GJ),F(0,"div",0),J(1,PJ,3,2,"div",1),J(2,RJ,3,1,"div",2),J(3,LJ,1,16,"p-paginator",3),F(4,"div",4)(5,"div",5),J(6,NJ,1,5,"ng-template",6),nc(7,"slice"),J(8,UJ,4,3,"div",7),V()(),J(9,jJ,1,16,"p-paginator",8),J(10,$J,3,1,"div",9),V()),2&e&&(Xn(o.styleClass),B("ngClass",no(17,WJ,"list"===o.layout,"grid"===o.layout))("ngStyle",o.style),j(1),B("ngIf",o.loading),j(1),B("ngIf",o.header||o.headerTemplate),j(1),B("ngIf",o.paginator&&("top"===o.paginatorPosition||"both"==o.paginatorPosition)),j(2),B("ngClass",o.gridStyleClass),j(1),B("ngForOf",o.paginator?Gm(7,13,o.filteredValue||o.value,o.lazy?0:o.first,(o.lazy?0:o.first)+o.rows):o.filteredValue||o.value)("ngForTrackBy",o.trackBy),j(2),B("ngIf",o.isEmpty()&&!o.loading),j(1),B("ngIf",o.paginator&&("bottom"===o.paginatorPosition||"both"==o.paginatorPosition)),j(1),B("ngIf",o.footer||o.footerTemplate))},dependencies:[Eo,Ms,mi,Is,Oo,oF,rb],styles:[".p-dataview{position:relative}.p-dataview .p-dataview-loading-overlay{position:absolute;display:flex;align-items:center;justify-content:center;z-index:2}\n"],encapsulation:2,changeDetection:0}),t})(),ZJ=(()=>{class t{constructor(e){this.dv=e}changeLayout(e,o){this.dv.changeLayout(o),e.preventDefault()}}return t.\u0275fac=function(e){return new(e||t)(be(bF))},t.\u0275cmp=on({type:t,selectors:[["p-dataViewLayoutOptions"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass"},decls:5,vars:10,consts:[[3,"ngClass","ngStyle"],["type","button",1,"p-button","p-button-icon-only",3,"ngClass","click","keydown.enter"],[1,"pi","pi-bars"],[1,"pi","pi-th-large"]],template:function(e,o){1&e&&(F(0,"div",0)(1,"button",1),Oe("click",function(s){return o.changeLayout(s,"list")})("keydown.enter",function(s){return o.changeLayout(s,"list")}),Ne(2,"i",2),V(),F(3,"button",1),Oe("click",function(s){return o.changeLayout(s,"grid")})("keydown.enter",function(s){return o.changeLayout(s,"grid")}),Ne(4,"i",3),V()()),2&e&&(Xn(o.styleClass),B("ngClass","p-dataview-layout-options p-selectbutton p-buttonset")("ngStyle",o.style),j(1),B("ngClass",An(6,vF,"list"===o.dv.layout)),j(2),B("ngClass",An(8,vF,"grid"===o.dv.layout)))},dependencies:[Eo,Oo],encapsulation:2}),t})(),KJ=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,is,rF,is]}),t})();const XJ=["playlistCard"];function YJ(t,n){if(1&t){const e=xt();F(0,"div",7)(1,"h3",8),ce(2),V(),F(3,"div",9)(4,"span",10)(5,"div",11),Ne(6,"i",12),F(7,"input",13),Oe("input",function(r){Ie(e);const s=q();return Me(jn(2).filter(s.getEventValue(r),"contains"))}),V()()()(),Ne(8,"p-dataViewLayoutOptions",14),V()}if(2&t){const e=q();j(2),Jt(e.title)}}const Zw=function(t,n,e){return["/playlists",t,n,e]};function QJ(t,n){if(1&t&&(F(0,"div",15)(1,"div",16)(2,"div",17),Ne(3,"img",18),V(),F(4,"div",19)(5,"div",20),ce(6),V(),F(7,"div",21),ce(8),V()(),F(9,"div",22)(10,"button",23)(11,"div",24)(12,"mat-icon"),ce(13,"play_arrow"),V()()()()()()),2&t){const e=n.$implicit;j(1),B("routerLink",$r(6,Zw,e.id,e.name,e.image)),j(2),B("src",e.image,Co)("alt",e.name),j(3),Jt(e.name),j(2),Jt(e.author),j(2),B("routerLink",$r(10,Zw,e.id,e.name,e.image))}}const JJ=function(t){return{background:t}},eee=function(t){return{display:t}};function tee(t,n){if(1&t){const e=xt();F(0,"div",25)(1,"div",26),Oe("mouseenter",function(){const s=Ie(e).$implicit;return Me(q().mouseEnter(s.id,"card"))})("mouseleave",function(){return Ie(e),Me(q().mouseLeave("card"))}),F(2,"div",27)(3,"div",28),Ne(4,"img",18),F(5,"button",29)(6,"div",24)(7,"mat-icon"),ce(8,"play_arrow"),V()()()(),F(9,"div",30),ce(10),V(),F(11,"div",21),ce(12),V()()()()}if(2&t){const e=n.$implicit,o=q();j(1),B("ngStyle",An(8,JJ,o.mouseInCard&&o.selected==e.id?"var(--selectedItem)":"transparent"))("routerLink",$r(10,Zw,e.id,e.name,e.image)),j(3),B("src",e.image,Co)("alt",e.name),j(1),B("routerLink",$r(14,Zw,e.id,e.name,e.image))("ngStyle",An(18,eee,o.mouseInCard&&o.selected==e.id?"flex":"none")),j(5),Jt(e.name),j(2),Jt(e.author)}}function nee(t,n){1&t&&(F(0,"p"),ce(1,"No se ha encontrado ninguna playlist"),V())}let iee=(()=>{class t{constructor(){this.mouseInCard=!1,this.selected=0}mouseEnter(e,o){this.mouseInCard=!0,this.selected=e}mouseLeave(e){this.mouseInCard=!1,this.selected=0}getEventValue(e){return e.target.value}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-playlist-table"]],viewQuery:function(e,o){if(1&e&&pi(XJ,5),2&e){let r;mn(r=gn())&&(o.playlistCard=r.first)}},inputs:{title:"title",playlists:"playlists"},decls:7,vars:3,consts:[[1,"containers"],["filterBy","name","layout","grid",3,"value","paginator","rows"],["dv",""],["pTemplate","header"],["pTemplate","listItem"],["pTemplate","gridItem"],["pTemplate","empty"],[1,"flex","flex-column","md:flex-row","md:justify-content-between"],[1,"mb-2","ml-3","show-titles-sm","text-center","md:text-left"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"p-input-icon-left","mb-2","md:mb-0","flex","align-items-center","justify-content-center"],[1,"relative"],[1,"pi","pi-search","absolute",2,"top","10px","left","10px"],["type","search","pInputText","","placeholder","Buscar por nombre",2,"padding-left","30px",3,"input"],[1,"flex","align-items-center","justify-content-center"],[1,"col-12"],[1,"grow","product-list-item",3,"routerLink"],[1,"mr-4",2,"width","8%"],[2,"border-radius","5px",3,"src","alt"],[1,"product-list-detail"],[1,"product-name"],[1,"product-description"],[1,"product-list-action"],["id","play-btn",1,"flex","align-items-center","justify-content-center","border-circle","play-icon","border-none",2,"width","50px","height","50px","cursor","pointer",3,"routerLink"],[1,"flex","align-items-center","justify-content-center","border-circle","bg-white",2,"height","28px !important","width","28px !important"],[1,"playlist-width"],[1,"product-grid-item","card",2,"cursor","pointer",3,"ngStyle","routerLink","mouseenter","mouseleave"],[1,"product-grid-item-content"],[1,"relative","mb-2",2,"width","100%"],["id","play-btn",1,"z-2","absolute","align-items-center","justify-content-center","border-circle","play-icon","border-none",2,"width","50px","height","50px","bottom","10px","left","10px","cursor","pointer",3,"routerLink","ngStyle"],[1,"product-name","mb-1"]],template:function(e,o){1&e&&(F(0,"div",0)(1,"p-dataView",1,2),J(3,YJ,9,1,"ng-template",3),J(4,QJ,14,14,"ng-template",4),J(5,tee,13,20,"ng-template",5),J(6,nee,2,0,"ng-template",6),V()()),2&e&&(j(1),B("value",o.playlists)("paginator",!0)("rows",9))},dependencies:[sg,Oo,_o,fc,El,bF,ZJ],styles:[".play-icon[_ngcontent-%COMP%]{background:var(--gradient45);box-shadow:var(--shadows)}mat-icon[_ngcontent-%COMP%]{background:var(--gradient45);-webkit-background-clip:text;-moz-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}.card[_ngcontent-%COMP%]{background:var(--surface-card);padding:1rem;border-radius:10px;margin-bottom:0rem}.product-grid-item[_ngcontent-%COMP%]{margin:.5em;display:grid;align-items:start;justify-content:space-between;text-align:center}.product-grid-item-bottom[_ngcontent-%COMP%], .product-grid-item-top[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.product-grid-item-content[_ngcontent-%COMP%]{text-align:center}.product-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}.product-description[_ngcontent-%COMP%]{font-size:.875rem}.product-category-icon[_ngcontent-%COMP%]{vertical-align:middle;margin-right:.5rem}.product-category[_ngcontent-%COMP%]{font-weight:600;vertical-align:middle}.product-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem;width:100%;align-self:flex-end;flex-direction:column;flex-direction:row;justify-content:space-between}.product-list-action[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-right:10px}.product-list-detail[_ngcontent-%COMP%]{flex:1 1 0}img[_ngcontent-%COMP%]{box-shadow:0 3px 6px #00000029,0 3px 6px #0000003b;margin-right:2rem;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.playlist-width[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .p-dataview-header{border-width:1px;border-top-left-radius:10px;border-top-right-radius:10px}[_nghost-%COMP%]     .p-dataview-content{border:1px solid var(--surface-border);border-width:0 1px 0 1px}[_nghost-%COMP%]     .p-paginator-bottom{border-width:1px 1px 1px 1px;border-bottom-left-radius:10px;border-bottom-right-radius:10px}[_nghost-%COMP%]     .p-button{border-radius:5px!important;margin-right:10px;height:auto;border:none;background:var(--selectedItemTable)}[_nghost-%COMP%]     .product-list-item:hover{background:var(--selectedItem);cursor:pointer}@media (min-width: 500px){.playlist-width[_ngcontent-%COMP%]{width:100%}}@media (min-width: 600px){.playlist-width[_ngcontent-%COMP%]{width:50%}}@media (min-width: 1100px){.playlist-width[_ngcontent-%COMP%]{width:33.333333%}}@media (min-width: 1300px){.playlist-width[_ngcontent-%COMP%]{width:25%}}@media (min-width: 1600px){.playlist-width[_ngcontent-%COMP%]{width:20%}}@media (min-width: 2000px){.playlist-width[_ngcontent-%COMP%]{width:16.66666666%}}@media (min-width: 2500px){.playlist-width[_ngcontent-%COMP%]{width:14,2857142857%}}"]}),t})();function oee(t,n){if(1&t){const e=xt();F(0,"div",7)(1,"h1",8),ce(2),V(),F(3,"button",9),Oe("click",function(){return Ie(e),Me(q().displayNewPlaylistDialog=!0)}),ce(4," Crear playlist "),V()()}if(2&t){const e=q();j(2),ei(" ",e.appLayout.currentRoute," ")}}let ree=(()=>{class t{constructor(e){this.appLayout=e,this.yourplaylists=[],this.following=[],this.reccomended=[],this.outline=!0,this.buttonTitle="Crear playlist",this.newPlaylist=!0,this.displayNewPlaylistDialog=!1}ngOnInit(){this.yourplaylists=[{id:1,name:"Lo mejor de lana del rey",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/6b3c60d3ae7e6d45d9759fb92f0d8a5f.jpg",author:"De Pilar Ester"},{id:2,name:"Los 2000",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/0381435cc855b88bdbdeb6dfc00b3da9.jpg",author:"De Jaime Roncal"},{id:3,name:"Zaragoza",image:"http://www.madonnalicious.com/images/extra/2009/celebration_album_cover.jpg",author:"De Pilar Ester"},{id:4,name:"De farra en farra",image:"https://i.pinimg.com/originals/8e/f4/19/8ef4198b9b313fccaa711b8cd58aeec0.jpg",author:"De Nacho Ortega"},{id:5,name:"De viaje",image:"https://i.pinimg.com/originals/48/24/93/48249335e8c3852d59a5a27e054bb8d2.jpg",author:"De Jaime Roncal"},{id:6,name:"De fiesta",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",author:"De Pilar Ester"},{id:7,name:"Viaje a Disney",image:"https://i.pinimg.com/originals/d0/20/00/d02000f30b49b7009e8316ab970264f5.jpg",author:"De Pilar Ester"}],this.following=[{id:1,name:"Mis viajes al hospital",image:"https://1.bp.blogspot.com/-8vqVKpVMHis/WdRYMBXMU6I/AAAAAAAAAek/BO5QjRw13B0zX3d0aG4zTUroqK2IPyPDQCLcBGAs/s1600/cover.jpg",author:"De Pilar Ester",favorite:!0},{id:2,name:"Green day",image:"https://1.bp.blogspot.com/-qPxSouBlGl8/WagHNY9pTHI/AAAAAAAAAdk/6TccPwoe0cMlQq5QWZ2WSgFteSx2Q9DuQCLcBGAs/s1600/COVER.jpg",author:"De Jaime Roncal",favorite:!0},{id:3,name:"Magical mirai",image:"https://4.bp.blogspot.com/-SSDZn988cZQ/U-MqsVwXpbI/AAAAAAAADqk/YEnQqHOqlDg/s1600/cover.jpg",author:"De Nacho Ortega",favorite:!0},{id:4,name:"yesssssss",image:"https://images-na.ssl-images-amazon.com/images/I/71BJ5flBQ1L._SL1024_.jpg",author:"De Loreto Matinero",favorite:!0},{id:5,name:"Anime",image:"https://vgmdownloads.com/soundtracks/hatsune-miku-project-diva-f-2nd-complete-collection/cover.png",author:"De Nacho Ortega",favorite:!0},{id:6,name:"Canis de los 2000",image:"https://s.pacn.ws/1500/v8/hatsune-miku-magical-mirai-2018-official-album-cd-dvd-limited-e-562439.1.jpg?p8p6b3",author:"De Nacho Ortega",favorite:!0}]}hideDialog(e){this.displayNewPlaylistDialog=e}}return t.\u0275fac=function(e){return new(e||t)(be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-playlists"]],decls:9,vars:7,consts:[["class","route-name flex align-items-center",4,"ngIf"],[1,"content"],["type","button","tabindex","1",1,"p-button-text","border-round-xl","h-3rem","mb-3","button-gradient","w-full","border-none","display-btn",3,"click"],["title","Tus playlists",3,"playlists"],["title","Siguiendo",3,"playlists"],["title","Recomendadas",3,"playlists"],[3,"display","newPLaylist","buttonTitle","showDialog"],[1,"route-name","flex","align-items-center"],[1,"current-route","w-full"],["type","button","tabindex","1",1,"p-button-text","border-round-xl","h-3rem","button-gradient","w-15rem","border-none",3,"click"]],template:function(e,o){1&e&&(J(0,oee,5,1,"div",0),F(1,"div",1)(2,"button",2),Oe("click",function(){return o.displayNewPlaylistDialog=!0}),ce(3," Crear playlist "),V(),Ne(4,"app-playlist-table",3)(5,"app-playlist-table",4)(6,"app-playlist-table",5),V(),F(7,"app-new-playlist-dialog",6),Oe("showDialog",function(s){return o.hideDialog(s)}),V(),ce(8,">")),2&e&&(B("ngIf",!o.appLayout.showBar),j(4),B("playlists",o.yourplaylists),j(1),B("playlists",o.following),j(1),B("playlists",o.reccomended),j(1),B("display",o.displayNewPlaylistDialog)("newPLaylist",!0)("buttonTitle",o.buttonTitle))},dependencies:[mi,yF,iee],styles:["[_nghost-%COMP%]{width:100%;height:100%}"]}),t})();if(!Rh)var Rh={map:function(t,n){var e={};return n?t.map(function(o,r){return e.index=r,n.call(e,o)}):t.slice()},naturalOrder:function(t,n){return t<n?-1:t>n?1:0},sum:function(t,n){var e={};return t.reduce(n?function(o,r,s){return e.index=s,o+n.call(e,r)}:function(o,r){return o+r},0)},max:function(t,n){return Math.max.apply(null,n?Rh.map(t,n):t)}};var see=function(){var t=5,n=8-t,e=1e3;function o(g,b,T){return(g<<2*t)+(b<<t)+T}function r(g){var b=[],T=!1;function I(){b.sort(g),T=!0}return{push:function(R){b.push(R),T=!1},peek:function(R){return T||I(),void 0===R&&(R=b.length-1),b[R]},pop:function(){return T||I(),b.pop()},size:function(){return b.length},map:function(R){return b.map(R)},debug:function(){return T||I(),b}}}function s(g,b,T,I,R,z,W){var X=this;X.r1=g,X.r2=b,X.g1=T,X.g2=I,X.b1=R,X.b2=z,X.histo=W}function l(){this.vboxes=new r(function(g,b){return Rh.naturalOrder(g.vbox.count()*g.vbox.volume(),b.vbox.count()*b.vbox.volume())})}function h(g,b){if(b.count()){var T=b.r2-b.r1+1,I=b.g2-b.g1+1,R=Rh.max([T,I,b.b2-b.b1+1]);if(1==b.count())return[b.copy()];var z,W,X,ee,le=0,ve=[],xe=[];if(R==T)for(z=b.r1;z<=b.r2;z++){for(ee=0,W=b.g1;W<=b.g2;W++)for(X=b.b1;X<=b.b2;X++)ee+=g[o(z,W,X)]||0;ve[z]=le+=ee}else if(R==I)for(z=b.g1;z<=b.g2;z++){for(ee=0,W=b.r1;W<=b.r2;W++)for(X=b.b1;X<=b.b2;X++)ee+=g[o(W,z,X)]||0;ve[z]=le+=ee}else for(z=b.b1;z<=b.b2;z++){for(ee=0,W=b.r1;W<=b.r2;W++)for(X=b.g1;X<=b.g2;X++)ee+=g[o(W,X,z)]||0;ve[z]=le+=ee}return ve.forEach(function(Be,Ke){xe[Ke]=le-Be}),function(Be){var Ke,ft,Vt,Nt,Ut,Pn=Be+"1",Qn=Be+"2",ki=0;for(z=b[Pn];z<=b[Qn];z++)if(ve[z]>le/2){for(Vt=b.copy(),Nt=b.copy(),Ut=(Ke=z-b[Pn])<=(ft=b[Qn]-z)?Math.min(b[Qn]-1,~~(z+ft/2)):Math.max(b[Pn],~~(z-1-Ke/2));!ve[Ut];)Ut++;for(ki=xe[Ut];!ki&&ve[Ut-1];)ki=xe[--Ut];return Vt[Qn]=Ut,Nt[Pn]=Vt[Qn]+1,[Vt,Nt]}}(R==T?"r":R==I?"g":"b")}}return s.prototype={volume:function(g){var b=this;return b._volume&&!g||(b._volume=(b.r2-b.r1+1)*(b.g2-b.g1+1)*(b.b2-b.b1+1)),b._volume},count:function(g){var b=this,T=b.histo;if(!b._count_set||g){var I,R,z,W=0;for(I=b.r1;I<=b.r2;I++)for(R=b.g1;R<=b.g2;R++)for(z=b.b1;z<=b.b2;z++)W+=T[o(I,R,z)]||0;b._count=W,b._count_set=!0}return b._count},copy:function(){var g=this;return new s(g.r1,g.r2,g.g1,g.g2,g.b1,g.b2,g.histo)},avg:function(g){var b=this,T=b.histo;if(!b._avg||g){var I,R,z,W,X=0,ee=1<<8-t,le=0,ve=0,xe=0;for(R=b.r1;R<=b.r2;R++)for(z=b.g1;z<=b.g2;z++)for(W=b.b1;W<=b.b2;W++)X+=I=T[o(R,z,W)]||0,le+=I*(R+.5)*ee,ve+=I*(z+.5)*ee,xe+=I*(W+.5)*ee;b._avg=X?[~~(le/X),~~(ve/X),~~(xe/X)]:[~~(ee*(b.r1+b.r2+1)/2),~~(ee*(b.g1+b.g2+1)/2),~~(ee*(b.b1+b.b2+1)/2)]}return b._avg},contains:function(g){var b=this,T=g[0]>>n;return gval=g[1]>>n,bval=g[2]>>n,T>=b.r1&&T<=b.r2&&gval>=b.g1&&gval<=b.g2&&bval>=b.b1&&bval<=b.b2}},l.prototype={push:function(g){this.vboxes.push({vbox:g,color:g.avg()})},palette:function(){return this.vboxes.map(function(g){return g.color})},size:function(){return this.vboxes.size()},map:function(g){for(var b=this.vboxes,T=0;T<b.size();T++)if(b.peek(T).vbox.contains(g))return b.peek(T).color;return this.nearest(g)},nearest:function(g){for(var b,T,I,R=this.vboxes,z=0;z<R.size();z++)((T=Math.sqrt(Math.pow(g[0]-R.peek(z).color[0],2)+Math.pow(g[1]-R.peek(z).color[1],2)+Math.pow(g[2]-R.peek(z).color[2],2)))<b||void 0===b)&&(b=T,I=R.peek(z).color);return I},forcebw:function(){var g=this.vboxes;g.sort(function(R,z){return Rh.naturalOrder(Rh.sum(R.color),Rh.sum(z.color))});var b=g[0].color;b[0]<5&&b[1]<5&&b[2]<5&&(g[0].color=[0,0,0]);var T=g.length-1,I=g[T].color;I[0]>251&&I[1]>251&&I[2]>251&&(g[T].color=[255,255,255])}},{quantize:function(g,b){if(!g.length||b<2||b>256)return!1;var ee,le,ve,T=(ee=g,ve=new Array(1<<3*t),ee.forEach(function(xe){le=o(xe[0]>>n,xe[1]>>n,xe[2]>>n),ve[le]=(ve[le]||0)+1}),ve);T.forEach(function(){});var I=function(ee,le){var ve,xe,Be,Ke=1e6,ft=0,Vt=1e6,Nt=0,Ut=1e6,Pn=0;return ee.forEach(function(Qn){(ve=Qn[0]>>n)<Ke?Ke=ve:ve>ft&&(ft=ve),(xe=Qn[1]>>n)<Vt?Vt=xe:xe>Nt&&(Nt=xe),(Be=Qn[2]>>n)<Ut?Ut=Be:Be>Pn&&(Pn=Be)}),new s(Ke,ft,Vt,Nt,Ut,Pn,le)}(g,T),R=new r(function(ee,le){return Rh.naturalOrder(ee.count(),le.count())});function z(ee,le){for(var ve,xe=ee.size(),Be=0;Be<e;){if(xe>=le||Be++>e)return;if((ve=ee.pop()).count()){var Ke=h(T,ve),ft=Ke[0],Vt=Ke[1];if(!ft)return;ee.push(ft),Vt&&(ee.push(Vt),xe++)}else ee.push(ve),Be++}}R.push(I),z(R,.75*b);for(var W=new r(function(ee,le){return Rh.naturalOrder(ee.count()*ee.volume(),le.count()*le.volume())});R.size();)W.push(R.pop());z(W,b);for(var X=new l;W.size();)X.push(W.pop());return X}}}().quantize,xF=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=t.naturalWidth,this.height=this.canvas.height=t.naturalHeight,this.context.drawImage(t,0,0,this.width,this.height)};xF.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var dy=function(){};dy.prototype.getColor=function(t,n){return void 0===n&&(n=10),this.getPalette(t,5,n)[0]},dy.prototype.getPalette=function(t,n,e){var o=function(h){var g=h.colorCount,b=h.quality;if(void 0!==g&&Number.isInteger(g)){if(1===g)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");g=Math.max(g,2),g=Math.min(g,20)}else g=10;return(void 0===b||!Number.isInteger(b)||b<1)&&(b=10),{colorCount:g,quality:b}}({colorCount:n,quality:e}),r=new xF(t),s=function(h,g,b){for(var T,I,R,z,W,X=h,ee=[],le=0;le<g;le+=b)I=X[0+(T=4*le)],R=X[T+1],z=X[T+2],(void 0===(W=X[T+3])||W>=125)&&(I>250&&R>250&&z>250||ee.push([I,R,z]));return ee}(r.getImageData().data,r.width*r.height,o.quality),l=see(s,o.colorCount);return l?l.palette():null},dy.prototype.getColorFromUrl=function(t,n,e){var o=this,r=document.createElement("img");r.addEventListener("load",function(){var s=o.getPalette(r,5,e);n(s[0],t)}),r.src=t},dy.prototype.getImageData=function(t,n){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){if(200==this.status){var o=new Uint8Array(this.response);i=o.length;for(var r=new Array(i),s=0;s<o.length;s++)r[s]=String.fromCharCode(o[s]);var l=r.join(""),h=window.btoa(l);n("data:image/png;base64,"+h)}},e.send()},dy.prototype.getColorAsync=function(t,n,e){var o=this;this.getImageData(t,function(r){var s=document.createElement("img");s.addEventListener("load",function(){var l=o.getPalette(s,5,e);n(l[0],this)}),s.src=r})};const aee=["sublist"],lee=function(t){return{"p-hidden":t}};function cee(t,n){if(1&t&&Ne(0,"li",5),2&t){const e=q().$implicit;B("ngClass",An(1,lee,!1===e.visible))}}function uee(t,n){if(1&t&&Ne(0,"span",17),2&t){const e=q(3).$implicit;B("ngClass",e.icon)("ngStyle",e.iconStyle)}}function dee(t,n){if(1&t&&(F(0,"span",18),ce(1),V()),2&t){const e=q(3).$implicit;j(1),Jt(e.label)}}function hee(t,n){1&t&&Ne(0,"span",19),2&t&&B("innerHTML",q(3).$implicit.label,_h)}function pee(t,n){if(1&t&&(F(0,"span",20),ce(1),V()),2&t){const e=q(3).$implicit;B("ngClass",e.badgeStyleClass),j(1),Jt(e.badge)}}function fee(t,n){1&t&&Ne(0,"span",21)}const wF=function(t){return{"p-disabled":t}};function mee(t,n){if(1&t){const e=xt();F(0,"a",11),Oe("keydown",function(r){return Ie(e),Me(q(3).onItemKeyDown(r))})("click",function(r){Ie(e),q();const s=jn(1),l=q().$implicit;return Me(q().itemClick(r,l,s))}),J(1,uee,1,2,"span",12),J(2,dee,2,1,"span",13),J(3,hee,1,1,"ng-template",null,14,ka),J(5,pee,2,2,"span",15),J(6,fee,1,0,"span",16),V()}if(2&t){const e=jn(4),o=q(2).$implicit,r=q();B("target",o.target)("ngClass",An(11,wF,o.disabled)),st("href",o.url,Co)("title",o.title)("id",o.id)("tabindex",o.disabled||!r.isActive?null:"0"),j(1),B("ngIf",o.icon),j(1),B("ngIf",!1!==o.escape)("ngIfElse",e),j(3),B("ngIf",o.badge),j(1),B("ngIf",o.items)}}function gee(t,n){if(1&t&&Ne(0,"span",17),2&t){const e=q(3).$implicit;B("ngClass",e.icon)("ngStyle",e.iconStyle)}}function _ee(t,n){if(1&t&&(F(0,"span",18),ce(1),V()),2&t){const e=q(3).$implicit;j(1),Jt(e.label)}}function yee(t,n){1&t&&Ne(0,"span",19),2&t&&B("innerHTML",q(3).$implicit.label,_h)}function vee(t,n){if(1&t&&(F(0,"span",20),ce(1),V()),2&t){const e=q(3).$implicit;B("ngClass",e.badgeStyleClass),j(1),Jt(e.badge)}}function bee(t,n){1&t&&Ne(0,"span",24)}const xee=function(){return{exact:!1}};function wee(t,n){if(1&t){const e=xt();F(0,"a",22),Oe("keydown",function(r){return Ie(e),Me(q(3).onItemKeyDown(r))})("click",function(r){Ie(e),q();const s=jn(1),l=q().$implicit;return Me(q().itemClick(r,l,s))}),J(1,gee,1,2,"span",12),J(2,_ee,2,1,"span",13),J(3,yee,1,1,"ng-template",null,14,ka),J(5,vee,2,2,"span",15),J(6,bee,1,0,"span",23),V()}if(2&t){const e=jn(4),o=q(2).$implicit,r=q();B("routerLink",o.routerLink)("queryParams",o.queryParams)("routerLinkActive","p-menuitem-link-active")("routerLinkActiveOptions",o.routerLinkActiveOptions||ai(21,xee))("href",o.url,Co)("target",o.target)("ngClass",An(22,wF,o.disabled))("fragment",o.fragment)("queryParamsHandling",o.queryParamsHandling)("preserveFragment",o.preserveFragment)("skipLocationChange",o.skipLocationChange)("replaceUrl",o.replaceUrl)("state",o.state),st("title",o.title)("id",o.id)("tabindex",o.disabled||!r.isActive?null:"0"),j(1),B("ngIf",o.icon),j(1),B("ngIf",!1!==o.escape)("ngIfElse",e),j(3),B("ngIf",o.badge),j(1),B("ngIf",o.items)}}function Cee(t,n){if(1&t&&Ne(0,"p-slideMenuSub",25),2&t){const e=q(2).$implicit,o=q();B("item",e)("index",o.index+1)("menuWidth",o.menuWidth)}}const Tee=function(t,n){return{"p-menuitem":!0,"p-menuitem-active":t,"p-hidden":n}};function Eee(t,n){if(1&t&&(F(0,"li",6,7),J(2,mee,7,13,"a",8),J(3,wee,7,24,"a",9),J(4,Cee,1,3,"p-slideMenuSub",10),V()),2&t){const e=jn(1),o=q().$implicit,r=q();Xn(o.styleClass),B("ngClass",no(8,Tee,e==r.activeItem,!1===o.visible))("tooltipOptions",o.tooltipOptions)("ngStyle",o.style),j(2),B("ngIf",!o.routerLink),j(1),B("ngIf",o.routerLink),j(1),B("ngIf",o.items)}}function See(t,n){if(1&t&&(J(0,cee,1,3,"li",3),J(1,Eee,5,11,"li",4)),2&t){const e=n.$implicit;B("ngIf",e.separator),j(1),B("ngIf",!e.separator)}}const Dee=function(t,n,e){return{"p-slidemenu-rootlist":t,"p-submenu-list":n,"p-active-submenu":e}},Mee=["container"],Iee=["backward"],kee=["slideMenuContent"],Aee=function(t){return{"p-slidemenu p-component":!0,"p-slidemenu-overlay":t}},Pee=function(t,n){return{showTransitionParams:t,hideTransitionParams:n}},Oee=function(t){return{value:"visible",params:t}};function Ree(t,n){if(1&t){const e=xt();F(0,"div",1,2),Oe("click",function(r){return Ie(e),Me(q().onOverlayClick(r))})("@overlayAnimation.start",function(r){return Ie(e),Me(q().onOverlayAnimationStart(r))})("@overlayAnimation.done",function(r){return Ie(e),Me(q().onOverlayAnimationEnd(r))}),F(2,"div",3)(3,"div",4,5),Ne(5,"p-slideMenuSub",6),V(),F(6,"a",7,8),Oe("keydown.enter",function(r){return Ie(e),Me(q().onBackwardKeydown(r))})("keydown.space",function(r){return Ie(e),Me(q().onBackwardKeydown(r))})("click",function(){return Ie(e),Me(q().goBack())}),Ne(8,"span",9),F(9,"span"),ce(10),V()()()()}if(2&t){const e=q();Xn(e.styleClass),B("ngClass",An(18,Aee,e.popup))("ngStyle",e.style)("@overlayAnimation",An(23,Oee,no(20,Pee,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",!0!==e.popup),j(2),aa("height",e.left?e.viewportHeight+"px":"auto")("width",e.menuWidth+"px"),j(3),B("item",e.model)("index",0)("menuWidth",e.menuWidth)("effectDuration",e.effectDuration)("easing",e.easing),j(1),aa("display",e.left?"block":"none"),j(4),Jt(e.backLabel)}}let Lee=(()=>{class t{constructor(e){this.backLabel="Back",this.easing="ease-out",this.slideMenu=e}itemClick(e,o,r){o.disabled?e.preventDefault():(!o.url&&!o.routerLink&&e.preventDefault(),o.command&&o.command({originalEvent:e,item:o}),o.items&&!this.slideMenu.animating&&(this.slideMenu.left-=this.slideMenu.menuWidth,this.activeItem=r,this.slideMenu.animating=!0,setTimeout(()=>this.slideMenu.animating=!1,this.effectDuration)),!o.items&&this.slideMenu.popup&&this.slideMenu.hide())}focusNextList(e){if(!this.slideMenu.animating){let o=Fe.getFocusableElements(e);o&&o.length>0&&o[0].focus(),this.unbindTransitionEndListener()}}onItemKeyDown(e){let o=e.currentTarget.parentElement;switch(e.code){case"Space":case"Enter":o&&!Fe.hasClass(o,"p-disabled")&&(o.children[0].click(),this.transitionEndListener=this.focusNextList.bind(this,o),this.sublistViewChild.nativeElement.addEventListener("transitionend",this.transitionEndListener)),e.preventDefault()}}unbindTransitionEndListener(){this.transitionEndListener&&this.sublistViewChild&&(this.sublistViewChild.nativeElement.removeEventListener("transitionend",this.transitionEndListener),this.transitionEndListener=null)}ngOnDestroy(){this.activeItem=null,this.unbindTransitionEndListener()}get isActive(){return-this.slideMenu.left==this.index*this.menuWidth}}return t.\u0275fac=function(e){return new(e||t)(be(xi(()=>sM)))},t.\u0275cmp=on({type:t,selectors:[["p-slideMenuSub"]],viewQuery:function(e,o){if(1&e&&pi(aee,5),2&e){let r;mn(r=gn())&&(o.sublistViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{item:"item",root:"root",backLabel:"backLabel",menuWidth:"menuWidth",effectDuration:"effectDuration",easing:"easing",index:"index"},decls:3,vars:16,consts:[[3,"ngClass"],["sublist",""],["ngFor","",3,"ngForOf"],["class","p-menu-separator",3,"ngClass",4,"ngIf"],["pTooltip","",3,"ngClass","tooltipOptions","class","ngStyle",4,"ngIf"],[1,"p-menu-separator",3,"ngClass"],["pTooltip","",3,"ngClass","tooltipOptions","ngStyle"],["listitem",""],["class","p-menuitem-link",3,"target","ngClass","keydown","click",4,"ngIf"],["class","p-menuitem-link",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","href","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state","keydown","click",4,"ngIf"],["class","p-submenu",3,"item","index","menuWidth",4,"ngIf"],[1,"p-menuitem-link",3,"target","ngClass","keydown","click"],["class","p-menuitem-icon",3,"ngClass","ngStyle",4,"ngIf"],["class","p-menuitem-text",4,"ngIf","ngIfElse"],["htmlRouteLabel",""],["class","p-menuitem-badge",3,"ngClass",4,"ngIf"],["class","p-submenu-icon pi pi-fw pi-angle-right",4,"ngIf"],[1,"p-menuitem-icon",3,"ngClass","ngStyle"],[1,"p-menuitem-text"],[1,"p-menuitem-text",3,"innerHTML"],[1,"p-menuitem-badge",3,"ngClass"],[1,"p-submenu-icon","pi","pi-fw","pi-angle-right"],[1,"p-menuitem-link",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","href","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state","keydown","click"],["class","p-submenu-icon pi pi-fw pi-caret-right",4,"ngIf"],[1,"p-submenu-icon","pi","pi-fw","pi-caret-right"],[1,"p-submenu",3,"item","index","menuWidth"]],template:function(e,o){1&e&&(F(0,"ul",0,1),J(2,See,2,2,"ng-template",2),V()),2&e&&(aa("width",o.menuWidth,"px")("left",o.root?o.slideMenu.left:o.slideMenu.menuWidth,"px")("transition-property",o.root?"left":"none")("transition-duration",o.effectDuration+"ms")("transition-timing-function",o.easing),B("ngClass",$r(12,Dee,o.root,!o.root,o.isActive)),j(2),B("ngForOf",o.root?o.item:o.item.items))},dependencies:[Eo,Ms,mi,Oo,sg,xL,YL,t],encapsulation:2}),t})(),sM=(()=>{class t{constructor(e,o,r,s,l){this.el=e,this.renderer=o,this.cd=r,this.config=s,this.overlayService=l,this.menuWidth=190,this.viewportHeight=180,this.effectDuration=250,this.easing="ease-out",this.backLabel="Back",this.autoZIndex=!0,this.baseZIndex=0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.onShow=new Tt,this.onHide=new Tt,this.left=0,this.animating=!1}ngAfterViewChecked(){!this.viewportUpdated&&!this.popup&&this.containerViewChild&&(this.updateViewPort(),this.viewportUpdated=!0)}set container(e){this.containerViewChild=e}set backward(e){this.backwardViewChild=e}set slideMenuContent(e){this.slideMenuContentViewChild=e}updateViewPort(){this.slideMenuContentViewChild.nativeElement.style.height=this.viewportHeight-Fe.getHiddenElementOuterHeight(this.backwardViewChild.nativeElement)+"px"}toggle(e){this.visible?this.hide():this.show(e),this.preventDocumentDefault=!0}show(e){this.target=e.currentTarget,this.visible=!0,this.preventDocumentDefault=!0,this.cd.markForCheck()}onOverlayClick(e){this.popup&&this.overlayService.add({originalEvent:e,target:this.el.nativeElement}),this.preventDocumentDefault=!0}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.popup&&(this.updateViewPort(),this.moveOnTop(),this.onShow.emit({}),this.appendOverlay(),Fe.absolutePosition(this.containerViewChild.nativeElement,this.target),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener());break;case"void":this.onOverlayHide(),this.onHide.emit({})}}onOverlayAnimationEnd(e){"void"===e.toState&&ns.clear(e.element)}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.containerViewChild.nativeElement):Fe.appendChild(this.containerViewChild.nativeElement,this.appendTo))}restoreOverlayAppend(){this.container&&this.appendTo&&this.el.nativeElement.appendChild(this.containerViewChild.nativeElement)}moveOnTop(){this.autoZIndex&&ns.set("menu",this.containerViewChild.nativeElement,this.baseZIndex+this.config.zIndex.menu)}hide(){this.visible=!1,this.cd.markForCheck()}onWindowResize(){this.visible&&!Fe.isTouchDevice()&&this.hide()}goBack(){this.left+=this.menuWidth}onBackwardKeydown(e){this.goBack(),this.left||setTimeout(()=>{let o=Fe.getFocusableElements(this.el.nativeElement);o&&o.length>0&&o[0].focus()},1),e.preventDefault()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","click",()=>{this.preventDocumentDefault||(this.hide(),this.cd.detectChanges()),this.preventDocumentDefault=!1}))}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new qb(this.target,()=>{this.visible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}onOverlayHide(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.preventDocumentDefault=!1,this.left=0,this.cd.destroyed||(this.target=null)}ngOnDestroy(){this.popup&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.restoreOverlayAppend(),this.onOverlayHide())}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(jr),be(Po),be(Il),be(Wb))},t.\u0275cmp=on({type:t,selectors:[["p-slideMenu"]],viewQuery:function(e,o){if(1&e&&(pi(Mee,5),pi(Iee,5),pi(kee,5)),2&e){let r;mn(r=gn())&&(o.container=r.first),mn(r=gn())&&(o.backward=r.first),mn(r=gn())&&(o.slideMenuContent=r.first)}},hostAttrs:[1,"p-element"],inputs:{model:"model",popup:"popup",style:"style",styleClass:"styleClass",menuWidth:"menuWidth",viewportHeight:"viewportHeight",effectDuration:"effectDuration",easing:"easing",backLabel:"backLabel",appendTo:"appendTo",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onShow:"onShow",onHide:"onHide"},decls:1,vars:1,consts:[[3,"ngClass","class","ngStyle","click",4,"ngIf"],[3,"ngClass","ngStyle","click"],["container",""],[1,"p-slidemenu-wrapper"],[1,"p-slidemenu-content"],["slideMenuContent",""],["root","root",3,"item","index","menuWidth","effectDuration","easing"],["tabindex","0",1,"p-slidemenu-backward","p-menuitem-link",3,"keydown.enter","keydown.space","click"],["backward",""],[1,"p-slidemenu-backward-icon","pi","pi-fw","pi-caret-left"]],template:function(e,o){1&e&&J(0,Ree,11,25,"div",0),2&e&&B("ngIf",!o.popup||o.visible)},dependencies:[Eo,mi,Oo,Lee],styles:[".p-slidemenu{width:12.5rem}.p-slidemenu.p-slidemenu-overlay{position:absolute;top:0;left:0}.p-slidemenu ul{list-style:none;margin:0;padding:0}.p-slidemenu .p-slidemenu-rootlist{position:absolute;top:0}.p-slidemenu .p-submenu-list{display:none;position:absolute;top:0;width:12.5rem}.p-slidemenu .p-menuitem-link{cursor:pointer;display:flex;align-items:center;text-decoration:none;overflow:hidden}.p-slidemenu .p-menuitem-icon,.p-slidemenu .p-menuitem-text{vertical-align:middle}.p-slidemenu .p-menuitem{position:relative}.p-slidemenu .p-menuitem-link .p-submenu-icon{margin-left:auto}.p-slidemenu .p-slidemenu-wrapper{position:relative}.p-slidemenu .p-slidemenu-content{overflow-x:hidden;overflow-y:auto;position:relative}.p-slidemenu-backward{position:absolute;bottom:0;width:100%;cursor:pointer;display:none}.p-slidemenu-backward .p-slidemenu-backward-icon,.p-slidemenu-backward span{vertical-align:middle}.p-slidemenu .p-menuitem-active{position:static}.p-slidemenu .p-menuitem-active>.p-submenu>.p-submenu-list{display:block}.p-slidemenu ul:not(.p-active-submenu)>.p-menuitem:not(.p-menuitem-active),.p-slidemenu .p-active-submenu>.p-menuitem-active>.p-submenu>.p-submenu-list{display:none}.p-slidemenu .p-active-submenu>.p-menuitem-active~.p-menuitem{display:block}\n"],encapsulation:2,data:{animation:[cc("overlayAnimation",[rr(":enter",[go({opacity:0,transform:"scaleY(0.8)"}),Ho("{{showTransitionParams}}")]),rr(":leave",[Ho("{{hideTransitionParams}}",go({opacity:0}))])])]},changeDetection:0}),t})(),CF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,pc,fu,pc,fu]}),t})();const Fee=["toggleButton"],zee=["toggleButtonIcon"],Nee=["menuDiv"],Bee=function(){return{width:"200px",height:"200px"}};function Vee(t,n){1&t&&(F(0,"div")(1,"div",4)(2,"div",5)(3,"div",6),Ne(4,"p-progressSpinner",7),F(5,"p",8),ce(6,"Cargando"),V()()()()()),2&t&&(j(4),Ao(ai(2,Bee)))}function Uee(t,n){if(1&t){const e=xt();F(0,"div",27)(1,"input",28),Oe("ngModelChange",function(r){return Ie(e),Me(q(2).name=r)}),V(),F(2,"button",29),Oe("click",function(){Ie(e);const r=q(2);return Me(r.changeName(r.name))}),F(3,"mat-icon"),ce(4,"done"),V()()()}if(2&t){const e=q(2);j(1),B("ngModel",e.name)}}function jee(t,n){if(1&t&&(F(0,"h1",35),ce(1),V()),2&t){const e=q(3);j(1),Jt(e.name)}}function Hee(t,n){1&t&&(F(0,"mat-icon"),ce(1,"favorite_outline"),V())}function $ee(t,n){1&t&&(F(0,"mat-icon"),ce(1,"favorite"),V())}function Gee(t,n){if(1&t){const e=xt();F(0,"div",30),J(1,jee,2,1,"h1",31),F(2,"div",32)(3,"button",33),Oe("click",function(){return Ie(e),Me(q(2).showTextField())}),F(4,"mat-icon"),ce(5,"edit"),V()(),F(6,"button",33),Oe("click",function(){return Ie(e),Me(q(2).onFavorite())}),J(7,Hee,2,0,"mat-icon",1),J(8,$ee,2,0,"mat-icon",1),V(),F(9,"button",34),Oe("click",function(){return Ie(e),Me(q(2).deletePlaylist())}),F(10,"mat-icon"),ce(11,"delete"),V()()()()}if(2&t){const e=q(2);j(1),B("ngIf",!e.changingName),j(6),B("ngIf",!e.favorite),j(1),B("ngIf",e.favorite)}}function Wee(t,n){if(1&t){const e=xt();F(0,"div",27)(1,"textarea",36),Oe("ngModelChange",function(r){return Ie(e),Me(q(2).playlistDescription=r)}),V(),F(2,"button",37),Oe("click",function(){Ie(e);const r=q(2);return Me(r.changeDesc(r.playlistDescription))}),F(3,"mat-icon"),ce(4,"done"),V()()()}if(2&t){const e=q(2);j(1),B("ngModel",e.playlistDescription)}}function qee(t,n){if(1&t&&(F(0,"p",42),ce(1),V()),2&t){const e=q(3);j(1),ei(" ",e.playlistDescription," ")}}function Zee(t,n){if(1&t){const e=xt();F(0,"div",38)(1,"div",39),J(2,qee,2,1,"p",40),F(3,"div",41)(4,"button",33),Oe("click",function(){return Ie(e),Me(q(2).showTextArea())}),F(5,"mat-icon"),ce(6,"edit"),V()()()()()}if(2&t){const e=q(2);j(2),B("ngIf",!e.changingDesc)}}function Kee(t,n){if(1&t){const e=xt();F(0,"div")(1,"div",9)(2,"button",10),Oe("click",function(){return Ie(e),Me(q().goBack())}),F(3,"mat-icon"),ce(4,"arrow_back"),V()(),F(5,"span",11),ce(6," Volver "),V()(),F(7,"div",12)(8,"div",13),Ne(9,"img",14),V(),F(10,"div",15)(11,"div",16),J(12,Uee,5,1,"div",17),J(13,Gee,12,3,"div",18),V(),F(14,"div",19),J(15,Wee,5,1,"div",17),J(16,Zee,7,1,"div",20),V(),F(17,"div",21),Ne(18,"img",22),F(19,"p",23),ce(20,"Nacho Ortega \xb7 24 canciones \xb7 3 me gusta"),V()(),F(21,"button",24),Oe("click",function(){Ie(e);const r=q();return Me(r.redirectToSpotify(r.name))}),F(22,"div",25),Ne(23,"img",26),ce(24," Escuchar en Spotify "),V()()()()()}if(2&t){const e=q();j(9),To("src",e.imageUrl,Co),j(3),B("ngIf",e.changingName),j(1),B("ngIf",!e.changingName),j(2),B("ngIf",e.changingDesc),j(1),B("ngIf",!e.changingDesc)}}const Xee=function(){return{width:"290px"}};function Yee(t,n){if(1&t){const e=xt();F(0,"p-slideMenu",73),Oe("click",function(r){return Ie(e),Me(q(3).activeMenu(r))}),V()}if(2&t){const e=q(3);Ao(ai(5,Xee)),B("model",e.items)("menuWidth",280)("viewportHeight",e.menuHeight)}}function Qee(t,n){if(1&t){const e=xt();F(0,"div")(1,"div",62)(2,"div",63),Ne(3,"img",64),V(),F(4,"div",65)(5,"p",66)(6,"span",67),ce(7),V(),F(8,"span",68),ce(9),V()()(),F(10,"div",63)(11,"button",69,52),Oe("click",function(){const s=Ie(e).$implicit;return Me(q(2).toogleMenu(s.id))}),F(13,"mat-icon",null,53),ce(15,"more_horiz"),V()()(),F(16,"div",70,71),J(18,Yee,1,6,"p-slideMenu",72),V()()()}if(2&t){const e=n.$implicit,o=q(2);j(3),To("src",e.image,Co),To("alt",e.name),j(4),Jt(e.name),j(2),Jt(e.author),j(9),B("ngIf",o.toogled==e.id&&o.isMenuOpen)}}function Jee(t,n){1&t&&(F(0,"h4",74),ce(1," No hay ningun vibe en esta playlist "),V())}function ete(t,n){if(1&t){const e=xt();F(0,"div",43)(1,"div",44)(2,"div",45),Ne(3,"iframe",46),V(),F(4,"div",47)(5,"div",48)(6,"div",49)(7,"h3"),ce(8,"Vibes"),V(),F(9,"div",50)(10,"button",51,52),Oe("click",function(){return Ie(e),Me(q().displayAddToPLaylistDialog=!0)}),F(12,"mat-icon",null,53),ce(14,"add"),V()()()()(),F(15,"div",54),J(16,Qee,19,5,"div",55),J(17,Jee,2,0,"h4",56),V()()(),F(18,"div",57)(19,"h3",58),ce(20,"Comentarios"),V(),F(21,"div",59)(22,"h3",60),ce(23,"Comentarios"),V(),Ne(24,"app-comments",61),V()()()}if(2&t){const e=q();j(16),B("ngForOf",e.vibes),j(1),B("ngIf",0==(null==e.vibes?null:e.vibes.length)),j(7),B("messages",e.messages)}}let tte=(()=>{class t{constructor(e,o,r,s,l){this.route=e,this.router=o,this.location=r,this.confirmationService=s,this.renderer=l,this.loaded=!1,this.displayAddToPLaylistDialog=!1,this.isMenuOpen=!1,this.menuHeight=135,this.changingName=!1,this.changingDesc=!1,this.renderer.listen("window","click",h=>{"more-button border-none flex justify-content-center align-items-center"!=h.target.attributes.class.nodeValue&&"mat-icon notranslate material-icons mat-ligature-font mat-icon-no-color"!=h.target.attributes.class.nodeValue&&!h.target.attributes.class.nodeValue.includes("ng-tns-")&&!h.target.attributes.class.nodeValue.includes("p-menuitem")&&!h.target.attributes.class.nodeValue.includes("p-submenu")&&!h.target.attributes.class.nodeValue.includes("p-menuitem-text")&&"ng-tns-c146-3"!=h.target.attributes.class.nodeValue&&!h.target.attributes.class.nodeValue.includes("p-slidemenu-backward")&&(console.log(h.target.attributes.class.nodeValue),this.isMenuOpen=!1)})}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),this.name=this.route.snapshot.paramMap.get("name"),this.playlistDescription="Esta es una playlist que hice mientras recordaba el viaje que hice a Yokohama",this.favorite=!1,this.imageUrl=this.route.snapshot.paramMap.get("image"),this.changeBackground(),this.items=[{icon:"pi pi-fw pi-plus",label:"A\xf1adir a playlist",items:[{label:"Mis viajes al hospital"},{label:"Los 2000"},{label:"Nightcore"}]},{separator:!0},{icon:"pi pi-fw pi-times",label:"Borrar vibe"}],this.vibes=[{id:1,name:"Love crazy",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",author:"De Pilar Ester"},{id:2,name:"Dance like you want to win",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/6b3c60d3ae7e6d45d9759fb92f0d8a5f.jpg",author:"De Jaime Roncal"},{id:3,name:"Shall we dance?",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/29bf68f5ad9fdcb30a9ed741270a6f20.jpg",author:"De Pilar Ester"},{id:4,name:"Taiga yo tomo ni naite kure",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/0381435cc855b88bdbdeb6dfc00b3da9.jpg",author:"De Nacho Ortega"},{id:5,name:"De viaje",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/a1c8496c1179efa9da50b27a2fd4f2e3.jpg",author:"De Jaime Roncal"},{id:6,name:"De fiesta",image:"http://www.madonnalicious.com/images/extra/2009/celebration_album_cover.jpg",author:"De Pilar Ester"},{id:7,name:"De farra en farra",image:"https://i.pinimg.com/originals/8e/f4/19/8ef4198b9b313fccaa711b8cd58aeec0.jpg",author:"De Nacho Ortega"},{id:8,name:"De viaje",image:"https://i.pinimg.com/originals/d0/20/00/d02000f30b49b7009e8316ab970264f5.jpg",author:"De Jaime Roncal"},{id:9,name:"De fiesta",image:"https://i.pinimg.com/originals/48/24/93/48249335e8c3852d59a5a27e054bb8d2.jpg",author:"De Pilar Ester"},{id:10,name:"Peanut butter jelly time",image:"https://i.discogs.com/PPDTS4DJShGbD_tmjNWRo3dIHshLVnl7JohtM-Bf0lM/rs:fit/g:sm/q:90/h:601/w:600/czM6Ly9kaXNjb2dz/LWRhdGFiYXNlLWlt/YWdlcy9SLTk4NDE5/MjctMTQ4NzQzMTM1/Ny04MjU2LmpwZWc.jpeg",author:"De Nacho Ortega"}],this.messages=[{id:1,name:"Ichika Nakano",image:"https://media.tenor.com/qNaWdxRxMBYAAAAC/ichika-ichika-nakano.gif",time:"12:00",comment:"Hola caracola"},{id:2,name:"Nino Nakano",image:"https://media.tenor.com/Hci64uKJMaMAAAAd/nino-nakano.gif",time:"12:00",comment:"Hola caracola"},{id:3,name:"Miku Nakano",image:"https://media.tenor.com/oPYlDzjkgUoAAAAC/answer-me-the-quintessential-quintuplets.gif",time:"12:00",comment:"Hola caracola mensaje muy largo para ver como se comporta el chat"},{id:4,name:"Yotsuba Nakano",image:"https://media.tenor.com/yQ_zLRi6zUkAAAAd/yotsuba-nakano.gif",time:"12:00",comment:"Hola caracola"},{id:5,name:"Itsuki Nakano",image:"https://media.tenor.com/j0URHc6S_PYAAAAd/i-dont-like-him-the-quintessential-quintuplets.gif",time:"12:00",comment:"Hola caracola"}]}changeBackground(){const e=new dy,o=new Image;o.crossOrigin="Anonymous",o.src="https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&refresh=2592000&url="+encodeURIComponent(this.imageUrl),o.addEventListener("load",()=>{var s=e.getColor(o),l="linear-gradient(45deg, var(--background) 0%, rgba("+s[0]+","+s[1]+","+s[2]+",1) 100%)";document.getElementById("colored-background").style.background=l,this.loaded=!0})}toogleMenu(e){console.log("toogleMenu"),this.isMenuOpen=!this.isMenuOpen,this.toogled=e,console.log(this.isMenuOpen),console.log(this.toogled)}activeMenu(e){console.log("activeMenu"),this.whatchElements("A"===e.target.tagName?e.target.text:e.target.parentNode.text)}whatchElements(e){switch(e){case"A\xf1adir a playlist":console.log("A\xf1adir a playlist");break;case"Borrar vibe":console.log("Borrar vibe",this.toogled-1);for(let o=0;o<this.vibes.length;o++)if(this.vibes[o].id==this.toogled){this.vibes.splice(o,1);break}this.toogled=0,this.isMenuOpen=!1}}redirectToSpotify(e){alert("Redirigiendo a Spotify, playlist: "+e)}goBack(){this.location.back()}changeName(e){this.changingName=!this.changingName,console.log(e)}changeDesc(e){this.changingDesc=!this.changingDesc,console.log(e)}showTextField(){this.changingName=!this.changingName}showTextArea(){this.changingDesc=!this.changingDesc}deletePlaylist(){this.confirmationService.confirm({header:"Borrar playlist",message:"\xbfSeguro que deseas borrar esta playlist? Una vez borrada no se podr\xe1 recuperar",acceptLabel:"Borrar playlist",rejectLabel:"Cancelar",accept:()=>{this.router.navigate(["/playlists"])}})}onFavorite(){this.favorite=!this.favorite}hideDialog(e){this.displayAddToPLaylistDialog=e}}return t.\u0275fac=function(e){return new(e||t)(be(rg),be(sr),be(d1),be(Gb),be(jr))},t.\u0275cmp=on({type:t,selectors:[["app-playlist-detail"]],viewQuery:function(e,o){if(1&e&&(pi(Fee,5),pi(zee,5),pi(Nee,5)),2&e){let r;mn(r=gn())&&(o.toggleButton=r.first),mn(r=gn())&&(o.toggleButtonIcon=r.first),mn(r=gn())&&(o.menuDiv=r.first)}},decls:5,vars:5,consts:[["id","colored-background",1,"header-background","content",2,"margin","0"],[4,"ngIf"],["class","content",4,"ngIf"],["buttonTitle","A\xf1adir vibes",3,"newPLaylist","display","showDialog"],[2,"height","100vh","width","100%"],[1,"flex","align-items-center","align-content-center","justify-content-center","w-full","h-full"],[1,"frostedBackground","align-items-center","align-content-center","justify-content-center","border-round-xl","window-width",2,"display","grid","transition","var(--transition)"],["strokeWidth","3",1,"text-center"],[1,"mx-auto","text-center"],[1,"flex","align-items-center","mb-2"],["mat-icon-button","","type","button",1,"black-buttons","flex","align-items-center","justify-content-center",3,"click"],[1,"ml-1","text-xl",2,"color","var(--fontColor)"],[1,"playlist-header"],[1,"playlist-image-container","justify-content-center"],["alt","Playlist Image",1,"playlist-image",3,"src"],[1,"playlist-desc-continer"],[1,"flex","align-items-center","align-content-center","mb-2"],["class","flex align-items-center width-desc","style","margin-bottom: 7px",4,"ngIf"],["class","text-buttons",4,"ngIf"],[1,"flex","align-items-center","align-content-center","mb-2","w-full","margin-buttons","mt-0"],["class","flex align-items-center align-content-center text-buttons",4,"ngIf"],[1,"flex","align-items-center","mb-4"],["src","assets/images/nachu.jpeg","alt","logo",1,"profile-image","mr-2"],[1,"m-0","text-base"],["type","button",1,"spoty-btn","w-15rem",3,"click"],[1,"flex","align-items-center","justify-content-center","text-lg"],["src","assets/images/spotify-white.svg","width","20","height","20","alt","logo",1,"spoty-icon","mr-2"],[1,"flex","align-items-center","width-desc",2,"margin-bottom","7px"],["type","text","pInputText","",1,"text-6xl","width-desc-2",3,"ngModel","ngModelChange"],["type","button",1,"ml-2","black-buttons",3,"click"],[1,"text-buttons"],["id","playlistName","class","text-6xl text-elipsis","style","white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",4,"ngIf"],[1,"flex","justify-content-center","margin-buttons"],["type","button",1,"flex","justify-content-center","align-items-center","ml-2","black-buttons",3,"click"],["type","button",1,"flex","justify-content-center","align-items-center","ml-2","black-buttons","text-pink-500",3,"click"],["id","playlistName",1,"text-6xl","text-elipsis",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],["placeholder","A\xf1adir descripci\xf3n",1,"flex","align-items-center","align-content-center","width-desc-2","h-5rem","border-none","p-3",2,"resize","none","border-radius","10px","font-family","Lato","color","var(--fontColor)","background","var(--frostedBackground)","outline","0.15rem solid #93cbf9",3,"ngModel","ngModelChange"],["type","button",1,"flex","align-items-center","align-content-center","justify-content-center","ml-2","black-buttons",3,"click"],[1,"flex","align-items-center","align-content-center","text-buttons"],[1,"flex","align-content-center","align-items-center","justify-content-center","w-full"],["class","w-full text-base desc-with",4,"ngIf"],[1,"flex","justify-content-center"],[1,"w-full","text-base","desc-with"],[1,"content"],[1,"body-container"],[1,"body-map"],["src","https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d51834.444224020444!2d139.74264095820314!3d35.710161600000006!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188ed642bdabb7%3A0x7c29484dac68bc1d!2sPok%C3%A9mon%20Center%20Sky%20Tree%20Town!5e0!3m2!1ses!2ses!4v1679417141304!5m2!1ses!2ses","allowfullscreen","","loading","lazy","referrerpolicy","no-referrer-when-downgrade",1,"w-full","h-full",2,"border","0","border-radius","10px"],[1,"margin-sm"],[2,"border-top-left-radius","10px","border-top-right-radius","10px","background","var(--containerBackground)"],[1,"flex","justify-content-between","align-items-center","h-5rem","mx-3",2,"border-bottom","1px solid var(--separationLine)"],[1,"flex","align-content-center","align-items-end"],["mat-icon-button","","type","button",1,"black-buttons",2,"cursor","pointer","height","45px","width","45px","border-radius","100% !important",3,"click"],["toggleButton",""],["toggleButtonIcon",""],[1,"song-list","containers",2,"padding","0","border-top-left-radius","0","border-top-right-radius","0"],[4,"ngFor","ngForOf"],["class","p-3 flex align-items-center justify-content-center","style","height: calc(100% - 3rem);",4,"ngIf"],[1,"comments-margin"],[1,"font-bold","pb-4","hide-title-sm"],[1,"card","w-full","container-chat","text-base"],[1,"show-title-sm","pb-4",2,"border-bottom","1px solid var(--separationLine)"],[3,"messages"],[1,"grow","relative","flex","pl-3","pr-3","pt-3"],[1,"flex-initial","flex","align-items-center","justify-content-center"],[1,"song-list-img",2,"box-shadow","var(--shadows)",3,"src","alt"],[1,"flex-grow-1","flex","align-items-center"],[1,"ml-3","m-0","block","text-lg"],[1,"block","mb-1"],[1,"block","mt-1","text-sm",2,"font-weight","lighter !important"],["mat-icon-button","","type","button",1,"black-buttons","vibe-list-buttons",2,"cursor","pointer","height","45px","width","45px","border-radius","100% !important",3,"click"],[1,"z-1","m-0","absolute",2,"right","65px","top","30px"],["menuDiv",""],[3,"model","menuWidth","style","viewportHeight","click",4,"ngIf"],[3,"model","menuWidth","viewportHeight","click"],[1,"p-3","flex","align-items-center","justify-content-center",2,"height","calc(100% - 3rem)"]],template:function(e,o){1&e&&(F(0,"div",0),J(1,Vee,7,3,"div",1),J(2,Kee,25,5,"div",1),V(),J(3,ete,25,3,"div",2),F(4,"app-new-playlist-dialog",3),Oe("showDialog",function(s){return o.hideDialog(s)}),V()),2&e&&(j(1),B("ngIf",!o.loaded),j(1),B("ngIf",o.loaded),j(1),B("ngIf",o.loaded),j(1),B("newPLaylist",!1)("display",o.displayAddToPLaylistDialog))},dependencies:[Ms,mi,dd,Tl,fc,El,hd,sM,mf,yF,gF],styles:["[_nghost-%COMP%]{width:100%;height:100%}.playlist-header[_ngcontent-%COMP%]{transition:var(--transition);display:flex}.playlist-image-container[_ngcontent-%COMP%]{transition:var(--transition);display:flex;flex:0 1 auto;align-items:center;height:250px;width:250px}.playlist-image[_ngcontent-%COMP%]{height:250px;width:250px;object-fit:cover;border-radius:10px;box-shadow:0 1px 5px #00000075}.playlist-desc-continer[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;justify-content:flex-end;margin-left:2rem}.profile-image[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;object-fit:cover;box-shadow:0 1px 5px #00000075}.header-background[_ngcontent-%COMP%]{background:var(--containerBackground);box-shadow:var(--shadows)}.body-container[_ngcontent-%COMP%]{transition:var(--transition);display:flex;margin-top:1.5rem}.body-map[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;justify-content:flex-end;border-radius:10px;margin-right:2rem;height:800px;box-shadow:var(--shadows)!important}.song-list[_ngcontent-%COMP%]{width:400px;height:720px;overflow:scroll;margin:0!important}.song-list-img[_ngcontent-%COMP%]{height:75px;width:75px;object-fit:cover;border-radius:5px}.text-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:left}.vibe-list-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.text-elipsis[_ngcontent-%COMP%]{max-width:800px}.width-desc[_ngcontent-%COMP%]{transition:var(--transition);width:70%}.width-desc-2[_ngcontent-%COMP%]{transition:var(--transition);width:95%!important}.comments-margin[_ngcontent-%COMP%]{margin-top:1.5rem}.show-title-sm[_ngcontent-%COMP%]{display:none}.desc-with[_ngcontent-%COMP%]{max-width:750px}.black-buttons[_ngcontent-%COMP%]{background:var(--frostedButtons);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.spoty-btn[_ngcontent-%COMP%]{box-shadow:0 1px 5px #00000075}  .p-progress-spinner-circle{stroke:var(--fontColor)!important}@media (max-width: 1650px){.text-elipsis[_ngcontent-%COMP%]{max-width:700px}.song-list[_ngcontent-%COMP%]{height:520px}.body-map[_ngcontent-%COMP%]{height:600px}}@media (max-width: 1500px){.text-elipsis[_ngcontent-%COMP%]{max-width:600px}.width-desc[_ngcontent-%COMP%]{width:100%}}@media (max-width: 1400px){.body-container[_ngcontent-%COMP%]{margin-top:0}}@media (max-width: 1350px){.text-elipsis[_ngcontent-%COMP%]{max-width:500px}}@media (max-width: 1260px){.text-elipsis[_ngcontent-%COMP%]{max-width:450px}}@media (max-width: 1200px){.text-elipsis[_ngcontent-%COMP%]{overflow:visible!important;text-align:center!important;white-space:inherit!important}.playlist-header[_ngcontent-%COMP%]{flex-direction:column;width:100%}.playlist-image-container[_ngcontent-%COMP%]{width:100%}.playlist-desc-continer[_ngcontent-%COMP%]{width:100%;align-items:center;margin-top:1rem;margin-left:0}.body-container[_ngcontent-%COMP%]{flex-direction:column;width:100%;margin-top:.25rem}.body-map[_ngcontent-%COMP%]{width:100%;margin-right:0}.song-list[_ngcontent-%COMP%]{width:100%;margin-bottom:1.5rem!important}.text-buttons[_ngcontent-%COMP%]{width:100%;margin:auto;display:block;align-items:center;align-content:center;text-align:center}.margin-sm[_ngcontent-%COMP%]{margin-top:1.5rem}.margin-buttons[_ngcontent-%COMP%]{margin-top:1rem}.comments-margin[_ngcontent-%COMP%]{margin-top:0}.hide-title-sm[_ngcontent-%COMP%]{display:none}.show-title-sm[_ngcontent-%COMP%]{display:block}.desc-with[_ngcontent-%COMP%]{max-width:-moz-fit-content;max-width:fit-content}}@media (max-width: 900px){.margin-sm[_ngcontent-%COMP%]{margin-top:16px}.song-list[_ngcontent-%COMP%]{margin-bottom:16px!important}}"]}),t})();const nte=["playlistCard"];function ite(t,n){if(1&t&&(F(0,"h3",7),ce(1),V()),2&t){const e=q(2);j(1),Jt(e.carouselTitle)}}const TF=function(){return{background:"white !important"}};function ote(t,n){1&t&&(F(0,"mat-icon",23),ce(1,"favorite_outline"),V()),2&t&&B("ngStyle",ai(1,TF))}function rte(t,n){1&t&&(F(0,"mat-icon",23),ce(1,"favorite"),V()),2&t&&B("ngStyle",ai(1,TF))}function ste(t,n){if(1&t){const e=xt();F(0,"div",20)(1,"button",21),Oe("click",function(){Ie(e);const r=q().$implicit;return Me(q(2).favorite(r.id))}),J(2,ote,2,2,"mat-icon",22),J(3,rte,2,2,"mat-icon",22),V()()}if(2&t){const e=q().$implicit;j(2),B("ngIf",!e.favorite),j(1),B("ngIf",e.favorite)}}const ate=function(t){return{background:t}},EF=function(t,n,e){return["/playlists",t,n,e]},lte=function(t){return{display:t}};function cte(t,n){if(1&t){const e=xt();F(0,"div",8)(1,"div",9),Oe("mouseenter",function(){const s=Ie(e).$implicit;return Me(q(2).mouseEnter(s.id,"card"))})("mouseleave",function(){return Ie(e),Me(q(2).mouseLeave("card"))}),F(2,"div",10)(3,"div",11)(4,"div",12),Ne(5,"img",13),V(),F(6,"div",14)(7,"div")(8,"h5",15),ce(9),nc(10,"slice"),V(),F(11,"h5",16),ce(12),nc(13,"slice"),V()(),J(14,ste,4,2,"div",17),V()()()(),F(15,"button",18),Oe("mouseenter",function(){const s=Ie(e).$implicit;return Me(q(2).mouseEnter(s.id,"button"))})("mouseleave",function(){return Ie(e),Me(q(2).mouseLeave("button"))}),F(16,"div",19)(17,"mat-icon"),ce(18,"play_arrow"),V()()()()}if(2&t){const e=n.$implicit,o=q(2);j(1),B("ngStyle",An(17,ate,o.mouseInCard&&o.selected==e.id?"var(--selectedItem)":"transparent")),j(3),B("routerLink",$r(19,EF,e.id,e.name,e.image)),j(1),To("src",e.image,Co),B("alt",e.name),j(4),Jt(e.name.length>15?Gm(10,9,e.name,0,15)+"...":e.name),j(3),Jt(e.author.length>18?Gm(13,13,e.author,0,18)+"...":e.author),j(2),B("ngIf","Siguiendo"==o.carouselTitle),j(1),B("routerLink",$r(23,EF,e.id,e.name,e.image))("ngStyle",An(27,lte,o.mouseInCard&&o.selected==e.id?"flex":"none"))}}function ute(t,n){if(1&t&&(F(0,"p-carousel",4),J(1,ite,2,1,"ng-template",5),J(2,cte,19,29,"ng-template",6),V()),2&t){const e=q();B("value",e.playlists)("numVisible",7)("numScroll",7)("circular",!0)("responsiveOptions",e.responsiveOptions)("showIndicators",!1)}}function dte(t,n){if(1&t&&(F(0,"div")(1,"h3",24),ce(2),V(),F(3,"p",25),ce(4,"No hay playlists disponibles"),V()()),2&t){const e=q();j(2),Jt(e.carouselTitle)}}let hte=(()=>{class t{constructor(){this.mouseInCard=!1,this.selected=0,this.responsiveOptions=[{breakpoint:"2100px",numVisible:5,numScroll:5},{breakpoint:"1650px",numVisible:4,numScroll:4},{breakpoint:"1450px",numVisible:3,numScroll:3},{breakpoint:"1150px",numVisible:2,numScroll:2},{breakpoint:"900px",numVisible:1,numScroll:1},{breakpoint:"699px",numVisible:2,numScroll:2},{breakpoint:"600px",numVisible:1,numScroll:1}]}clickImage(){alert("CLICK")}mouseEnter(e,o){this.mouseInCard=!0,this.selected=e}mouseLeave(e){this.mouseInCard=!1,this.selected=0}favorite(e){console.log("FAVORITE");for(let o=0;o<this.playlists.length;o++)if(this.playlists[o].id==e){this.playlists[o].favorite=!this.playlists[o].favorite;break}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-carousel"]],viewQuery:function(e,o){if(1&e&&pi(nte,5),2&e){let r;mn(r=gn())&&(o.playlistCard=r.first)}},inputs:{carouselTitle:"carouselTitle",playlists:"playlists"},decls:5,vars:3,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers-carousel"],[3,"value","numVisible","numScroll","circular","responsiveOptions","showIndicators",4,"ngIf"],[4,"ngIf"],[3,"value","numVisible","numScroll","circular","responsiveOptions","showIndicators"],["pTemplate","header"],["pTemplate","item"],[1,"mb-4","ml-3","show-titles-sm"],[1,"flex","flex-wrap","justify-content-center"],[1,"z-0","flex","flex-column","h-16rem","relative",2,"border-radius","15px",3,"ngStyle","mouseenter","mouseleave"],[1,"h-full","w-13rem","carousel-line"],[1,"w-full","h-full","p-3"],[1,"w-full","overflow-hidden",2,"aspect-ratio","1/1","cursor","pointer","border-radius","10px !important",3,"routerLink"],[1,"h-full","w-auto",3,"src","alt"],[1,"flex","mt-2"],[1,"mb-1","text-left"],[1,"carousel-text","text-left"],["class","ml-auto flex",4,"ngIf"],["id","play-btn",1,"z-2","absolute","align-items-center","justify-content-center","border-circle","play-icon","border-none",2,"width","50px","height","50px","top","130px","margin-right","110px","padding-top","0.5rem","padding-bottom","0.5rem","cursor","pointer",3,"routerLink","ngStyle","mouseenter","mouseleave"],[1,"flex","align-items-center","justify-content-center","border-circle","bg-white",2,"height","28px !important","width","28px !important"],[1,"ml-auto","flex"],["type","button",1,"ml-2","black-buttons","flex","align-items-center","justify-content-center",3,"click"],["class","flex justify-content-center",3,"ngStyle",4,"ngIf"],[1,"flex","justify-content-center",3,"ngStyle"],[1,"mb-3","ml-3",2,"font-weight","bold"],[1,"ml-3",2,"font-size","medium","margin","0"]],template:function(e,o){1&e&&(F(0,"h3",0),ce(1),V(),F(2,"div",1),J(3,ute,3,6,"p-carousel",2),J(4,dte,5,1,"div",3),V()),2&e&&(j(1),Jt(o.carouselTitle),j(2),B("ngIf",0!=(null==o.playlists?null:o.playlists.length)),j(1),B("ngIf",0==(null==o.playlists?null:o.playlists.length)))},dependencies:[sg,mi,Oo,hF,_o,El,rb],styles:[".carousel-line[_ngcontent-%COMP%]{border:var(--carouselOutline);border-radius:.75rem}.carousel-text[_ngcontent-%COMP%]{color:var(--carouselText);font-size:small;font-weight:400}.play-icon[_ngcontent-%COMP%]{background:var(--gradient45);box-shadow:var(--shadows)}mat-icon[_ngcontent-%COMP%]{background:var(--gradient45);-webkit-background-clip:text;-moz-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}"]}),t})();function pte(t,n){1&t&&Ne(0,"span",11),2&t&&B("innerHTML",q(2).$implicit.summary,_h)}function fte(t,n){1&t&&Ne(0,"span",12),2&t&&B("innerHTML",q(2).$implicit.detail,_h)}function mte(t,n){if(1&t&&(xn(0),J(1,pte,1,1,"span",9),J(2,fte,1,1,"span",10),In()),2&t){const e=q().$implicit;j(1),B("ngIf",e.summary),j(1),B("ngIf",e.detail)}}function gte(t,n){if(1&t&&(F(0,"span",15),ce(1),V()),2&t){const e=q(2).$implicit;j(1),Jt(e.summary)}}function _te(t,n){if(1&t&&(F(0,"span",16),ce(1),V()),2&t){const e=q(2).$implicit;j(1),Jt(e.detail)}}function yte(t,n){if(1&t&&(J(0,gte,2,1,"span",13),J(1,_te,2,1,"span",14)),2&t){const e=q().$implicit;B("ngIf",e.summary),j(1),B("ngIf",e.detail)}}function vte(t,n){if(1&t){const e=xt();F(0,"button",17),Oe("click",function(){Ie(e);const r=q().index;return Me(q(2).removeMessage(r))}),Ne(1,"i",18),V()}}const bte=function(t,n){return{showTransitionParams:t,hideTransitionParams:n}},xte=function(t){return{value:"visible",params:t}},wte=function(t,n,e,o){return{"pi-info-circle":t,"pi-check":n,"pi-exclamation-triangle":e,"pi-times-circle":o}};function Cte(t,n){if(1&t&&(F(0,"div",4)(1,"div",5),Ne(2,"span",6),J(3,mte,3,2,"ng-container",1),J(4,yte,2,2,"ng-template",null,7,ka),J(6,vte,2,0,"button",8),V()()),2&t){const e=n.$implicit,o=jn(5),r=q(2);Xn("p-message p-message-"+e.severity),B("@messageAnimation",An(12,xte,no(9,bte,r.showTransitionOptions,r.hideTransitionOptions))),j(2),Xn("p-message-icon pi"+(e.icon?" "+e.icon:"")),B("ngClass",Th(14,wte,"info"===e.severity,"success"===e.severity,"warn"===e.severity,"error"===e.severity)),j(1),B("ngIf",!r.escape)("ngIfElse",o),j(3),B("ngIf",r.closable)}}function Tte(t,n){if(1&t&&(xn(0),J(1,Cte,7,19,"div",3),In()),2&t){const e=q();j(1),B("ngForOf",e.messages)}}function Ete(t,n){1&t&&Ht(0)}function Ste(t,n){if(1&t&&(F(0,"div",19)(1,"div",5),J(2,Ete,1,0,"ng-container",20),V()()),2&t){const e=q();B("ngClass","p-message p-message-"+e.severity),j(2),B("ngTemplateOutlet",e.contentTemplate)}}let Qb=(()=>{class t{constructor(e,o,r){this.messageService=e,this.el=o,this.cd=r,this.closable=!0,this.enableService=!0,this.escape=!0,this.showTransitionOptions="300ms ease-out",this.hideTransitionOptions="200ms cubic-bezier(0.86, 0, 0.07, 1)",this.valueChange=new Tt,this.timerSubscriptions=[]}set value(e){this.messages=e,this.startMessageLifes(this.messages)}ngAfterContentInit(){this.templates.forEach(e=>{e.getType(),this.contentTemplate=e.template}),this.messageService&&this.enableService&&!this.contentTemplate&&(this.messageSubscription=this.messageService.messageObserver.subscribe(e=>{if(e){Array.isArray(e)||(e=[e]);const o=e.filter(r=>this.key===r.key);this.messages=this.messages?[...this.messages,...o]:[...o],this.startMessageLifes(o),this.cd.markForCheck()}}),this.clearSubscription=this.messageService.clearObserver.subscribe(e=>{e?this.key===e&&(this.messages=null):this.messages=null,this.cd.markForCheck()}))}hasMessages(){let e=this.el.nativeElement.parentElement;return!(!e||!e.offsetParent)&&(null!=this.contentTemplate||this.messages&&this.messages.length>0)}clear(){this.messages=[],this.valueChange.emit(this.messages)}removeMessage(e){this.messages=this.messages.filter((o,r)=>r!==e),this.valueChange.emit(this.messages)}get icon(){const e=this.severity||(this.hasMessages()?this.messages[0].severity:null);if(this.hasMessages())switch(e){case"success":return"pi-check";case"info":default:return"pi-info-circle";case"error":return"pi-times";case"warn":return"pi-exclamation-triangle"}return null}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.timerSubscriptions?.forEach(e=>e.unsubscribe())}startMessageLifes(e){e?.forEach(o=>o.life&&this.startMessageLife(o))}startMessageLife(e){const o=PL(e.life).subscribe(()=>{this.messages=this.messages?.filter(r=>r!==e),this.timerSubscriptions=this.timerSubscriptions?.filter(r=>r!==o),this.valueChange.emit(this.messages),this.cd.markForCheck()});this.timerSubscriptions.push(o)}}return t.\u0275fac=function(e){return new(e||t)(be(Y9,8),be(si),be(Po))},t.\u0275cmp=on({type:t,selectors:[["p-messages"]],contentQueries:function(e,o,r){if(1&e&&No(r,_o,4),2&e){let s;mn(s=gn())&&(o.templates=s)}},hostAttrs:[1,"p-element"],inputs:{value:"value",closable:"closable",style:"style",styleClass:"styleClass",enableService:"enableService",key:"key",escape:"escape",severity:"severity",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{valueChange:"valueChange"},decls:4,vars:5,consts:[["role","alert",1,"p-messages","p-component",3,"ngStyle"],[4,"ngIf","ngIfElse"],["staticMessage",""],["role","alert",3,"class",4,"ngFor","ngForOf"],["role","alert"],[1,"p-message-wrapper"],[3,"ngClass"],["escapeOut",""],["class","p-message-close p-link","type","button","pRipple","",3,"click",4,"ngIf"],["class","p-message-summary",3,"innerHTML",4,"ngIf"],["class","p-message-detail",3,"innerHTML",4,"ngIf"],[1,"p-message-summary",3,"innerHTML"],[1,"p-message-detail",3,"innerHTML"],["class","p-message-summary",4,"ngIf"],["class","p-message-detail",4,"ngIf"],[1,"p-message-summary"],[1,"p-message-detail"],["type","button","pRipple","",1,"p-message-close","p-link",3,"click"],[1,"p-message-close-icon","pi","pi-times"],["role","alert",3,"ngClass"],[4,"ngTemplateOutlet"]],template:function(e,o){if(1&e&&(F(0,"div",0),J(1,Tte,2,1,"ng-container",1),J(2,Ste,3,2,"ng-template",null,2,ka),V()),2&e){const r=jn(3);Xn(o.styleClass),B("ngStyle",o.style),j(1),B("ngIf",!o.contentTemplate)("ngIfElse",r)}},dependencies:[Eo,Ms,mi,Is,Oo,vd],styles:[".p-message-wrapper{display:flex;align-items:center}.p-message-close{display:flex;align-items:center;justify-content:center}.p-message-close.p-link{margin-left:auto;overflow:hidden;position:relative}.p-messages .p-message.ng-animating{overflow:hidden}\n"],encapsulation:2,data:{animation:[cc("messageAnimation",[rr(":enter",[go({opacity:0,transform:"translateY(-25%)"}),Ho("{{showTransitionParams}}")]),rr(":leave",[Ho("{{hideTransitionParams}}",go({height:0,marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,opacity:0}))])])]},changeDetection:0}),t})(),aM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,il]}),t})();function Dte(t,n){1&t&&(F(0,"div",33)(1,"h2",34),ce(2,"Editar perfil"),V()())}function Mte(t,n){1&t&&(F(0,"div",35)(1,"span",36),ce(2,"El nombre no puede tener m\xe1s de 20 caracteres"),V()())}function Ite(t,n){1&t&&(F(0,"div",35)(1,"span",36),ce(2,"Introduzca un nombre"),V()())}function kte(t,n){1&t&&(F(0,"div",35)(1,"span",36),ce(2,"El nombre de usuario no puede tener m\xe1s de 10 caracteres"),V()())}function Ate(t,n){1&t&&(F(0,"div",35)(1,"span",36),ce(2,"Introduzca un nombre de usuario"),V()())}function Pte(t,n){1&t&&(F(0,"div")(1,"span",36),ce(2,"Introduzca un correo v\xe1lido"),V()())}function Ote(t,n){1&t&&(F(0,"div",35)(1,"span",36),ce(2,"Introduzca un correo"),V()())}function Rte(t,n){1&t&&(Ne(0,"i",37),F(1,"span",38),ce(2,"El email indicado ya est\xe1 en uso."),V())}function Lte(t,n){1&t&&Ne(0,"p-progressSpinner",39)}function Fte(t,n){1&t&&(F(0,"mat-icon",40),ce(1,"check"),V())}const zte=function(){return{width:"600px"}},Nte=function(){return{"650px":"95vw"}};let Bte=(()=>{class t{constructor(e){this.appLayout=e,this.showDialog=new Tt,this.acceptLabel="Aceptar",this.loading=!1,this.emailDisabled=!0,this.displaySuccess=!1}ngOnInit(){this.updateForm=new tl({email:new gs({value:this.email,disabled:!0},[ms.required,ms.email]),name:new gs({value:this.name,disabled:!0},[ms.required,ms.maxLength(20)]),nickname:new gs({value:this.nickname,disabled:!0},[ms.required,ms.maxLength(10)])}),this.updateFields(this.updateForm)}onSubmit(e){var o=this;return hu(function*(){o.loading=!0,o.acceptLabel="Actualizando...",yield new Promise(r=>setTimeout(r,5e3)),e.controls.email.touched&&(console.log("mail changed"),o.appLayout.user.email=e.value.email),e.controls.name.touched&&(console.log("name changed"),o.appLayout.user.name=e.value.name),e.controls.nickname.touched&&(console.log("nickname changed"),o.appLayout.user.nickname=e.value.nickname),o.displaySuccess=!0,o.cancel(e)})()}cancel(e){this.showDialog.emit(!1),this.updateForm.markAsPristine(),this.updateForm.markAsUntouched(),this.updateForm.get("email").disable(),this.updateForm.get("name").disable(),this.updateForm.get("nickname").disable(),this.updateFields(e),this.acceptLabel="Aceptar",this.loading=!1}updateFields(e){e.get("email")?.setValue(this.appLayout.user.email),e.get("name")?.setValue(this.appLayout.user.name),e.get("nickname")?.setValue(this.appLayout.user.nickname)}onHide(e){this.displaySuccess=e}}return t.\u0275fac=function(e){return new(e||t)(be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-edit-profile-dialog"]],inputs:{display:"display"},outputs:{showDialog:"showDialog"},decls:54,vars:26,consts:[[3,"closable","visible","modal","draggable","breakpoints","visibleChange"],["pTemplate","header","class","py-0"],[3,"formGroup","ngSubmit"],[2,"transition","var(--transition)"],[1,"form-label-container"],["for","name",1,"block","mb-2"],[1,"p-inputgroup"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-user"],["id","name","name","name","formControlName","name","placeholder","Nombre Apellido","type","text","pInputText","",1,"form-control","h-3rem"],["type","button","pButton","","pRipple","","icon","pi pi-pencil","styleClass","p-button-danger",1,"w-3rem",2,"border-top-left-radius","0 !important","border-bottom-left-radius","0 !important",3,"click"],["class","mb-2",4,"ngIf"],["for","nickname",1,"block","mb-2"],[1,"pi","pi-at"],["id","nickname","name","nickname","formControlName","nickname","placeholder","Nombre de usuario","type","text","pInputText","",1,"form-control","h-3rem"],[1,"pi","pi-envelope"],["id","email","name","email","formControlName","email","placeholder","correo@email.com","type","text","pInputText","",1,"form-control","h-3rem"],[4,"ngIf"],["severity","error"],["pTemplate",""],[1,"flex","mt-3"],[1,"flex","align-items-center","justify-content-center","w-6","mr-1"],["pButton","","pRipple","","type","button",1,"mt-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"text-pink-500","w-3rem"],[1,"text-pink-500","w-full"],[1,"flex","align-items-center","justify-content-center","w-6","ml-1"],["pButton","","pRipple","","type","submit",1,"mt-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled"],["strokeWidth","5","class","mr-3",4,"ngIf"],["class","text-green-500 w-3rem",4,"ngIf"],[1,"w-full"],["title","Perfil actualizado","message","Informaci\xf3n del perfil actualizada correctamente",3,"display","showDialog"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"],[1,"mb-2"],[1,"text-xs",2,"color","var(--validationErrors)"],[1,"pi","pi-exclamation-triangle","mr-2"],[1,"custom-message"],["strokeWidth","5",1,"mr-3"],[1,"text-green-500","w-3rem"]],template:function(e,o){if(1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.display=s}),J(1,Dte,3,0,"ng-template",1),F(2,"form",2),Oe("ngSubmit",function(){return o.onSubmit(o.updateForm)}),F(3,"div",3)(4,"div",4)(5,"label",5),ce(6,"Nombre"),V(),F(7,"div",6)(8,"span",7),Ne(9,"i",8),V(),Ne(10,"input",9),F(11,"button",10),Oe("click",function(){return o.updateForm.get("name").enable()}),V()(),J(12,Mte,3,0,"div",11),J(13,Ite,3,0,"div",11),V(),F(14,"div",4)(15,"label",12),ce(16,"Nombre de usuario"),V(),F(17,"div",6)(18,"span",7),Ne(19,"i",13),V(),Ne(20,"input",14),F(21,"button",10),Oe("click",function(){return o.updateForm.get("nickname").enable()}),V()(),J(22,kte,3,0,"div",11),J(23,Ate,3,0,"div",11),V(),F(24,"div",4)(25,"label",5),ce(26,"Email"),V(),F(27,"div",6)(28,"span",7),Ne(29,"i",15),V(),Ne(30,"input",16),F(31,"button",10),Oe("click",function(){return o.updateForm.get("email").enable()}),V()(),J(32,Pte,3,0,"div",17),J(33,Ote,3,0,"div",11),V(),F(34,"p-messages",18),J(35,Rte,3,0,"ng-template",19),V()(),F(36,"div",20)(37,"div",21)(38,"button",22),Oe("click",function(){return o.cancel(o.updateForm)}),F(39,"div",23)(40,"span",24)(41,"mat-icon",25),ce(42,"close"),V(),F(43,"p",26),ce(44," Cancelar "),V()()()()(),F(45,"div",27)(46,"button",28)(47,"div",23)(48,"span",24),J(49,Lte,1,0,"p-progressSpinner",29),J(50,Fte,2,0,"mat-icon",30),F(51,"p",31),ce(52),V()()()()()()()(),F(53,"app-success-dialog-edit",32),Oe("showDialog",function(s){return o.onHide(s)}),V()),2&e){let r,s,l,h,g,b;Ao(ai(24,zte)),B("closable",!1)("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",ai(25,Nte)),j(2),B("formGroup",o.updateForm),j(10),B("ngIf",(null==(r=o.updateForm.get("name"))?null:r.hasError("maxlength"))&&(o.updateForm.controls.name.dirty||o.updateForm.controls.name.touched)),j(1),B("ngIf",(null==(s=o.updateForm.get("name"))?null:s.hasError("required"))&&(o.updateForm.controls.name.dirty||o.updateForm.controls.name.touched)),j(9),B("ngIf",(null==(l=o.updateForm.get("nickname"))?null:l.hasError("maxlength"))&&(o.updateForm.controls.nickname.dirty||o.updateForm.controls.nickname.touched)),j(1),B("ngIf",(null==(h=o.updateForm.get("nickname"))?null:h.hasError("required"))&&(o.updateForm.controls.nickname.dirty||o.updateForm.controls.nickname.touched)),j(9),B("ngIf",o.updateForm.controls.email.invalid&&!(null!=(g=o.updateForm.get("email"))&&g.hasError("required"))&&(o.updateForm.controls.email.dirty||o.updateForm.controls.email.touched)),j(1),B("ngIf",(null==(b=o.updateForm.get("email"))?null:b.hasError("required"))&&(o.updateForm.controls.email.dirty||o.updateForm.controls.email.touched)),j(5),B("disabled",o.loading),j(8),B("disabled",!o.updateForm.valid||o.loading),j(3),B("ngIf",o.loading),j(1),B("ngIf",!o.loading),j(1),Mo("text-green-500",!o.loading)("text-blue-500",o.loading),j(1),ei(" ",o.acceptLabel," "),j(1),B("display",o.displaySuccess)}},dependencies:[mi,tf,dd,Tl,ef,pd,nf,os,_o,fc,mu,El,Qb,mf,qw],styles:["[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:var(--primary-color)!important}[_nghost-%COMP%]     .p-progress-spinner{height:30px;width:30px}"]}),t})();const Vte=["input"];function Ute(t,n){if(1&t){const e=xt();F(0,"i",5),Oe("click",function(){return Ie(e),Me(q().clear())}),V()}}function jte(t,n){if(1&t){const e=xt();F(0,"i",6),Oe("click",function(){return Ie(e),Me(q().onMaskToggle())}),nc(1,"mapper"),V()}if(2&t){const e=q();B("ngClass",N_(1,1,e.unmasked,e.toggleIconClass))}}function Hte(t,n){1&t&&Ht(0)}function $te(t,n){1&t&&Ht(0)}function Gte(t,n){if(1&t&&(xn(0),J(1,$te,1,0,"ng-container",8),In()),2&t){const e=q(2);j(1),B("ngTemplateOutlet",e.contentTemplate)}}const Wte=function(t){return{width:t}};function qte(t,n){if(1&t&&(F(0,"div",11),Ne(1,"div",0),nc(2,"mapper"),V(),F(3,"div",12),ce(4),V()),2&t){const e=q(2);j(1),B("ngClass",N_(2,3,e.meter,e.strengthClass))("ngStyle",An(6,Wte,e.meter?e.meter.width:"")),j(3),Jt(e.infoText)}}function Zte(t,n){1&t&&Ht(0)}const Kte=function(t,n){return{showTransitionParams:t,hideTransitionParams:n}},Xte=function(t){return{value:"visible",params:t}};function Yte(t,n){if(1&t){const e=xt();F(0,"div",6,7),Oe("click",function(r){return Ie(e),Me(q().onOverlayClick(r))})("@overlayAnimation.start",function(r){return Ie(e),Me(q().onAnimationStart(r))})("@overlayAnimation.done",function(r){return Ie(e),Me(q().onAnimationEnd(r))}),J(2,Hte,1,0,"ng-container",8),J(3,Gte,2,1,"ng-container",9),J(4,qte,5,8,"ng-template",null,10,ka),J(6,Zte,1,0,"ng-container",8),V()}if(2&t){const e=jn(5),o=q();B("ngClass","p-password-panel p-component")("@overlayAnimation",An(9,Xte,no(6,Kte,o.showTransitionOptions,o.hideTransitionOptions))),j(2),B("ngTemplateOutlet",o.headerTemplate),j(1),B("ngIf",o.contentTemplate)("ngIfElse",e),j(3),B("ngTemplateOutlet",o.footerTemplate)}}let Qte=(()=>{class t{transform(e,o,...r){return o(e,...r)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=Pr({name:"mapper",type:t,pure:!0}),t})();const Jte={provide:ks,useExisting:xi(()=>SF),multi:!0};let SF=(()=>{class t{constructor(e,o,r,s){this.cd=e,this.config=o,this.el=r,this.overlayService=s,this.mediumRegex="^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})",this.strongRegex="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})",this.feedback=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.showClear=!1,this.onFocus=new Tt,this.onBlur=new Tt,this.onClear=new Tt,this.overlayVisible=!1,this.focused=!1,this.unmasked=!1,this.value=null,this.onModelChange=()=>{},this.onModelTouched=()=>{}}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"content":default:this.contentTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngOnInit(){this.infoText=this.promptText(),this.mediumCheckRegExp=new RegExp(this.mediumRegex),this.strongCheckRegExp=new RegExp(this.strongRegex),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.updateUI(this.value||"")})}onAnimationStart(e){switch(e.toState){case"visible":this.overlay=e.element,ns.set("overlay",this.overlay,this.config.zIndex.overlay),this.appendContainer(),this.alignOverlay(),this.bindScrollListener(),this.bindResizeListener();break;case"void":this.unbindScrollListener(),this.unbindResizeListener(),this.overlay=null}}onAnimationEnd(e){"void"===e.toState&&ns.clear(e.element)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):document.getElementById(this.appendTo).appendChild(this.overlay))}alignOverlay(){this.appendTo?(this.overlay.style.minWidth=Fe.getOuterWidth(this.input.nativeElement)+"px",Fe.absolutePosition(this.overlay,this.input.nativeElement)):Fe.relativePosition(this.overlay,this.input.nativeElement)}onInput(e){this.value=e.target.value,this.onModelChange(this.value)}onInputFocus(e){this.focused=!0,this.feedback&&(this.overlayVisible=!0),this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.feedback&&(this.overlayVisible=!1),this.onModelTouched(),this.onBlur.emit(e)}onKeyDown(e){"Escape"===e.key&&(this.overlayVisible=!1)}onKeyUp(e){this.feedback&&(this.updateUI(e.target.value),this.overlayVisible||(this.overlayVisible=!0))}updateUI(e){let o=null,r=null;switch(this.testStrength(e)){case 1:o=this.weakText(),r={strength:"weak",width:"33.33%"};break;case 2:o=this.mediumText(),r={strength:"medium",width:"66.66%"};break;case 3:o=this.strongText(),r={strength:"strong",width:"100%"};break;default:o=this.promptText(),r=null}this.meter=r,this.infoText=o}onMaskToggle(){this.unmasked=!this.unmasked}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}testStrength(e){let o=0;return this.strongCheckRegExp.test(e)?o=3:this.mediumCheckRegExp.test(e)?o=2:e.length&&(o=1),o}writeValue(e){this.value=void 0===e?null:e,this.feedback&&this.updateUI(this.value||""),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new qb(this.input.nativeElement,()=>{this.overlayVisible&&(this.overlayVisible=!1)})),this.scrollHandler.bindScrollListener()}bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&!Fe.isTouchDevice()&&(this.overlayVisible=!1)},window.addEventListener("resize",this.resizeListener))}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)}containerClass(e){return{"p-password p-component p-inputwrapper":!0,"p-input-icon-right":e}}inputFieldClass(e){return{"p-password-input":!0,"p-disabled":e}}toggleIconClass(e){return e?"pi pi-eye-slash":"pi pi-eye"}strengthClass(e){return`p-password-strength ${e?e.strength:""}`}filled(){return null!=this.value&&this.value.toString().length>0}promptText(){return this.promptLabel||this.getTranslation(Dr.PASSWORD_PROMPT)}weakText(){return this.weakLabel||this.getTranslation(Dr.WEAK)}mediumText(){return this.mediumLabel||this.getTranslation(Dr.MEDIUM)}strongText(){return this.strongLabel||this.getTranslation(Dr.STRONG)}restoreAppend(){this.overlay&&this.appendTo&&("body"===this.appendTo?document.body.removeChild(this.overlay):document.getElementById(this.appendTo).removeChild(this.overlay))}inputType(e){return e?"text":"password"}getTranslation(e){return this.config.getTranslation(e)}clear(){this.value=null,this.onModelChange(this.value),this.writeValue(this.value),this.onClear.emit()}ngOnDestroy(){this.overlay&&(ns.clear(this.overlay),this.overlay=null),this.restoreAppend(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.translationSubscription&&this.translationSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(be(Po),be(Il),be(si),be(Wb))},t.\u0275cmp=on({type:t,selectors:[["p-password"]],contentQueries:function(e,o,r){if(1&e&&No(r,_o,4),2&e){let s;mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&pi(Vte,5),2&e){let r;mn(r=gn())&&(o.input=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:8,hostBindings:function(e,o){2&e&&Mo("p-inputwrapper-filled",o.filled())("p-inputwrapper-focus",o.focused)("p-password-clearable",o.showClear)("p-password-mask",o.toggleMask)},inputs:{ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",label:"label",disabled:"disabled",promptLabel:"promptLabel",mediumRegex:"mediumRegex",strongRegex:"strongRegex",weakLabel:"weakLabel",mediumLabel:"mediumLabel",maxLength:"maxLength",strongLabel:"strongLabel",inputId:"inputId",feedback:"feedback",appendTo:"appendTo",toggleMask:"toggleMask",inputStyleClass:"inputStyleClass",panelStyle:"panelStyle",panelStyleClass:"panelStyleClass",styleClass:"styleClass",style:"style",inputStyle:"inputStyle",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",placeholder:"placeholder",showClear:"showClear"},outputs:{onFocus:"onFocus",onBlur:"onBlur",onClear:"onClear"},features:[Wi([Jte])],decls:9,vars:28,consts:[[3,"ngClass","ngStyle"],["pInputText","",3,"ngClass","ngStyle","value","input","focus","blur","keyup","keydown"],["input",""],["class","p-password-clear-icon pi pi-times",3,"click",4,"ngIf"],[3,"ngClass","click",4,"ngIf"],[1,"p-password-clear-icon","pi","pi-times",3,"click"],[3,"ngClass","click"],["overlay",""],[4,"ngTemplateOutlet"],[4,"ngIf","ngIfElse"],["content",""],[1,"p-password-meter"],["className","p-password-info"]],template:function(e,o){1&e&&(F(0,"div",0),nc(1,"mapper"),F(2,"input",1,2),Oe("input",function(s){return o.onInput(s)})("focus",function(s){return o.onInputFocus(s)})("blur",function(s){return o.onInputBlur(s)})("keyup",function(s){return o.onKeyUp(s)})("keydown",function(s){return o.onKeyDown(s)}),nc(4,"mapper"),nc(5,"mapper"),V(),J(6,Ute,1,0,"i",3),J(7,jte,2,4,"i",4),J(8,Yte,7,11,"div",4),V()),2&e&&(Xn(o.styleClass),B("ngClass",N_(1,19,o.toggleMask,o.containerClass))("ngStyle",o.style),j(2),Xn(o.inputStyleClass),B("ngClass",N_(4,22,o.disabled,o.inputFieldClass))("ngStyle",o.inputStyle)("value",o.value),st("label",o.label)("aria-label",o.ariaLabel)("aria-labelledBy",o.ariaLabelledBy)("id",o.inputId)("type",N_(5,25,o.unmasked,o.inputType))("placeholder",o.placeholder)("maxlength",o.maxLength),j(4),B("ngIf",o.showClear&&null!=o.value),j(1),B("ngIf",o.toggleMask),j(1),B("ngIf",o.overlayVisible))},dependencies:[Eo,mi,Is,Oo,fc,Qte],styles:[".p-password{position:relative;display:inline-flex}.p-password-panel{position:absolute;top:0;left:0}.p-password .p-password-panel{min-width:100%}.p-password-meter{height:10px}.p-password-strength{height:100%;width:0%;transition:width 1s ease-in-out}.p-fluid .p-password{display:flex}.p-password-input::-ms-reveal,.p-password-input::-ms-clear{display:none}.p-password-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-password-clearable{position:relative}\n"],encapsulation:2,data:{animation:[cc("overlayAnimation",[rr(":enter",[go({opacity:0,transform:"scaleY(0.8)"}),Ho("{{showTransitionParams}}")]),rr(":leave",[Ho("{{hideTransitionParams}}",go({opacity:0}))])])]},changeDetection:0}),t})(),DF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,Zb,is]}),t})();function ene(t,n){1&t&&(F(0,"div",27)(1,"span",28),ce(2,"Introduzca una contrase\xf1a"),V()())}function tne(t,n){1&t&&(F(0,"div",27)(1,"span",28),ce(2,"La contrase\xf1a debe tener 8 caracteres como m\xednimo"),V()())}function nne(t,n){1&t&&(F(0,"div",27)(1,"span",28),ce(2,"Introduzca una contrase\xf1a"),V()())}function ine(t,n){1&t&&(F(0,"div",27)(1,"span",28),ce(2,"Introduzca una contrase\xf1a"),V()())}function one(t,n){1&t&&(F(0,"div",27)(1,"span",28),ce(2,"Las contrase\xf1as no coinciden"),V()())}function rne(t,n){1&t&&(Ne(0,"i",29),F(1,"span",30),ce(2,"La contrase\xf1a actual es incorrecta."),V())}function sne(t,n){1&t&&Ne(0,"p-progressSpinner",31)}function ane(t,n){1&t&&(F(0,"mat-icon",32),ce(1,"check"),V())}const lne=function(){return{width:"600px"}},cne=function(){return{"650px":"95vw"}};let une=(()=>{class t{constructor(){this.showDialog=new Tt,this.loading=!1,this.acceptLabel="Aceptar",this.displaySuccess=!1}ngOnInit(){this.updatePwd=new tl({oldPassword:new gs(this.oldPassword,[ms.required]),newPassword:new gs(this.newPassword,[ms.required,ms.minLength(8)]),newPasswordConfirm:new gs(this.newPasswordConfirm,[ms.required])})}onSubmit(e){var o=this;return hu(function*(){o.loading=!0,o.acceptLabel="Actualizando...",yield new Promise(r=>setTimeout(r,5e3)),o.cancel(),o.displaySuccess=!0})()}cancel(){this.showDialog.emit(!1),this.updatePwd.reset(),this.loading=!1,this.acceptLabel="Aceptar"}onHide(e){this.displaySuccess=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-edit-password-dialog"]],inputs:{display:"display"},outputs:{showDialog:"showDialog"},decls:49,vars:33,consts:[["header","Editar contrase\xf1a",3,"closable","visible","modal","draggable","breakpoints","visibleChange"],[3,"formGroup","ngSubmit"],[1,"md:px-3","pt-3",2,"transition","var(--transition)"],[1,"form-label-container"],["for","name",1,"block","mb-2"],[1,"flex"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-key"],["id","oldPassword","name","oldPassword","formControlName","oldPassword","placeholder","Contrase\xf1a actual","type","text",1,"form-control","w-full","h-3rem",3,"feedback","toggleMask"],["class","mb-2",4,"ngIf"],["id","newPassword","name","newPassword","formControlName","newPassword","placeholder","Contrase\xf1a","type","text",1,"form-control","w-full","h-3rem",3,"feedback","toggleMask"],["for","newPasswordConfirm",1,"block","mb-2"],["id","newPasswordConfirm","name","newPasswordConfirm","formControlName","newPasswordConfirm","placeholder","Confirmar contrase\xf1a","type","text",1,"ng-dirty","form-control","w-full","h-3rem",3,"feedback","toggleMask"],["severity","error"],["pTemplate",""],[1,"flex","card-container","blue-container","overflow-hidden","md:px-3","md:pb-3","pt-1",2,"transition","var(--transition)"],[1,"flex","align-items-center","justify-content-center","w-6"],["pButton","","pRipple","","type","button",1,"mt-2","mb-2","mr-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"text-pink-500","w-3rem"],[1,"text-pink-500","w-full"],["pButton","","pRipple","","type","submit",1,"mt-2","mb-2","ml-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled"],["strokeWidth","5","class","mr-3",4,"ngIf"],["class","text-green-500 w-3rem",4,"ngIf"],[1,"w-full"],["title","Contrase\xf1a actualizada","message","La contrase\xf1a se ha actualizado correctamente",3,"display","showDialog"],[1,"mb-2"],[1,"text-xs",2,"color","var(--validationErrors)"],[1,"pi","pi-exclamation-triangle","mr-2"],[1,"custom-message"],["strokeWidth","5",1,"mr-3"],[1,"text-green-500","w-3rem"]],template:function(e,o){if(1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.display=s}),F(1,"form",1),Oe("ngSubmit",function(){return o.onSubmit(o.updatePwd)}),F(2,"div",2)(3,"div",3)(4,"label",4),ce(5,"Contase\xf1a actual"),V(),F(6,"div",5)(7,"span",6),Ne(8,"i",7),V(),Ne(9,"p-password",8),V(),J(10,ene,3,0,"div",9),V(),F(11,"div",3)(12,"label",4),ce(13,"Nueva contrase\xf1a"),V(),F(14,"div",5)(15,"span",6),Ne(16,"i",7),V(),Ne(17,"p-password",10),V(),J(18,tne,3,0,"div",9),J(19,nne,3,0,"div",9),V(),F(20,"div",3)(21,"label",11),ce(22,"Confirmar contrase\xf1a"),V(),F(23,"div",5)(24,"span",6),Ne(25,"i",7),V(),Ne(26,"p-password",12),V(),J(27,ine,3,0,"div",9),J(28,one,3,0,"div",9),V(),F(29,"p-messages",13),J(30,rne,3,0,"ng-template",14),V()(),F(31,"div",15)(32,"div",16)(33,"button",17),Oe("click",function(){return o.cancel()}),F(34,"div",18)(35,"span",19)(36,"mat-icon",20),ce(37,"close"),V(),F(38,"p",21),ce(39," Cancelar "),V()()()()(),F(40,"div",16)(41,"button",22)(42,"div",18)(43,"span",19),J(44,sne,1,0,"p-progressSpinner",23),J(45,ane,2,0,"mat-icon",24),F(46,"p",25),ce(47),V()()()()()()()(),F(48,"app-success-dialog-edit",26),Oe("showDialog",function(s){return o.onHide(s)}),V()),2&e){let r,s,l,h,g,b,T;Ao(ai(31,lne)),B("closable",!1)("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",ai(32,cne)),j(1),B("formGroup",o.updatePwd),j(8),B("feedback",!1)("toggleMask",!0),j(1),B("ngIf",(null==(r=o.updatePwd.get("oldPassword"))?null:r.hasError("required"))&&(o.updatePwd.controls.oldPassword.dirty||o.updatePwd.controls.oldPassword.touched)),j(7),B("feedback",!1)("toggleMask",!0),j(1),B("ngIf",(null==(s=o.updatePwd.get("newPassword"))?null:s.hasError("minlength"))&&(o.updatePwd.controls.newPassword.dirty||o.updatePwd.controls.newPassword.touched)),j(1),B("ngIf",(null==(l=o.updatePwd.get("newPassword"))?null:l.hasError("required"))&&(o.updatePwd.controls.newPassword.dirty||o.updatePwd.controls.newPassword.touched)),j(7),Mo("ng-invalid",(null==(h=o.updatePwd.get("newPassword"))?null:h.value)!=(null==(h=o.updatePwd.get("newPasswordConfirm"))?null:h.value)&&(o.updatePwd.controls.newPasswordConfirm.dirty||o.updatePwd.controls.newPasswordConfirm.touched)),B("feedback",!1)("toggleMask",!0),j(1),B("ngIf",(null==(g=o.updatePwd.get("newPasswordConfirm"))?null:g.hasError("required"))&&(o.updatePwd.controls.newPasswordConfirm.dirty||o.updatePwd.controls.newPasswordConfirm.touched)),j(1),B("ngIf",(null==(b=o.updatePwd.get("newPassword"))?null:b.value)!=(null==(b=o.updatePwd.get("newPasswordConfirm"))?null:b.value)&&!(null!=(b=o.updatePwd.get("newPasswordConfirm"))&&b.hasError("required"))&&(o.updatePwd.controls.newPasswordConfirm.dirty||o.updatePwd.controls.newPasswordConfirm.touched)),j(5),B("disabled",o.loading),j(8),B("disabled",!o.updatePwd.valid||o.loading||(null==(T=o.updatePwd.get("newPassword"))?null:T.value)!=(null==(T=o.updatePwd.get("newPasswordConfirm"))?null:T.value)),j(3),B("ngIf",o.loading),j(1),B("ngIf",!o.loading),j(1),Mo("text-green-500",!o.loading)("text-blue-500",o.loading),j(1),ei(" ",o.acceptLabel," "),j(1),B("display",o.displaySuccess)}},dependencies:[mi,tf,Tl,ef,pd,nf,os,_o,mu,El,Qb,SF,mf,qw],styles:["[_nghost-%COMP%]     .p-password{width:100%;margin-bottom:1rem}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:var(--primary-color)!important}[_nghost-%COMP%]     .p-progress-spinner{height:30px;width:30px}[_nghost-%COMP%]     .p-inputtext{width:100%;height:3rem;border-top-left-radius:0;border-bottom-left-radius:0}"]}),t})();function dne(t,n){if(1&t&&(F(0,"div",5),ce(1),V()),2&t){const e=q(2);aa("display",null!=e.value&&0!==e.value?"flex":"none"),j(1),O_("",e.value,"",e.unit,"")}}function hne(t,n){if(1&t&&(F(0,"div",3),J(1,dne,2,4,"div",4),V()),2&t){const e=q();aa("width",e.value+"%")("background",e.color),j(1),B("ngIf",e.showValue)}}function pne(t,n){if(1&t&&(F(0,"div",6),Ne(1,"div",7),V()),2&t){const e=q();j(1),aa("background",e.color)}}const fne=function(t,n){return{"p-progressbar p-component":!0,"p-progressbar-determinate":t,"p-progressbar-indeterminate":n}};let mne=(()=>{class t{constructor(){this.showValue=!0,this.unit="%",this.mode="determinate"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["p-progressBar"]],hostAttrs:[1,"p-element"],inputs:{value:"value",showValue:"showValue",style:"style",styleClass:"styleClass",unit:"unit",mode:"mode",color:"color"},decls:3,vars:10,consts:[["role","progressbar","aria-valuemin","0","aria-valuemax","100",3,"ngStyle","ngClass"],["class","p-progressbar-value p-progressbar-value-animate","style","display:flex",3,"width","background",4,"ngIf"],["class","p-progressbar-indeterminate-container",4,"ngIf"],[1,"p-progressbar-value","p-progressbar-value-animate",2,"display","flex"],["class","p-progressbar-label",3,"display",4,"ngIf"],[1,"p-progressbar-label"],[1,"p-progressbar-indeterminate-container"],[1,"p-progressbar-value","p-progressbar-value-animate"]],template:function(e,o){1&e&&(F(0,"div",0),J(1,hne,2,5,"div",1),J(2,pne,2,2,"div",2),V()),2&e&&(Xn(o.styleClass),B("ngStyle",o.style)("ngClass",no(7,fne,"determinate"===o.mode,"indeterminate"===o.mode)),st("aria-valuenow",o.value),j(1),B("ngIf","determinate"===o.mode),j(1),B("ngIf","indeterminate"===o.mode))},dependencies:[Eo,mi,Oo],styles:['.p-progressbar{position:relative;overflow:hidden}.p-progressbar-determinate .p-progressbar-value{height:100%;width:0%;position:absolute;display:none;border:0 none;display:flex;align-items:center;justify-content:center;overflow:hidden}.p-progressbar-determinate .p-progressbar-label{display:inline-flex}.p-progressbar-determinate .p-progressbar-value-animate{transition:width 1s ease-in-out}.p-progressbar-indeterminate .p-progressbar-value:before{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite}.p-progressbar-indeterminate .p-progressbar-value:after{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;animation-delay:1.15s}@keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}\n'],encapsulation:2,changeDetection:0}),t})(),MF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();const gne=["advancedfileinput"],_ne=["basicfileinput"],yne=["content"];function vne(t,n){if(1&t){const e=xt();F(0,"p-button",17),Oe("onClick",function(){return Ie(e),Me(q(2).upload())}),V()}if(2&t){const e=q(2);B("label",e.uploadButtonLabel)("icon",e.uploadIcon)("disabled",!e.hasFiles()||e.isFileLimitExceeded())("styleClass",e.uploadStyleClass)}}function bne(t,n){if(1&t){const e=xt();F(0,"p-button",17),Oe("onClick",function(){return Ie(e),Me(q(2).clear())}),V()}if(2&t){const e=q(2);B("label",e.cancelButtonLabel)("icon",e.cancelIcon)("disabled",!e.hasFiles()||e.uploading)("styleClass",e.cancelStyleClass)}}function xne(t,n){1&t&&Ht(0)}function wne(t,n){1&t&&Ne(0,"p-progressBar",18),2&t&&B("value",q(2).progress)("showValue",!1)}function Cne(t,n){if(1&t){const e=xt();F(0,"img",26),Oe("error",function(r){return Ie(e),Me(q(5).imageError(r))}),V()}if(2&t){const e=q().$implicit,o=q(4);B("src",e.objectURL,Co)("width",o.previewWidth)}}function Tne(t,n){if(1&t){const e=xt();F(0,"div",22)(1,"div"),J(2,Cne,1,2,"img",23),V(),F(3,"div",24),ce(4),V(),F(5,"div"),ce(6),V(),F(7,"div")(8,"button",25),Oe("click",function(r){const l=Ie(e).index;return Me(q(4).remove(r,l))}),V()()()}if(2&t){const e=n.$implicit,o=q(4);j(2),B("ngIf",o.isImage(e)),j(2),Jt(e.name),j(2),Jt(o.formatSize(e.size)),j(2),Xn(o.removeStyleClass),B("disabled",o.uploading)}}function Ene(t,n){if(1&t&&(F(0,"div"),J(1,Tne,9,6,"div",21),V()),2&t){const e=q(3);j(1),B("ngForOf",e.files)}}function Sne(t,n){}function Dne(t,n){if(1&t&&(F(0,"div"),J(1,Sne,0,0,"ng-template",27),V()),2&t){const e=q(3);j(1),B("ngForOf",e.files)("ngForTemplate",e.fileTemplate)}}function Mne(t,n){if(1&t&&(F(0,"div",19),J(1,Ene,2,1,"div",20),J(2,Dne,2,2,"div",20),V()),2&t){const e=q(2);j(1),B("ngIf",!e.fileTemplate),j(1),B("ngIf",e.fileTemplate)}}function Ine(t,n){1&t&&Ht(0)}const kne=function(t,n){return{"p-focus":t,"p-disabled":n}},Ane=function(t){return{$implicit:t}};function Pne(t,n){if(1&t){const e=xt();F(0,"div",2)(1,"div",3)(2,"span",4),Oe("focus",function(){return Ie(e),Me(q().onFocus())})("blur",function(){return Ie(e),Me(q().onBlur())})("click",function(){return Ie(e),Me(q().choose())})("keydown.enter",function(){return Ie(e),Me(q().choose())}),F(3,"input",5,6),Oe("change",function(r){return Ie(e),Me(q().onFileSelect(r))}),V(),Ne(5,"span",7),F(6,"span",8),ce(7),V()(),J(8,vne,1,4,"p-button",9),J(9,bne,1,4,"p-button",9),J(10,xne,1,0,"ng-container",10),V(),F(11,"div",11,12),Oe("dragenter",function(r){return Ie(e),Me(q().onDragEnter(r))})("dragleave",function(r){return Ie(e),Me(q().onDragLeave(r))})("drop",function(r){return Ie(e),Me(q().onDrop(r))}),J(13,wne,1,2,"p-progressBar",13),Ne(14,"p-messages",14),J(15,Mne,3,2,"div",15),J(16,Ine,1,0,"ng-container",16),V()()}if(2&t){const e=q();Xn(e.styleClass),B("ngClass","p-fileupload p-fileupload-advanced p-component")("ngStyle",e.style),j(2),Xn(e.chooseStyleClass),B("ngClass",no(24,kne,e.focus,e.disabled||e.isChooseDisabled())),j(1),B("multiple",e.multiple)("accept",e.accept)("disabled",e.disabled||e.isChooseDisabled()),st("title",""),j(2),Xn(e.chooseIcon),B("ngClass","p-button-icon p-button-icon-left"),j(2),Jt(e.chooseButtonLabel),j(1),B("ngIf",!e.auto&&e.showUploadButton),j(1),B("ngIf",!e.auto&&e.showCancelButton),j(1),B("ngTemplateOutlet",e.toolbarTemplate),j(3),B("ngIf",e.hasFiles()),j(1),B("value",e.msgs)("enableService",!1),j(1),B("ngIf",e.hasFiles()),j(1),B("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",An(27,Ane,e.files))}}function One(t,n){if(1&t&&(F(0,"span",8),ce(1),V()),2&t){const e=q(2);j(1),Jt(e.basicButtonLabel)}}function Rne(t,n){if(1&t){const e=xt();F(0,"input",33,34),Oe("change",function(r){return Ie(e),Me(q(2).onFileSelect(r))})("focus",function(){return Ie(e),Me(q(2).onFocus())})("blur",function(){return Ie(e),Me(q(2).onBlur())}),V()}if(2&t){const e=q(2);B("accept",e.accept)("multiple",e.multiple)("disabled",e.disabled)}}const Lne=function(t,n,e,o){return{"p-button p-component p-fileupload-choose":!0,"p-button-icon-only":t,"p-fileupload-choose-selected":n,"p-focus":e,"p-disabled":o}};function Fne(t,n){if(1&t){const e=xt();F(0,"div",28),Ne(1,"p-messages",14),F(2,"span",29),Oe("mouseup",function(){return Ie(e),Me(q().onBasicUploaderClick())})("keydown",function(r){return Ie(e),Me(q().onBasicKeydown(r))}),Ne(3,"span",30),J(4,One,2,1,"span",31),J(5,Rne,2,3,"input",32),V()()}if(2&t){const e=q();j(1),B("value",e.msgs)("enableService",!1),j(1),Xn(e.styleClass),B("ngClass",Th(9,Lne,!e.basicButtonLabel,e.hasFiles(),e.focus,e.disabled))("ngStyle",e.style),j(1),B("ngClass",e.hasFiles()&&!e.auto?e.uploadIcon:e.chooseIcon),j(1),B("ngIf",e.basicButtonLabel),j(1),B("ngIf",!e.hasFiles())}}let zne=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.sanitizer=o,this.zone=r,this.http=s,this.cd=l,this.config=h,this.method="post",this.invalidFileSizeMessageSummary="{0}: Invalid file size, ",this.invalidFileSizeMessageDetail="maximum upload size is {0}.",this.invalidFileTypeMessageSummary="{0}: Invalid file type, ",this.invalidFileTypeMessageDetail="allowed file types: {0}.",this.invalidFileLimitMessageDetail="limit is {0} at most.",this.invalidFileLimitMessageSummary="Maximum number of files exceeded, ",this.previewWidth=50,this.chooseIcon="pi pi-plus",this.uploadIcon="pi pi-upload",this.cancelIcon="pi pi-times",this.showUploadButton=!0,this.showCancelButton=!0,this.mode="advanced",this.onBeforeUpload=new Tt,this.onSend=new Tt,this.onUpload=new Tt,this.onError=new Tt,this.onClear=new Tt,this.onRemove=new Tt,this.onSelect=new Tt,this.onProgress=new Tt,this.uploadHandler=new Tt,this.onImageError=new Tt,this._files=[],this.progress=0,this.uploadedFileCount=0}set files(e){this._files=[];for(let o=0;o<e.length;o++){let r=e[o];this.validate(r)&&(this.isImage(r)&&(r.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(e[o]))),this._files.push(e[o]))}}get files(){return this._files}get basicButtonLabel(){return this.auto||!this.hasFiles()?this.chooseLabel:this.uploadLabel??this.files[0].name}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"file":default:this.fileTemplate=e.template;break;case"content":this.contentTemplate=e.template;break;case"toolbar":this.toolbarTemplate=e.template}})}ngOnInit(){this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()})}ngAfterViewInit(){"advanced"===this.mode&&this.zone.runOutsideAngular(()=>{this.content&&this.content.nativeElement.addEventListener("dragover",this.onDragOver.bind(this))})}choose(){this.advancedFileInput.nativeElement.click()}onFileSelect(e){if("drop"!==e.type&&this.isIE11()&&this.duplicateIEEvent)return void(this.duplicateIEEvent=!1);this.msgs=[],this.multiple||(this.files=[]);let o=e.dataTransfer?e.dataTransfer.files:e.target.files;for(let r=0;r<o.length;r++){let s=o[r];this.isFileSelected(s)||this.validate(s)&&(this.isImage(s)&&(s.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(o[r]))),this.files.push(o[r]))}this.onSelect.emit({originalEvent:e,files:o,currentFiles:this.files}),this.fileLimit&&"advanced"==this.mode&&this.checkFileLimit(),this.hasFiles()&&this.auto&&("advanced"!==this.mode||!this.isFileLimitExceeded())&&this.upload(),"drop"!==e.type&&this.isIE11()?this.clearIEInput():this.clearInputElement()}isFileSelected(e){for(let o of this.files)if(o.name+o.type+o.size===e.name+e.type+e.size)return!0;return!1}isIE11(){return!!window.MSInputMethodContext&&!!document.documentMode}validate(e){return this.msgs=[],this.accept&&!this.isFileTypeValid(e)?(this.msgs.push({severity:"error",summary:this.invalidFileTypeMessageSummary.replace("{0}",e.name),detail:this.invalidFileTypeMessageDetail.replace("{0}",this.accept)}),!1):!(this.maxFileSize&&e.size>this.maxFileSize&&(this.msgs.push({severity:"error",summary:this.invalidFileSizeMessageSummary.replace("{0}",e.name),detail:this.invalidFileSizeMessageDetail.replace("{0}",this.formatSize(this.maxFileSize))}),1))}isFileTypeValid(e){let o=this.accept.split(",").map(r=>r.trim());for(let r of o)if(this.isWildcard(r)?this.getTypeClass(e.type)===this.getTypeClass(r):e.type==r||this.getFileExtension(e).toLowerCase()===r.toLowerCase())return!0;return!1}getTypeClass(e){return e.substring(0,e.indexOf("/"))}isWildcard(e){return-1!==e.indexOf("*")}getFileExtension(e){return"."+e.name.split(".").pop()}isImage(e){return/^image\//.test(e.type)}onImageLoad(e){window.URL.revokeObjectURL(e.src)}upload(){if(this.customUpload)this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.uploadHandler.emit({files:this.files}),this.cd.markForCheck();else{this.uploading=!0,this.msgs=[];let e=new FormData;this.onBeforeUpload.emit({formData:e});for(let o=0;o<this.files.length;o++)e.append(this.name,this.files[o],this.files[o].name);this.http[this.method](this.url,e,{headers:this.headers,reportProgress:!0,observe:"events",withCredentials:this.withCredentials}).subscribe(o=>{switch(o.type){case yr.Sent:this.onSend.emit({originalEvent:o,formData:e});break;case yr.Response:this.uploading=!1,this.progress=0,o.status>=200&&o.status<300?(this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.onUpload.emit({originalEvent:o,files:this.files})):this.onError.emit({files:this.files}),this.clear();break;case yr.UploadProgress:o.loaded&&(this.progress=Math.round(100*o.loaded/o.total)),this.onProgress.emit({originalEvent:o,progress:this.progress})}this.cd.markForCheck()},o=>{this.uploading=!1,this.onError.emit({files:this.files,error:o})})}}clear(){this.files=[],this.onClear.emit(),this.clearInputElement(),this.cd.markForCheck()}remove(e,o){this.clearInputElement(),this.onRemove.emit({originalEvent:e,file:this.files[o]}),this.files.splice(o,1),this.checkFileLimit()}isFileLimitExceeded(){return this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount&&this.focus&&(this.focus=!1),this.fileLimit&&this.fileLimit<this.files.length+this.uploadedFileCount}isChooseDisabled(){return this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount}checkFileLimit(){this.msgs=[],this.isFileLimitExceeded()?this.msgs.push({severity:"error",summary:this.invalidFileLimitMessageSummary.replace("{0}",this.fileLimit.toString()),detail:this.invalidFileLimitMessageDetail.replace("{0}",this.fileLimit.toString())}):this.msgs=[]}clearInputElement(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.advancedFileInput.nativeElement.value=""),this.basicFileInput&&this.basicFileInput.nativeElement&&(this.basicFileInput.nativeElement.value="")}clearIEInput(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.duplicateIEEvent=!0,this.advancedFileInput.nativeElement.value="")}hasFiles(){return this.files&&this.files.length>0}onDragEnter(e){this.disabled||(e.stopPropagation(),e.preventDefault())}onDragOver(e){this.disabled||(Fe.addClass(this.content.nativeElement,"p-fileupload-highlight"),this.dragHighlight=!0,e.stopPropagation(),e.preventDefault())}onDragLeave(e){this.disabled||Fe.removeClass(this.content.nativeElement,"p-fileupload-highlight")}onDrop(e){if(!this.disabled){Fe.removeClass(this.content.nativeElement,"p-fileupload-highlight"),e.stopPropagation(),e.preventDefault();let o=e.dataTransfer?e.dataTransfer.files:e.target.files;(this.multiple||o&&1===o.length)&&this.onFileSelect(e)}}onFocus(){this.focus=!0}onBlur(){this.focus=!1}formatSize(e){if(0==e)return"0 B";let l=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,l)).toFixed(3))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][l]}onBasicUploaderClick(){this.hasFiles()?this.upload():this.basicFileInput.nativeElement.click()}onBasicKeydown(e){switch(e.code){case"Space":case"Enter":this.onBasicUploaderClick(),e.preventDefault()}}imageError(e){this.onImageError.emit(e)}getBlockableElement(){return this.el.nativeElement.children[0]}get chooseButtonLabel(){return this.chooseLabel||this.config.getTranslation(Dr.CHOOSE)}get uploadButtonLabel(){return this.uploadLabel||this.config.getTranslation(Dr.UPLOAD)}get cancelButtonLabel(){return this.cancelLabel||this.config.getTranslation(Dr.CANCEL)}ngOnDestroy(){this.content&&this.content.nativeElement&&this.content.nativeElement.removeEventListener("dragover",this.onDragOver),this.translationSubscription&&this.translationSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(D1),be(fi),be(Z1),be(Po),be(Il))},t.\u0275cmp=on({type:t,selectors:[["p-fileUpload"]],contentQueries:function(e,o,r){if(1&e&&No(r,_o,4),2&e){let s;mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(gne,5),pi(_ne,5),pi(yne,5)),2&e){let r;mn(r=gn())&&(o.advancedFileInput=r.first),mn(r=gn())&&(o.basicFileInput=r.first),mn(r=gn())&&(o.content=r.first)}},hostAttrs:[1,"p-element"],inputs:{name:"name",url:"url",method:"method",multiple:"multiple",accept:"accept",disabled:"disabled",auto:"auto",withCredentials:"withCredentials",maxFileSize:"maxFileSize",invalidFileSizeMessageSummary:"invalidFileSizeMessageSummary",invalidFileSizeMessageDetail:"invalidFileSizeMessageDetail",invalidFileTypeMessageSummary:"invalidFileTypeMessageSummary",invalidFileTypeMessageDetail:"invalidFileTypeMessageDetail",invalidFileLimitMessageDetail:"invalidFileLimitMessageDetail",invalidFileLimitMessageSummary:"invalidFileLimitMessageSummary",style:"style",styleClass:"styleClass",previewWidth:"previewWidth",chooseLabel:"chooseLabel",uploadLabel:"uploadLabel",cancelLabel:"cancelLabel",chooseIcon:"chooseIcon",uploadIcon:"uploadIcon",cancelIcon:"cancelIcon",showUploadButton:"showUploadButton",showCancelButton:"showCancelButton",mode:"mode",headers:"headers",customUpload:"customUpload",fileLimit:"fileLimit",uploadStyleClass:"uploadStyleClass",cancelStyleClass:"cancelStyleClass",removeStyleClass:"removeStyleClass",chooseStyleClass:"chooseStyleClass",files:"files"},outputs:{onBeforeUpload:"onBeforeUpload",onSend:"onSend",onUpload:"onUpload",onError:"onError",onClear:"onClear",onRemove:"onRemove",onSelect:"onSelect",onProgress:"onProgress",uploadHandler:"uploadHandler",onImageError:"onImageError"},decls:2,vars:2,consts:[[3,"ngClass","ngStyle","class",4,"ngIf"],["class","p-fileupload p-fileupload-basic p-component",4,"ngIf"],[3,"ngClass","ngStyle"],[1,"p-fileupload-buttonbar"],["pRipple","","tabindex","0",1,"p-button","p-component","p-fileupload-choose",3,"ngClass","focus","blur","click","keydown.enter"],["type","file",3,"multiple","accept","disabled","change"],["advancedfileinput",""],[3,"ngClass"],[1,"p-button-label"],["type","button",3,"label","icon","disabled","styleClass","onClick",4,"ngIf"],[4,"ngTemplateOutlet"],[1,"p-fileupload-content",3,"dragenter","dragleave","drop"],["content",""],[3,"value","showValue",4,"ngIf"],[3,"value","enableService"],["class","p-fileupload-files",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button",3,"label","icon","disabled","styleClass","onClick"],[3,"value","showValue"],[1,"p-fileupload-files"],[4,"ngIf"],["class","p-fileupload-row",4,"ngFor","ngForOf"],[1,"p-fileupload-row"],[3,"src","width","error",4,"ngIf"],[1,"p-fileupload-filename"],["type","button","icon","pi pi-times","pButton","",3,"disabled","click"],[3,"src","width","error"],["ngFor","",3,"ngForOf","ngForTemplate"],[1,"p-fileupload","p-fileupload-basic","p-component"],["tabindex","0","pRipple","",3,"ngClass","ngStyle","mouseup","keydown"],[1,"p-button-icon","p-button-icon-left","pi",3,"ngClass"],["class","p-button-label",4,"ngIf"],["type","file",3,"accept","multiple","disabled","change","focus","blur",4,"ngIf"],["type","file",3,"accept","multiple","disabled","change","focus","blur"],["basicfileinput",""]],template:function(e,o){1&e&&(J(0,Pne,17,29,"div",0),J(1,Fne,6,14,"div",1)),2&e&&(B("ngIf","advanced"===o.mode),j(1),B("ngIf","basic"===o.mode))},dependencies:[Eo,Ms,mi,Is,Oo,os,hW,mne,Qb,vd],styles:[".p-fileupload-content{position:relative}.p-fileupload-row{display:flex;align-items:center}.p-fileupload-row>div{flex:1 1 auto;width:25%}.p-fileupload-row>div:last-child{text-align:right}.p-fileupload-content .p-progressbar{width:100%;position:absolute;top:0;left:0}.p-button.p-fileupload-choose{position:relative;overflow:hidden}.p-button.p-fileupload-choose input[type=file],.p-fileupload-choose.p-fileupload-choose-selected input[type=file]{display:none}.p-fluid .p-fileupload .p-button{width:auto}.p-fileupload-filename{word-break:break-all}\n"],encapsulation:2,changeDetection:0}),t})(),IF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,is,pu,MF,aM,il,is,pu,MF,aM]}),t})();const Nne=["fileUpload"];function Bne(t,n){1&t&&(F(0,"div",19)(1,"h2",20),ce(2,"Editar foto de perfil"),V()())}function Vne(t,n){1&t&&(Ne(0,"i",23),F(1,"span",24),ce(2,"Por favor especifique una imagen."),V())}function Une(t,n){1&t&&(F(0,"p-messages",21),J(1,Vne,3,0,"ng-template",22),V())}function jne(t,n){1&t&&Ne(0,"p-progressSpinner",25)}function Hne(t,n){1&t&&(F(0,"mat-icon",26),ce(1,"check"),V())}const $ne=function(){return{width:"600px"}},Gne=function(){return{"650px":"95vw"}};let Wne=(()=>{class t{constructor(e,o){this.fb=e,this.appLayout=o,this.showDialog=new Tt,this.imageUploaded=!1,this.loading=!1,this.error=!1,this.acceptLabel="Aceptar",this.displaySuccess=!1}ngOnInit(){this.form=this.fb.group({myFile:new gs})}uploadFile(e){console.log("uploadFile");for(let o of e.files)this.form.patchValue({myFile:o}),this.form.get("myFile").updateValueAndValidity()}save(){var e=this;return hu(function*(){e.loading=!0,e.acceptLabel="Actualizando...",e.fileUpload.upload(),null!=e.form.value.myFile?(e.error=!1,yield new Promise(o=>setTimeout(o,5e3)),e.loading=!1,e.acceptLabel="Aceptar",e.showDialog.emit(!1),e.cancel(),e.displaySuccess=!0):(e.imageUploaded=!1,e.error=!0,console.log("No file selected"))})()}cancel(){this.imageUploaded=!1,this.error=!1,this.form.value.myFile=null,this.fileUpload.clear(),this.showDialog.emit(!1)}onHide(e){this.displaySuccess=e}}return t.\u0275fac=function(e){return new(e||t)(be(a6),be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-image-upload-dialog"]],viewQuery:function(e,o){if(1&e&&pi(Nne,5),2&e){let r;mn(r=gn())&&(o.fileUpload=r.first)}},inputs:{display:"display"},outputs:{showDialog:"showDialog"},decls:25,vars:22,consts:[[3,"closable","visible","modal","draggable","breakpoints","visibleChange"],["pTemplate","header","class","py-0"],[3,"formGroup"],[2,"transition","var(--transition)"],["mode","basic","chooseLabel","Subir foto",3,"customUpload","click","uploadHandler"],["fileUpload",""],["severity","error",4,"ngIf"],[1,"flex","mt-3"],[1,"flex-grow-1","flex","align-items-center","justify-content-center","w-6","mr-1"],["pButton","","pRipple","",1,"mt-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"text-pink-500","w-3rem"],[1,"text-pink-500","w-full"],[1,"flex-grow-1","flex","align-items-center","justify-content-center","w-6","ml-1"],["strokeWidth","5","class","mr-3",4,"ngIf"],["class","text-green-500 w-3rem",4,"ngIf"],[1,"w-full"],["title","Imagen actualizada","message","La foto de perfil se ha actualizado correctamente",3,"display","showDialog"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"],["severity","error"],["pTemplate",""],[1,"pi","pi-exclamation-triangle","mr-2"],[1,"custom-message"],["strokeWidth","5",1,"mr-3"],[1,"text-green-500","w-3rem"]],template:function(e,o){1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.display=s}),J(1,Bne,3,0,"ng-template",1),F(2,"form",2)(3,"div",3)(4,"p-fileUpload",4,5),Oe("click",function(){return o.imageUploaded=!0})("uploadHandler",function(s){return o.uploadFile(s)}),V(),J(6,Une,2,0,"p-messages",6),V()(),F(7,"div",7)(8,"div",8)(9,"button",9),Oe("click",function(){return o.cancel()}),F(10,"div",10)(11,"span",11)(12,"mat-icon",12),ce(13,"close"),V(),F(14,"p",13),ce(15," Cancelar "),V()()()()(),F(16,"div",14)(17,"button",9),Oe("click",function(){return o.save()}),F(18,"div",10)(19,"span",11),J(20,jne,1,0,"p-progressSpinner",15),J(21,Hne,2,0,"mat-icon",16),F(22,"p",17),ce(23),V()()()()()()(),F(24,"app-success-dialog-edit",18),Oe("showDialog",function(s){return o.onHide(s)}),V()),2&e&&(Ao(ai(20,$ne)),B("closable",!1)("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",ai(21,Gne)),j(2),B("formGroup",o.form),j(2),B("customUpload",!0),j(2),B("ngIf",o.error),j(3),B("disabled",o.loading),j(8),B("disabled",!o.imageUploaded),j(3),B("ngIf",o.loading),j(1),B("ngIf",!o.loading),j(1),Mo("text-green-500",!o.loading)("text-blue-500",o.loading),j(1),ei(" ",o.acceptLabel," "),j(1),B("display",o.displaySuccess))},dependencies:[mi,tf,ef,pd,os,_o,mu,El,zne,Qb,mf,qw],styles:["[_nghost-%COMP%]     .p-message{margin-bottom:0!important}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:var(--primary-color)!important}[_nghost-%COMP%]     .p-progress-spinner{height:30px;width:30px}[_nghost-%COMP%]     .p-dialog .p-dialog-content{padding-top:0}"]}),t})();function qne(t,n){if(1&t&&(F(0,"div",24)(1,"h1",25),ce(2),V()()),2&t){const e=q();j(2),O_(" ",e.appLayout.currentRoute," de ",e.appLayout.user.name," ")}}let Zne=(()=>{class t{constructor(e,o,r){this.router=e,this.appLayout=o,this.confirmationService=r,this.yourplaylists=[],this.following=[],this.misAmigos=[],this.displayEditProfileDialog=!1,this.displayEditPwdDialog=!1,this.displayEditImageDialog=!1}ngOnInit(){this.appLayout.currentRoute=" Perfil",this.appLayout.currentRouteId=6,this.profileStatics={numPlaylists:5,numFriends:3,numVibes:2},this.yourplaylists=[{id:1,name:"Lo mejor de lana del rey",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/6b3c60d3ae7e6d45d9759fb92f0d8a5f.jpg",author:"De Pilar Ester"},{id:2,name:"Los 2000",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/0381435cc855b88bdbdeb6dfc00b3da9.jpg",author:"De Jaime Roncal"},{id:3,name:"Zaragoza",image:"http://www.madonnalicious.com/images/extra/2009/celebration_album_cover.jpg",author:"De Pilar Ester"},{id:4,name:"De farra en farra",image:"https://i.pinimg.com/originals/8e/f4/19/8ef4198b9b313fccaa711b8cd58aeec0.jpg",author:"De Nacho Ortega"},{id:5,name:"De viaje",image:"https://i.pinimg.com/originals/48/24/93/48249335e8c3852d59a5a27e054bb8d2.jpg",author:"De Jaime Roncal"},{id:6,name:"De fiesta",image:"https://www.designandpaper.com/wp-content/uploads/2022/05/8722dac88fa7541418f66d732838115f.jpg",author:"De Pilar Ester"},{id:7,name:"Viaje a Disney",image:"https://i.pinimg.com/originals/d0/20/00/d02000f30b49b7009e8316ab970264f5.jpg",author:"De Pilar Ester"}],this.following=[{id:1,name:"Mis viajes al hospital",image:"https://1.bp.blogspot.com/-8vqVKpVMHis/WdRYMBXMU6I/AAAAAAAAAek/BO5QjRw13B0zX3d0aG4zTUroqK2IPyPDQCLcBGAs/s1600/cover.jpg",author:"De Pilar Ester",favorite:!0},{id:2,name:"Green day",image:"https://1.bp.blogspot.com/-qPxSouBlGl8/WagHNY9pTHI/AAAAAAAAAdk/6TccPwoe0cMlQq5QWZ2WSgFteSx2Q9DuQCLcBGAs/s1600/COVER.jpg",author:"De Jaime Roncal",favorite:!0},{id:3,name:"Magical mirai",image:"https://4.bp.blogspot.com/-SSDZn988cZQ/U-MqsVwXpbI/AAAAAAAADqk/YEnQqHOqlDg/s1600/cover.jpg",author:"De Nacho Ortega",favorite:!0},{id:4,name:"yesssssss",image:"https://images-na.ssl-images-amazon.com/images/I/71BJ5flBQ1L._SL1024_.jpg",author:"De Loreto Matinero",favorite:!0},{id:5,name:"Anime",image:"https://vgmdownloads.com/soundtracks/hatsune-miku-project-diva-f-2nd-complete-collection/cover.png",author:"De Nacho Ortega",favorite:!0},{id:6,name:"Canis de los 2000",image:"https://s.pacn.ws/1500/v8/hatsune-miku-magical-mirai-2018-official-album-cd-dvd-limited-e-562439.1.jpg?p8p6b3",author:"De Nacho Ortega",favorite:!0}],this.following=[{id:1,name:"Mis viajes al hospital",image:"https://1.bp.blogspot.com/-8vqVKpVMHis/WdRYMBXMU6I/AAAAAAAAAek/BO5QjRw13B0zX3d0aG4zTUroqK2IPyPDQCLcBGAs/s1600/cover.jpg",author:"De Pilar Ester",favorite:!0},{id:2,name:"Green day",image:"https://1.bp.blogspot.com/-qPxSouBlGl8/WagHNY9pTHI/AAAAAAAAAdk/6TccPwoe0cMlQq5QWZ2WSgFteSx2Q9DuQCLcBGAs/s1600/COVER.jpg",author:"De Jaime Roncal",favorite:!0},{id:3,name:"Magical mirai",image:"https://4.bp.blogspot.com/-SSDZn988cZQ/U-MqsVwXpbI/AAAAAAAADqk/YEnQqHOqlDg/s1600/cover.jpg",author:"De Nacho Ortega",favorite:!0},{id:4,name:"yesssssss",image:"https://images-na.ssl-images-amazon.com/images/I/71BJ5flBQ1L._SL1024_.jpg",author:"De Loreto Matinero",favorite:!0},{id:5,name:"Anime",image:"https://vgmdownloads.com/soundtracks/hatsune-miku-project-diva-f-2nd-complete-collection/cover.png",author:"De Nacho Ortega",favorite:!0},{id:6,name:"Canis de los 2000",image:"https://s.pacn.ws/1500/v8/hatsune-miku-magical-mirai-2018-official-album-cd-dvd-limited-e-562439.1.jpg?p8p6b3",author:"De Nacho Ortega",favorite:!0}],this.misAmigos=[{name:"Pilar Ester",nickname:"pichula",image:"https://media.licdn.com/dms/image/C4D03AQGhTmQp0J-eUw/profile-displayphoto-shrink_200_200/0/1646170721207?e=1684368000&v=beta&t=GrPpweOwHS4uTOiwQ9Vvg3pwY4crqQq7yKPf2DZas7g"},{name:"Jaime Roncal",nickname:"jaima",image:"https://media.licdn.com/dms/image/D4D03AQGlULIm-un43A/profile-displayphoto-shrink_800_800/0/1670712145849?e=2147483647&v=beta&t=LRBX_xAxtl7jymxEzR16l_88BGRmIGIchXsKn1rT3RY"},{name:"Loreto Matinero",nickname:"loretixx",image:"https://media.tenor.com/XSCFKXi06sAAAAAC/felix-argyle-cute.gif"},{name:"Nacho Ortega",nickname:"pikanachi",image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif"}]}showDialog(){this.displayEditProfileDialog=!0}showDialogPassword(){this.displayEditPwdDialog=!0}showImageDialog(){this.displayEditImageDialog=!0}hideDialogProfile(e){this.displayEditProfileDialog=e}hideDialogPassword(e){this.displayEditPwdDialog=e}hideDialogImage(e){this.displayEditImageDialog=e}deleteAccount(){this.confirmationService.confirm({header:"Borrar cuenta",message:"\xbfSeguro que deseas borrar tu cuenta? Una vez borrada se eliminar\xe1n todos tus datos y no podr\xe1s recuperarlos.",acceptLabel:"Borrar cueta",rejectLabel:"Cancelar",accept:()=>{this.router.navigate(["/"])}})}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(nl),be(Gb))},t.\u0275cmp=on({type:t,selectors:[["app-profile"]],decls:33,vars:13,consts:[["class","route-name",4,"ngIf"],[1,"content"],[1,"containers","playlist-header"],[1,"playlist-image-container","justify-content-center"],[1,"relative"],["alt","Playlist Image",1,"playlist-image",3,"src"],["id","play-btn",1,"z-2","absolute","align-items-center","justify-content-center","vibe-btn","play-icon","border-circle","border-none","w-3rem","h-3rem","absolute-position-btn",3,"click"],[1,"flex","align-items-center","justify-content-center","border-circle"],[2,"color","black"],[1,"playlist-desc-continer"],[1,"flex","align-items-center","mb-1"],[1,"text-7xl","text-center"],[1,"flex","align-items-center","mb-3"],[1,"m-0","text-xl","text-600"],[1,"flex","align-items-center","mb-4"],[1,"flex","align-items-center","align-content-center"],["type","button",1,"mr-2","button-width","p-button-text","mt-5","border-round-xl","h-3rem","vibe-btn",3,"click"],[1,"vibe-btn-text"],["type","button",1,"ml-2","button-width","p-button-text","mt-5","border-round-xl","h-3rem","vibe-btn","delete-btn",3,"click"],[1,""],["carouselTitle","Tus playlists",3,"playlists"],["carouselTitle","Siguiendo",3,"playlists"],[3,"friends"],[3,"display","showDialog"],[1,"route-name"],[1,"current-route"]],template:function(e,o){1&e&&(J(0,qne,3,2,"div",0),F(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),Ne(5,"img",5),F(6,"button",6),Oe("click",function(){return o.showImageDialog()}),F(7,"div",7)(8,"mat-icon",8),ce(9,"edit"),V()()()()(),F(10,"div",9)(11,"div",10)(12,"h1",11),ce(13),V()(),F(14,"div",12)(15,"p",13),ce(16),V()(),F(17,"div",14)(18,"p",13),ce(19),V()(),F(20,"div",15)(21,"button",16),Oe("click",function(){return o.showDialog()}),F(22,"span",17),ce(23,"Editar perfil"),V()(),F(24,"button",18),Oe("click",function(){return o.deleteAccount()}),F(25,"span",19),ce(26,"Borrar cuenta"),V()()()()(),Ne(27,"app-carousel",20)(28,"app-carousel",21)(29,"app-friends-carousel",22),V(),F(30,"app-edit-profile-dialog",23),Oe("showDialog",function(s){return o.hideDialogProfile(s)}),V(),F(31,"app-edit-password-dialog",23),Oe("showDialog",function(s){return o.hideDialogPassword(s)}),V(),F(32,"app-image-upload-dialog",23),Oe("showDialog",function(s){return o.hideDialogImage(s)}),V()),2&e&&(B("ngIf",!o.appLayout.showBar),j(5),To("src",o.appLayout.user.image,Co),j(8),ei(" ",o.appLayout.user.name," "),j(3),ei(" @",o.appLayout.user.nickname," "),j(3),ZT("",o.profileStatics.numPlaylists," playlists \xb7 ",o.profileStatics.numFriends," amigos \xb7 ",o.profileStatics.numVibes," vibes"),j(8),B("playlists",o.yourplaylists),j(1),B("playlists",o.following),j(1),B("friends",o.misAmigos),j(1),B("display",o.displayEditProfileDialog),j(1),B("display",o.displayEditPwdDialog),j(1),B("display",o.displayEditImageDialog))},dependencies:[mi,El,hte,fF,Bte,une,Wne],styles:["[_nghost-%COMP%]{width:100%;height:100%}.playlist-header[_ngcontent-%COMP%]{transition:var(--transition);display:flex}.playlist-image-container[_ngcontent-%COMP%]{transition:var(--transition);display:flex;flex:0 1 auto;align-items:center;height:250px;width:250px}.playlist-image[_ngcontent-%COMP%]{height:250px;width:250px;object-fit:cover;border-radius:100%}.playlist-desc-continer[_ngcontent-%COMP%]{transition:var(--transition);display:flex;flex:1 1 auto;flex-direction:column;justify-content:flex-end;margin-left:2rem}.absolute-position-btn[_ngcontent-%COMP%]{right:30px;bottom:3px;cursor:pointer}.button-width[_ngcontent-%COMP%]{transition:var(--transition);width:11rem!important;font-size:.9rem}.delete-btn[_ngcontent-%COMP%]{background:var(--pink-400)!important;color:var(--surface-f)!important;font-size:var(--buttonsFontSize)}.delete-btn[_ngcontent-%COMP%]:hover{background:var(--pink-300)!important}@media (max-width: 1200px){.playlist-header[_ngcontent-%COMP%]{flex-direction:column;width:100%;padding:1.5rem}.playlist-image-container[_ngcontent-%COMP%]{width:100%}.playlist-desc-continer[_ngcontent-%COMP%]{width:100%;align-items:center;margin-top:1rem;margin-left:0}.body-container[_ngcontent-%COMP%]{flex-direction:column;width:100%;margin-top:.25rem}}@media (max-width: 440px){.button-width[_ngcontent-%COMP%]{transition:var(--transition);width:9rem!important;font-size:.7rem}}"]}),t})();function Jb(t){return(Jb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(t)}function Ln(t,n,e){return(n=function Xne(t){var n=function Kne(t,n){if("object"!==Jb(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var o=e.call(t,n||"default");if("object"!==Jb(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===Jb(n)?n:String(n)}(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function hy(t){return t+.5|0}const Lh=(t,n,e)=>Math.max(Math.min(t,e),n);function e0(t){return Lh(hy(2.55*t),0,255)}function gf(t){return Lh(hy(255*t),0,255)}function Fh(t){return Lh(hy(t/2.55)/100,0,1)}function kF(t){return Lh(hy(100*t),0,100)}const mc={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},lM=[..."0123456789ABCDEF"],Yne=t=>lM[15&t],Qne=t=>lM[(240&t)>>4]+lM[15&t],Kw=t=>(240&t)>>4==(15&t),iie=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function AF(t,n,e){const o=n*Math.min(e,1-e),r=(s,l=(s+t/30)%12)=>e-o*Math.max(Math.min(l-3,9-l,1),-1);return[r(0),r(8),r(4)]}function oie(t,n,e){const o=(r,s=(r+t/60)%6)=>e-e*n*Math.max(Math.min(s,4-s,1),0);return[o(5),o(3),o(1)]}function rie(t,n,e){const o=AF(t,1,.5);let r;for(n+e>1&&(r=1/(n+e),n*=r,e*=r),r=0;r<3;r++)o[r]*=1-n-e,o[r]+=n;return o}function cM(t){const e=t.r/255,o=t.g/255,r=t.b/255,s=Math.max(e,o,r),l=Math.min(e,o,r),h=(s+l)/2;let g,b,T;return s!==l&&(T=s-l,b=h>.5?T/(2-s-l):T/(s+l),g=function sie(t,n,e,o,r){return t===r?(n-e)/o+(n<e?6:0):n===r?(e-t)/o+2:(t-n)/o+4}(e,o,r,T,s),g=60*g+.5),[0|g,b||0,h]}function uM(t,n,e,o){return(Array.isArray(n)?t(n[0],n[1],n[2]):t(n,e,o)).map(gf)}function dM(t,n,e){return uM(AF,t,n,e)}function PF(t){return(t%360+360)%360}const OF={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},RF={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Xw;const fie=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,hM=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,py=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Yw(t,n,e){if(t){let o=cM(t);o[n]=Math.max(0,Math.min(o[n]+o[n]*e,0===n?360:1)),o=dM(o),t.r=o[0],t.g=o[1],t.b=o[2]}}function LF(t,n){return t&&Object.assign(n||{},t)}function FF(t){var n={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(n={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(n.a=gf(t[3]))):(n=LF(t,{r:0,g:0,b:0,a:1})).a=gf(n.a),n}function yie(t){return"r"===t.charAt(0)?function mie(t){const n=fie.exec(t);let o,r,s,e=255;if(n){if(n[7]!==o){const l=+n[7];e=n[8]?e0(l):Lh(255*l,0,255)}return o=+n[1],r=+n[3],s=+n[5],o=255&(n[2]?e0(o):Lh(o,0,255)),r=255&(n[4]?e0(r):Lh(r,0,255)),s=255&(n[6]?e0(s):Lh(s,0,255)),{r:o,g:r,b:s,a:e}}}(t):function cie(t){const n=iie.exec(t);let o,e=255;if(!n)return;n[5]!==o&&(e=n[6]?e0(+n[5]):gf(+n[5]));const r=PF(+n[2]),s=+n[3]/100,l=+n[4]/100;return o="hwb"===n[1]?function aie(t,n,e){return uM(rie,t,n,e)}(r,s,l):"hsv"===n[1]?function lie(t,n,e){return uM(oie,t,n,e)}(r,s,l):dM(r,s,l),{r:o[0],g:o[1],b:o[2],a:e}}(t)}class fy{constructor(n){if(n instanceof fy)return n;const e=typeof n;let o;"object"===e?o=FF(n):"string"===e&&(o=function eie(t){var e,n=t.length;return"#"===t[0]&&(4===n||5===n?e={r:255&17*mc[t[1]],g:255&17*mc[t[2]],b:255&17*mc[t[3]],a:5===n?17*mc[t[4]]:255}:(7===n||9===n)&&(e={r:mc[t[1]]<<4|mc[t[2]],g:mc[t[3]]<<4|mc[t[4]],b:mc[t[5]]<<4|mc[t[6]],a:9===n?mc[t[7]]<<4|mc[t[8]]:255})),e}(n)||function pie(t){Xw||(Xw=function hie(){const t={},n=Object.keys(RF),e=Object.keys(OF);let o,r,s,l,h;for(o=0;o<n.length;o++){for(l=h=n[o],r=0;r<e.length;r++)s=e[r],h=h.replace(s,OF[s]);s=parseInt(RF[l],16),t[h]=[s>>16&255,s>>8&255,255&s]}return t}(),Xw.transparent=[0,0,0,0]);const n=Xw[t.toLowerCase()];return n&&{r:n[0],g:n[1],b:n[2],a:4===n.length?n[3]:255}}(n)||yie(n)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var n=LF(this._rgb);return n&&(n.a=Fh(n.a)),n}set rgb(n){this._rgb=FF(n)}rgbString(){return this._valid?function gie(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Fh(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}(this._rgb):void 0}hexString(){return this._valid?function nie(t){var n=(t=>Kw(t.r)&&Kw(t.g)&&Kw(t.b)&&Kw(t.a))(t)?Yne:Qne;return t?"#"+n(t.r)+n(t.g)+n(t.b)+((t,n)=>t<255?n(t):"")(t.a,n):void 0}(this._rgb):void 0}hslString(){return this._valid?function die(t){if(!t)return;const n=cM(t),e=n[0],o=kF(n[1]),r=kF(n[2]);return t.a<255?`hsla(${e}, ${o}%, ${r}%, ${Fh(t.a)})`:`hsl(${e}, ${o}%, ${r}%)`}(this._rgb):void 0}mix(n,e){if(n){const o=this.rgb,r=n.rgb;let s;const l=e===s?.5:e,h=2*l-1,g=o.a-r.a,b=((h*g==-1?h:(h+g)/(1+h*g))+1)/2;s=1-b,o.r=255&b*o.r+s*r.r+.5,o.g=255&b*o.g+s*r.g+.5,o.b=255&b*o.b+s*r.b+.5,o.a=l*o.a+(1-l)*r.a,this.rgb=o}return this}interpolate(n,e){return n&&(this._rgb=function _ie(t,n,e){const o=py(Fh(t.r)),r=py(Fh(t.g)),s=py(Fh(t.b));return{r:gf(hM(o+e*(py(Fh(n.r))-o))),g:gf(hM(r+e*(py(Fh(n.g))-r))),b:gf(hM(s+e*(py(Fh(n.b))-s))),a:t.a+e*(n.a-t.a)}}(this._rgb,n._rgb,e)),this}clone(){return new fy(this.rgb)}alpha(n){return this._rgb.a=gf(n),this}clearer(n){return this._rgb.a*=1-n,this}greyscale(){const n=this._rgb,e=hy(.3*n.r+.59*n.g+.11*n.b);return n.r=n.g=n.b=e,this}opaquer(n){return this._rgb.a*=1+n,this}negate(){const n=this._rgb;return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,this}lighten(n){return Yw(this._rgb,2,n),this}darken(n){return Yw(this._rgb,2,-n),this}saturate(n){return Yw(this._rgb,1,n),this}desaturate(n){return Yw(this._rgb,1,-n),this}rotate(n){return function uie(t,n){var e=cM(t);e[0]=PF(e[0]+n),e=dM(e),t.r=e[0],t.g=e[1],t.b=e[2]}(this._rgb,n),this}}function zh(){}const vie=(()=>{let t=0;return()=>t++})();function yo(t){return null===t||typeof t>"u"}function Yo(t){if(Array.isArray&&Array.isArray(t))return!0;const n=Object.prototype.toString.call(t);return"[object"===n.slice(0,7)&&"Array]"===n.slice(-6)}function io(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function Mr(t){return("number"==typeof t||t instanceof Number)&&isFinite(+t)}function kl(t,n){return Mr(t)?t:n}function Oi(t,n){return typeof t>"u"?n:t}const zF=(t,n)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*n:+t;function $o(t,n,e){if(t&&"function"==typeof t.call)return t.apply(e,n)}function Ro(t,n,e,o){let r,s,l;if(Yo(t))if(s=t.length,o)for(r=s-1;r>=0;r--)n.call(e,t[r],r);else for(r=0;r<s;r++)n.call(e,t[r],r);else if(io(t))for(l=Object.keys(t),s=l.length,r=0;r<s;r++)n.call(e,t[l[r]],l[r])}function Qw(t,n){let e,o,r,s;if(!t||!n||t.length!==n.length)return!1;for(e=0,o=t.length;e<o;++e)if(r=t[e],s=n[e],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function Jw(t){if(Yo(t))return t.map(Jw);if(io(t)){const n=Object.create(null),e=Object.keys(t),o=e.length;let r=0;for(;r<o;++r)n[e[r]]=Jw(t[e[r]]);return n}return t}function NF(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function xie(t,n,e,o){if(!NF(t))return;const r=n[t],s=e[t];io(r)&&io(s)?t0(r,s,o):n[t]=Jw(s)}function t0(t,n,e){const o=Yo(n)?n:[n],r=o.length;if(!io(t))return t;const s=(e=e||{}).merger||xie;let l;for(let h=0;h<r;++h){if(l=o[h],!io(l))continue;const g=Object.keys(l);for(let b=0,T=g.length;b<T;++b)s(g[b],t,l,e)}return t}function n0(t,n){return t0(t,n,{merger:wie})}function wie(t,n,e){if(!NF(t))return;const o=n[t],r=e[t];io(o)&&io(r)?n0(o,r):Object.prototype.hasOwnProperty.call(n,t)||(n[t]=Jw(r))}const BF={"":t=>t,x:t=>t.x,y:t=>t.y};function _f(t,n){return(BF[n]||(BF[n]=function Tie(t){const n=function Cie(t){const n=t.split("."),e=[];let o="";for(const r of n)o+=r,o.endsWith("\\")?o=o.slice(0,-1)+".":(e.push(o),o="");return e}(t);return e=>{for(const o of n){if(""===o)break;e=e&&e[o]}return e}}(n)))(t)}function pM(t){return t.charAt(0).toUpperCase()+t.slice(1)}const gc=t=>typeof t<"u",yf=t=>"function"==typeof t,VF=(t,n)=>{if(t.size!==n.size)return!1;for(const e of t)if(!n.has(e))return!1;return!0},ar=Math.PI,Qo=2*ar,Sie=Qo+ar,eC=Number.POSITIVE_INFINITY,Die=ar/180,Ir=ar/2,lg=ar/4,UF=2*ar/3,vf=Math.log10,wd=Math.sign;function o0(t,n,e){return Math.abs(t-n)<e}function jF(t){const n=Math.round(t);t=o0(t,n,t/1e3)?n:t;const e=Math.pow(10,Math.floor(vf(t))),o=t/e;return(o<=1?1:o<=2?2:o<=5?5:10)*e}function my(t){return!isNaN(parseFloat(t))&&isFinite(t)}function HF(t,n,e){let o,r,s;for(o=0,r=t.length;o<r;o++)s=t[o][e],isNaN(s)||(n.min=Math.min(n.min,s),n.max=Math.max(n.max,s))}function gu(t){return t*(ar/180)}function fM(t){return t*(180/ar)}function $F(t){if(!Mr(t))return;let n=1,e=0;for(;Math.round(t*n)/n!==t;)n*=10,e++;return e}function GF(t,n){const e=n.x-t.x,o=n.y-t.y,r=Math.sqrt(e*e+o*o);let s=Math.atan2(o,e);return s<-.5*ar&&(s+=Qo),{angle:s,distance:r}}function mM(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))}function kie(t,n){return(t-n+Sie)%Qo-ar}function Al(t){return(t%Qo+Qo)%Qo}function r0(t,n,e,o){const r=Al(t),s=Al(n),l=Al(e),h=Al(s-r),g=Al(l-r),b=Al(r-s),T=Al(r-l);return r===s||r===l||o&&s===l||h>g&&b<T}function As(t,n,e){return Math.max(n,Math.min(e,t))}function Nh(t,n,e,o=1e-6){return t>=Math.min(n,e)-o&&t<=Math.max(n,e)+o}function gM(t,n,e){e=e||(l=>t[l]<n);let s,o=t.length-1,r=0;for(;o-r>1;)s=r+o>>1,e(s)?r=s:o=s;return{lo:r,hi:o}}const Bh=(t,n,e,o)=>gM(t,e,o?r=>{const s=t[r][n];return s<e||s===e&&t[r+1][n]===e}:r=>t[r][n]<e),Pie=(t,n,e)=>gM(t,e,o=>t[o][n]>=e),WF=["push","pop","shift","splice","unshift"];function qF(t,n){const e=t._chartjs;if(!e)return;const o=e.listeners,r=o.indexOf(n);-1!==r&&o.splice(r,1),!(o.length>0)&&(WF.forEach(s=>{delete t[s]}),delete t._chartjs)}function ZF(t){const n=new Set;let e,o;for(e=0,o=t.length;e<o;++e)n.add(t[e]);return n.size===o?t:Array.from(n)}const KF=typeof window>"u"?function(t){return t()}:window.requestAnimationFrame;function XF(t,n){let e=[],o=!1;return function(...r){e=r,o||(o=!0,KF.call(window,()=>{o=!1,t.apply(n,e)}))}}const _M=t=>"start"===t?"left":"end"===t?"right":"center",ca=(t,n,e)=>"start"===t?n:"end"===t?e:(n+e)/2;function YF(t,n,e){const o=n.length;let r=0,s=o;if(t._sorted){const{iScale:l,_parsed:h}=t,g=l.axis,{min:b,max:T,minDefined:I,maxDefined:R}=l.getUserBounds();I&&(r=As(Math.min(Bh(h,l.axis,b).lo,e?o:Bh(n,g,l.getPixelForValue(b)).lo),0,o-1)),s=R?As(Math.max(Bh(h,l.axis,T,!0).hi+1,e?0:Bh(n,g,l.getPixelForValue(T),!0).hi+1),r,o)-r:o-r}return{start:r,count:s}}function QF(t){const{xScale:n,yScale:e,_scaleRanges:o}=t,r={xmin:n.min,xmax:n.max,ymin:e.min,ymax:e.max};if(!o)return t._scaleRanges=r,!0;const s=o.xmin!==n.min||o.xmax!==n.max||o.ymin!==e.min||o.ymax!==e.max;return Object.assign(o,r),s}const tC=t=>0===t||1===t,JF=(t,n,e)=>-Math.pow(2,10*(t-=1))*Math.sin((t-n)*Qo/e),e3=(t,n,e)=>Math.pow(2,-10*t)*Math.sin((t-n)*Qo/e)+1,s0={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*Ir),easeOutSine:t=>Math.sin(t*Ir),easeInOutSine:t=>-.5*(Math.cos(ar*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>tC(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>tC(t)?t:JF(t,.075,.3),easeOutElastic:t=>tC(t)?t:e3(t,.075,.3),easeInOutElastic:t=>tC(t)?t:t<.5?.5*JF(2*t,.1125,.45):.5+.5*e3(2*t-1,.1125,.45),easeInBack:t=>t*t*(2.70158*t-1.70158),easeOutBack:t=>(t-=1)*t*(2.70158*t+1.70158)+1,easeInOutBack(t){let n=1.70158;return(t/=.5)<1?t*t*((1+(n*=1.525))*t-n)*.5:.5*((t-=2)*t*((1+(n*=1.525))*t+n)+2)},easeInBounce:t=>1-s0.easeOutBounce(1-t),easeOutBounce:t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,easeInOutBounce:t=>t<.5?.5*s0.easeInBounce(2*t):.5*s0.easeOutBounce(2*t-1)+.5};function t3(t){if(t&&"object"==typeof t){const n=t.toString();return"[object CanvasPattern]"===n||"[object CanvasGradient]"===n}return!1}function n3(t){return t3(t)?t:new fy(t)}function yM(t){return t3(t)?t:new fy(t).saturate(.5).darken(.1).hexString()}const zie=["x","y","borderWidth","radius","tension"],Nie=["color","borderColor","backgroundColor"],o3=new Map;function a0(t,n,e){return function Uie(t,n){n=n||{};const e=t+JSON.stringify(n);let o=o3.get(e);return o||(o=new Intl.NumberFormat(t,n),o3.set(e,o)),o}(n,e).format(t)}const r3={values:t=>Yo(t)?t:""+t,numeric(t,n,e){if(0===t)return"0";const o=this.chart.options.locale;let r,s=t;if(e.length>1){const b=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(b<1e-4||b>1e15)&&(r="scientific"),s=function jie(t,n){let e=n.length>3?n[2].value-n[1].value:n[1].value-n[0].value;return Math.abs(e)>=1&&t!==Math.floor(t)&&(e=t-Math.floor(t)),e}(t,e)}const l=vf(Math.abs(s)),h=Math.max(Math.min(-1*Math.floor(l),20),0),g={notation:r,minimumFractionDigits:h,maximumFractionDigits:h};return Object.assign(g,this.options.ticks.format),a0(t,o,g)},logarithmic(t,n,e){if(0===t)return"0";const o=e[n].significand||t/Math.pow(10,Math.floor(vf(t)));return[1,2,3,5,10,15].includes(o)||n>.8*e.length?r3.numeric.call(this,t,n,e):""}};var nC={formatters:r3};const cg=Object.create(null),vM=Object.create(null);function l0(t,n){if(!n)return t;const e=n.split(".");for(let o=0,r=e.length;o<r;++o){const s=e[o];t=t[s]||(t[s]=Object.create(null))}return t}function bM(t,n,e){return"string"==typeof n?t0(l0(t,n),e):t0(l0(t,""),n)}class $ie{constructor(n,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,r)=>yM(r.backgroundColor),this.hoverBorderColor=(o,r)=>yM(r.borderColor),this.hoverColor=(o,r)=>yM(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(n),this.apply(e)}set(n,e){return bM(this,n,e)}get(n){return l0(this,n)}describe(n,e){return bM(vM,n,e)}override(n,e){return bM(cg,n,e)}route(n,e,o,r){const s=l0(this,n),l=l0(this,o),h="_"+e;Object.defineProperties(s,{[h]:{value:s[e],writable:!0},[e]:{enumerable:!0,get(){const g=this[h],b=l[r];return io(g)?Object.assign({},b,g):Oi(g,b)},set(g){this[h]=g}}})}apply(n){n.forEach(e=>e(this))}}var Zr=new $ie({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function Bie(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>"onProgress"!==n&&"onComplete"!==n&&"fn"!==n}),t.set("animations",{colors:{type:"color",properties:Nie},numbers:{type:"number",properties:zie}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>0|n}}}})},function Vie(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function Hie(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,e)=>e.lineWidth,tickColor:(n,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:nC.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&"callback"!==n&&"parser"!==n,_indexable:n=>"borderDash"!==n&&"tickBorderDash"!==n&&"dash"!==n}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:n=>"backdropPadding"!==n&&"callback"!==n,_indexable:n=>"backdropPadding"!==n})}]);function iC(t,n,e,o,r){let s=n[r];return s||(s=n[r]=t.measureText(r).width,e.push(r)),s>o&&(o=s),o}function Wie(t,n,e,o){let r=(o=o||{}).data=o.data||{},s=o.garbageCollect=o.garbageCollect||[];o.font!==n&&(r=o.data={},s=o.garbageCollect=[],o.font=n),t.save(),t.font=n;let l=0;const h=e.length;let g,b,T,I,R;for(g=0;g<h;g++)if(I=e[g],null!=I&&!0!==Yo(I))l=iC(t,r,s,l,I);else if(Yo(I))for(b=0,T=I.length;b<T;b++)R=I[b],null!=R&&!Yo(R)&&(l=iC(t,r,s,l,R));t.restore();const z=s.length/2;if(z>e.length){for(g=0;g<z;g++)delete r[s[g]];s.splice(0,z)}return l}function ug(t,n,e){const o=t.currentDevicePixelRatio,r=0!==e?Math.max(e/2,.5):0;return Math.round((n-r)*o)/o+r}function s3(t,n){(n=n||t.getContext("2d")).save(),n.resetTransform(),n.clearRect(0,0,t.width,t.height),n.restore()}function xM(t,n,e,o){a3(t,n,e,o,null)}function a3(t,n,e,o,r){let s,l,h,g,b,T,I,R;const z=n.pointStyle,W=n.rotation,X=n.radius;let ee=(W||0)*Die;if(z&&"object"==typeof z&&(s=z.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return t.save(),t.translate(e,o),t.rotate(ee),t.drawImage(z,-z.width/2,-z.height/2,z.width,z.height),void t.restore();if(!(isNaN(X)||X<=0)){switch(t.beginPath(),z){default:r?t.ellipse(e,o,r/2,X,0,0,Qo):t.arc(e,o,X,0,Qo),t.closePath();break;case"triangle":T=r?r/2:X,t.moveTo(e+Math.sin(ee)*T,o-Math.cos(ee)*X),ee+=UF,t.lineTo(e+Math.sin(ee)*T,o-Math.cos(ee)*X),ee+=UF,t.lineTo(e+Math.sin(ee)*T,o-Math.cos(ee)*X),t.closePath();break;case"rectRounded":b=.516*X,g=X-b,l=Math.cos(ee+lg)*g,I=Math.cos(ee+lg)*(r?r/2-b:g),h=Math.sin(ee+lg)*g,R=Math.sin(ee+lg)*(r?r/2-b:g),t.arc(e-I,o-h,b,ee-ar,ee-Ir),t.arc(e+R,o-l,b,ee-Ir,ee),t.arc(e+I,o+h,b,ee,ee+Ir),t.arc(e-R,o+l,b,ee+Ir,ee+ar),t.closePath();break;case"rect":if(!W){g=Math.SQRT1_2*X,T=r?r/2:g,t.rect(e-T,o-g,2*T,2*g);break}ee+=lg;case"rectRot":I=Math.cos(ee)*(r?r/2:X),l=Math.cos(ee)*X,h=Math.sin(ee)*X,R=Math.sin(ee)*(r?r/2:X),t.moveTo(e-I,o-h),t.lineTo(e+R,o-l),t.lineTo(e+I,o+h),t.lineTo(e-R,o+l),t.closePath();break;case"crossRot":ee+=lg;case"cross":I=Math.cos(ee)*(r?r/2:X),l=Math.cos(ee)*X,h=Math.sin(ee)*X,R=Math.sin(ee)*(r?r/2:X),t.moveTo(e-I,o-h),t.lineTo(e+I,o+h),t.moveTo(e+R,o-l),t.lineTo(e-R,o+l);break;case"star":I=Math.cos(ee)*(r?r/2:X),l=Math.cos(ee)*X,h=Math.sin(ee)*X,R=Math.sin(ee)*(r?r/2:X),t.moveTo(e-I,o-h),t.lineTo(e+I,o+h),t.moveTo(e+R,o-l),t.lineTo(e-R,o+l),ee+=lg,I=Math.cos(ee)*(r?r/2:X),l=Math.cos(ee)*X,h=Math.sin(ee)*X,R=Math.sin(ee)*(r?r/2:X),t.moveTo(e-I,o-h),t.lineTo(e+I,o+h),t.moveTo(e+R,o-l),t.lineTo(e-R,o+l);break;case"line":l=r?r/2:Math.cos(ee)*X,h=Math.sin(ee)*X,t.moveTo(e-l,o-h),t.lineTo(e+l,o+h);break;case"dash":t.moveTo(e,o),t.lineTo(e+Math.cos(ee)*(r?r/2:X),o+Math.sin(ee)*X);break;case!1:t.closePath()}t.fill(),n.borderWidth>0&&t.stroke()}}function c0(t,n,e){return e=e||.5,!n||t&&t.x>n.left-e&&t.x<n.right+e&&t.y>n.top-e&&t.y<n.bottom+e}function oC(t,n){t.save(),t.beginPath(),t.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),t.clip()}function rC(t){t.restore()}function qie(t,n,e,o,r){if(!n)return t.lineTo(e.x,e.y);if("middle"===r){const s=(n.x+e.x)/2;t.lineTo(s,n.y),t.lineTo(s,e.y)}else"after"===r!=!!o?t.lineTo(n.x,e.y):t.lineTo(e.x,n.y);t.lineTo(e.x,e.y)}function Zie(t,n,e,o){if(!n)return t.lineTo(e.x,e.y);t.bezierCurveTo(o?n.cp1x:n.cp2x,o?n.cp1y:n.cp2y,o?e.cp2x:e.cp1x,o?e.cp2y:e.cp1y,e.x,e.y)}function dg(t,n,e,o,r,s={}){const l=Yo(n)?n:[n],h=s.strokeWidth>0&&""!==s.strokeColor;let g,b;for(t.save(),t.font=r.string,function Kie(t,n){n.translation&&t.translate(n.translation[0],n.translation[1]),yo(n.rotation)||t.rotate(n.rotation),n.color&&(t.fillStyle=n.color),n.textAlign&&(t.textAlign=n.textAlign),n.textBaseline&&(t.textBaseline=n.textBaseline)}(t,s),g=0;g<l.length;++g)b=l[g],s.backdrop&&Yie(t,s.backdrop),h&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),yo(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(b,e,o,s.maxWidth)),t.fillText(b,e,o,s.maxWidth),Xie(t,e,o,b,s),o+=r.lineHeight;t.restore()}function Xie(t,n,e,o,r){if(r.strikethrough||r.underline){const s=t.measureText(o),l=n-s.actualBoundingBoxLeft,h=n+s.actualBoundingBoxRight,b=e+s.actualBoundingBoxDescent,T=r.strikethrough?(e-s.actualBoundingBoxAscent+b)/2:b;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(l,T),t.lineTo(h,T),t.stroke()}}function Yie(t,n){const e=t.fillStyle;t.fillStyle=n.color,t.fillRect(n.left,n.top,n.width,n.height),t.fillStyle=e}function u0(t,n){const{x:e,y:o,w:r,h:s,radius:l}=n;t.arc(e+l.topLeft,o+l.topLeft,l.topLeft,-Ir,ar,!0),t.lineTo(e,o+s-l.bottomLeft),t.arc(e+l.bottomLeft,o+s-l.bottomLeft,l.bottomLeft,ar,Ir,!0),t.lineTo(e+r-l.bottomRight,o+s),t.arc(e+r-l.bottomRight,o+s-l.bottomRight,l.bottomRight,Ir,0,!0),t.lineTo(e+r,o+l.topRight),t.arc(e+r-l.topRight,o+l.topRight,l.topRight,0,-Ir,!0),t.lineTo(e+l.topLeft,o)}const Qie=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Jie=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function eoe(t,n){const e=(""+t).match(Qie);if(!e||"normal"===e[1])return 1.2*n;switch(t=+e[2],e[3]){case"px":return t;case"%":t/=100}return n*t}const toe=t=>+t||0;function wM(t,n){const e={},o=io(n),r=o?Object.keys(n):n,s=io(t)?o?l=>Oi(t[l],t[n[l]]):l=>t[l]:()=>t;for(const l of r)e[l]=toe(s(l));return e}function l3(t){return wM(t,{top:"y",right:"x",bottom:"y",left:"x"})}function hg(t){return wM(t,["topLeft","topRight","bottomLeft","bottomRight"])}function ua(t){const n=l3(t);return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function ys(t,n){let e=Oi((t=t||{}).size,(n=n||Zr.font).size);"string"==typeof e&&(e=parseInt(e,10));let o=Oi(t.style,n.style);o&&!(""+o).match(Jie)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const r={family:Oi(t.family,n.family),lineHeight:eoe(Oi(t.lineHeight,n.lineHeight),e),size:e,style:o,weight:Oi(t.weight,n.weight),string:""};return r.string=function Gie(t){return!t||yo(t.size)||yo(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(r),r}function d0(t,n,e,o){let s,l,h,r=!0;for(s=0,l=t.length;s<l;++s)if(h=t[s],void 0!==h&&(void 0!==n&&"function"==typeof h&&(h=h(n),r=!1),void 0!==e&&Yo(h)&&(h=h[e%h.length],r=!1),void 0!==h))return o&&!r&&(o.cacheable=!1),h}function bf(t,n){return Object.assign(Object.create(t),n)}function CM(t,n=[""],e=t,o,r=(()=>t[0])){gc(o)||(o=p3("_fallback",t));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:e,_fallback:o,_getTarget:r,override:l=>CM([l,...t],n,e,o)};return new Proxy(s,{deleteProperty:(l,h)=>(delete l[h],delete l._keys,delete t[0][h],!0),get:(l,h)=>u3(l,h,()=>function uoe(t,n,e,o){let r;for(const s of n)if(r=p3(ioe(s,t),e),gc(r))return TM(t,r)?EM(e,o,t,r):r}(h,n,t,l)),getOwnPropertyDescriptor:(l,h)=>Reflect.getOwnPropertyDescriptor(l._scopes[0],h),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(l,h)=>f3(l).includes(h),ownKeys:l=>f3(l),set(l,h,g){const b=l._storage||(l._storage=r());return l[h]=b[h]=g,delete l._keys,!0}})}function gy(t,n,e,o){const r={_cacheable:!1,_proxy:t,_context:n,_subProxy:e,_stack:new Set,_descriptors:c3(t,o),setContext:s=>gy(t,s,e,o),override:s=>gy(t.override(s),n,e,o)};return new Proxy(r,{deleteProperty:(s,l)=>(delete s[l],delete t[l],!0),get:(s,l,h)=>u3(s,l,()=>function ooe(t,n,e){const{_proxy:o,_context:r,_subProxy:s,_descriptors:l}=t;let h=o[n];return yf(h)&&l.isScriptable(n)&&(h=function roe(t,n,e,o){const{_proxy:r,_context:s,_subProxy:l,_stack:h}=e;if(h.has(t))throw new Error("Recursion detected: "+Array.from(h).join("->")+"->"+t);return h.add(t),n=n(s,l||o),h.delete(t),TM(t,n)&&(n=EM(r._scopes,r,t,n)),n}(n,h,t,e)),Yo(h)&&h.length&&(h=function soe(t,n,e,o){const{_proxy:r,_context:s,_subProxy:l,_descriptors:h}=e;if(gc(s.index)&&o(t))n=n[s.index%n.length];else if(io(n[0])){const g=n,b=r._scopes.filter(T=>T!==g);n=[];for(const T of g){const I=EM(b,r,t,T);n.push(gy(I,s,l&&l[t],h))}}return n}(n,h,t,l.isIndexable)),TM(n,h)&&(h=gy(h,r,s&&s[n],l)),h}(s,l,h)),getOwnPropertyDescriptor:(s,l)=>s._descriptors.allKeys?Reflect.has(t,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,l),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(s,l)=>Reflect.has(t,l),ownKeys:()=>Reflect.ownKeys(t),set:(s,l,h)=>(t[l]=h,delete s[l],!0)})}function c3(t,n={scriptable:!0,indexable:!0}){const{_scriptable:e=n.scriptable,_indexable:o=n.indexable,_allKeys:r=n.allKeys}=t;return{allKeys:r,scriptable:e,indexable:o,isScriptable:yf(e)?e:()=>e,isIndexable:yf(o)?o:()=>o}}const ioe=(t,n)=>t?t+pM(n):n,TM=(t,n)=>io(n)&&"adapters"!==t&&(null===Object.getPrototypeOf(n)||n.constructor===Object);function u3(t,n,e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const o=e();return t[n]=o,o}function d3(t,n,e){return yf(t)?t(n,e):t}const aoe=(t,n)=>!0===t?n:"string"==typeof t?_f(n,t):void 0;function loe(t,n,e,o,r){for(const s of n){const l=aoe(e,s);if(l){t.add(l);const h=d3(l._fallback,e,r);if(gc(h)&&h!==e&&h!==o)return h}else if(!1===l&&gc(o)&&e!==o)return null}return!1}function EM(t,n,e,o){const r=n._rootScopes,s=d3(n._fallback,e,o),l=[...t,...r],h=new Set;h.add(o);let g=h3(h,l,e,s||e,o);return!(null===g||gc(s)&&s!==e&&(g=h3(h,l,s,g,o),null===g))&&CM(Array.from(h),[""],r,s,()=>function coe(t,n,e){const o=t._getTarget();n in o||(o[n]={});const r=o[n];return Yo(r)&&io(e)?e:r||{}}(n,e,o))}function h3(t,n,e,o,r){for(;e;)e=loe(t,n,e,o,r);return e}function p3(t,n){for(const e of n){if(!e)continue;const o=e[t];if(gc(o))return o}}function f3(t){let n=t._keys;return n||(n=t._keys=function doe(t){const n=new Set;for(const e of t)for(const o of Object.keys(e).filter(r=>!r.startsWith("_")))n.add(o);return Array.from(n)}(t._scopes)),n}function m3(t,n,e,o){const{iScale:r}=t,{key:s="r"}=this._parsing,l=new Array(o);let h,g,b,T;for(h=0,g=o;h<g;++h)b=h+e,T=n[b],l[h]={r:r.parse(_f(T,s),b)};return l}const hoe=Number.EPSILON||1e-14,_y=(t,n)=>n<t.length&&!t[n].skip&&t[n],g3=t=>"x"===t?"y":"x";function poe(t,n,e,o){const r=t.skip?n:t,s=n,l=e.skip?n:e,h=mM(s,r),g=mM(l,s);let b=h/(h+g),T=g/(h+g);b=isNaN(b)?0:b,T=isNaN(T)?0:T;const I=o*b,R=o*T;return{previous:{x:s.x-I*(l.x-r.x),y:s.y-I*(l.y-r.y)},next:{x:s.x+R*(l.x-r.x),y:s.y+R*(l.y-r.y)}}}function sC(t,n,e){return Math.max(Math.min(t,e),n)}function yoe(t,n,e,o,r){let s,l,h,g;if(n.spanGaps&&(t=t.filter(b=>!b.skip)),"monotone"===n.cubicInterpolationMode)!function goe(t,n="x"){const e=g3(n),o=t.length,r=Array(o).fill(0),s=Array(o);let l,h,g,b=_y(t,0);for(l=0;l<o;++l)if(h=g,g=b,b=_y(t,l+1),g){if(b){const T=b[n]-g[n];r[l]=0!==T?(b[e]-g[e])/T:0}s[l]=h?b?wd(r[l-1])!==wd(r[l])?0:(r[l-1]+r[l])/2:r[l-1]:r[l]}(function foe(t,n,e){const o=t.length;let r,s,l,h,g,b=_y(t,0);for(let T=0;T<o-1;++T)if(g=b,b=_y(t,T+1),g&&b){if(o0(n[T],0,hoe)){e[T]=e[T+1]=0;continue}r=e[T]/n[T],s=e[T+1]/n[T],h=Math.pow(r,2)+Math.pow(s,2),!(h<=9)&&(l=3/Math.sqrt(h),e[T]=r*l*n[T],e[T+1]=s*l*n[T])}})(t,r,s),function moe(t,n,e="x"){const o=g3(e),r=t.length;let s,l,h,g=_y(t,0);for(let b=0;b<r;++b){if(l=h,h=g,g=_y(t,b+1),!h)continue;const T=h[e],I=h[o];l&&(s=(T-l[e])/3,h[`cp1${e}`]=T-s,h[`cp1${o}`]=I-s*n[b]),g&&(s=(g[e]-T)/3,h[`cp2${e}`]=T+s,h[`cp2${o}`]=I+s*n[b])}}(t,s,n)}(t,r);else{let b=o?t[t.length-1]:t[0];for(s=0,l=t.length;s<l;++s)h=t[s],g=poe(b,h,t[Math.min(s+1,l-(o?0:1))%l],n.tension),h.cp1x=g.previous.x,h.cp1y=g.previous.y,h.cp2x=g.next.x,h.cp2y=g.next.y,b=h}n.capBezierPoints&&function _oe(t,n){let e,o,r,s,l,h=c0(t[0],n);for(e=0,o=t.length;e<o;++e)l=s,s=h,h=e<o-1&&c0(t[e+1],n),s&&(r=t[e],l&&(r.cp1x=sC(r.cp1x,n.left,n.right),r.cp1y=sC(r.cp1y,n.top,n.bottom)),h&&(r.cp2x=sC(r.cp2x,n.left,n.right),r.cp2y=sC(r.cp2y,n.top,n.bottom)))}(t,e)}function _3(){return typeof window<"u"&&typeof document<"u"}function SM(t){let n=t.parentNode;return n&&"[object ShadowRoot]"===n.toString()&&(n=n.host),n}function aC(t,n,e){let o;return"string"==typeof t?(o=parseInt(t,10),-1!==t.indexOf("%")&&(o=o/100*n.parentNode[e])):o=t,o}const lC=t=>t.ownerDocument.defaultView.getComputedStyle(t,null),boe=["top","right","bottom","left"];function pg(t,n,e){const o={};e=e?"-"+e:"";for(let r=0;r<4;r++){const s=boe[r];o[s]=parseFloat(t[n+"-"+s+e])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const xoe=(t,n,e)=>(t>0||n>0)&&(!e||!e.shadowRoot);function fg(t,n){if("native"in t)return t;const{canvas:e,currentDevicePixelRatio:o}=n,r=lC(e),s="border-box"===r.boxSizing,l=pg(r,"padding"),h=pg(r,"border","width"),{x:g,y:b,box:T}=function woe(t,n){const e=t.touches,o=e&&e.length?e[0]:t,{offsetX:r,offsetY:s}=o;let h,g,l=!1;if(xoe(r,s,t.target))h=r,g=s;else{const b=n.getBoundingClientRect();h=o.clientX-b.left,g=o.clientY-b.top,l=!0}return{x:h,y:g,box:l}}(t,e),I=l.left+(T&&h.left),R=l.top+(T&&h.top);let{width:z,height:W}=n;return s&&(z-=l.width+h.width,W-=l.height+h.height),{x:Math.round((g-I)/z*e.width/o),y:Math.round((b-R)/W*e.height/o)}}const cC=t=>Math.round(10*t)/10;function y3(t,n,e){const o=n||1,r=Math.floor(t.height*o),s=Math.floor(t.width*o);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const l=t.canvas;return l.style&&(e||!l.style.height&&!l.style.width)&&(l.style.height=`${t.height}px`,l.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==o||l.height!==r||l.width!==s)&&(t.currentDevicePixelRatio=o,l.height=r,l.width=s,t.ctx.setTransform(o,0,0,o,0,0),!0)}const Eoe=function(){let t=!1;try{const n={get passive(){return t=!0,!1}};window.addEventListener("test",null,n),window.removeEventListener("test",null,n)}catch{}return t}();function v3(t,n){const e=function voe(t,n){return lC(t).getPropertyValue(n)}(t,n),o=e&&e.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}function mg(t,n,e,o){return{x:t.x+e*(n.x-t.x),y:t.y+e*(n.y-t.y)}}function Soe(t,n,e,o){return{x:t.x+e*(n.x-t.x),y:"middle"===o?e<.5?t.y:n.y:"after"===o?e<1?t.y:n.y:e>0?n.y:t.y}}function Doe(t,n,e,o){const r={x:t.cp2x,y:t.cp2y},s={x:n.cp1x,y:n.cp1y},l=mg(t,r,e),h=mg(r,s,e),g=mg(s,n,e),b=mg(l,h,e),T=mg(h,g,e);return mg(b,T,e)}const Moe=function(t,n){return{x:e=>t+t+n-e,setWidth(e){n=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,o)=>e-o,leftForLtr:(e,o)=>e-o}},Ioe=function(){return{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,n)=>t+n,leftForLtr:(t,n)=>t}};function yy(t,n,e){return t?Moe(n,e):Ioe()}function b3(t,n){let e,o;("ltr"===n||"rtl"===n)&&(e=t.canvas.style,o=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",n,"important"),t.prevTextDirection=o)}function x3(t,n){void 0!==n&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",n[0],n[1]))}function w3(t){return"angle"===t?{between:r0,compare:kie,normalize:Al}:{between:Nh,compare:(n,e)=>n-e,normalize:n=>n}}function C3({start:t,end:n,count:e,loop:o,style:r}){return{start:t%e,end:n%e,loop:o&&(n-t+1)%e==0,style:r}}function T3(t,n,e){if(!e)return[t];const{property:o,start:r,end:s}=e,l=n.length,{compare:h,between:g,normalize:b}=w3(o),{start:T,end:I,loop:R,style:z}=function koe(t,n,e){const{property:o,start:r,end:s}=e,{between:l,normalize:h}=w3(o),g=n.length;let R,z,{start:b,end:T,loop:I}=t;if(I){for(b+=g,T+=g,R=0,z=g;R<z&&l(h(n[b%g][o]),r,s);++R)b--,T--;b%=g,T%=g}return T<b&&(T+=g),{start:b,end:T,loop:I,style:t.style}}(t,n,e),W=[];let le,ve,xe,X=!1,ee=null;for(let Nt=T,Ut=T;Nt<=I;++Nt)ve=n[Nt%l],!ve.skip&&(le=b(ve[o]),le!==xe&&(X=g(le,r,s),null===ee&&(X||g(r,xe,le)&&0!==h(r,xe))&&(ee=0===h(le,r)?Nt:Ut),null!==ee&&(!X||0===h(s,le)||g(s,xe,le))&&(W.push(C3({start:ee,end:Nt,loop:R,count:l,style:z})),ee=null),Ut=Nt,xe=le));return null!==ee&&W.push(C3({start:ee,end:I,loop:R,count:l,style:z})),W}function E3(t,n){const e=[],o=t.segments;for(let r=0;r<o.length;r++){const s=T3(o[r],t.points,n);s.length&&e.push(...s)}return e}function D3(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Loe(t,n){return n&&JSON.stringify(t)!==JSON.stringify(n)}class Foe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(n,e,o,r){const l=e.duration;e.listeners[r].forEach(h=>h({chart:n,initial:e.initial,numSteps:l,currentStep:Math.min(o-e.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=KF.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(n=Date.now()){let e=0;this._charts.forEach((o,r)=>{if(!o.running||!o.items.length)return;const s=o.items;let g,l=s.length-1,h=!1;for(;l>=0;--l)g=s[l],g._active?(g._total>o.duration&&(o.duration=g._total),g.tick(n),h=!0):(s[l]=s[s.length-1],s.pop());h&&(r.draw(),this._notify(r,o,n,"progress")),s.length||(o.running=!1,this._notify(r,o,n,"complete"),o.initial=!1),e+=s.length}),this._lastDate=n,0===e&&(this._running=!1)}_getAnims(n){const e=this._charts;let o=e.get(n);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(n,o)),o}listen(n,e,o){this._getAnims(n).listeners[e].push(o)}add(n,e){!e||!e.length||this._getAnims(n).items.push(...e)}has(n){return this._getAnims(n).items.length>0}start(n){const e=this._charts.get(n);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((o,r)=>Math.max(o,r._duration),0),this._refresh())}running(n){if(!this._running)return!1;const e=this._charts.get(n);return!(!e||!e.running||!e.items.length)}stop(n){const e=this._charts.get(n);if(!e||!e.items.length)return;const o=e.items;let r=o.length-1;for(;r>=0;--r)o[r].cancel();e.items=[],this._notify(n,e,Date.now(),"complete")}remove(n){return this._charts.delete(n)}}var Vh=new Foe;const M3="transparent",zoe={boolean:(t,n,e)=>e>.5?n:t,color(t,n,e){const o=n3(t||M3),r=o.valid&&n3(n||M3);return r&&r.valid?r.mix(o,e).hexString():n},number:(t,n,e)=>t+(n-t)*e};class Noe{constructor(n,e,o,r){const s=e[o];r=d0([n.to,r,s,n.from]);const l=d0([n.from,s,r]);this._active=!0,this._fn=n.fn||zoe[n.type||typeof l],this._easing=s0[n.easing]||s0.linear,this._start=Math.floor(Date.now()+(n.delay||0)),this._duration=this._total=Math.floor(n.duration),this._loop=!!n.loop,this._target=e,this._prop=o,this._from=l,this._to=r,this._promises=void 0}active(){return this._active}update(n,e,o){if(this._active){this._notify(!1);const r=this._target[this._prop],s=o-this._start,l=this._duration-s;this._start=o,this._duration=Math.floor(Math.max(l,n.duration)),this._total+=s,this._loop=!!n.loop,this._to=d0([n.to,e,r,n.from]),this._from=d0([n.from,r,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(n){const e=n-this._start,o=this._duration,r=this._prop,s=this._from,l=this._loop,h=this._to;let g;if(this._active=s!==h&&(l||e<o),!this._active)return this._target[r]=h,void this._notify(!0);e<0?this._target[r]=s:(g=e/o%2,g=l&&g>1?2-g:g,g=this._easing(Math.min(1,Math.max(0,g))),this._target[r]=this._fn(s,h,g))}wait(){const n=this._promises||(this._promises=[]);return new Promise((e,o)=>{n.push({res:e,rej:o})})}_notify(n){const e=n?"res":"rej",o=this._promises||[];for(let r=0;r<o.length;r++)o[r][e]()}}class I3{constructor(n,e){this._chart=n,this._properties=new Map,this.configure(e)}configure(n){if(!io(n))return;const e=Object.keys(Zr.animation),o=this._properties;Object.getOwnPropertyNames(n).forEach(r=>{const s=n[r];if(!io(s))return;const l={};for(const h of e)l[h]=s[h];(Yo(s.properties)&&s.properties||[r]).forEach(h=>{(h===r||!o.has(h))&&o.set(h,l)})})}_animateOptions(n,e){const o=e.options,r=function Voe(t,n){if(!n)return;let e=t.options;if(e)return e.$shared&&(t.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e;t.options=n}(n,o);if(!r)return[];const s=this._createAnimations(r,o);return o.$shared&&function Boe(t,n){const e=[],o=Object.keys(n);for(let r=0;r<o.length;r++){const s=t[o[r]];s&&s.active()&&e.push(s.wait())}return Promise.all(e)}(n.options.$animations,o).then(()=>{n.options=o},()=>{}),s}_createAnimations(n,e){const o=this._properties,r=[],s=n.$animations||(n.$animations={}),l=Object.keys(e),h=Date.now();let g;for(g=l.length-1;g>=0;--g){const b=l[g];if("$"===b.charAt(0))continue;if("options"===b){r.push(...this._animateOptions(n,e));continue}const T=e[b];let I=s[b];const R=o.get(b);if(I){if(R&&I.active()){I.update(R,T,h);continue}I.cancel()}R&&R.duration?(s[b]=I=new Noe(R,n,b,T),r.push(I)):n[b]=T}return r}update(n,e){if(0===this._properties.size)return void Object.assign(n,e);const o=this._createAnimations(n,e);return o.length?(Vh.add(this._chart,o),!0):void 0}}function k3(t,n){const e=t&&t.options||{},o=e.reverse,r=void 0===e.min?n:0,s=void 0===e.max?n:0;return{start:o?s:r,end:o?r:s}}function A3(t,n){const e=[],o=t._getSortedDatasetMetas(n);let r,s;for(r=0,s=o.length;r<s;++r)e.push(o[r].index);return e}function P3(t,n,e,o={}){const r=t.keys,s="single"===o.mode;let l,h,g,b;if(null!==n){for(l=0,h=r.length;l<h;++l){if(g=+r[l],g===e){if(o.all)continue;break}b=t.values[g],Mr(b)&&(s||0===n||wd(n)===wd(b))&&(n+=b)}return n}}function O3(t,n){const e=t&&t.options.stacked;return e||void 0===e&&void 0!==n.stack}function Woe(t,n,e){const o=t[n]||(t[n]={});return o[e]||(o[e]={})}function R3(t,n,e,o){for(const r of n.getMatchingVisibleMetas(o).reverse()){const s=t[r.index];if(e&&s>0||!e&&s<0)return r.index}return null}function L3(t,n){const{chart:e,_cachedMeta:o}=t,r=e._stacks||(e._stacks={}),{iScale:s,vScale:l,index:h}=o,g=s.axis,b=l.axis,T=function $oe(t,n,e){return`${t.id}.${n.id}.${e.stack||e.type}`}(s,l,o),I=n.length;let R;for(let z=0;z<I;++z){const W=n[z],{[g]:X,[b]:ee}=W;R=(W._stacks||(W._stacks={}))[b]=Woe(r,T,X),R[h]=ee,R._top=R3(R,l,!0,o.type),R._bottom=R3(R,l,!1,o.type),(R._visualValues||(R._visualValues={}))[h]=ee}}function DM(t,n){const e=t.scales;return Object.keys(e).filter(o=>e[o].axis===n).shift()}function h0(t,n){const e=t.controller.index,o=t.vScale&&t.vScale.axis;if(o){n=n||t._parsed;for(const r of n){const s=r._stacks;if(!s||void 0===s[o]||void 0===s[o][e])return;delete s[o][e],void 0!==s[o]._visualValues&&void 0!==s[o]._visualValues[e]&&delete s[o]._visualValues[e]}}}const MM=t=>"reset"===t||"none"===t,F3=(t,n)=>n?t:Object.assign({},t);let xf=(()=>{class t{constructor(e,o){this.chart=e,this._ctx=e.ctx,this.index=o,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=O3(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&h0(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,o=this._cachedMeta,r=this.getDataset(),s=(R,z,W,X)=>"x"===R?z:"r"===R?X:W,l=o.xAxisID=Oi(r.xAxisID,DM(e,"x")),h=o.yAxisID=Oi(r.yAxisID,DM(e,"y")),g=o.rAxisID=Oi(r.rAxisID,DM(e,"r")),b=o.indexAxis,T=o.iAxisID=s(b,l,h,g),I=o.vAxisID=s(b,h,l,g);o.xScale=this.getScaleForId(l),o.yScale=this.getScaleForId(h),o.rScale=this.getScaleForId(g),o.iScale=this.getScaleForId(T),o.vScale=this.getScaleForId(I)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const o=this._cachedMeta;return e===o.iScale?o.vScale:o.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&qF(this._data,this),e._stacked&&h0(e)}_dataCheck(){const e=this.getDataset(),o=e.data||(e.data=[]),r=this._data;if(io(o))this._data=function Hoe(t){const n=Object.keys(t),e=new Array(n.length);let o,r,s;for(o=0,r=n.length;o<r;++o)s=n[o],e[o]={x:s,y:t[s]};return e}(o);else if(r!==o){if(r){qF(r,this);const s=this._cachedMeta;h0(s),s._parsed=[]}o&&Object.isExtensible(o)&&function Rie(t,n){t._chartjs?t._chartjs.listeners.push(n):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[n]}}),WF.forEach(e=>{const o="_onData"+pM(e),r=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...s){const l=r.apply(this,s);return t._chartjs.listeners.forEach(h=>{"function"==typeof h[o]&&h[o](...s)}),l}})}))}(o,this),this._syncList=[],this._data=o}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const o=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const l=o._stacked;o._stacked=O3(o.vScale,o),o.stack!==r.stack&&(s=!0,h0(o),o.stack=r.stack),this._resyncElements(e),(s||l!==o._stacked)&&L3(this,o._parsed)}configure(){const e=this.chart.config,o=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),o,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,o){const{_cachedMeta:r,_data:s}=this,{iScale:l,_stacked:h}=r,g=l.axis;let I,R,z,b=0===e&&o===s.length||r._sorted,T=e>0&&r._parsed[e-1];if(!1===this._parsing)r._parsed=s,r._sorted=!0,z=s;else{z=Yo(s[e])?this.parseArrayData(r,s,e,o):io(s[e])?this.parseObjectData(r,s,e,o):this.parsePrimitiveData(r,s,e,o);const W=()=>null===R[g]||T&&R[g]<T[g];for(I=0;I<o;++I)r._parsed[I+e]=R=z[I],b&&(W()&&(b=!1),T=R);r._sorted=b}h&&L3(this,z)}parsePrimitiveData(e,o,r,s){const{iScale:l,vScale:h}=e,g=l.axis,b=h.axis,T=l.getLabels(),I=l===h,R=new Array(s);let z,W,X;for(z=0,W=s;z<W;++z)X=z+r,R[z]={[g]:I||l.parse(T[X],X),[b]:h.parse(o[X],X)};return R}parseArrayData(e,o,r,s){const{xScale:l,yScale:h}=e,g=new Array(s);let b,T,I,R;for(b=0,T=s;b<T;++b)I=b+r,R=o[I],g[b]={x:l.parse(R[0],I),y:h.parse(R[1],I)};return g}parseObjectData(e,o,r,s){const{xScale:l,yScale:h}=e,{xAxisKey:g="x",yAxisKey:b="y"}=this._parsing,T=new Array(s);let I,R,z,W;for(I=0,R=s;I<R;++I)z=I+r,W=o[z],T[I]={x:l.parse(_f(W,g),z),y:h.parse(_f(W,b),z)};return T}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,o,r){const l=this._cachedMeta,h=o[e.axis];return P3({keys:A3(this.chart,!0),values:o._stacks[e.axis]._visualValues},h,l.index,{mode:r})}updateRangeFromParsed(e,o,r,s){const l=r[o.axis];let h=null===l?NaN:l;const g=s&&r._stacks[o.axis];s&&g&&(s.values=g,h=P3(s,l,this._cachedMeta.index)),e.min=Math.min(e.min,h),e.max=Math.max(e.max,h)}getMinMax(e,o){const r=this._cachedMeta,s=r._parsed,l=r._sorted&&e===r.iScale,h=s.length,g=this._getOtherScale(e),b=((t,n,e)=>t&&!n.hidden&&n._stacked&&{keys:A3(this.chart,!0),values:null})(o,r),T={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:I,max:R}=function Goe(t){const{min:n,max:e,minDefined:o,maxDefined:r}=t.getUserBounds();return{min:o?n:Number.NEGATIVE_INFINITY,max:r?e:Number.POSITIVE_INFINITY}}(g);let z,W;function X(){W=s[z];const ee=W[g.axis];return!Mr(W[e.axis])||I>ee||R<ee}for(z=0;z<h&&(X()||(this.updateRangeFromParsed(T,e,W,b),!l));++z);if(l)for(z=h-1;z>=0;--z)if(!X()){this.updateRangeFromParsed(T,e,W,b);break}return T}getAllParsedValues(e){const o=this._cachedMeta._parsed,r=[];let s,l,h;for(s=0,l=o.length;s<l;++s)h=o[s][e.axis],Mr(h)&&r.push(h);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const o=this._cachedMeta,r=o.iScale,s=o.vScale,l=this.getParsed(e);return{label:r?""+r.getLabelForValue(l[r.axis]):"",value:s?""+s.getLabelForValue(l[s.axis]):""}}_update(e){const o=this._cachedMeta;this.update(e||"default"),o._clip=function joe(t){let n,e,o,r;return io(t)?(n=t.top,e=t.right,o=t.bottom,r=t.left):n=e=o=r=t,{top:n,right:e,bottom:o,left:r,disabled:!1===t}}(Oi(this.options.clip,function Uoe(t,n,e){if(!1===e)return!1;const o=k3(t,e),r=k3(n,e);return{top:r.end,right:o.end,bottom:r.start,left:o.start}}(o.xScale,o.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,r=this._cachedMeta,s=r.data||[],l=this.chart.chartArea,h=[],g=this._drawStart||0,b=this._drawCount||s.length-g,T=this.options.drawActiveElementsOnTop;let I;for(r.dataset&&r.dataset.draw(e,l,g,b),I=g;I<g+b;++I){const R=s[I];R.hidden||(R.active&&T?h.push(R):R.draw(e,l))}for(I=0;I<h.length;++I)h[I].draw(e,l)}getStyle(e,o){const r=o?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,o,r){const s=this.getDataset();let l;if(e>=0&&e<this._cachedMeta.data.length){const h=this._cachedMeta.data[e];l=h.$context||(h.$context=function Zoe(t,n,e){return bf(t,{active:!1,dataIndex:n,parsed:void 0,raw:void 0,element:e,index:n,mode:"default",type:"data"})}(this.getContext(),e,h)),l.parsed=this.getParsed(e),l.raw=s.data[e],l.index=l.dataIndex=e}else l=this.$context||(this.$context=function qoe(t,n){return bf(t,{active:!1,dataset:void 0,datasetIndex:n,index:n,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),l.dataset=s,l.index=l.datasetIndex=this.index;return l.active=!!o,l.mode=r,l}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,o){return this._resolveElementOptions(this.dataElementType.id,o,e)}_resolveElementOptions(e,o="default",r){const s="active"===o,l=this._cachedDataOpts,h=e+"-"+o,g=l[h],b=this.enableOptionSharing&&gc(r);if(g)return F3(g,b);const T=this.chart.config,I=T.datasetElementScopeKeys(this._type,e),R=s?[`${e}Hover`,"hover",e,""]:[e,""],z=T.getOptionScopes(this.getDataset(),I),W=Object.keys(Zr.elements[e]),ee=T.resolveNamedOptions(z,W,()=>this.getContext(r,s,o),R);return ee.$shared&&(ee.$shared=b,l[h]=Object.freeze(F3(ee,b))),ee}_resolveAnimations(e,o,r){const s=this.chart,l=this._cachedDataOpts,h=`animation-${o}`,g=l[h];if(g)return g;let b;if(!1!==s.options.animation){const I=this.chart.config,R=I.datasetAnimationScopeKeys(this._type,o),z=I.getOptionScopes(this.getDataset(),R);b=I.createResolver(z,this.getContext(e,r,o))}const T=new I3(s,b&&b.animations);return b&&b._cacheable&&(l[h]=Object.freeze(T)),T}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,o){return!o||MM(e)||this.chart._animationsDisabled}_getSharedOptions(e,o){const r=this.resolveDataElementOptions(e,o),s=this._sharedOptions,l=this.getSharedOptions(r),h=this.includeOptions(o,l)||l!==s;return this.updateSharedOptions(l,o,r),{sharedOptions:l,includeOptions:h}}updateElement(e,o,r,s){MM(s)?Object.assign(e,r):this._resolveAnimations(o,s).update(e,r)}updateSharedOptions(e,o,r){e&&!MM(o)&&this._resolveAnimations(void 0,o).update(e,r)}_setStyle(e,o,r,s){e.active=s;const l=this.getStyle(o,s);this._resolveAnimations(o,r,s).update(e,{options:!s&&this.getSharedOptions(l)||l})}removeHoverStyle(e,o,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,o,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const o=this._data,r=this._cachedMeta.data;for(const[g,b,T]of this._syncList)this[g](b,T);this._syncList=[];const s=r.length,l=o.length,h=Math.min(l,s);h&&this.parse(0,h),l>s?this._insertElements(s,l-s,e):l<s&&this._removeElements(l,s-l)}_insertElements(e,o,r=!0){const s=this._cachedMeta,l=s.data,h=e+o;let g;const b=T=>{for(T.length+=o,g=T.length-1;g>=h;g--)T[g]=T[g-o]};for(b(l),g=e;g<h;++g)l[g]=new this.dataElementType;this._parsing&&b(s._parsed),this.parse(e,o),r&&this.updateElements(l,e,o,"reset")}updateElements(e,o,r,s){}_removeElements(e,o){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,o);r._stacked&&h0(r,s)}r.data.splice(e,o)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[o,r,s]=e;this[o](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,o){o&&this._sync(["_removeElements",e,o]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return Ln(t,"defaults",{}),Ln(t,"datasetElementType",null),Ln(t,"dataElementType",null),t})();function Yoe(t){const n=t.iScale,e=function Xoe(t,n){if(!t._cache.$bar){const e=t.getMatchingVisibleMetas(n);let o=[];for(let r=0,s=e.length;r<s;r++)o=o.concat(e[r].controller.getAllParsedValues(t));t._cache.$bar=ZF(o.sort((r,s)=>r-s))}return t._cache.$bar}(n,t.type);let r,s,l,h,o=n._length;const g=()=>{32767===l||-32768===l||(gc(h)&&(o=Math.min(o,Math.abs(l-h)||o)),h=l)};for(r=0,s=e.length;r<s;++r)l=n.getPixelForValue(e[r]),g();for(h=void 0,r=0,s=n.ticks.length;r<s;++r)l=n.getPixelForTick(r),g();return o}function z3(t,n,e,o){return Yo(t)?function ere(t,n,e,o){const r=e.parse(t[0],o),s=e.parse(t[1],o),l=Math.min(r,s),h=Math.max(r,s);let g=l,b=h;Math.abs(l)>Math.abs(h)&&(g=h,b=l),n[e.axis]=b,n._custom={barStart:g,barEnd:b,start:r,end:s,min:l,max:h}}(t,n,e,o):n[e.axis]=e.parse(t,o),n}function N3(t,n,e,o){const r=t.iScale,s=t.vScale,l=r.getLabels(),h=r===s,g=[];let b,T,I,R;for(b=e,T=e+o;b<T;++b)R=n[b],I={},I[r.axis]=h||r.parse(l[b],b),g.push(z3(R,I,s,b));return g}function IM(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function ire(t,n,e,o){let r=n.borderSkipped;const s={};if(!r)return void(t.borderSkipped=s);if(!0===r)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:l,end:h,reverse:g,top:b,bottom:T}=function nre(t){let n,e,o,r,s;return t.horizontal?(n=t.base>t.x,e="left",o="right"):(n=t.base<t.y,e="bottom",o="top"),n?(r="end",s="start"):(r="start",s="end"),{start:e,end:o,reverse:n,top:r,bottom:s}}(t);"middle"===r&&e&&(t.enableBorderRadius=!0,(e._top||0)===o?r=b:(e._bottom||0)===o?r=T:(s[B3(T,l,h,g)]=!0,r=b)),s[B3(r,l,h,g)]=!0,t.borderSkipped=s}function B3(t,n,e,o){return o?(t=function ore(t,n,e){return t===n?e:t===e?n:t}(t,n,e),t=V3(t,e,n)):t=V3(t,n,e),t}function V3(t,n,e){return"start"===t?n:"end"===t?e:t}function rre(t,{inflateAmount:n},e){t.inflateAmount="auto"===n?1===e?.33:0:n}let sre=(()=>{class t extends xf{parsePrimitiveData(e,o,r,s){return N3(e,o,r,s)}parseArrayData(e,o,r,s){return N3(e,o,r,s)}parseObjectData(e,o,r,s){const{iScale:l,vScale:h}=e,{xAxisKey:g="x",yAxisKey:b="y"}=this._parsing,T="x"===l.axis?g:b,I="x"===h.axis?g:b,R=[];let z,W,X,ee;for(z=r,W=r+s;z<W;++z)ee=o[z],X={},X[l.axis]=l.parse(_f(ee,T),z),R.push(z3(_f(ee,I),X,h,z));return R}updateRangeFromParsed(e,o,r,s){super.updateRangeFromParsed(e,o,r,s);const l=r._custom;l&&o===this._cachedMeta.vScale&&(e.min=Math.min(e.min,l.min),e.max=Math.max(e.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const o=this._cachedMeta,{iScale:r,vScale:s}=o,l=this.getParsed(e),h=l._custom,g=IM(h)?"["+h.start+", "+h.end+"]":""+s.getLabelForValue(l[s.axis]);return{label:""+r.getLabelForValue(l[r.axis]),value:g}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(e){const o=this._cachedMeta;this.updateElements(o.data,0,o.data.length,e)}updateElements(e,o,r,s){const l="reset"===s,{index:h,_cachedMeta:{vScale:g}}=this,b=g.getBasePixel(),T=g.isHorizontal(),I=this._getRuler(),{sharedOptions:R,includeOptions:z}=this._getSharedOptions(o,s);for(let W=o;W<o+r;W++){const X=this.getParsed(W),ee=l||yo(X[g.axis])?{base:b,head:b}:this._calculateBarValuePixels(W),le=this._calculateBarIndexPixels(W,I),ve=(X._stacks||{})[g.axis],xe={horizontal:T,base:ee.base,enableBorderRadius:!ve||IM(X._custom)||h===ve._top||h===ve._bottom,x:T?ee.head:le.center,y:T?le.center:ee.head,height:T?le.size:Math.abs(ee.size),width:T?Math.abs(ee.size):le.size};z&&(xe.options=R||this.resolveDataElementOptions(W,e[W].active?"active":s));const Be=xe.options||e[W].options;ire(xe,Be,ve,h),rre(xe,Be,I.ratio),this.updateElement(e[W],W,xe,s)}}_getStacks(e,o){const{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(b=>b.controller.options.grouped),l=r.options.stacked,h=[],g=b=>{const T=b.controller.getParsed(o),I=T&&T[b.vScale.axis];if(yo(I)||isNaN(I))return!0};for(const b of s)if((void 0===o||!g(b))&&((!1===l||-1===h.indexOf(b.stack)||void 0===l&&void 0===b.stack)&&h.push(b.stack),b.index===e))break;return h.length||h.push(void 0),h}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,o,r){const s=this._getStacks(e,r),l=void 0!==o?s.indexOf(o):-1;return-1===l?s.length-1:l}_getRuler(){const e=this.options,o=this._cachedMeta,r=o.iScale,s=[];let l,h;for(l=0,h=o.data.length;l<h;++l)s.push(r.getPixelForValue(this.getParsed(l)[r.axis],l));const g=e.barThickness;return{min:g||Yoe(o),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:g?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:o,_stacked:r,index:s},options:{base:l,minBarLength:h}}=this,g=l||0,b=this.getParsed(e),T=b._custom,I=IM(T);let X,ee,R=b[o.axis],z=0,W=r?this.applyStack(o,b,r):R;W!==R&&(z=W-R,W=R),I&&(R=T.barStart,W=T.barEnd-T.barStart,0!==R&&wd(R)!==wd(T.barEnd)&&(z=0),z+=R);const le=yo(l)||I?z:l;let ve=o.getPixelForValue(le);if(X=this.chart.getDataVisibility(e)?o.getPixelForValue(z+W):ve,ee=X-ve,Math.abs(ee)<h){ee=function tre(t,n,e){return 0!==t?wd(t):(n.isHorizontal()?1:-1)*(n.min>=e?1:-1)}(ee,o,g)*h,R===g&&(ve-=ee/2);const xe=o.getPixelForDecimal(0),Be=o.getPixelForDecimal(1),Ke=Math.min(xe,Be),ft=Math.max(xe,Be);ve=Math.max(Math.min(ve,ft),Ke),X=ve+ee,r&&!I&&(b._stacks[o.axis]._visualValues[s]=o.getValueForPixel(X)-o.getValueForPixel(ve))}if(ve===o.getPixelForValue(g)){const xe=wd(ee)*o.getLineWidthForValue(g)/2;ve+=xe,ee-=xe}return{size:ee,base:ve,head:X,center:X+ee/2}}_calculateBarIndexPixels(e,o){const r=o.scale,s=this.options,l=s.skipNull,h=Oi(s.maxBarThickness,1/0);let g,b;if(o.grouped){const T=l?this._getStackCount(e):o.stackCount,I="flex"===s.barThickness?function Joe(t,n,e,o){const r=n.pixels,s=r[t];let l=t>0?r[t-1]:null,h=t<r.length-1?r[t+1]:null;const g=e.categoryPercentage;null===l&&(l=s-(null===h?n.end-n.start:h-s)),null===h&&(h=s+s-l);const b=s-(s-Math.min(l,h))/2*g;return{chunk:Math.abs(h-l)/2*g/o,ratio:e.barPercentage,start:b}}(e,o,s,T):function Qoe(t,n,e,o){const r=e.barThickness;let s,l;return yo(r)?(s=n.min*e.categoryPercentage,l=e.barPercentage):(s=r*o,l=1),{chunk:s/o,ratio:l,start:n.pixels[t]-s/2}}(e,o,s,T),R=this._getStackIndex(this.index,this._cachedMeta.stack,l?e:void 0);g=I.start+I.chunk*R+I.chunk/2,b=Math.min(h,I.chunk*I.ratio)}else g=r.getPixelForValue(this.getParsed(e)[r.axis],e),b=Math.min(h,o.min*o.ratio);return{base:g-b/2,head:g+b/2,center:g,size:b}}draw(){const e=this._cachedMeta,o=e.vScale,r=e.data,s=r.length;let l=0;for(;l<s;++l)null!==this.getParsed(l)[o.axis]&&r[l].draw(this._ctx)}}return Ln(t,"id","bar"),Ln(t,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Ln(t,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}}),t})(),are=(()=>{class t extends xf{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,o,r,s){const l=super.parsePrimitiveData(e,o,r,s);for(let h=0;h<l.length;h++)l[h]._custom=this.resolveDataElementOptions(h+r).radius;return l}parseArrayData(e,o,r,s){const l=super.parseArrayData(e,o,r,s);for(let h=0;h<l.length;h++)l[h]._custom=Oi(o[r+h][2],this.resolveDataElementOptions(h+r).radius);return l}parseObjectData(e,o,r,s){const l=super.parseObjectData(e,o,r,s);for(let h=0;h<l.length;h++){const g=o[r+h];l[h]._custom=Oi(g&&g.r&&+g.r,this.resolveDataElementOptions(h+r).radius)}return l}getMaxOverflow(){const e=this._cachedMeta.data;let o=0;for(let r=e.length-1;r>=0;--r)o=Math.max(o,e[r].size(this.resolveDataElementOptions(r))/2);return o>0&&o}getLabelAndValue(e){const o=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:l}=o,h=this.getParsed(e),g=s.getLabelForValue(h.x),b=l.getLabelForValue(h.y),T=h._custom;return{label:r[e]||"",value:"("+g+", "+b+(T?", "+T:"")+")"}}update(e){const o=this._cachedMeta.data;this.updateElements(o,0,o.length,e)}updateElements(e,o,r,s){const l="reset"===s,{iScale:h,vScale:g}=this._cachedMeta,{sharedOptions:b,includeOptions:T}=this._getSharedOptions(o,s),I=h.axis,R=g.axis;for(let z=o;z<o+r;z++){const W=e[z],X=!l&&this.getParsed(z),ee={},le=ee[I]=l?h.getPixelForDecimal(.5):h.getPixelForValue(X[I]),ve=ee[R]=l?g.getBasePixel():g.getPixelForValue(X[R]);ee.skip=isNaN(le)||isNaN(ve),T&&(ee.options=b||this.resolveDataElementOptions(z,W.active?"active":s),l&&(ee.options.radius=0)),this.updateElement(W,z,ee,s)}}resolveDataElementOptions(e,o){const r=this.getParsed(e);let s=super.resolveDataElementOptions(e,o);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const l=s.radius;return"active"!==o&&(s.radius=0),s.radius+=Oi(r&&r._custom,l),s}}return Ln(t,"id","bubble"),Ln(t,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Ln(t,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}}),t})(),kM=(()=>{class t extends xf{constructor(e,o){super(e,o),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,o){const r=this.getDataset().data,s=this._cachedMeta;if(!1===this._parsing)s._parsed=r;else{let h,g,l=b=>+r[b];if(io(r[e])){const{key:b="value"}=this._parsing;l=T=>+_f(r[T],b)}for(h=e,g=e+o;h<g;++h)s._parsed[h]=l(h)}}_getRotation(){return gu(this.options.rotation-90)}_getCircumference(){return gu(this.options.circumference)}_getRotationExtents(){let e=Qo,o=-Qo;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const s=this.chart.getDatasetMeta(r).controller,l=s._getRotation(),h=s._getCircumference();e=Math.min(e,l),o=Math.max(o,l+h)}return{rotation:e,circumference:o-e}}update(e){const o=this.chart,{chartArea:r}=o,s=this._cachedMeta,l=s.data,h=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,g=Math.max((Math.min(r.width,r.height)-h)/2,0),b=Math.min(((t,n)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:+t/n)(this.options.cutout,g),1),T=this._getRingWeight(this.index),{circumference:I,rotation:R}=this._getRotationExtents(),{ratioX:z,ratioY:W,offsetX:X,offsetY:ee}=function lre(t,n,e){let o=1,r=1,s=0,l=0;if(n<Qo){const h=t,g=h+n,b=Math.cos(h),T=Math.sin(h),I=Math.cos(g),R=Math.sin(g),z=(xe,Be,Ke)=>r0(xe,h,g,!0)?1:Math.max(Be,Be*e,Ke,Ke*e),W=(xe,Be,Ke)=>r0(xe,h,g,!0)?-1:Math.min(Be,Be*e,Ke,Ke*e),X=z(0,b,I),ee=z(Ir,T,R),le=W(ar,b,I),ve=W(ar+Ir,T,R);o=(X-le)/2,r=(ee-ve)/2,s=-(X+le)/2,l=-(ee+ve)/2}return{ratioX:o,ratioY:r,offsetX:s,offsetY:l}}(R,I,b),xe=Math.max(Math.min((r.width-h)/z,(r.height-h)/W)/2,0),Be=zF(this.options.radius,xe),ft=(Be-Math.max(Be*b,0))/this._getVisibleDatasetWeightTotal();this.offsetX=X*Be,this.offsetY=ee*Be,s.total=this.calculateTotal(),this.outerRadius=Be-ft*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-ft*T,0),this.updateElements(l,0,l.length,e)}_circumference(e,o){const r=this.options,s=this._cachedMeta,l=this._getCircumference();return o&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||null===s._parsed[e]||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*l/Qo)}updateElements(e,o,r,s){const l="reset"===s,h=this.chart,g=h.chartArea,I=(g.left+g.right)/2,R=(g.top+g.bottom)/2,z=l&&h.options.animation.animateScale,W=z?0:this.innerRadius,X=z?0:this.outerRadius,{sharedOptions:ee,includeOptions:le}=this._getSharedOptions(o,s);let xe,ve=this._getRotation();for(xe=0;xe<o;++xe)ve+=this._circumference(xe,l);for(xe=o;xe<o+r;++xe){const Be=this._circumference(xe,l),Ke=e[xe],ft={x:I+this.offsetX,y:R+this.offsetY,startAngle:ve,endAngle:ve+Be,circumference:Be,outerRadius:X,innerRadius:W};le&&(ft.options=ee||this.resolveDataElementOptions(xe,Ke.active?"active":s)),ve+=Be,this.updateElement(Ke,xe,ft,s)}}calculateTotal(){const e=this._cachedMeta,o=e.data;let s,r=0;for(s=0;s<o.length;s++){const l=e._parsed[s];null!==l&&!isNaN(l)&&this.chart.getDataVisibility(s)&&!o[s].hidden&&(r+=Math.abs(l))}return r}calculateCircumference(e){const o=this._cachedMeta.total;return o>0&&!isNaN(e)?Qo*(Math.abs(e)/o):0}getLabelAndValue(e){const r=this.chart,s=r.data.labels||[],l=a0(this._cachedMeta._parsed[e],r.options.locale);return{label:s[e]||"",value:l}}getMaxBorderWidth(e){let o=0;const r=this.chart;let s,l,h,g,b;if(!e)for(s=0,l=r.data.datasets.length;s<l;++s)if(r.isDatasetVisible(s)){h=r.getDatasetMeta(s),e=h.data,g=h.controller;break}if(!e)return 0;for(s=0,l=e.length;s<l;++s)b=g.resolveDataElementOptions(s),"inner"!==b.borderAlign&&(o=Math.max(o,b.borderWidth||0,b.hoverBorderWidth||0));return o}getMaxOffset(e){let o=0;for(let r=0,s=e.length;r<s;++r){const l=this.resolveDataElementOptions(r);o=Math.max(o,l.offset||0,l.hoverOffset||0)}return o}_getRingWeightOffset(e){let o=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(o+=this._getRingWeight(r));return o}_getRingWeight(e){return Math.max(Oi(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return Ln(t,"id","doughnut"),Ln(t,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Ln(t,"descriptors",{_scriptable:n=>"spacing"!==n,_indexable:n=>"spacing"!==n}),Ln(t,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const e=n.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:o,color:r}}=n.legend.options;return e.labels.map((s,l)=>{const g=n.getDatasetMeta(0).controller.getStyle(l);return{text:s,fillStyle:g.backgroundColor,strokeStyle:g.borderColor,fontColor:r,lineWidth:g.borderWidth,pointStyle:o,hidden:!n.getDataVisibility(l),index:l}})}return[]}},onClick(n,e,o){o.chart.toggleDataVisibility(e.index),o.chart.update()}}}}),t})(),cre=(()=>{class t extends xf{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const o=this._cachedMeta,{dataset:r,data:s=[],_dataset:l}=o,h=this.chart._animationsDisabled;let{start:g,count:b}=YF(o,s,h);this._drawStart=g,this._drawCount=b,QF(o)&&(g=0,b=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!l._decimated,r.points=s;const T=this.resolveDatasetElementOptions(e);this.options.showLine||(T.borderWidth=0),T.segment=this.options.segment,this.updateElement(r,void 0,{animated:!h,options:T},e),this.updateElements(s,g,b,e)}updateElements(e,o,r,s){const l="reset"===s,{iScale:h,vScale:g,_stacked:b,_dataset:T}=this._cachedMeta,{sharedOptions:I,includeOptions:R}=this._getSharedOptions(o,s),z=h.axis,W=g.axis,{spanGaps:X,segment:ee}=this.options,le=my(X)?X:Number.POSITIVE_INFINITY,ve=this.chart._animationsDisabled||l||"none"===s,xe=o+r,Be=e.length;let Ke=o>0&&this.getParsed(o-1);for(let ft=0;ft<Be;++ft){const Vt=e[ft],Nt=ve?Vt:{};if(ft<o||ft>=xe){Nt.skip=!0;continue}const Ut=this.getParsed(ft),Pn=yo(Ut[W]),Qn=Nt[z]=h.getPixelForValue(Ut[z],ft),ki=Nt[W]=l||Pn?g.getBasePixel():g.getPixelForValue(b?this.applyStack(g,Ut,b):Ut[W],ft);Nt.skip=isNaN(Qn)||isNaN(ki)||Pn,Nt.stop=ft>0&&Math.abs(Ut[z]-Ke[z])>le,ee&&(Nt.parsed=Ut,Nt.raw=T.data[ft]),R&&(Nt.options=I||this.resolveDataElementOptions(ft,Vt.active?"active":s)),ve||this.updateElement(Vt,ft,Nt,s),Ke=Ut}}getMaxOverflow(){const e=this._cachedMeta,o=e.dataset,r=o.options&&o.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const l=s[0].size(this.resolveDataElementOptions(0)),h=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,l,h)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}return Ln(t,"id","line"),Ln(t,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Ln(t,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}}),t})(),U3=(()=>{class t extends xf{constructor(e,o){super(e,o),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const r=this.chart,s=r.data.labels||[],l=a0(this._cachedMeta._parsed[e].r,r.options.locale);return{label:s[e]||"",value:l}}parseObjectData(e,o,r,s){return m3.bind(this)(e,o,r,s)}update(e){const o=this._cachedMeta.data;this._updateRadius(),this.updateElements(o,0,o.length,e)}getMinMax(){const o={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return this._cachedMeta.data.forEach((r,s)=>{const l=this.getParsed(s).r;!isNaN(l)&&this.chart.getDataVisibility(s)&&(l<o.min&&(o.min=l),l>o.max&&(o.max=l))}),o}_updateRadius(){const e=this.chart,o=e.chartArea,r=e.options,s=Math.min(o.right-o.left,o.bottom-o.top),l=Math.max(s/2,0),g=(l-Math.max(r.cutoutPercentage?l/100*r.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=l-g*this.index,this.innerRadius=this.outerRadius-g}updateElements(e,o,r,s){const l="reset"===s,h=this.chart,b=h.options.animation,T=this._cachedMeta.rScale,I=T.xCenter,R=T.yCenter,z=T.getIndexAngle(0)-.5*ar;let X,W=z;const ee=360/this.countVisibleElements();for(X=0;X<o;++X)W+=this._computeAngle(X,s,ee);for(X=o;X<o+r;X++){const le=e[X];let ve=W,xe=W+this._computeAngle(X,s,ee),Be=h.getDataVisibility(X)?T.getDistanceFromCenterForValue(this.getParsed(X).r):0;W=xe,l&&(b.animateScale&&(Be=0),b.animateRotate&&(ve=xe=z));const Ke={x:I,y:R,innerRadius:0,outerRadius:Be,startAngle:ve,endAngle:xe,options:this.resolveDataElementOptions(X,le.active?"active":s)};this.updateElement(le,X,Ke,s)}}countVisibleElements(){let o=0;return this._cachedMeta.data.forEach((r,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&o++}),o}_computeAngle(e,o,r){return this.chart.getDataVisibility(e)?gu(this.resolveDataElementOptions(e,o).angle||r):0}}return Ln(t,"id","polarArea"),Ln(t,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Ln(t,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const e=n.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:o,color:r}}=n.legend.options;return e.labels.map((s,l)=>{const g=n.getDatasetMeta(0).controller.getStyle(l);return{text:s,fillStyle:g.backgroundColor,strokeStyle:g.borderColor,fontColor:r,lineWidth:g.borderWidth,pointStyle:o,hidden:!n.getDataVisibility(l),index:l}})}return[]}},onClick(n,e,o){o.chart.toggleDataVisibility(e.index),o.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}}),t})();var ure=Object.freeze({__proto__:null,BarController:sre,BubbleController:are,DoughnutController:kM,LineController:cre,PolarAreaController:U3,PieController:(()=>{class t extends kM{}return Ln(t,"id","pie"),Ln(t,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"}),t})(),RadarController:(()=>{class t extends xf{getLabelAndValue(e){const o=this._cachedMeta.vScale,r=this.getParsed(e);return{label:o.getLabels()[e],value:""+o.getLabelForValue(r[o.axis])}}parseObjectData(e,o,r,s){return m3.bind(this)(e,o,r,s)}update(e){const o=this._cachedMeta,r=o.dataset,s=o.data||[],l=o.iScale.getLabels();if(r.points=s,"resize"!==e){const h=this.resolveDatasetElementOptions(e);this.options.showLine||(h.borderWidth=0),this.updateElement(r,void 0,{_loop:!0,_fullLoop:l.length===s.length,options:h},e)}this.updateElements(s,0,s.length,e)}updateElements(e,o,r,s){const l=this._cachedMeta.rScale,h="reset"===s;for(let g=o;g<o+r;g++){const b=e[g],T=this.resolveDataElementOptions(g,b.active?"active":s),I=l.getPointPositionForValue(g,this.getParsed(g).r),R=h?l.xCenter:I.x,z=h?l.yCenter:I.y,W={x:R,y:z,angle:I.angle,skip:isNaN(R)||isNaN(z),options:T};this.updateElement(b,g,W,s)}}}return Ln(t,"id","radar"),Ln(t,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Ln(t,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}}),t})(),ScatterController:(()=>{class t extends xf{getLabelAndValue(e){const o=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:l}=o,h=this.getParsed(e),g=s.getLabelForValue(h.x),b=l.getLabelForValue(h.y);return{label:r[e]||"",value:"("+g+", "+b+")"}}update(e){const o=this._cachedMeta,{data:r=[]}=o,s=this.chart._animationsDisabled;let{start:l,count:h}=YF(o,r,s);if(this._drawStart=l,this._drawCount=h,QF(o)&&(l=0,h=r.length),this.options.showLine){const{dataset:g,_dataset:b}=o;g._chart=this.chart,g._datasetIndex=this.index,g._decimated=!!b._decimated,g.points=r;const T=this.resolveDatasetElementOptions(e);T.segment=this.options.segment,this.updateElement(g,void 0,{animated:!s,options:T},e)}this.updateElements(r,l,h,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,o,r,s){const l="reset"===s,{iScale:h,vScale:g,_stacked:b,_dataset:T}=this._cachedMeta,I=this.resolveDataElementOptions(o,s),R=this.getSharedOptions(I),z=this.includeOptions(s,R),W=h.axis,X=g.axis,{spanGaps:ee,segment:le}=this.options,ve=my(ee)?ee:Number.POSITIVE_INFINITY,xe=this.chart._animationsDisabled||l||"none"===s;let Be=o>0&&this.getParsed(o-1);for(let Ke=o;Ke<o+r;++Ke){const ft=e[Ke],Vt=this.getParsed(Ke),Nt=xe?ft:{},Ut=yo(Vt[X]),Pn=Nt[W]=h.getPixelForValue(Vt[W],Ke),Qn=Nt[X]=l||Ut?g.getBasePixel():g.getPixelForValue(b?this.applyStack(g,Vt,b):Vt[X],Ke);Nt.skip=isNaN(Pn)||isNaN(Qn)||Ut,Nt.stop=Ke>0&&Math.abs(Vt[W]-Be[W])>ve,le&&(Nt.parsed=Vt,Nt.raw=T.data[Ke]),z&&(Nt.options=R||this.resolveDataElementOptions(Ke,ft.active?"active":s)),xe||this.updateElement(ft,Ke,Nt,s),Be=Vt}this.updateSharedOptions(R,s,I)}getMaxOverflow(){const e=this._cachedMeta,o=e.data||[];if(!this.options.showLine){let g=0;for(let b=o.length-1;b>=0;--b)g=Math.max(g,o[b].size(this.resolveDataElementOptions(b))/2);return g>0&&g}const r=e.dataset,s=r.options&&r.options.borderWidth||0;if(!o.length)return s;const l=o[0].size(this.resolveDataElementOptions(0)),h=o[o.length-1].size(this.resolveDataElementOptions(o.length-1));return Math.max(s,l,h)/2}}return Ln(t,"id","scatter"),Ln(t,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Ln(t,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}}),t})()});function gg(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class AM{static override(n){Object.assign(AM.prototype,n)}constructor(n){this.options=n||{}}init(){}formats(){return gg()}parse(){return gg()}format(){return gg()}add(){return gg()}diff(){return gg()}startOf(){return gg()}endOf(){return gg()}}var dre__date=AM;function hre(t,n,e,o){const{controller:r,data:s,_sorted:l}=t,h=r._cachedMeta.iScale;if(h&&n===h.axis&&"r"!==n&&l&&s.length){const g=h._reversePixels?Pie:Bh;if(!o)return g(s,n,e);if(r._sharedOptions){const b=s[0],T="function"==typeof b.getRange&&b.getRange(n);if(T){const I=g(s,n,e-T),R=g(s,n,e+T);return{lo:I.lo,hi:R.hi}}}}return{lo:0,hi:s.length-1}}function p0(t,n,e,o,r){const s=t.getSortedVisibleDatasetMetas(),l=e[n];for(let h=0,g=s.length;h<g;++h){const{index:b,data:T}=s[h],{lo:I,hi:R}=hre(s[h],n,l,r);for(let z=I;z<=R;++z){const W=T[z];W.skip||o(W,b,z)}}}function PM(t,n,e,o,r){const s=[];return!r&&!t.isPointInArea(n)||p0(t,e,n,function(h,g,b){!r&&!c0(h,t.chartArea,0)||h.inRange(n.x,n.y,o)&&s.push({element:h,datasetIndex:g,index:b})},!0),s}function OM(t,n,e,o,r,s){return s||t.isPointInArea(n)?"r"!==e||o?function mre(t,n,e,o,r,s){let l=[];const h=function pre(t){const n=-1!==t.indexOf("x"),e=-1!==t.indexOf("y");return function(o,r){const s=n?Math.abs(o.x-r.x):0,l=e?Math.abs(o.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(l,2))}}(e);let g=Number.POSITIVE_INFINITY;return p0(t,e,n,function b(T,I,R){const z=T.inRange(n.x,n.y,r);if(o&&!z)return;const W=T.getCenterPoint(r);if(!s&&!t.isPointInArea(W)&&!z)return;const ee=h(n,W);ee<g?(l=[{element:T,datasetIndex:I,index:R}],g=ee):ee===g&&l.push({element:T,datasetIndex:I,index:R})}),l}(t,n,e,o,r,s):function fre(t,n,e,o){let r=[];return p0(t,e,n,function s(l,h,g){const{startAngle:b,endAngle:T}=l.getProps(["startAngle","endAngle"],o),{angle:I}=GF(l,{x:n.x,y:n.y});r0(I,b,T)&&r.push({element:l,datasetIndex:h,index:g})}),r}(t,n,e,r):[]}function j3(t,n,e,o,r){const s=[],l="x"===e?"inXRange":"inYRange";let h=!1;return p0(t,e,n,(g,b,T)=>{g[l](n[e],r)&&(s.push({element:g,datasetIndex:b,index:T}),h=h||g.inRange(n.x,n.y,r))}),o&&!h?[]:s}var gre={evaluateInteractionItems:p0,modes:{index(t,n,e,o){const r=fg(n,t),s=e.axis||"x",l=e.includeInvisible||!1,h=e.intersect?PM(t,r,s,o,l):OM(t,r,s,!1,o,l),g=[];return h.length?(t.getSortedVisibleDatasetMetas().forEach(b=>{const T=h[0].index,I=b.data[T];I&&!I.skip&&g.push({element:I,datasetIndex:b.index,index:T})}),g):[]},dataset(t,n,e,o){const r=fg(n,t),s=e.axis||"xy",l=e.includeInvisible||!1;let h=e.intersect?PM(t,r,s,o,l):OM(t,r,s,!1,o,l);if(h.length>0){const g=h[0].datasetIndex,b=t.getDatasetMeta(g).data;h=[];for(let T=0;T<b.length;++T)h.push({element:b[T],datasetIndex:g,index:T})}return h},point:(t,n,e,o)=>PM(t,fg(n,t),e.axis||"xy",o,e.includeInvisible||!1),nearest:(t,n,e,o)=>OM(t,fg(n,t),e.axis||"xy",e.intersect,o,e.includeInvisible||!1),x:(t,n,e,o)=>j3(t,fg(n,t),"x",e.intersect,o),y:(t,n,e,o)=>j3(t,fg(n,t),"y",e.intersect,o)}};const H3=["left","top","right","bottom"];function f0(t,n){return t.filter(e=>e.pos===n)}function $3(t,n){return t.filter(e=>-1===H3.indexOf(e.pos)&&e.box.axis===n)}function m0(t,n){return t.sort((e,o)=>{const r=n?o:e,s=n?e:o;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function G3(t,n,e,o){return Math.max(t[e],n[e])+Math.max(t[o],n[o])}function W3(t,n){t.top=Math.max(t.top,n.top),t.left=Math.max(t.left,n.left),t.bottom=Math.max(t.bottom,n.bottom),t.right=Math.max(t.right,n.right)}function xre(t,n,e,o){const{pos:r,box:s}=e,l=t.maxPadding;if(!io(r)){e.size&&(t[r]-=e.size);const I=o[e.stack]||{size:0,count:1};I.size=Math.max(I.size,e.horizontal?s.height:s.width),e.size=I.size/I.count,t[r]+=e.size}s.getPadding&&W3(l,s.getPadding());const h=Math.max(0,n.outerWidth-G3(l,t,"left","right")),g=Math.max(0,n.outerHeight-G3(l,t,"top","bottom")),b=h!==t.w,T=g!==t.h;return t.w=h,t.h=g,e.horizontal?{same:b,other:T}:{same:T,other:b}}function Cre(t,n){const e=n.maxPadding;return function o(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(l=>{s[l]=Math.max(n[l],e[l])}),s}(t?["left","right"]:["top","bottom"])}function g0(t,n,e,o){const r=[];let s,l,h,g,b,T;for(s=0,l=t.length,b=0;s<l;++s){h=t[s],g=h.box,g.update(h.width||n.w,h.height||n.h,Cre(h.horizontal,n));const{same:I,other:R}=xre(n,e,h,o);b|=I&&r.length,T=T||R,g.fullSize||r.push(h)}return b&&g0(r,n,e,o)||T}function uC(t,n,e,o,r){t.top=e,t.left=n,t.right=n+o,t.bottom=e+r,t.width=o,t.height=r}function q3(t,n,e,o){const r=e.padding;let{x:s,y:l}=n;for(const h of t){const g=h.box,b=o[h.stack]||{count:1,placed:0,weight:1},T=h.stackWeight/b.weight||1;if(h.horizontal){const I=n.w*T,R=b.size||g.height;gc(b.start)&&(l=b.start),g.fullSize?uC(g,r.left,l,e.outerWidth-r.right-r.left,R):uC(g,n.left+b.placed,l,I,R),b.start=l,b.placed+=I,l=g.bottom}else{const I=n.h*T,R=b.size||g.width;gc(b.start)&&(s=b.start),g.fullSize?uC(g,s,r.top,R,e.outerHeight-r.bottom-r.top):uC(g,s,n.top+b.placed,R,I),b.start=s,b.placed+=I,s=g.right}}n.x=s,n.y=l}var da={addBox(t,n){t.boxes||(t.boxes=[]),n.fullSize=n.fullSize||!1,n.position=n.position||"top",n.weight=n.weight||0,n._layers=n._layers||function(){return[{z:0,draw(e){n.draw(e)}}]},t.boxes.push(n)},removeBox(t,n){const e=t.boxes?t.boxes.indexOf(n):-1;-1!==e&&t.boxes.splice(e,1)},configure(t,n,e){n.fullSize=e.fullSize,n.position=e.position,n.weight=e.weight},update(t,n,e,o){if(!t)return;const r=ua(t.options.layout.padding),s=Math.max(n-r.width,0),l=Math.max(e-r.height,0),h=function bre(t){const n=function _re(t){const n=[];let e,o,r,s,l,h;for(e=0,o=(t||[]).length;e<o;++e)r=t[e],({position:s,options:{stack:l,stackWeight:h=1}}=r),n.push({index:e,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:l&&s+l,stackWeight:h});return n}(t),e=m0(n.filter(b=>b.box.fullSize),!0),o=m0(f0(n,"left"),!0),r=m0(f0(n,"right")),s=m0(f0(n,"top"),!0),l=m0(f0(n,"bottom")),h=$3(n,"x"),g=$3(n,"y");return{fullSize:e,leftAndTop:o.concat(s),rightAndBottom:r.concat(g).concat(l).concat(h),chartArea:f0(n,"chartArea"),vertical:o.concat(r).concat(g),horizontal:s.concat(l).concat(h)}}(t.boxes),g=h.vertical,b=h.horizontal;Ro(t.boxes,X=>{"function"==typeof X.beforeLayout&&X.beforeLayout()});const T=g.reduce((X,ee)=>ee.box.options&&!1===ee.box.options.display?X:X+1,0)||1,I=Object.freeze({outerWidth:n,outerHeight:e,padding:r,availableWidth:s,availableHeight:l,vBoxMaxWidth:s/2/T,hBoxMaxHeight:l/2}),R=Object.assign({},r);W3(R,ua(o));const z=Object.assign({maxPadding:R,w:s,h:l,x:r.left,y:r.top},r),W=function vre(t,n){const e=function yre(t){const n={};for(const e of t){const{stack:o,pos:r,stackWeight:s}=e;if(!o||!H3.includes(r))continue;const l=n[o]||(n[o]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=s}return n}(t),{vBoxMaxWidth:o,hBoxMaxHeight:r}=n;let s,l,h;for(s=0,l=t.length;s<l;++s){h=t[s];const{fullSize:g}=h.box,b=e[h.stack],T=b&&h.stackWeight/b.weight;h.horizontal?(h.width=T?T*o:g&&n.availableWidth,h.height=r):(h.width=o,h.height=T?T*r:g&&n.availableHeight)}return e}(g.concat(b),I);g0(h.fullSize,z,I,W),g0(g,z,I,W),g0(b,z,I,W)&&g0(g,z,I,W),function wre(t){const n=t.maxPadding;function e(o){const r=Math.max(n[o]-t[o],0);return t[o]+=r,r}t.y+=e("top"),t.x+=e("left"),e("right"),e("bottom")}(z),q3(h.leftAndTop,z,I,W),z.x+=z.w,z.y+=z.h,q3(h.rightAndBottom,z,I,W),t.chartArea={left:z.left,top:z.top,right:z.left+z.w,bottom:z.top+z.h,height:z.h,width:z.w},Ro(h.chartArea,X=>{const ee=X.box;Object.assign(ee,t.chartArea),ee.update(z.w,z.h,{left:0,top:0,right:0,bottom:0})})}};class Z3{acquireContext(n,e){}releaseContext(n){return!1}addEventListener(n,e,o){}removeEventListener(n,e,o){}getDevicePixelRatio(){return 1}getMaximumSize(n,e,o,r){return e=Math.max(0,e||n.width),o=o||n.height,{width:e,height:Math.max(0,r?Math.floor(e/r):o)}}isAttached(n){return!0}updateConfig(n){}}class Tre extends Z3{acquireContext(n){return n&&n.getContext&&n.getContext("2d")||null}updateConfig(n){n.options.animation=!1}}const dC="$chartjs",Ere={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},K3=t=>null===t||""===t,X3=!!Eoe&&{passive:!0};function Mre(t,n,e){t.canvas.removeEventListener(n,e,X3)}function hC(t,n){for(const e of t)if(e===n||e.contains(n))return!0}function kre(t,n,e){const o=t.canvas,r=new MutationObserver(s=>{let l=!1;for(const h of s)l=l||hC(h.addedNodes,o),l=l&&!hC(h.removedNodes,o);l&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}function Are(t,n,e){const o=t.canvas,r=new MutationObserver(s=>{let l=!1;for(const h of s)l=l||hC(h.removedNodes,o),l=l&&!hC(h.addedNodes,o);l&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}const _0=new Map;let Y3=0;function Q3(){const t=window.devicePixelRatio;t!==Y3&&(Y3=t,_0.forEach((n,e)=>{e.currentDevicePixelRatio!==t&&n()}))}function Rre(t,n,e){const o=t.canvas,r=o&&SM(o);if(!r)return;const s=XF((h,g)=>{const b=r.clientWidth;e(h,g),b<r.clientWidth&&e()},window),l=new ResizeObserver(h=>{const g=h[0],b=g.contentRect.width,T=g.contentRect.height;0===b&&0===T||s(b,T)});return l.observe(r),function Pre(t,n){_0.size||window.addEventListener("resize",Q3),_0.set(t,n)}(t,s),l}function RM(t,n,e){e&&e.disconnect(),"resize"===n&&function Ore(t){_0.delete(t),_0.size||window.removeEventListener("resize",Q3)}(t)}function Lre(t,n,e){const o=t.canvas,r=XF(s=>{null!==t.ctx&&e(function Ire(t,n){const e=Ere[t.type]||t.type,{x:o,y:r}=fg(t,n);return{type:e,chart:n,native:t,x:void 0!==o?o:null,y:void 0!==r?r:null}}(s,t))},t);return function Dre(t,n,e){t.addEventListener(n,e,X3)}(o,n,r),r}class Fre extends Z3{acquireContext(n,e){const o=n&&n.getContext&&n.getContext("2d");return o&&o.canvas===n?(function Sre(t,n){const e=t.style,o=t.getAttribute("height"),r=t.getAttribute("width");if(t[dC]={initial:{height:o,width:r,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",K3(r)){const s=v3(t,"width");void 0!==s&&(t.width=s)}if(K3(o))if(""===t.style.height)t.height=t.width/(n||2);else{const s=v3(t,"height");void 0!==s&&(t.height=s)}}(n,e),o):null}releaseContext(n){const e=n.canvas;if(!e[dC])return!1;const o=e[dC].initial;["height","width"].forEach(s=>{const l=o[s];yo(l)?e.removeAttribute(s):e.setAttribute(s,l)});const r=o.style||{};return Object.keys(r).forEach(s=>{e.style[s]=r[s]}),e.width=e.width,delete e[dC],!0}addEventListener(n,e,o){this.removeEventListener(n,e),(n.$proxies||(n.$proxies={}))[e]=({attach:kre,detach:Are,resize:Rre}[e]||Lre)(n,e,o)}removeEventListener(n,e){const o=n.$proxies||(n.$proxies={}),r=o[e];r&&(({attach:RM,detach:RM,resize:RM}[e]||Mre)(n,e,r),o[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(n,e,o,r){return function Toe(t,n,e,o){const r=lC(t),s=pg(r,"margin"),l=aC(r.maxWidth,t,"clientWidth")||eC,h=aC(r.maxHeight,t,"clientHeight")||eC,g=function Coe(t,n,e){let o,r;if(void 0===n||void 0===e){const s=SM(t);if(s){const l=s.getBoundingClientRect(),h=lC(s),g=pg(h,"border","width"),b=pg(h,"padding");n=l.width-b.width-g.width,e=l.height-b.height-g.height,o=aC(h.maxWidth,s,"clientWidth"),r=aC(h.maxHeight,s,"clientHeight")}else n=t.clientWidth,e=t.clientHeight}return{width:n,height:e,maxWidth:o||eC,maxHeight:r||eC}}(t,n,e);let{width:b,height:T}=g;if("content-box"===r.boxSizing){const R=pg(r,"border","width"),z=pg(r,"padding");b-=z.width+R.width,T-=z.height+R.height}return b=Math.max(0,b-s.width),T=Math.max(0,o?b/o:T-s.height),b=cC(Math.min(b,l,g.maxWidth)),T=cC(Math.min(T,h,g.maxHeight)),b&&!T&&(T=cC(b/2)),(void 0!==n||void 0!==e)&&o&&g.height&&T>g.height&&(T=g.height,b=cC(Math.floor(T*o))),{width:b,height:T}}(n,e,o,r)}isAttached(n){const e=SM(n);return!(!e||!e.isConnected)}}class _u{constructor(){Ln(this,"active",!1)}tooltipPosition(n){const{x:e,y:o}=this.getProps(["x","y"],n);return{x:e,y:o}}hasValue(){return my(this.x)&&my(this.y)}getProps(n,e){const o=this.$animations;if(!e||!o)return this;const r={};return n.forEach(s=>{r[s]=o[s]&&o[s].active()?o[s]._to:this[s]}),r}}function pC(t,n,e,o,r){const s=Oi(o,0),l=Math.min(Oi(r,t.length),t.length);let g,b,T,h=0;for(e=Math.ceil(e),r&&(g=r-o,e=g/Math.floor(g/e)),T=s;T<0;)h++,T=Math.round(s+h*e);for(b=Math.max(s,0);b<l;b++)b===T&&(n.push(t[b]),h++,T=Math.round(s+h*e))}Ln(_u,"defaults",{}),Ln(_u,"defaultRoutes",void 0);const $re=t=>"left"===t?"right":"right"===t?"left":t,J3=(t,n,e)=>"top"===n||"left"===n?t[n]+e:t[n]-e,ez=(t,n)=>Math.min(n||t,t);function tz(t,n){const e=[],o=t.length/n,r=t.length;let s=0;for(;s<r;s+=o)e.push(t[Math.floor(s)]);return e}function Gre(t,n,e){const o=t.ticks.length,r=Math.min(n,o-1),s=t._startPixel,l=t._endPixel,h=1e-6;let b,g=t.getPixelForTick(r);if(!(e&&(b=1===o?Math.max(g-s,l-g):0===n?(t.getPixelForTick(1)-g)/2:(g-t.getPixelForTick(r-1))/2,g+=r<n?b:-b,g<s-h||g>l+h)))return g}function y0(t){return t.drawTicks?t.tickLength:0}function nz(t,n){if(!t.display)return 0;const e=ys(t.font,n),o=ua(t.padding);return(Yo(t.text)?t.text.length:1)*e.lineHeight+o.height}function Kre(t,n,e){let o=_M(t);return(e&&"right"!==n||!e&&"right"===n)&&(o=$re(o)),o}class _g extends _u{constructor(n){super(),this.id=n.id,this.type=n.type,this.options=void 0,this.ctx=n.ctx,this.chart=n.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(n){this.options=n.setContext(this.getContext()),this.axis=n.axis,this._userMin=this.parse(n.min),this._userMax=this.parse(n.max),this._suggestedMin=this.parse(n.suggestedMin),this._suggestedMax=this.parse(n.suggestedMax)}parse(n,e){return n}getUserBounds(){let{_userMin:n,_userMax:e,_suggestedMin:o,_suggestedMax:r}=this;return n=kl(n,Number.POSITIVE_INFINITY),e=kl(e,Number.NEGATIVE_INFINITY),o=kl(o,Number.POSITIVE_INFINITY),r=kl(r,Number.NEGATIVE_INFINITY),{min:kl(n,o),max:kl(e,r),minDefined:Mr(n),maxDefined:Mr(e)}}getMinMax(n){let l,{min:e,max:o,minDefined:r,maxDefined:s}=this.getUserBounds();if(r&&s)return{min:e,max:o};const h=this.getMatchingVisibleMetas();for(let g=0,b=h.length;g<b;++g)l=h[g].controller.getMinMax(this,n),r||(e=Math.min(e,l.min)),s||(o=Math.max(o,l.max));return e=s&&e>o?o:e,o=r&&e>o?e:o,{min:kl(e,kl(o,e)),max:kl(o,kl(e,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const n=this.chart.data;return this.options.labels||(this.isHorizontal()?n.xLabels:n.yLabels)||n.labels||[]}getLabelItems(n=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(n))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){$o(this.options.beforeUpdate,[this])}update(n,e,o){const{beginAtZero:r,grace:s,ticks:l}=this.options,h=l.sampleSize;this.beforeUpdate(),this.maxWidth=n,this.maxHeight=e,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function noe(t,n,e){const{min:o,max:r}=t,s=zF(n,(r-o)/2),l=(h,g)=>e&&0===h?0:h+g;return{min:l(o,-Math.abs(s)),max:l(r,s)}}(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const g=h<this.ticks.length;this._convertTicksToLabels(g?tz(this.ticks,h):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||"auto"===l.source)&&(this.ticks=function Nre(t,n){const e=t.options.ticks,o=function Bre(t){const n=t.options.offset,e=t._tickSize();return Math.floor(Math.min(t._length/e+(n?0:1),t._maxLength/e))}(t),r=Math.min(e.maxTicksLimit||o,o),s=e.major.enabled?function Ure(t){const n=[];let e,o;for(e=0,o=t.length;e<o;e++)t[e].major&&n.push(e);return n}(n):[],l=s.length,h=s[0],g=s[l-1],b=[];if(l>r)return function jre(t,n,e,o){let l,r=0,s=e[0];for(o=Math.ceil(o),l=0;l<t.length;l++)l===s&&(n.push(t[l]),r++,s=e[r*o])}(n,b,s,l/r),b;const T=function Vre(t,n,e){const o=function Hre(t){const n=t.length;let e,o;if(n<2)return!1;for(o=t[0],e=1;e<n;++e)if(t[e]-t[e-1]!==o)return!1;return o}(t),r=n.length/e;if(!o)return Math.max(r,1);const s=function Mie(t){const n=[],e=Math.sqrt(t);let o;for(o=1;o<e;o++)t%o==0&&(n.push(o),n.push(t/o));return e===(0|e)&&n.push(e),n.sort((r,s)=>r-s).pop(),n}(o);for(let l=0,h=s.length-1;l<h;l++){const g=s[l];if(g>r)return g}return Math.max(r,1)}(s,n,r);if(l>0){let I,R;const z=l>1?Math.round((g-h)/(l-1)):null;for(pC(n,b,T,yo(z)?0:h-z,h),I=0,R=l-1;I<R;I++)pC(n,b,T,s[I],s[I+1]);return pC(n,b,T,g,yo(z)?n.length:g+z),b}return pC(n,b,T),b}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),g&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,o,n=this.options.reverse;this.isHorizontal()?(e=this.left,o=this.right):(e=this.top,o=this.bottom,n=!n),this._startPixel=e,this._endPixel=o,this._reversePixels=n,this._length=o-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){$o(this.options.afterUpdate,[this])}beforeSetDimensions(){$o(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){$o(this.options.afterSetDimensions,[this])}_callHooks(n){this.chart.notifyPlugins(n,this.getContext()),$o(this.options[n],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){$o(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(n){const e=this.options.ticks;let o,r,s;for(o=0,r=n.length;o<r;o++)s=n[o],s.label=$o(e.callback,[s.value,o,n],this)}afterTickToLabelConversion(){$o(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){$o(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const n=this.options,e=n.ticks,o=ez(this.ticks.length,n.ticks.maxTicksLimit),r=e.minRotation||0,s=e.maxRotation;let h,g,b,l=r;if(!this._isVisible()||!e.display||r>=s||o<=1||!this.isHorizontal())return void(this.labelRotation=r);const T=this._getLabelSizes(),I=T.widest.width,R=T.highest.height,z=As(this.chart.width-I,0,this.maxWidth);h=n.offset?this.maxWidth/o:z/(o-1),I+6>h&&(h=z/(o-(n.offset?.5:1)),g=this.maxHeight-y0(n.grid)-e.padding-nz(n.title,this.chart.options.font),b=Math.sqrt(I*I+R*R),l=fM(Math.min(Math.asin(As((T.highest.height+6)/h,-1,1)),Math.asin(As(g/b,-1,1))-Math.asin(As(R/b,-1,1)))),l=Math.max(r,Math.min(s,l))),this.labelRotation=l}afterCalculateLabelRotation(){$o(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){$o(this.options.beforeFit,[this])}fit(){const n={width:0,height:0},{chart:e,options:{ticks:o,title:r,grid:s}}=this,l=this._isVisible(),h=this.isHorizontal();if(l){const g=nz(r,e.options.font);if(h?(n.width=this.maxWidth,n.height=y0(s)+g):(n.height=this.maxHeight,n.width=y0(s)+g),o.display&&this.ticks.length){const{first:b,last:T,widest:I,highest:R}=this._getLabelSizes(),z=2*o.padding,W=gu(this.labelRotation),X=Math.cos(W),ee=Math.sin(W);h?n.height=Math.min(this.maxHeight,n.height+(o.mirror?0:ee*I.width+X*R.height)+z):n.width=Math.min(this.maxWidth,n.width+(o.mirror?0:X*I.width+ee*R.height)+z),this._calculatePadding(b,T,ee,X)}}this._handleMargins(),h?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=n.height):(this.width=n.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(n,e,o,r){const{ticks:{align:s,padding:l},position:h}=this.options,g=0!==this.labelRotation,b="top"!==h&&"x"===this.axis;if(this.isHorizontal()){const T=this.getPixelForTick(0)-this.left,I=this.right-this.getPixelForTick(this.ticks.length-1);let R=0,z=0;g?b?(R=r*n.width,z=o*e.height):(R=o*n.height,z=r*e.width):"start"===s?z=e.width:"end"===s?R=n.width:"inner"!==s&&(R=n.width/2,z=e.width/2),this.paddingLeft=Math.max((R-T+l)*this.width/(this.width-T),0),this.paddingRight=Math.max((z-I+l)*this.width/(this.width-I),0)}else{let T=e.height/2,I=n.height/2;"start"===s?(T=0,I=n.height):"end"===s&&(T=e.height,I=0),this.paddingTop=T+l,this.paddingBottom=I+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){$o(this.options.afterFit,[this])}isHorizontal(){const{axis:n,position:e}=this.options;return"top"===e||"bottom"===e||"x"===n}isFullSize(){return this.options.fullSize}_convertTicksToLabels(n){let e,o;for(this.beforeTickToLabelConversion(),this.generateTickLabels(n),e=0,o=n.length;e<o;e++)yo(n[e].label)&&(n.splice(e,1),o--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let n=this._labelSizes;if(!n){const e=this.options.ticks.sampleSize;let o=this.ticks;e<o.length&&(o=tz(o,e)),this._labelSizes=n=this._computeLabelSizes(o,o.length,this.options.ticks.maxTicksLimit)}return n}_computeLabelSizes(n,e,o){const{ctx:r,_longestTextCache:s}=this,l=[],h=[],g=Math.floor(e/ez(e,o));let I,R,z,W,X,ee,le,ve,xe,Be,Ke,b=0,T=0;for(I=0;I<e;I+=g){if(W=n[I].label,X=this._resolveTickFontOptions(I),r.font=ee=X.string,le=s[ee]=s[ee]||{data:{},gc:[]},ve=X.lineHeight,xe=Be=0,yo(W)||Yo(W)){if(Yo(W))for(R=0,z=W.length;R<z;++R)Ke=W[R],!yo(Ke)&&!Yo(Ke)&&(xe=iC(r,le.data,le.gc,xe,Ke),Be+=ve)}else xe=iC(r,le.data,le.gc,xe,W),Be=ve;l.push(xe),h.push(Be),b=Math.max(xe,b),T=Math.max(Be,T)}!function Wre(t,n){Ro(t,e=>{const o=e.gc,r=o.length/2;let s;if(r>n){for(s=0;s<r;++s)delete e.data[o[s]];o.splice(0,r)}})}(s,e);const ft=l.indexOf(b),Vt=h.indexOf(T),Nt=Ut=>({width:l[Ut]||0,height:h[Ut]||0});return{first:Nt(0),last:Nt(e-1),widest:Nt(ft),highest:Nt(Vt),widths:l,heights:h}}getLabelForValue(n){return n}getPixelForValue(n,e){return NaN}getValueForPixel(n){}getPixelForTick(n){const e=this.ticks;return n<0||n>e.length-1?null:this.getPixelForValue(e[n].value)}getPixelForDecimal(n){this._reversePixels&&(n=1-n);const e=this._startPixel+n*this._length;return function Aie(t){return As(t,-32768,32767)}(this._alignToPixels?ug(this.chart,e,0):e)}getDecimalForPixel(n){const e=(n-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:n,max:e}=this;return n<0&&e<0?e:n>0&&e>0?n:0}getContext(n){const e=this.ticks||[];if(n>=0&&n<e.length){const o=e[n];return o.$context||(o.$context=function Zre(t,n,e){return bf(t,{tick:e,index:n,type:"tick"})}(this.getContext(),n,o))}return this.$context||(this.$context=function qre(t,n){return bf(t,{scale:n,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const n=this.options.ticks,e=gu(this.labelRotation),o=Math.abs(Math.cos(e)),r=Math.abs(Math.sin(e)),s=this._getLabelSizes(),l=n.autoSkipPadding||0,h=s?s.widest.width+l:0,g=s?s.highest.height+l:0;return this.isHorizontal()?g*o>h*r?h/o:g/r:g*r<h*o?g/o:h/r}_isVisible(){const n=this.options.display;return"auto"!==n?!!n:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(n){const e=this.axis,o=this.chart,r=this.options,{grid:s,position:l,border:h}=r,g=s.offset,b=this.isHorizontal(),I=this.ticks.length+(g?1:0),R=y0(s),z=[],W=h.setContext(this.getContext()),X=W.display?W.width:0,ee=X/2,le=function(en){return ug(o,en,X)};let ve,xe,Be,Ke,ft,Vt,Nt,Ut,Pn,Qn,ki,Jo;if("top"===l)ve=le(this.bottom),Vt=this.bottom-R,Ut=ve-ee,Qn=le(n.top)+ee,Jo=n.bottom;else if("bottom"===l)ve=le(this.top),Qn=n.top,Jo=le(n.bottom)-ee,Vt=ve+ee,Ut=this.top+R;else if("left"===l)ve=le(this.right),ft=this.right-R,Nt=ve-ee,Pn=le(n.left)+ee,ki=n.right;else if("right"===l)ve=le(this.left),Pn=n.left,ki=le(n.right)-ee,ft=ve+ee,Nt=this.left+R;else if("x"===e){if("center"===l)ve=le((n.top+n.bottom)/2+.5);else if(io(l)){const en=Object.keys(l)[0];ve=le(this.chart.scales[en].getPixelForValue(l[en]))}Qn=n.top,Jo=n.bottom,Vt=ve+ee,Ut=Vt+R}else if("y"===e){if("center"===l)ve=le((n.left+n.right)/2);else if(io(l)){const en=Object.keys(l)[0];ve=le(this.chart.scales[en].getPixelForValue(l[en]))}ft=ve-ee,Nt=ft-R,Pn=n.left,ki=n.right}const ha=Oi(r.ticks.maxTicksLimit,I),So=Math.max(1,Math.ceil(I/ha));for(xe=0;xe<I;xe+=So){const en=this.getContext(xe),yn=s.setContext(en),Hn=h.setContext(en),li=yn.lineWidth,er=yn.color,Oa=Hn.dash||[],rs=Hn.dashOffset,sl=yn.tickWidth,Lo=yn.tickColor,Cf=yn.tickBorderDash||[],vg=yn.tickBorderDashOffset;Be=Gre(this,xe,g),void 0!==Be&&(Ke=ug(o,Be,li),b?ft=Nt=Pn=ki=Ke:Vt=Ut=Qn=Jo=Ke,z.push({tx1:ft,ty1:Vt,tx2:Nt,ty2:Ut,x1:Pn,y1:Qn,x2:ki,y2:Jo,width:li,color:er,borderDash:Oa,borderDashOffset:rs,tickWidth:sl,tickColor:Lo,tickBorderDash:Cf,tickBorderDashOffset:vg}))}return this._ticksLength=I,this._borderValue=ve,z}_computeLabelItems(n){const e=this.axis,o=this.options,{position:r,ticks:s}=o,l=this.isHorizontal(),h=this.ticks,{align:g,crossAlign:b,padding:T,mirror:I}=s,R=y0(o.grid),z=R+T,W=I?-T:z,X=-gu(this.labelRotation),ee=[];let le,ve,xe,Be,Ke,ft,Vt,Nt,Ut,Pn,Qn,ki,Jo="middle";if("top"===r)ft=this.bottom-W,Vt=this._getXAxisLabelAlignment();else if("bottom"===r)ft=this.top+W,Vt=this._getXAxisLabelAlignment();else if("left"===r){const So=this._getYAxisLabelAlignment(R);Vt=So.textAlign,Ke=So.x}else if("right"===r){const So=this._getYAxisLabelAlignment(R);Vt=So.textAlign,Ke=So.x}else if("x"===e){if("center"===r)ft=(n.top+n.bottom)/2+z;else if(io(r)){const So=Object.keys(r)[0];ft=this.chart.scales[So].getPixelForValue(r[So])+z}Vt=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===r)Ke=(n.left+n.right)/2-z;else if(io(r)){const So=Object.keys(r)[0];Ke=this.chart.scales[So].getPixelForValue(r[So])}Vt=this._getYAxisLabelAlignment(R).textAlign}"y"===e&&("start"===g?Jo="top":"end"===g&&(Jo="bottom"));const ha=this._getLabelSizes();for(le=0,ve=h.length;le<ve;++le){xe=h[le],Be=xe.label;const So=s.setContext(this.getContext(le));Nt=this.getPixelForTick(le)+s.labelOffset,Ut=this._resolveTickFontOptions(le),Pn=Ut.lineHeight,Qn=Yo(Be)?Be.length:1;const en=Qn/2,yn=So.color,Hn=So.textStrokeColor,li=So.textStrokeWidth;let Oa,er=Vt;if(l?(Ke=Nt,"inner"===Vt&&(er=le===ve-1?this.options.reverse?"left":"right":0===le?this.options.reverse?"right":"left":"center"),ki="top"===r?"near"===b||0!==X?-Qn*Pn+Pn/2:"center"===b?-ha.highest.height/2-en*Pn+Pn:Pn/2-ha.highest.height:"near"===b||0!==X?Pn/2:"center"===b?ha.highest.height/2-en*Pn:ha.highest.height-Qn*Pn,I&&(ki*=-1),0!==X&&!So.showLabelBackdrop&&(Ke+=Pn/2*Math.sin(X))):(ft=Nt,ki=(1-Qn)*Pn/2),So.showLabelBackdrop){const rs=ua(So.backdropPadding),sl=ha.heights[le],Lo=ha.widths[le];let Cf=ki-rs.top,vg=0-rs.left;switch(Jo){case"middle":Cf-=sl/2;break;case"bottom":Cf-=sl}switch(Vt){case"center":vg-=Lo/2;break;case"right":vg-=Lo}Oa={left:vg,top:Cf,width:Lo+rs.width,height:sl+rs.height,color:So.backdropColor}}ee.push({label:Be,font:Ut,textOffset:ki,options:{rotation:X,color:yn,strokeColor:Hn,strokeWidth:li,textAlign:er,textBaseline:Jo,translation:[Ke,ft],backdrop:Oa}})}return ee}_getXAxisLabelAlignment(){const{position:n,ticks:e}=this.options;if(-gu(this.labelRotation))return"top"===n?"left":"right";let r="center";return"start"===e.align?r="left":"end"===e.align?r="right":"inner"===e.align&&(r="inner"),r}_getYAxisLabelAlignment(n){const{position:e,ticks:{crossAlign:o,mirror:r,padding:s}}=this.options,h=n+s,g=this._getLabelSizes().widest.width;let b,T;return"left"===e?r?(T=this.right+s,"near"===o?b="left":"center"===o?(b="center",T+=g/2):(b="right",T+=g)):(T=this.right-h,"near"===o?b="right":"center"===o?(b="center",T-=g/2):(b="left",T=this.left)):"right"===e?r?(T=this.left+s,"near"===o?b="right":"center"===o?(b="center",T-=g/2):(b="left",T-=g)):(T=this.left+h,"near"===o?b="left":"center"===o?(b="center",T+=g/2):(b="right",T=this.right)):b="right",{textAlign:b,x:T}}_computeLabelArea(){if(this.options.ticks.mirror)return;const n=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:n.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:n.width}:void 0}drawBackground(){const{ctx:n,options:{backgroundColor:e},left:o,top:r,width:s,height:l}=this;e&&(n.save(),n.fillStyle=e,n.fillRect(o,r,s,l),n.restore())}getLineWidthForValue(n){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const r=this.ticks.findIndex(s=>s.value===n);return r>=0?e.setContext(this.getContext(r)).lineWidth:0}drawGrid(n){const e=this.options.grid,o=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(n));let s,l;const h=(g,b,T)=>{!T.width||!T.color||(o.save(),o.lineWidth=T.width,o.strokeStyle=T.color,o.setLineDash(T.borderDash||[]),o.lineDashOffset=T.borderDashOffset,o.beginPath(),o.moveTo(g.x,g.y),o.lineTo(b.x,b.y),o.stroke(),o.restore())};if(e.display)for(s=0,l=r.length;s<l;++s){const g=r[s];e.drawOnChartArea&&h({x:g.x1,y:g.y1},{x:g.x2,y:g.y2},g),e.drawTicks&&h({x:g.tx1,y:g.ty1},{x:g.tx2,y:g.ty2},{color:g.tickColor,width:g.tickWidth,borderDash:g.tickBorderDash,borderDashOffset:g.tickBorderDashOffset})}}drawBorder(){const{chart:n,ctx:e,options:{border:o,grid:r}}=this,s=o.setContext(this.getContext()),l=o.display?s.width:0;if(!l)return;const h=r.setContext(this.getContext(0)).lineWidth,g=this._borderValue;let b,T,I,R;this.isHorizontal()?(b=ug(n,this.left,l)-l/2,T=ug(n,this.right,h)+h/2,I=R=g):(I=ug(n,this.top,l)-l/2,R=ug(n,this.bottom,h)+h/2,b=T=g),e.save(),e.lineWidth=s.width,e.strokeStyle=s.color,e.beginPath(),e.moveTo(b,I),e.lineTo(T,R),e.stroke(),e.restore()}drawLabels(n){if(!this.options.ticks.display)return;const o=this.ctx,r=this._computeLabelArea();r&&oC(o,r);const s=this.getLabelItems(n);for(const l of s)dg(o,l.label,0,l.textOffset,l.font,l.options);r&&rC(o)}drawTitle(){const{ctx:n,options:{position:e,title:o,reverse:r}}=this;if(!o.display)return;const s=ys(o.font),l=ua(o.padding),h=o.align;let g=s.lineHeight/2;"bottom"===e||"center"===e||io(e)?(g+=l.bottom,Yo(o.text)&&(g+=s.lineHeight*(o.text.length-1))):g+=l.top;const{titleX:b,titleY:T,maxWidth:I,rotation:R}=function Xre(t,n,e,o){const{top:r,left:s,bottom:l,right:h,chart:g}=t,{chartArea:b,scales:T}=g;let R,z,W,I=0;const X=l-r,ee=h-s;if(t.isHorizontal()){if(z=ca(o,s,h),io(e)){const le=Object.keys(e)[0];W=T[le].getPixelForValue(e[le])+X-n}else W="center"===e?(b.bottom+b.top)/2+X-n:J3(t,e,n);R=h-s}else{if(io(e)){const le=Object.keys(e)[0];z=T[le].getPixelForValue(e[le])-ee+n}else z="center"===e?(b.left+b.right)/2-ee+n:J3(t,e,n);W=ca(o,l,r),I="left"===e?-Ir:Ir}return{titleX:z,titleY:W,maxWidth:R,rotation:I}}(this,g,e,h);dg(n,o.text,0,0,s,{color:o.color,maxWidth:I,rotation:R,textAlign:Kre(h,e,r),textBaseline:"middle",translation:[b,T]})}draw(n){this._isVisible()&&(this.drawBackground(),this.drawGrid(n),this.drawBorder(),this.drawTitle(),this.drawLabels(n))}_layers(){const n=this.options,e=n.ticks&&n.ticks.z||0,o=Oi(n.grid&&n.grid.z,-1),r=Oi(n.border&&n.border.z,0);return this._isVisible()&&this.draw===_g.prototype.draw?[{z:o,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:e,draw:s=>{this.drawLabels(s)}}]:[{z:e,draw:s=>{this.draw(s)}}]}getMatchingVisibleMetas(n){const e=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",r=[];let s,l;for(s=0,l=e.length;s<l;++s){const h=e[s];h[o]===this.id&&(!n||h.type===n)&&r.push(h)}return r}_resolveTickFontOptions(n){return ys(this.options.ticks.setContext(this.getContext(n)).font)}_maxDigits(){const n=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/n}}class fC{constructor(n,e,o){this.type=n,this.scope=e,this.override=o,this.items=Object.create(null)}isForType(n){return Object.prototype.isPrototypeOf.call(this.type.prototype,n.prototype)}register(n){const e=Object.getPrototypeOf(n);let o;(function Jre(t){return"id"in t&&"defaults"in t})(e)&&(o=this.register(e));const r=this.items,s=n.id,l=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+n);return s in r||(r[s]=n,function Yre(t,n,e){const o=t0(Object.create(null),[e?Zr.get(e):{},Zr.get(n),t.defaults]);Zr.set(n,o),t.defaultRoutes&&function Qre(t,n){Object.keys(n).forEach(e=>{const o=e.split("."),r=o.pop(),s=[t].concat(o).join("."),l=n[e].split("."),h=l.pop(),g=l.join(".");Zr.route(s,r,g,h)})}(n,t.defaultRoutes),t.descriptors&&Zr.describe(n,t.descriptors)}(n,l,o),this.override&&Zr.override(n.id,n.overrides)),l}get(n){return this.items[n]}unregister(n){const e=this.items,o=n.id,r=this.scope;o in e&&delete e[o],r&&o in Zr[r]&&(delete Zr[r][o],this.override&&delete cg[o])}}class ese{constructor(){this.controllers=new fC(xf,"datasets",!0),this.elements=new fC(_u,"elements"),this.plugins=new fC(Object,"plugins"),this.scales=new fC(_g,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...n){this._each("register",n)}remove(...n){this._each("unregister",n)}addControllers(...n){this._each("register",n,this.controllers)}addElements(...n){this._each("register",n,this.elements)}addPlugins(...n){this._each("register",n,this.plugins)}addScales(...n){this._each("register",n,this.scales)}getController(n){return this._get(n,this.controllers,"controller")}getElement(n){return this._get(n,this.elements,"element")}getPlugin(n){return this._get(n,this.plugins,"plugin")}getScale(n){return this._get(n,this.scales,"scale")}removeControllers(...n){this._each("unregister",n,this.controllers)}removeElements(...n){this._each("unregister",n,this.elements)}removePlugins(...n){this._each("unregister",n,this.plugins)}removeScales(...n){this._each("unregister",n,this.scales)}_each(n,e,o){[...e].forEach(r=>{const s=o||this._getRegistryForType(r);o||s.isForType(r)||s===this.plugins&&r.id?this._exec(n,s,r):Ro(r,l=>{const h=o||this._getRegistryForType(l);this._exec(n,h,l)})})}_exec(n,e,o){const r=pM(n);$o(o["before"+r],[],o),e[n](o),$o(o["after"+r],[],o)}_getRegistryForType(n){for(let e=0;e<this._typedRegistries.length;e++){const o=this._typedRegistries[e];if(o.isForType(n))return o}return this.plugins}_get(n,e,o){const r=e.get(n);if(void 0===r)throw new Error('"'+n+'" is not a registered '+o+".");return r}}var Cd=new ese;class tse{constructor(){this._init=[]}notify(n,e,o,r){"beforeInit"===e&&(this._init=this._createDescriptors(n,!0),this._notify(this._init,n,"install"));const s=r?this._descriptors(n).filter(r):this._descriptors(n),l=this._notify(s,n,e,o);return"afterDestroy"===e&&(this._notify(s,n,"stop"),this._notify(this._init,n,"uninstall")),l}_notify(n,e,o,r){r=r||{};for(const s of n){const l=s.plugin;if(!1===$o(l[o],[e,r,s.options],l)&&r.cancelable)return!1}return!0}invalidate(){yo(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(n){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(n);return this._notifyStateChanges(n),e}_createDescriptors(n,e){const o=n&&n.config,r=Oi(o.options&&o.options.plugins,{}),s=function nse(t){const n={},e=[],o=Object.keys(Cd.plugins.items);for(let s=0;s<o.length;s++)e.push(Cd.getPlugin(o[s]));const r=t.plugins||[];for(let s=0;s<r.length;s++){const l=r[s];-1===e.indexOf(l)&&(e.push(l),n[l.id]=!0)}return{plugins:e,localIds:n}}(o);return!1!==r||e?function ose(t,{plugins:n,localIds:e},o,r){const s=[],l=t.getContext();for(const h of n){const g=h.id,b=ise(o[g],r);null!==b&&s.push({plugin:h,options:rse(t.config,{plugin:h,local:e[g]},b,l)})}return s}(n,s,r,e):[]}_notifyStateChanges(n){const e=this._oldCache||[],o=this._cache,r=(s,l)=>s.filter(h=>!l.some(g=>h.plugin.id===g.plugin.id));this._notify(r(e,o),n,"stop"),this._notify(r(o,e),n,"start")}}function ise(t,n){return n||!1!==t?!0===t?{}:t:null}function rse(t,{plugin:n,local:e},o,r){const s=t.pluginScopeKeys(n),l=t.getOptionScopes(o,s);return e&&n.defaults&&l.push(n.defaults),t.createResolver(l,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function LM(t,n){return((n.datasets||{})[t]||{}).indexAxis||n.indexAxis||(Zr.datasets[t]||{}).indexAxis||"x"}function mC(t,n){if("x"===t||"y"===t||"r"===t||(t=n.axis||function lse(t){return"top"===t||"bottom"===t?"x":"left"===t||"right"===t?"y":void 0}(n.position)||t.length>1&&mC(t[0].toLowerCase(),n)))return t;throw new Error(`Cannot determine type of '${name}' axis. Please provide 'axis' or 'position' option.`)}function iz(t){const n=t.options||(t.options={});n.plugins=Oi(n.plugins,{}),n.scales=function cse(t,n){const e=cg[t.type]||{scales:{}},o=n.scales||{},r=LM(t.type,n),s=Object.create(null);return Object.keys(o).forEach(l=>{const h=o[l];if(!io(h))return console.error(`Invalid scale configuration for scale: ${l}`);if(h._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const g=mC(l,h),b=function ase(t,n){return t===n?"_index_":"_value_"}(g,r),T=e.scales||{};s[l]=n0(Object.create(null),[{axis:g},h,T[g],T[b]])}),t.data.datasets.forEach(l=>{const h=l.type||t.type,g=l.indexAxis||LM(h,n),T=(cg[h]||{}).scales||{};Object.keys(T).forEach(I=>{const R=function sse(t,n){let e=t;return"_index_"===t?e=n:"_value_"===t&&(e="x"===n?"y":"x"),e}(I,g),z=l[R+"AxisID"]||R;s[z]=s[z]||Object.create(null),n0(s[z],[{axis:R},o[z],T[I]])})}),Object.keys(s).forEach(l=>{const h=s[l];n0(h,[Zr.scales[h.type],Zr.scale])}),s}(t,n)}function oz(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const rz=new Map,sz=new Set;function gC(t,n){let e=rz.get(t);return e||(e=n(),rz.set(t,e),sz.add(e)),e}const v0=(t,n,e)=>{const o=_f(n,e);void 0!==o&&t.add(o)};class dse{constructor(n){this._config=function use(t){return(t=t||{}).data=oz(t.data),iz(t),t}(n),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(n){this._config.type=n}get data(){return this._config.data}set data(n){this._config.data=oz(n)}get options(){return this._config.options}set options(n){this._config.options=n}get plugins(){return this._config.plugins}update(){const n=this._config;this.clearCache(),iz(n)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(n){return gC(n,()=>[[`datasets.${n}`,""]])}datasetAnimationScopeKeys(n,e){return gC(`${n}.transition.${e}`,()=>[[`datasets.${n}.transitions.${e}`,`transitions.${e}`],[`datasets.${n}`,""]])}datasetElementScopeKeys(n,e){return gC(`${n}-${e}`,()=>[[`datasets.${n}.elements.${e}`,`datasets.${n}`,`elements.${e}`,""]])}pluginScopeKeys(n){const e=n.id;return gC(`${this.type}-plugin-${e}`,()=>[[`plugins.${e}`,...n.additionalOptionScopes||[]]])}_cachedScopes(n,e){const o=this._scopeCache;let r=o.get(n);return(!r||e)&&(r=new Map,o.set(n,r)),r}getOptionScopes(n,e,o){const{options:r,type:s}=this,l=this._cachedScopes(n,o),h=l.get(e);if(h)return h;const g=new Set;e.forEach(T=>{n&&(g.add(n),T.forEach(I=>v0(g,n,I))),T.forEach(I=>v0(g,r,I)),T.forEach(I=>v0(g,cg[s]||{},I)),T.forEach(I=>v0(g,Zr,I)),T.forEach(I=>v0(g,vM,I))});const b=Array.from(g);return 0===b.length&&b.push(Object.create(null)),sz.has(e)&&l.set(e,b),b}chartOptionScopes(){const{options:n,type:e}=this;return[n,cg[e]||{},Zr.datasets[e]||{},{type:e},Zr,vM]}resolveNamedOptions(n,e,o,r=[""]){const s={$shared:!0},{resolver:l,subPrefixes:h}=az(this._resolverCache,n,r);let g=l;(function pse(t,n){const{isScriptable:e,isIndexable:o}=c3(t);for(const r of n){const s=e(r),l=o(r),h=(l||s)&&t[r];if(s&&(yf(h)||hse(h))||l&&Yo(h))return!0}return!1})(l,e)&&(s.$shared=!1,g=gy(l,o=yf(o)?o():o,this.createResolver(n,o,h)));for(const b of e)s[b]=g[b];return s}createResolver(n,e,o=[""],r){const{resolver:s}=az(this._resolverCache,n,o);return io(e)?gy(s,e,void 0,r):s}}function az(t,n,e){let o=t.get(n);o||(o=new Map,t.set(n,o));const r=e.join();let s=o.get(r);return s||(s={resolver:CM(n,e),subPrefixes:e.filter(h=>!h.toLowerCase().includes("hover"))},o.set(r,s)),s}const hse=t=>io(t)&&Object.getOwnPropertyNames(t).reduce((n,e)=>n||yf(t[e]),!1),mse=["top","bottom","left","right","chartArea"];function lz(t,n){return"top"===t||"bottom"===t||-1===mse.indexOf(t)&&"x"===n}function cz(t,n){return function(e,o){return e[t]===o[t]?e[n]-o[n]:e[t]-o[t]}}function uz(t){const n=t.chart,e=n.options.animation;n.notifyPlugins("afterRender"),$o(e&&e.onComplete,[t],n)}function gse(t){const n=t.chart,e=n.options.animation;$o(e&&e.onProgress,[t],n)}function dz(t){return _3()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const _C={},hz=t=>{const n=dz(t);return Object.values(_C).filter(e=>e.canvas===n).pop()};function _se(t,n,e){const o=Object.keys(t);for(const r of o){const s=+r;if(s>=n){const l=t[r];delete t[r],(e>0||s>n)&&(t[s+e]=l)}}}let FM=(()=>{class t{static register(...e){Cd.add(...e),pz()}static unregister(...e){Cd.remove(...e),pz()}constructor(e,o){const r=this.config=new dse(o),s=dz(e),l=hz(s);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const h=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||function zre(t){return!_3()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?Tre:Fre}(s)),this.platform.updateConfig(r);const g=this.platform.acquireContext(s,h.aspectRatio),b=g&&g.canvas,T=b&&b.height,I=b&&b.width;this.id=vie(),this.ctx=g,this.canvas=b,this.width=I,this.height=T,this._options=h,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new tse,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function Lie(t,n){let e;return function(...o){return n?(clearTimeout(e),e=setTimeout(t,n,o)):t.apply(this,o),n}}(R=>this.update(R),h.resizeDelay||0),this._dataChanges=[],_C[this.id]=this,g&&b?(Vh.listen(this,"complete",uz),Vh.listen(this,"progress",gse),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:o},width:r,height:s,_aspectRatio:l}=this;return yo(e)?o&&l?l:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Cd}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():y3(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return s3(this.canvas,this.ctx),this}stop(){return Vh.stop(this),this}resize(e,o){Vh.running(this)?this._resizeBeforeDraw={width:e,height:o}:this._resize(e,o)}_resize(e,o){const r=this.options,h=this.platform.getMaximumSize(this.canvas,e,o,r.maintainAspectRatio&&this.aspectRatio),g=r.devicePixelRatio||this.platform.getDevicePixelRatio(),b=this.width?"resize":"attach";this.width=h.width,this.height=h.height,this._aspectRatio=this.aspectRatio,y3(this,g,!0)&&(this.notifyPlugins("resize",{size:h}),$o(r.onResize,[this,h],this),this.attached&&this._doResize(b)&&this.render())}ensureScalesHaveIDs(){Ro(this.options.scales||{},(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,o=e.scales,r=this.scales,s=Object.keys(r).reduce((h,g)=>(h[g]=!1,h),{});let l=[];o&&(l=l.concat(Object.keys(o).map(h=>{const g=o[h],b=mC(h,g),T="r"===b,I="x"===b;return{options:g,dposition:T?"chartArea":I?"bottom":"left",dtype:T?"radialLinear":I?"category":"linear"}}))),Ro(l,h=>{const g=h.options,b=g.id,T=mC(b,g),I=Oi(g.type,h.dtype);(void 0===g.position||lz(g.position,T)!==lz(h.dposition))&&(g.position=h.dposition),s[b]=!0;let R=null;b in r&&r[b].type===I?R=r[b]:(R=new(Cd.getScale(I))({id:b,type:I,ctx:this.ctx,chart:this}),r[R.id]=R),R.init(g,e)}),Ro(s,(h,g)=>{h||delete r[g]}),Ro(r,h=>{da.configure(this,h,h.options),da.addBox(this,h)})}_updateMetasets(){const e=this._metasets,o=this.data.datasets.length,r=e.length;if(e.sort((s,l)=>s.index-l.index),r>o){for(let s=o;s<r;++s)this._destroyDatasetMeta(s);e.splice(o,r-o)}this._sortedMetasets=e.slice(0).sort(cz("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:o}}=this;e.length>o.length&&delete this._stacks,e.forEach((r,s)=>{0===o.filter(l=>l===r._dataset).length&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],o=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=o.length;r<s;r++){const l=o[r];let h=this.getDatasetMeta(r);const g=l.type||this.config.type;if(h.type&&h.type!==g&&(this._destroyDatasetMeta(r),h=this.getDatasetMeta(r)),h.type=g,h.indexAxis=l.indexAxis||LM(g,this.options),h.order=l.order||0,h.index=r,h.label=""+l.label,h.visible=this.isDatasetVisible(r),h.controller)h.controller.updateIndex(r),h.controller.linkScales();else{const b=Cd.getController(g),{datasetElementType:T,dataElementType:I}=Zr.datasets[g];Object.assign(b,{dataElementType:Cd.getElement(I),datasetElementType:T&&Cd.getElement(T)}),h.controller=new b(this,r),e.push(h.controller)}}return this._updateMetasets(),e}_resetElements(){Ro(this.data.datasets,(e,o)=>{this.getDatasetMeta(o).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const o=this.config;o.update();const r=this._options=o.createResolver(o.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let h=0;for(let T=0,I=this.data.datasets.length;T<I;T++){const{controller:R}=this.getDatasetMeta(T),z=!s&&-1===l.indexOf(R);R.buildOrUpdateElements(z),h=Math.max(+R.getMaxOverflow(),h)}h=this._minPadding=r.layout.autoPadding?h:0,this._updateLayout(h),s||Ro(l,T=>{T.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(cz("z","_idx"));const{_active:g,_lastEvent:b}=this;b?this._eventHandler(b,!0):g.length&&this._updateHoverStyles(g,g,!0),this.render()}_updateScales(){Ro(this.scales,e=>{da.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,o=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!VF(o,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,o=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:l}of o)_se(e,s,"_removeElements"===r?-l:l)}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const o=this.data.datasets.length,r=l=>new Set(e.filter(h=>h[0]===l).map((h,g)=>g+","+h.splice(1).join(","))),s=r(0);for(let l=1;l<o;l++)if(!VF(s,r(l)))return;return Array.from(s).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;da.update(this,this.width,this.height,e);const o=this.chartArea,r=o.width<=0||o.height<=0;this._layers=[],Ro(this.boxes,s=>{r&&"chartArea"===s.position||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,l)=>{s._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let o=0,r=this.data.datasets.length;o<r;++o)this.getDatasetMeta(o).controller.configure();for(let o=0,r=this.data.datasets.length;o<r;++o)this._updateDataset(o,yf(e)?e({datasetIndex:o}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,o){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:o,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",s)&&(r.controller._update(o),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Vh.has(this)?this.attached&&!Vh.running(this)&&Vh.start(this):(this.draw(),uz({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resize(r,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const o=this._layers;for(e=0;e<o.length&&o[e].z<=0;++e)o[e].draw(this.chartArea);for(this._drawDatasets();e<o.length;++e)o[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const o=this._sortedMetasets,r=[];let s,l;for(s=0,l=o.length;s<l;++s){const h=o[s];(!e||h.visible)&&r.push(h)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let o=e.length-1;o>=0;--o)this._drawDataset(e[o]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const o=this.ctx,r=e._clip,s=!r.disabled,l=function vse(t){const{xScale:n,yScale:e}=t;if(n&&e)return{left:n.left,right:n.right,top:e.top,bottom:e.bottom}}(e)||this.chartArea,h={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",h)&&(s&&oC(o,{left:!1===r.left?0:l.left-r.left,right:!1===r.right?this.width:l.right+r.right,top:!1===r.top?0:l.top-r.top,bottom:!1===r.bottom?this.height:l.bottom+r.bottom}),e.controller.draw(),s&&rC(o),h.cancelable=!1,this.notifyPlugins("afterDatasetDraw",h))}isPointInArea(e){return c0(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,o,r,s){const l=gre.modes[o];return"function"==typeof l?l(this,e,r,s):[]}getDatasetMeta(e){const o=this.data.datasets[e],r=this._metasets;let s=r.filter(l=>l&&l._dataset===o).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:o&&o.order||0,index:e,_dataset:o,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=bf(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const o=this.data.datasets[e];if(!o)return!1;const r=this.getDatasetMeta(e);return"boolean"==typeof r.hidden?!r.hidden:!o.hidden}setDatasetVisibility(e,o){this.getDatasetMeta(e).hidden=!o}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,o,r){const s=r?"show":"hide",l=this.getDatasetMeta(e),h=l.controller._resolveAnimations(void 0,s);gc(o)?(l.data[o].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),h.update(l,{visible:r}),this.update(g=>g.datasetIndex===e?s:void 0))}hide(e,o){this._updateVisibility(e,o,!1)}show(e,o){this._updateVisibility(e,o,!0)}_destroyDatasetMeta(e){const o=this._metasets[e];o&&o.controller&&o.controller._destroy(),delete this._metasets[e]}_stop(){let e,o;for(this.stop(),Vh.remove(this),e=0,o=this.data.datasets.length;e<o;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:o}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),s3(e,o),this.platform.releaseContext(o),this.canvas=null,this.ctx=null),delete _C[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,o=this.platform,r=(l,h)=>{o.addEventListener(this,l,h),e[l]=h},s=(l,h,g)=>{l.offsetX=h,l.offsetY=g,this._eventHandler(l)};Ro(this.options.events,l=>r(l,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,o=this.platform,r=(b,T)=>{o.addEventListener(this,b,T),e[b]=T},s=(b,T)=>{e[b]&&(o.removeEventListener(this,b,T),delete e[b])},l=(b,T)=>{this.canvas&&this.resize(b,T)};let h;const g=()=>{s("attach",g),this.attached=!0,this.resize(),r("resize",l),r("detach",h)};h=()=>{this.attached=!1,s("resize",l),this._stop(),this._resize(0,0),r("attach",g)},o.isAttached(this.canvas)?g():h()}unbindEvents(){Ro(this._listeners,(e,o)=>{this.platform.removeEventListener(this,o,e)}),this._listeners={},Ro(this._responsiveListeners,(e,o)=>{this.platform.removeEventListener(this,o,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,o,r){const s=r?"set":"remove";let l,h,g,b;for("dataset"===o&&(l=this.getDatasetMeta(e[0].datasetIndex),l.controller["_"+s+"DatasetHoverStyle"]()),g=0,b=e.length;g<b;++g){h=e[g];const T=h&&this.getDatasetMeta(h.datasetIndex).controller;T&&T[s+"HoverStyle"](h.element,h.datasetIndex,h.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const o=this._active||[],r=e.map(({datasetIndex:l,index:h})=>{const g=this.getDatasetMeta(l);if(!g)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:g.data[h],index:h}});!Qw(r,o)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,o))}notifyPlugins(e,o,r){return this._plugins.notify(this,e,o,r)}isPluginEnabled(e){return 1===this._plugins._cache.filter(o=>o.plugin.id===e).length}_updateHoverStyles(e,o,r){const s=this.options.hover,l=(b,T)=>b.filter(I=>!T.some(R=>I.datasetIndex===R.datasetIndex&&I.index===R.index)),h=l(o,e),g=r?e:l(e,o);h.length&&this.updateHoverStyle(h,s.mode,!1),g.length&&s.mode&&this.updateHoverStyle(g,s.mode,!0)}_eventHandler(e,o){const r={event:e,replay:o,cancelable:!0,inChartArea:this.isPointInArea(e)},s=h=>(h.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",r,s))return;const l=this._handleEvent(e,o,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(l||r.changed)&&this.render(),this}_handleEvent(e,o,r){const{_active:s=[],options:l}=this,g=this._getActiveElements(e,s,r,o),b=function Eie(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}(e),T=function yse(t,n,e,o){return e&&"mouseout"!==t.type?o?n:t:null}(e,this._lastEvent,r,b);r&&(this._lastEvent=null,$o(l.onHover,[e,g,this],this),b&&$o(l.onClick,[e,g,this],this));const I=!Qw(g,s);return(I||o)&&(this._active=g,this._updateHoverStyles(g,s,o)),this._lastEvent=T,I}_getActiveElements(e,o,r,s){if("mouseout"===e.type)return[];if(!r)return o;const l=this.options.hover;return this.getElementsAtEventForMode(e,l.mode,l,s)}}return Ln(t,"defaults",Zr),Ln(t,"instances",_C),Ln(t,"overrides",cg),Ln(t,"registry",Cd),Ln(t,"version","4.2.1"),Ln(t,"getChart",hz),t})();function pz(){return Ro(FM.instances,t=>t._plugins.invalidate())}function vy(t,n,e,o){return{x:e+t*Math.cos(n),y:o+t*Math.sin(n)}}function yC(t,n,e,o,r,s){const{x:l,y:h,startAngle:g,pixelMargin:b,innerRadius:T}=n,I=Math.max(n.outerRadius+o+e-b,0),R=T>0?T+o+e+b:0;let z=0;const W=r-g;if(o){const yn=((T>0?T-o:0)+(I>0?I-o:0))/2;z=(W-(0!==yn?W*yn/(yn+o):W))/2}const ee=(W-Math.max(.001,W*I-e/ar)/I)/2,le=g+ee+z,ve=r-ee-z,{outerStart:xe,outerEnd:Be,innerStart:Ke,innerEnd:ft}=function wse(t,n,e,o){const r=function xse(t){return wM(t,["outerStart","outerEnd","innerStart","innerEnd"])}(t.options.borderRadius),s=(e-n)/2,l=Math.min(s,o*n/2),h=g=>{const b=(e-Math.min(s,g))*o/2;return As(g,0,Math.min(s,b))};return{outerStart:h(r.outerStart),outerEnd:h(r.outerEnd),innerStart:As(r.innerStart,0,l),innerEnd:As(r.innerEnd,0,l)}}(n,R,I,ve-le),Vt=I-xe,Nt=I-Be,Ut=le+xe/Vt,Pn=ve-Be/Nt,Qn=R+Ke,ki=R+ft,Jo=le+Ke/Qn,ha=ve-ft/ki;if(t.beginPath(),s){const So=(Ut+Pn)/2;if(t.arc(l,h,I,Ut,So),t.arc(l,h,I,So,Pn),Be>0){const li=vy(Nt,Pn,l,h);t.arc(li.x,li.y,Be,Pn,ve+Ir)}const en=vy(ki,ve,l,h);if(t.lineTo(en.x,en.y),ft>0){const li=vy(ki,ha,l,h);t.arc(li.x,li.y,ft,ve+Ir,ha+Math.PI)}const yn=(ve-ft/R+(le+Ke/R))/2;if(t.arc(l,h,R,ve-ft/R,yn,!0),t.arc(l,h,R,yn,le+Ke/R,!0),Ke>0){const li=vy(Qn,Jo,l,h);t.arc(li.x,li.y,Ke,Jo+Math.PI,le-Ir)}const Hn=vy(Vt,le,l,h);if(t.lineTo(Hn.x,Hn.y),xe>0){const li=vy(Vt,Ut,l,h);t.arc(li.x,li.y,xe,le-Ir,Ut)}}else{t.moveTo(l,h);const So=Math.cos(Ut)*I+l,en=Math.sin(Ut)*I+h;t.lineTo(So,en);const yn=Math.cos(Pn)*I+l,Hn=Math.sin(Pn)*I+h;t.lineTo(yn,Hn)}t.closePath()}class vC extends _u{constructor(n){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,e,o){const r=this.getProps(["x","y"],o),{angle:s,distance:l}=GF(r,{x:n,y:e}),{startAngle:h,endAngle:g,innerRadius:b,outerRadius:T,circumference:I}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],o),R=this.options.spacing/2,W=Oi(I,g-h)>=Qo||r0(s,h,g),X=Nh(l,b+R,T+R);return W&&X}getCenterPoint(n){const{x:e,y:o,startAngle:r,endAngle:s,innerRadius:l,outerRadius:h}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:g,spacing:b}=this.options,T=(r+s)/2,I=(l+h+b+g)/2;return{x:e+Math.cos(T)*I,y:o+Math.sin(T)*I}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:e,circumference:o}=this,r=(e.offset||0)/4,s=(e.spacing||0)/2,l=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=o>Qo?Math.floor(o/Qo):0,0===o||this.innerRadius<0||this.outerRadius<0)return;n.save();const h=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(h)*r,Math.sin(h)*r);const b=r*(1-Math.sin(Math.min(ar,o||0)));n.fillStyle=e.backgroundColor,n.strokeStyle=e.borderColor,function Cse(t,n,e,o,r){const{fullCircles:s,startAngle:l,circumference:h}=n;let g=n.endAngle;if(s){yC(t,n,e,o,g,r);for(let b=0;b<s;++b)t.fill();isNaN(h)||(g=l+(h%Qo||Qo))}yC(t,n,e,o,g,r),t.fill()}(n,this,b,s,l),function Tse(t,n,e,o,r){const{fullCircles:s,startAngle:l,circumference:h,options:g}=n,{borderWidth:b,borderJoinStyle:T}=g,I="inner"===g.borderAlign;if(!b)return;I?(t.lineWidth=2*b,t.lineJoin=T||"round"):(t.lineWidth=b,t.lineJoin=T||"bevel");let R=n.endAngle;if(s){yC(t,n,e,o,R,r);for(let z=0;z<s;++z)t.stroke();isNaN(h)||(R=l+(h%Qo||Qo))}I&&function bse(t,n,e){const{startAngle:o,pixelMargin:r,x:s,y:l,outerRadius:h,innerRadius:g}=n;let b=r/h;t.beginPath(),t.arc(s,l,h,o-b,e+b),g>r?(b=r/g,t.arc(s,l,g,e+b,o-b,!0)):t.arc(s,l,r,e+Ir,o-Ir),t.closePath(),t.clip()}(t,n,R),s||(yC(t,n,e,o,R,r),t.stroke())}(n,this,b,s,l),n.restore()}}function fz(t,n,e=n){t.lineCap=Oi(e.borderCapStyle,n.borderCapStyle),t.setLineDash(Oi(e.borderDash,n.borderDash)),t.lineDashOffset=Oi(e.borderDashOffset,n.borderDashOffset),t.lineJoin=Oi(e.borderJoinStyle,n.borderJoinStyle),t.lineWidth=Oi(e.borderWidth,n.borderWidth),t.strokeStyle=Oi(e.borderColor,n.borderColor)}function Ese(t,n,e){t.lineTo(e.x,e.y)}function mz(t,n,e={}){const o=t.length,{start:r=0,end:s=o-1}=e,{start:l,end:h}=n,g=Math.max(r,l),b=Math.min(s,h);return{count:o,start:g,loop:n.loop,ilen:b<g&&!(r<l&&s<l||r>h&&s>h)?o+b-g:b-g}}function Dse(t,n,e,o){const{points:r,options:s}=n,{count:l,start:h,loop:g,ilen:b}=mz(r,e,o),T=function Sse(t){return t.stepped?qie:t.tension||"monotone"===t.cubicInterpolationMode?Zie:Ese}(s);let z,W,X,{move:I=!0,reverse:R}=o||{};for(z=0;z<=b;++z)W=r[(h+(R?b-z:z))%l],!W.skip&&(I?(t.moveTo(W.x,W.y),I=!1):T(t,X,W,R,s.stepped),X=W);return g&&(W=r[(h+(R?b:0))%l],T(t,X,W,R,s.stepped)),!!g}function Mse(t,n,e,o){const r=n.points,{count:s,start:l,ilen:h}=mz(r,e,o),{move:g=!0,reverse:b}=o||{};let R,z,W,X,ee,le,T=0,I=0;const ve=Be=>(l+(b?h-Be:Be))%s,xe=()=>{X!==ee&&(t.lineTo(T,ee),t.lineTo(T,X),t.lineTo(T,le))};for(g&&(z=r[ve(0)],t.moveTo(z.x,z.y)),R=0;R<=h;++R){if(z=r[ve(R)],z.skip)continue;const Be=z.x,Ke=z.y,ft=0|Be;ft===W?(Ke<X?X=Ke:Ke>ee&&(ee=Ke),T=(I*T+Be)/++I):(xe(),t.lineTo(Be,Ke),W=ft,I=0,X=ee=Ke),le=Ke}xe()}function zM(t){const n=t.options;return t._decimated||t._loop||n.tension||"monotone"===n.cubicInterpolationMode||n.stepped||n.borderDash&&n.borderDash.length?Dse:Mse}Ln(vC,"id","arc"),Ln(vC,"defaults",{borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Ln(vC,"defaultRoutes",{backgroundColor:"backgroundColor"});const Pse="function"==typeof Path2D;let bC=(()=>{class t extends _u{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,o){const r=this.options;!r.tension&&"monotone"!==r.cubicInterpolationMode||r.stepped||this._pointsUpdated||(yoe(this._points,r,e,r.spanGaps?this._loop:this._fullLoop,o),this._pointsUpdated=!0)}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function Ooe(t,n){const e=t.points,o=t.options.spanGaps,r=e.length;if(!r)return[];const s=!!t._loop,{start:l,end:h}=function Aoe(t,n,e,o){let r=0,s=n-1;if(e&&!o)for(;r<n&&!t[r].skip;)r++;for(;r<n&&t[r].skip;)r++;for(r%=n,e&&(s+=r);s>r&&t[s%n].skip;)s--;return s%=n,{start:r,end:s}}(e,r,s,o);return function S3(t,n,e,o){return o&&o.setContext&&e?function Roe(t,n,e,o){const r=t._chart.getContext(),s=D3(t.options),{_datasetIndex:l,options:{spanGaps:h}}=t,g=e.length,b=[];let T=s,I=n[0].start,R=I;function z(W,X,ee,le){const ve=h?-1:1;if(W!==X){for(W+=g;e[W%g].skip;)W-=ve;for(;e[X%g].skip;)X+=ve;W%g!=X%g&&(b.push({start:W%g,end:X%g,loop:ee,style:le}),T=le,I=X%g)}}for(const W of n){I=h?I:W.start;let ee,X=e[I%g];for(R=I+1;R<=W.end;R++){const le=e[R%g];ee=D3(o.setContext(bf(r,{type:"segment",p0:X,p1:le,p0DataIndex:(R-1)%g,p1DataIndex:R%g,datasetIndex:l}))),Loe(ee,T)&&z(I,R-1,W.loop,T),X=le,T=ee}I<R-1&&z(I,R-1,W.loop,T)}return b}(t,n,e,o):n}(t,!0===o?[{start:l,end:h,loop:s}]:function Poe(t,n,e,o){const r=t.length,s=[];let g,l=n,h=t[n];for(g=n+1;g<=e;++g){const b=t[g%r];b.skip||b.stop?h.skip||(s.push({start:n%r,end:(g-1)%r,loop:o=!1}),n=l=b.stop?g:null):(l=g,h.skip&&(n=g)),h=b}return null!==l&&s.push({start:n%r,end:l%r,loop:o}),s}(e,l,h<l?h+r:h,!!t._fullLoop&&0===l&&h===r-1),e,n)}(this,this.options.segment))}first(){const e=this.segments;return e.length&&this.points[e[0].start]}last(){const e=this.segments,r=e.length;return r&&this.points[e[r-1].end]}interpolate(e,o){const r=this.options,s=e[o],l=this.points,h=E3(this,{property:o,start:s,end:s});if(!h.length)return;const g=[],b=function Ise(t){return t.stepped?Soe:t.tension||"monotone"===t.cubicInterpolationMode?Doe:mg}(r);let T,I;for(T=0,I=h.length;T<I;++T){const{start:R,end:z}=h[T],W=l[R],X=l[z];if(W===X){g.push(W);continue}const le=b(W,X,Math.abs((s-W[o])/(X[o]-W[o])),r.stepped);le[o]=e[o],g.push(le)}return 1===g.length?g[0]:g}pathSegment(e,o,r){return zM(this)(e,this,o,r)}path(e,o,r){const s=this.segments,l=zM(this);let h=this._loop;o=o||0,r=r||this.points.length-o;for(const g of s)h&=l(e,this,g,{start:o,end:o+r-1});return!!h}draw(e,o,r,s){(this.points||[]).length&&(this.options||{}).borderWidth&&(e.save(),function Ose(t,n,e,o){Pse&&!n.options.segment?function kse(t,n,e,o){let r=n._path;r||(r=n._path=new Path2D,n.path(r,e,o)&&r.closePath()),fz(t,n.options),t.stroke(r)}(t,n,e,o):function Ase(t,n,e,o){const{segments:r,options:s}=n,l=zM(n);for(const h of r)fz(t,s,h.style),t.beginPath(),l(t,n,h,{start:e,end:e+o-1})&&t.closePath(),t.stroke()}(t,n,e,o)}(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return Ln(t,"id","line"),Ln(t,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Ln(t,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Ln(t,"descriptors",{_scriptable:!0,_indexable:n=>"borderDash"!==n&&"fill"!==n}),t})();function gz(t,n,e,o){const r=t.options,{[e]:s}=t.getProps([e],o);return Math.abs(n-s)<r.radius+r.hitRadius}let Rse=(()=>{class t extends _u{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,o,r){const s=this.options,{x:l,y:h}=this.getProps(["x","y"],r);return Math.pow(e-l,2)+Math.pow(o-h,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,o){return gz(this,e,"x",o)}inYRange(e,o){return gz(this,e,"y",o)}getCenterPoint(e){const{x:o,y:r}=this.getProps(["x","y"],e);return{x:o,y:r}}size(e){let o=(e=e||this.options||{}).radius||0;return o=Math.max(o,o&&e.hoverRadius||0),2*(o+(o&&e.borderWidth||0))}draw(e,o){const r=this.options;this.skip||r.radius<.1||!c0(this,o,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,xM(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}return Ln(t,"id","point"),Ln(t,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Ln(t,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),t})();function _z(t,n){const{x:e,y:o,base:r,width:s,height:l}=t.getProps(["x","y","base","width","height"],n);let h,g,b,T,I;return t.horizontal?(I=l/2,h=Math.min(e,r),g=Math.max(e,r),b=o-I,T=o+I):(I=s/2,h=e-I,g=e+I,b=Math.min(o,r),T=Math.max(o,r)),{left:h,top:b,right:g,bottom:T}}function wf(t,n,e,o){return t?0:As(n,e,o)}function NM(t,n,e,o){const r=null===n,s=null===e,h=t&&!(r&&s)&&_z(t,o);return h&&(r||Nh(n,h.left,h.right))&&(s||Nh(e,h.top,h.bottom))}function Bse(t,n){t.rect(n.x,n.y,n.w,n.h)}function BM(t,n,e={}){const o=t.x!==e.x?-n:0,r=t.y!==e.y?-n:0;return{x:t.x+o,y:t.y+r,w:t.w+((t.x+t.w!==e.x+e.w?n:0)-o),h:t.h+((t.y+t.h!==e.y+e.h?n:0)-r),radius:t.radius}}class xC extends _u{constructor(n){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,n&&Object.assign(this,n)}draw(n){const{inflateAmount:e,options:{borderColor:o,backgroundColor:r}}=this,{inner:s,outer:l}=function zse(t){const n=_z(t),e=n.right-n.left,o=n.bottom-n.top,r=function Lse(t,n,e){const r=t.borderSkipped,s=l3(t.options.borderWidth);return{t:wf(r.top,s.top,0,e),r:wf(r.right,s.right,0,n),b:wf(r.bottom,s.bottom,0,e),l:wf(r.left,s.left,0,n)}}(t,e/2,o/2),s=function Fse(t,n,e){const{enableBorderRadius:o}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,s=hg(r),l=Math.min(n,e),h=t.borderSkipped,g=o||io(r);return{topLeft:wf(!g||h.top||h.left,s.topLeft,0,l),topRight:wf(!g||h.top||h.right,s.topRight,0,l),bottomLeft:wf(!g||h.bottom||h.left,s.bottomLeft,0,l),bottomRight:wf(!g||h.bottom||h.right,s.bottomRight,0,l)}}(t,e/2,o/2);return{outer:{x:n.left,y:n.top,w:e,h:o,radius:s},inner:{x:n.left+r.l,y:n.top+r.t,w:e-r.l-r.r,h:o-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}(this),h=function Nse(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}(l.radius)?u0:Bse;n.save(),(l.w!==s.w||l.h!==s.h)&&(n.beginPath(),h(n,BM(l,e,s)),n.clip(),h(n,BM(s,-e,l)),n.fillStyle=o,n.fill("evenodd")),n.beginPath(),h(n,BM(s,e)),n.fillStyle=r,n.fill(),n.restore()}inRange(n,e,o){return NM(this,n,e,o)}inXRange(n,e){return NM(this,n,null,e)}inYRange(n,e){return NM(this,null,n,e)}getCenterPoint(n){const{x:e,y:o,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],n);return{x:s?(e+r)/2:e,y:s?o:(o+r)/2}}getRange(n){return"x"===n?this.width/2:this.height/2}}Ln(xC,"id","bar"),Ln(xC,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Ln(xC,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var Vse=Object.freeze({__proto__:null,ArcElement:vC,LineElement:bC,PointElement:Rse,BarElement:xC});const VM=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],yz=VM.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function vz(t){return VM[t%VM.length]}function bz(t){return yz[t%yz.length]}function xz(t){let n;for(n in t)if(t[n].borderColor||t[n].backgroundColor)return!0;return!1}var Wse={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,n,e){if(!e.enabled)return;const{data:{datasets:o},options:r}=t.config,{elements:s}=r;if(!e.forceOverride&&(xz(o)||function Gse(t){return t&&(t.borderColor||t.backgroundColor)}(r)||s&&xz(s)))return;const l=function $se(t){let n=0;return(e,o)=>{const r=t.getDatasetMeta(o).controller;r instanceof kM?n=function jse(t,n){return t.backgroundColor=t.data.map(()=>vz(n++)),n}(e,n):r instanceof U3?n=function Hse(t,n){return t.backgroundColor=t.data.map(()=>bz(n++)),n}(e,n):r&&(n=function Use(t,n){return t.borderColor=vz(n),t.backgroundColor=bz(n),++n}(e,n))}}(t);o.forEach(l)}};function wz(t){if(t._decimated){const n=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:n})}}function Cz(t){t.data.datasets.forEach(n=>{wz(n)})}var Xse={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,n,e)=>{if(!e.enabled)return void Cz(t);const o=t.width;t.data.datasets.forEach((r,s)=>{const{_data:l,indexAxis:h}=r,g=t.getDatasetMeta(s),b=l||r.data;if("y"===d0([h,t.options.indexAxis])||!g.controller.supportsDecimation)return;const T=t.scales[g.xAxisID];if("linear"!==T.type&&"time"!==T.type||t.options.parsing)return;let W,{start:I,count:R}=function Kse(t,n){const e=n.length;let r,o=0;const{iScale:s}=t,{min:l,max:h,minDefined:g,maxDefined:b}=s.getUserBounds();return g&&(o=As(Bh(n,s.axis,l).lo,0,e-1)),r=b?As(Bh(n,s.axis,h).hi+1,o,e)-o:e-o,{start:o,count:r}}(g,b);if(R<=(e.threshold||4*o))wz(r);else{switch(yo(l)&&(r._data=b,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(X){this._data=X}})),e.algorithm){case"lttb":W=function qse(t,n,e,o,r){const s=r.samples||o;if(s>=e)return t.slice(n,n+e);const l=[],h=(e-2)/(s-2);let g=0;const b=n+e-1;let I,R,z,W,X,T=n;for(l[g++]=t[T],I=0;I<s-2;I++){let ve,ee=0,le=0;const xe=Math.floor((I+1)*h)+1+n,Be=Math.min(Math.floor((I+2)*h)+1,e)+n,Ke=Be-xe;for(ve=xe;ve<Be;ve++)ee+=t[ve].x,le+=t[ve].y;ee/=Ke,le/=Ke;const ft=Math.floor(I*h)+1+n,Vt=Math.min(Math.floor((I+1)*h)+1,e)+n,{x:Nt,y:Ut}=t[T];for(z=W=-1,ve=ft;ve<Vt;ve++)W=.5*Math.abs((Nt-ee)*(t[ve].y-Ut)-(Nt-t[ve].x)*(le-Ut)),W>z&&(z=W,R=t[ve],X=ve);l[g++]=R,T=X}return l[g++]=t[b],l}(b,I,R,o,e);break;case"min-max":W=function Zse(t,n,e,o){let l,h,g,b,T,I,R,z,W,X,r=0,s=0;const ee=[],ve=t[n].x,Be=t[n+e-1].x-ve;for(l=n;l<n+e;++l){h=t[l],g=(h.x-ve)/Be*o,b=h.y;const Ke=0|g;if(Ke===T)b<W?(W=b,I=l):b>X&&(X=b,R=l),r=(s*r+h.x)/++s;else{const ft=l-1;if(!yo(I)&&!yo(R)){const Vt=Math.min(I,R),Nt=Math.max(I,R);Vt!==z&&Vt!==ft&&ee.push({...t[Vt],x:r}),Nt!==z&&Nt!==ft&&ee.push({...t[Nt],x:r})}l>0&&ft!==z&&ee.push(t[ft]),ee.push(h),T=Ke,s=0,W=X=b,I=R=z=l}}return ee}(b,I,R,o);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}r._decimated=W}})},destroy(t){Cz(t)}};function UM(t,n,e,o){if(o)return;let r=n[t],s=e[t];return"angle"===t&&(r=Al(r),s=Al(s)),{property:t,start:r,end:s}}function jM(t,n,e){for(;n>t;n--){const o=e[n];if(!isNaN(o.x)&&!isNaN(o.y))break}return n}function Tz(t,n,e,o){return t&&n?o(t[e],n[e]):t?t[e]:n?n[e]:0}function Ez(t,n){let e=[],o=!1;return Yo(t)?(o=!0,e=t):e=function Qse(t,n){const{x:e=null,y:o=null}=t||{},r=n.points,s=[];return n.segments.forEach(({start:l,end:h})=>{h=jM(l,h,r);const g=r[l],b=r[h];null!==o?(s.push({x:g.x,y:o}),s.push({x:b.x,y:o})):null!==e&&(s.push({x:e,y:g.y}),s.push({x:e,y:b.y}))}),s}(t,n),e.length?new bC({points:e,options:{tension:0},_loop:o,_fullLoop:o}):null}function Sz(t){return t&&!1!==t.fill}function Jse(t,n,e){let r=t[n].fill;const s=[n];let l;if(!e)return r;for(;!1!==r&&-1===s.indexOf(r);){if(!Mr(r))return r;if(l=t[r],!l)return!1;if(l.visible)return r;s.push(r),r=l.fill}return!1}function eae(t,n,e){const o=function oae(t){const n=t.options,e=n.fill;let o=Oi(e&&e.target,e);return void 0===o&&(o=!!n.backgroundColor),!1!==o&&null!==o&&(!0===o?"origin":o)}(t);if(io(o))return!isNaN(o.value)&&o;let r=parseFloat(o);return Mr(r)&&Math.floor(r)===r?function tae(t,n,e,o){return("-"===t||"+"===t)&&(e=n+e),!(e===n||e<0||e>=o)&&e}(o[0],n,r,e):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}function aae(t,n,e){const o=[];for(let r=0;r<e.length;r++){const s=e[r],{first:l,last:h,point:g}=lae(s,n,"x");if(!(!g||l&&h))if(l)o.unshift(g);else if(t.push(g),!h)break}t.push(...o)}function lae(t,n,e){const o=t.interpolate(n,e);if(!o)return{};const r=o[e],s=t.segments,l=t.points;let h=!1,g=!1;for(let b=0;b<s.length;b++){const T=s[b],I=l[T.start][e],R=l[T.end][e];if(Nh(r,I,R)){h=r===I,g=r===R;break}}return{first:h,last:g,point:o}}class Dz{constructor(n){this.x=n.x,this.y=n.y,this.radius=n.radius}pathSegment(n,e,o){const{x:r,y:s,radius:l}=this;return n.arc(r,s,l,(e=e||{start:0,end:Qo}).end,e.start,!0),!o.bounds}interpolate(n){const{x:e,y:o,radius:r}=this,s=n.angle;return{x:e+Math.cos(s)*r,y:o+Math.sin(s)*r,angle:s}}}function HM(t,n,e){const o=function cae(t){const{chart:n,fill:e,line:o}=t;if(Mr(e))return function uae(t,n){const e=t.getDatasetMeta(n);return e&&t.isDatasetVisible(n)?e.dataset:null}(n,e);if("stack"===e)return function rae(t){const{scale:n,index:e,line:o}=t,r=[],s=o.segments,l=o.points,h=function sae(t,n){const e=[],o=t.getMatchingVisibleMetas("line");for(let r=0;r<o.length;r++){const s=o[r];if(s.index===n)break;s.hidden||e.unshift(s.dataset)}return e}(n,e);h.push(Ez({x:null,y:n.bottom},o));for(let g=0;g<s.length;g++){const b=s[g];for(let T=b.start;T<=b.end;T++)aae(r,l[T],h)}return new bC({points:r,options:{}})}(t);if("shape"===e)return!0;const r=function dae(t){return(t.scale||{}).getPointPositionForValue?function pae(t){const{scale:n,fill:e}=t,o=n.options,r=n.getLabels().length,s=o.reverse?n.max:n.min,l=function iae(t,n,e){let o;return o="start"===t?e:"end"===t?n.options.reverse?n.min:n.max:io(t)?t.value:n.getBaseValue(),o}(e,n,s),h=[];if(o.grid.circular){const g=n.getPointPositionForValue(0,s);return new Dz({x:g.x,y:g.y,radius:n.getDistanceFromCenterForValue(l)})}for(let g=0;g<r;++g)h.push(n.getPointPositionForValue(g,l));return h}(t):function hae(t){const{scale:n={},fill:e}=t,o=function nae(t,n){let e=null;return"start"===t?e=n.bottom:"end"===t?e=n.top:io(t)?e=n.getPixelForValue(t.value):n.getBasePixel&&(e=n.getBasePixel()),e}(e,n);if(Mr(o)){const r=n.isHorizontal();return{x:r?o:null,y:r?null:o}}return null}(t)}(t);return r instanceof Dz?r:Ez(r,o)}(n),{line:r,scale:s,axis:l}=n,h=r.options,g=h.fill,b=h.backgroundColor,{above:T=b,below:I=b}=g||{};o&&r.points.length&&(oC(t,e),function fae(t,n){const{line:e,target:o,above:r,below:s,area:l,scale:h}=n,g=e._loop?"angle":n.axis;t.save(),"x"===g&&s!==r&&(Mz(t,o,l.top),Iz(t,{line:e,target:o,color:r,scale:h,property:g}),t.restore(),t.save(),Mz(t,o,l.bottom)),Iz(t,{line:e,target:o,color:s,scale:h,property:g}),t.restore()}(t,{line:r,target:o,above:T,below:I,area:e,scale:s,axis:l}),rC(t))}function Mz(t,n,e){const{segments:o,points:r}=n;let s=!0,l=!1;t.beginPath();for(const h of o){const{start:g,end:b}=h,T=r[g],I=r[jM(g,b,r)];s?(t.moveTo(T.x,T.y),s=!1):(t.lineTo(T.x,e),t.lineTo(T.x,T.y)),l=!!n.pathSegment(t,h,{move:l}),l?t.closePath():t.lineTo(I.x,e)}t.lineTo(n.first().x,e),t.closePath(),t.clip()}function Iz(t,n){const{line:e,target:o,property:r,color:s,scale:l}=n,h=function Yse(t,n,e){const o=t.segments,r=t.points,s=n.points,l=[];for(const h of o){let{start:g,end:b}=h;b=jM(g,b,r);const T=UM(e,r[g],r[b],h.loop);if(!n.segments){l.push({source:h,target:T,start:r[g],end:r[b]});continue}const I=E3(n,T);for(const R of I){const z=UM(e,s[R.start],s[R.end],R.loop),W=T3(h,r,z);for(const X of W)l.push({source:X,target:R,start:{[e]:Tz(T,z,"start",Math.max)},end:{[e]:Tz(T,z,"end",Math.min)}})}}return l}(e,o,r);for(const{source:g,target:b,start:T,end:I}of h){const{style:{backgroundColor:R=s}={}}=g,z=!0!==o;t.save(),t.fillStyle=R,mae(t,l,z&&UM(r,T,I)),t.beginPath();const W=!!e.pathSegment(t,g);let X;if(z){W?t.closePath():kz(t,o,I,r);const ee=!!o.pathSegment(t,b,{move:W,reverse:!0});X=W&&ee,X||kz(t,o,T,r)}t.closePath(),t.fill(X?"evenodd":"nonzero"),t.restore()}}function mae(t,n,e){const{top:o,bottom:r}=n.chart.chartArea,{property:s,start:l,end:h}=e||{};"x"===s&&(t.beginPath(),t.rect(l,o,h-l,r-o),t.clip())}function kz(t,n,e,o){const r=n.interpolate(e,o);r&&t.lineTo(r.x,r.y)}var gae={id:"filler",afterDatasetsUpdate(t,n,e){const o=(t.data.datasets||[]).length,r=[];let s,l,h,g;for(l=0;l<o;++l)s=t.getDatasetMeta(l),h=s.dataset,g=null,h&&h.options&&h instanceof bC&&(g={visible:t.isDatasetVisible(l),index:l,fill:eae(h,l,o),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:h}),s.$filler=g,r.push(g);for(l=0;l<o;++l)g=r[l],g&&!1!==g.fill&&(g.fill=Jse(r,l,e.propagate))},beforeDraw(t,n,e){const o="beforeDraw"===e.drawTime,r=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let l=r.length-1;l>=0;--l){const h=r[l].$filler;h&&(h.line.updateControlPoints(s,h.axis),o&&h.fill&&HM(t.ctx,h,s))}},beforeDatasetsDraw(t,n,e){if("beforeDatasetsDraw"!==e.drawTime)return;const o=t.getSortedVisibleDatasetMetas();for(let r=o.length-1;r>=0;--r){const s=o[r].$filler;Sz(s)&&HM(t.ctx,s,t.chartArea)}},beforeDatasetDraw(t,n,e){const o=n.meta.$filler;!Sz(o)||"beforeDatasetDraw"!==e.drawTime||HM(t.ctx,o,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Az=(t,n)=>{let{boxHeight:e=n,boxWidth:o=n}=t;return t.usePointStyle&&(e=Math.min(e,n),o=t.pointStyleWidth||Math.min(o,n)),{boxWidth:o,boxHeight:e,itemHeight:Math.max(n,e)}};class Pz extends _u{constructor(n){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,e,o){this.maxWidth=n,this.maxHeight=e,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const n=this.options.labels||{};let e=$o(n.generateLabels,[this.chart],this)||[];n.filter&&(e=e.filter(o=>n.filter(o,this.chart.data))),n.sort&&(e=e.sort((o,r)=>n.sort(o,r,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:n,ctx:e}=this;if(!n.display)return void(this.width=this.height=0);const o=n.labels,r=ys(o.font),s=r.size,l=this._computeTitleHeight(),{boxWidth:h,itemHeight:g}=Az(o,s);let b,T;e.font=r.string,this.isHorizontal()?(b=this.maxWidth,T=this._fitRows(l,s,h,g)+10):(T=this.maxHeight,b=this._fitCols(l,r,h,g)+10),this.width=Math.min(b,n.maxWidth||this.maxWidth),this.height=Math.min(T,n.maxHeight||this.maxHeight)}_fitRows(n,e,o,r){const{ctx:s,maxWidth:l,options:{labels:{padding:h}}}=this,g=this.legendHitBoxes=[],b=this.lineWidths=[0],T=r+h;let I=n;s.textAlign="left",s.textBaseline="middle";let R=-1,z=-T;return this.legendItems.forEach((W,X)=>{const ee=o+e/2+s.measureText(W.text).width;(0===X||b[b.length-1]+ee+2*h>l)&&(I+=T,b[b.length-(X>0?0:1)]=0,z+=T,R++),g[X]={left:0,top:z,row:R,width:ee,height:r},b[b.length-1]+=ee+h}),I}_fitCols(n,e,o,r){const{ctx:s,maxHeight:l,options:{labels:{padding:h}}}=this,g=this.legendHitBoxes=[],b=this.columnSizes=[],T=l-n;let I=h,R=0,z=0,W=0,X=0;return this.legendItems.forEach((ee,le)=>{const{itemWidth:ve,itemHeight:xe}=function yae(t,n,e,o,r){const s=function vae(t,n,e,o){let r=t.text;return r&&"string"!=typeof r&&(r=r.reduce((s,l)=>s.length>l.length?s:l)),n+e.size/2+o.measureText(r).width}(o,t,n,e),l=function bae(t,n,e){let o=t;return"string"!=typeof n.text&&(o=Oz(n,e)),o}(r,o,n.lineHeight);return{itemWidth:s,itemHeight:l}}(o,e,s,ee,r);le>0&&z+xe+2*h>T&&(I+=R+h,b.push({width:R,height:z}),W+=R+h,X++,R=z=0),g[le]={left:W,top:z,col:X,width:ve,height:xe},R=Math.max(R,ve),z+=xe+h}),I+=R,b.push({width:R,height:z}),I}adjustHitBoxes(){if(!this.options.display)return;const n=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:o,labels:{padding:r},rtl:s}}=this,l=yy(s,this.left,this.width);if(this.isHorizontal()){let h=0,g=ca(o,this.left+r,this.right-this.lineWidths[h]);for(const b of e)h!==b.row&&(h=b.row,g=ca(o,this.left+r,this.right-this.lineWidths[h])),b.top+=this.top+n+r,b.left=l.leftForLtr(l.x(g),b.width),g+=b.width+r}else{let h=0,g=ca(o,this.top+n+r,this.bottom-this.columnSizes[h].height);for(const b of e)b.col!==h&&(h=b.col,g=ca(o,this.top+n+r,this.bottom-this.columnSizes[h].height)),b.top=g,b.left+=this.left+r,b.left=l.leftForLtr(l.x(b.left),b.width),g+=b.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const n=this.ctx;oC(n,this),this._draw(),rC(n)}}_draw(){const{options:n,columnSizes:e,lineWidths:o,ctx:r}=this,{align:s,labels:l}=n,h=Zr.color,g=yy(n.rtl,this.left,this.width),b=ys(l.font),{padding:T}=l,I=b.size,R=I/2;let z;this.drawTitle(),r.textAlign=g.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=b.string;const{boxWidth:W,boxHeight:X,itemHeight:ee}=Az(l,I),xe=this.isHorizontal(),Be=this._computeTitleHeight();z=xe?{x:ca(s,this.left+T,this.right-o[0]),y:this.top+T+Be,line:0}:{x:this.left+T,y:ca(s,this.top+Be+T,this.bottom-e[0].height),line:0},b3(this.ctx,n.textDirection);const Ke=ee+T;this.legendItems.forEach((ft,Vt)=>{r.strokeStyle=ft.fontColor,r.fillStyle=ft.fontColor;const Nt=r.measureText(ft.text).width,Ut=g.textAlign(ft.textAlign||(ft.textAlign=l.textAlign)),Pn=W+R+Nt;let Qn=z.x,ki=z.y;g.setWidth(this.width),xe?Vt>0&&Qn+Pn+T>this.right&&(ki=z.y+=Ke,z.line++,Qn=z.x=ca(s,this.left+T,this.right-o[z.line])):Vt>0&&ki+Ke>this.bottom&&(Qn=z.x=Qn+e[z.line].width+T,z.line++,ki=z.y=ca(s,this.top+Be+T,this.bottom-e[z.line].height)),function(ft,Vt,Nt){if(isNaN(W)||W<=0||isNaN(X)||X<0)return;r.save();const Ut=Oi(Nt.lineWidth,1);if(r.fillStyle=Oi(Nt.fillStyle,h),r.lineCap=Oi(Nt.lineCap,"butt"),r.lineDashOffset=Oi(Nt.lineDashOffset,0),r.lineJoin=Oi(Nt.lineJoin,"miter"),r.lineWidth=Ut,r.strokeStyle=Oi(Nt.strokeStyle,h),r.setLineDash(Oi(Nt.lineDash,[])),l.usePointStyle){const Pn={radius:X*Math.SQRT2/2,pointStyle:Nt.pointStyle,rotation:Nt.rotation,borderWidth:Ut},Qn=g.xPlus(ft,W/2);a3(r,Pn,Qn,Vt+R,l.pointStyleWidth&&W)}else{const Pn=Vt+Math.max((I-X)/2,0),Qn=g.leftForLtr(ft,W),ki=hg(Nt.borderRadius);r.beginPath(),Object.values(ki).some(Jo=>0!==Jo)?u0(r,{x:Qn,y:Pn,w:W,h:X,radius:ki}):r.rect(Qn,Pn,W,X),r.fill(),0!==Ut&&r.stroke()}r.restore()}(g.x(Qn),ki,ft),Qn=((t,n,e,o)=>t===(o?"left":"right")?e:"center"===t?(n+e)/2:n)(Ut,Qn+W+R,xe?Qn+Pn:this.right,n.rtl),function(ft,Vt,Nt){dg(r,Nt.text,ft,Vt+ee/2,b,{strikethrough:Nt.hidden,textAlign:g.textAlign(Nt.textAlign)})}(g.x(Qn),ki,ft),xe?z.x+=Pn+T:z.y+="string"!=typeof ft.text?Oz(ft,b.lineHeight):Ke}),x3(this.ctx,n.textDirection)}drawTitle(){const n=this.options,e=n.title,o=ys(e.font),r=ua(e.padding);if(!e.display)return;const s=yy(n.rtl,this.left,this.width),l=this.ctx,h=e.position,b=r.top+o.size/2;let T,I=this.left,R=this.width;if(this.isHorizontal())R=Math.max(...this.lineWidths),T=this.top+b,I=ca(n.align,I,this.right-R);else{const W=this.columnSizes.reduce((X,ee)=>Math.max(X,ee.height),0);T=b+ca(n.align,this.top,this.bottom-W-n.labels.padding-this._computeTitleHeight())}const z=ca(h,I,I+R);l.textAlign=s.textAlign(_M(h)),l.textBaseline="middle",l.strokeStyle=e.color,l.fillStyle=e.color,l.font=o.string,dg(l,e.text,z,T,o)}_computeTitleHeight(){const n=this.options.title,e=ys(n.font),o=ua(n.padding);return n.display?e.lineHeight+o.height:0}_getLegendItemAt(n,e){let o,r,s;if(Nh(n,this.left,this.right)&&Nh(e,this.top,this.bottom))for(s=this.legendHitBoxes,o=0;o<s.length;++o)if(r=s[o],Nh(n,r.left,r.left+r.width)&&Nh(e,r.top,r.top+r.height))return this.legendItems[o];return null}handleEvent(n){const e=this.options;if(!function xae(t,n){return!(("mousemove"!==t&&"mouseout"!==t||!n.onHover&&!n.onLeave)&&(!n.onClick||"click"!==t&&"mouseup"!==t))}(n.type,e))return;const o=this._getLegendItemAt(n.x,n.y);if("mousemove"===n.type||"mouseout"===n.type){const r=this._hoveredItem,s=((t,n)=>null!==t&&null!==n&&t.datasetIndex===n.datasetIndex&&t.index===n.index)(r,o);r&&!s&&$o(e.onLeave,[n,r,this],this),this._hoveredItem=o,o&&!s&&$o(e.onHover,[n,o,this],this)}else o&&$o(e.onClick,[n,o,this],this)}}function Oz(t,n){return n*(t.text?t.text.length+.5:0)}var wae={id:"legend",_element:Pz,start(t,n,e){const o=t.legend=new Pz({ctx:t.ctx,options:e,chart:t});da.configure(t,o,e),da.addBox(t,o)},stop(t){da.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,n,e){const o=t.legend;da.configure(t,o,e),o.options=e},afterUpdate(t){const n=t.legend;n.buildLabels(),n.adjustHitBoxes()},afterEvent(t,n){n.replay||t.legend.handleEvent(n.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,n,e){const o=n.datasetIndex,r=e.chart;r.isDatasetVisible(o)?(r.hide(o),n.hidden=!0):(r.show(o),n.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const n=t.data.datasets,{labels:{usePointStyle:e,pointStyle:o,textAlign:r,color:s,useBorderRadius:l,borderRadius:h}}=t.legend.options;return t._getSortedDatasetMetas().map(g=>{const b=g.controller.getStyle(e?0:void 0),T=ua(b.borderWidth);return{text:n[g.index].label,fillStyle:b.backgroundColor,fontColor:s,hidden:!g.visible,lineCap:b.borderCapStyle,lineDash:b.borderDash,lineDashOffset:b.borderDashOffset,lineJoin:b.borderJoinStyle,lineWidth:(T.width+T.height)/4,strokeStyle:b.borderColor,pointStyle:o||b.pointStyle,rotation:b.rotation,textAlign:r||b.textAlign,borderRadius:l&&(h||b.borderRadius),datasetIndex:g.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class $M extends _u{constructor(n){super(),this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,e){const o=this.options;if(this.left=0,this.top=0,!o.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=n,this.height=this.bottom=e;const r=Yo(o.text)?o.text.length:1;this._padding=ua(o.padding);const s=r*ys(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const n=this.options.position;return"top"===n||"bottom"===n}_drawArgs(n){const{top:e,left:o,bottom:r,right:s,options:l}=this,h=l.align;let b,T,I,g=0;return this.isHorizontal()?(T=ca(h,o,s),I=e+n,b=s-o):("left"===l.position?(T=o+n,I=ca(h,r,e),g=-.5*ar):(T=s-n,I=ca(h,e,r),g=.5*ar),b=r-e),{titleX:T,titleY:I,maxWidth:b,rotation:g}}draw(){const n=this.ctx,e=this.options;if(!e.display)return;const o=ys(e.font),s=o.lineHeight/2+this._padding.top,{titleX:l,titleY:h,maxWidth:g,rotation:b}=this._drawArgs(s);dg(n,e.text,0,0,o,{color:e.color,maxWidth:g,rotation:b,textAlign:_M(e.align),textBaseline:"middle",translation:[l,h]})}}var Tae={id:"title",_element:$M,start(t,n,e){!function Cae(t,n){const e=new $M({ctx:t.ctx,options:n,chart:t});da.configure(t,e,n),da.addBox(t,e),t.titleBlock=e}(t,e)},stop(t){da.removeBox(t,t.titleBlock),delete t.titleBlock},beforeUpdate(t,n,e){const o=t.titleBlock;da.configure(t,o,e),o.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const wC=new WeakMap;var Eae={id:"subtitle",start(t,n,e){const o=new $M({ctx:t.ctx,options:e,chart:t});da.configure(t,o,e),da.addBox(t,o),wC.set(t,o)},stop(t){da.removeBox(t,wC.get(t)),wC.delete(t)},beforeUpdate(t,n,e){const o=wC.get(t);da.configure(t,o,e),o.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const b0={average(t){if(!t.length)return!1;let n,e,o=0,r=0,s=0;for(n=0,e=t.length;n<e;++n){const l=t[n].element;if(l&&l.hasValue()){const h=l.tooltipPosition();o+=h.x,r+=h.y,++s}}return{x:o/s,y:r/s}},nearest(t,n){if(!t.length)return!1;let s,l,h,e=n.x,o=n.y,r=Number.POSITIVE_INFINITY;for(s=0,l=t.length;s<l;++s){const g=t[s].element;if(g&&g.hasValue()){const T=mM(n,g.getCenterPoint());T<r&&(r=T,h=g)}}if(h){const g=h.tooltipPosition();e=g.x,o=g.y}return{x:e,y:o}}};function Td(t,n){return n&&(Yo(n)?Array.prototype.push.apply(t,n):t.push(n)),t}function Uh(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function Sae(t,n){const{element:e,datasetIndex:o,index:r}=n,s=t.getDatasetMeta(o).controller,{label:l,value:h}=s.getLabelAndValue(r);return{chart:t,label:l,parsed:s.getParsed(r),raw:t.data.datasets[o].data[r],formattedValue:h,dataset:s.getDataset(),dataIndex:r,datasetIndex:o,element:e}}function Rz(t,n){const e=t.chart.ctx,{body:o,footer:r,title:s}=t,{boxWidth:l,boxHeight:h}=n,g=ys(n.bodyFont),b=ys(n.titleFont),T=ys(n.footerFont),I=s.length,R=r.length,z=o.length,W=ua(n.padding);let X=W.height,ee=0,le=o.reduce((Be,Ke)=>Be+Ke.before.length+Ke.lines.length+Ke.after.length,0);le+=t.beforeBody.length+t.afterBody.length,I&&(X+=I*b.lineHeight+(I-1)*n.titleSpacing+n.titleMarginBottom),le&&(X+=z*(n.displayColors?Math.max(h,g.lineHeight):g.lineHeight)+(le-z)*g.lineHeight+(le-1)*n.bodySpacing),R&&(X+=n.footerMarginTop+R*T.lineHeight+(R-1)*n.footerSpacing);let ve=0;const xe=function(Be){ee=Math.max(ee,e.measureText(Be).width+ve)};return e.save(),e.font=b.string,Ro(t.title,xe),e.font=g.string,Ro(t.beforeBody.concat(t.afterBody),xe),ve=n.displayColors?l+2+n.boxPadding:0,Ro(o,Be=>{Ro(Be.before,xe),Ro(Be.lines,xe),Ro(Be.after,xe)}),ve=0,e.font=T.string,Ro(t.footer,xe),e.restore(),ee+=W.width,{width:ee,height:X}}function Iae(t,n,e,o){const{x:r,width:s}=e,{width:l,chartArea:{left:h,right:g}}=t;let b="center";return"center"===o?b=r<=(h+g)/2?"left":"right":r<=s/2?b="left":r>=l-s/2&&(b="right"),function Mae(t,n,e,o){const{x:r,width:s}=o,l=e.caretSize+e.caretPadding;if("left"===t&&r+s+l>n.width||"right"===t&&r-s-l<0)return!0}(b,t,n,e)&&(b="center"),b}function Lz(t,n,e){const o=e.yAlign||n.yAlign||function Dae(t,n){const{y:e,height:o}=n;return e<o/2?"top":e>t.height-o/2?"bottom":"center"}(t,e);return{xAlign:e.xAlign||n.xAlign||Iae(t,n,e,o),yAlign:o}}function Fz(t,n,e,o){const{caretSize:r,caretPadding:s,cornerRadius:l}=t,{xAlign:h,yAlign:g}=e,b=r+s,{topLeft:T,topRight:I,bottomLeft:R,bottomRight:z}=hg(l);let W=function kae(t,n){let{x:e,width:o}=t;return"right"===n?e-=o:"center"===n&&(e-=o/2),e}(n,h);const X=function Aae(t,n,e){let{y:o,height:r}=t;return"top"===n?o+=e:o-="bottom"===n?r+e:r/2,o}(n,g,b);return"center"===g?"left"===h?W+=b:"right"===h&&(W-=b):"left"===h?W-=Math.max(T,R)+r:"right"===h&&(W+=Math.max(I,z)+r),{x:As(W,0,o.width-n.width),y:As(X,0,o.height-n.height)}}function CC(t,n,e){const o=ua(e.padding);return"center"===n?t.x+t.width/2:"right"===n?t.x+t.width-o.right:t.x+o.left}function zz(t){return Td([],Uh(t))}function Nz(t,n){const e=n&&n.dataset&&n.dataset.tooltip&&n.dataset.tooltip.callbacks;return e?t.override(e):t}const Bz={beforeTitle:zh,title(t){if(t.length>0){const n=t[0],e=n.chart.data.labels,o=e?e.length:0;if(this&&this.options&&"dataset"===this.options.mode)return n.dataset.label||"";if(n.label)return n.label;if(o>0&&n.dataIndex<o)return e[n.dataIndex]}return""},afterTitle:zh,beforeBody:zh,beforeLabel:zh,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let n=t.dataset.label||"";n&&(n+=": ");const e=t.formattedValue;return yo(e)||(n+=e),n},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:zh,afterBody:zh,beforeFooter:zh,footer:zh,afterFooter:zh};function ol(t,n,e,o){const r=t[n].call(e,o);return typeof r>"u"?Bz[n].call(e,o):r}let Vz=(()=>{class t extends _u{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const o=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&o.options.animation&&r.animations,l=new I3(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=function Pae(t,n,e){return bf(t,{tooltip:n,tooltipItems:e,type:"tooltip"})}(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,o){const{callbacks:r}=o,s=ol(r,"beforeTitle",this,e),l=ol(r,"title",this,e),h=ol(r,"afterTitle",this,e);let g=[];return g=Td(g,Uh(s)),g=Td(g,Uh(l)),g=Td(g,Uh(h)),g}getBeforeBody(e,o){return zz(ol(o.callbacks,"beforeBody",this,e))}getBody(e,o){const{callbacks:r}=o,s=[];return Ro(e,l=>{const h={before:[],lines:[],after:[]},g=Nz(r,l);Td(h.before,Uh(ol(g,"beforeLabel",this,l))),Td(h.lines,ol(g,"label",this,l)),Td(h.after,Uh(ol(g,"afterLabel",this,l))),s.push(h)}),s}getAfterBody(e,o){return zz(ol(o.callbacks,"afterBody",this,e))}getFooter(e,o){const{callbacks:r}=o,s=ol(r,"beforeFooter",this,e),l=ol(r,"footer",this,e),h=ol(r,"afterFooter",this,e);let g=[];return g=Td(g,Uh(s)),g=Td(g,Uh(l)),g=Td(g,Uh(h)),g}_createItems(e){const o=this._active,r=this.chart.data,s=[],l=[],h=[];let b,T,g=[];for(b=0,T=o.length;b<T;++b)g.push(Sae(this.chart,o[b]));return e.filter&&(g=g.filter((I,R,z)=>e.filter(I,R,z,r))),e.itemSort&&(g=g.sort((I,R)=>e.itemSort(I,R,r))),Ro(g,I=>{const R=Nz(e.callbacks,I);s.push(ol(R,"labelColor",this,I)),l.push(ol(R,"labelPointStyle",this,I)),h.push(ol(R,"labelTextColor",this,I))}),this.labelColors=s,this.labelPointStyles=l,this.labelTextColors=h,this.dataPoints=g,g}update(e,o){const r=this.options.setContext(this.getContext()),s=this._active;let l,h=[];if(s.length){const g=b0[r.position].call(this,s,this._eventPosition);h=this._createItems(r),this.title=this.getTitle(h,r),this.beforeBody=this.getBeforeBody(h,r),this.body=this.getBody(h,r),this.afterBody=this.getAfterBody(h,r),this.footer=this.getFooter(h,r);const b=this._size=Rz(this,r),T=Object.assign({},g,b),I=Lz(this.chart,r,T),R=Fz(r,T,I,this.chart);this.xAlign=I.xAlign,this.yAlign=I.yAlign,l={opacity:1,x:R.x,y:R.y,width:b.width,height:b.height,caretX:g.x,caretY:g.y}}else 0!==this.opacity&&(l={opacity:0});this._tooltipItems=h,this.$context=void 0,l&&this._resolveAnimations().update(this,l),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:o})}drawCaret(e,o,r,s){const l=this.getCaretPosition(e,r,s);o.lineTo(l.x1,l.y1),o.lineTo(l.x2,l.y2),o.lineTo(l.x3,l.y3)}getCaretPosition(e,o,r){const{xAlign:s,yAlign:l}=this,{caretSize:h,cornerRadius:g}=r,{topLeft:b,topRight:T,bottomLeft:I,bottomRight:R}=hg(g),{x:z,y:W}=e,{width:X,height:ee}=o;let le,ve,xe,Be,Ke,ft;return"center"===l?(Ke=W+ee/2,"left"===s?(le=z,ve=le-h,Be=Ke+h,ft=Ke-h):(le=z+X,ve=le+h,Be=Ke-h,ft=Ke+h),xe=le):(ve="left"===s?z+Math.max(b,I)+h:"right"===s?z+X-Math.max(T,R)-h:this.caretX,"top"===l?(Be=W,Ke=Be-h,le=ve-h,xe=ve+h):(Be=W+ee,Ke=Be+h,le=ve+h,xe=ve-h),ft=Be),{x1:le,x2:ve,x3:xe,y1:Be,y2:Ke,y3:ft}}drawTitle(e,o,r){const s=this.title,l=s.length;let h,g,b;if(l){const T=yy(r.rtl,this.x,this.width);for(e.x=CC(this,r.titleAlign,r),o.textAlign=T.textAlign(r.titleAlign),o.textBaseline="middle",h=ys(r.titleFont),g=r.titleSpacing,o.fillStyle=r.titleColor,o.font=h.string,b=0;b<l;++b)o.fillText(s[b],T.x(e.x),e.y+h.lineHeight/2),e.y+=h.lineHeight+g,b+1===l&&(e.y+=r.titleMarginBottom-g)}}_drawColorBox(e,o,r,s,l){const h=this.labelColors[r],g=this.labelPointStyles[r],{boxHeight:b,boxWidth:T,boxPadding:I}=l,R=ys(l.bodyFont),z=CC(this,"left",l),W=s.x(z),ee=o.y+(b<R.lineHeight?(R.lineHeight-b)/2:0);if(l.usePointStyle){const le={radius:Math.min(T,b)/2,pointStyle:g.pointStyle,rotation:g.rotation,borderWidth:1},ve=s.leftForLtr(W,T)+T/2,xe=ee+b/2;e.strokeStyle=l.multiKeyBackground,e.fillStyle=l.multiKeyBackground,xM(e,le,ve,xe),e.strokeStyle=h.borderColor,e.fillStyle=h.backgroundColor,xM(e,le,ve,xe)}else{e.lineWidth=io(h.borderWidth)?Math.max(...Object.values(h.borderWidth)):h.borderWidth||1,e.strokeStyle=h.borderColor,e.setLineDash(h.borderDash||[]),e.lineDashOffset=h.borderDashOffset||0;const le=s.leftForLtr(W,T-I),ve=s.leftForLtr(s.xPlus(W,1),T-I-2),xe=hg(h.borderRadius);Object.values(xe).some(Be=>0!==Be)?(e.beginPath(),e.fillStyle=l.multiKeyBackground,u0(e,{x:le,y:ee,w:T,h:b,radius:xe}),e.fill(),e.stroke(),e.fillStyle=h.backgroundColor,e.beginPath(),u0(e,{x:ve,y:ee+1,w:T-2,h:b-2,radius:xe}),e.fill()):(e.fillStyle=l.multiKeyBackground,e.fillRect(le,ee,T,b),e.strokeRect(le,ee,T,b),e.fillStyle=h.backgroundColor,e.fillRect(ve,ee+1,T-2,b-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,o,r){const{body:s}=this,{bodySpacing:l,bodyAlign:h,displayColors:g,boxHeight:b,boxWidth:T,boxPadding:I}=r,R=ys(r.bodyFont);let z=R.lineHeight,W=0;const X=yy(r.rtl,this.x,this.width),ee=function(Ut){o.fillText(Ut,X.x(e.x+W),e.y+z/2),e.y+=z+l},le=X.textAlign(h);let ve,xe,Be,Ke,ft,Vt,Nt;for(o.textAlign=h,o.textBaseline="middle",o.font=R.string,e.x=CC(this,le,r),o.fillStyle=r.bodyColor,Ro(this.beforeBody,ee),W=g&&"right"!==le?"center"===h?T/2+I:T+2+I:0,Ke=0,Vt=s.length;Ke<Vt;++Ke){for(ve=s[Ke],xe=this.labelTextColors[Ke],o.fillStyle=xe,Ro(ve.before,ee),Be=ve.lines,g&&Be.length&&(this._drawColorBox(o,e,Ke,X,r),z=Math.max(R.lineHeight,b)),ft=0,Nt=Be.length;ft<Nt;++ft)ee(Be[ft]),z=R.lineHeight;Ro(ve.after,ee)}W=0,z=R.lineHeight,Ro(this.afterBody,ee),e.y-=l}drawFooter(e,o,r){const s=this.footer,l=s.length;let h,g;if(l){const b=yy(r.rtl,this.x,this.width);for(e.x=CC(this,r.footerAlign,r),e.y+=r.footerMarginTop,o.textAlign=b.textAlign(r.footerAlign),o.textBaseline="middle",h=ys(r.footerFont),o.fillStyle=r.footerColor,o.font=h.string,g=0;g<l;++g)o.fillText(s[g],b.x(e.x),e.y+h.lineHeight/2),e.y+=h.lineHeight+r.footerSpacing}}drawBackground(e,o,r,s){const{xAlign:l,yAlign:h}=this,{x:g,y:b}=e,{width:T,height:I}=r,{topLeft:R,topRight:z,bottomLeft:W,bottomRight:X}=hg(s.cornerRadius);o.fillStyle=s.backgroundColor,o.strokeStyle=s.borderColor,o.lineWidth=s.borderWidth,o.beginPath(),o.moveTo(g+R,b),"top"===h&&this.drawCaret(e,o,r,s),o.lineTo(g+T-z,b),o.quadraticCurveTo(g+T,b,g+T,b+z),"center"===h&&"right"===l&&this.drawCaret(e,o,r,s),o.lineTo(g+T,b+I-X),o.quadraticCurveTo(g+T,b+I,g+T-X,b+I),"bottom"===h&&this.drawCaret(e,o,r,s),o.lineTo(g+W,b+I),o.quadraticCurveTo(g,b+I,g,b+I-W),"center"===h&&"left"===l&&this.drawCaret(e,o,r,s),o.lineTo(g,b+R),o.quadraticCurveTo(g,b,g+R,b),o.closePath(),o.fill(),s.borderWidth>0&&o.stroke()}_updateAnimationTarget(e){const o=this.chart,r=this.$animations,s=r&&r.x,l=r&&r.y;if(s||l){const h=b0[e.position].call(this,this._active,this._eventPosition);if(!h)return;const g=this._size=Rz(this,e),b=Object.assign({},h,this._size),T=Lz(o,e,b),I=Fz(e,b,T,o);(s._to!==I.x||l._to!==I.y)&&(this.xAlign=T.xAlign,this.yAlign=T.yAlign,this.width=g.width,this.height=g.height,this.caretX=h.x,this.caretY=h.y,this._resolveAnimations().update(this,I))}}_willRender(){return!!this.opacity}draw(e){const o=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(o);const s={width:this.width,height:this.height},l={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const h=ua(o.padding);o.enabled&&(this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length)&&(e.save(),e.globalAlpha=r,this.drawBackground(l,e,s,o),b3(e,o.textDirection),l.y+=h.top,this.drawTitle(l,e,o),this.drawBody(l,e,o),this.drawFooter(l,e,o),x3(e,o.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,o){const r=this._active,s=e.map(({datasetIndex:g,index:b})=>{const T=this.chart.getDatasetMeta(g);if(!T)throw new Error("Cannot find a dataset at index "+g);return{datasetIndex:g,element:T.data[b],index:b}}),l=!Qw(r,s),h=this._positionChanged(s,o);(l||h)&&(this._active=s,this._eventPosition=o,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,o,r=!0){if(o&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,l=this._active||[],h=this._getActiveElements(e,l,o,r),g=this._positionChanged(h,e),b=o||!Qw(h,l)||g;return b&&(this._active=h,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,o))),b}_getActiveElements(e,o,r,s){const l=this.options;if("mouseout"===e.type)return[];if(!s)return o;const h=this.chart.getElementsAtEventForMode(e,l.mode,l,r);return l.reverse&&h.reverse(),h}_positionChanged(e,o){const{caretX:r,caretY:s,options:l}=this,h=b0[l.position].call(this,e,o);return!1!==h&&(r!==h.x||s!==h.y)}}return Ln(t,"positioners",b0),t})();var Rae=Object.freeze({__proto__:null,Colors:Wse,Decimation:Xse,Filler:gae,Legend:wae,SubTitle:Eae,Title:Tae,Tooltip:{id:"tooltip",_element:Vz,positioners:b0,afterInit(t,n,e){e&&(t.tooltip=new Vz({chart:t,options:e}))},beforeUpdate(t,n,e){t.tooltip&&t.tooltip.initialize(e)},reset(t,n,e){t.tooltip&&t.tooltip.initialize(e)},afterDraw(t){const n=t.tooltip;if(n&&n._willRender()){const e={tooltip:n};if(!1===t.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0}))return;n.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",e)}},afterEvent(t,n){t.tooltip&&t.tooltip.handleEvent(n.event,n.replay,n.inChartArea)&&(n.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,n)=>n.bodyFont.size,boxWidth:(t,n)=>n.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Bz},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]}});function Uz(t){const n=this.getLabels();return t>=0&&t<n.length?n[t]:t}let Nae=(()=>{class t extends _g{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const o=this._addedLabels;if(o.length){const r=this.getLabels();for(const{index:s,label:l}of o)r[s]===l&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,o){if(yo(e))return null;const r=this.getLabels();return o=isFinite(o)&&r[o]===e?o:function Fae(t,n,e,o){const r=t.indexOf(n);return-1===r?((t,n,e,o)=>("string"==typeof n?(e=t.push(n)-1,o.unshift({index:e,label:n})):isNaN(n)&&(e=null),e))(t,n,e,o):r!==t.lastIndexOf(n)?e:r}(r,e,Oi(o,e),this._addedLabels),((t,n)=>null===t?null:As(Math.round(t),0,n))(o,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:o}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(r=0),o||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,o=this.max,r=this.options.offset,s=[];let l=this.getLabels();l=0===e&&o===l.length-1?l:l.slice(e,o+1),this._valueRange=Math.max(l.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let h=e;h<=o;h++)s.push({value:h});return s}getLabelForValue(e){return Uz.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!=typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const o=this.ticks;return e<0||e>o.length-1?null:this.getPixelForValue(o[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}return Ln(t,"id","category"),Ln(t,"defaults",{ticks:{callback:Uz}}),t})();function jz(t,n,{horizontal:e,minRotation:o}){const r=gu(o),s=(e?Math.sin(r):Math.cos(r))||.001;return Math.min(n/s,.75*n*(""+t).length)}class TC extends _g{constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(n,e){return yo(n)||("number"==typeof n||n instanceof Number)&&!isFinite(+n)?null:+n}handleTickRangeOptions(){const{beginAtZero:n}=this.options,{minDefined:e,maxDefined:o}=this.getUserBounds();let{min:r,max:s}=this;const l=g=>r=e?r:g,h=g=>s=o?s:g;if(n){const g=wd(r),b=wd(s);g<0&&b<0?h(0):g>0&&b>0&&l(0)}if(r===s){let g=0===s?1:Math.abs(.05*s);h(s+g),n||l(r-g)}this.min=r,this.max=s}getTickLimit(){const n=this.options.ticks;let r,{maxTicksLimit:e,stepSize:o}=n;return o?(r=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),e=e||11),e&&(r=Math.min(e,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const n=this.options,e=n.ticks;let o=this.getTickLimit();o=Math.max(2,o);const l=function Bae(t,n){const e=[],{bounds:r,step:s,min:l,max:h,precision:g,count:b,maxTicks:T,maxDigits:I,includeBounds:R}=t,z=s||1,W=T-1,{min:X,max:ee}=n,le=!yo(l),ve=!yo(h),xe=!yo(b),Be=(ee-X)/(I+1);let ft,Vt,Nt,Ut,Ke=jF((ee-X)/W/z)*z;if(Ke<1e-14&&!le&&!ve)return[{value:X},{value:ee}];Ut=Math.ceil(ee/Ke)-Math.floor(X/Ke),Ut>W&&(Ke=jF(Ut*Ke/W/z)*z),yo(g)||(ft=Math.pow(10,g),Ke=Math.ceil(Ke*ft)/ft),"ticks"===r?(Vt=Math.floor(X/Ke)*Ke,Nt=Math.ceil(ee/Ke)*Ke):(Vt=X,Nt=ee),le&&ve&&s&&function Iie(t,n){const e=Math.round(t);return e-n<=t&&e+n>=t}((h-l)/s,Ke/1e3)?(Ut=Math.round(Math.min((h-l)/Ke,T)),Ke=(h-l)/Ut,Vt=l,Nt=h):xe?(Vt=le?l:Vt,Nt=ve?h:Nt,Ut=b-1,Ke=(Nt-Vt)/Ut):(Ut=(Nt-Vt)/Ke,Ut=o0(Ut,Math.round(Ut),Ke/1e3)?Math.round(Ut):Math.ceil(Ut));const Pn=Math.max($F(Ke),$F(Vt));ft=Math.pow(10,yo(g)?Pn:g),Vt=Math.round(Vt*ft)/ft,Nt=Math.round(Nt*ft)/ft;let Qn=0;for(le&&(R&&Vt!==l?(e.push({value:l}),Vt<l&&Qn++,o0(Math.round((Vt+Qn*Ke)*ft)/ft,l,jz(l,Be,t))&&Qn++):Vt<l&&Qn++);Qn<Ut;++Qn)e.push({value:Math.round((Vt+Qn*Ke)*ft)/ft});return ve&&R&&Nt!==h?e.length&&o0(e[e.length-1].value,h,jz(h,Be,t))?e[e.length-1].value=h:e.push({value:h}):(!ve||Nt===h)&&e.push({value:Nt}),e}({maxTicks:o,bounds:n.bounds,min:n.min,max:n.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===n.bounds&&HF(l,this,"value"),n.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const n=this.ticks;let e=this.min,o=this.max;if(super.configure(),this.options.offset&&n.length){const r=(o-e)/Math.max(n.length-1,1)/2;e-=r,o+=r}this._startValue=e,this._endValue=o,this._valueRange=o-e}getLabelForValue(n){return a0(n,this.chart.options.locale,this.options.ticks.format)}}class GM extends TC{determineDataLimits(){const{min:n,max:e}=this.getMinMax(!0);this.min=Mr(n)?n:0,this.max=Mr(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const n=this.isHorizontal(),e=n?this.width:this.height,o=gu(this.options.ticks.minRotation),r=(n?Math.sin(o):Math.cos(o))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,s.lineHeight/r))}getPixelForValue(n){return null===n?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getValueForPixel(n){return this._startValue+this.getDecimalForPixel(n)*this._valueRange}}Ln(GM,"id","linear"),Ln(GM,"defaults",{ticks:{callback:nC.formatters.numeric}});const x0=t=>Math.floor(vf(t)),yg=(t,n)=>Math.pow(10,x0(t)+n);function Hz(t){return t/Math.pow(10,x0(t))==1}function $z(t,n,e){const o=Math.pow(10,e),r=Math.floor(t/o);return Math.ceil(n/o)-r}class WM extends _g{constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(n,e){const o=TC.prototype.parse.apply(this,[n,e]);if(0!==o)return Mr(o)&&o>0?o:null;this._zero=!0}determineDataLimits(){const{min:n,max:e}=this.getMinMax(!0);this.min=Mr(n)?Math.max(0,n):null,this.max=Mr(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Mr(this._userMin)&&(this.min=n===yg(this.min,0)?yg(this.min,-1):yg(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:n,maxDefined:e}=this.getUserBounds();let o=this.min,r=this.max;const s=h=>o=n?o:h,l=h=>r=e?r:h;o===r&&(o<=0?(s(1),l(10)):(s(yg(o,-1)),l(yg(r,1)))),o<=0&&s(yg(r,-1)),r<=0&&l(yg(o,1)),this.min=o,this.max=r}buildTicks(){const n=this.options,o=function Uae(t,{min:n,max:e}){n=kl(t.min,n);const o=[],r=x0(n);let s=function Vae(t,n){let o=x0(n-t);for(;$z(t,n,o)>10;)o++;for(;$z(t,n,o)<10;)o--;return Math.min(o,x0(t))}(n,e),l=s<0?Math.pow(10,Math.abs(s)):1;const h=Math.pow(10,s),g=r>s?Math.pow(10,r):0,b=Math.round((n-g)*l)/l,T=Math.floor((n-g)/h/10)*h*10;let I=Math.floor((b-T)/Math.pow(10,s)),R=kl(t.min,Math.round((g+T+I*Math.pow(10,s))*l)/l);for(;R<e;)o.push({value:R,major:Hz(R),significand:I}),I>=10?I=I<15?15:20:I++,I>=20&&(s++,I=2,l=s>=0?1:l),R=Math.round((g+T+I*Math.pow(10,s))*l)/l;const z=kl(t.max,R);return o.push({value:z,major:Hz(z),significand:I}),o}({min:this._userMin,max:this._userMax},this);return"ticks"===n.bounds&&HF(o,this,"value"),n.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}getLabelForValue(n){return void 0===n?"0":a0(n,this.chart.options.locale,this.options.ticks.format)}configure(){const n=this.min;super.configure(),this._startValue=vf(n),this._valueRange=vf(this.max)-vf(n)}getPixelForValue(n){return(void 0===n||0===n)&&(n=this.min),null===n||isNaN(n)?NaN:this.getPixelForDecimal(n===this.min?0:(vf(n)-this._startValue)/this._valueRange)}getValueForPixel(n){const e=this.getDecimalForPixel(n);return Math.pow(10,this._startValue+e*this._valueRange)}}function qM(t){const n=t.ticks;if(n.display&&t.display){const e=ua(n.backdropPadding);return Oi(n.font&&n.font.size,Zr.font.size)+e.height}return 0}function jae(t,n,e){return e=Yo(e)?e:[e],{w:Wie(t,n.string,e),h:e.length*n.lineHeight}}function Gz(t,n,e,o,r){return t===o||t===r?{start:n-e/2,end:n+e/2}:t<o||t>r?{start:n-e,end:n}:{start:n,end:n+e}}function $ae(t,n,e,o,r){const s=Math.abs(Math.sin(e)),l=Math.abs(Math.cos(e));let h=0,g=0;o.start<n.l?(h=(n.l-o.start)/s,t.l=Math.min(t.l,n.l-h)):o.end>n.r&&(h=(o.end-n.r)/s,t.r=Math.max(t.r,n.r+h)),r.start<n.t?(g=(n.t-r.start)/l,t.t=Math.min(t.t,n.t-g)):r.end>n.b&&(g=(r.end-n.b)/l,t.b=Math.max(t.b,n.b+g))}function Wae(t){return 0===t||180===t?"center":t<180?"left":"right"}function qae(t,n,e){return"right"===e?t-=n:"center"===e&&(t-=n/2),t}function Zae(t,n,e){return 90===e||270===e?t-=n/2:(e>270||e<90)&&(t-=n),t}function Wz(t,n,e,o){const{ctx:r}=t;if(e)r.arc(t.xCenter,t.yCenter,n,0,Qo);else{let s=t.getPointPosition(0,n);r.moveTo(s.x,s.y);for(let l=1;l<o;l++)s=t.getPointPosition(l,n),r.lineTo(s.x,s.y)}}Ln(WM,"id","logarithmic"),Ln(WM,"defaults",{ticks:{callback:nC.formatters.logarithmic,major:{enabled:!0}}});class w0 extends TC{constructor(n){super(n),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const n=this._padding=ua(qM(this.options)/2),e=this.width=this.maxWidth-n.width,o=this.height=this.maxHeight-n.height;this.xCenter=Math.floor(this.left+e/2+n.left),this.yCenter=Math.floor(this.top+o/2+n.top),this.drawingArea=Math.floor(Math.min(e,o)/2)}determineDataLimits(){const{min:n,max:e}=this.getMinMax(!1);this.min=Mr(n)&&!isNaN(n)?n:0,this.max=Mr(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/qM(this.options))}generateTickLabels(n){TC.prototype.generateTickLabels.call(this,n),this._pointLabels=this.getLabels().map((e,o)=>{const r=$o(this.options.pointLabels.callback,[e,o],this);return r||0===r?r:""}).filter((e,o)=>this.chart.getDataVisibility(o))}fit(){const n=this.options;n.display&&n.pointLabels.display?function Hae(t){const n={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},e=Object.assign({},n),o=[],r=[],s=t._pointLabels.length,l=t.options.pointLabels,h=l.centerPointLabels?ar/s:0;for(let g=0;g<s;g++){const b=l.setContext(t.getPointLabelContext(g));r[g]=b.padding;const T=t.getPointPosition(g,t.drawingArea+r[g],h),I=ys(b.font),R=jae(t.ctx,I,t._pointLabels[g]);o[g]=R;const z=Al(t.getIndexAngle(g)+h),W=Math.round(fM(z));$ae(e,n,z,Gz(W,T.x,R.w,0,180),Gz(W,T.y,R.h,90,270))}t.setCenterPoint(n.l-e.l,e.r-n.r,n.t-e.t,e.b-n.b),t._pointLabelItems=function Gae(t,n,e){const o=[],r=t._pointLabels.length,s=t.options,l=qM(s)/2,h=t.drawingArea,g=s.pointLabels.centerPointLabels?ar/r:0;for(let b=0;b<r;b++){const T=t.getPointPosition(b,h+l+e[b],g),I=Math.round(fM(Al(T.angle+Ir))),R=n[b],z=Zae(T.y,R.h,I),W=Wae(I),X=qae(T.x,R.w,W);o.push({x:T.x,y:z,textAlign:W,left:X,top:z,right:X+R.w,bottom:z+R.h})}return o}(t,o,r)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(n,e,o,r){this.xCenter+=Math.floor((n-e)/2),this.yCenter+=Math.floor((o-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(n,e,o,r))}getIndexAngle(n){return Al(n*(Qo/(this._pointLabels.length||1))+gu(this.options.startAngle||0))}getDistanceFromCenterForValue(n){if(yo(n))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-n)*e:(n-this.min)*e}getValueForDistanceFromCenter(n){if(yo(n))return NaN;const e=n/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(n){const e=this._pointLabels||[];if(n>=0&&n<e.length){const o=e[n];return function Yae(t,n,e){return bf(t,{label:e,index:n,type:"pointLabel"})}(this.getContext(),n,o)}}getPointPosition(n,e,o=0){const r=this.getIndexAngle(n)-Ir+o;return{x:Math.cos(r)*e+this.xCenter,y:Math.sin(r)*e+this.yCenter,angle:r}}getPointPositionForValue(n,e){return this.getPointPosition(n,this.getDistanceFromCenterForValue(e))}getBasePosition(n){return this.getPointPositionForValue(n||0,this.getBaseValue())}getPointLabelPosition(n){const{left:e,top:o,right:r,bottom:s}=this._pointLabelItems[n];return{left:e,top:o,right:r,bottom:s}}drawBackground(){const{backgroundColor:n,grid:{circular:e}}=this.options;if(n){const o=this.ctx;o.save(),o.beginPath(),Wz(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),o.closePath(),o.fillStyle=n,o.fill(),o.restore()}}drawGrid(){const n=this.ctx,e=this.options,{angleLines:o,grid:r,border:s}=e,l=this._pointLabels.length;let h,g,b;if(e.pointLabels.display&&function Kae(t,n){const{ctx:e,options:{pointLabels:o}}=t;for(let r=n-1;r>=0;r--){const s=o.setContext(t.getPointLabelContext(r)),l=ys(s.font),{x:h,y:g,textAlign:b,left:T,top:I,right:R,bottom:z}=t._pointLabelItems[r],{backdropColor:W}=s;if(!yo(W)){const X=hg(s.borderRadius),ee=ua(s.backdropPadding);e.fillStyle=W;const le=T-ee.left,ve=I-ee.top,xe=R-T+ee.width,Be=z-I+ee.height;Object.values(X).some(Ke=>0!==Ke)?(e.beginPath(),u0(e,{x:le,y:ve,w:xe,h:Be,radius:X}),e.fill()):e.fillRect(le,ve,xe,Be)}dg(e,t._pointLabels[r],h,g+l.lineHeight/2,l,{color:s.color,textAlign:b,textBaseline:"middle"})}}(this,l),r.display&&this.ticks.forEach((T,I)=>{if(0!==I){g=this.getDistanceFromCenterForValue(T.value);const R=this.getContext(I),z=r.setContext(R),W=s.setContext(R);!function Xae(t,n,e,o,r){const s=t.ctx,l=n.circular,{color:h,lineWidth:g}=n;!l&&!o||!h||!g||e<0||(s.save(),s.strokeStyle=h,s.lineWidth=g,s.setLineDash(r.dash),s.lineDashOffset=r.dashOffset,s.beginPath(),Wz(t,e,l,o),s.closePath(),s.stroke(),s.restore())}(this,z,g,l,W)}}),o.display){for(n.save(),h=l-1;h>=0;h--){const T=o.setContext(this.getPointLabelContext(h)),{color:I,lineWidth:R}=T;!R||!I||(n.lineWidth=R,n.strokeStyle=I,n.setLineDash(T.borderDash),n.lineDashOffset=T.borderDashOffset,g=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),b=this.getPointPosition(h,g),n.beginPath(),n.moveTo(this.xCenter,this.yCenter),n.lineTo(b.x,b.y),n.stroke())}n.restore()}}drawBorder(){}drawLabels(){const n=this.ctx,e=this.options,o=e.ticks;if(!o.display)return;const r=this.getIndexAngle(0);let s,l;n.save(),n.translate(this.xCenter,this.yCenter),n.rotate(r),n.textAlign="center",n.textBaseline="middle",this.ticks.forEach((h,g)=>{if(0===g&&!e.reverse)return;const b=o.setContext(this.getContext(g)),T=ys(b.font);if(s=this.getDistanceFromCenterForValue(this.ticks[g].value),b.showLabelBackdrop){n.font=T.string,l=n.measureText(h.label).width,n.fillStyle=b.backdropColor;const I=ua(b.backdropPadding);n.fillRect(-l/2-I.left,-s-T.size/2-I.top,l+I.width,T.size+I.height)}dg(n,h.label,0,-s,T,{color:b.color})}),n.restore()}drawTitle(){}}Ln(w0,"id","radialLinear"),Ln(w0,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:nC.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}}),Ln(w0,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Ln(w0,"descriptors",{angleLines:{_fallback:"grid"}});const EC={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},rl=Object.keys(EC);function Qae(t,n){return t-n}function qz(t,n){if(yo(n))return null;const e=t._adapter,{parser:o,round:r,isoWeekday:s}=t._parseOpts;let l=n;return"function"==typeof o&&(l=o(l)),Mr(l)||(l="string"==typeof o?e.parse(l,o):e.parse(l)),null===l?null:(r&&(l="week"!==r||!my(s)&&!0!==s?e.startOf(l,r):e.startOf(l,"isoWeek",s)),+l)}function Zz(t,n,e,o){const r=rl.length;for(let s=rl.indexOf(t);s<r-1;++s){const l=EC[rl[s]];if(l.common&&Math.ceil((e-n)/((l.steps?l.steps:Number.MAX_SAFE_INTEGER)*l.size))<=o)return rl[s]}return rl[r-1]}function Kz(t,n,e){if(e){if(e.length){const{lo:o,hi:r}=gM(e,n);t[e[o]>=n?e[o]:e[r]]=!0}}else t[n]=!0}function Xz(t,n,e){const o=[],r={},s=n.length;let l,h;for(l=0;l<s;++l)h=n[l],r[h]=l,o.push({value:h,major:!1});return 0!==s&&e?function tle(t,n,e,o){const r=t._adapter,s=+r.startOf(n[0].value,o),l=n[n.length-1].value;let h,g;for(h=s;h<=l;h=+r.add(h,1,o))g=e[h],g>=0&&(n[g].major=!0);return n}(t,o,r,e):o}let ZM=(()=>{class t extends _g{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,o={}){const r=e.time||(e.time={}),s=this._adapter=new dre__date(e.adapters.date);s.init(o),n0(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=o.normalized}parse(e,o){return void 0===e?null:qz(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,o=this._adapter,r=e.time.unit||"day";let{min:s,max:l,minDefined:h,maxDefined:g}=this.getUserBounds();function b(T){!h&&!isNaN(T.min)&&(s=Math.min(s,T.min)),!g&&!isNaN(T.max)&&(l=Math.max(l,T.max))}(!h||!g)&&(b(this._getLabelBounds()),("ticks"!==e.bounds||"labels"!==e.ticks.source)&&b(this.getMinMax(!1))),s=Mr(s)&&!isNaN(s)?s:+o.startOf(Date.now(),r),l=Mr(l)&&!isNaN(l)?l:+o.endOf(Date.now(),r)+1,this.min=Math.min(s,l-1),this.max=Math.max(s+1,l)}_getLabelBounds(){const e=this.getLabelTimestamps();let o=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(o=e[0],r=e[e.length-1]),{min:o,max:r}}buildTicks(){const e=this.options,o=e.time,r=e.ticks,s="labels"===r.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const l=this.min,g=function Oie(t,n,e){let o=0,r=t.length;for(;o<r&&t[o]<n;)o++;for(;r>o&&t[r-1]>e;)r--;return o>0||r<t.length?t.slice(o,r):t}(s,l,this.max);return this._unit=o.unit||(r.autoSkip?Zz(o.minUnit,this.min,this.max,this._getLabelCapacity(l)):function Jae(t,n,e,o,r){for(let s=rl.length-1;s>=rl.indexOf(e);s--){const l=rl[s];if(EC[l].common&&t._adapter.diff(r,o,l)>=n-1)return l}return rl[e?rl.indexOf(e):0]}(this,g.length,o.minUnit,this.min,this.max)),this._majorUnit=r.major.enabled&&"year"!==this._unit?function ele(t){for(let n=rl.indexOf(t)+1,e=rl.length;n<e;++n)if(EC[rl[n]].common)return rl[n]}(this._unit):void 0,this.initOffsets(s),e.reverse&&g.reverse(),Xz(this,g,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let s,l,o=0,r=0;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),o=1===e.length?1-s:(this.getDecimalForValue(e[1])-s)/2,l=this.getDecimalForValue(e[e.length-1]),r=1===e.length?l:(l-this.getDecimalForValue(e[e.length-2]))/2);const h=e.length<3?.5:.25;o=As(o,0,h),r=As(r,0,h),this._offsets={start:o,end:r,factor:1/(o+1+r)}}_generate(){const e=this._adapter,o=this.min,r=this.max,s=this.options,l=s.time,h=l.unit||Zz(l.minUnit,o,r,this._getLabelCapacity(o)),g=Oi(s.ticks.stepSize,1),b="week"===h&&l.isoWeekday,T=my(b)||!0===b,I={};let z,W,R=o;if(T&&(R=+e.startOf(R,"isoWeek",b)),R=+e.startOf(R,T?"day":h),e.diff(r,o,h)>1e5*g)throw new Error(o+" and "+r+" are too far apart with stepSize of "+g+" "+h);const X="data"===s.ticks.source&&this.getDataTimestamps();for(z=R,W=0;z<r;z=+e.add(z,g,h),W++)Kz(I,z,X);return(z===r||"ticks"===s.bounds||1===W)&&Kz(I,z,X),Object.keys(I).sort((ee,le)=>ee-le).map(ee=>+ee)}getLabelForValue(e){const r=this.options.time;return this._adapter.format(e,r.tooltipFormat?r.tooltipFormat:r.displayFormats.datetime)}format(e,o){return this._adapter.format(e,o||this.options.time.displayFormats[this._unit])}_tickFormatFunction(e,o,r,s){const l=this.options,h=l.ticks.callback;if(h)return $o(h,[e,o,r],this);const g=l.time.displayFormats,b=this._unit,T=this._majorUnit,R=T&&g[T],z=r[o];return this._adapter.format(e,s||(T&&R&&z&&z.major?R:b&&g[b]))}generateTickLabels(e){let o,r,s;for(o=0,r=e.length;o<r;++o)s=e[o],s.label=this._tickFormatFunction(s.value,o,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const o=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((o.start+r)*o.factor)}getValueForPixel(e){const o=this._offsets,r=this.getDecimalForPixel(e)/o.factor-o.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const o=this.options.ticks,r=this.ctx.measureText(e).width,s=gu(this.isHorizontal()?o.maxRotation:o.minRotation),l=Math.cos(s),h=Math.sin(s),g=this._resolveTickFontOptions(0).size;return{w:r*l+g*h,h:r*h+g*l}}_getLabelCapacity(e){const o=this.options.time,r=o.displayFormats,s=r[o.unit]||r.millisecond,l=this._tickFormatFunction(e,0,Xz(this,[e],this._majorUnit),s),h=this._getLabelSize(l),g=Math.floor(this.isHorizontal()?this.width/h.w:this.height/h.h)-1;return g>0?g:1}getDataTimestamps(){let o,r,e=this._cache.data||[];if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(o=0,r=s.length;o<r;++o)e=e.concat(s[o].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let o,r;if(e.length)return e;const s=this.getLabels();for(o=0,r=s.length;o<r;++o)e.push(qz(this,s[o]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return ZF(e.sort(Qae))}}return Ln(t,"id","time"),Ln(t,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}}),t})();function SC(t,n,e){let s,l,h,g,o=0,r=t.length-1;e?(n>=t[o].pos&&n<=t[r].pos&&({lo:o,hi:r}=Bh(t,"pos",n)),({pos:s,time:h}=t[o]),({pos:l,time:g}=t[r])):(n>=t[o].time&&n<=t[r].time&&({lo:o,hi:r}=Bh(t,"time",n)),({time:s,pos:h}=t[o]),({time:l,pos:g}=t[r]));const b=l-s;return b?h+(g-h)*(n-s)/b:h}class KM extends ZM{constructor(n){super(n),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const n=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(n);this._minPos=SC(e,this.min),this._tableRange=SC(e,this.max)-this._minPos,super.initOffsets(n)}buildLookupTable(n){const{min:e,max:o}=this,r=[],s=[];let l,h,g,b,T;for(l=0,h=n.length;l<h;++l)b=n[l],b>=e&&b<=o&&r.push(b);if(r.length<2)return[{time:e,pos:0},{time:o,pos:1}];for(l=0,h=r.length;l<h;++l)T=r[l+1],g=r[l-1],b=r[l],Math.round((T+g)/2)!==b&&s.push({time:b,pos:l/(h-1)});return s}_getTimestampsForTable(){let n=this._cache.all||[];if(n.length)return n;const e=this.getDataTimestamps(),o=this.getLabelTimestamps();return n=e.length&&o.length?this.normalize(e.concat(o)):e.length?e:o,n=this._cache.all=n,n}getDecimalForValue(n){return(SC(this._table,n)-this._minPos)/this._tableRange}getValueForPixel(n){const e=this._offsets,o=this.getDecimalForPixel(n)/e.factor-e.end;return SC(this._table,o*this._tableRange+this._minPos,!0)}}Ln(KM,"id","timeseries"),Ln(KM,"defaults",ZM.defaults),FM.register(ure,Vse,Rae,Object.freeze({__proto__:null,CategoryScale:Nae,LinearScale:GM,LogarithmicScale:WM,RadialLinearScale:w0,TimeScale:ZM,TimeSeriesScale:KM}));const ole=FM;let rle=(()=>{class t{constructor(e){this.el=e,this.plugins=[],this.responsive=!0,this.onDataSelect=new Tt,this._options={}}get data(){return this._data}set data(e){this._data=e,this.reinit()}get options(){return this._options}set options(e){this._options=e,this.reinit()}ngAfterViewInit(){this.initChart(),this.initialized=!0}onCanvasClick(e){if(this.chart){const o=this.chart.getElementsAtEventForMode(e,"nearest",{intersect:!0},!1),r=this.chart.getElementsAtEventForMode(e,"dataset",{intersect:!0},!1);o&&o[0]&&r&&this.onDataSelect.emit({originalEvent:e,element:o[0],dataset:r})}}initChart(){let e=this.options||{};e.responsive=this.responsive,e.responsive&&(this.height||this.width)&&(e.maintainAspectRatio=!1),this.chart=new ole(this.el.nativeElement.children[0].children[0],{type:this.type,data:this.data,options:this.options,plugins:this.plugins})}getCanvas(){return this.el.nativeElement.children[0].children[0]}getBase64Image(){return this.chart.toBase64Image()}generateLegend(){if(this.chart)return this.chart.generateLegend()}refresh(){this.chart&&this.chart.update()}reinit(){this.chart&&(this.chart.destroy(),this.initChart())}ngOnDestroy(){this.chart&&(this.chart.destroy(),this.initialized=!1,this.chart=null)}}return t.\u0275fac=function(e){return new(e||t)(be(si))},t.\u0275cmp=on({type:t,selectors:[["p-chart"]],hostAttrs:[1,"p-element"],inputs:{type:"type",plugins:"plugins",width:"width",height:"height",responsive:"responsive",data:"data",options:"options"},outputs:{onDataSelect:"onDataSelect"},decls:2,vars:6,consts:[[2,"position","relative"],[3,"click"]],template:function(e,o){1&e&&(F(0,"div",0)(1,"canvas",1),Oe("click",function(s){return o.onCanvasClick(s)}),V()()),2&e&&(aa("width",o.responsive&&!o.width?null:o.width)("height",o.responsive&&!o.height?null:o.height),j(1),st("width",o.responsive&&!o.width?null:o.width)("height",o.responsive&&!o.height?null:o.height))},encapsulation:2,changeDetection:0}),t})(),Yz=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();function sle(t,n){if(1&t&&(F(0,"div",15)(1,"h1",16),ce(2),V()()),2&t){const e=q();j(2),ei(" ",e.appLayout.currentRoute," ")}}function ale(t,n){1&t&&Ne(0,"iframe",17)}function lle(t,n){1&t&&Ne(0,"iframe",18)}function cle(t,n){1&t&&Ne(0,"iframe",19)}function ule(t,n){if(1&t&&(F(0,"div",20)(1,"div",21),Ne(2,"img",22),V(),F(3,"div",23)(4,"div")(5,"p",24),ce(6),V(),F(7,"p",25),ce(8),V()()()()),2&t){const e=n.$implicit;j(2),To("src",e.image,Co),j(4),ei(" ",e.name," "),j(2),ei("",e.reproducciones," reproducciones")}}let dle=(()=>{class t{constructor(e,o){this.router=e,this.appLayout=o,this.selectedButton=1,this.data={labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40]},{label:"Second Dataset",data:[28,48,40,19,86,27,90]}]},this.options=[{name:"Pop",value:1},{name:"Rock",value:2},{name:"Jazz",value:3},{name:"Rap",value:4}],this.canciones=[{name:"La macarena",reproducciones:9,image:"https://media.tenor.com/a1V-3ctKdQ0AAAAC/rem-rezero.gif"},{name:"D\xedas de enero",reproducciones:13,image:"https://media.tenor.com/7WbRvUKO9JUAAAAi/ram-png.gif"},{name:"Para bailar",reproducciones:15,image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif"},{name:"Para relajarse",reproducciones:20,image:"https://media.tenor.com/XSCFKXi06sAAAAAC/felix-argyle-cute.gif"}]}ngOnInit(){console.log("INIT")}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-dashboard"]],decls:29,vars:8,consts:[["class","route-name flex align-items-center",4,"ngIf"],[1,"grid"],[1,"col-11","lg:col-6","contenido"],[1,"mb-2"],[1,"flex","justify-content-end","flex-wrap","card-container"],["optionLabel","name","optionValue","value",3,"options","ngModel","ngModelChange"],[1,"body-map","mt-2"],["src","https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4260.77908268514!2d135.7717383468077!3d34.96771981925473!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60010f14384c5a19%3A0x5d22970f58bfde17!2sSenbon%20Torii%20(Portada%20de%20Mil%20Torii)!5e1!3m2!1ses!2ses!4v1680530977466!5m2!1ses!2ses","allowfullscreen","","loading","lazy","referrerpolicy","no-referrer-when-downgrade",4,"ngIf"],["src","https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1179.8102103187255!2d135.7842412430635!3d34.99490701859737!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x600108d385dcfb07%3A0x62af658650c434ba!2sKiyomizu-dera!5e1!3m2!1ses!2ses!4v1680531080822!5m2!1ses!2ses","allowfullscreen","","loading","lazy","referrerpolicy","no-referrer-when-downgrade",4,"ngIf"],["src","https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1382.8672261787092!2d135.7789840965205!3d34.998248182446744!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x600108c560f8c421%3A0xb1cb2441e0223549!2sHokan-ji!5e1!3m2!1ses!2ses!4v1680531184196!5m2!1ses!2ses","allowfullscreen","","loading","lazy","referrerpolicy","no-referrer-when-downgrade",4,"ngIf"],[1,"col-11","lg:col-4","contenido"],[1,"flex","card-container","justify-content-center"],[1,"mt-0","mb-2","text-gradient","w-fit","margin-text-gradient","search-friends-text","text-8xl","font-bold","text-center"],["type","line","width","35vw","height","50vh",3,"data"],["class","flex align-items-center w-full mt-1 hover-item p-2",4,"ngFor","ngForOf"],[1,"route-name","flex","align-items-center"],[1,"current-route","w-full"],["src","https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4260.77908268514!2d135.7717383468077!3d34.96771981925473!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60010f14384c5a19%3A0x5d22970f58bfde17!2sSenbon%20Torii%20(Portada%20de%20Mil%20Torii)!5e1!3m2!1ses!2ses!4v1680530977466!5m2!1ses!2ses","allowfullscreen","","loading","lazy","referrerpolicy","no-referrer-when-downgrade"],["src","https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1179.8102103187255!2d135.7842412430635!3d34.99490701859737!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x600108d385dcfb07%3A0x62af658650c434ba!2sKiyomizu-dera!5e1!3m2!1ses!2ses!4v1680531080822!5m2!1ses!2ses","allowfullscreen","","loading","lazy","referrerpolicy","no-referrer-when-downgrade"],["src","https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1382.8672261787092!2d135.7789840965205!3d34.998248182446744!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x600108c560f8c421%3A0xb1cb2441e0223549!2sHokan-ji!5e1!3m2!1ses!2ses!4v1680531184196!5m2!1ses!2ses","allowfullscreen","","loading","lazy","referrerpolicy","no-referrer-when-downgrade"],[1,"flex","align-items-center","w-full","mt-1","hover-item","p-2"],[1,"mr-3",2,"height","60px","width","60px","border-radius","5px"],[2,"height","60px","width","60px","object-fit","cover","border-radius","5px","box-shadow","var(--shadows)",3,"src"],[1,"flex-grow-1","flex","mr-3"],[1,"p-0","m-0"],[1,"p-0","m-0","text-500"]],template:function(e,o){1&e&&(J(0,sle,3,1,"div",0),F(1,"div",1)(2,"div",2)(3,"h2",3),ce(4," Mapa de g\xe9neros"),V(),F(5,"div",4)(6,"p-selectButton",5),Oe("ngModelChange",function(s){return o.selectedButton=s}),V()(),F(7,"div",6),J(8,ale,1,0,"iframe",7),J(9,lle,1,0,"iframe",8),J(10,cle,1,0,"iframe",9),V()(),F(11,"div",10)(12,"h2",3),ce(13," Usuarios este mes"),V(),F(14,"div",11)(15,"h1",12),ce(16," 225"),V()(),F(17,"div",11)(18,"h3"),ce(19," usuarios"),V()()()(),F(20,"div",1)(21,"div",2)(22,"h2",3),ce(23," N\xfamero de usuarios por d\xeda"),V(),Ne(24,"p-chart",13),V(),F(25,"div",10)(26,"h2",3),ce(27," Canciones m\xe1s escuchadas hoy"),V(),J(28,ule,9,3,"div",14),V()()),2&e&&(B("ngIf",!o.appLayout.showBar),j(6),B("options",o.options)("ngModel",o.selectedButton),j(2),B("ngIf",1==o.selectedButton),j(1),B("ngIf",2==o.selectedButton),j(1),B("ngIf",3==o.selectedButton),j(14),B("data",o.data),j(4),B("ngForOf",o.canciones))},dependencies:[Ms,mi,Tl,hd,QD,rle],styles:["[_nghost-%COMP%]{width:100%}iframe[_ngcontent-%COMP%]{width:100%;height:100%;border:0;border-radius:10px}.body-map[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;justify-content:flex-end;border-radius:10px;height:calc(50vh - 140px);box-shadow:var(--shadows)!important}.contenido[_ngcontent-%COMP%]{transition:var(--transition);font-size:1rem;background-color:var(--containerBackground);border-radius:10px;padding:2rem;margin:2rem;justify-content:center;align-items:center}.hover-item[_ngcontent-%COMP%]{transition:var(--transition)}.hover-item[_ngcontent-%COMP%]:hover{transition:var(--transition);border-radius:10px;background:var(--surface-hover);cursor:pointer}.hover-item[_ngcontent-%COMP%]:active{border-radius:10px;background:var(--surface-300);transition:var(--transition)}[_nghost-%COMP%]     .p-component{display:flex;width:max-content;box-shadow:var(--shadows);border-radius:10px}[_nghost-%COMP%]     .p-buttonset .p-button:first-of-type{border-radius:10px 0 0 10px!important}[_nghost-%COMP%]     .p-buttonset .p-button:not(:first-of-type):not(:last-of-type){border-radius:0!important}[_nghost-%COMP%]     .p-button{border-top-left-radius:0!important;border-bottom-left-radius:0!important;box-shadow:none!important}"]}),t})();function hle(t,n){if(1&t){const e=xt();F(0,"div",12)(1,"div",13)(2,"div",14)(3,"span",15),Ne(4,"i",16),F(5,"input",17),Oe("input",function(r){Ie(e);const s=q();return Me(jn(1).filterGlobal(s.getEventValue(r),"contains"))}),V()(),F(6,"div",18)(7,"button",19)(8,"span",20),ce(9," Exportar pdf "),V()(),F(10,"button",21)(11,"span",20),ce(12," Exportar excel "),V()()()()()()}}function ple(t,n){1&t&&(F(0,"tr")(1,"th",22)(2,"div",23),ce(3," Name "),Ne(4,"p-sortIcon",24),V()(),F(5,"th",22)(6,"div",23),ce(7," User ID "),Ne(8,"p-sortIcon",24),V()(),F(9,"th",25)(10,"div",23),ce(11," Email "),Ne(12,"p-sortIcon",26),V()(),F(13,"th",27)(14,"div",23),ce(15," Nickname "),Ne(16,"p-sortIcon",28),V()(),F(17,"th",29)(18,"div",23),ce(19," Spotify ID "),Ne(20,"p-sortIcon",30),V()(),F(21,"th",29)(22,"div",23),ce(23," Creation Date "),Ne(24,"p-sortIcon",30),V()(),F(25,"th",29)(26,"div",23),ce(27," Last Login Date "),Ne(28,"p-sortIcon",30),V()(),F(29,"th",29)(30,"div",23),ce(31," Number Friends "),Ne(32,"p-sortIcon",30),V()(),F(33,"th",29)(34,"div",23),ce(35," Number Vibes "),Ne(36,"p-sortIcon",30),V()(),F(37,"th",29)(38,"div",23),ce(39," Number Playlists "),Ne(40,"p-sortIcon",30),V()(),F(41,"th",31)(42,"div",32),ce(43," Bloquear cuenta "),V()()())}function fle(t,n){if(1&t){const e=xt();F(0,"tr")(1,"td",33)(2,"div",34)(3,"div",35),Ne(4,"img",36),V(),F(5,"div",37),ce(6),V()()(),F(7,"td",38),ce(8),V(),F(9,"td",38),ce(10),V(),F(11,"td",38),ce(12),V(),F(13,"td",38),ce(14),V(),F(15,"td",38),ce(16),V(),F(17,"td",38),ce(18),V(),F(19,"td",38),ce(20),V(),F(21,"td",38),ce(22),V(),F(23,"td",38),ce(24),V(),F(25,"td",33)(26,"div",39)(27,"button",40),Oe("click",function(){return Ie(e),Me(q().showBlockDialog())}),F(28,"span",20),ce(29," Bloquear cuenta "),V()()()()()}if(2&t){const e=n.$implicit;j(4),To("src",e.image,Co),B("alt",e.name),j(2),Jt(e.name),j(2),Jt(e.id),j(2),Jt(e.email),j(2),Jt(e.nickname),j(2),Jt(e.spotifyID),j(2),Jt(e.creationDate),j(2),Jt(e.lastLoginDate),j(2),Jt(e.friends),j(2),Jt(e.vibes),j(2),Jt(e.playlists)}}function mle(t,n){1&t&&(F(0,"tr")(1,"td",41),ce(2,"No users found."),V()())}const gle=function(){return["name","fechaRegistro","ultimoAcceso","playlists"]},_le=function(){return{width:"500px"}},yle=function(){return{"500px":"95vw"}};let vle=(()=>{class t{constructor(){this.loading=!0,this.displayBlockDialog=!1}ngOnInit(){}getEventValue(e){return e.target.value}showBlockDialog(){this.displayBlockDialog=!0}confirm(){this.displayBlockDialog=!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-admin-users-table"]],inputs:{users:"users",loading:"loading"},decls:13,vars:15,consts:[[3,"value","paginator","rows","rowHover","showCurrentPageReport","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","\xbfEst\xe1 seguro que desea bloquear a este usuario? ",3,"visible","modal","draggable","breakpoints","visibleChange"],[1,"p-3"],["pButton","","pRipple","","type","submit",1,"p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"],[1,"table-header","flex","flex-column"],[1,"card","flex","flex-column"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"p-input-icon-left","flex"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],[2,"text-align","right"],[1,"mr-2","p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient",2,"border","none"],[1,"vibe-btn-text-white","font-normal","text-xs"],[1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient",2,"border","none"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center","name-size"],["field","name"],["pSortableColumn","fechaRegistro"],["field","fechaRegistro"],["pSortableColumn","ultimoAcceso"],["field","ultimoAcceso"],["pSortableColumn","playlists"],["field","playlists"],["pSortableColumn","boton"],[1,"flex","justify-content-between","align-items-center","margin-td-right",2,"float","right"],[1,"padding-td"],[2,"display","flex","align-items","flex-start"],[1,"round-images-size"],[1,"round-images","round-images-size",3,"src","alt"],[1,"ml-3","name-size",2,"height","40px","text-align","start","display","flex","align-items","center"],[1,"padding-td","name-size"],[1,"margin-td-right",2,"float","right"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","gradiente",3,"click"],["colspan","8"]],template:function(e,o){1&e&&(F(0,"p-table",0,1),J(2,hle,13,0,"ng-template",2),J(3,ple,44,0,"ng-template",3),J(4,fle,30,12,"ng-template",4),J(5,mle,3,0,"ng-template",5),V(),F(6,"p-dialog",6),Oe("visibleChange",function(s){return o.displayBlockDialog=s}),F(7,"div",7)(8,"button",8),Oe("click",function(){return o.confirm()}),F(9,"div",9)(10,"span",10)(11,"p",11),ce(12,"Aceptar"),V()()()()()()),2&e&&(B("value",o.users)("paginator",!0)("rows",20)("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",ai(12,gle)),j(6),Ao(ai(13,_le)),B("visible",o.displayBlockDialog)("modal",!0)("draggable",!1)("breakpoints",ai(14,yle)))},dependencies:[os,_o,fc,bd,Yb,Ww,mu],styles:[".gradiente[_ngcontent-%COMP%]{background:linear-gradient(90deg,rgb(67,68,75) 0%,rgb(37,33,39) 73%);box-shadow:var(--shadows);background-position:50% 100%;background-size:110% 110%;color:#fff!important}"]}),t})();function ble(t,n){if(1&t&&(F(0,"div",3)(1,"h1",4),ce(2),V()()),2&t){const e=q();j(2),ei(" ",e.appLayout.currentRoute," ")}}let xle=(()=>{class t{constructor(e,o){this.router=e,this.appLayout=o}ngOnInit(){this.users=[{id:"711unhht4cv",name:"Pilar Ester",email:"pilarester@gmail.com",nickname:"piluca",spotifyID:"df24bn3jb43b34",creationDate:"10/09/2022",lastLoginDate:"12/03/2023",friends:1,vibes:2,playlists:1,image:"https://media.licdn.com/dms/image/C4D03AQGhTmQp0J-eUw/profile-displayphoto-shrink_200_200/0/1646170721207?e=1684368000&v=beta&t=GrPpweOwHS4uTOiwQ9Vvg3pwY4crqQq7yKPf2DZas7g"},{id:"711unhht4cv",name:"Jaime Roncal",email:"jaimeroncal@gmail.com",nickname:"jaima",spotifyID:"df24bn3jb43b34",creationDate:"10/09/2022",lastLoginDate:"12/03/2023",friends:1,vibes:2,playlists:1,image:"https://media.licdn.com/dms/image/D4D03AQGlULIm-un43A/profile-displayphoto-shrink_800_800/0/1670712145849?e=2147483647&v=beta&t=LRBX_xAxtl7jymxEzR16l_88BGRmIGIchXsKn1rT3RY"},{id:"711unhht4cv",name:"Loreto Matinero",email:"loretomatinero@gmail.com",nickname:"loretixx",spotifyID:"df24bn3jb43b34",creationDate:"10/09/2022",lastLoginDate:"12/03/2023",friends:1,vibes:2,playlists:1,image:"https://media.tenor.com/XSCFKXi06sAAAAAC/felix-argyle-cute.gif"},{id:"711unhht4cv",name:"Nacho Ortega",email:"nachoortega@gmail.com",nickname:"pikanachi",spotifyID:"df24bn3jb43b34",creationDate:"10/09/2022",lastLoginDate:"12/03/2023",friends:1,vibes:2,playlists:1,image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif"}]}}return t.\u0275fac=function(e){return new(e||t)(be(sr),be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-users"]],decls:3,vars:2,consts:[["class","route-name",4,"ngIf"],[1,"content"],[3,"users"],[1,"route-name"],[1,"current-route"]],template:function(e,o){1&e&&(J(0,ble,3,1,"div",0),F(1,"div",1),Ne(2,"app-admin-users-table",2),V()),2&e&&(B("ngIf",!o.appLayout.showBar),j(2),B("users",o.users))},dependencies:[mi,vle]}),t})(),wle=(()=>{class t{goLanding(){window.location.href="/"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-not-found"]],decls:11,vars:0,consts:[[2,"height","100vh","width","100%","background-image","var(--gradient45)"],[1,"flex","align-items-center","align-content-center","justify-content-center","w-full","h-full"],[1,"frostedBackground","align-items-center","align-content-center","justify-content-center","border-round-xl","window-width",2,"display","grid","transition","var(--transition)"],["alt","logo",1,"logo","m-auto","w-20rem"],[1,"mx-auto"],[1,"mx-auto","text-center"],["type","button",1,"mt-3","button-width","p-button-text","border-round-xl","h-3rem","vibe-btn",3,"click"],[1,"vibe-btn-text"]],template:function(e,o){1&e&&(F(0,"div",0)(1,"div",1)(2,"div",2),Ne(3,"img",3),F(4,"h1",4),ce(5,"Error 404"),V(),F(6,"p",5),ce(7,"Ooops! La p\xe1gina que est\xe1s buscando no existe"),V(),F(8,"button",6),Oe("click",function(){return o.goLanding()}),F(9,"span",7),ce(10,"Ir a inicio"),V()()()()())},styles:[".frostedBackground[_ngcontent-%COMP%]{background:var(--frostedBackground);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:none;box-shadow:var(--shadows)}.window-width[_ngcontent-%COMP%]{width:50rem;padding:5rem}.logo[_ngcontent-%COMP%]{content:var(--logoFooter);background-size:cover;background-repeat:no-repeat;background-position:center;width:13rem}@media (max-width: 993px){.window-width[_ngcontent-%COMP%]{width:30rem!important;padding:2rem!important}}@media (max-height: 993px){.window-width[_ngcontent-%COMP%]{width:30rem!important;padding:2rem!important}}@media (max-width: 530px){.window-width[_ngcontent-%COMP%]{width:25rem!important;padding:1.5rem!important}}@media (max-height: 560px){.window-width[_ngcontent-%COMP%]{width:25rem!important;padding:1.5rem!important}}@media (max-width: 400px){.window-width[_ngcontent-%COMP%]{width:22rem!important;padding:1rem!important}}"]}),t})(),Qz=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[pc.forRoot([{path:"",component:oM},{path:"404",component:wle},{path:"",component:nl,children:[{path:"home",component:iJ},{path:"playlists",component:ree},{path:"playlists/:id/:name/:image",component:tte},{path:"map",component:cJ},{path:"friends",component:aQ},{path:"notifications",component:rM},{path:"profile/:id",component:Zne},{path:"admin/dashboard",component:dle},{path:"admin/users",component:xle},{path:"**",redirectTo:"/404"}]}],{scrollPositionRestoration:"enabled",anchorScrolling:"enabled",onSameUrlNavigation:"reload"}),pc]}),t})(),ece=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,pc,fu,pc,fu]}),t})(),cce=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,pc,fu,pc,fu]}),t})(),oN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,pc,il,fu,pc,fu]}),t})();const Fce=["content"];function zce(t,n){1&t&&Ht(0)}function Nce(t,n){if(1&t&&(F(0,"div",10),J(1,zce,1,0,"ng-container",11),V()),2&t){const e=q(3);j(1),B("ngTemplateOutlet",e.headerTemplate)}}function Bce(t,n){if(1&t&&(F(0,"span",15),ce(1),V()),2&t){const e=q(4);j(1),Jt(e.option("header"))}}const Vce=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function Uce(t,n){if(1&t){const e=xt();F(0,"button",16),Oe("click",function(r){return Ie(e),Me(q(4).close(r))})("keydown.enter",function(r){return Ie(e),Me(q(4).close(r))}),Ne(1,"span",17),V()}2&t&&B("ngClass",ai(1,Vce))}function jce(t,n){if(1&t&&(F(0,"div",10),J(1,Bce,2,1,"span",12),F(2,"div",13),J(3,Uce,2,2,"button",14),V()()),2&t){const e=q(3);j(1),B("ngIf",e.option("header")),j(2),B("ngIf",e.closable)}}function Hce(t,n){1&t&&Ne(0,"i",1),2&t&&(Xn(q(3).option("icon")),B("ngClass","p-confirm-dialog-icon"))}function $ce(t,n){1&t&&Ht(0)}function Gce(t,n){if(1&t&&(F(0,"div",18),Qi(1),J(2,$ce,1,0,"ng-container",11),V()),2&t){const e=q(3);j(2),B("ngTemplateOutlet",e.footerTemplate)}}function Wce(t,n){if(1&t){const e=xt();F(0,"button",20),Oe("click",function(){return Ie(e),Me(q(4).reject())}),V()}if(2&t){const e=q(4);Xn(e.option("rejectButtonStyleClass")),B("icon",e.option("rejectIcon"))("label",e.rejectButtonLabel)("ngClass","p-confirm-dialog-reject"),st("aria-label",e.rejectAriaLabel)}}function qce(t,n){if(1&t){const e=xt();F(0,"button",20),Oe("click",function(){return Ie(e),Me(q(4).accept())}),V()}if(2&t){const e=q(4);Xn(e.option("acceptButtonStyleClass")),B("icon",e.option("acceptIcon"))("label",e.acceptButtonLabel)("ngClass","p-confirm-dialog-accept"),st("aria-label",e.acceptAriaLabel)}}function Zce(t,n){if(1&t&&(F(0,"div",18),J(1,Wce,1,6,"button",19),J(2,qce,1,6,"button",19),V()),2&t){const e=q(3);j(1),B("ngIf",e.option("rejectVisible")),j(1),B("ngIf",e.option("acceptVisible"))}}const Kce=function(t){return{"p-dialog p-confirm-dialog p-component":!0,"p-dialog-rtl":t}},Xce=function(t,n){return{transform:t,transition:n}},Yce=function(t){return{value:"visible",params:t}};function Qce(t,n){if(1&t){const e=xt();F(0,"div",3),Oe("@animation.start",function(r){return Ie(e),Me(q(2).onAnimationStart(r))})("@animation.done",function(r){return Ie(e),Me(q(2).onAnimationEnd(r))}),J(1,Nce,2,1,"div",4),J(2,jce,4,2,"div",4),F(3,"div",5,6),J(5,Hce,1,3,"i",7),Ne(6,"span",8),V(),J(7,Gce,3,1,"div",9),J(8,Zce,3,2,"div",9),V()}if(2&t){const e=q(2);Xn(e.styleClass),B("ngClass",An(11,Kce,e.rtl))("ngStyle",e.style)("@animation",An(16,Yce,no(13,Xce,e.transformOptions,e.transitionOptions))),j(1),B("ngIf",e.headerTemplate),j(1),B("ngIf",!e.headerTemplate),j(3),B("ngIf",e.option("icon")),j(1),B("innerHTML",e.option("message"),_h),j(1),B("ngIf",e.footer||e.footerTemplate),j(1),B("ngIf",!e.footer&&!e.footerTemplate)}}function Jce(t,n){if(1&t&&(F(0,"div",1),J(1,Qce,9,18,"div",2),V()),2&t){const e=q();Xn(e.maskStyleClass),B("ngClass",e.getMaskClass()),j(1),B("ngIf",e.visible)}}const eue=[[["p-footer"]]],tue=["p-footer"],nue=af([go({transform:"{{transform}}",opacity:0}),Ho("{{transition}}",go({transform:"none",opacity:1}))]),iue=af([Ho("{{transition}}",go({transform:"{{transform}}",opacity:0}))]);let oue=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.renderer=o,this.confirmationService=r,this.zone=s,this.cd=l,this.config=h,this.acceptIcon="pi pi-check",this.acceptVisible=!0,this.rejectIcon="pi pi-times",this.rejectVisible=!0,this.closeOnEscape=!0,this.blockScroll=!0,this.closable=!0,this.autoZIndex=!0,this.baseZIndex=0,this.transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)",this.focusTrap=!0,this.defaultFocus="accept",this.onHide=new Tt,this._position="center",this.transformOptions="scale(0.7)",this.id=cy(),this.subscription=this.confirmationService.requireConfirmation$.subscribe(g=>{g?g.key===this.key&&(this.confirmation=g,this.confirmationOptions={message:this.confirmation.message||this.message,icon:this.confirmation.icon||this.icon,header:this.confirmation.header||this.header,rejectVisible:null==this.confirmation.rejectVisible?this.rejectVisible:this.confirmation.rejectVisible,acceptVisible:null==this.confirmation.acceptVisible?this.acceptVisible:this.confirmation.acceptVisible,acceptLabel:this.confirmation.acceptLabel||this.acceptLabel,rejectLabel:this.confirmation.rejectLabel||this.rejectLabel,acceptIcon:this.confirmation.acceptIcon||this.acceptIcon,rejectIcon:this.confirmation.rejectIcon||this.rejectIcon,acceptButtonStyleClass:this.confirmation.acceptButtonStyleClass||this.acceptButtonStyleClass,rejectButtonStyleClass:this.confirmation.rejectButtonStyleClass||this.rejectButtonStyleClass,defaultFocus:this.confirmation.defaultFocus||this.defaultFocus,blockScroll:!1===this.confirmation.blockScroll||!0===this.confirmation.blockScroll?this.confirmation.blockScroll:this.blockScroll,closeOnEscape:!1===this.confirmation.closeOnEscape||!0===this.confirmation.closeOnEscape?this.confirmation.closeOnEscape:this.closeOnEscape,dismissableMask:!1===this.confirmation.dismissableMask||!0===this.confirmation.dismissableMask?this.confirmation.dismissableMask:this.dismissableMask},this.confirmation.accept&&(this.confirmation.acceptEvent=new Tt,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new Tt,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0):this.hide()})}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0),this.cd.markForCheck()}get position(){return this._position}set position(e){switch(this._position=e,e){case"top-left":case"bottom-left":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"top-right":case"bottom-right":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngOnInit(){this.breakpoints&&this.createStyle(),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.visible&&this.cd.markForCheck()})}option(e){const o=this.confirmationOptions||this;if(o.hasOwnProperty(e))return o[e]}onAnimationStart(e){if("visible"===e.toState){this.container=e.element,this.wrapper=this.container.parentElement,this.contentContainer=Fe.findSingle(this.container,".p-dialog-content"),this.container.setAttribute(this.id,""),this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.enableModality();const o=this.getElementToFocus();o&&o.focus()}}onAnimationEnd(e){"void"===e.toState&&this.onOverlayHide()}getElementToFocus(){switch(this.option("defaultFocus")){case"accept":default:return Fe.findSingle(this.container,".p-confirm-dialog-accept");case"reject":return Fe.findSingle(this.container,".p-confirm-dialog-reject");case"close":return Fe.findSingle(this.container,".p-dialog-header-close");case"none":return null}}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.wrapper):Fe.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.wrapper&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}enableModality(){this.option("blockScroll")&&Fe.addClass(document.body,"p-overflow-hidden"),this.option("dismissableMask")&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.close(e)}))}disableModality(){this.maskVisible=!1,this.option("blockScroll")&&Fe.removeClass(document.body,"p-overflow-hidden"),this.dismissableMask&&this.unbindMaskClickListener(),this.container&&!this.cd.destroyed&&this.cd.detectChanges()}createStyle(){if(!this.styleElement){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement);let e="";for(let o in this.breakpoints)e+=`\n                    @media screen and (max-width: ${o}) {\n                        .p-dialog[${this.id}] {\n                            width: ${this.breakpoints[o]} !important;\n                        }\n                    }\n                `;this.styleElement.innerHTML=e}}close(e){this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(ff.CANCEL),this.hide(ff.CANCEL),e.preventDefault()}hide(e){this.onHide.emit(e),this.visible=!1,this.confirmation=null,this.confirmationOptions=null}moveOnTop(){this.autoZIndex&&(ns.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}getMaskClass(){let e={"p-dialog-mask p-component-overlay":!0,"p-dialog-mask-scrollblocker":this.blockScroll};return e[this.getPositionClass().toString()]=!0,e}getPositionClass(){const o=["left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find(r=>r===this.position);return o?`p-dialog-${o}`:""}bindGlobalListeners(){(this.option("closeOnEscape")&&this.closable||this.focusTrap&&!this.documentEscapeListener)&&(this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",o=>{if(27==o.which&&this.option("closeOnEscape")&&this.closable&&parseInt(this.container.style.zIndex)===ns.get(this.container)&&this.visible&&this.close(o),9===o.which&&this.focusTrap){o.preventDefault();let r=Fe.getFocusableElements(this.container);if(r&&r.length>0)if(r[0].ownerDocument.activeElement){let s=r.indexOf(r[0].ownerDocument.activeElement);o.shiftKey?-1==s||0===s?r[r.length-1].focus():r[s-1].focus():-1==s||s===r.length-1?r[0].focus():r[s+1].focus()}else r[0].focus()}}))}unbindGlobalListeners(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}onOverlayHide(){this.container&&this.autoZIndex&&ns.clear(this.container),this.disableModality(),this.unbindGlobalListeners(),this.container=null}destroyStyle(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.restoreAppend(),this.onOverlayHide(),this.subscription.unsubscribe(),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.destroyStyle()}accept(){this.confirmation&&this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide(ff.ACCEPT)}reject(){this.confirmation&&this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(ff.REJECT),this.hide(ff.REJECT)}get acceptButtonLabel(){return this.option("acceptLabel")||this.config.getTranslation(Dr.ACCEPT)}get rejectButtonLabel(){return this.option("rejectLabel")||this.config.getTranslation(Dr.REJECT)}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(jr),be(Gb),be(fi),be(Po),be(Il))},t.\u0275cmp=on({type:t,selectors:[["p-confirmDialog"]],contentQueries:function(e,o,r){if(1&e&&(No(r,Uw,5),No(r,_o,4)),2&e){let s;mn(s=gn())&&(o.footer=s.first),mn(s=gn())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&pi(Fce,5),2&e){let r;mn(r=gn())&&(o.contentViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",icon:"icon",message:"message",style:"style",styleClass:"styleClass",maskStyleClass:"maskStyleClass",acceptIcon:"acceptIcon",acceptLabel:"acceptLabel",acceptAriaLabel:"acceptAriaLabel",acceptVisible:"acceptVisible",rejectIcon:"rejectIcon",rejectLabel:"rejectLabel",rejectAriaLabel:"rejectAriaLabel",rejectVisible:"rejectVisible",acceptButtonStyleClass:"acceptButtonStyleClass",rejectButtonStyleClass:"rejectButtonStyleClass",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",blockScroll:"blockScroll",rtl:"rtl",closable:"closable",appendTo:"appendTo",key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",transitionOptions:"transitionOptions",focusTrap:"focusTrap",defaultFocus:"defaultFocus",breakpoints:"breakpoints",visible:"visible",position:"position"},outputs:{onHide:"onHide"},ngContentSelectors:tue,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],[3,"ngClass","ngStyle","class",4,"ngIf"],[3,"ngClass","ngStyle"],["class","p-dialog-header",4,"ngIf"],[1,"p-dialog-content"],["content",""],[3,"ngClass","class",4,"ngIf"],[1,"p-confirm-dialog-message",3,"innerHTML"],["class","p-dialog-footer",4,"ngIf"],[1,"p-dialog-header"],[4,"ngTemplateOutlet"],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button",3,"ngClass","click","keydown.enter"],[1,"pi","pi-times"],[1,"p-dialog-footer"],["type","button","pRipple","","pButton","",3,"icon","label","ngClass","class","click",4,"ngIf"],["type","button","pRipple","","pButton","",3,"icon","label","ngClass","click"]],template:function(e,o){1&e&&(or(eue),J(0,Jce,2,4,"div",0)),2&e&&B("ngIf",o.maskVisible)},dependencies:[Eo,mi,Is,Oo,os,vd],styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[cc("animation",[rr("void => visible",[Q_(nue)]),rr("visible => void",[Q_(iue)])])]},changeDetection:0}),t})(),rN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,pu,il,pu,is]}),t})(),sN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,il,is]}),t})();const sue=function(t,n,e){return{"p-inputswitch p-component":!0,"p-inputswitch-checked":t,"p-disabled":n,"p-focus":e}},aue={provide:ks,useExisting:xi(()=>lue),multi:!0};let lue=(()=>{class t{constructor(e){this.cd=e,this.trueValue=!0,this.falseValue=!1,this.onChange=new Tt,this.modelValue=!1,this.focused=!1,this.onModelChange=()=>{},this.onModelTouched=()=>{}}onClick(e,o){!this.disabled&&!this.readonly&&(e.preventDefault(),this.toggle(e),o.focus())}onInputChange(e){this.readonly||this.updateModel(e,e.target.checked)}toggle(e){this.updateModel(e,!this.checked())}updateModel(e,o){this.modelValue=o?this.trueValue:this.falseValue,this.onModelChange(this.modelValue),this.onChange.emit({originalEvent:e,checked:this.modelValue})}onFocus(e){this.focused=!0}onBlur(e){this.focused=!1,this.onModelTouched()}writeValue(e){this.modelValue=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}checked(){return this.modelValue===this.trueValue}}return t.\u0275fac=function(e){return new(e||t)(be(Po))},t.\u0275cmp=on({type:t,selectors:[["p-inputSwitch"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",tabindex:"tabindex",inputId:"inputId",name:"name",disabled:"disabled",readonly:"readonly",trueValue:"trueValue",falseValue:"falseValue",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy"},outputs:{onChange:"onChange"},features:[Wi([aue])],decls:5,vars:16,consts:[[3,"ngClass","ngStyle","click"],[1,"p-hidden-accessible"],["type","checkbox","role","switch",3,"checked","disabled","change","focus","blur"],["cb",""],[1,"p-inputswitch-slider"]],template:function(e,o){if(1&e){const r=xt();F(0,"div",0),Oe("click",function(l){Ie(r);const h=jn(3);return Me(o.onClick(l,h))}),F(1,"div",1)(2,"input",2,3),Oe("change",function(l){return o.onInputChange(l)})("focus",function(l){return o.onFocus(l)})("blur",function(l){return o.onBlur(l)}),V()(),Ne(4,"span",4),V()}2&e&&(Xn(o.styleClass),B("ngClass",$r(12,sue,o.checked(),o.disabled,o.focused))("ngStyle",o.style),j(2),B("checked",o.checked())("disabled",o.disabled),st("aria-label",o.ariaLabel)("id",o.inputId)("name",o.name)("tabindex",o.tabindex)("aria-checked",o.checked())("aria-labelledby",o.ariaLabelledBy))},dependencies:[Eo,Oo],styles:['.p-inputswitch{position:relative;display:inline-block;-webkit-user-select:none;user-select:none}.p-inputswitch-slider{position:absolute;cursor:pointer;inset:0}.p-inputswitch-slider:before{position:absolute;content:"";top:50%}\n'],encapsulation:2,changeDetection:0}),t})(),aN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})(),lN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})(),fue=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})(),mue=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei]}),t})();function gue(t,n){if(1&t&&(F(0,"span",1),ce(1),V()),2&t){const e=q();Xn(e.styleClass),B("ngClass",e.containerClass())("ngStyle",e.style),j(1),Jt(e.value)}}let _ue=(()=>{class t{constructor(){this.badgeDisabled=!1}containerClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":null!=this.value&&1===String(this.value).length,"p-badge-lg":"large"===this.size,"p-badge-xl":"xlarge"===this.size,"p-badge-info":"info"===this.severity,"p-badge-success":"success"===this.severity,"p-badge-warning":"warning"===this.severity,"p-badge-danger":"danger"===this.severity}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["p-badge"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",size:"size",severity:"severity",value:"value",badgeDisabled:"badgeDisabled"},decls:1,vars:1,consts:[[3,"ngClass","class","ngStyle",4,"ngIf"],[3,"ngClass","ngStyle"]],template:function(e,o){1&e&&J(0,gue,2,5,"span",0),2&e&&B("ngIf",!o.badgeDisabled)},dependencies:[Eo,mi,Oo],styles:[".p-badge{display:inline-block;border-radius:10px;text-align:center;padding:0 .5rem}.p-overlay-badge{position:relative}.p-overlay-badge .p-badge{position:absolute;top:0;right:0;transform:translate(50%,-50%);transform-origin:100% 0;margin:0}.p-badge-dot{width:.5rem;min-width:.5rem;height:.5rem;border-radius:50%;padding:0}.p-badge-no-gutter{padding:0;border-radius:50%}\n"],encapsulation:2,changeDetection:0}),t})(),cN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,is]}),t})();const yue=["*",[["mat-toolbar-row"]]],vue=["*","mat-toolbar-row"],bue=kS(class{constructor(t){this._elementRef=t}});let xue=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=kn({type:t,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),t})(),wue=(()=>{class t extends bue{constructor(e,o,r){super(e),this._platform=o,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(rc),be(lo))},t.\u0275cmp=on({type:t,selectors:[["mat-toolbar"]],contentQueries:function(e,o,r){if(1&e&&No(r,xue,5),2&e){let s;mn(s=gn())&&(o._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(e,o){2&e&&Mo("mat-toolbar-multiple-rows",o._toolbarRows.length>0)("mat-toolbar-single-row",0===o._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Li],ngContentSelectors:vue,decls:2,vars:0,template:function(e,o){1&e&&(or(yue),Qi(0),Qi(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),t})(),Cue=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[lc,lc]}),t})();const Tue=["mat-button",""],Eue=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Sue=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],Mue=["mat-icon-button",""],Iue=["*"],kue=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],Aue=kS(n8(o8(class{constructor(t){this._elementRef=t}})));let uN=(()=>{class t extends Aue{constructor(e,o,r,s){super(e),this._platform=o,this._ngZone=r,this._animationMode=s,this._focusMonitor=ti(tO),this._isFab=!1;const l=e.nativeElement.classList;for(const h of kue)this._hasHostAttributes(h.selector)&&h.mdcClasses.forEach(g=>{l.add(g)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e="program",o){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,o):this._elementRef.nativeElement.focus(o)}_hasHostAttributes(...e){return e.some(o=>this._elementRef.nativeElement.hasAttribute(o))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return t.\u0275fac=function(e){bh()},t.\u0275dir=kn({type:t,viewQuery:function(e,o){if(1&e&&pi(AS,5),2&e){let r;mn(r=gn())&&(o.ripple=r.first)}},features:[Li]}),t})(),Oue=(()=>{class t extends uN{constructor(e,o,r,s){super(e,o,r,s)}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(rc),be(fi),be(U_,8))},t.\u0275cmp=on({type:t,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(e,o){2&e&&(st("disabled",o.disabled||null),Mo("_mat-animation-noopable","NoopAnimations"===o._animationMode)("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Li],attrs:Tue,ngContentSelectors:Sue,decls:8,vars:6,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(e,o){1&e&&(or(Eue),Ne(0,"span",0),Qi(1),F(2,"span",1),Qi(3,1),V(),Qi(4,2),Ne(5,"span",2)(6,"span",3)(7,"span",4)),2&e&&(Mo("mdc-button__ripple",!o._isFab)("mdc-fab__ripple",o._isFab),j(6),B("matRippleDisabled",o._isRippleDisabled())("matRippleTrigger",o._elementRef.nativeElement))},dependencies:[AS],styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),t})(),Lue=(()=>{class t extends uN{constructor(e,o,r,s){super(e,o,r,s)}}return t.\u0275fac=function(e){return new(e||t)(be(si),be(rc),be(fi),be(U_,8))},t.\u0275cmp=on({type:t,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(e,o){2&e&&(st("disabled",o.disabled||null),Mo("_mat-animation-noopable","NoopAnimations"===o._animationMode)("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Li],attrs:Mue,ngContentSelectors:Iue,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(e,o){1&e&&(or(),Ne(0,"span",0),Qi(1),Ne(2,"span",1)(3,"span",2)(4,"span",3)),2&e&&(j(3),B("matRippleDisabled",o._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",o._elementRef.nativeElement))},dependencies:[AS],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),t})(),Fue=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[lc,d8,lc]}),t})(),zue=(()=>{class t{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(e){this._vertical=du(e)}get inset(){return this._inset}set inset(e){this._inset=du(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(e,o){2&e&&(st("aria-orientation",o.vertical?"vertical":"horizontal"),Mo("mat-divider-vertical",o.vertical)("mat-divider-horizontal",!o.vertical)("mat-divider-inset",o.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(e,o){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0}),t})(),Nue=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[lc,lc]}),t})(),xde=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,pc,il,fu,pc,fu]}),t})();af([go({transform:"{{transform}}",opacity:0}),Ho("{{transition}}")]),af([Ho("{{transition}}",go({transform:"{{transform}}",opacity:0}))]);let Ide=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,il]}),t})();function kde(t,n){if(1&t){const e=xt();F(0,"div",3)(1,"button",4),Oe("click",function(){return Ie(e),Me(q().onCancel())}),F(2,"div",5)(3,"span",6)(4,"p",7),ce(5,"Aceptar"),V()()()()()}}const Ade=function(){return{width:"500px"}},Pde=function(){return{"500px":"95vw"}};let Ode=(()=>{class t{constructor(){this.showDialog=new Tt}onCancel(){this.showDialog.emit(!1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-success-dialog"]],inputs:{display:"display",message:"message",title:"title"},outputs:{showDialog:"showDialog"},decls:6,vars:10,consts:[[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],[1,"text-center"],["pTemplate","footer"],[1,"p-3"],["pButton","","pRipple","","type","submit",1,"p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"]],template:function(e,o){1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.display=s})("onHide",function(){return o.onCancel()}),F(1,"h3",1),ce(2),V(),F(3,"p",1),ce(4),V(),J(5,kde,6,0,"ng-template",2),V()),2&e&&(Ao(ai(8,Ade)),B("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",ai(9,Pde)),j(2),ei(" ",o.title," "),j(2),ei(" ",o.message," "))},dependencies:[os,mu,_o]}),t})();function Rde(t,n){if(1&t){const e=xt();F(0,"button",8),Oe("click",function(){return Ie(e),Me(q(2).backClick())}),F(1,"mat-icon",9),ce(2,"arrow_back"),V()()}2&t&&B("disabled",q(2).loadingVibe)}function Lde(t,n){if(1&t&&(F(0,"div",5),J(1,Rde,3,1,"button",6),F(2,"h2",7),ce(3,"Crear vibe"),V()()),2&t){const e=q();j(1),B("ngIf",e.showSecondPage||e.showThirdPage)}}function Fde(t,n){if(1&t){const e=xt();F(0,"div",31)(1,"div",32)(2,"div",33)(3,"h4",34),ce(4," Canciones encontradas "),V(),F(5,"div",29)(6,"span",35),Ne(7,"i",36),F(8,"input",37),Oe("input",function(r){Ie(e),q();const s=jn(4),l=q(2);return Me(s.filterGlobal(l.getEventValue(r),"contains"))}),V()()()()()()}}function zde(t,n){1&t&&(F(0,"tr")(1,"th",38)(2,"div",39),ce(3," T\xedtulo "),Ne(4,"p-sortIcon",40),V()(),F(5,"th",41)(6,"div",39),ce(7," \xc1lbum "),Ne(8,"p-sortIcon",42),V()(),F(9,"th",43)(10,"div",44),ce(11," Duraci\xf3n "),Ne(12,"p-sortIcon",45),V()()())}function Nde(t,n){if(1&t&&(F(0,"tr",46)(1,"td",47)(2,"div",48)(3,"div",49),Ne(4,"img",50),V(),F(5,"div",51),ce(6),V()()(),F(7,"td",52),ce(8),V(),F(9,"td",47)(10,"div",53)(11,"div",51),ce(12),V()()()()),2&t){const e=n.$implicit;B("pSelectableRow",e),j(4),To("src",e.image,Co),B("alt",e.name),j(2),Jt(e.name),j(2),Jt(e.album),j(4),Jt(e.time)}}function Bde(t,n){1&t&&(F(0,"tr")(1,"td",54),ce(2,"No se ha encontrado ninguna canci\xf3n"),V()())}function Vde(t,n){if(1&t&&(F(0,"div",55),ce(1),V()),2&t){const e=q(3);j(1),ei(" ",e.songs.length," canciones encontradas ")}}const Ude=function(){return["name","album"]},jde=function(){return[10,25,50]};function Hde(t,n){if(1&t){const e=xt();F(0,"div")(1,"p",19),ce(2,"Selecciona una canci\xf3n"),V(),F(3,"p-table",20,21),Oe("selectionChange",function(r){return Ie(e),Me(q(2).selectedSong=r)})("onRowSelect",function(r){return Ie(e),Me(q(2).onRowSelect(r))}),J(5,Fde,9,0,"ng-template",22),J(6,zde,13,0,"ng-template",23),J(7,Nde,13,6,"ng-template",24),J(8,Bde,3,0,"ng-template",25),J(9,Vde,2,1,"ng-template",26),V(),F(10,"button",27),Oe("click",function(){Ie(e);const r=q(2);return r.displayTable=!1,r.showFirstPage=!1,Me(r.showSecondPage=!0)}),F(11,"div",28)(12,"span",29)(13,"p",30),ce(14,"Continuar"),V()()()()()}if(2&t){const e=q(2);j(3),B("value",e.songs)("scrollable",!0)("selection",e.selectedSong)("loading",e.loading)("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",ai(9,Ude))("rowsPerPageOptions",ai(10,jde)),j(7),B("disabled",null==e.selectedSong)}}function $de(t,n){if(1&t){const e=xt();F(0,"div")(1,"div",10)(2,"div",11)(3,"div")(4,"p",12),ce(5,"Busca una canci\xf3n para tu vibe"),V()()()(),F(6,"form",13),Oe("ngSubmit",function(){Ie(e);const r=q();return Me(r.onSubmit(r.searchForm))}),F(7,"div",14)(8,"span",15),Ne(9,"i",16),V(),Ne(10,"input",17)(11,"button",18),V()(),J(12,Hde,15,11,"div",3),V()}if(2&t){const e=q();j(6),B("formGroup",e.searchForm),j(5),B("disabled",!e.searchForm.valid||e.loading)("icon",e.loading?"pi pi-spin pi-spinner":"pi pi-search"),j(1),B("ngIf",e.displayTable&&e.showFirstPage)}}function Gde(t,n){if(1&t){const e=xt();F(0,"div")(1,"div",56)(2,"div",57)(3,"div",58)(4,"div",59)(5,"p",60),ce(6,"Situa tu cancion en el mapa"),V(),F(7,"p",61),ce(8,"Esta se\xe1 la ubicaci\xf3n de tu vibe"),V()()()(),F(9,"div",62)(10,"div",63)(11,"p",64),ce(12),V(),F(13,"p",65),ce(14),V()(),Ne(15,"img",50),V()(),Ne(16,"app-map-vibes",66),F(17,"button",67),Oe("click",function(){Ie(e);const r=q();return r.displayTable=!1,r.showThirdPage=!0,Me(r.showSecondPage=!1)}),F(18,"div",28)(19,"span",29)(20,"p",30),ce(21,"Continuar"),V()()()()()}if(2&t){const e=q();B("@fadeInOut",void 0),j(12),Jt(e.selectedSong.name),j(2),ei(" ",e.selectedSong.album," "),j(1),To("src",e.selectedSong.image,Co),B("alt",e.selectedSong.name),j(1),B("id",e.newVibe)("vibes",e.vibes)("showSearchBar",!0)("showLocationButton",!1)}}function Wde(t,n){1&t&&Ne(0,"p-progressSpinner",80)}function qde(t,n){if(1&t){const e=xt();F(0,"div")(1,"div",68)(2,"div",69)(3,"div")(4,"p"),ce(5,"Tu vibe"),V()()()(),F(6,"div",70),Ne(7,"img",71),F(8,"div",72)(9,"p",73),ce(10),V(),F(11,"p",74),ce(12),V()()(),F(13,"div",75),Ne(14,"img",76),F(15,"div",77),ce(16," Zaragoza, Espa\xf1ita "),V()(),F(17,"textarea",78),Oe("ngModelChange",function(r){return Ie(e),Me(q().vibeDescription=r)}),V(),F(18,"button",27),Oe("click",function(){return Ie(e),Me(q().uploadVibe())}),F(19,"div",28)(20,"span",29),J(21,Wde,1,0,"p-progressSpinner",79),F(22,"p",30),ce(23),V()()()()()}if(2&t){const e=q();j(7),To("src",e.selectedSong.image,Co),B("alt",e.selectedSong.name),j(3),Jt(e.selectedSong.name),j(2),ei(" ",e.selectedSong.album," "),j(5),B("ngModel",e.vibeDescription),j(1),B("disabled",e.loadingVibe),j(3),B("ngIf",e.loadingVibe),j(2),ei(" ",e.creatingVibe,"")}}const Zde=function(){return{width:"750px"}},Kde=function(){return{"750px":"95vw"}},Xde=function(t,n,e,o,r,s,l,h){return{"h-0":t,"h-1":n,"h-2":e,"h-3":o,"h-4":r,"h-5":s,"h-thirdPage":l,"h-secondPage":h}};let Yde=(()=>{class t{constructor(e){this.appLayout=e,this.searchForm=new tl({}),this.loading=!1,this.newVibe="nuevo-vibe",this.displayTable=!1,this.displayPlace=!1,this.showFirstPage=!0,this.showSecondPage=!1,this.showThirdPage=!1,this.loadingVibe=!1,this.creatingVibe="Crear vibe",this.displaySuccess=!1}ngOnInit(){this.searchForm=new tl({song:new gs(this.song,[ms.required])})}getEventValue(e){return e.target.value}onSubmit(e){var o=this;return hu(function*(){console.log(e.value.song),o.loading=!0,yield new Promise(r=>setTimeout(r,5e3)),o.displayTable=!0,o.songs=[{id:1,name:"Guren no Yumiya",author:"Linked Horizon",album:"Shingeki no Kiseki",image:"https://media.licdn.com/dms/image/C4D03AQGhTmQp0J-eUw/profile-displayphoto-shrink_200_200/0/1646170721207?e=1684368000&v=beta&t=GrPpweOwHS4uTOiwQ9Vvg3pwY4crqQq7yKPf2DZas7g",time:"5:11"},{id:2,name:"the WORLD",author:"Nigthmare",album:"the WORLD Ruler",image:"https://media.licdn.com/dms/image/D4D03AQGlULIm-un43A/profile-displayphoto-shrink_800_800/0/1670712145849?e=2147483647&v=beta&t=LRBX_xAxtl7jymxEzR16l_88BGRmIGIchXsKn1rT3RY",time:"3:48"},{id:3,name:"Mixed Nuts",author:"OFFICIAL HIGE DANdism",album:"Mixed Nuts",image:"https://media.tenor.com/XSCFKXi06sAAAAAC/felix-argyle-cute.gif",time:"3:33"},{id:4,name:"LOST IN PARADISE",author:"ALI, AKLO",album:"MUSIC WORLD",image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif",time:"5:29"},{id:5,name:"Sinzo wo Sasageyo!",author:"Linked Horizon",album:"Sinzo wo Sasageyo!",image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif",time:"3:12"},{id:6,name:"A Cruel Angel's Thesis",author:"Yoko Takahashi",album:"Neon Genesis Evangelion",image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif",time:"3:30"},{id:7,name:"KISS OF DEATH",author:"BABYMETAL",album:"METAL GALAXY",image:"https://media.tenor.com/2MR7_swF7e8AAAAC/emi-emilia.gif",time:"3:10"}],o.loading=!1})()}onRowSelect(e){console.log("selected",e.data.name),this.selectedSong=e.data}cancel(){this.searchForm.reset(),this.selectedSong=null,this.song="",this.showFirstPage=!0,this.displayTable=!1,this.showSecondPage=!1,this.showThirdPage=!1,this.loadingVibe=!1,this.creatingVibe="Crear vibe",this.vibeDescription=""}backClick(){this.showSecondPage?(this.showFirstPage=!0,this.displayTable=!0,this.showSecondPage=!1,this.showThirdPage=!1,this.selectedSong=null):this.showThirdPage&&(this.showSecondPage=!0,this.showThirdPage=!1)}uploadVibe(){var e=this;return hu(function*(){e.loadingVibe=!0,e.creatingVibe="Creando vibe...",console.log("vibeDescription",e.vibeDescription),console.log("selectedSong",e.selectedSong),yield new Promise(o=>setTimeout(o,5e3)),e.cancel(),e.appLayout.displayNewVibeDialog=!1,e.displaySuccess=!0})()}onHide(e){this.displaySuccess=e}}return t.\u0275fac=function(e){return new(e||t)(be(nl))},t.\u0275cmp=on({type:t,selectors:[["app-new-vibe-dialog"]],decls:7,vars:23,consts:[[3,"visible","closable","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[1,"animation","h-song","pt-2",3,"ngClass"],[4,"ngIf"],["title","Vibe creado","message","Tu vibe ha sido creado con \xe9xito, puedes consultarlo en el mapa",3,"display","showDialog"],[1,"flex","align-items-center","justify-content-center","mb-1"],["class","back-buttons flex align-items-center justify-content-center mr-2","type","button",3,"disabled","click",4,"ngIf"],[1,"p-dialog-title"],["type","button",1,"back-buttons","flex","align-items-center","justify-content-center","mr-2",3,"disabled","click"],[1,"flex","justify-content-center"],[1,"flex","justify-content-between","flex-wrap","card-container"],[1,"flex"],[2,"margin-bottom","15px"],[3,"formGroup","ngSubmit"],[1,"p-inputgroup","h-fit"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-volume-up"],["id","song","name","song","formControlName","song","placeholder","Buscar canciones","type","text","pInputText","",1,"form-control","h-3rem"],["type","submit","pButton","","pRipple","","styleClass","p-button-danger",1,"button-gradient-45","w-3rem",2,"border-top-left-radius","0 !important","border-bottom-left-radius","0 !important",3,"disabled","icon"],[1,"mt-4",2,"margin-bottom","15px"],["dataKey","id","selectionMode","single","styleClass","p-datatable-sm","scrollHeight","330px","currentPageReportTemplate","{first} a {last}",3,"value","scrollable","selection","loading","rowHover","showCurrentPageReport","globalFilterFields","rowsPerPageOptions","selectionChange","onRowSelect"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],["pButton","","pRipple","",1,"mt-4","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"md:m-0","mb-3","text-center","md:text-left"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Filtrar",3,"input"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center","name-size"],["field","name"],["pSortableColumn","album"],["field","album"],["pSortableColumn","time"],[1,"flex","justify-content-between","align-items-center","margin-td-right",2,"float","right"],["field","time"],[3,"pSelectableRow"],[1,"padding-td"],[2,"display","flex","align-items","flex-start"],[1,"round-images-size"],[1,"round-images-size","border-round-sm",3,"src","alt"],[1,"ml-3","name-size",2,"height","40px","text-align","start","display","flex","align-items","center"],[1,"padding-td","name-size"],[1,"margin-td-right",2,"float","right"],["colspan","8"],[1,"flex","align-items-center","justify-content-between"],[1,"flex","justify-content-between","flex-wrap","card-container","mb-3"],[1,"flex","w-fit","h-4rem"],[1,"flex","align-items-center","w-auto","h-4rem"],[1,"mr-3"],[2,"text-overflow","ellipsis"],[1,"text-color-secondary",2,"text-overflow","ellipsis"],[1,"flex","align-items-center","justify-content-end","w-auto","h-4rem"],[1,"mr-3","text-right"],[1,"text-lg","text-right"],[1,"text-sm","text-color-secondary","text-right"],["mapHeight","400px !important",3,"id","vibes","showSearchBar","showLocationButton"],["pButton","","pRipple","",1,"mt-4","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"],[1,"flex","justify-content-between","flex-wrap","card-container","mb-4"],[1,"flex","w-fit"],[1,"flex","align-items-center","justify-content-start","w-auto","h-auto"],[1,"h-5rem","w-5rem","border-round-sm","mr-3",3,"src","alt"],[1,"text-left"],[1,"text-xl","mb-1"],[1,"text-base","text-color-secondary","mb-1"],[1,"mt-3","mb-3","flex","align-items-center"],["src","assets/images/spotivibesLogo.svg",1,"h-2rem","w-2rem","mr-1"],[1,"text-gradient","font-bold"],["placeholder","A\xf1adir descripci\xf3n",1,"w-full","h-10rem","border-none","p-3",2,"resize","none","border-radius","10px","font-family","Lato","color","var(--fontColor)","background","var(--frostedBackground)","outline","0.15rem solid #93cbf9",3,"ngModel","ngModelChange"],["strokeWidth","5","class","mr-3",4,"ngIf"],["strokeWidth","5",1,"mr-3"]],template:function(e,o){1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.appLayout.displayNewVibeDialog=s})("onHide",function(){return o.cancel()}),J(1,Lde,4,1,"ng-template",1),F(2,"div",2),J(3,$de,13,4,"div",3),J(4,Gde,22,9,"div",3),J(5,qde,24,8,"div",3),V()(),F(6,"app-success-dialog",4),Oe("showDialog",function(s){return o.onHide(s)}),V()),2&e&&(Ao(ai(12,Zde)),B("visible",o.appLayout.displayNewVibeDialog)("closable",!o.loadingVibe)("modal",!0)("draggable",!1)("breakpoints",ai(13,Kde)),j(2),B("ngClass",function DI(t,n,e,o,r,s,l,h,g,b,T){const I=zr()+t,R=Lt(),z=pt(R,I,e,o,r,s);return pt(R,I+4,l,h,g,b)||z?we(R,I+8,T?n.call(T,e,o,r,s,l,h,g,b):n(e,o,r,s,l,h,g,b)):Ae(R,I+8)}(14,Xde,o.displayTable&&0==o.songs.length,o.displayTable&&1==o.songs.length,o.displayTable&&2==o.songs.length,o.displayTable&&3==o.songs.length,o.displayTable&&4==o.songs.length,o.displayTable&&o.songs.length>=5,o.showThirdPage,o.showSecondPage)),j(1),B("ngIf",o.showFirstPage),j(1),B("ngIf",o.showSecondPage),j(1),B("ngIf",o.showThirdPage),j(1),B("display",o.displaySuccess))},dependencies:[Eo,mi,tf,dd,Tl,ef,hd,pd,nf,os,fc,mu,_o,bd,Yb,cF,Ww,El,mf,iM,Ode],styles:["p[_ngcontent-%COMP%]{margin:0}.vibe-container[_ngcontent-%COMP%]{width:100%;display:flex}.image-column[_ngcontent-%COMP%]{width:50px;height:100%;align-items:start;right:0;top:7px}.text-column[_ngcontent-%COMP%]{margin-left:1rem;flex-grow:1;width:100%;height:100%;justify-content:center;align-items:start}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:#fff!important}[_nghost-%COMP%]     .p-progress-spinner{height:30px;width:30px}[_nghost-%COMP%]     .p-dialog .p-dialog-header{padding-bottom:0}[_nghost-%COMP%]     .p-datatable.p-datatable-sm .p-datatable-footer{border-bottom-left-radius:10px!important;border-bottom-right-radius:10px}[_nghost-%COMP%]     .p-dialog .p-dialog-content{padding-top:0}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr:focus{outline:.15rem solid #93cbf9;outline-offset:-.15rem;background:var(--selectedItemTable)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr{background:var(--frostedTable)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background:var(--selectedItemTable)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-header{background:var(--selectedItem)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-footer{background:var(--selectedItem)!important;border-width:0px 1px 1px 1px}[_nghost-%COMP%]     .p-datatable.p-datatable-scrollable>.p-datatable-wrapper>.p-datatable-table>.p-datatable-thead{background:var(--selectedItem)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{background:var(--frostedTable)!important}.animation[_ngcontent-%COMP%]{transition:var(--transition)}.h-song[_ngcontent-%COMP%]{height:90px}.h-0[_ngcontent-%COMP%]{height:385px!important}.h-1[_ngcontent-%COMP%]{height:410px!important}.h-2[_ngcontent-%COMP%]{height:465px!important}.h-3[_ngcontent-%COMP%]{height:530px!important}.h-4[_ngcontent-%COMP%]{height:590px!important}.h-5[_ngcontent-%COMP%]{height:640px!important}.h-6[_ngcontent-%COMP%]{height:695px!important}.h-secondPage[_ngcontent-%COMP%]{height:560px!important}.h-thirdPage[_ngcontent-%COMP%]{height:426px!important}"],data:{animation:[cc("fadeInOut",[rr(":enter",[go({opacity:0}),Ho("500ms",go({opacity:1}))]),rr(":leave",[Ho("500ms",go({opacity:0}))])])]}}),t})(),YM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,uy,nM,$_,pu]}),t})(),fN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,YM]}),t})(),Qde=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t}),t.\u0275inj=wn({imports:[Ei,EA,Qz,vR,$_,R8,FP,pu,Zb,nM,pF,uF,CF,oN,xde,Ide,Cue,K9,Fue,AO,Nue,rN,sN,IF,aN,lN,DF,_F,uy,JD,Yz,cN,fN,YM]}),t})();$d(nl,[Ms,mi,Oo,Dw,sM,wue,HD,NL,jD,Oue,Lue,El,zue,oue,_ue,Yde],[rb]);let Jde=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-footer"]],decls:7,vars:0,consts:[[1,"footer","m-auto","w-full"],[1,"card","h-full"],[1,"flex","flex-wrap","card-container","blue-container","h-full"],[1,"flex","align-items-center","justify-content-center","w-full"],["alt","logo",1,"logo","m-auto"]],template:function(e,o){1&e&&(F(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Ne(4,"img",4),V(),F(5,"div",3),ce(6," \xa9 Spotivibes 2023. All rights reserved. "),V()()()())},styles:[".footer[_ngcontent-%COMP%]{background:var(--containerBackground);height:18rem}.logo[_ngcontent-%COMP%]{content:var(--logoFooter);background-size:cover;background-repeat:no-repeat;background-position:center;width:13rem}"]}),t})();function ehe(t,n){1&t&&(F(0,"div",8)(1,"div",9)(2,"div",10)(3,"h4",11),ce(4," Solicitudes de amistad "),V()()()())}function the(t,n){1&t&&(F(0,"tr")(1,"th",12)(2,"div",13),ce(3," Nombre "),V()(),F(4,"th",14)(5,"div",15),ce(6," Aceptar / Rechazar "),V()()())}function nhe(t,n){if(1&t){const e=xt();F(0,"tr")(1,"td",16)(2,"div",17)(3,"div",18),Ne(4,"img",19),V(),F(5,"div",20),ce(6),V()()(),F(7,"td",16)(8,"div",21)(9,"button",22),Oe("click",function(){const s=Ie(e).$implicit;return Me(q().appNotification.aceptarSolicitud(s.id))}),F(10,"span",23)(11,"mat-icon"),ce(12,"check"),V()()(),F(13,"button",24),Oe("click",function(){const s=Ie(e).$implicit;return Me(q().appNotification.cancelarSolicitud(s.id))}),F(14,"span",25)(15,"mat-icon"),ce(16,"close"),V()()()()()()}if(2&t){const e=n.$implicit;j(4),To("src",e.image,Co),B("alt",e.name),j(2),Jt(e.name)}}function ihe(t,n){1&t&&(F(0,"tr")(1,"td",26),ce(2,"No tienes solicitudes de amistad."),V()())}const ohe=function(){return["name","nickname"]},rhe=function(){return[10,25,50]};let she=(()=>{class t{constructor(e){this.appNotification=e,this.loading=!0}ngOnInit(){}getEventValue(e){return e.target.value}}return t.\u0275fac=function(e){return new(e||t)(be(rM))},t.\u0275cmp=on({type:t,selectors:[["app-notifications-table"]],inputs:{solicitudes:"solicitudes",loading:"loading"},decls:9,vars:7,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers"],["currentPageReportTemplate","{first} a {last}",3,"value","loading","rowHover","globalFilterFields","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"md:m-0","mb-3","text-center","md:text-left"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center"],["pSortableColumn","boton"],[1,"flex","justify-content-between","align-items-center",2,"float","right"],[1,"padding-td"],[2,"display","flex","align-items","flex-start"],[1,"round-images-size"],[1,"round-images","round-images-size",3,"src","alt"],[1,"ml-3","name-size",2,"height","40px","text-align","center","display","flex","align-items","center","line-height","40px"],[1,"margin-td-right",2,"float","right"],["type","button",1,"button-width","text-base","p-button-text","border-round-xl","h-2rem","vibe-btn","mr-2",3,"click"],[1,"text-green-500","flex","align-items-center","justify-content-center"],["type","button",1,"button-width","text-base","p-button-text","border-round-xl","h-2rem","vibe-btn",3,"click"],[1,"text-pink-500","flex","align-items-center","justify-content-center"],["colspan","8"]],template:function(e,o){1&e&&(F(0,"h3",0),ce(1," Solicitudes de amistad "),V(),F(2,"div",1)(3,"p-table",2,3),J(5,ehe,5,0,"ng-template",4),J(6,the,7,0,"ng-template",5),J(7,nhe,17,3,"ng-template",6),J(8,ihe,3,0,"ng-template",7),V()()),2&e&&(j(3),B("value",o.solicitudes)("loading",o.loading)("rowHover",!0)("globalFilterFields",ai(5,ohe))("rowsPerPageOptions",ai(6,rhe)))},dependencies:[_o,bd,Yb,El],styles:[".padding-td[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important;padding-left:1rem!important;padding-right:0!important}.margin-td-right[_ngcontent-%COMP%]{margin-right:1rem!important}.name-size[_ngcontent-%COMP%]{font-size:1rem!important}.button-width[_ngcontent-%COMP%]{width:80px!important}@media (max-width: 710px){.padding-td[_ngcontent-%COMP%]{padding-top:.75rem!important;padding-bottom:.75rem!important;padding-left:.75rem!important;padding-right:0!important}.margin-td-right[_ngcontent-%COMP%]{margin-right:.75rem!important}}@media (max-width: 600px){.name-size[_ngcontent-%COMP%]{font-size:.9rem!important}.button-width[_ngcontent-%COMP%]{width:60px!important}}"]}),t})();function ahe(t,n){1&t&&(F(0,"div",7)(1,"div",8)(2,"div",9)(3,"h4",10),ce(4," Notificaciones recientes"),V()()()())}function lhe(t,n){if(1&t&&(F(0,"tr")(1,"td",11)(2,"div",12)(3,"div",13),Ne(4,"img",14),V(),F(5,"div",15),ce(6),V()()(),F(7,"td",16)(8,"div",17)(9,"div",18),Ne(10,"img",19),V(),F(11,"div",20)(12,"div",21)(13,"h4",22),ce(14),V(),F(15,"h5",23),ce(16),V()()()()()()),2&t){const e=n.$implicit;j(4),To("src",e.image,Co),B("alt",e.name),j(2),O_(" ",e.name," ",e.action," "),j(4),To("src",e.objectImage,Co),B("alt",e.object),j(4),Jt(e.object),j(2),Jt(e.objectAuthor)}}function che(t,n){1&t&&(F(0,"tr")(1,"td",24),ce(2,"No tienes notificaciones."),V()())}const uhe=function(){return[10,25,50]};let dhe=(()=>{class t{constructor(){this.loading=!0}getEventValue(e){return e.target.value}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=on({type:t,selectors:[["app-notifications-list"]],inputs:{notificaciones:"notificaciones",loading:"loading"},decls:8,vars:8,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers"],["currentPageReportTemplate","{first} a {last}",3,"value","rows","paginator","loading","rowHover","showCurrentPageReport","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"md:m-0","text-center","md:text-left"],[1,"padding-td",2,"max-width","fit-content"],[1,"flex","align-items-center"],[1,"round-images-size","mr-3"],[1,"round-images","round-images-size",3,"src","alt"],[1,"text-left","font-size","max-with-desc",2,"height","40px","display","flex","align-items","center"],[1,"padding-td"],[1,"flex",2,"float","right"],[1,"overflow-hidden","mr-3",2,"height","40px","width","40px","border-radius","20%","box-shadow","var(--shadows)"],["height","100","width","200",1,"h-full","w-auto",2,"overflow","hidden","cursor","pointer",3,"src","alt"],[1,"flex","align-items-start","margin-sm"],[1,"text-align-left","max-width-noti"],[1,"font-size"],[1,"font-size","font-normal"],["colspan","8"]],template:function(e,o){1&e&&(F(0,"h3",0),ce(1," Notificaciones "),V(),F(2,"div",1)(3,"p-table",2,3),J(5,ahe,5,0,"ng-template",4),J(6,lhe,17,8,"ng-template",5),J(7,che,3,0,"ng-template",6),V()()),2&e&&(j(3),B("value",o.notificaciones)("rows",10)("paginator",!0)("loading",o.loading)("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",ai(7,uhe)))},dependencies:[_o,bd],styles:[".padding-td[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important;padding-left:1rem!important;padding-right:0!important}.margin-sm[_ngcontent-%COMP%]{margin-right:1rem!important}.font-size[_ngcontent-%COMP%]{font-size:1rem!important}@media (max-width: 1100px){.padding-td[_ngcontent-%COMP%]{padding-top:.75rem!important;padding-bottom:.75rem!important;padding-left:.75rem!important;padding-right:0!important}.font-size[_ngcontent-%COMP%]{font-size:.9rem!important}.margin-sm[_ngcontent-%COMP%]{margin-right:.75rem!important}.max-with-desc[_ngcontent-%COMP%]{max-width:220px!important}}@media (max-width: 800px){.max-with-desc[_ngcontent-%COMP%]{max-width:150px!important}.font-size[_ngcontent-%COMP%]{font-size:.8rem!important}.margin-sm[_ngcontent-%COMP%]{margin-right:.75rem!important}.max-width-noti[_ngcontent-%COMP%]{max-width:150px!important}}@media (max-width: 500px){.max-with-desc[_ngcontent-%COMP%]{max-width:100px!important}.font-size[_ngcontent-%COMP%]{font-size:.8rem!important}.margin-sm[_ngcontent-%COMP%]{margin-right:.75rem!important}.max-width-noti[_ngcontent-%COMP%]{max-width:100px!important}}"]}),t})();function hhe(t,n){if(1&t){const e=xt();F(0,"button",9),Oe("click",function(){return Ie(e),Me(q(2).backClick())}),F(1,"mat-icon"),ce(2,"arrow_back"),V()()}2&t&&B("disabled",q(2).loadingSignUp)}function phe(t,n){if(1&t&&(F(0,"div",7),J(1,hhe,3,1,"button",8),V()),2&t){const e=q();j(1),B("ngIf",e.displayRegister)}}function fhe(t,n){if(1&t){const e=xt();F(0,"div",10)(1,"div",11)(2,"h3"),ce(3,"Un momento"),V(),F(4,"p"),ce(5," Antes de empezar vamos a configurar tu cuenta "),V()(),F(6,"button",12),Oe("click",function(){return Ie(e),Me(q().showRegister())}),F(7,"div",2)(8,"span",13),ce(9,"Continuar"),V()()()()}2&t&&B("@onEnterDisolve",void 0)}function mhe(t,n){1&t&&(F(0,"div")(1,"span",35),ce(2,"Introduzca un correo v\xe1lido"),V()())}function ghe(t,n){1&t&&(F(0,"div",36)(1,"span",35),ce(2,"Introduzca un correo"),V()())}function _he(t,n){1&t&&(F(0,"div",36)(1,"span",35),ce(2,"El nombre no puede tener m\xe1s de 20 caracteres"),V()())}function yhe(t,n){1&t&&(F(0,"div",36)(1,"span",35),ce(2,"Introduzca un nombre"),V()())}function vhe(t,n){1&t&&(F(0,"div",36)(1,"span",35),ce(2,"El nombre de usuario no puede tener m\xe1s de 10 caracteres"),V()())}function bhe(t,n){1&t&&(F(0,"div",36)(1,"span",35),ce(2,"Introduzca un nombre de usuario"),V()())}function xhe(t,n){1&t&&(Ne(0,"i",39),F(1,"span",40),ce(2,"El email indicado ya est\xe1 registrado."),V())}function whe(t,n){1&t&&(F(0,"p-messages",37),J(1,xhe,3,0,"ng-template",38),V())}function Che(t,n){1&t&&Ne(0,"p-progressSpinner",41)}function The(t,n){if(1&t){const e=xt();F(0,"form",14),Oe("ngSubmit",function(){Ie(e);const r=q();return Me(r.onSubmitSignUp(r.signUpForm))}),F(1,"div",15)(2,"div",16)(3,"h3"),ce(4,"Informaci\xf3n de tu cuenta"),V(),F(5,"p"),ce(6," Danos algunos detalles m\xe1s para configurar tu cuenta "),V()(),F(7,"div",17)(8,"label",18),ce(9,"email"),V(),F(10,"div",19)(11,"span",20),Ne(12,"i",21),V(),Ne(13,"input",22),V(),J(14,mhe,3,0,"div",23),J(15,ghe,3,0,"div",24),V(),F(16,"div",17)(17,"label",25),ce(18,"Nombre"),V(),F(19,"div",19)(20,"span",20),Ne(21,"i",26),V(),Ne(22,"input",27),V(),J(23,_he,3,0,"div",24),J(24,yhe,3,0,"div",24),V(),F(25,"div",17)(26,"label",28),ce(27,"Nombre de usuario"),V(),F(28,"div",19)(29,"span",20),Ne(30,"i",29),V(),Ne(31,"input",30),V(),J(32,vhe,3,0,"div",24),J(33,bhe,3,0,"div",24),V(),J(34,whe,2,0,"p-messages",31),F(35,"button",32)(36,"div",2)(37,"span",13),J(38,Che,1,0,"p-progressSpinner",33),F(39,"p",34),ce(40),V()()()()()()}if(2&t){const e=q();let o,r,s,l,h,g;B("@onEnterDisolve",void 0)("formGroup",e.signUpForm),j(14),B("ngIf",e.signUpForm.controls.signUpEmail.invalid&&!(null!=(o=e.signUpForm.get("signUpEmail"))&&o.hasError("required"))&&(e.signUpForm.controls.signUpEmail.dirty||e.signUpForm.controls.signUpEmail.touched)),j(1),B("ngIf",(null==(r=e.signUpForm.get("signUpEmail"))?null:r.hasError("required"))&&(e.signUpForm.controls.signUpEmail.dirty||e.signUpForm.controls.signUpEmail.touched)),j(8),B("ngIf",(null==(s=e.signUpForm.get("signUpName"))?null:s.hasError("maxlength"))&&(e.signUpForm.controls.signUpName.dirty||e.signUpForm.controls.signUpName.touched)),j(1),B("ngIf",(null==(l=e.signUpForm.get("signUpName"))?null:l.hasError("required"))&&(e.signUpForm.controls.signUpName.dirty||e.signUpForm.controls.signUpName.touched)),j(8),B("ngIf",(null==(h=e.signUpForm.get("signUpNickname"))?null:h.hasError("maxlength"))&&(e.signUpForm.controls.signUpNickname.dirty||e.signUpForm.controls.signUpNickname.touched)),j(1),B("ngIf",(null==(g=e.signUpForm.get("signUpNickname"))?null:g.hasError("required"))&&(e.signUpForm.controls.signUpNickname.dirty||e.signUpForm.controls.signUpNickname.touched)),j(1),B("ngIf",e.emailError),j(1),B("disabled",!e.signUpForm.valid||e.loadingSignUp),j(3),B("ngIf",e.loadingSignUp),j(2),Jt(e.signUpBtnText)}}const Ehe=function(){return["/home"]};function She(t,n){1&t&&(F(0,"div",10)(1,"div",11)(2,"h3"),ce(3,"\xa1Todo listo!"),V(),F(4,"p"),ce(5," Ya puedes empezar a usar Spotivibes "),V()(),F(6,"button",42)(7,"div",2)(8,"span",13),ce(9,"Finalizar"),V()()()()),2&t&&(B("@onEnterDisolve",void 0),j(6),B("routerLink",ai(2,Ehe)))}const Dhe=function(){return{width:"600px",transition:"all 500ms"}},Mhe=function(){return{"650px":"95vw"}},Ihe=function(t,n){return{"h-380":t,"h-460":n}};let khe=(()=>{class t{constructor(e){this.landingPage=e,this.loginDialog=!1,this.displayRegister=!1,this.displayCreated=!1,this.loadingSignUp=!1,this.signUpBtnText="Crear cuenta",this.emailError=!1,this.signUpForm=new tl({})}ngOnInit(){this.signUpForm=new tl({signUpEmail:new gs(this.signUpEmail,[ms.required,ms.email]),signUpName:new gs(this.signUpName,[ms.required,ms.maxLength(20)]),signUpNickname:new gs(this.signUpNickname,[ms.required,ms.maxLength(10)])})}onSubmitSignUp(e){var o=this;return hu(function*(){console.log("Valid?",e.valid),console.log("Email",e.value.signUpEmail),console.log("Name",e.value.signUpName),console.log("Nickname",e.value.signUpNickname),console.log("Password",e.value.signUpPassword),o.loadingSignUp=!0,o.signUpBtnText="Creando cuenta...",yield new Promise(r=>setTimeout(r,5e3)),o.loadingSignUp=!1,o.signUpBtnText="Crear cuenta",o.displayRegister=!1,o.displayCreated=!0})()}cancel(){this.signUpForm.reset(),this.loadingSignUp=!1,this.displayRegister=!1,this.displayCreated=!1,this.signUpBtnText="Crear cuenta"}showRegister(){this.displayRegister=!0}backClick(){this.signUpForm.reset(),this.displayRegister=!1,this.loadingSignUp=!1,this.signUpBtnText="Crear cuenta"}}return t.\u0275fac=function(e){return new(e||t)(be(oM))},t.\u0275cmp=on({type:t,selectors:[["app-login-dialog"]],decls:8,vars:16,consts:[[3,"visible","closable","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header"],[1,"flex","align-items-center","justify-content-center","w-full"],["alt","logo",1,"logo","m-auto"],[1,"animation","h-180",3,"ngClass"],["class","text-center md:px-3 py-3",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"flex","align-items-start"],["class","back-buttons flex align-items-center justify-content-center","type","button",3,"disabled","click",4,"ngIf"],["type","button",1,"back-buttons","flex","align-items-center","justify-content-center",3,"disabled","click"],[1,"text-center","md:px-3","py-3"],[1,"py-2"],["pButton","","pRipple","","type","submit",1,"mt-2","mb-2","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"],[1,"flex","align-items-center","justify-content-center"],[3,"formGroup","ngSubmit"],[1,"md:px-3"],[1,"py-2","text-center"],[1,"form-label-container"],["for","signUpEmail",1,"block","mb-2"],[1,"p-inputgroup"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-envelope"],["id","signUpEmail","name","signUpEmail","formControlName","signUpEmail","placeholder","correo@email.com","type","text","pInputText","",1,"form-control","w-full","h-3rem"],[4,"ngIf"],["class","mb-2",4,"ngIf"],["for","signUpName",1,"block","mb-2"],[1,"pi","pi-user"],["id","signUpName","name","signUpName","formControlName","signUpName","placeholder","Nombre Apellido","type","text","pInputText","",1,"form-control","w-full","h-3rem"],["for","signUpNickname",1,"block","mb-2"],[1,"pi","pi-at"],["id","signUpNickname","name","signUpNickname","formControlName","signUpNickname","placeholder","Nombre de usuario","type","text","pInputText","",1,"form-control","w-full","h-3rem"],["severity","error",4,"ngIf"],["pButton","","pRipple","","type","submit",1,"mt-2","mb-2","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"disabled"],["strokeWidth","5","class","mr-3",4,"ngIf"],[1,"vibe-btn-text-white","w-full"],[1,"text-xs",2,"color","var(--validationErrors)"],[1,"mb-2"],["severity","error"],["pTemplate",""],[1,"pi","pi-exclamation-triangle","mr-2"],[1,"custom-message"],["strokeWidth","5",1,"mr-3"],["pButton","","pRipple","",1,"mt-2","mb-2","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"routerLink"]],template:function(e,o){1&e&&(F(0,"p-dialog",0),Oe("visibleChange",function(s){return o.landingPage.displayFirstLogin=s})("onHide",function(){return o.cancel()}),J(1,phe,2,1,"ng-template",1),F(2,"div",2),Ne(3,"img",3),V(),F(4,"div",4),J(5,fhe,10,1,"div",5),J(6,The,41,12,"form",6),J(7,She,10,3,"div",5),V()()),2&e&&(Ao(ai(11,Dhe)),B("visible",o.landingPage.displayFirstLogin)("closable",!o.displayCreated&&!o.displayRegister)("modal",!0)("draggable",!1)("breakpoints",ai(12,Mhe)),j(4),B("ngClass",no(13,Ihe,o.displayRegister&&!o.emailError,o.displayRegister&&o.emailError)),j(1),B("ngIf",!o.displayRegister&&!o.displayCreated),j(1),B("ngIf",o.displayRegister),j(1),B("ngIf",o.displayCreated))},dependencies:[sg,Eo,mi,tf,dd,Tl,ef,pd,nf,os,_o,fc,mu,El,Qb,mf],styles:[".logo[_ngcontent-%COMP%]{content:var(--logoFooter);background-size:cover;background-repeat:no-repeat;background-position:center;width:13rem}[_nghost-%COMP%]     .p-inputtext{width:100%!important;height:3rem!important;border-top-left-radius:0;border-bottom-left-radius:0}[_nghost-%COMP%]     .p-password{width:100%!important}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:#fff!important}[_nghost-%COMP%]     .p-progress-spinner{height:30px;width:30px}.animation[_ngcontent-%COMP%]{transition:var(--transition)}.h-180[_ngcontent-%COMP%]{height:175px}.h-380[_ngcontent-%COMP%]{height:465px!important}.h-460[_ngcontent-%COMP%]{height:555px!important}"],data:{animation:[cc("onEnterDisolve",[rr(":enter",[go({opacity:0,animation:"disolve 0.8s"}),Ho(800)])])]}}),t})(),Ahe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=fn({type:t,bootstrap:[WD]}),t.\u0275inj=wn({imports:[Qde,Qz,Ei,FP,vR,pu,pF,Zb,uF,nM,AO,$_,cce,ece,oN,CF,rN,sN,aN,IF,DF,lN,_F,aM,fue,JD,mue,Yz,cN,uy,KJ,fN,YM]}),t})();$d(oM,[mi,os,mf,Jde,khe],[]),$d(rM,[mi,she,dhe],[]),KU().bootstrapModule(Ahe).catch(t=>console.error(t))},49:function(tn,Qt,dt){var _t;tn=dt.nmd(tn),function(mt){"object"==typeof global&&global;var Je=function($t){this.message=$t};(Je.prototype=new Error).name="InvalidCharacterError";var Xe=function($t){throw new Je($t)},Ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ye=/[\t\n\f\r ]/g,Kt={encode:function($t){$t=String($t),/[^\0-\xFF]/.test($t)&&Xe("The string to be encoded contains characters outside of the Latin1 range.");for(var Ue,rt,He,bt,Bt=$t.length%3,Se="",ht=-1,Ot=$t.length-Bt;++ht<Ot;)Ue=$t.charCodeAt(ht)<<16,rt=$t.charCodeAt(++ht)<<8,He=$t.charCodeAt(++ht),Se+=Ve.charAt((bt=Ue+rt+He)>>18&63)+Ve.charAt(bt>>12&63)+Ve.charAt(bt>>6&63)+Ve.charAt(63&bt);return 2==Bt?(Ue=$t.charCodeAt(ht)<<8,rt=$t.charCodeAt(++ht),Se+=Ve.charAt((bt=Ue+rt)>>10)+Ve.charAt(bt>>4&63)+Ve.charAt(bt<<2&63)+"="):1==Bt&&(bt=$t.charCodeAt(ht),Se+=Ve.charAt(bt>>2)+Ve.charAt(bt<<4&63)+"=="),Se},decode:function($t){var Bt=($t=String($t).replace(Ye,"")).length;Bt%4==0&&(Bt=($t=$t.replace(/==?$/,"")).length),(Bt%4==1||/[^+a-zA-Z0-9/]/.test($t))&&Xe("Invalid character: the string to be decoded is not correctly encoded.");for(var ht,Ue,Se=0,rt="",He=-1;++He<Bt;)Ue=Ve.indexOf($t.charAt(He)),ht=Se%4?64*ht+Ue:Ue,Se++%4&&(rt+=String.fromCharCode(255&ht>>(-2*Se&6)));return rt},version:"0.1.0"};void 0!==(_t=function(){return Kt}.call(Qt,dt,Qt,tn))&&(tn.exports=_t)}()},69:tn=>{"use strict";var _t,Qt="object"==typeof Reflect?Reflect:null,dt=Qt&&"function"==typeof Qt.apply?Qt.apply:function(He,Et,bt){return Function.prototype.apply.call(He,Et,bt)};_t=Qt&&"function"==typeof Qt.ownKeys?Qt.ownKeys:Object.getOwnPropertySymbols?function(He){return Object.getOwnPropertyNames(He).concat(Object.getOwnPropertySymbols(He))}:function(He){return Object.getOwnPropertyNames(He)};var Ge=Number.isNaN||function(He){return He!=He};function m(){m.init.call(this)}tn.exports=m,tn.exports.once=function Se(rt,He){return new Promise(function(Et,bt){function Ot(zn){rt.removeListener(He,nn),bt(zn)}function nn(){"function"==typeof rt.removeListener&&rt.removeListener("error",Ot),Et([].slice.call(arguments))}Ue(rt,He,nn,{once:!0}),"error"!==He&&function ht(rt,He,Et){"function"==typeof rt.on&&Ue(rt,"error",He,Et)}(rt,Ot,{once:!0})})},m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var re=10;function Je(rt){if("function"!=typeof rt)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof rt)}function Xe(rt){return void 0===rt._maxListeners?m.defaultMaxListeners:rt._maxListeners}function Ve(rt,He,Et,bt){var Ot,nn,zn;if(Je(Et),void 0===(nn=rt._events)?(nn=rt._events=Object.create(null),rt._eventsCount=0):(void 0!==nn.newListener&&(rt.emit("newListener",He,Et.listener?Et.listener:Et),nn=rt._events),zn=nn[He]),void 0===zn)zn=nn[He]=Et,++rt._eventsCount;else if("function"==typeof zn?zn=nn[He]=bt?[Et,zn]:[zn,Et]:bt?zn.unshift(Et):zn.push(Et),(Ot=Xe(rt))>0&&zn.length>Ot&&!zn.warned){zn.warned=!0;var ho=new Error("Possible EventEmitter memory leak detected. "+zn.length+" "+String(He)+" listeners added. Use emitter.setMaxListeners() to increase limit");ho.name="MaxListenersExceededWarning",ho.emitter=rt,ho.type=He,ho.count=zn.length,function mt(rt){console&&console.warn&&console.warn(rt)}(ho)}return rt}function Ye(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ft(rt,He,Et){var bt={fired:!1,wrapFn:void 0,target:rt,type:He,listener:Et},Ot=Ye.bind(bt);return Ot.listener=Et,bt.wrapFn=Ot,Ot}function pn(rt,He,Et){var bt=rt._events;if(void 0===bt)return[];var Ot=bt[He];return void 0===Ot?[]:"function"==typeof Ot?Et?[Ot.listener||Ot]:[Ot]:Et?function Bt(rt){for(var He=new Array(rt.length),Et=0;Et<He.length;++Et)He[Et]=rt[Et].listener||rt[Et];return He}(Ot):rn(Ot,Ot.length)}function Kt(rt){var He=this._events;if(void 0!==He){var Et=He[rt];if("function"==typeof Et)return 1;if(void 0!==Et)return Et.length}return 0}function rn(rt,He){for(var Et=new Array(He),bt=0;bt<He;++bt)Et[bt]=rt[bt];return Et}function Ue(rt,He,Et,bt){if("function"==typeof rt.on)bt.once?rt.once(He,Et):rt.on(He,Et);else{if("function"!=typeof rt.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof rt);rt.addEventListener(He,function Ot(nn){bt.once&&rt.removeEventListener(He,Ot),Et(nn)})}}Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return re},set:function(rt){if("number"!=typeof rt||rt<0||Ge(rt))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+rt+".");re=rt}}),m.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(He){if("number"!=typeof He||He<0||Ge(He))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+He+".");return this._maxListeners=He,this},m.prototype.getMaxListeners=function(){return Xe(this)},m.prototype.emit=function(He){for(var Et=[],bt=1;bt<arguments.length;bt++)Et.push(arguments[bt]);var Ot="error"===He,nn=this._events;if(void 0!==nn)Ot=Ot&&void 0===nn.error;else if(!Ot)return!1;if(Ot){var zn;if(Et.length>0&&(zn=Et[0]),zn instanceof Error)throw zn;var ho=new Error("Unhandled error."+(zn?" ("+zn.message+")":""));throw ho.context=zn,ho}var xo=nn[He];if(void 0===xo)return!1;if("function"==typeof xo)dt(xo,this,Et);else{var Bn=xo.length,vr=rn(xo,Bn);for(bt=0;bt<Bn;++bt)dt(vr[bt],this,Et)}return!0},m.prototype.on=m.prototype.addListener=function(He,Et){return Ve(this,He,Et,!1)},m.prototype.prependListener=function(He,Et){return Ve(this,He,Et,!0)},m.prototype.once=function(He,Et){return Je(Et),this.on(He,Ft(this,He,Et)),this},m.prototype.prependOnceListener=function(He,Et){return Je(Et),this.prependListener(He,Ft(this,He,Et)),this},m.prototype.off=m.prototype.removeListener=function(He,Et){var bt,Ot,nn,zn,ho;if(Je(Et),void 0===(Ot=this._events))return this;if(void 0===(bt=Ot[He]))return this;if(bt===Et||bt.listener===Et)0==--this._eventsCount?this._events=Object.create(null):(delete Ot[He],Ot.removeListener&&this.emit("removeListener",He,bt.listener||Et));else if("function"!=typeof bt){for(nn=-1,zn=bt.length-1;zn>=0;zn--)if(bt[zn]===Et||bt[zn].listener===Et){ho=bt[zn].listener,nn=zn;break}if(nn<0)return this;0===nn?bt.shift():function $t(rt,He){for(;He+1<rt.length;He++)rt[He]=rt[He+1];rt.pop()}(bt,nn),1===bt.length&&(Ot[He]=bt[0]),void 0!==Ot.removeListener&&this.emit("removeListener",He,ho||Et)}return this},m.prototype.removeAllListeners=function(He){var Et,bt,Ot;if(void 0===(bt=this._events))return this;if(void 0===bt.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==bt[He]&&(0==--this._eventsCount?this._events=Object.create(null):delete bt[He]),this;if(0===arguments.length){var zn,nn=Object.keys(bt);for(Ot=0;Ot<nn.length;++Ot)"removeListener"!==(zn=nn[Ot])&&this.removeAllListeners(zn);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Et=bt[He]))this.removeListener(He,Et);else if(void 0!==Et)for(Ot=Et.length-1;Ot>=0;Ot--)this.removeListener(He,Et[Ot]);return this},m.prototype.listeners=function(He){return pn(this,He,!0)},m.prototype.rawListeners=function(He){return pn(this,He,!1)},m.listenerCount=function(rt,He){return"function"==typeof rt.listenerCount?rt.listenerCount(He):Kt.call(rt,He)},m.prototype.listenerCount=Kt,m.prototype.eventNames=function(){return this._eventsCount>0?_t(this._events):[]}},780:tn=>{var dt;tn.exports=dt={},dt.simpleFilter=function(_t,mt){return mt.filter(function(Ge){return dt.test(_t,Ge)})},dt.test=function(_t,mt){return null!==dt.match(_t,mt)},dt.match=function(_t,mt,Ge){var Kt,m=0,re=[],Je=mt.length,Xe=0,Ve=0,Ye=(Ge=Ge||{}).pre||"",Ft=Ge.post||"",pn=Ge.caseSensitive&&mt||mt.toLowerCase();_t=Ge.caseSensitive&&_t||_t.toLowerCase();for(var rn=0;rn<Je;rn++)Kt=mt[rn],pn[rn]===_t[m]?(Kt=Ye+Kt+Ft,m+=1,Ve+=1+Ve):Ve=0,Xe+=Ve,re[re.length]=Kt;return m===_t.length?(Xe=pn===_t?1/0:Xe,{rendered:re.join(""),score:Xe}):null},dt.filter=function(_t,mt,Ge){return mt&&0!==mt.length?"string"!=typeof _t?mt:(Ge=Ge||{},mt.reduce(function(m,re,Je,Xe){var Ve=re;Ge.extract&&(Ve=Ge.extract(re));var Ye=dt.match(_t,Ve,Ge);return null!=Ye&&(m[m.length]={string:Ye.rendered,score:Ye.score,index:Je,original:re}),m},[]).sort(function(m,re){return re.score-m.score||m.index-re.index})):[]}},82:tn=>{var dt=NaN,_t="[object Symbol]",mt=/^\s+|\s+$/g,Ge=/^[-+]0x[0-9a-f]+$/i,m=/^0b[01]+$/i,re=/^0o[0-7]+$/i,Je=parseInt,Xe="object"==typeof global&&global&&global.Object===Object&&global,Ve="object"==typeof self&&self&&self.Object===Object&&self,Ye=Xe||Ve||Function("return this")(),pn=Object.prototype.toString,Kt=Math.max,rn=Math.min,$t=function(){return Ye.Date.now()};function Se(He){var Et=typeof He;return!!He&&("object"==Et||"function"==Et)}function rt(He){if("number"==typeof He)return He;if(function Ue(He){return"symbol"==typeof He||function ht(He){return!!He&&"object"==typeof He}(He)&&pn.call(He)==_t}(He))return dt;if(Se(He)){var Et="function"==typeof He.valueOf?He.valueOf():He;He=Se(Et)?Et+"":Et}if("string"!=typeof He)return 0===He?He:+He;He=He.replace(mt,"");var bt=m.test(He);return bt||re.test(He)?Je(He.slice(2),bt?2:8):Ge.test(He)?dt:+He}tn.exports=function Bt(He,Et,bt){var Ot,nn,zn,ho,xo,Bn,vr=0,lr=!1,qs=!1,Ps=!0;if("function"!=typeof He)throw new TypeError("Expected a function");function Jn(Yn){var Vo=Ot,Nn=nn;return Ot=nn=void 0,vr=Yn,ho=He.apply(Nn,Vo)}function Os(Yn){var Vo=Yn-Bn;return void 0===Bn||Vo>=Et||Vo<0||qs&&Yn-vr>=zn}function ss(){var Yn=$t();if(Os(Yn))return gi(Yn);xo=setTimeout(ss,function Pl(Yn){var vo=Et-(Yn-Bn);return qs?rn(vo,zn-(Yn-vr)):vo}(Yn))}function gi(Yn){return xo=void 0,Ps&&Ot?Jn(Yn):(Ot=nn=void 0,ho)}function ji(){var Yn=$t(),Vo=Os(Yn);if(Ot=arguments,nn=this,Bn=Yn,Vo){if(void 0===xo)return function fa(Yn){return vr=Yn,xo=setTimeout(ss,Et),lr?Jn(Yn):ho}(Bn);if(qs)return xo=setTimeout(ss,Et),Jn(Bn)}return void 0===xo&&(xo=setTimeout(ss,Et)),ho}return Et=rt(Et)||0,Se(bt)&&(lr=!!bt.leading,zn=(qs="maxWait"in bt)?Kt(rt(bt.maxWait)||0,Et):zn,Ps="trailing"in bt?!!bt.trailing:Ps),ji.cancel=function ma(){void 0!==xo&&clearTimeout(xo),vr=0,Ot=Bn=nn=xo=void 0},ji.flush=function Rs(){return void 0===xo?ho:gi($t())},ji}},898:function(tn){tn.exports=function(){"use strict";var Qt,dt,_t;function mt(m,re){if(Qt)if(dt){var Je="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Qt+")(sharedChunk); ("+dt+")(sharedChunk); self.onerror = null;",Xe={};Qt(Xe),_t=re(Xe),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(_t.workerUrl=window.URL.createObjectURL(new Blob([Je],{type:"text/javascript"})))}else dt=re;else Qt=re}return mt(0,function(m){var re=typeof self<"u"?self:{},Je="2.13.0";let Xe;const Ve={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Xe){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Xe=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):c}catch{Xe=c}}return Xe},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ye={supported:!1,testSupport:function(c){!Kt&&pn&&(rn?$t(c):Ft=c)}};let Ft,pn,Kt=!1,rn=!1;function $t(c){const a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,pn),c.isContextLost())return;Ye.supported=!0}catch{}c.deleteTexture(a),Kt=!0}re.document&&(pn=re.document.createElement("img"),pn.onload=function(){Ft&&$t(Ft),Ft=null,rn=!0},pn.onerror=function(){Kt=!0,Ft=null},pn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Bt="01";var Se=ht;function ht(c,a,u,p){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=a,this.p2x=u,this.p2y=p}ht.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,a){if(void 0===a&&(a=1e-6),c<0)return 0;if(c>1)return 1;for(var u=c,p=0;p<8;p++){var _=this.sampleCurveX(u)-c;if(Math.abs(_)<a)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=_/v}var w=0,E=1;for(u=c,p=0;p<20&&(_=this.sampleCurveX(u),!(Math.abs(_-c)<a));p++)c>_?w=u:E=u,u=.5*(E-w)+w;return u},solve:function(c,a){return this.sampleCurveY(this.solveCurveX(c,a))}};var Ue=rt;function rt(c,a){this.x=c,this.y=a}rt.prototype={clone:function(){return new rt(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,a){return this.clone()._rotateAround(c,a)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var a=c.x-this.x,u=c.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,a){return Math.atan2(this.x*a-this.y*c,this.x*c+this.y*a)},_matMult:function(c){var a=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=a,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var a=Math.cos(c),u=Math.sin(c),p=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=p,this},_rotateAround:function(c,a){var u=Math.cos(c),p=Math.sin(c),_=a.y+p*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-p*(this.y-a.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},rt.convert=function(c){return c instanceof rt?c:Array.isArray(c)?new rt(c[0],c[1]):c};const He=Math.PI/180,Et=180/Math.PI;function bt(c){return c*He}function Ot(c){return c*Et}const nn=[[0,0],[1,0],[1,1],[0,1]];function zn(c){if(c<=0)return 0;if(c>=1)return 1;const a=c*c,u=a*c;return 4*(c<.5?u:3*(c-a)+u-.75)}function ho(c,a,u,p){const _=new Se(c,a,u,p);return function(v){return _.solve(v)}}const xo=ho(.25,.1,.25,1);function Bn(c,a,u){return Math.min(u,Math.max(a,c))}function vr(c,a,u){return(u=Bn((u-c)/(a-c),0,1))*u*(3-2*u)}function lr(c,a,u){const p=u-a,_=((c-a)%p+p)%p+a;return _===a?u:_}function qs(c,a,u){if(!c.length)return u(null,[]);let p=c.length;const _=new Array(c.length);let v=null;c.forEach((w,E)=>{a(w,(D,M)=>{D&&(v=D),_[E]=M,0==--p&&u(v,_)})})}function Ps(c){const a=[];for(const u in c)a.push(c[u]);return a}function Jn(c,...a){for(const u of a)for(const p in u)c[p]=u[p];return c}let fa=1;function Pl(){return fa++}function Os(){return function c(a){return a?(a^Math.random()*(16>>a/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function ss(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function gi(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function ma(c,a){c.forEach(u=>{a[u]&&(a[u]=a[u].bind(a))})}function Rs(c,a){return-1!==c.indexOf(a,c.length-a.length)}function ji(c,a,u){const p={};for(const _ in c)p[_]=a.call(u||this,c[_],_,c);return p}function Yn(c,a,u){const p={};for(const _ in c)a.call(u||this,c[_],_,c)&&(p[_]=c[_]);return p}function Vo(c){return Array.isArray(c)?c.map(Vo):"object"==typeof c&&c?ji(c,Vo):c}const Nn={};function vo(c){Nn[c]||(typeof console<"u"&&console.warn(c),Nn[c]=!0)}function Ra(c,a,u){return(u.y-c.y)*(a.x-c.x)>(a.y-c.y)*(u.x-c.x)}function zi(c){let a=0;for(let u,p,_=0,v=c.length,w=v-1;_<v;w=_++)u=c[_],p=c[w],a+=(p.x-u.x)*(u.y+p.y);return a}function La(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function yc(c){const a={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,p,_,v)=>{const w=_||v;return a[p]=!w||w.toLowerCase(),""}),a["max-age"]){const u=parseInt(a["max-age"],10);isNaN(u)?delete a["max-age"]:a["max-age"]=u}return a}let jh=null;function Ol(c){if(null==jh){const a=c.navigator?c.navigator.userAgent:null;jh=!!c.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return jh}function Hh(c){try{const a=re[c];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}}function yu(c,a){return[c[4*a],c[4*a+1],c[4*a+2],c[4*a+3]]}const Ed="mapbox-tiles";let Fa,za,Sd=500,vc=50;function $h(){try{return re.caches}catch{}}function al(){$h()&&!Fa&&(Fa=re.caches.open(Ed))}function vu(c){const a=c.indexOf("?");if(a<0)return c;const p=function(_){const v=_.indexOf("?");return v>0?_.slice(v+1).split("&"):[]}(c).filter(_=>{const v=_.split("=");return"language"===v[0]||"worldview"===v[0]});return p.length?`${c.slice(0,a)}?${p.join("&")}`:c.slice(0,a)}let Dd=1/0;const Md={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Md);class Zs extends Error{constructor(a,u,p){401===u&&Tu(p)&&(a+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(a),this.status=u,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ga=La()?()=>self.worker&&self.worker.referrer:()=>("blob:"===re.location.protocol?re.parent:re).location.href,Rl=function(c,a){if(!(/^file:/.test(u=c.url)||/^file:/.test(ga())&&!/^\w+:/.test(u))){if(re.fetch&&re.Request&&re.AbortController&&re.Request.prototype.hasOwnProperty("signal"))return function(p,_){const v=new re.AbortController,w=new re.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:ga(),signal:v.signal});let E=!1,D=!1;const M=(O=w.url).indexOf("sku=")>0&&Tu(O);var O;"json"===p.type&&w.headers.set("Accept","application/json");const N=(G,K,te)=>{if(D)return;if(G&&"SecurityError"!==G.message&&vo(G),K&&te)return U(K);const se=Date.now();re.fetch(w).then(_e=>{if(_e.ok){const De=M?_e.clone():null;return U(_e,De,se)}return _(new Zs(_e.statusText,_e.status,p.url))}).catch(_e=>{"AbortError"!==_e.name&&_(new Error(`${_e.message} ${p.url}`))})},U=(G,K,te)=>{("arrayBuffer"===p.type?G.arrayBuffer():"json"===p.type?G.json():G.text()).then(se=>{D||(K&&te&&function(_e,De,pe){if(al(),!Fa)return;const we={status:De.status,statusText:De.statusText,headers:new re.Headers};De.headers.forEach((et,Qe)=>we.headers.set(Qe,et));const Ae=yc(De.headers.get("Cache-Control")||"");if(Ae["no-store"])return;Ae["max-age"]&&we.headers.set("Expires",new Date(pe+1e3*Ae["max-age"]).toUTCString());const Ee=we.headers.get("Expires");Ee&&(new Date(Ee).getTime()-pe<42e4||function(et,Qe){if(void 0===za)try{new Response(new ReadableStream),za=!0}catch{za=!1}za?Qe(et.body):et.blob().then(Qe)}(De,et=>{const Qe=new re.Response(et,we);al(),Fa&&Fa.then(pt=>pt.put(vu(_e.url),Qe)).catch(pt=>vo(pt.message))}))}(w,K,te),E=!0,_(null,se,G.headers.get("Cache-Control"),G.headers.get("Expires")))}).catch(se=>{D||_(new Error(se.message))})};return M?function(G,K){if(al(),!Fa)return K(null);const te=vu(G.url);Fa.then(se=>{se.match(te).then(_e=>{const De=function(pe){if(!pe)return!1;const we=new Date(pe.headers.get("Expires")||0),Ae=yc(pe.headers.get("Cache-Control")||"");return we>Date.now()&&!Ae["no-cache"]}(_e);se.delete(te),De&&se.put(te,_e.clone()),K(null,_e,De)}).catch(K)}).catch(K)}(w,N):N(null,null),{cancel:()=>{D=!0,E||v.abort()}}}(c,a);if(La()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,a,void 0,!0)}var u;return function(p,_){const v=new re.XMLHttpRequest;v.open(p.method||"GET",p.url,!0),"arrayBuffer"===p.type&&(v.responseType="arraybuffer");for(const w in p.headers)v.setRequestHeader(w,p.headers[w]);return"json"===p.type&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials="include"===p.credentials,v.onerror=()=>{_(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||0===v.status)&&null!==v.response){let w=v.response;if("json"===p.type)try{w=JSON.parse(v.response)}catch(E){return _(E)}_(null,w,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else _(new Zs(v.statusText,v.status,p.url))},v.send(p.body),{cancel:()=>v.abort()}}(c,a)},bu=function(c,a){return Rl(Jn(c,{type:"arrayBuffer"}),a)};function Id(c){const a=re.document.createElement("a");return a.href=c,a.protocol===re.document.location.protocol&&a.host===re.document.location.host}const kd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let xu,wu;xu=[],wu=0;const Gh=function(c,a){if(Ye.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),wu>=Ve.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:c,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return xu.push(v),v}wu++;let u=!1;const p=()=>{if(!u)for(u=!0,wu--;xu.length&&wu<Ve.MAX_PARALLEL_IMAGE_REQUESTS;){const v=xu.shift(),{requestParameters:w,callback:E,cancelled:D}=v;D||(v.cancel=Gh(w,E).cancel)}},_=bu(c,(v,w,E,D)=>{p(),v?a(v):w&&(re.createImageBitmap?function(M,O){const N=new re.Blob([new Uint8Array(M)],{type:"image/png"});re.createImageBitmap(N).then(U=>{O(null,U)}).catch(U=>{O(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(w,(M,O)=>a(M,O,E,D)):function(M,O){const N=new re.Image,U=re.URL;N.onload=()=>{O(null,N),U.revokeObjectURL(N.src),N.onload=null,re.requestAnimationFrame(()=>{N.src=kd})},N.onerror=()=>O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const G=new re.Blob([new Uint8Array(M)],{type:"image/png"});N.src=M.byteLength?U.createObjectURL(G):kd}(w,(M,O)=>a(M,O,E,D)))});return{cancel:()=>{_.cancel(),p()}}},Cu="NO_ACCESS_TOKEN";function Na(c){return 0===c.indexOf("mapbox:")}function Tu(c){return Ve.API_URL_REGEX.test(c)}function Eu(c){return Ve.API_CDN_URL_REGEX.test(c)}function Ad(c){return Ve.API_STYLE_REGEX.test(c)&&!bc(c)}function bc(c){return Ve.API_SPRITE_REGEX.test(c)}const Ll=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function vs(c){const a=c.match(Ll);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Fl(c){const a=c.params.length?`?${c.params.join("&")}`:"";return`${c.protocol}://${c.authority}${c.path}${a}`}function Pd(c){if(!c)return null;const a=c.split(".");if(!a||3!==a.length)return null;try{return JSON.parse(decodeURIComponent(re.atob(a[1]).split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class zl{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const u=Pd(Ve.ACCESS_TOKEN);let p="";return p=u&&u.u?re.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,(_,v)=>String.fromCharCode(Number("0x"+v)))):Ve.ACCESS_TOKEN||"",a?`mapbox.eventData.${a}:${p}`:`mapbox.eventData:${p}`}fetchEventData(){const a=Hh("localStorage"),u=this.getStorageKey(),p=this.getStorageKey("uuid");if(a)try{const _=re.localStorage.getItem(u);_&&(this.eventData=JSON.parse(_));const v=re.localStorage.getItem(p);v&&(this.anonId=v)}catch{vo("Unable to read from LocalStorage")}}saveEventData(){const a=Hh("localStorage"),u=this.getStorageKey(),p=this.getStorageKey("uuid");if(a)try{re.localStorage.setItem(p,this.anonId),Object.keys(this.eventData).length>=1&&re.localStorage.setItem(u,JSON.stringify(this.eventData))}catch{vo("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,u,p,_){if(!Ve.EVENTS_URL)return;const v=vs(Ve.EVENTS_URL);v.params.push(`access_token=${_||Ve.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(a).toISOString()},E=u?Jn(w,u):w,D={url:Fl(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};var O;this.pendingRequest=(O=M=>{this.pendingRequest=null,p(M),this.saveEventData(),this.processRequests(_)},Rl(Jn(D,{method:"POST"}),O))}queueRequest(a,u){this.queue.push(a),this.processRequests(u)}}const me=new class extends zl{constructor(c){super("appUserTurnstile"),this._customAccessToken=c}postTurnstileEvent(c,a){Ve.EVENTS_URL&&Ve.ACCESS_TOKEN&&Array.isArray(c)&&c.some(u=>Na(u)||Tu(u))&&this.queueRequest(Date.now(),a)}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=Pd(Ve.ACCESS_TOKEN),u=a?a.u:Ve.ACCESS_TOKEN;let p=u!==this.eventData.tokenU;gi(this.anonId)||(this.anonId=Os(),p=!0);const _=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),w=new Date(_),E=(_-this.eventData.lastSuccess)/864e5;p=p||E>=1||E<-1||v.getDate()!==w.getDate()}else p=!0;p?this.postEvent(_,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Je,skuId:Bt,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=_,this.eventData.tokenU=u)},c):this.processRequests()}},Y=me.postTurnstileEvent.bind(me),ne=new class extends zl{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(c,a,u,p){this.skuToken=a,this.errorCb=p,Ve.EVENTS_URL&&(u||Ve.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Cu)))}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),gi(this.anonId)||(this.anonId=Os()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Je,skuId:Bt,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):a&&(this.success[a]=!0)},c))}},fe=ne.postMapLoadEvent.bind(ne),Te=new class extends zl{constructor(){super("gljs.performance")}postPerformanceEvent(c,a){Ve.EVENTS_URL&&(c||Ve.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},c)}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:a,performanceData:u}=this.queue.shift(),p=function(_){const v=re.performance.getEntriesByType("resource"),w=re.performance.getEntriesByType("mark"),E=function(U){const G={};if(U)for(const K in U)if("other"!==K)for(const te of U[K]){const se=`${K}ResolveRangeMin`,_e=`${K}ResolveRangeMax`,De=`${K}RequestCount`,pe=`${K}RequestCachedCount`;G[se]=Math.min(G[se]||1/0,te.startTime),G[_e]=Math.max(G[_e]||-1/0,te.responseEnd);const we=Ae=>{void 0===G[Ae]&&(G[Ae]=0),++G[Ae]};void 0!==te.transferSize&&0===te.transferSize&&we(pe),we(De)}return G}(function(U,G){const K={};if(U)for(const te of U){const se=G(te);void 0===K[se]&&(K[se]=[]),K[se].push(te)}return K}(v,Xt)),D=re.devicePixelRatio,M=re.navigator.connection||re.navigator.mozConnection||re.navigator.webkitConnection,O={counters:[],metadata:[],attributes:[]},N=(U,G,K)=>{null!=K&&U.push({name:G,value:K.toString()})};for(const U in E)N(O.counters,U,E[U]);if(_.interactionRange[0]!==1/0&&_.interactionRange[1]!==-1/0&&(N(O.counters,"interactionRangeMin",_.interactionRange[0]),N(O.counters,"interactionRangeMax",_.interactionRange[1])),w)for(const U of Object.keys(tt)){const G=tt[U],K=w.find(te=>te.name===G);K&&N(O.counters,G,K.startTime)}return N(O.counters,"visibilityHidden",_.visibilityHidden),N(O.attributes,"style",function(U){if(U)for(const G of U){const K=G.name.split("?")[0];if(Ad(K)){const te=K.split("/").slice(-2);if(2===te.length)return`mapbox://styles/${te[0]}/${te[1]}`}}}(v)),N(O.attributes,"terrainEnabled",_.terrainEnabled?"true":"false"),N(O.attributes,"fogEnabled",_.fogEnabled?"true":"false"),N(O.attributes,"projection",_.projection),N(O.attributes,"zoom",_.zoom),N(O.metadata,"devicePixelRatio",D),N(O.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),N(O.metadata,"navigatorUserAgent",re.navigator.userAgent),N(O.metadata,"screenWidth",re.screen.width),N(O.metadata,"screenHeight",re.screen.height),N(O.metadata,"windowWidth",re.innerWidth),N(O.metadata,"windowHeight",re.innerHeight),N(O.metadata,"mapWidth",_.width/D),N(O.metadata,"mapHeight",_.height/D),N(O.metadata,"webglRenderer",_.renderer),N(O.metadata,"webglVendor",_.vendor),N(O.metadata,"sdkVersion",Je),N(O.metadata,"sdkIdentifier","mapbox-gl-js"),O}(u);for(const _ of p.metadata);for(const _ of p.counters);for(const _ of p.attributes);this.postEvent(a,p,()=>{},c)}},Re=Te.postPerformanceEvent.bind(Te),qe=new class extends zl{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(c,a,u,p){if(!Ve.API_URL||!Ve.SESSION_PATH)return;const _=vs(Ve.API_URL+Ve.SESSION_PATH);_.params.push(`sku=${a||""}`),_.params.push(`access_token=${p||Ve.ACCESS_TOKEN||""}`);const v={url:Fl(_),headers:{"Content-Type":"text/plain"}};var E;this.pendingRequest=(E=w=>{this.pendingRequest=null,u(w),this.saveEventData(),this.processRequests(p)},Rl(Jn(v,{method:"GET"}),E))}getSessionAPI(c,a,u,p){this.skuToken=a,this.errorCb=p,Ve.SESSION_PATH&&Ve.API_URL&&(u||Ve.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Cu)))}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||this.getSession(u,this.skuToken,p=>{p?this.errorCb(p):a&&(this.success[a]=!0)},c)}},We=qe.getSessionAPI.bind(qe),ze=new Set,tt={create:"create",load:"load",fullLoad:"fullLoad"},wt={mark(c){re.performance.mark(c)},measure(c,a,u){re.performance.measure(c,a,u)}};function Xt(c){const a=c.name.split("?")[0];return Eu(a)&&a.includes("mapbox-gl.js")?"javascript":Eu(a)&&a.includes("mapbox-gl.css")?"css":Ve.API_FONTS_REGEX.test(a)?"fontRange":bc(a)?"sprite":Ad(a)?"style":Ve.API_TILEJSON_REGEX.test(a)?"tilejson":"other"}const St=re.performance;function Sn(c){const a=c?c.url.toString():void 0;return St.getEntriesByName(a)}let dn,Mn,Vn,oi;const Ri={now:()=>void 0!==Vn?Vn:re.performance.now(),setNow(c){Vn=c},restoreNow(){Vn=void 0},frame(c){const a=re.requestAnimationFrame(c);return{cancel:()=>re.cancelAnimationFrame(a)}},getImageData(c,a=0){const{width:u,height:p}=c;oi||(oi=re.document.createElement("canvas"));const _=oi.getContext("2d",{willReadFrequently:!0});if(!_)throw new Error("failed to create canvas 2d context");return(u>oi.width||p>oi.height)&&(oi.width=u,oi.height=p),_.clearRect(-a,-a,u+2*a,p+2*a),_.drawImage(c,0,0,u,p),_.getImageData(-a,-a,u+2*a,p+2*a)},resolveURL:c=>(dn||(dn=re.document.createElement("a")),dn.href=c,dn.href),get devicePixelRatio(){return re.devicePixelRatio},get prefersReducedMotion(){return!!re.matchMedia&&(null==Mn&&(Mn=re.matchMedia("(prefers-reduced-motion: reduce)")),Mn.matches)}};function On(c,a,u){u[c]&&-1!==u[c].indexOf(a)||(u[c]=u[c]||[],u[c].push(a))}function Vi(c,a,u){if(u&&u[c]){const p=u[c].indexOf(a);-1!==p&&u[c].splice(p,1)}}class oo{constructor(a,u={}){Jn(this,u),this.type=a}}class ll extends oo{constructor(a,u={}){super("error",Jn({error:a},u))}}class Ba{on(a,u){return this._listeners=this._listeners||{},On(a,u,this._listeners),this}off(a,u){return Vi(a,u,this._listeners),Vi(a,u,this._oneTimeListeners),this}once(a,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},On(a,u,this._oneTimeListeners),this):new Promise(p=>this.once(a,p))}fire(a,u){"string"==typeof a&&(a=new oo(a,u||{}));const p=a.type;if(this.listens(p)){a.target=this;const _=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const E of _)E.call(this,a);const v=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const E of v)Vi(p,E,this._oneTimeListeners),E.call(this,a);const w=this._eventedParent;w&&(Jn(a,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),w.fire(a))}else a instanceof ll&&console.error(a.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,u){return this._eventedParent=a,this._eventedParentData=u,this}}var gt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function cl(c,...a){for(const u of a)for(const p in u)c[p]=u[p];return c}function Go(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Nl(c){if(Array.isArray(c))return c.map(Nl);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const a={};for(const u in c)a[u]=Nl(c[u]);return a}return Go(c)}class Tf extends Error{constructor(a,u){super(u),this.message=u,this.key=a}}var Va=Tf;class Su{constructor(a,u=[]){this.parent=a,this.bindings={};for(const[p,_]of u)this.bindings[p]=_}concat(a){return new Su(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}var Wo=Su;const xc={kind:"null"},Gt={kind:"number"},_i={kind:"string"},Cn={kind:"boolean"},Ks={kind:"color"},eo={kind:"object"},ci={kind:"value"},Od={kind:"collator"},xi={kind:"formatted"},$n={kind:"resolvedImage"};function kr(c,a){return{kind:"array",itemType:c,N:a}}function ro(c){if("array"===c.kind){const a=ro(c.itemType);return"number"==typeof c.N?`array<${a}, ${c.N}>`:"value"===c.itemType.kind?"array":`array<${a}>`}return c.kind}const by=[xc,Gt,_i,Cn,Ks,xi,eo,kr(ci),$n];function Ar(c,a){if("error"===a.kind)return null;if("array"===c.kind){if("array"===a.kind&&(0===a.N&&"value"===a.itemType.kind||!Ar(c.itemType,a.itemType))&&("number"!=typeof c.N||c.N===a.N))return null}else{if(c.kind===a.kind)return null;if("value"===c.kind)for(const u of by)if(!Ar(u,a))return null}return`Expected ${ro(c)} but found ${ro(a)} instead.`}function Dt(c,a){return a.some(u=>u.kind===c.kind)}function Ua(c,a){return a.some(u=>"null"===u?null===c:"array"===u?Array.isArray(c):"object"===u?c&&!Array.isArray(c)&&"object"==typeof c:u===typeof c)}var ri,Zi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Rd(c){return(c=Math.round(c))<0?0:c>255?255:c}function Du(c){return Rd("%"===c[c.length-1]?parseFloat(c)/100*255:parseInt(c))}function Mu(c){return(a="%"===c[c.length-1]?parseFloat(c)/100:parseFloat(c))<0?0:a>1?1:a;var a}function Iu(c,a,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?c+(a-c)*u*6:2*u<1?a:3*u<2?c+(a-c)*(2/3-u)*6:c}try{ri={}.parseCSSColor=function(c){var a,u=c.replace(/ /g,"").toLowerCase();if(u in Zi)return Zi[u].slice();if("#"===u[0])return 4===u.length?(a=parseInt(u.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:7===u.length&&(a=parseInt(u.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var p=u.indexOf("("),_=u.indexOf(")");if(-1!==p&&_+1===u.length){var v=u.substr(0,p),w=u.substr(p+1,_-(p+1)).split(","),E=1;switch(v){case"rgba":if(4!==w.length)return null;E=Mu(w.pop());case"rgb":return 3!==w.length?null:[Du(w[0]),Du(w[1]),Du(w[2]),E];case"hsla":if(4!==w.length)return null;E=Mu(w.pop());case"hsl":if(3!==w.length)return null;var D=(parseFloat(w[0])%360+360)%360/360,M=Mu(w[1]),O=Mu(w[2]),N=O<=.5?O*(M+1):O+M-O*M,U=2*O-N;return[Rd(255*Iu(U,N,D+1/3)),Rd(255*Iu(U,N,D)),Rd(255*Iu(U,N,D-1/3)),E];default:return null}}return null}}catch{}class Do{constructor(a,u,p,_=1){this.r=a,this.g=u,this.b=p,this.a=_}static parse(a){if(!a)return;if(a instanceof Do)return a;if("string"!=typeof a)return;const u=ri(a);return u?new Do(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[a,u,p,_]=this.toArray();return`rgba(${Math.round(a)},${Math.round(u)},${Math.round(p)},${_})`}toArray(){const{r:a,g:u,b:p,a:_}=this;return 0===_?[0,0,0,0]:[255*a/_,255*u/_,255*p/_,_]}toArray01(){const{r:a,g:u,b:p,a:_}=this;return 0===_?[0,0,0,0]:[a/_,u/_,p/_,_]}toArray01PremultipliedAlpha(){const{r:a,g:u,b:p,a:_}=this;return[a,u,p,_]}}Do.black=new Do(0,0,0,1),Do.white=new Do(1,1,1,1),Do.transparent=new Do(0,0,0,0),Do.red=new Do(1,0,0,1),Do.blue=new Do(0,0,1,1);var qo=Do;class Wh{constructor(a,u,p){this.sensitivity=a?u?"variant":"case":u?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,u){return this.collator.compare(a,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class qh{constructor(a,u,p,_,v){this.text=a.normalize?a.normalize():a,this.image=u,this.scale=p,this.fontStack=_,this.textColor=v}}class Zo{constructor(a){this.sections=a}static fromString(a){return new Zo([new qh(a,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(a=>0!==a.text.length||a.image&&0!==a.image.name.length)}static factory(a){return a instanceof Zo?a:Zo.fromString(a)}toString(){return 0===this.sections.length?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const u of this.sections){if(u.image){a.push(["image",u.image.name]);continue}a.push(u.text);const p={};u.fontStack&&(p["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(p["font-scale"]=u.scale),u.textColor&&(p["text-color"]=["rgba"].concat(u.textColor.toArray())),a.push(p)}return a}}class bs{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new bs({name:a,available:!1}):null}serialize(){return["image",this.name]}}function xy(c,a,u,p){return"number"==typeof c&&c>=0&&c<=255&&"number"==typeof a&&a>=0&&a<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===p||"number"==typeof p&&p>=0&&p<=1?null:`Invalid rgba value [${[c,a,u,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof p?[c,a,u,p]:[c,a,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ef(c){if(null===c||"string"==typeof c||"boolean"==typeof c||"number"==typeof c||c instanceof qo||c instanceof Wh||c instanceof Zo||c instanceof bs)return!0;if(Array.isArray(c)){for(const a of c)if(!Ef(a))return!1;return!0}if("object"==typeof c){for(const a in c)if(!Ef(c[a]))return!1;return!0}return!1}function cr(c){if(null===c)return xc;if("string"==typeof c)return _i;if("boolean"==typeof c)return Cn;if("number"==typeof c)return Gt;if(c instanceof qo)return Ks;if(c instanceof Wh)return Od;if(c instanceof Zo)return xi;if(c instanceof bs)return $n;if(Array.isArray(c)){const a=c.length;let u;for(const p of c){const _=cr(p);if(u){if(u===_)continue;u=ci;break}u=_}return kr(u||ci,a)}return eo}function Ld(c){const a=typeof c;return null===c?"":"string"===a||"number"===a||"boolean"===a?String(c):c instanceof qo||c instanceof Zo||c instanceof bs?c.toString():JSON.stringify(c)}class xg{constructor(a,u){this.type=a,this.value=u}static parse(a,u){if(2!==a.length)return u.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Ef(a[1]))return u.error("invalid value");const p=a[1];let _=cr(p);const v=u.expectedType;return"array"!==_.kind||0!==_.N||!v||"array"!==v.kind||"number"==typeof v.N&&0!==v.N||(_=v),new xg(_,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof qo?["rgba"].concat(this.value.toArray()):this.value instanceof Zo?this.value.serialize():this.value}}var Fd=xg,Kr=class{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}};const as={string:_i,number:Gt,boolean:Cn,object:eo};class Ui{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");let p,_=1;const v=a[0];if("array"===v){let E,D;if(a.length>2){const M=a[1];if("string"!=typeof M||!(M in as)||"object"===M)return u.error('The item type argument of "array" must be one of string, number, boolean',1);E=as[M],_++}else E=ci;if(a.length>3){if(null!==a[2]&&("number"!=typeof a[2]||a[2]<0||a[2]!==Math.floor(a[2])))return u.error('The length argument to "array" must be a positive integer literal',2);D=a[2],_++}p=kr(E,D)}else p=as[v];const w=[];for(;_<a.length;_++){const E=u.parse(a[_],_,ci);if(!E)return null;w.push(E)}return new Ui(p,w)}evaluate(a){for(let u=0;u<this.args.length;u++){const p=this.args[u].evaluate(a);if(!Ar(this.type,cr(p)))return p;if(u===this.args.length-1)throw new Kr(`Expected value to be of type ${ro(this.type)}, but found ${ro(cr(p))} instead.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,u=[a.kind];if("array"===a.kind){const p=a.itemType;if("string"===p.kind||"number"===p.kind||"boolean"===p.kind){u.push(p.kind);const _=a.N;("number"==typeof _||this.args.length>1)&&u.push(_)}}return u.concat(this.args.map(p=>p.serialize()))}}var Bl=Ui;class Zh{constructor(a){this.type=xi,this.sections=a}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const p=a[1];if(!Array.isArray(p)&&"object"==typeof p)return u.error("First argument must be an image or text section.");const _=[];let v=!1;for(let w=1;w<=a.length-1;++w){const E=a[w];if(v&&"object"==typeof E&&!Array.isArray(E)){v=!1;let D=null;if(E["font-scale"]&&(D=u.parse(E["font-scale"],1,Gt),!D))return null;let M=null;if(E["text-font"]&&(M=u.parse(E["text-font"],1,kr(_i)),!M))return null;let O=null;if(E["text-color"]&&(O=u.parse(E["text-color"],1,Ks),!O))return null;const N=_[_.length-1];N.scale=D,N.font=M,N.textColor=O}else{const D=u.parse(a[w],1,ci);if(!D)return null;const M=D.type.kind;if("string"!==M&&"value"!==M&&"null"!==M&&"resolvedImage"!==M)return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,_.push({content:D,scale:null,font:null,textColor:null})}}return new Zh(_)}evaluate(a){return new Zo(this.sections.map(u=>{const p=u.content.evaluate(a);return cr(p)===$n?new qh("",p,null,null,null):new qh(Ld(p),null,u.scale?u.scale.evaluate(a):null,u.font?u.font.evaluate(a).join(","):null,u.textColor?u.textColor.evaluate(a):null)}))}eachChild(a){for(const u of this.sections)a(u.content),u.scale&&a(u.scale),u.font&&a(u.font),u.textColor&&a(u.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const u of this.sections){a.push(u.content.serialize());const p={};u.scale&&(p["font-scale"]=u.scale.serialize()),u.font&&(p["text-font"]=u.font.serialize()),u.textColor&&(p["text-color"]=u.textColor.serialize()),a.push(p)}return a}}class Sf{constructor(a){this.type=$n,this.input=a}static parse(a,u){if(2!==a.length)return u.error("Expected two arguments.");const p=u.parse(a[1],1,_i);return p?new Sf(p):u.error("No image name provided.")}evaluate(a){const u=this.input.evaluate(a),p=bs.fromString(u);return p&&a.availableImages&&(p.available=a.availableImages.indexOf(u)>-1),p}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const an={"to-boolean":Cn,"to-color":Ks,"to-number":Gt,"to-string":_i};class wg{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const p=a[0];if(("to-boolean"===p||"to-string"===p)&&2!==a.length)return u.error("Expected one argument.");const _=an[p],v=[];for(let w=1;w<a.length;w++){const E=u.parse(a[w],w,ci);if(!E)return null;v.push(E)}return new wg(_,v)}evaluate(a){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(a));if("color"===this.type.kind){let u,p;for(const _ of this.args){if(u=_.evaluate(a),p=null,u instanceof qo)return u;if("string"==typeof u){const v=a.parseColor(u);if(v)return v}else if(Array.isArray(u)&&(p=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:xy(u[0],u[1],u[2],u[3]),!p))return new qo(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new Kr(p||`Could not parse color from value '${"string"==typeof u?u:String(JSON.stringify(u))}'`)}if("number"===this.type.kind){let u=null;for(const p of this.args){if(u=p.evaluate(a),null===u)return 0;const _=Number(u);if(!isNaN(_))return _}throw new Kr(`Could not convert ${JSON.stringify(u)} to number.`)}return"formatted"===this.type.kind?Zo.fromString(Ld(this.args[0].evaluate(a))):"resolvedImage"===this.type.kind?bs.fromString(Ld(this.args[0].evaluate(a))):Ld(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Zh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Sf(this.args[0]).serialize();const a=[`to-${this.type.kind}`];return this.eachChild(u=>{a.push(u.serialize())}),a}}var wn=wg;const zd=["Unknown","Point","LineString","Polygon"];var Nd=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?zd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:u,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*a-c[0])+this.featureDistanceData.bearing[1]*(p*a-c[1])}return 0}parseColor(c){let a=this._parseColorCache[c];return a||(a=this._parseColorCache[c]=qo.parse(c)),a}};class wc{constructor(a,u,p,_){this.name=a,this.type=u,this._evaluate=p,this.args=_}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,u){const p=a[0],_=wc.definitions[p];if(!_)return u.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(_)?_[0]:_.type,w=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,E=w.filter(([M])=>!Array.isArray(M)||M.length===a.length-1);let D=null;for(const[M,O]of E){D=new kf(u.registry,u.path,null,u.scope);const N=[];let U=!1;for(let G=1;G<a.length;G++){const K=a[G],te=Array.isArray(M)?M[G-1]:M.type,se=D.parse(K,1+N.length,te);if(!se){U=!0;break}N.push(se)}if(!U)if(Array.isArray(M)&&M.length!==N.length)D.error(`Expected ${M.length} arguments, but found ${N.length} instead.`);else{for(let G=0;G<N.length;G++){const K=Array.isArray(M)?M[G]:M.type,te=N[G];D.concat(G+1).checkSubtype(K,te.type)}if(0===D.errors.length)return new wc(p,v,O,N)}}if(1===E.length)u.errors.push(...D.errors);else{const M=(E.length?E:w).map(([N])=>{return U=N,Array.isArray(U)?`(${U.map(ro).join(", ")})`:`(${ro(U.type)}...)`;var U}).join(" | "),O=[];for(let N=1;N<a.length;N++){const U=u.parse(a[N],1+O.length);if(!U)return null;O.push(ro(U.type))}u.error(`Expected arguments of type ${M}, but found (${O.join(", ")}) instead.`)}return null}static register(a,u){wc.definitions=u;for(const p in u)a[p]=wc}}var Vl=wc;class Kh{constructor(a,u,p){this.type=Od,this.locale=p,this.caseSensitive=a,this.diacriticSensitive=u}static parse(a,u){if(2!==a.length)return u.error("Expected one argument.");const p=a[1];if("object"!=typeof p||Array.isArray(p))return u.error("Collator options argument must be an object.");const _=u.parse(void 0!==p["case-sensitive"]&&p["case-sensitive"],1,Cn);if(!_)return null;const v=u.parse(void 0!==p["diacritic-sensitive"]&&p["diacritic-sensitive"],1,Cn);if(!v)return null;let w=null;return p.locale&&(w=u.parse(p.locale,1,_i),!w)?null:new Kh(_,v,w)}evaluate(a){return new Wh(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}const ul=8192;function ls(c,a){c[0]=Math.min(c[0],a[0]),c[1]=Math.min(c[1],a[1]),c[2]=Math.max(c[2],a[0]),c[3]=Math.max(c[3],a[1])}function Cc(c,a){return!(c[0]<=a[0]||c[2]>=a[2]||c[1]<=a[1]||c[3]>=a[3])}function Df(c,a){const u=(180+c[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,_=Math.pow(2,a.z);return[Math.round(u*_*ul),Math.round(p*_*ul)]}function Cg(c,a,u){const p=c[0]-a[0],_=c[1]-a[1],v=c[0]-u[0],w=c[1]-u[1];return p*w-v*_==0&&p*v<=0&&_*w<=0}function Wn(c,a){let u=!1;for(let w=0,E=a.length;w<E;w++){const D=a[w];for(let M=0,O=D.length;M<O-1;M++){if(Cg(c,D[M],D[M+1]))return!1;(_=D[M])[1]>(p=c)[1]!=(v=D[M+1])[1]>p[1]&&p[0]<(v[0]-_[0])*(p[1]-_[1])/(v[1]-_[1])+_[0]&&(u=!u)}}var p,_,v;return u}function Xh(c,a){for(let u=0;u<a.length;u++)if(Wn(c,a[u]))return!0;return!1}function Mf(c,a,u,p){const _=p[0]-u[0],v=p[1]-u[1],w=(c[0]-u[0])*v-_*(c[1]-u[1]),E=(a[0]-u[0])*v-_*(a[1]-u[1]);return w>0&&E<0||w<0&&E>0}function xs(c,a,u){for(const M of u)for(let O=0;O<M.length-1;++O)if((E=[(w=M[O+1])[0]-(v=M[O])[0],w[1]-v[1]])[0]*(D=[(_=a)[0]-(p=c)[0],_[1]-p[1]])[1]-E[1]*D[0]!=0&&Mf(p,_,v,w)&&Mf(v,w,p,_))return!0;var p,_,v,w,E,D;return!1}function Tc(c,a){for(let u=0;u<c.length;++u)if(!Wn(c[u],a))return!1;for(let u=0;u<c.length-1;++u)if(xs(c[u],c[u+1],a))return!1;return!0}function wy(c,a){for(let u=0;u<a.length;u++)if(Tc(c,a[u]))return!0;return!1}function bo(c,a,u){const p=[];for(let _=0;_<c.length;_++){const v=[];for(let w=0;w<c[_].length;w++){const E=Df(c[_][w],u);ls(a,E),v.push(E)}p.push(v)}return p}function If(c,a,u){const p=[];for(let _=0;_<c.length;_++){const v=bo(c[_],a,u);p.push(v)}return p}function Tg(c,a,u,p){if(c[0]<u[0]||c[0]>u[2]){const _=.5*p;let v=c[0]-u[0]>_?-p:u[0]-c[0]>_?p:0;0===v&&(v=c[0]-u[2]>_?-p:u[2]-c[0]>_?p:0),c[0]+=v}ls(a,c)}function ku(c,a,u,p){const _=Math.pow(2,p.z)*ul,v=[p.x*ul,p.y*ul],w=[];if(!c)return w;for(const E of c)for(const D of E){const M=[D.x+v[0],D.y+v[1]];Tg(M,a,u,_),w.push(M)}return w}function Ai(c,a,u,p){const _=Math.pow(2,p.z)*ul,v=[p.x*ul,p.y*ul],w=[];if(!c)return w;for(const D of c){const M=[];for(const O of D){const N=[O.x+v[0],O.y+v[1]];ls(a,N),M.push(N)}w.push(M)}if(a[2]-a[0]<=_/2){(E=a)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const D of w)for(const M of D)Tg(M,a,u,_)}var E;return w}class Ec{constructor(a,u){this.type=Cn,this.geojson=a,this.geometries=u}static parse(a,u){if(2!==a.length)return u.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Ef(a[1])){const p=a[1];if("FeatureCollection"===p.type)for(let _=0;_<p.features.length;++_){const v=p.features[_].geometry.type;if("Polygon"===v||"MultiPolygon"===v)return new Ec(p,p.features[_].geometry)}else if("Feature"===p.type){const _=p.geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new Ec(p,p.geometry)}else if("Polygon"===p.type||"MultiPolygon"===p.type)return new Ec(p,p)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(null!=a.geometry()&&null!=a.canonicalID()){if("Point"===a.geometryType())return function(u,p){const _=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(!w)return!1;if("Polygon"===p.type){const E=bo(p.coordinates,v,w),D=ku(u.geometry(),_,v,w);if(!Cc(_,v))return!1;for(const M of D)if(!Wn(M,E))return!1}if("MultiPolygon"===p.type){const E=If(p.coordinates,v,w),D=ku(u.geometry(),_,v,w);if(!Cc(_,v))return!1;for(const M of D)if(!Xh(M,E))return!1}return!0}(a,this.geometries);if("LineString"===a.geometryType())return function(u,p){const _=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(!w)return!1;if("Polygon"===p.type){const E=bo(p.coordinates,v,w),D=Ai(u.geometry(),_,v,w);if(!Cc(_,v))return!1;for(const M of D)if(!Tc(M,E))return!1}if("MultiPolygon"===p.type){const E=If(p.coordinates,v,w),D=Ai(u.geometry(),_,v,w);if(!Cc(_,v))return!1;for(const M of D)if(!wy(M,E))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Au=Ec;function Bd(c){if(c instanceof Vl&&("get"===c.name&&1===c.args.length||"feature-state"===c.name||"has"===c.name&&1===c.args.length||"properties"===c.name||"geometry-type"===c.name||"id"===c.name||/^filter-/.test(c.name))||c instanceof Au)return!1;let a=!0;return c.eachChild(u=>{a&&!Bd(u)&&(a=!1)}),a}function Vd(c){if(c instanceof Vl&&"feature-state"===c.name)return!1;let a=!0;return c.eachChild(u=>{a&&!Vd(u)&&(a=!1)}),a}function Yh(c,a){if(c instanceof Vl&&a.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(p=>{u&&!Yh(p,a)&&(u=!1)}),u}class Ud{constructor(a,u){this.type=u.type,this.name=a,this.boundExpression=u}static parse(a,u){if(2!==a.length||"string"!=typeof a[1])return u.error("'var' expression requires exactly one string literal argument.");const p=a[1];return u.scope.has(p)?new Ud(p,u.scope.get(p)):u.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Sc=Ud;class dl{constructor(a,u=[],p,_=new Wo,v=[]){this.registry=a,this.path=u,this.key=u.map(w=>`[${w}]`).join(""),this.scope=_,this.errors=v,this.expectedType=p}parse(a,u,p,_,v={}){return u?this.concat(u,p,_)._parse(a,v):this._parse(a,v)}_parse(a,u){function p(_,v,w){return"assert"===w?new Bl(v,[_]):"coerce"===w?new wn(v,[_]):_}if(null!==a&&"string"!=typeof a&&"boolean"!=typeof a&&"number"!=typeof a||(a=["literal",a]),Array.isArray(a)){if(0===a.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=a[0];if("string"!=typeof _)return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[_];if(v){let w=v.parse(a,this);if(!w)return null;if(this.expectedType){const E=this.expectedType,D=w.type;if("string"!==E.kind&&"number"!==E.kind&&"boolean"!==E.kind&&"object"!==E.kind&&"array"!==E.kind||"value"!==D.kind)if("color"!==E.kind&&"formatted"!==E.kind&&"resolvedImage"!==E.kind||"value"!==D.kind&&"string"!==D.kind){if(this.checkSubtype(E,D))return null}else w=p(w,E,u.typeAnnotation||"coerce");else w=p(w,E,u.typeAnnotation||"assert")}if(!(w instanceof Fd)&&"resolvedImage"!==w.type.kind&&Rt(w)){const E=new Nd;try{w=new Fd(w.type,w.evaluate(E))}catch(D){return this.error(D.message),null}}return w}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===a?"'undefined' value invalid. Use null instead.":"object"==typeof a?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,u,p){const _="number"==typeof a?this.path.concat(a):this.path,v=p?this.scope.concat(p):this.scope;return new dl(this.registry,_,u||null,v,this.errors)}error(a,...u){const p=`${this.key}${u.map(_=>`[${_}]`).join("")}`;this.errors.push(new Va(p,a))}checkSubtype(a,u){const p=Ar(a,u);return p&&this.error(p),p}}var kf=dl;function Rt(c){if(c instanceof Sc)return Rt(c.boundExpression);if(c instanceof Vl&&"error"===c.name||c instanceof Kh||c instanceof Au)return!1;const a=c instanceof wn||c instanceof Bl;let u=!0;return c.eachChild(p=>{u=a?u&&Rt(p):u&&p instanceof Fd}),!!u&&Bd(c)&&Yh(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ul(c,a){const u=c.length-1;let p,_,v=0,w=u,E=0;for(;v<=w;)if(E=Math.floor((v+w)/2),p=c[E],_=c[E+1],p<=a){if(E===u||a<_)return E;v=E+1}else{if(!(p>a))throw new Kr("Input is not a number.");w=E-1}return 0}class ti{constructor(a,u,p){this.type=a,this.input=u,this.labels=[],this.outputs=[];for(const[_,v]of p)this.labels.push(_),this.outputs.push(v)}static parse(a,u){if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");const p=u.parse(a[1],1,Gt);if(!p)return null;const _=[];let v=null;u.expectedType&&"value"!==u.expectedType.kind&&(v=u.expectedType);for(let w=1;w<a.length;w+=2){const E=1===w?-1/0:a[w],D=a[w+1],M=w,O=w+1;if("number"!=typeof E)return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(_.length&&_[_.length-1][0]>=E)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const N=u.parse(D,O,v);if(!N)return null;v=v||N.type,_.push([E,N])}return new ti(v,p,_)}evaluate(a){const u=this.labels,p=this.outputs;if(1===u.length)return p[0].evaluate(a);const _=this.input.evaluate(a);if(_<=u[0])return p[0].evaluate(a);const v=u.length;return _>=u[v-1]?p[v-1].evaluate(a):p[Ul(u,_)].evaluate(a)}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&a.push(this.labels[u]),a.push(this.outputs[u].serialize());return a}}var Pu=ti;function Si(c,a,u){return c*(1-u)+a*u}var hl=Object.freeze({__proto__:null,number:Si,color:function(c,a,u){return new qo(Si(c.r,a.r,u),Si(c.g,a.g,u),Si(c.b,a.b,u),Si(c.a,a.a,u))},array:function(c,a,u){return c.map((p,_)=>Si(p,a[_],u))}});const Eg=.95047,Sg=1.08883,Af=4/29,ja=6/29,Xs=3*ja*ja,Ys=Math.PI/180,pl=180/Math.PI;function Hi(c){return c>.008856451679035631?Math.pow(c,1/3):c/Xs+Af}function Ou(c){return c>ja?c*c*c:Xs*(c-Af)}function Ru(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Lu(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Pf(c){const a=Lu(c.r),u=Lu(c.g),p=Lu(c.b),_=Hi((.4124564*a+.3575761*u+.1804375*p)/Eg),v=Hi((.2126729*a+.7151522*u+.072175*p)/1);return{l:116*v-16,a:500*(_-v),b:200*(v-Hi((.0193339*a+.119192*u+.9503041*p)/Sg)),alpha:c.a}}function Ha(c){let a=(c.l+16)/116,u=isNaN(c.a)?a:a+c.a/500,p=isNaN(c.b)?a:a-c.b/200;return a=1*Ou(a),u=Eg*Ou(u),p=Sg*Ou(p),new qo(Ru(3.2404542*u-1.5371385*a-.4985314*p),Ru(-.969266*u+1.8760108*a+.041556*p),Ru(.0556434*u-.2040259*a+1.0572252*p),c.alpha)}function jd(c,a,u){const p=a-c;return c+u*(p>180||p<-180?p-360*Math.round(p/360):p)}const Hd={forward:Pf,reverse:Ha,interpolate:function(c,a,u){return{l:Si(c.l,a.l,u),a:Si(c.a,a.a,u),b:Si(c.b,a.b,u),alpha:Si(c.alpha,a.alpha,u)}}},on={forward:function(c){const{l:a,a:u,b:p}=Pf(c),_=Math.atan2(p,u)*pl;return{h:_<0?_+360:_,c:Math.sqrt(u*u+p*p),l:a,alpha:c.a}},reverse:function(c){const a=c.h*Ys,u=c.c;return Ha({l:c.l,a:Math.cos(a)*u,b:Math.sin(a)*u,alpha:c.alpha})},interpolate:function(c,a,u){return{h:jd(c.h,a.h,u),c:Si(c.c,a.c,u),l:Si(c.l,a.l,u),alpha:Si(c.alpha,a.alpha,u)}}};var $d=Object.freeze({__proto__:null,lab:Hd,hcl:on});class Fu{constructor(a,u,p,_,v){this.type=a,this.operator=u,this.interpolation=p,this.input=_,this.labels=[],this.outputs=[];for(const[w,E]of v)this.labels.push(w),this.outputs.push(E)}static interpolationFactor(a,u,p,_){let v=0;if("exponential"===a.name)v=Qh(u,a.base,p,_);else if("linear"===a.name)v=Qh(u,1,p,_);else if("cubic-bezier"===a.name){const w=a.controlPoints;v=new Se(w[0],w[1],w[2],w[3]).solve(Qh(u,1,p,_))}return v}static parse(a,u){let[p,_,v,...w]=a;if(!Array.isArray(_)||0===_.length)return u.error("Expected an interpolation type expression.",1);if("linear"===_[0])_={name:"linear"};else if("exponential"===_[0]){const M=_[1];if("number"!=typeof M)return u.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:M}}else{if("cubic-bezier"!==_[0])return u.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const M=_.slice(1);if(4!==M.length||M.some(O=>"number"!=typeof O||O<0||O>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:M}}}if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(v=u.parse(v,2,Gt),!v)return null;const E=[];let D=null;"interpolate-hcl"===p||"interpolate-lab"===p?D=Ks:u.expectedType&&"value"!==u.expectedType.kind&&(D=u.expectedType);for(let M=0;M<w.length;M+=2){const O=w[M],N=w[M+1],U=M+3,G=M+4;if("number"!=typeof O)return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(E.length&&E[E.length-1][0]>=O)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const K=u.parse(N,G,D);if(!K)return null;D=D||K.type,E.push([O,K])}return"number"===D.kind||"color"===D.kind||"array"===D.kind&&"number"===D.itemType.kind&&"number"==typeof D.N?new Fu(D,p,_,v,E):u.error(`Type ${ro(D)} is not interpolatable.`)}evaluate(a){const u=this.labels,p=this.outputs;if(1===u.length)return p[0].evaluate(a);const _=this.input.evaluate(a);if(_<=u[0])return p[0].evaluate(a);const v=u.length;if(_>=u[v-1])return p[v-1].evaluate(a);const w=Ul(u,_),E=Fu.interpolationFactor(this.interpolation,_,u[w],u[w+1]),D=p[w].evaluate(a),M=p[w+1].evaluate(a);return"interpolate"===this.operator?hl[this.type.kind.toLowerCase()](D,M,E):"interpolate-hcl"===this.operator?on.reverse(on.interpolate(on.forward(D),on.forward(M),E)):Hd.reverse(Hd.interpolate(Hd.forward(D),Hd.forward(M),E))}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,a,this.input.serialize()];for(let p=0;p<this.labels.length;p++)u.push(this.labels[p],this.outputs[p].serialize());return u}}function Qh(c,a,u,p){const _=p-u,v=c-u;return 0===_?0:1===a?v/_:(Math.pow(a,v)-1)/(Math.pow(a,_)-1)}var fn=Fu;class Of{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expectected at least one argument.");let p=null;const _=u.expectedType;_&&"value"!==_.kind&&(p=_);const v=[];for(const E of a.slice(1)){const D=u.parse(E,1+v.length,p,void 0,{typeAnnotation:"omit"});if(!D)return null;p=p||D.type,v.push(D)}const w=_&&v.some(E=>Ar(_,E.type));return new Of(w?ci:p,v)}evaluate(a){let u,p=null,_=0;for(const v of this.args){if(_++,p=v.evaluate(a),p&&p instanceof bs&&!p.available&&(u||(u=p),p=null,_===this.args.length))return u;if(null!==p)break}return p}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var Rf=Of;class kn{constructor(a,u){this.type=u.type,this.bindings=[].concat(a),this.result=u}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const u of this.bindings)a(u[1]);a(this.result)}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const p=[];for(let v=1;v<a.length-1;v+=2){const w=a[v];if("string"!=typeof w)return u.error(`Expected string, but found ${typeof w} instead.`,v);if(/[^a-zA-Z0-9_]/.test(w))return u.error("Variable names must contain only alphanumeric characters or '_'.",v);const E=u.parse(a[v+1],v+1);if(!E)return null;p.push([w,E])}const _=u.parse(a[a.length-1],a.length-1,u.expectedType,p);return _?new kn(p,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[u,p]of this.bindings)a.push(u,p.serialize());return a.push(this.result.serialize()),a}}var Pr=kn;class Ki{constructor(a,u,p){this.type=a,this.index=u,this.input=p}static parse(a,u){if(3!==a.length)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=u.parse(a[1],1,Gt),_=u.parse(a[2],2,kr(u.expectedType||ci));return p&&_?new Ki(_.type.itemType,p,_):null}evaluate(a){const u=this.index.evaluate(a),p=this.input.evaluate(a);if(u<0)throw new Kr(`Array index out of bounds: ${u} < 0.`);if(u>=p.length)throw new Kr(`Array index out of bounds: ${u} > ${p.length-1}.`);if(u!==Math.floor(u))throw new Kr(`Array index must be an integer, but found ${u} instead.`);return p[u]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Xr=Ki;class Or{constructor(a,u){this.type=Cn,this.needle=a,this.haystack=u}static parse(a,u){if(3!==a.length)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=u.parse(a[1],1,ci),_=u.parse(a[2],2,ci);return p&&_?Dt(p.type,[Cn,_i,Gt,xc,ci])?new Or(p,_):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${ro(p.type)} instead`):null}evaluate(a){const u=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(null==p)return!1;if(!Ua(u,["boolean","string","number","null"]))throw new Kr(`Expected first argument to be of type boolean, string, number or null, but found ${ro(cr(u))} instead.`);if(!Ua(p,["string","array"]))throw new Kr(`Expected second argument to be of type array or string, but found ${ro(cr(p))} instead.`);return p.indexOf(u)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Dc=Or;class Rr{constructor(a,u,p){this.type=Gt,this.needle=a,this.haystack=u,this.fromIndex=p}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=u.parse(a[1],1,ci),_=u.parse(a[2],2,ci);if(!p||!_)return null;if(!Dt(p.type,[Cn,_i,Gt,xc,ci]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${ro(p.type)} instead`);if(4===a.length){const v=u.parse(a[3],3,Gt);return v?new Rr(p,_,v):null}return new Rr(p,_)}evaluate(a){const u=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!Ua(u,["boolean","string","number","null"]))throw new Kr(`Expected first argument to be of type boolean, string, number or null, but found ${ro(cr(u))} instead.`);if(!Ua(p,["string","array"]))throw new Kr(`Expected second argument to be of type array or string, but found ${ro(cr(p))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(a);return p.indexOf(u,_)}return p.indexOf(u)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var $a=Rr;class vn{constructor(a,u,p,_,v,w){this.inputType=a,this.type=u,this.input=p,this.cases=_,this.outputs=v,this.otherwise=w}static parse(a,u){if(a.length<5)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return u.error("Expected an even number of arguments.");let p,_;u.expectedType&&"value"!==u.expectedType.kind&&(_=u.expectedType);const v={},w=[];for(let M=2;M<a.length-1;M+=2){let O=a[M];const N=a[M+1];Array.isArray(O)||(O=[O]);const U=u.concat(M);if(0===O.length)return U.error("Expected at least one branch label.");for(const K of O){if("number"!=typeof K&&"string"!=typeof K)return U.error("Branch labels must be numbers or strings.");if("number"==typeof K&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof K&&Math.floor(K)!==K)return U.error("Numeric branch labels must be integer values.");if(p){if(U.checkSubtype(p,cr(K)))return null}else p=cr(K);if(void 0!==v[String(K)])return U.error("Branch labels must be unique.");v[String(K)]=w.length}const G=u.parse(N,M,_);if(!G)return null;_=_||G.type,w.push(G)}const E=u.parse(a[1],1,ci);if(!E)return null;const D=u.parse(a[a.length-1],a.length-1,_);return D?"value"!==E.type.kind&&u.concat(1).checkSubtype(p,E.type)?null:new vn(p,_,E,v,w,D):null}evaluate(a){const u=this.input.evaluate(a);return(cr(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),p=[],_={};for(const w of u){const E=_[this.cases[w]];void 0===E?(_[this.cases[w]]=p.length,p.push([this.cases[w],[w]])):p[E][1].push(w)}const v=w=>"number"===this.inputType.kind?Number(w):w;for(const[w,E]of p)a.push(1===E.length?v(E[0]):E.map(v)),a.push(this.outputs[w].serialize());return a.push(this.otherwise.serialize()),a}}var Ci=vn;class Fo{constructor(a,u,p){this.type=a,this.branches=u,this.otherwise=p}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return u.error("Expected an odd number of arguments.");let p;u.expectedType&&"value"!==u.expectedType.kind&&(p=u.expectedType);const _=[];for(let w=1;w<a.length-1;w+=2){const E=u.parse(a[w],w,Cn);if(!E)return null;const D=u.parse(a[w+1],w+1,p);if(!D)return null;_.push([E,D]),p=p||D.type}const v=u.parse(a[a.length-1],a.length-1,p);return v?new Fo(p,_,v):null}evaluate(a){for(const[u,p]of this.branches)if(u.evaluate(a))return p.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[u,p]of this.branches)a(u),a(p);a(this.otherwise)}outputDefined(){return this.branches.every(([a,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var _a=Fo;class Ls{constructor(a,u,p,_){this.type=a,this.input=u,this.beginIndex=p,this.endIndex=_}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=u.parse(a[1],1,ci),_=u.parse(a[2],2,Gt);if(!p||!_)return null;if(!Dt(p.type,[kr(ci),_i,ci]))return u.error(`Expected first argument to be of type array or string, but found ${ro(p.type)} instead`);if(4===a.length){const v=u.parse(a[3],3,Gt);return v?new Ls(p.type,p,_,v):null}return new Ls(p.type,p,_)}evaluate(a){const u=this.input.evaluate(a),p=this.beginIndex.evaluate(a);if(!Ua(u,["string","array"]))throw new Kr(`Expected first argument to be of type array or string, but found ${ro(cr(u))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(a);return u.slice(p,_)}return u.slice(p)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Lr=Ls;function jl(c,a){return"=="===c||"!="===c?"boolean"===a.kind||"string"===a.kind||"number"===a.kind||"null"===a.kind||"value"===a.kind:"string"===a.kind||"number"===a.kind||"value"===a.kind}function Uo(c,a,u,p){return 0===p.compare(a,u)}function fl(c,a,u){const p="=="!==c&&"!="!==c;return class mN{constructor(v,w,E){this.type=Cn,this.lhs=v,this.rhs=w,this.collator=E,this.hasUntypedArgument="value"===v.type.kind||"value"===w.type.kind}static parse(v,w){if(3!==v.length&&4!==v.length)return w.error("Expected two or three arguments.");const E=v[0];let D=w.parse(v[1],1,ci);if(!D)return null;if(!jl(E,D.type))return w.concat(1).error(`"${E}" comparisons are not supported for type '${ro(D.type)}'.`);let M=w.parse(v[2],2,ci);if(!M)return null;if(!jl(E,M.type))return w.concat(2).error(`"${E}" comparisons are not supported for type '${ro(M.type)}'.`);if(D.type.kind!==M.type.kind&&"value"!==D.type.kind&&"value"!==M.type.kind)return w.error(`Cannot compare types '${ro(D.type)}' and '${ro(M.type)}'.`);p&&("value"===D.type.kind&&"value"!==M.type.kind?D=new Bl(M.type,[D]):"value"!==D.type.kind&&"value"===M.type.kind&&(M=new Bl(D.type,[M])));let O=null;if(4===v.length){if("string"!==D.type.kind&&"string"!==M.type.kind&&"value"!==D.type.kind&&"value"!==M.type.kind)return w.error("Cannot use collator to compare non-string types.");if(O=w.parse(v[3],3,Od),!O)return null}return new mN(D,M,O)}evaluate(v){const w=this.lhs.evaluate(v),E=this.rhs.evaluate(v);if(p&&this.hasUntypedArgument){const D=cr(w),M=cr(E);if(D.kind!==M.kind||"string"!==D.kind&&"number"!==D.kind)throw new Kr(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${D.kind}, ${M.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const D=cr(w),M=cr(E);if("string"!==D.kind||"string"!==M.kind)return a(v,w,E)}return this.collator?u(v,w,E,this.collator.evaluate(v)):a(v,w,E)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[c];return this.eachChild(w=>{v.push(w.serialize())}),v}}}const Jh=fl("==",function(c,a,u){return a===u},Uo),Ti=fl("!=",function(c,a,u){return a!==u},function(c,a,u,p){return!Uo(0,a,u,p)}),ep=fl("<",function(c,a,u){return a<u},function(c,a,u,p){return p.compare(a,u)<0}),zu=fl(">",function(c,a,u){return a>u},function(c,a,u,p){return p.compare(a,u)>0}),tp=fl("<=",function(c,a,u){return a<=u},function(c,a,u,p){return p.compare(a,u)<=0}),Nu=fl(">=",function(c,a,u){return a>=u},function(c,a,u,p){return p.compare(a,u)>=0});class br{constructor(a,u,p,_,v,w){this.type=_i,this.number=a,this.locale=u,this.currency=p,this.unit=_,this.minFractionDigits=v,this.maxFractionDigits=w}static parse(a,u){if(3!==a.length)return u.error("Expected two arguments.");const p=u.parse(a[1],1,Gt);if(!p)return null;const _=a[2];if("object"!=typeof _||Array.isArray(_))return u.error("NumberFormat options argument must be an object.");let v=null;if(_.locale&&(v=u.parse(_.locale,1,_i),!v))return null;let w=null;if(_.currency&&(w=u.parse(_.currency,1,_i),!w))return null;let E=null;if(_.unit&&(E=u.parse(_.unit,1,_i),!E))return null;let D=null;if(_["min-fraction-digits"]&&(D=u.parse(_["min-fraction-digits"],1,Gt),!D))return null;let M=null;return _["max-fraction-digits"]&&(M=u.parse(_["max-fraction-digits"],1,Gt),!M)?null:new br(p,v,w,E,D,M)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(a):void 0,unit:this.unit?this.unit.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.unit&&a(this.unit),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.unit&&(a.unit=this.unit.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class Mc{constructor(a){this.type=Gt,this.input=a}static parse(a,u){if(2!==a.length)return u.error(`Expected 1 argument, but found ${a.length-1} instead.`);const p=u.parse(a[1],1);return p?"array"!==p.type.kind&&"string"!==p.type.kind&&"value"!==p.type.kind?u.error(`Expected argument of type string or array, but found ${ro(p.type)} instead.`):new Mc(p):null}evaluate(a){const u=this.input.evaluate(a);if("string"==typeof u||Array.isArray(u))return u.length;throw new Kr(`Expected value to be of type string or array, but found ${ro(cr(u))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(u=>{a.push(u.serialize())}),a}}const Ic={"==":Jh,"!=":Ti,">":zu,"<":ep,">=":Nu,"<=":tp,array:Bl,at:Xr,boolean:Bl,case:_a,coalesce:Rf,collator:Kh,format:Zh,image:Sf,in:Dc,"index-of":$a,interpolate:fn,"interpolate-hcl":fn,"interpolate-lab":fn,length:Mc,let:Pr,literal:Fd,match:Ci,number:Bl,"number-format":br,object:Bl,slice:Lr,step:Pu,string:Bl,"to-boolean":wn,"to-color":wn,"to-number":wn,"to-string":wn,var:Sc,within:Au};function ya(c,[a,u,p,_]){a=a.evaluate(c),u=u.evaluate(c),p=p.evaluate(c);const v=_?_.evaluate(c):1,w=xy(a,u,p,v);if(w)throw new Kr(w);return new qo(a/255*v,u/255*v,p/255*v,v)}function Bu(c,a){return c in a}function np(c,a){const u=a[c];return void 0===u?null:u}function to(c){return{type:c}}Vl.register(Ic,{error:[{kind:"error"},[_i],(c,[a])=>{throw new Kr(a.evaluate(c))}],typeof:[_i,[ci],(c,[a])=>ro(cr(a.evaluate(c)))],"to-rgba":[kr(Gt,4),[Ks],(c,[a])=>a.evaluate(c).toArray()],rgb:[Ks,[Gt,Gt,Gt],ya],rgba:[Ks,[Gt,Gt,Gt,Gt],ya],has:{type:Cn,overloads:[[[_i],(c,[a])=>Bu(a.evaluate(c),c.properties())],[[_i,eo],(c,[a,u])=>Bu(a.evaluate(c),u.evaluate(c))]]},get:{type:ci,overloads:[[[_i],(c,[a])=>np(a.evaluate(c),c.properties())],[[_i,eo],(c,[a,u])=>np(a.evaluate(c),u.evaluate(c))]]},"feature-state":[ci,[_i],(c,[a])=>np(a.evaluate(c),c.featureState||{})],properties:[eo,[],c=>c.properties()],"geometry-type":[_i,[],c=>c.geometryType()],id:[ci,[],c=>c.id()],zoom:[Gt,[],c=>c.globals.zoom],pitch:[Gt,[],c=>c.globals.pitch||0],"distance-from-center":[Gt,[],c=>c.distanceFromCenter()],"heatmap-density":[Gt,[],c=>c.globals.heatmapDensity||0],"line-progress":[Gt,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[Gt,[],c=>c.globals.skyRadialProgress||0],accumulated:[ci,[],c=>void 0===c.globals.accumulated?null:c.globals.accumulated],"+":[Gt,to(Gt),(c,a)=>{let u=0;for(const p of a)u+=p.evaluate(c);return u}],"*":[Gt,to(Gt),(c,a)=>{let u=1;for(const p of a)u*=p.evaluate(c);return u}],"-":{type:Gt,overloads:[[[Gt,Gt],(c,[a,u])=>a.evaluate(c)-u.evaluate(c)],[[Gt],(c,[a])=>-a.evaluate(c)]]},"/":[Gt,[Gt,Gt],(c,[a,u])=>a.evaluate(c)/u.evaluate(c)],"%":[Gt,[Gt,Gt],(c,[a,u])=>a.evaluate(c)%u.evaluate(c)],ln2:[Gt,[],()=>Math.LN2],pi:[Gt,[],()=>Math.PI],e:[Gt,[],()=>Math.E],"^":[Gt,[Gt,Gt],(c,[a,u])=>Math.pow(a.evaluate(c),u.evaluate(c))],sqrt:[Gt,[Gt],(c,[a])=>Math.sqrt(a.evaluate(c))],log10:[Gt,[Gt],(c,[a])=>Math.log(a.evaluate(c))/Math.LN10],ln:[Gt,[Gt],(c,[a])=>Math.log(a.evaluate(c))],log2:[Gt,[Gt],(c,[a])=>Math.log(a.evaluate(c))/Math.LN2],sin:[Gt,[Gt],(c,[a])=>Math.sin(a.evaluate(c))],cos:[Gt,[Gt],(c,[a])=>Math.cos(a.evaluate(c))],tan:[Gt,[Gt],(c,[a])=>Math.tan(a.evaluate(c))],asin:[Gt,[Gt],(c,[a])=>Math.asin(a.evaluate(c))],acos:[Gt,[Gt],(c,[a])=>Math.acos(a.evaluate(c))],atan:[Gt,[Gt],(c,[a])=>Math.atan(a.evaluate(c))],min:[Gt,to(Gt),(c,a)=>Math.min(...a.map(u=>u.evaluate(c)))],max:[Gt,to(Gt),(c,a)=>Math.max(...a.map(u=>u.evaluate(c)))],abs:[Gt,[Gt],(c,[a])=>Math.abs(a.evaluate(c))],round:[Gt,[Gt],(c,[a])=>{const u=a.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[Gt,[Gt],(c,[a])=>Math.floor(a.evaluate(c))],ceil:[Gt,[Gt],(c,[a])=>Math.ceil(a.evaluate(c))],"filter-==":[Cn,[_i,ci],(c,[a,u])=>c.properties()[a.value]===u.value],"filter-id-==":[Cn,[ci],(c,[a])=>c.id()===a.value],"filter-type-==":[Cn,[_i],(c,[a])=>c.geometryType()===a.value],"filter-<":[Cn,[_i,ci],(c,[a,u])=>{const p=c.properties()[a.value],_=u.value;return typeof p==typeof _&&p<_}],"filter-id-<":[Cn,[ci],(c,[a])=>{const u=c.id(),p=a.value;return typeof u==typeof p&&u<p}],"filter->":[Cn,[_i,ci],(c,[a,u])=>{const p=c.properties()[a.value],_=u.value;return typeof p==typeof _&&p>_}],"filter-id->":[Cn,[ci],(c,[a])=>{const u=c.id(),p=a.value;return typeof u==typeof p&&u>p}],"filter-<=":[Cn,[_i,ci],(c,[a,u])=>{const p=c.properties()[a.value],_=u.value;return typeof p==typeof _&&p<=_}],"filter-id-<=":[Cn,[ci],(c,[a])=>{const u=c.id(),p=a.value;return typeof u==typeof p&&u<=p}],"filter->=":[Cn,[_i,ci],(c,[a,u])=>{const p=c.properties()[a.value],_=u.value;return typeof p==typeof _&&p>=_}],"filter-id->=":[Cn,[ci],(c,[a])=>{const u=c.id(),p=a.value;return typeof u==typeof p&&u>=p}],"filter-has":[Cn,[ci],(c,[a])=>a.value in c.properties()],"filter-has-id":[Cn,[],c=>null!==c.id()&&void 0!==c.id()],"filter-type-in":[Cn,[kr(_i)],(c,[a])=>a.value.indexOf(c.geometryType())>=0],"filter-id-in":[Cn,[kr(ci)],(c,[a])=>a.value.indexOf(c.id())>=0],"filter-in-small":[Cn,[_i,kr(ci)],(c,[a,u])=>u.value.indexOf(c.properties()[a.value])>=0],"filter-in-large":[Cn,[_i,kr(ci)],(c,[a,u])=>function(p,_,v,w){for(;v<=w;){const E=v+w>>1;if(_[E]===p)return!0;_[E]>p?w=E-1:v=E+1}return!1}(c.properties()[a.value],u.value,0,u.value.length-1)],all:{type:Cn,overloads:[[[Cn,Cn],(c,[a,u])=>a.evaluate(c)&&u.evaluate(c)],[to(Cn),(c,a)=>{for(const u of a)if(!u.evaluate(c))return!1;return!0}]]},any:{type:Cn,overloads:[[[Cn,Cn],(c,[a,u])=>a.evaluate(c)||u.evaluate(c)],[to(Cn),(c,a)=>{for(const u of a)if(u.evaluate(c))return!0;return!1}]]},"!":[Cn,[Cn],(c,[a])=>!a.evaluate(c)],"is-supported-script":[Cn,[_i],(c,[a])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(a.evaluate(c))}],upcase:[_i,[_i],(c,[a])=>a.evaluate(c).toUpperCase()],downcase:[_i,[_i],(c,[a])=>a.evaluate(c).toLowerCase()],concat:[_i,to(ci),(c,a)=>a.map(u=>Ld(u.evaluate(c))).join("")],"resolved-locale":[_i,[Od],(c,[a])=>a.evaluate(c).resolvedLocale()]});var Gd=Ic;function kc(c){return{result:"success",value:c}}function Ac(c){return{result:"error",value:c}}function ml(c){return"data-driven"===c["property-type"]}function Qs(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function gl(c){return!!c.expression&&c.expression.interpolated}function qn(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":null===c?"null":typeof c}function Lf(c){return"object"==typeof c&&null!==c&&!Array.isArray(c)}function Fs(c){return c}function zs(c,a){const u="color"===a.type,p=c.stops&&"object"==typeof c.stops[0][0],_=p||!(p||void 0!==c.property),v=c.type||(gl(a)?"exponential":"interval");if(u&&((c=cl({},c)).stops&&(c.stops=c.stops.map(M=>[M[0],qo.parse(M[1])])),c.default=qo.parse(c.default?c.default:a.default)),c.colorSpace&&"rgb"!==c.colorSpace&&!$d[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let w,E,D;if("exponential"===v)w=ws;else if("interval"===v)w=Wd;else if("categorical"===v){w=Oc,E=Object.create(null);for(const M of c.stops)E[M[0]]=M[1];D=typeof c.stops[0][0]}else{if("identity"!==v)throw new Error(`Unknown function type "${v}"`);w=Dg}if(p){const M={},O=[];for(let G=0;G<c.stops.length;G++){const K=c.stops[G],te=K[0].zoom;void 0===M[te]&&(M[te]={zoom:te,type:c.type,property:c.property,default:c.default,stops:[]},O.push(te)),M[te].stops.push([K[0].value,K[1]])}const N=[];for(const G of O)N.push([M[G].zoom,zs(M[G],a)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:fn.interpolationFactor.bind(void 0,U),zoomStops:N.map(G=>G[0]),evaluate:({zoom:G},K)=>ws({stops:N,base:c.base},a,G).evaluate(G,K)}}if(_){const M="exponential"===v?{name:"exponential",base:void 0!==c.base?c.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:fn.interpolationFactor.bind(void 0,M),zoomStops:c.stops.map(O=>O[0]),evaluate:({zoom:O})=>w(c,a,O,E,D)}}return{kind:"source",evaluate(M,O){const N=O&&O.properties?O.properties[c.property]:void 0;return void 0===N?Pc(c.default,a.default):w(c,a,N,E,D)}}}function Pc(c,a,u){return void 0!==c?c:void 0!==a?a:void 0!==u?u:void 0}function Oc(c,a,u,p,_){return Pc(typeof u===_?p[u]:void 0,c.default,a.default)}function Wd(c,a,u){if("number"!==qn(u))return Pc(c.default,a.default);const p=c.stops.length;if(1===p||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[p-1][0])return c.stops[p-1][1];const _=Ul(c.stops.map(v=>v[0]),u);return c.stops[_][1]}function ws(c,a,u){const p=void 0!==c.base?c.base:1;if("number"!==qn(u))return Pc(c.default,a.default);const _=c.stops.length;if(1===_||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[_-1][0])return c.stops[_-1][1];const v=Ul(c.stops.map(O=>O[0]),u),w=function(O,N,U,G){const K=G-U,te=O-U;return 0===K?0:1===N?te/K:(Math.pow(N,te)-1)/(Math.pow(N,K)-1)}(u,p,c.stops[v][0],c.stops[v+1][0]),E=c.stops[v][1],D=c.stops[v+1][1];let M=hl[a.type]||Fs;if(c.colorSpace&&"rgb"!==c.colorSpace){const O=$d[c.colorSpace];M=(N,U)=>O.reverse(O.interpolate(O.forward(N),O.forward(U),w))}return"function"==typeof E.evaluate?{evaluate(...O){const N=E.evaluate.apply(void 0,O),U=D.evaluate.apply(void 0,O);if(void 0!==N&&void 0!==U)return M(N,U,w)}}:M(E,D,w)}function Dg(c,a,u){return"color"===a.type?u=qo.parse(u):"formatted"===a.type?u=Zo.fromString(u.toString()):"resolvedImage"===a.type?u=bs.fromString(u.toString()):qn(u)===a.type||"enum"===a.type&&a.values[u]||(u=void 0),Pc(u,c.default,a.default)}class Ff{constructor(a,u){var p;this.expression=a,this._warningHistory={},this._evaluator=new Nd,this._defaultValue=u?"color"===(p=u).type&&(Lf(p.default)||Array.isArray(p.default))?new qo(0,0,0,0):"color"===p.type?qo.parse(p.default)||null:void 0===p.default?null:p.default:null,this._enumValues=u&&"enum"===u.type?u.values:null}evaluateWithoutErrorHandling(a,u,p,_,v,w,E,D){return this._evaluator.globals=a,this._evaluator.feature=u,this._evaluator.featureState=p,this._evaluator.canonical=_||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=D||null,this.expression.evaluate(this._evaluator)}evaluate(a,u,p,_,v,w,E,D){this._evaluator.globals=a,this._evaluator.feature=u||null,this._evaluator.featureState=p||null,this._evaluator.canonical=_||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=D||null;try{const M=this.expression.evaluate(this._evaluator);if(null==M||"number"==typeof M&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new Kr(`Expected value to be one of ${Object.keys(this._enumValues).map(O=>JSON.stringify(O)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function Vu(c){return Array.isArray(c)&&c.length>0&&"string"==typeof c[0]&&c[0]in Gd}function Uu(c,a){const u=new kf(Gd,[],a?function(_){const v={color:Ks,string:_i,number:Gt,enum:_i,boolean:Cn,formatted:xi,resolvedImage:$n};return"array"===_.type?kr(v[_.value]||ci,_.length):v[_.type]}(a):void 0),p=u.parse(c,void 0,void 0,void 0,a&&"string"===a.type?{typeAnnotation:"coerce"}:void 0);return p?kc(new Ff(p,a)):Ac(u.errors)}class zf{constructor(a,u){this.kind=a,this._styleExpression=u,this.isStateDependent="constant"!==a&&!Vd(u.expression)}evaluateWithoutErrorHandling(a,u,p,_,v,w){return this._styleExpression.evaluateWithoutErrorHandling(a,u,p,_,v,w)}evaluate(a,u,p,_,v,w){return this._styleExpression.evaluate(a,u,p,_,v,w)}}class ju{constructor(a,u,p,_){this.kind=a,this.zoomStops=p,this._styleExpression=u,this.isStateDependent="camera"!==a&&!Vd(u.expression),this.interpolationType=_}evaluateWithoutErrorHandling(a,u,p,_,v,w){return this._styleExpression.evaluateWithoutErrorHandling(a,u,p,_,v,w)}evaluate(a,u,p,_,v,w){return this._styleExpression.evaluate(a,u,p,_,v,w)}interpolationFactor(a,u,p){return this.interpolationType?fn.interpolationFactor(this.interpolationType,a,u,p):0}}function Hu(c,a){if("error"===(c=Uu(c,a)).result)return c;const u=c.value.expression,p=Bd(u);if(!p&&!ml(a))return Ac([new Va("","data expressions not supported")]);const _=Yh(u,["zoom","pitch","distance-from-center"]);if(!_&&!Qs(a))return Ac([new Va("","zoom expressions not supported")]);const v=op(u);return v||_?v instanceof Va?Ac([v]):v instanceof fn&&!gl(a)?Ac([new Va("",'"interpolate" expressions cannot be used with this property')]):kc(v?new ju(p?"camera":"composite",c.value,v.labels,v instanceof fn?v.interpolation:void 0):new zf(p?"constant":"source",c.value)):Ac([new Va("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ip{constructor(a,u){this._parameters=a,this._specification=u,cl(this,zs(this._parameters,this._specification))}static deserialize(a){return new ip(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function op(c){let a=null;if(c instanceof Pr)a=op(c.result);else if(c instanceof Rf){for(const u of c.args)if(a=op(u),a)break}else(c instanceof Pu||c instanceof fn)&&c.input instanceof Vl&&"zoom"===c.input.name&&(a=c);return a instanceof Va||c.eachChild(u=>{const p=op(u);p instanceof Va?a=p:!a&&p?a=new Va("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&p&&a!==p&&(a=new Va("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}class Yt{constructor(a,u,p,_){this.message=(a?`${a}: `:"")+p,_&&(this.identifier=_),null!=u&&u.__line__&&(this.line=u.__line__)}}function va(c){const a=c.key,u=c.value,p=c.valueSpec||{},_=c.objectElementValidators||{},v=c.style,w=c.styleSpec;let E=[];const D=qn(u);if("object"!==D)return[new Yt(a,u,`object expected, ${D} found`)];for(const M in u){const O=M.split(".")[0];let U;_[O]?U=_[O]:p[O]?U=hr:_["*"]?U=_["*"]:p["*"]&&(U=hr),U?E=E.concat(U({key:(a&&`${a}.`)+M,value:u[M],valueSpec:p[O]||p["*"],style:v,styleSpec:w,object:u,objectKey:M},u)):E.push(new Yt(a,u[M],`unknown property "${M}"`))}for(const M in p)_[M]||p[M].required&&void 0===p[M].default&&void 0===u[M]&&E.push(new Yt(a,u,`missing required property "${M}"`));return E}function Cy(c){const a=c.value,u=c.valueSpec,p=c.style,_=c.styleSpec,v=c.key,w=c.arrayElementValidator||hr;if("array"!==qn(a))return[new Yt(v,a,`array expected, ${qn(a)} found`)];if(u.length&&a.length!==u.length)return[new Yt(v,a,`array length ${u.length} expected, length ${a.length} found`)];if(u["min-length"]&&a.length<u["min-length"])return[new Yt(v,a,`array length at least ${u["min-length"]} expected, length ${a.length} found`)];let E={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};_.$version<7&&(E.function=u.function),"object"===qn(u.value)&&(E=u.value);let D=[];for(let M=0;M<a.length;M++)D=D.concat(w({array:a,arrayIndex:M,value:a[M],valueSpec:E,style:p,styleSpec:_,key:`${v}[${M}]`}));return D}function Mg(c){const a=c.key,u=c.value,p=c.valueSpec;let _=qn(u);if("number"===_&&u!=u&&(_="NaN"),"number"!==_)return[new Yt(a,u,`number expected, ${_} found`)];if("minimum"in p){let v=p.minimum;if("array"===qn(p.minimum)&&(v=p.minimum[c.arrayIndex]),u<v)return[new Yt(a,u,`${u} is less than the minimum value ${v}`)]}if("maximum"in p){let v=p.maximum;if("array"===qn(p.maximum)&&(v=p.maximum[c.arrayIndex]),u>v)return[new Yt(a,u,`${u} is greater than the maximum value ${v}`)]}return[]}function rp(c){const a=c.valueSpec,u=Go(c.value.type);let p,_,v,w={};const E="categorical"!==u&&void 0===c.value.property,D=!E,M="array"===qn(c.value.stops)&&"array"===qn(c.value.stops[0])&&"object"===qn(c.value.stops[0][0]),O=va({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(G){if("identity"===u)return[new Yt(G.key,G.value,'identity function may not have a "stops" property')];let K=[];const te=G.value;return K=K.concat(Cy({key:G.key,value:te,valueSpec:G.valueSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:N})),"array"===qn(te)&&0===te.length&&K.push(new Yt(G.key,te,"array must have at least one stop")),K},default:function(G){return hr({key:G.key,value:G.value,valueSpec:a,style:G.style,styleSpec:G.styleSpec})}}});return"identity"===u&&E&&O.push(new Yt(c.key,c.value,'missing required property "property"')),"identity"===u||c.value.stops||O.push(new Yt(c.key,c.value,'missing required property "stops"')),"exponential"===u&&c.valueSpec.expression&&!gl(c.valueSpec)&&O.push(new Yt(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(D&&!ml(c.valueSpec)?O.push(new Yt(c.key,c.value,"property functions not supported")):E&&!Qs(c.valueSpec)&&O.push(new Yt(c.key,c.value,"zoom functions not supported"))),"categorical"!==u&&!M||void 0!==c.value.property||O.push(new Yt(c.key,c.value,'"property" property is required')),O;function N(G){let K=[];const te=G.value,se=G.key;if("array"!==qn(te))return[new Yt(se,te,`array expected, ${qn(te)} found`)];if(2!==te.length)return[new Yt(se,te,`array length 2 expected, length ${te.length} found`)];if(M){if("object"!==qn(te[0]))return[new Yt(se,te,`object expected, ${qn(te[0])} found`)];if(void 0===te[0].zoom)return[new Yt(se,te,"object stop key must have zoom")];if(void 0===te[0].value)return[new Yt(se,te,"object stop key must have value")];const _e=Go(te[0].zoom);if("number"!=typeof _e)return[new Yt(se,te[0].zoom,"stop zoom values must be numbers")];if(v&&v>_e)return[new Yt(se,te[0].zoom,"stop zoom values must appear in ascending order")];_e!==v&&(v=_e,_=void 0,w={}),K=K.concat(va({key:`${se}[0]`,value:te[0],valueSpec:{zoom:{}},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:Mg,value:U}}))}else K=K.concat(U({key:`${se}[0]`,value:te[0],valueSpec:{},style:G.style,styleSpec:G.styleSpec},te));return Vu(Nl(te[1]))?K.concat([new Yt(`${se}[1]`,te[1],"expressions are not allowed in function stops.")]):K.concat(hr({key:`${se}[1]`,value:te[1],valueSpec:a,style:G.style,styleSpec:G.styleSpec}))}function U(G,K){const te=qn(G.value),se=Go(G.value),_e=null!==G.value?G.value:K;if(p){if(te!==p)return[new Yt(G.key,_e,`${te} stop domain type must match previous stop domain type ${p}`)]}else p=te;if("number"!==te&&"string"!==te&&"boolean"!==te&&"number"!=typeof se&&"string"!=typeof se&&"boolean"!=typeof se)return[new Yt(G.key,_e,"stop domain value must be a number, string, or boolean")];if("number"!==te&&"categorical"!==u){let De=`number expected, ${te} found`;return ml(a)&&void 0===u&&(De+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Yt(G.key,_e,De)]}return"categorical"!==u||"number"!==te||"number"==typeof se&&isFinite(se)&&Math.floor(se)===se?"categorical"!==u&&"number"===te&&"number"==typeof se&&"number"==typeof _&&void 0!==_&&se<_?[new Yt(G.key,_e,"stop domain values must appear in ascending order")]:(_=se,"categorical"===u&&se in w?[new Yt(G.key,_e,"stop domain values must be unique")]:(w[se]=!0,[])):[new Yt(G.key,_e,`integer expected, found ${String(se)}`)]}}function qd(c){const a=("property"===c.expressionContext?Hu:Uu)(Nl(c.value),c.valueSpec);if("error"===a.result)return a.value.map(p=>new Yt(`${c.key}${p.key}`,c.value,p.message));const u=a.value.expression||a.value._styleExpression.expression;if("property"===c.expressionContext&&"text-font"===c.propertyKey&&!u.outputDefined())return[new Yt(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===c.expressionContext&&"layout"===c.propertyType&&!Vd(u))return[new Yt(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===c.expressionContext)return Ty(u,c);if(c.expressionContext&&0===c.expressionContext.indexOf("cluster")){if(!Yh(u,["zoom","feature-state"]))return[new Yt(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===c.expressionContext&&!Bd(u))return[new Yt(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ty(c,a){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const _ of a.valueSpec.expression.parameters)u.delete(_);if(0===u.size)return[];const p=[];return c instanceof Vl&&u.has(c.name)?[new Yt(a.key,a.value,`["${c.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(c.eachChild(_=>{p.push(...Ty(_,a))}),p)}function Zd(c){const a=c.key,u=c.value,p=c.valueSpec,_=[];return Array.isArray(p.values)?-1===p.values.indexOf(Go(u))&&_.push(new Yt(a,u,`expected one of [${p.values.join(", ")}], ${JSON.stringify(u)} found`)):-1===Object.keys(p.values).indexOf(Go(u))&&_.push(new Yt(a,u,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(u)} found`)),_}function sp(c){if(!0===c||!1===c)return!0;if(!Array.isArray(c)||0===c.length)return!1;switch(c[0]){case"has":return c.length>=2&&"$id"!==c[1]&&"$type"!==c[1];case"in":return c.length>=3&&("string"!=typeof c[1]||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==c.length||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const a of c.slice(1))if(!sp(a)&&"boolean"!=typeof a)return!1;return!0;default:return!0}}function Nf(c,a="fill"){if(null==c)return{filter:()=>!0,needGeometry:!1,needFeature:!1};sp(c)||(c=up(c));const u=c;let p=!0;try{p=function(M){if(!zo(M))return M;let O=Nl(M);return lp(O),O=ap(O),O}(u)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(u,null,2)}\n        `)}const _=gt[`filter_${a}`],v=Uu(p,_);let w=null;if("error"===v.result)throw new Error(v.value.map(M=>`${M.key}: ${M.message}`).join(", "));w=(M,O,N)=>v.value.evaluate(M,O,{},N);let E=null,D=null;if(p!==u){const M=Uu(u,_);if("error"===M.result)throw new Error(M.value.map(O=>`${O.key}: ${O.message}`).join(", "));E=(O,N,U,G,K)=>M.value.evaluate(O,N,{},U,void 0,void 0,G,K),D=!Bd(M.value.expression)}return{filter:w,dynamicFilter:E||void 0,needGeometry:Bf(p),needFeature:!!D}}function ap(c){if(!Array.isArray(c))return c;const a=function(u){if(cp.has(u[0]))for(let p=1;p<u.length;p++)if(zo(u[p]))return!0;return u}(c);return!0===a?a:a.map(u=>ap(u))}function lp(c){let a=!1;const u=[];if("case"===c[0]){for(let p=1;p<c.length-1;p+=2)a=a||zo(c[p]),u.push(c[p+1]);u.push(c[c.length-1])}else if("match"===c[0]){a=a||zo(c[1]);for(let p=2;p<c.length-1;p+=2)u.push(c[p+1]);u.push(c[c.length-1])}else if("step"===c[0]){a=a||zo(c[1]);for(let p=1;p<c.length-1;p+=2)u.push(c[p+1])}a&&(c.length=0,c.push("any",...u));for(let p=1;p<c.length;p++)lp(c[p])}function zo(c){if(!Array.isArray(c))return!1;if("pitch"===(a=c[0])||"distance-from-center"===a)return!0;var a;for(let u=1;u<c.length;u++)if(zo(c[u]))return!0;return!1}const cp=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ur(c,a){return c<a?-1:c>a?1:0}function Bf(c){if(!Array.isArray(c))return!1;if("within"===c[0])return!0;for(let a=1;a<c.length;a++)if(Bf(c[a]))return!0;return!1}function up(c){if(!c)return!0;const a=c[0];return c.length<=1?"any"!==a:"=="===a?Vf(c[1],c[2],"=="):"!="===a?$u(Vf(c[1],c[2],"==")):"<"===a||">"===a||"<="===a||">="===a?Vf(c[1],c[2],a):"any"===a?(u=c.slice(1),["any"].concat(u.map(up))):"all"===a?["all"].concat(c.slice(1).map(up)):"none"===a?["all"].concat(c.slice(1).map(up).map($u)):"in"===a?Kd(c[1],c.slice(2)):"!in"===a?$u(Kd(c[1],c.slice(2))):"has"===a?Uf(c[1]):"!has"===a?$u(Uf(c[1])):"within"!==a||c;var u}function Vf(c,a,u){switch(c){case"$type":return[`filter-type-${u}`,a];case"$id":return[`filter-id-${u}`,a];default:return[`filter-${u}`,c,a]}}function Kd(c,a){if(0===a.length)return!1;switch(c){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(u=>typeof u!=typeof a[0])?["filter-in-large",c,["literal",a.sort(ur)]]:["filter-in-small",c,["literal",a]]}}function Uf(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function $u(c){return["!",c]}function Xd(c){return sp(Nl(c.value))?qd(cl({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${c.layerType||"fill"}`]})):Ig(c)}function Ig(c){const a=c.value,u=c.key;if("array"!==qn(a))return[new Yt(u,a,`array expected, ${qn(a)} found`)];const p=c.styleSpec;let _,v=[];if(a.length<1)return[new Yt(u,a,"filter array must have at least 1 element")];switch(v=v.concat(Zd({key:`${u}[0]`,value:a[0],valueSpec:p.filter_operator,style:c.style,styleSpec:c.styleSpec})),Go(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&"$type"===Go(a[1])&&v.push(new Yt(u,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":3!==a.length&&v.push(new Yt(u,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(_=qn(a[1]),"string"!==_&&v.push(new Yt(`${u}[1]`,a[1],`string expected, ${_} found`)));for(let w=2;w<a.length;w++)_=qn(a[w]),"$type"===Go(a[1])?v=v.concat(Zd({key:`${u}[${w}]`,value:a[w],valueSpec:p.geometry_type,style:c.style,styleSpec:c.styleSpec})):"string"!==_&&"number"!==_&&"boolean"!==_&&v.push(new Yt(`${u}[${w}]`,a[w],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let w=1;w<a.length;w++)v=v.concat(Ig({key:`${u}[${w}]`,value:a[w],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":_=qn(a[1]),2!==a.length?v.push(new Yt(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):"string"!==_&&v.push(new Yt(`${u}[1]`,a[1],`string expected, ${_} found`));break;case"within":_=qn(a[1]),2!==a.length?v.push(new Yt(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):"object"!==_&&v.push(new Yt(`${u}[1]`,a[1],`object expected, ${_} found`))}return v}function cs(c,a){const u=c.key,p=c.style,_=c.styleSpec,v=c.value,w=c.objectKey,E=_[`${a}_${c.layerType}`];if(!E)return[];const D=w.match(/^(.*)-transition$/);if("paint"===a&&D&&E[D[1]]&&E[D[1]].transition)return hr({key:u,value:v,valueSpec:_.transition,style:p,styleSpec:_});const M=c.valueSpec||E[w];if(!M)return[new Yt(u,v,`unknown property "${w}"`)];let O;if("string"===qn(v)&&ml(M)&&!M.tokens&&(O=/^{([^}]+)}$/.exec(v)))return[new Yt(u,v,`"${w}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(O[1])} }\`.`)];const N=[];return"symbol"===c.layerType&&("text-field"===w&&p&&!p.glyphs&&N.push(new Yt(u,v,'use of "text-field" requires a style "glyphs" property')),"text-font"===w&&Lf(Nl(v))&&"identity"===Go(v.type)&&N.push(new Yt(u,v,'"text-font" does not support identity functions'))),N.concat(hr({key:c.key,value:v,valueSpec:M,style:p,styleSpec:_,expressionContext:"property",propertyType:a,propertyKey:w}))}function jf(c){return cs(c,"paint")}function dp(c){return cs(c,"layout")}function dr(c){let a=[];const u=c.value,p=c.key,_=c.style,v=c.styleSpec;u.type||u.ref||a.push(new Yt(p,u,'either "type" or "ref" is required'));let w=Go(u.type);const E=Go(u.ref);if(u.id){const D=Go(u.id);for(let M=0;M<c.arrayIndex;M++){const O=_.layers[M];Go(O.id)===D&&a.push(new Yt(p,u.id,`duplicate layer id "${u.id}", previously used at line ${O.id.__line__}`))}}if("ref"in u){let D;["type","source","source-layer","filter","layout"].forEach(M=>{M in u&&a.push(new Yt(p,u[M],`"${M}" is prohibited for ref layers`))}),_.layers.forEach(M=>{Go(M.id)===E&&(D=M)}),D?D.ref?a.push(new Yt(p,u.ref,"ref cannot reference another ref layer")):w=Go(D.type):"string"==typeof E&&a.push(new Yt(p,u.ref,`ref layer "${E}" not found`))}else if("background"!==w&&"sky"!==w)if(u.source){const D=_.sources&&_.sources[u.source],M=D&&Go(D.type);D?"vector"===M&&"raster"===w?a.push(new Yt(p,u.source,`layer "${u.id}" requires a raster source`)):"raster"===M&&"raster"!==w?a.push(new Yt(p,u.source,`layer "${u.id}" requires a vector source`)):"vector"!==M||u["source-layer"]?"raster-dem"===M&&"hillshade"!==w?a.push(new Yt(p,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==w||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||"geojson"===M&&D.lineMetrics||a.push(new Yt(p,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Yt(p,u,`layer "${u.id}" must specify a "source-layer"`)):a.push(new Yt(p,u.source,`source "${u.source}" not found`))}else a.push(new Yt(p,u,'missing required property "source"'));return a=a.concat(va({key:p,value:u,valueSpec:v.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>hr({key:`${p}.type`,value:u.type,valueSpec:v.layer.type,style:c.style,styleSpec:c.styleSpec,object:u,objectKey:"type"}),filter:D=>Xd(cl({layerType:w},D)),layout:D=>va({layer:u,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":M=>dp(cl({layerType:w},M))}}),paint:D=>va({layer:u,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":M=>jf(cl({layerType:w},M))}})}})),a}function Gu(c){const a=c.value,u=c.key,p=qn(a);return"string"!==p?[new Yt(u,a,`string expected, ${p} found`)]:[]}const Rc={promoteId:function({key:c,value:a}){if("string"===qn(a))return Gu({key:c,value:a});{const u=[];for(const p in a)u.push(...Gu({key:`${c}.${p}`,value:a[p]}));return u}}};function Fr(c){const a=c.value,u=c.key,p=c.styleSpec,_=c.style;if(!a.type)return[new Yt(u,a,'"type" is required')];const v=Go(a.type);let w;switch(v){case"vector":case"raster":case"raster-dem":return w=va({key:u,value:a,valueSpec:p[`source_${v.replace("-","_")}`],style:c.style,styleSpec:p,objectElementValidators:Rc}),w;case"geojson":if(w=va({key:u,value:a,valueSpec:p.source_geojson,style:_,styleSpec:p,objectElementValidators:Rc}),a.cluster)for(const E in a.clusterProperties){const[D,M]=a.clusterProperties[E],O="string"==typeof D?[D,["accumulated"],["get",E]]:D;w.push(...qd({key:`${u}.${E}.map`,value:M,expressionContext:"cluster-map"})),w.push(...qd({key:`${u}.${E}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return w;case"video":return va({key:u,value:a,valueSpec:p.source_video,style:_,styleSpec:p});case"image":return va({key:u,value:a,valueSpec:p.source_image,style:_,styleSpec:p});case"canvas":return[new Yt(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zd({key:`${u}.type`,value:a.type,valueSpec:{values:kg(p)},style:_,styleSpec:p})}}function kg(c){return c.source.reduce((a,u)=>{const p=c[u];return"enum"===p.type.type&&(a=a.concat(Object.keys(p.type.values))),a},[])}function Hf(c){const a=c.value,u=c.styleSpec,p=u.light,_=c.style;let v=[];const w=qn(a);if(void 0===a)return v;if("object"!==w)return v=v.concat([new Yt("light",a,`object expected, ${w} found`)]),v;for(const E in a){const D=E.match(/^(.*)-transition$/);v=v.concat(D&&p[D[1]]&&p[D[1]].transition?hr({key:E,value:a[E],valueSpec:u.transition,style:_,styleSpec:u}):p[E]?hr({key:E,value:a[E],valueSpec:p[E],style:_,styleSpec:u}):[new Yt(E,a[E],`unknown property "${E}"`)])}return v}function Hl(c){const a=c.value,u=c.key,p=c.style,_=c.styleSpec,v=_.terrain;let w=[];const E=qn(a);if(void 0===a)return w;if("object"!==E)return w=w.concat([new Yt("terrain",a,`object expected, ${E} found`)]),w;for(const D in a){const M=D.match(/^(.*)-transition$/);w=w.concat(M&&v[M[1]]&&v[M[1]].transition?hr({key:D,value:a[D],valueSpec:_.transition,style:p,styleSpec:_}):v[D]?hr({key:D,value:a[D],valueSpec:v[D],style:p,styleSpec:_}):[new Yt(D,a[D],`unknown property "${D}"`)])}if(a.source){const D=p.sources&&p.sources[a.source],M=D&&Go(D.type);D?"raster-dem"!==M&&w.push(new Yt(u,a.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):w.push(new Yt(u,a.source,`source "${a.source}" not found`))}else w.push(new Yt(u,a,'terrain is missing required property "source"'));return w}function Cs(c){const a=c.value,u=c.style,p=c.styleSpec,_=p.fog;let v=[];const w=qn(a);if(void 0===a)return v;if("object"!==w)return v=v.concat([new Yt("fog",a,`object expected, ${w} found`)]),v;for(const E in a){const D=E.match(/^(.*)-transition$/);v=v.concat(D&&_[D[1]]&&_[D[1]].transition?hr({key:E,value:a[E],valueSpec:p.transition,style:u,styleSpec:p}):_[E]?hr({key:E,value:a[E],valueSpec:_[E],style:u,styleSpec:p}):[new Yt(E,a[E],`unknown property "${E}"`)])}return v}const hp={"*":()=>[],array:Cy,boolean:function(c){const a=c.value,u=c.key,p=qn(a);return"boolean"!==p?[new Yt(u,a,`boolean expected, ${p} found`)]:[]},number:Mg,color:function(c){const a=c.key,u=c.value,p=qn(u);return"string"!==p?[new Yt(a,u,`color expected, ${p} found`)]:null===ri(u)?[new Yt(a,u,`color expected, "${u}" found`)]:[]},enum:Zd,filter:Xd,function:rp,layer:dr,object:va,source:Fr,light:Hf,terrain:Hl,fog:Cs,string:Gu,formatted:function(c){return 0===Gu(c).length?[]:qd(c)},resolvedImage:function(c){return 0===Gu(c).length?[]:qd(c)},projection:function(c){const a=c.value,u=c.styleSpec,p=u.projection,_=c.style;let v=[];const w=qn(a);if("object"===w)for(const E in a)v=v.concat(hr({key:E,value:a[E],valueSpec:p[E],style:_,styleSpec:u}));else"string"!==w&&(v=v.concat([new Yt("projection",a,`object or string expected, ${w} found`)]));return v}};function hr(c){const a=c.value,u=c.valueSpec,p=c.styleSpec;return u.expression&&Lf(Go(a))?rp(c):u.expression&&Vu(Nl(a))?qd(c):u.type&&hp[u.type]?hp[u.type](c):va(cl({},c,{valueSpec:u.type?p[u.type]:u}))}function Ey(c){const a=c.value,u=c.key,p=Gu(c);return p.length||(-1===a.indexOf("{fontstack}")&&p.push(new Yt(u,a,'"glyphs" url must include a "{fontstack}" token')),-1===a.indexOf("{range}")&&p.push(new Yt(u,a,'"glyphs" url must include a "{range}" token'))),p}function _l(c,a=gt){return Kn(hr({key:"",value:c,valueSpec:a.$root,styleSpec:a,style:c,objectElementValidators:{glyphs:Ey,"*":()=>[]}}))}const Ag=c=>Kn(jf(c)),pp=c=>Kn(dp(c));function Kn(c){return c.slice().sort((a,u)=>a.line&&u.line?a.line-u.line:0)}function $f(c,a){let u=!1;if(a&&a.length)for(const p of a)c.fire(new ll(new Error(p.message))),u=!0;return u}var Yd=Ga;function Ga(c,a,u){var p=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var _=new Int32Array(this.arrayBuffer);c=_[0],this.d=(a=_[1])+2*(u=_[2]);for(var v=0;v<this.d*this.d;v++){var w=_[3+v],E=_[3+v+1];p.push(w===E?null:_.subarray(w,E))}var D=_[3+p.length+1];this.keys=_.subarray(_[3+p.length],D),this.bboxes=_.subarray(D),this.insert=this._insertReadonly}else{this.d=a+2*u;for(var M=0;M<this.d*this.d;M++)p.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=c,this.padding=u,this.scale=a/c,this.uid=0;var O=u/a*c;this.min=-O,this.max=c+O}Ga.prototype.insert=function(c,a,u,p,_){this._forEachCell(a,u,p,_,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(_)},Ga.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ga.prototype._insertCell=function(c,a,u,p,_,v){this.cells[_].push(v)},Ga.prototype.query=function(c,a,u,p,_){var v=this.min,w=this.max;if(c<=v&&a<=v&&w<=u&&w<=p&&!_)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(c,a,u,p,this._queryCell,E,{},_),E},Ga.prototype._queryCell=function(c,a,u,p,_,v,w,E){var D=this.cells[_];if(null!==D)for(var M=this.keys,O=this.bboxes,N=0;N<D.length;N++){var U=D[N];if(void 0===w[U]){var G=4*U;(E?E(O[G+0],O[G+1],O[G+2],O[G+3]):c<=O[G+2]&&a<=O[G+3]&&u>=O[G+0]&&p>=O[G+1])?(w[U]=!0,v.push(M[U])):w[U]=!1}}},Ga.prototype._forEachCell=function(c,a,u,p,_,v,w,E){for(var D=this._convertToCellCoord(c),M=this._convertToCellCoord(a),O=this._convertToCellCoord(u),N=this._convertToCellCoord(p),U=D;U<=O;U++)for(var G=M;G<=N;G++){var K=this.d*G+U;if((!E||E(this._convertFromCellCoord(U),this._convertFromCellCoord(G),this._convertFromCellCoord(U+1),this._convertFromCellCoord(G+1)))&&_.call(this,c,a,u,p,K,v,w,E))return}},Ga.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},Ga.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},Ga.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,a=3+this.cells.length+1+1,u=0,p=0;p<this.cells.length;p++)u+=this.cells[p].length;var _=new Int32Array(a+u+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var v=a,w=0;w<c.length;w++){var E=c[w];_[3+w]=v,_.set(E,v),v+=E.length}return _[3+c.length]=v,_.set(this.keys,v),_[3+c.length+1]=v+=this.keys.length,_.set(this.bboxes,v),v+=this.bboxes.length,_.buffer};const fp={};function ln(c,a,u={}){Object.defineProperty(c,"_classRegistryKey",{value:a,writeable:!1}),fp[a]={klass:c,omit:u.omit||[]}}ln(Object,"Object"),Yd.serialize=function(c,a){const u=c.toArrayBuffer();return a&&a.push(u),{buffer:u}},Yd.deserialize=function(c){return new Yd(c.buffer)},Object.defineProperty(Yd,"name",{value:"Grid"}),ln(Yd,"Grid"),ln(qo,"Color"),ln(Error,"Error"),ln(Zs,"AJAXError"),ln(bs,"ResolvedImage"),ln(ip,"StylePropertyFunction"),ln(Ff,"StyleExpression",{omit:["_evaluator"]}),ln(ju,"ZoomDependentExpression"),ln(zf,"ZoomConstantExpression"),ln(Vl,"CompoundExpression",{omit:["_evaluate"]});for(const c in Gd)fp[Gd[c]._classRegistryKey]||ln(Gd[c],`Expression${c}`);function Gf(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&"ArrayBuffer"===c.constructor.name)}function Qd(c){return re.ImageBitmap&&c instanceof re.ImageBitmap}function Jd(c,a){if(null==c||"boolean"==typeof c||"number"==typeof c||"string"==typeof c||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Gf(c)||Qd(c))return a&&a.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return a&&a.push(u.buffer),u}if(c instanceof re.ImageData)return a&&a.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const p of c)u.push(Jd(p,a));return u}if("object"==typeof c){const u=c.constructor,p=u._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${p}`);const _=u.serialize?u.serialize(c,a):{};if(!u.serialize){for(const v in c)c.hasOwnProperty(v)&&(fp[p].omit.indexOf(v)>=0||(_[v]=Jd(c[v],a)));c instanceof Error&&(_.message=c.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==p&&(_.$name=p),_}throw new Error("can't serialize object of type "+typeof c)}function Lt(c){if(null==c||"boolean"==typeof c||"number"==typeof c||"string"==typeof c||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Gf(c)||Qd(c)||ArrayBuffer.isView(c)||c instanceof re.ImageData)return c;if(Array.isArray(c))return c.map(Lt);if("object"==typeof c){const a=c.$name||"Object",{klass:u}=fp[a];if(!u)throw new Error(`can't deserialize unregistered class ${a}`);if(u.deserialize)return u.deserialize(c);const p=Object.create(u.prototype);for(const _ of Object.keys(c))"$name"!==_&&(p[_]=Lt(c[_]));return p}throw new Error("can't deserialize object of type "+typeof c)}const Pi=c=>c>=1536&&c<=1791,Ie=c=>c>=1872&&c<=1919,Me=c=>c>=2208&&c<=2303,xr=c=>c>=11904&&c<=12031,mp=c=>c>=12032&&c<=12255,Lc=c=>c>=12272&&c<=12287,Ts=c=>c>=12288&&c<=12351,Wu=c=>c>=12352&&c<=12447,$l=c=>c>=12448&&c<=12543,gp=c=>c>=12544&&c<=12591,Sy=c=>c>=12704&&c<=12735,Wf=c=>c>=12736&&c<=12783,zr=c=>c>=12784&&c<=12799,Wa=c=>c>=12800&&c<=13055,qf=c=>c>=13056&&c<=13311,Fc=c=>c>=13312&&c<=19903,ba=c=>c>=19968&&c<=40959,Pg=c=>c>=40960&&c<=42127,Zf=c=>c>=42128&&c<=42191,Og=c=>c>=44032&&c<=55215,Rg=c=>c>=63744&&c<=64255,qu=c=>c>=64336&&c<=65023,zc=c=>c>=65040&&c<=65055,y=c=>c>=65072&&c<=65103,d=c=>c>=65104&&c<=65135,f=c=>c>=65136&&c<=65279,x=c=>c>=65280&&c<=65519;function C(c){for(const a of c)if(P(a.charCodeAt(0)))return!0;return!1}function S(c){for(const a of c)if(!k(a.charCodeAt(0)))return!1;return!0}function k(c){return!(Pi(c)||Ie(c)||Me(c)||qu(c)||f(c))}function P(c){return!(746!==c&&747!==c&&(c<4352||!(Sy(c)||gp(c)||y(c)&&!(c>=65097&&c<=65103)||Rg(c)||qf(c)||xr(c)||Wf(c)||!(!Ts(c)||c>=12296&&c<=12305||c>=12308&&c<=12319||12336===c)||Fc(c)||ba(c)||Wa(c)||(a=c,a>=12592&&a<=12687)||(a=>a>=43360&&a<=43391)(c)||(a=>a>=55216&&a<=55295)(c)||(a=>a>=4352&&a<=4607)(c)||Og(c)||Wu(c)||Lc(c)||(a=>a>=12688&&a<=12703)(c)||mp(c)||zr(c)||$l(c)&&12540!==c||!(!x(c)||65288===c||65289===c||65293===c||c>=65306&&c<=65310||65339===c||65341===c||65343===c||c>=65371&&c<=65503||65507===c||c>=65512&&c<=65519)||!(!d(c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||(a=>a>=5120&&a<=5759)(c)||(a=>a>=6320&&a<=6399)(c)||zc(c)||(a=>a>=19904&&a<=19967)(c)||Pg(c)||Zf(c))));var a}function L(c){return!(P(c)||(a=c,(u=a)>=128&&u<=255&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||(u=>u>=8192&&u<=8303)(a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||(u=>u>=8448&&u<=8527)(a)||(u=>u>=8528&&u<=8591)(a)||(u=>u>=8960&&u<=9215)(a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||9003===a||a>=9085&&a<=9114||a>=9150&&a<=9165||9167===a||a>=9169&&a<=9179||a>=9186&&a<=9215)||(u=>u>=9216&&u<=9279)(a)&&9251!==a||(u=>u>=9280&&u<=9311)(a)||(u=>u>=9312&&u<=9471)(a)||(u=>u>=9632&&u<=9727)(a)||(u=>u>=9728&&u<=9983)(a)&&!(a>=9754&&a<=9759)||(u=>u>=11008&&u<=11263)(a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Ts(a)||$l(a)||(u=>u>=57344&&u<=63743)(a)||y(a)||d(a)||x(a)||8734===a||8756===a||8757===a||a>=9984&&a<=10087||a>=10102&&a<=10131||65532===a||65533===a));var a,u}function H(c){return c>=1424&&c<=2303||qu(c)||f(c)}function $(c,a){return!(!a&&H(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||(u=c,u>=6016&&u<=6143));var u}function Q(c){for(const a of c)if(H(a.charCodeAt(0)))return!0;return!1}const oe="deferred",ue="loading",ae="loaded";let de=null,he="unavailable",ie=null;const ye=function(c){c&&"string"==typeof c&&c.indexOf("NetworkError")>-1&&(he="error"),de&&de(c)};function ge(){Ce.fire(new oo("pluginStateChange",{pluginStatus:he,pluginURL:ie}))}const Ce=new Ba,Pe=function(){return he},ke=function(){if(he!==oe||!ie)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");he=ue,ge(),ie&&bu({url:ie},c=>{c?ye(c):(he=ae,ge())})},Le={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>he===ae||null!=Le.applyArabicShaping,isLoading:()=>he===ue,setState(c){he=c.pluginStatus,ie=c.pluginURL},isParsed:()=>null!=Le.applyArabicShaping&&null!=Le.processBidirectionalText&&null!=Le.processStyledBidirectionalText,getPluginURL:()=>ie};class $e{constructor(a,u){this.zoom=a,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(a){return function(u,p){for(const _ of u)if(!$(_.charCodeAt(0),p))return!1;return!0}(a,Le.isLoaded())}}class nt{constructor(a,u){this.property=a,this.value=u,this.expression=function(p,_){if(Lf(p))return new ip(p,_);if(Vu(p)){const v=Hu(p,_);if("error"===v.result)throw new Error(v.value.map(w=>`${w.key}: ${w.message}`).join(", "));return v.value}{let v=p;return"string"==typeof p&&"color"===_.type&&(v=qo.parse(p)),{kind:"constant",evaluate:()=>v}}}(void 0===u?a.specification.default:u,a.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(a,u,p){return this.property.possiblyEvaluate(this,a,u,p)}}class ot{constructor(a){this.property=a,this.value=new nt(a,void 0)}transitioned(a,u){return new Ze(this.property,this.value,u,Jn({},a.transition,this.transition),a.now)}untransitioned(){return new Ze(this.property,this.value,null,{},0)}}class zt{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return Vo(this._values[a].value.value)}setValue(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new ot(this._values[a].property)),this._values[a].value=new nt(this._values[a].property,null===u?void 0:Vo(u))}getTransition(a){return Vo(this._values[a].transition)}setTransition(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new ot(this._values[a].property)),this._values[a].transition=Vo(u)||void 0}serialize(){const a={};for(const u of Object.keys(this._values)){const p=this.getValue(u);void 0!==p&&(a[u]=p);const _=this.getTransition(u);void 0!==_&&(a[`${u}-transition`]=_)}return a}transitioned(a,u){const p=new Ct(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].transitioned(a,u._values[_]);return p}untransitioned(){const a=new Ct(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].untransitioned();return a}}class Ze{constructor(a,u,p,_,v){const w=_.delay||0,E=_.duration||0;v=v||0,this.property=a,this.value=u,this.begin=v+w,this.end=this.begin+E,a.specification.transition&&(_.delay||_.duration)&&(this.prior=p)}possiblyEvaluate(a,u,p){const _=a.now||0,v=this.value.possiblyEvaluate(a,u,p),w=this.prior;if(w){if(_>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(_<this.begin)return w.possiblyEvaluate(a,u,p);{const E=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(a,u,p),v,zn(E))}}return v}}class Ct{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,u,p){const _=new it(this._properties);for(const v of Object.keys(this._values))_._values[v]=this._values[v].possiblyEvaluate(a,u,p);return _}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class ut{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return Vo(this._values[a].value)}setValue(a,u){this._values[a]=new nt(this._values[a].property,null===u?void 0:Vo(u))}serialize(){const a={};for(const u of Object.keys(this._values)){const p=this.getValue(u);void 0!==p&&(a[u]=p)}return a}possiblyEvaluate(a,u,p){const _=new it(this._properties);for(const v of Object.keys(this._values))_._values[v]=this._values[v].possiblyEvaluate(a,u,p);return _}}class kt{constructor(a,u,p){this.property=a,this.value=u,this.parameters=p}isConstant(){return"constant"===this.value.kind}constantOr(a){return"constant"===this.value.kind?this.value.value:a}evaluate(a,u,p,_){return this.property.evaluate(this.value,this.parameters,a,u,p,_)}}class it{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class je{constructor(a){this.specification=a}possiblyEvaluate(a,u){return a.expression.evaluate(u)}interpolate(a,u,p){const _=hl[this.specification.type];return _?_(a,u,p):a}}class lt{constructor(a,u){this.specification=a,this.overrides=u}possiblyEvaluate(a,u,p,_){return new kt(this,"constant"===a.expression.kind||"camera"===a.expression.kind?{kind:"constant",value:a.expression.evaluate(u,null,{},p,_)}:a.expression,u)}interpolate(a,u,p){if("constant"!==a.value.kind||"constant"!==u.value.kind)return a;if(void 0===a.value.value||void 0===u.value.value)return new kt(this,{kind:"constant",value:void 0},a.parameters);const _=hl[this.specification.type];return _?new kt(this,{kind:"constant",value:_(a.value.value,u.value.value,p)},a.parameters):a}evaluate(a,u,p,_,v,w){return"constant"===a.kind?a.value:a.evaluate(u,p,_,v,w)}}class Mt{constructor(a){this.specification=a}possiblyEvaluate(a,u,p,_){return!!a.expression.evaluate(u,null,{},p,_)}interpolate(){return!1}}class Pt{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new $e(0,{});for(const p in a){const _=a[p];_.specification.overridable&&this.overridableProperties.push(p);const v=this.defaultPropertyValues[p]=new nt(_,void 0),w=this.defaultTransitionablePropertyValues[p]=new ot(_);this.defaultTransitioningPropertyValues[p]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=v.possiblyEvaluate(u)}}}function hn(c,a){return 256*(c=Bn(Math.floor(c),0,255))+Bn(Math.floor(a),0,255)}ln(lt,"DataDrivenProperty"),ln(je,"DataConstantProperty"),ln(Mt,"ColorRampProperty");const ni={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class cn{constructor(a,u){this._structArray=a,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Zt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,u){return a._trim(),u&&(a.isTransferred=!0,u.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const u=Object.create(this.prototype);return u.arrayBuffer=a.arrayBuffer,u.length=a.length,u.capacity=a.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function bn(c,a=1){let u=0,p=0;return{members:c.map(_=>{const v=ni[_.type].BYTES_PER_ELEMENT,w=u=yi(u,Math.max(a,v)),E=_.components||1;return p=Math.max(p,v),u+=v*E,{name:_.name,type:_.type,components:E,offset:w}}),size:yi(u,Math.max(p,a)),alignment:a}}function yi(c,a){return Math.ceil(c/a)*a}class Tn extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u){const p=this.length;return this.resize(p+1),this.emplace(p,a,u)}emplace(a,u,p){const _=2*a;return this.int16[_+0]=u,this.int16[_+1]=p,a}}Tn.prototype.bytesPerElement=4,ln(Tn,"StructArrayLayout2i4");class $i extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,u,p)}emplace(a,u,p,_){const v=3*a;return this.int16[v+0]=u,this.int16[v+1]=p,this.int16[v+2]=_,a}}$i.prototype.bytesPerElement=6,ln($i,"StructArrayLayout3i6");class Gi extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,p,_)}emplace(a,u,p,_,v){const w=4*a;return this.int16[w+0]=u,this.int16[w+1]=p,this.int16[w+2]=_,this.int16[w+3]=v,a}}Gi.prototype.bytesPerElement=8,ln(Gi,"StructArrayLayout4i8");class so extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v,w,E){const D=this.length;return this.resize(D+1),this.emplace(D,a,u,p,_,v,w,E)}emplace(a,u,p,_,v,w,E,D){const M=6*a,O=12*a,N=3*a;return this.int16[M+0]=u,this.int16[M+1]=p,this.uint8[O+4]=_,this.uint8[O+5]=v,this.uint8[O+6]=w,this.uint8[O+7]=E,this.float32[N+2]=D,a}}so.prototype.bytesPerElement=12,ln(so,"StructArrayLayout2i4ub1f12");class Xi extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,p,_)}emplace(a,u,p,_,v){const w=4*a;return this.float32[w+0]=u,this.float32[w+1]=p,this.float32[w+2]=_,this.float32[w+3]=v,a}}Xi.prototype.bytesPerElement=16,ln(Xi,"StructArrayLayout4f16");class tr extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v){const w=this.length;return this.resize(w+1),this.emplace(w,a,u,p,_,v)}emplace(a,u,p,_,v,w){const E=6*a,D=3*a;return this.uint16[E+0]=u,this.uint16[E+1]=p,this.uint16[E+2]=_,this.uint16[E+3]=v,this.float32[D+2]=w,a}}tr.prototype.bytesPerElement=12,ln(tr,"StructArrayLayout4ui1f12");class us extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,p,_)}emplace(a,u,p,_,v){const w=4*a;return this.uint16[w+0]=u,this.uint16[w+1]=p,this.uint16[w+2]=_,this.uint16[w+3]=v,a}}us.prototype.bytesPerElement=8,ln(us,"StructArrayLayout4ui8");class Js extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v,w){const E=this.length;return this.resize(E+1),this.emplace(E,a,u,p,_,v,w)}emplace(a,u,p,_,v,w,E){const D=6*a;return this.int16[D+0]=u,this.int16[D+1]=p,this.int16[D+2]=_,this.int16[D+3]=v,this.int16[D+4]=w,this.int16[D+5]=E,a}}Js.prototype.bytesPerElement=12,ln(Js,"StructArrayLayout6i12");class yl extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v,w,E,D,M,O,N,U){const G=this.length;return this.resize(G+1),this.emplace(G,a,u,p,_,v,w,E,D,M,O,N,U)}emplace(a,u,p,_,v,w,E,D,M,O,N,U,G){const K=12*a;return this.int16[K+0]=u,this.int16[K+1]=p,this.int16[K+2]=_,this.int16[K+3]=v,this.uint16[K+4]=w,this.uint16[K+5]=E,this.uint16[K+6]=D,this.uint16[K+7]=M,this.int16[K+8]=O,this.int16[K+9]=N,this.int16[K+10]=U,this.int16[K+11]=G,a}}yl.prototype.bytesPerElement=24,ln(yl,"StructArrayLayout4i4ui4i24");class Ni extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v,w){const E=this.length;return this.resize(E+1),this.emplace(E,a,u,p,_,v,w)}emplace(a,u,p,_,v,w,E){const D=10*a,M=5*a;return this.int16[D+0]=u,this.int16[D+1]=p,this.int16[D+2]=_,this.float32[M+2]=v,this.float32[M+3]=w,this.float32[M+4]=E,a}}Ni.prototype.bytesPerElement=20,ln(Ni,"StructArrayLayout3i3f20");class co extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint32[1*a+0]=u,a}}co.prototype.bytesPerElement=4,ln(co,"StructArrayLayout1ul4");class Di extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v,w,E,D,M,O,N,U,G){const K=this.length;return this.resize(K+1),this.emplace(K,a,u,p,_,v,w,E,D,M,O,N,U,G)}emplace(a,u,p,_,v,w,E,D,M,O,N,U,G,K){const te=20*a,se=10*a;return this.int16[te+0]=u,this.int16[te+1]=p,this.int16[te+2]=_,this.int16[te+3]=v,this.int16[te+4]=w,this.float32[se+3]=E,this.float32[se+4]=D,this.float32[se+5]=M,this.float32[se+6]=O,this.int16[te+14]=N,this.uint32[se+8]=U,this.uint16[te+18]=G,this.uint16[te+19]=K,a}}Di.prototype.bytesPerElement=40,ln(Di,"StructArrayLayout5i4f1i1ul2ui40");class Io extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v,w,E){const D=this.length;return this.resize(D+1),this.emplace(D,a,u,p,_,v,w,E)}emplace(a,u,p,_,v,w,E,D){const M=8*a;return this.int16[M+0]=u,this.int16[M+1]=p,this.int16[M+2]=_,this.int16[M+4]=v,this.int16[M+5]=w,this.int16[M+6]=E,this.int16[M+7]=D,a}}Io.prototype.bytesPerElement=16,ln(Io,"StructArrayLayout3i2i2i16");class Nr extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v){const w=this.length;return this.resize(w+1),this.emplace(w,a,u,p,_,v)}emplace(a,u,p,_,v,w){const E=4*a,D=8*a;return this.float32[E+0]=u,this.float32[E+1]=p,this.float32[E+2]=_,this.int16[D+6]=v,this.int16[D+7]=w,a}}Nr.prototype.bytesPerElement=16,ln(Nr,"StructArrayLayout2f1f2i16");class uo extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,p,_)}emplace(a,u,p,_,v){const w=12*a,E=3*a;return this.uint8[w+0]=u,this.uint8[w+1]=p,this.float32[E+1]=_,this.float32[E+2]=v,a}}uo.prototype.bytesPerElement=12,ln(uo,"StructArrayLayout2ub2f12");class wr extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,u,p)}emplace(a,u,p,_){const v=3*a;return this.float32[v+0]=u,this.float32[v+1]=p,this.float32[v+2]=_,a}}wr.prototype.bytesPerElement=12,ln(wr,"StructArrayLayout3f12");class Yr extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,u,p)}emplace(a,u,p,_){const v=3*a;return this.uint16[v+0]=u,this.uint16[v+1]=p,this.uint16[v+2]=_,a}}Yr.prototype.bytesPerElement=6,ln(Yr,"StructArrayLayout3ui6");class vl extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v,w,E,D,M,O,N,U,G,K,te,se,_e,De,pe,we,Ae){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,a,u,p,_,v,w,E,D,M,O,N,U,G,K,te,se,_e,De,pe,we,Ae)}emplace(a,u,p,_,v,w,E,D,M,O,N,U,G,K,te,se,_e,De,pe,we,Ae,Ee){const et=30*a,Qe=15*a,pt=60*a;return this.int16[et+0]=u,this.int16[et+1]=p,this.int16[et+2]=_,this.float32[Qe+2]=v,this.float32[Qe+3]=w,this.uint16[et+8]=E,this.uint16[et+9]=D,this.uint32[Qe+5]=M,this.uint32[Qe+6]=O,this.uint32[Qe+7]=N,this.uint16[et+16]=U,this.uint16[et+17]=G,this.uint16[et+18]=K,this.float32[Qe+10]=te,this.float32[Qe+11]=se,this.uint8[pt+48]=_e,this.uint8[pt+49]=De,this.uint8[pt+50]=pe,this.uint32[Qe+13]=we,this.int16[et+28]=Ae,this.uint8[pt+58]=Ee,a}}vl.prototype.bytesPerElement=60,ln(vl,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Nc extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v,w,E,D,M,O,N,U,G,K,te,se,_e,De,pe,we,Ae,Ee,et,Qe,pt,st,at,yt,vt,It){const At=this.length;return this.resize(At+1),this.emplace(At,a,u,p,_,v,w,E,D,M,O,N,U,G,K,te,se,_e,De,pe,we,Ae,Ee,et,Qe,pt,st,at,yt,vt,It)}emplace(a,u,p,_,v,w,E,D,M,O,N,U,G,K,te,se,_e,De,pe,we,Ae,Ee,et,Qe,pt,st,at,yt,vt,It,At){const ct=38*a,jt=19*a;return this.int16[ct+0]=u,this.int16[ct+1]=p,this.int16[ct+2]=_,this.float32[jt+2]=v,this.float32[jt+3]=w,this.int16[ct+8]=E,this.int16[ct+9]=D,this.int16[ct+10]=M,this.int16[ct+11]=O,this.int16[ct+12]=N,this.int16[ct+13]=U,this.uint16[ct+14]=G,this.uint16[ct+15]=K,this.uint16[ct+16]=te,this.uint16[ct+17]=se,this.uint16[ct+18]=_e,this.uint16[ct+19]=De,this.uint16[ct+20]=pe,this.uint16[ct+21]=we,this.uint16[ct+22]=Ae,this.uint16[ct+23]=Ee,this.uint16[ct+24]=et,this.uint16[ct+25]=Qe,this.uint16[ct+26]=pt,this.uint16[ct+27]=st,this.uint16[ct+28]=at,this.uint32[jt+15]=yt,this.float32[jt+16]=vt,this.float32[jt+17]=It,this.float32[jt+18]=At,a}}Nc.prototype.bytesPerElement=76,ln(Nc,"StructArrayLayout3i2f6i15ui1ul3f76");class Es extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.float32[1*a+0]=u,a}}Es.prototype.bytesPerElement=4,ln(Es,"StructArrayLayout1f4");class Ns extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,v){const w=this.length;return this.resize(w+1),this.emplace(w,a,u,p,_,v)}emplace(a,u,p,_,v,w){const E=5*a;return this.float32[E+0]=u,this.float32[E+1]=p,this.float32[E+2]=_,this.float32[E+3]=v,this.float32[E+4]=w,a}}Ns.prototype.bytesPerElement=20,ln(Ns,"StructArrayLayout5f20");class bl extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,p,_)}emplace(a,u,p,_,v){const w=6*a;return this.uint32[3*a+0]=u,this.uint16[w+2]=p,this.uint16[w+3]=_,this.uint16[w+4]=v,a}}bl.prototype.bytesPerElement=12,ln(bl,"StructArrayLayout1ul3ui12");class xa extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u){const p=this.length;return this.resize(p+1),this.emplace(p,a,u)}emplace(a,u,p){const _=2*a;return this.uint16[_+0]=u,this.uint16[_+1]=p,a}}xa.prototype.bytesPerElement=4,ln(xa,"StructArrayLayout2ui4");class Ss extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint16[1*a+0]=u,a}}Ss.prototype.bytesPerElement=2,ln(Ss,"StructArrayLayout1ui2");class Zu extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u){const p=this.length;return this.resize(p+1),this.emplace(p,a,u)}emplace(a,u,p){const _=2*a;return this.float32[_+0]=u,this.float32[_+1]=p,a}}Zu.prototype.bytesPerElement=8,ln(Zu,"StructArrayLayout2f8");class Dy extends cn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Dy.prototype.size=40;class Lg extends Di{get(a){return new Dy(this,a)}}ln(Lg,"CollisionBoxArray");class eh extends cn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(a){this._structArray.uint8[this._pos1+49]=a}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(a){this._structArray.uint8[this._pos1+50]=a}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(a){this._structArray.uint8[this._pos1+58]=a}}eh.prototype.size=60;class T0 extends vl{get(a){return new eh(this,a)}}ln(T0,"PlacedSymbolArray");class Cr extends cn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(a){this._structArray.uint32[this._pos4+15]=a}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Cr.prototype.size=76;class Fg extends Nc{get(a){return new Cr(this,a)}}ln(Fg,"SymbolInstanceArray");class E0 extends Es{getoffsetX(a){return this.float32[1*a+0]}}ln(E0,"GlyphOffsetArray");class My extends Tn{getx(a){return this.int16[2*a+0]}gety(a){return this.int16[2*a+1]}}ln(My,"SymbolLineVertexArray");class _p extends cn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}_p.prototype.size=12;class th extends bl{get(a){return new _p(this,a)}}ln(th,"FeatureIndexArray");class nh extends xa{geta_centroid_pos0(a){return this.uint16[2*a+0]}geta_centroid_pos1(a){return this.uint16[2*a+1]}}ln(nh,"FillExtrusionCentroidArray");const yp=bn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),S0=bn([{name:"a_dash",components:4,type:"Uint16"}]);var Bc={},vp={get exports(){return Bc},set exports(c){Bc=c}},D0={};({get exports(){return D0},set exports(c){D0=c}}).exports=function(c,a){var u,p,_,v,w,E,D,M;for(p=c.length-(u=3&c.length),_=a,w=3432918353,E=461845907,M=0;M<p;)D=255&c.charCodeAt(M)|(255&c.charCodeAt(++M))<<8|(255&c.charCodeAt(++M))<<16|(255&c.charCodeAt(++M))<<24,++M,_=27492+(65535&(v=5*(65535&(_=(_^=D=(65535&(D=(D=(65535&D)*w+(((D>>>16)*w&65535)<<16)&4294967295)<<15|D>>>17))*E+(((D>>>16)*E&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(D=0,u){case 3:D^=(255&c.charCodeAt(M+2))<<16;case 2:D^=(255&c.charCodeAt(M+1))<<8;case 1:_^=D=(65535&(D=(D=(65535&(D^=255&c.charCodeAt(M)))*w+(((D>>>16)*w&65535)<<16)&4294967295)<<15|D>>>17))*E+(((D>>>16)*E&65535)<<16)&4294967295}return _^=c.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0};var Iy={};({get exports(){return Iy},set exports(c){Iy=c}}).exports=function(c,a){for(var u,p=c.length,_=a^p,v=0;p>=4;)u=1540483477*(65535&(u=255&c.charCodeAt(v)|(255&c.charCodeAt(++v))<<8|(255&c.charCodeAt(++v))<<16|(255&c.charCodeAt(++v))<<24))+((1540483477*(u>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),p-=4,++v;switch(p){case 3:_^=(255&c.charCodeAt(v+2))<<16;case 2:_^=(255&c.charCodeAt(v+1))<<8;case 1:_=1540483477*(65535&(_^=255&c.charCodeAt(v)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};var sn=D0,JM=Iy;vp.exports=sn,Bc.murmur3=sn,Bc.murmur2=JM;class ky{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,u,p,_){this.ids.push(MC(a)),this.positions.push(u,p,_)}getPositions(a){const u=MC(a);let p=0,_=this.ids.length-1;for(;p<_;){const w=p+_>>1;this.ids[w]>=u?_=w:p=w+1}const v=[];for(;this.ids[p]===u;)v.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return v}static serialize(a,u){const p=new Float64Array(a.ids),_=new Uint32Array(a.positions);return M0(p,_,0,p.length-1),u&&u.push(p.buffer,_.buffer),{ids:p,positions:_}}static deserialize(a){const u=new ky;return u.ids=a.ids,u.positions=a.positions,u.indexed=!0,u}}function MC(c){const a=+c;return!isNaN(a)&&Number.MIN_SAFE_INTEGER<=a&&a<=Number.MAX_SAFE_INTEGER?a:Bc(String(c))}function M0(c,a,u,p){for(;u<p;){const _=c[u+p>>1];let v=u-1,w=p+1;for(;;){do{v++}while(c[v]<_);do{w--}while(c[w]>_);if(v>=w)break;Ay(c,v,w),Ay(a,3*v,3*w),Ay(a,3*v+1,3*w+1),Ay(a,3*v+2,3*w+2)}w-u<p-w?(M0(c,a,u,w),u=w+1):(M0(c,a,w+1,p),p=w)}}function Ay(c,a,u){const p=c[a];c[a]=c[u],c[u]=p}ln(ky,"FeaturePositionMap");class Ku{constructor(a){this.gl=a.gl,this.initialized=!1}fetchUniformLocation(a,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(a,u),this.initialized=!0),!!this.location}}class Py extends Ku{constructor(a){super(a),this.current=0}set(a,u,p){this.fetchUniformLocation(a,u)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class bp extends Ku{constructor(a){super(a),this.current=[0,0,0,0]}set(a,u,p){this.fetchUniformLocation(a,u)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class IC extends Ku{constructor(a){super(a),this.current=qo.transparent}set(a,u,p){this.fetchUniformLocation(a,u)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const e2=new Float32Array(16),Br=new Float32Array(9),Oy=new Float32Array(4);function ih(c){return[hn(255*c.r,255*c.g),hn(255*c.b,255*c.a)]}class Kf{constructor(a,u,p){this.value=a,this.uniformNames=u.map(_=>`u_${_}`),this.type=p}setUniform(a,u,p,_,v){u.set(a,v,_.constantOr(this.value))}getBinding(a,u){return"color"===this.type?new IC(a):new Py(a)}}class ds{constructor(a,u){this.uniformNames=u.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(a){this.pixelRatio=a.pixelRatio||1,this.pattern=a.tl.concat(a.br)}setUniform(a,u,p,_,v){const w="u_pattern"===v||"u_dash"===v?this.pattern:"u_pixel_ratio"===v?this.pixelRatio:null;w&&u.set(a,v,w)}getBinding(a,u){return"u_pattern"===u||"u_dash"===u?new bp(a):new Py(a)}}class Bs{constructor(a,u,p,_){this.expression=a,this.type=p,this.maxValue=0,this.paintVertexAttributes=u.map(v=>({name:`a_${v}`,type:"Float32",components:"color"===p?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(a,u,p,_,v,w){const E=this.paintVertexArray.length,D=this.expression.evaluate(new $e(0),u,{},v,_,w);this.paintVertexArray.resize(a),this._setPaintValue(E,a,D)}updatePaintArray(a,u,p,_,v){const w=this.expression.evaluate({zoom:0},p,_,void 0,v);this._setPaintValue(a,u,w)}_setPaintValue(a,u,p){if("color"===this.type){const _=ih(p);for(let v=a;v<u;v++)this.paintVertexArray.emplace(v,_[0],_[1])}else{for(let _=a;_<u;_++)this.paintVertexArray.emplace(_,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qa{constructor(a,u,p,_,v,w){this.expression=a,this.uniformNames=u.map(E=>`u_${E}_t`),this.type=p,this.useIntegerZoom=_,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=u.map(E=>({name:`a_${E}`,type:"Float32",components:"color"===p?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(a,u,p,_,v,w){const E=this.expression.evaluate(new $e(this.zoom),u,{},v,_,w),D=this.expression.evaluate(new $e(this.zoom+1),u,{},v,_,w),M=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(M,a,E,D)}updatePaintArray(a,u,p,_,v){const w=this.expression.evaluate({zoom:this.zoom},p,_,void 0,v),E=this.expression.evaluate({zoom:this.zoom+1},p,_,void 0,v);this._setPaintValue(a,u,w,E)}_setPaintValue(a,u,p,_){if("color"===this.type){const v=ih(p),w=ih(_);for(let E=a;E<u;E++)this.paintVertexArray.emplace(E,v[0],v[1],w[0],w[1])}else{for(let v=a;v<u;v++)this.paintVertexArray.emplace(v,p,_);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(_))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,u,p,_,v){const w=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,E=Bn(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);u.set(a,v,E)}getBinding(a,u){return new Py(a)}}class xl{constructor(a,u,p,_,v){this.expression=a,this.layerId=v,this.paintVertexAttributes=("array"===p?S0:yp).members;for(let w=0;w<u.length;++w);this.paintVertexArray=new _}populatePaintArray(a,u,p){const _=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValues(_,a,u.patterns&&u.patterns[this.layerId],p)}updatePaintArray(a,u,p,_,v,w){this._setPaintValues(a,u,p.patterns&&p.patterns[this.layerId],w)}_setPaintValues(a,u,p,_){if(!_||!p)return;const v=_[p];if(!v)return;const{tl:w,br:E,pixelRatio:D}=v;for(let M=a;M<u;M++)this.paintVertexArray.emplace(M,w[0],w[1],E[0],E[1],D)}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Za{constructor(a,u,p=(()=>!0)){this.binders={},this._buffers=[];const _=[];for(const v in a.paint._values){if(!p(v))continue;const w=a.paint.get(v);if(!(w instanceof kt&&ml(w.property.specification)))continue;const E=kC(v,a.type),D=w.value,M=w.property.specification.type,O=w.property.useIntegerZoom,N="line-dasharray"===v||v.endsWith("pattern"),U="line-dasharray"===v&&"constant"!==a.layout.get("line-cap").value.kind;if("constant"!==D.kind||U)if("source"===D.kind||U||N){const G=zg(v,M,"source");this.binders[v]=N?new xl(D,E,M,G,a.id):new Bs(D,E,M,G),_.push(`/a_${v}`)}else{const G=zg(v,M,"composite");this.binders[v]=new qa(D,E,M,O,u,G),_.push(`/z_${v}`)}else this.binders[v]=N?new ds(D.value,E):new Kf(D.value,E,M),_.push(`/u_${v}`)}this.cacheKey=_.sort().join("")}getMaxValue(a){const u=this.binders[a];return u instanceof Bs||u instanceof qa?u.maxValue:0}populatePaintArrays(a,u,p,_,v,w){for(const E in this.binders){const D=this.binders[E];(D instanceof Bs||D instanceof qa||D instanceof xl)&&D.populatePaintArray(a,u,p,_,v,w)}}setConstantPatternPositions(a){for(const u in this.binders){const p=this.binders[u];p instanceof ds&&p.setConstantPatternPositions(a)}}updatePaintArrays(a,u,p,_,v,w){let E=!1;for(const D in a){const M=u.getPositions(D);for(const O of M){const N=p.feature(O.index);for(const U in this.binders){const G=this.binders[U];if((G instanceof Bs||G instanceof qa||G instanceof xl)&&!0===G.expression.isStateDependent){const K=_.paint.get(U);G.expression=K.value,G.updatePaintArray(O.start,O.end,N,a[D],v,w),E=!0}}}}return E}defines(){const a=[];for(const u in this.binders){const p=this.binders[u];(p instanceof Kf||p instanceof ds)&&a.push(...p.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return a}getBinderAttributes(){const a=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof Bs||p instanceof qa||p instanceof xl)for(let _=0;_<p.paintVertexAttributes.length;_++)a.push(p.paintVertexAttributes[_].name)}return a}getBinderUniforms(){const a=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof Kf||p instanceof ds||p instanceof qa)for(const _ of p.uniformNames)a.push(_)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a){const u=[];for(const p in this.binders){const _=this.binders[p];if(_ instanceof Kf||_ instanceof ds||_ instanceof qa)for(const v of _.uniformNames)u.push({name:v,property:p,binding:_.getBinding(a,v)})}return u}setUniforms(a,u,p,_,v){for(const{name:w,property:E,binding:D}of p)this.binders[E].setUniform(a,D,v,_.get(E),w)}updatePaintBuffers(){this._buffers=[];for(const a in this.binders){const u=this.binders[a];(u instanceof Bs||u instanceof qa||u instanceof xl)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(a){for(const u in this.binders){const p=this.binders[u];(p instanceof Bs||p instanceof qa||p instanceof xl)&&p.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const u=this.binders[a];(u instanceof Bs||u instanceof qa||u instanceof xl)&&u.destroy()}}}class oh{constructor(a,u,p=(()=>!0)){this.programConfigurations={};for(const _ of a)this.programConfigurations[_.id]=new Za(_,u,p);this.needsUpload=!1,this._featureMap=new ky,this._bufferOffset=0}populatePaintArrays(a,u,p,_,v,w,E){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(a,u,_,v,w,E);void 0!==u.id&&this._featureMap.add(u.id,p,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,u,p,_,v){for(const w of p)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(a,this._featureMap,u,w,_,v)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}const t2={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function kC(c,a){return t2[c]||[c.replace(`${a}-`,"").replace(/-/g,"_")]}const n2={"line-pattern":{source:tr,composite:tr},"fill-pattern":{source:tr,composite:tr},"fill-extrusion-pattern":{source:tr,composite:tr},"line-dasharray":{source:us,composite:us}},wa={color:{source:Zu,composite:Xi},number:{source:Es,composite:Zu}};function zg(c,a,u){const p=n2[c];return p&&p[u]||wa[a][u]}ln(Kf,"ConstantBinder"),ln(ds,"PatternConstantBinder"),ln(Bs,"SourceExpressionBinder"),ln(xl,"PatternCompositeBinder"),ln(qa,"CompositeExpressionBinder"),ln(Za,"ProgramConfiguration",{omit:["_buffers"]}),ln(oh,"ProgramConfigurationSet");const Vc="-transition";class Gl extends Ba{constructor(a,u){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==a.type&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,"background"!==a.type&&"sky"!==a.type&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),u.layout&&(this._unevaluatedLayout=new ut(u.layout)),u.paint)){this._transitionablePaint=new zt(u.paint);for(const p in a.paint)this.setPaintProperty(p,a.paint[p],{validate:!1});for(const p in a.layout)this.setLayoutProperty(p,a.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new it(u.paint)}}getLayoutProperty(a){return"visibility"===a?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,u,p={}){null!=u&&this._validate(pp,`layers.${this.id}.layout.${a}`,a,u,p)||("visibility"!==a?this._unevaluatedLayout.setValue(a,u):this.visibility=u)}getPaintProperty(a){return Rs(a,Vc)?this._transitionablePaint.getTransition(a.slice(0,-Vc.length)):this._transitionablePaint.getValue(a)}setPaintProperty(a,u,p={}){if(null!=u&&this._validate(Ag,`layers.${this.id}.paint.${a}`,a,u,p))return!1;if(Rs(a,Vc))return this._transitionablePaint.setTransition(a.slice(0,-Vc.length),u||void 0),!1;{const _=this._transitionablePaint._values[a],v=_.value.isDataDriven(),w=_.value;this._transitionablePaint.setValue(a,u),this._handleSpecialPaintPropertyUpdate(a);const E=this._transitionablePaint._values[a].value,D=E.isDataDriven(),M=Rs(a,"pattern")||"line-dasharray"===a;return D||v||M||this._handleOverridablePaintPropertyUpdate(a,w,E)}}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getProgramConfiguration(a){return null}_handleOverridablePaintPropertyUpdate(a,u,p){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||"none"===this.visibility}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,u)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),Yn(a,(u,p)=>!(void 0===u||"layout"===p&&!Object.keys(u).length||"paint"===p&&!Object.keys(u).length))}_validate(a,u,p,_,v={}){return(!v||!1!==v.validate)&&$f(this,a.call(_l,{key:u,layerType:this.type,objectKey:p,value:_,styleSpec:gt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const u=this.paint.get(a);if(u instanceof kt&&ml(u.property.specification)&&("source"===u.value.kind||"composite"===u.value.kind)&&u.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Nf(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const I0=bn([{name:"a_pos",components:2,type:"Int16"}],4),AC=bn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ko{constructor(a=[]){this.segments=a}prepareSegment(a,u,p,_){let v=this.segments[this.segments.length-1];return a>Ko.MAX_VERTEX_ARRAY_LENGTH&&vo(`Max vertices per segment is ${Ko.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!v||v.vertexLength+a>Ko.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==_)&&(v={vertexOffset:u.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},void 0!==_&&(v.sortKey=_),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const a of this.segments)for(const u in a.vaos)a.vaos[u].destroy()}static simpleSegment(a,u,p,_){return new Ko([{vertexOffset:a,primitiveOffset:u,vertexLength:p,primitiveLength:_,vaos:{},sortKey:0}])}}Ko.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ln(Ko,"SegmentVector");var Un=8192;class Xu{constructor(a,u){a&&(u?this.setSouthWest(a).setNorthEast(u):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof Mi?new Mi(a.lng,a.lat):Mi.convert(a),this}setSouthWest(a){return this._sw=a instanceof Mi?new Mi(a.lng,a.lat):Mi.convert(a),this}extend(a){const u=this._sw,p=this._ne;let _,v;if(a instanceof Mi)_=a,v=a;else{if(!(a instanceof Xu))return Array.isArray(a)?4===a.length||a.every(Array.isArray)?this.extend(Xu.convert(a)):this.extend(Mi.convert(a)):"object"==typeof a&&null!==a&&a.hasOwnProperty("lat")&&a.hasOwnProperty("lon")?this.extend(Mi.convert(a)):this;if(_=a._sw,v=a._ne,!_||!v)return this}return u||p?(u.lng=Math.min(_.lng,u.lng),u.lat=Math.min(_.lat,u.lat),p.lng=Math.max(v.lng,p.lng),p.lat=Math.max(v.lat,p.lat)):(this._sw=new Mi(_.lng,_.lat),this._ne=new Mi(v.lng,v.lat)),this}getCenter(){return new Mi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Mi(this.getWest(),this.getNorth())}getSouthEast(){return new Mi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:u,lat:p}=Mi.convert(a);let _=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(a){return!a||a instanceof Xu?a:new Xu(a)}}var Ng=1e-6,ea=typeof Float32Array<"u"?Float32Array:Array;function Bg(){var c=new ea(9);return ea!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function Xf(c,a,u){var p=a[0],_=a[1],v=a[2],w=a[3],E=a[4],D=a[5],M=a[6],O=a[7],N=a[8],U=u[0],G=u[1],K=u[2],te=u[3],se=u[4],_e=u[5],De=u[6],pe=u[7],we=u[8];return c[0]=U*p+G*w+K*M,c[1]=U*_+G*E+K*O,c[2]=U*v+G*D+K*N,c[3]=te*p+se*w+_e*M,c[4]=te*_+se*E+_e*O,c[5]=te*v+se*D+_e*N,c[6]=De*p+pe*w+we*M,c[7]=De*_+pe*E+we*O,c[8]=De*v+pe*D+we*N,c}function Ca(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Wl(c,a){var u=a[0],p=a[1],_=a[2],v=a[3],w=a[4],E=a[5],D=a[6],M=a[7],O=a[8],N=a[9],U=a[10],G=a[11],K=a[12],te=a[13],se=a[14],_e=a[15],De=u*E-p*w,pe=u*D-_*w,we=u*M-v*w,Ae=p*D-_*E,Ee=p*M-v*E,et=_*M-v*D,Qe=O*te-N*K,pt=O*se-U*K,st=O*_e-G*K,at=N*se-U*te,yt=N*_e-G*te,vt=U*_e-G*se,It=De*vt-pe*yt+we*at+Ae*st-Ee*pt+et*Qe;return It?(c[0]=(E*vt-D*yt+M*at)*(It=1/It),c[1]=(_*yt-p*vt-v*at)*It,c[2]=(te*et-se*Ee+_e*Ae)*It,c[3]=(U*Ee-N*et-G*Ae)*It,c[4]=(D*st-w*vt-M*pt)*It,c[5]=(u*vt-_*st+v*pt)*It,c[6]=(se*we-K*et-_e*pe)*It,c[7]=(O*et-U*we+G*pe)*It,c[8]=(w*yt-E*st+M*Qe)*It,c[9]=(p*st-u*yt-v*Qe)*It,c[10]=(K*Ee-te*we+_e*De)*It,c[11]=(N*we-O*Ee-G*De)*It,c[12]=(E*pt-w*at-D*Qe)*It,c[13]=(u*at-p*pt+_*Qe)*It,c[14]=(te*pe-K*Ae-se*De)*It,c[15]=(O*Ae-N*pe+U*De)*It,c):null}function Yu(c,a,u){var p=a[0],_=a[1],v=a[2],w=a[3],E=a[4],D=a[5],M=a[6],O=a[7],N=a[8],U=a[9],G=a[10],K=a[11],te=a[12],se=a[13],_e=a[14],De=a[15],pe=u[0],we=u[1],Ae=u[2],Ee=u[3];return c[0]=pe*p+we*E+Ae*N+Ee*te,c[1]=pe*_+we*D+Ae*U+Ee*se,c[2]=pe*v+we*M+Ae*G+Ee*_e,c[3]=pe*w+we*O+Ae*K+Ee*De,c[4]=(pe=u[4])*p+(we=u[5])*E+(Ae=u[6])*N+(Ee=u[7])*te,c[5]=pe*_+we*D+Ae*U+Ee*se,c[6]=pe*v+we*M+Ae*G+Ee*_e,c[7]=pe*w+we*O+Ae*K+Ee*De,c[8]=(pe=u[8])*p+(we=u[9])*E+(Ae=u[10])*N+(Ee=u[11])*te,c[9]=pe*_+we*D+Ae*U+Ee*se,c[10]=pe*v+we*M+Ae*G+Ee*_e,c[11]=pe*w+we*O+Ae*K+Ee*De,c[12]=(pe=u[12])*p+(we=u[13])*E+(Ae=u[14])*N+(Ee=u[15])*te,c[13]=pe*_+we*D+Ae*U+Ee*se,c[14]=pe*v+we*M+Ae*G+Ee*_e,c[15]=pe*w+we*O+Ae*K+Ee*De,c}function ql(c,a,u){var p,_,v,w,E,D,M,O,N,U,G,K,te=u[0],se=u[1],_e=u[2];return a===c?(c[12]=a[0]*te+a[4]*se+a[8]*_e+a[12],c[13]=a[1]*te+a[5]*se+a[9]*_e+a[13],c[14]=a[2]*te+a[6]*se+a[10]*_e+a[14],c[15]=a[3]*te+a[7]*se+a[11]*_e+a[15]):(_=a[1],v=a[2],w=a[3],E=a[4],D=a[5],M=a[6],O=a[7],N=a[8],U=a[9],G=a[10],K=a[11],c[0]=p=a[0],c[1]=_,c[2]=v,c[3]=w,c[4]=E,c[5]=D,c[6]=M,c[7]=O,c[8]=N,c[9]=U,c[10]=G,c[11]=K,c[12]=p*te+E*se+N*_e+a[12],c[13]=_*te+D*se+U*_e+a[13],c[14]=v*te+M*se+G*_e+a[14],c[15]=w*te+O*se+K*_e+a[15]),c}function rh(c,a,u){var p=u[0],_=u[1],v=u[2];return c[0]=a[0]*p,c[1]=a[1]*p,c[2]=a[2]*p,c[3]=a[3]*p,c[4]=a[4]*_,c[5]=a[5]*_,c[6]=a[6]*_,c[7]=a[7]*_,c[8]=a[8]*v,c[9]=a[9]*v,c[10]=a[10]*v,c[11]=a[11]*v,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c}function Vg(c,a,u){var p=Math.sin(u),_=Math.cos(u),v=a[4],w=a[5],E=a[6],D=a[7],M=a[8],O=a[9],N=a[10],U=a[11];return a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[4]=v*_+M*p,c[5]=w*_+O*p,c[6]=E*_+N*p,c[7]=D*_+U*p,c[8]=M*_-v*p,c[9]=O*_-w*p,c[10]=N*_-E*p,c[11]=U*_-D*p,c}function Qu(c,a,u){var p=Math.sin(u),_=Math.cos(u),v=a[0],w=a[1],E=a[2],D=a[3],M=a[8],O=a[9],N=a[10],U=a[11];return a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=v*_-M*p,c[1]=w*_-O*p,c[2]=E*_-N*p,c[3]=D*_-U*p,c[8]=v*p+M*_,c[9]=w*p+O*_,c[10]=E*p+N*_,c[11]=D*p+U*_,c}function Yf(c,a){return c[0]=a[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=a[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Ry(c,a,u){var p,_,v,w=u[0],E=u[1],D=u[2],M=Math.hypot(w,E,D);return M<Ng?null:(w*=M=1/M,E*=M,D*=M,p=Math.sin(a),_=Math.cos(a),c[0]=w*w*(v=1-_)+_,c[1]=E*w*v+D*p,c[2]=D*w*v-E*p,c[3]=0,c[4]=w*E*v-D*p,c[5]=E*E*v+_,c[6]=D*E*v+w*p,c[7]=0,c[8]=w*D*v+E*p,c[9]=E*D*v-w*p,c[10]=D*D*v+_,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}Math.hypot||(Math.hypot=function(){for(var c=0,a=arguments.length;a--;)c+=arguments[a]*arguments[a];return Math.sqrt(c)});var PC=Yu;function Ly(){var c=new ea(3);return ea!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function sh(c){var a=new ea(3);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a}function Uc(c){return Math.hypot(c[0],c[1],c[2])}function xp(c,a,u){var p=new ea(3);return p[0]=c,p[1]=a,p[2]=u,p}function Ju(c,a,u){return c[0]=a[0]+u[0],c[1]=a[1]+u[1],c[2]=a[2]+u[2],c}function Ug(c,a,u){return c[0]=a[0]-u[0],c[1]=a[1]-u[1],c[2]=a[2]-u[2],c}function k0(c,a,u){return c[0]=a[0]*u[0],c[1]=a[1]*u[1],c[2]=a[2]*u[2],c}function jg(c,a,u){return c[0]=Math.min(a[0],u[0]),c[1]=Math.min(a[1],u[1]),c[2]=Math.min(a[2],u[2]),c}function Qf(c,a,u){return c[0]=Math.max(a[0],u[0]),c[1]=Math.max(a[1],u[1]),c[2]=Math.max(a[2],u[2]),c}function Ta(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c}function Jf(c,a,u,p){return c[0]=a[0]+u[0]*p,c[1]=a[1]+u[1]*p,c[2]=a[2]+u[2]*p,c}function Vr(c,a){var u=a[0],p=a[1],_=a[2],v=u*u+p*p+_*_;return v>0&&(v=1/Math.sqrt(v)),c[0]=a[0]*v,c[1]=a[1]*v,c[2]=a[2]*v,c}function Ea(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]}function Fy(c,a,u){var p=a[0],_=a[1],v=a[2],w=u[0],E=u[1],D=u[2];return c[0]=_*D-v*E,c[1]=v*w-p*D,c[2]=p*E-_*w,c}function Bo(c,a,u){var p=a[0],_=a[1],v=a[2],w=u[3]*p+u[7]*_+u[11]*v+u[15];return c[0]=(u[0]*p+u[4]*_+u[8]*v+u[12])/(w=w||1),c[1]=(u[1]*p+u[5]*_+u[9]*v+u[13])/w,c[2]=(u[2]*p+u[6]*_+u[10]*v+u[14])/w,c}function OC(c,a,u){var p=u[0],_=u[1],v=u[2],w=a[0],E=a[1],D=a[2],M=_*D-v*E,O=v*w-p*D,N=p*E-_*w,U=_*N-v*O,G=v*M-p*N,K=p*O-_*M,te=2*u[3];return O*=te,N*=te,G*=2,K*=2,c[0]=w+(M*=te)+(U*=2),c[1]=E+O+G,c[2]=D+N+K,c}var wp,Zl=Ug,RC=k0,LC=Uc;function Hg(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c[3]=a[3]*u,c}function FC(c,a){var u=a[0],p=a[1],_=a[2],v=a[3],w=u*u+p*p+_*_+v*v;return w>0&&(w=1/Math.sqrt(w)),c[0]=u*w,c[1]=p*w,c[2]=_*w,c[3]=v*w,c}function Cp(c,a,u){var p=a[0],_=a[1],v=a[2],w=a[3];return c[0]=u[0]*p+u[4]*_+u[8]*v+u[12]*w,c[1]=u[1]*p+u[5]*_+u[9]*v+u[13]*w,c[2]=u[2]*p+u[6]*_+u[10]*v+u[14]*w,c[3]=u[3]*p+u[7]*_+u[11]*v+u[15]*w,c}function $g(){var c=new ea(4);return ea!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function zC(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function NC(c,a,u){u*=.5;var p=a[0],_=a[1],v=a[2],w=a[3],E=Math.sin(u),D=Math.cos(u);return c[0]=p*D+w*E,c[1]=_*D+v*E,c[2]=v*D-_*E,c[3]=w*D-p*E,c}function BC(c,a,u){u*=.5;var p=a[0],_=a[1],v=a[2],w=a[3],E=Math.sin(u),D=Math.cos(u);return c[0]=p*D-v*E,c[1]=_*D+w*E,c[2]=v*D+p*E,c[3]=w*D-_*E,c}Ly(),wp=new ea(4),ea!=Float32Array&&(wp[0]=0,wp[1]=0,wp[2]=0,wp[3]=0);var o2=FC;Ly(),xp(1,0,0),xp(0,1,0),$g(),$g(),Bg();const r2=bn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:A0}=r2,zy=bn([{name:"a_pos_3",components:3,type:"Int16"}]);var ah=bn([{name:"a_pos",type:"Int16",components:2}]);class Gg{constructor(a,u){this.pos=a,this.dir=u}intersectsPlane(a,u,p){const _=Ea(u,this.dir);if(Math.abs(_)<1e-6)return!1;const v=((a[0]-this.pos[0])*u[0]+(a[1]-this.pos[1])*u[1]+(a[2]-this.pos[2])*u[2])/_;return p[0]=this.pos[0]+this.dir[0]*v,p[1]=this.pos[1]+this.dir[1]*v,p[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(a,u,p){if(te=(G=this.pos)[0],se=G[1],_e=G[2],De=(K=a)[0],pe=K[1],we=K[2],Math.abs(te-De)<=Ng*Math.max(1,Math.abs(te),Math.abs(De))&&Math.abs(se-pe)<=Ng*Math.max(1,Math.abs(se),Math.abs(pe))&&Math.abs(_e-we)<=Ng*Math.max(1,Math.abs(_e),Math.abs(we))||0===u)return p[0]=p[1]=p[2]=0,!1;var G,K,te,se,_e,De,pe,we;const[_,v,w]=this.dir,E=this.pos[0]-a[0],D=this.pos[1]-a[1],M=this.pos[2]-a[2],O=_*_+v*v+w*w,N=2*(E*_+D*v+M*w),U=N*N-4*O*(E*E+D*D+M*M-u*u);if(U<0){const G=Math.max(-N/2,0),K=E+_*G,te=D+v*G,se=M+w*G,_e=Math.hypot(K,te,se);return p[0]=K*u/_e,p[1]=te*u/_e,p[2]=se*u/_e,!1}{const G=(-N-Math.sqrt(U))/(2*O);if(G<0){const K=Math.hypot(E,D,M);return p[0]=E*u/K,p[1]=D*u/K,p[2]=M*u/K,!1}return p[0]=E+_*G,p[1]=D+v*G,p[2]=M+w*G,!0}}}class Wg{constructor(a,u,p,_,v){this.TL=a,this.TR=u,this.BR=p,this.BL=_,this.horizon=v}static fromInvProjectionMatrix(a,u,p){const _=[-1,1,1],v=[1,1,1],w=[1,-1,1],E=[-1,-1,1],D=Bo(_,_,a),M=Bo(v,v,a),O=Bo(w,w,a),N=Bo(E,E,a);return new Wg(D,M,O,N,u/p)}}class qg{constructor(a,u){this.points=a,this.planes=u}static fromInvProjectionMatrix(a,u,p,_){const v=Math.pow(2,p),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{const M=Cp([],D,a),O=1/M[3]/u*v;return(N=M)[0]=(U=M)[0]*(G=[O,O,_?1/M[3]:O,O])[0],N[1]=U[1]*G[1],N[2]=U[2]*G[2],N[3]=U[3]*G[3],N;var N,U,G}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{const M=Vr([],Fy([],Zl([],w[D[0]],w[D[1]]),Zl([],w[D[2]],w[D[1]]))),O=-Ea(M,w[D[1]]);return M.concat(O)});return new qg(w,E)}}class wo{static fromPoints(a){const u=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const _ of a)jg(u,u,_),Qf(p,p,_);return new wo(u,p)}static applyTransform(a,u){const p=a.getCorners();for(let _=0;_<p.length;++_)Bo(p[_],p[_],u);return wo.fromPoints(p)}constructor(a,u){this.min=a,this.max=u,this.center=Ta([],Ju([],this.min,this.max),.5)}quadrant(a){const u=[a%2==0,a<2],p=sh(this.min),_=sh(this.max);for(let v=0;v<u.length;v++)p[v]=u[v]?this.min[v]:this.center[v],_[v]=u[v]?this.center[v]:this.max[v];return _[2]=this.max[2],new wo(p,_)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}distanceZ(a){return Math.max(Math.min(this.max[2],a[2]),this.min[2])-a[2]}getCorners(){const a=this.min,u=this.max;return[[a[0],a[1],a[2]],[u[0],a[1],a[2]],[u[0],u[1],a[2]],[a[0],u[1],a[2]],[a[0],a[1],u[2]],[u[0],a[1],u[2]],[u[0],u[1],u[2]],[a[0],u[1],u[2]]]}intersects(a){const u=this.getCorners();let p=!0;for(let _=0;_<a.planes.length;_++){const v=a.planes[_];let w=0;for(let E=0;E<u.length;E++)w+=Ea(v,u[E])+v[3]>=0;if(0===w)return 0;w!==u.length&&(p=!1)}if(p)return 2;for(let _=0;_<3;_++){let v=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let E=0;E<a.points.length;E++){const D=a.points[E][_]-this.min[_];v=Math.min(v,D),w=Math.max(w,D)}if(w<0||v>this.max[_]-this.min[_])return 0}return 1}}const Kl=Un/Math.PI/2,em=[64,32,16],Sa=-Kl,ta=Kl,VC=[new wo([Sa,Sa,Sa],[ta,ta,ta]),new wo([Sa,Sa,Sa],[0,0,ta]),new wo([0,Sa,Sa],[ta,0,ta]),new wo([Sa,0,Sa],[0,ta,ta]),new wo([0,0,Sa],[ta,ta,ta])];function Zg(c){return c*Kl/rm}function P0(c,a,u,p=!0){const _=Ta([],c._camera.position,c.worldSize),v=[a,u,1,1];Cp(v,v,c.pixelMatrixInverse),Hg(v,v,1/v[3]);const w=Vr([],Zl([],v,_)),E=c.globeMatrix,D=[E[12],E[13],E[14]],M=Zl([],D,_),O=Uc(M),N=Vr([],M),U=c.worldSize/(2*Math.PI),G=Ea(N,w),K=Math.asin(U/O);if(K<Math.acos(G)){if(!p)return null;const st=[],at=[];Ta(st,w,O/G),Vr(at,Zl(at,st,M)),Vr(w,Ju(w,M,Ta(w,at,Math.tan(K)*O)))}const te=[];new Gg(_,w).closestPointOnSphere(D,U,te);const se=Vr([],yu(E,0)),_e=Vr([],yu(E,1)),De=Vr([],yu(E,2)),pe=Ea(se,te),we=Ea(_e,te),Ae=Ea(De,te),Ee=Ot(Math.asin(-we/U));let et=Ot(Math.atan2(pe,Ae));et=c.center.lng+function(st,at){const yt=(at-st+180)%360-180;return yt<-180?yt+360:yt}(c.center.lng,et);const Qe=wl(et),pt=Bn(Vs(Ee),0,1);return new Sp(Qe,pt)}class O0{constructor(a,u,p){this.a=Zl([],a,p),this.b=Zl([],u,p),this.center=p;const _=Vr([],this.a),v=Vr([],this.b);this.angle=Math.acos(Ea(_,v))}}function Ny(c,a){if(0===c.angle)return null;let u;return u=0===c.a[a]?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[a]/c.a[a]/Math.sin(c.angle)-1/Math.tan(c.angle)),u<0||u>1?null:function(p,_,v,w){const E=Math.sin(v);return p*(Math.sin((1-w)*v)/E)+_*(Math.sin(w*v)/E)}(c.a[a],c.b[a],c.angle,Bn(u,0,1))+c.center[a]}function Xl(c){if(c.z<=1)return VC[c.z+2*c.y+c.x];const a=ch(Ur(c));return wo.fromPoints(a)}function Tr(c,a,u){return Ta(c,c,1-u),Jf(c,c,a,u)}function Kg(c,a){const u=Ep(a.zoom);if(0===u)return Xl(c);const p=Ur(c),_=ch(p),v=wl(p.getWest())*a.worldSize,w=wl(p.getEast())*a.worldSize,E=Vs(p.getNorth())*a.worldSize,D=Vs(p.getSouth())*a.worldSize,M=[v,E,0],O=[w,E,0],N=[v,D,0],U=[w,D,0],G=Wl([],a.globeMatrix);return Bo(M,M,G),Bo(O,O,G),Bo(N,N,G),Bo(U,U,G),_[0]=Tr(_[0],N,u),_[1]=Tr(_[1],U,u),_[2]=Tr(_[2],O,u),_[3]=Tr(_[3],M,u),wo.fromPoints(_)}function By(c,a,u){for(const p of c)Bo(p,p,a),Ta(p,p,u)}function Ur({x:c,y:a,z:u}){const p=1/(1<<u),_=new Mi(na(c*p),Qr((a+1)*p)),v=new Mi(na((c+1)*p),Qr(a*p));return new Xu(_,v)}function ch(c){const a=bt(c.getNorth()),u=bt(c.getSouth()),p=Math.cos(a),_=Math.cos(u),v=Math.sin(a),w=Math.sin(u),E=c.getWest(),D=c.getEast();return[uh(_,w,E),uh(_,w,D),uh(p,v,D),uh(p,v,E)]}function uh(c,a,u,p=Kl){return u=bt(u),[c*Math.sin(u)*p,-a*p,c*Math.cos(u)*p]}function dh(c,a,u){return uh(Math.cos(bt(c)),Math.sin(bt(c)),a,u)}function tm(c,a,u,p){const _=1<<u.z,v=(c/Un+u.x)/_;return dh(Qr((a/Un+u.y)/_),na(v),p)}function nm({min:c,max:a}){return 16383/Math.max(a[0]-c[0],a[1]-c[1],a[2]-c[2])}const R0=new Float64Array(16);function Tp(c){const a=nm(c),u=Yf(R0,[a,a,a]);return ql(u,u,((p=[])[0]=-(_=c.min)[0],p[1]=-_[1],p[2]=-_[2],p));var p,_}function Uy(c){const a=(p=c.min,(u=R0)[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=p[0],u[13]=p[1],u[14]=p[2],u[15]=1,u);var u,p;const _=1/nm(c);return rh(a,a,[_,_,_])}function jy(c,a,u,p,_){const v=function(D){const M=Un/(2*Math.PI);return D/(2*Math.PI)/M}(u),w=[c,a,-u/(2*Math.PI)],E=Ca(new Float64Array(16));return ql(E,E,w),rh(E,E,[v,v,v]),Vg(E,E,bt(-_)),Qu(E,E,bt(-p)),E}function Ep(c){return vr(5,6,c)}function L0(c,a){const u=dh(a.lat,a.lng);return w=(_=Ug([],function(K){const te=dh(K._center.lat,K._center.lng);let se=Fy([],xp(0,1,0),te);const _e=Ry([],-K.angle,te);se=Bo(se,se,_e),Ry(_e,-K._pitch,se);const De=Vr([],te);return Ta(De,De,Zg(K.cameraToCenterDistance/K.pixelsPerMeter)),Bo(De,De,_e),Ju([],te,De)}(c),u))[0],E=_[1],D=_[2],M=(v=u)[0],O=v[1],N=v[2],G=(U=Math.sqrt(w*w+E*E+D*D)*Math.sqrt(M*M+O*O+N*N))&&Ea(_,v)/U,Math.acos(Math.min(Math.max(G,-1),1));var _,v,w,E,D,M,O,N,U,G}function im(c,a){return L0(c,a)>Math.PI/2*1.01}const Xg=bt(85),UC=Math.cos(Xg),om=Math.sin(Xg),rm=6371008.8,F0=2*Math.PI*rm;class Mi{constructor(a,u){if(isNaN(a)||isNaN(u))throw new Error(`Invalid LngLat object: (${a}, ${u})`);if(this.lng=+a,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Mi(lr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const u=Math.PI/180,p=this.lat*u,_=a.lat*u,v=Math.sin(p)*Math.sin(_)+Math.cos(p)*Math.cos(_)*Math.cos((a.lng-this.lng)*u);return rm*Math.acos(Math.min(v,1))}toBounds(a=0){const u=360*a/40075017,p=u/Math.cos(Math.PI/180*this.lat);return new Xu(new Mi(this.lng-p,this.lat-u),new Mi(this.lng+p,this.lat+u))}toEcef(a){const u=Zg(a);return dh(this.lat,this.lng,Kl+u)}static convert(a){if(a instanceof Mi)return a;if(Array.isArray(a)&&(2===a.length||3===a.length))return new Mi(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"==typeof a&&null!==a)return new Mi(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function sm(c){return F0*Math.cos(c*Math.PI/180)}function wl(c){return(180+c)/360}function Vs(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Da(c,a){return c/sm(a)}function na(c){return 360*c-180}function Qr(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Yg(c,a){return c*sm(Qr(a))}const Jr=85.051129;function z0(c){return 1/Math.cos(c*Math.PI/180)}class Sp{constructor(a,u,p=0){this.x=+a,this.y=+u,this.z=+p}static fromLngLat(a,u=0){const p=Mi.convert(a);return new Sp(wl(p.lng),Vs(p.lat),Da(u,p.lat))}toLngLat(){return new Mi(na(this.x),Qr(this.y))}toAltitude(){return Yg(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/F0*z0(Qr(this.y))}}function Hy(c,a,u,p,_,v,w,E,D){const M=(a+p)/2,O=(u+_)/2,N=new Ue(M,O);E(N),function(U,G,K,te,se,_e){const De=K-se,pe=te-_e;return Math.abs((te-G)*De-(K-U)*pe)/Math.hypot(De,pe)}(N.x,N.y,v.x,v.y,w.x,w.y)>=D?(Hy(c,a,u,M,O,v,N,E,D),Hy(c,M,O,p,_,N,w,E,D)):c.push(w)}function N0(c,a,u){let p=c[0],_=p.x,v=p.y;a(p);const w=[p];for(let E=1;E<c.length;E++){const D=c[E],{x:M,y:O}=D;a(D),Hy(w,_,v,M,O,p,D,a,u),_=M,v=O,p=D}return w}function $y(c,a,u,p){if(p(a,u)){const _=a.add(u)._mult(.5);$y(c,a,_,p),$y(c,_,u,p)}else c.push(u)}function B0(c,a){let u=c[0];const p=[u];for(let _=1;_<c.length;_++){const v=c[_];$y(p,u,v,a),u=v}return p}const am=Math.pow(2,14)-1,Gy=-am-1;function Wy(c,a){const u=Math.round(c.x*a),p=Math.round(c.y*a);return c.x=Bn(u,Gy,am),c.y=Bn(p,Gy,am),(u<c.x||u>c.x+1||p<c.y||p>c.y+1)&&vo("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function jc(c,a,u){const p=c.loadGeometry(),_=c.extent,v=Un/_;if(a&&u&&u.projection.isReprojectedInTileSpace){const w=1<<a.z,{scale:E,x:D,y:M,projection:O}=u,N=U=>{const G=na((a.x+U.x/_)/w),K=Qr((a.y+U.y/_)/w),te=O.project(G,K);U.x=(te.x*E-D)*_,U.y=(te.y*E-M)*_};for(let U=0;U<p.length;U++)if(1!==c.type)p[U]=N0(p[U],N,1);else{const G=[];for(const K of p[U])K.x<0||K.x>=_||K.y<0||K.y>=_||(N(K),G.push(K));p[U]=G}}for(const w of p)for(const E of w)Wy(E,v);return p}function hh(c,a){return{type:c.type,id:c.id,properties:c.properties,geometry:a?jc(c):[]}}function lm(c,a,u,p,_){c.emplaceBack(2*a+(p+1)/2,2*u+(_+1)/2)}function cm(c,a,u){c.emplaceBack(a.x,a.y,a.z,16384*u[0],16384*u[1],16384*u[2])}class Hc{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.projection=a.projection,this.layoutVertexArray=new Tn,this.indexArray=new Yr,this.segments=new Ko,this.programConfigurations=new oh(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,p,_){const v=this.layers[0],w=[];let E=null;"circle"===v.type&&(E=v.layout.get("circle-sort-key"));for(const{feature:M,id:O,index:N,sourceLayerIndex:U}of a){const G=this.layers[0]._featureFilter.needGeometry,K=hh(M,G);if(!this.layers[0]._featureFilter.filter(new $e(this.zoom),K,p))continue;const te=E?E.evaluate(K,{},p):void 0,se={id:O,properties:M.properties,type:M.type,sourceLayerIndex:U,index:N,geometry:G?K.geometry:jc(M,p,_),patterns:{},sortKey:te};w.push(se)}E&&w.sort((M,O)=>M.sortKey-O.sortKey);let D=null;"globe"===_.projection.name&&(this.globeExtVertexArray=new Js,D=_.projection);for(const M of w){const{geometry:O,index:N,sourceLayerIndex:U}=M,G=a[N].feature;this.addFeature(M,O,N,u.availableImages,p,D),u.featureIndex.insert(G,O,N,U,this.index)}}update(a,u,p,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,p,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,I0.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,AC.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(a,u,p,_,v,w){for(const E of u)for(const D of E){const M=D.x,O=D.y;if(M<0||M>=Un||O<0||O>=Un)continue;if(w){const G=w.projectTilePoint(M,O,v),K=w.upVector(v,M,O),te=this.globeExtVertexArray;cm(te,G,K),cm(te,G,K),cm(te,G,K),cm(te,G,K)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),U=N.vertexLength;lm(this.layoutVertexArray,M,O,-1,-1),lm(this.layoutVertexArray,M,O,1,-1),lm(this.layoutVertexArray,M,O,1,1),lm(this.layoutVertexArray,M,O,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+2,U+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,{},_,v)}}function qy(c,a){for(let u=0;u<c.length;u++)if($c(a,c[u]))return!0;for(let u=0;u<a.length;u++)if($c(c,a[u]))return!0;return!!Dp(c,a)}function V0(c,a,u){return!!$c(c,a)||!!Qg(a,c,u)}function U0(c,a){if(1===c.length)return Ky(a,c[0]);for(let u=0;u<a.length;u++){const p=a[u];for(let _=0;_<p.length;_++)if($c(c,p[_]))return!0}for(let u=0;u<c.length;u++)if(Ky(a,c[u]))return!0;for(let u=0;u<a.length;u++)if(Dp(c,a[u]))return!0;return!1}function s2(c,a,u){if(c.length>1){if(Dp(c,a))return!0;for(let p=0;p<a.length;p++)if(Qg(a[p],c,u))return!0}for(let p=0;p<c.length;p++)if(Qg(c[p],a,u))return!0;return!1}function Dp(c,a){if(0===c.length||0===a.length)return!1;for(let u=0;u<c.length-1;u++){const p=c[u],_=c[u+1];for(let v=0;v<a.length-1;v++)if(jC(p,_,a[v],a[v+1]))return!0}return!1}function jC(c,a,u,p){return Ra(c,u,p)!==Ra(a,u,p)&&Ra(c,a,u)!==Ra(c,a,p)}function Qg(c,a,u){const p=u*u;if(1===a.length)return c.distSqr(a[0])<p;for(let _=1;_<a.length;_++)if(Zy(c,a[_-1],a[_])<p)return!0;return!1}function Zy(c,a,u){const p=a.distSqr(u);if(0===p)return c.distSqr(a);const _=((c.x-a.x)*(u.x-a.x)+(c.y-a.y)*(u.y-a.y))/p;return c.distSqr(_<0?a:_>1?u:u.sub(a)._mult(_)._add(a))}function Ky(c,a){let u,p,_,v=!1;for(let w=0;w<c.length;w++){u=c[w];for(let E=0,D=u.length-1;E<u.length;D=E++)p=u[E],_=u[D],p.y>a.y!=_.y>a.y&&a.x<(_.x-p.x)*(a.y-p.y)/(_.y-p.y)+p.x&&(v=!v)}return v}function $c(c,a){let u=!1;for(let p=0,_=c.length-1;p<c.length;_=p++){const v=c[p],w=c[_];v.y>a.y!=w.y>a.y&&a.x<(w.x-v.x)*(a.y-v.y)/(w.y-v.y)+v.x&&(u=!u)}return u}function Xy(c,a,u,p,_){for(const w of c)if(a<=w.x&&u<=w.y&&p>=w.x&&_>=w.y)return!0;const v=[new Ue(a,u),new Ue(a,_),new Ue(p,_),new Ue(p,u)];if(c.length>2)for(const w of v)if($c(c,w))return!0;for(let w=0;w<c.length-1;w++)if(Jg(c[w],c[w+1],v))return!0;return!1}function Jg(c,a,u){const p=u[0],_=u[2];if(c.x<p.x&&a.x<p.x||c.x>_.x&&a.x>_.x||c.y<p.y&&a.y<p.y||c.y>_.y&&a.y>_.y)return!1;const v=Ra(c,a,u[0]);return v!==Ra(c,a,u[1])||v!==Ra(c,a,u[2])||v!==Ra(c,a,u[3])}function Gc(c,a,u){const p=a.paint.get(c).value;return"constant"===p.kind?p.value:u.programConfigurations.get(a.id).getMaxValue(c)}function um(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function e_(c,a,u,p,_){if(!a[0]&&!a[1])return c;const v=Ue.convert(a)._mult(_);"viewport"===u&&v._rotate(-p);const w=[];for(let E=0;E<c.length;E++)w.push(c[E].sub(v));return w}function t_(c,a,u,p){const _=Ue.convert(c)._mult(p);return"viewport"===a&&_._rotate(-u),_}ln(Hc,"CircleBucket",{omit:["layers"]});const Yy=new Pt({"circle-sort-key":new lt(gt.layout_circle["circle-sort-key"])});var dm={paint:new Pt({"circle-radius":new lt(gt.paint_circle["circle-radius"]),"circle-color":new lt(gt.paint_circle["circle-color"]),"circle-blur":new lt(gt.paint_circle["circle-blur"]),"circle-opacity":new lt(gt.paint_circle["circle-opacity"]),"circle-translate":new je(gt.paint_circle["circle-translate"]),"circle-translate-anchor":new je(gt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new je(gt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new je(gt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new lt(gt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new lt(gt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new lt(gt.paint_circle["circle-stroke-opacity"])}),layout:Yy};function j0(c,a,u,p,_,v,w,E,D){if(v&&c.queryGeometry.isAboveHorizon)return!1;v&&(D*=c.pixelToTileUnitsFactor);const M=c.tileID.canonical,O=u.projection.upVectorScale(M,u.center.lat,u.worldSize).metersToTile;for(const N of a)for(const U of N){const G=U.add(E),K=_&&u.elevation?u.elevation.exaggeration()*_.getElevationAt(G.x,G.y,!0):0,te=u.projection.projectTilePoint(G.x,G.y,M);if(K>0){const pe=u.projection.upVector(M,G.x,G.y);te.x+=pe[0]*O*K,te.y+=pe[1]*O*K,te.z+=pe[2]*O*K}const se=v?G:H0(te.x,te.y,te.z,p),_e=v?c.tilespaceRays.map(pe=>$C(pe,K)):c.queryGeometry.screenGeometry,De=Cp([],[te.x,te.y,te.z,1],p);if(!w&&v?D*=De[3]/u.cameraToCenterDistance:w&&!v&&(D*=u.cameraToCenterDistance/De[3]),v){const pe=Qr((U.y/Un+M.y)/(1<<M.z));D/=u.projection.pixelsPerMeter(pe,1)/Da(1,pe)}if(V0(_e,se,D))return!0}return!1}function H0(c,a,u,p){const _=Cp([],[c,a,u,1],p);return new Ue(_[0]/_[3],_[1]/_[3])}const $0=xp(0,0,0),HC=xp(0,0,1);function $C(c,a){const u=Ly();return $0[2]=a,c.intersectsPlane($0,HC,u),new Ue(u[0],u[1])}class Qy extends Hc{}function Jy(c,{width:a,height:u},p,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==a*u*p)throw new RangeError("mismatched image size")}else _=new Uint8Array(a*u*p);return c.width=a,c.height=u,c.data=_,c}function hm(c,a,u){const{width:p,height:_}=a;p===c.width&&_===c.height||(pm(c,a,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,p),height:Math.min(c.height,_)},u),c.width=p,c.height=_,c.data=a.data)}function pm(c,a,u,p,_,v){if(0===_.width||0===_.height)return a;if(_.width>c.width||_.height>c.height||u.x>c.width-_.width||u.y>c.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>a.width||_.height>a.height||p.x>a.width-_.width||p.y>a.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const w=c.data,E=a.data;for(let D=0;D<_.height;D++){const M=((u.y+D)*c.width+u.x)*v,O=((p.y+D)*a.width+p.x)*v;for(let N=0;N<_.width*v;N++)E[O+N]=w[M+N]}return a}ln(Qy,"HeatmapBucket",{omit:["layers"]});class ia{constructor(a,u){Jy(this,a,1,u)}resize(a){hm(this,new ia(a),1)}clone(){return new ia({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,p,_,v){pm(a,u,p,_,v,1)}}class oa{constructor(a,u){Jy(this,a,4,u)}resize(a){hm(this,new oa(a),4)}replace(a,u){u?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new oa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,p,_,v){pm(a,u,p,_,v,4)}}ln(ia,"AlphaImage"),ln(oa,"RGBAImage");var GC={paint:new Pt({"heatmap-radius":new lt(gt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new lt(gt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new je(gt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mt(gt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new je(gt.paint_heatmap["heatmap-opacity"])})};function G0(c){const a={},u=c.resolution||256,p=c.clips?c.clips.length:1,_=c.image||new oa({width:u,height:p}),v=(w,E,D)=>{a[c.evaluationKey]=D;const M=c.expression.evaluate(a);_.data[w+E+0]=Math.floor(255*M.r/M.a),_.data[w+E+1]=Math.floor(255*M.g/M.a),_.data[w+E+2]=Math.floor(255*M.b/M.a),_.data[w+E+3]=Math.floor(255*M.a)};if(c.clips)for(let w=0,E=0;w<p;++w,E+=4*u)for(let D=0,M=0;D<u;D++,M+=4){const O=D/(u-1),{start:N,end:U}=c.clips[w];v(E,M,N*(1-O)+U*O)}else for(let w=0,E=0;w<u;w++,E+=4)v(0,E,w/(u-1));return _}var WC={paint:new Pt({"hillshade-illumination-direction":new je(gt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new je(gt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new je(gt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new je(gt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new je(gt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new je(gt.paint_hillshade["hillshade-accent-color"])})};const ev=bn([{name:"a_pos",components:2,type:"Int16"}],4),{members:qC}=ev;var ph={};function fh(c,a,u){u=u||2;var p,_,v,w,E,D,M,O=a&&a.length,N=O?a[0]*u:c.length,U=n_(c,0,N,u,!0),G=[];if(!U||U.next===U.prev)return G;if(O&&(U=function(te,se,_e,De){var pe,we,Ae,Ee=[];for(pe=0,we=se.length;pe<we;pe++)(Ae=n_(te,se[pe]*De,pe<we-1?se[pe+1]*De:te.length,De,!1))===Ae.next&&(Ae.steiner=!0),Ee.push(Yl(Ae));for(Ee.sort(XC),pe=0;pe<Ee.length;pe++)_e=YC(Ee[pe],_e);return _e}(c,a,U,u)),c.length>80*u){p=v=c[0],_=w=c[1];for(var K=u;K<N;K+=u)(E=c[K])<p&&(p=E),(D=c[K+1])<_&&(_=D),E>v&&(v=E),D>w&&(w=D);M=0!==(M=Math.max(v-p,w-_))?32767/M:0}return Mp(U,G,u,p,_,M,0),G}function n_(c,a,u,p,_){var v,w;if(_===Cl(c,a,u,p)>0)for(v=a;v<u;v+=p)w=K0(v,c[v],c[v+1],w);else for(v=u-p;v>=a;v-=p)w=K0(v,c[v],c[v+1],w);return w&&i_(w,w.next)&&(gm(w),w=w.next),w}function ed(c,a){if(!c)return c;a||(a=c);var u,p=c;do{if(u=!1,p.steiner||!i_(p,p.next)&&0!==Xo(p.prev,p,p.next))p=p.next;else{if(gm(p),(p=a=p.prev)===p.next)break;u=!0}}while(u||p!==a);return a}function Mp(c,a,u,p,_,v,w){if(c){!w&&v&&function(O,N,U,G){var K=O;do{0===K.z&&(K.z=Us(K.x,K.y,N,U,G)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next}while(K!==O);K.prevZ.nextZ=null,K.prevZ=null,function(te){var se,_e,De,pe,we,Ae,Ee,et,Qe=1;do{for(_e=te,te=null,we=null,Ae=0;_e;){for(Ae++,De=_e,Ee=0,se=0;se<Qe&&(Ee++,De=De.nextZ);se++);for(et=Qe;Ee>0||et>0&&De;)0!==Ee&&(0===et||!De||_e.z<=De.z)?(pe=_e,_e=_e.nextZ,Ee--):(pe=De,De=De.nextZ,et--),we?we.nextZ=pe:te=pe,pe.prevZ=we,we=pe;_e=De}we.nextZ=null,Qe*=2}while(Ae>1)}(K)}(c,p,_,v);for(var E,D,M=c;c.prev!==c.next;)if(E=c.prev,D=c.next,v?mh(c,p,_,v):W0(c))a.push(E.i/u|0),a.push(c.i/u|0),a.push(D.i/u|0),gm(c),c=D.next,M=D.next;else if((c=D)===M){w?1===w?Mp(c=ZC(ed(c),a,u),a,u,p,_,v,2):2===w&&KC(c,a,u,p,_,v):Mp(ed(c),a,u,p,_,v,1);break}}}function W0(c){var a=c.prev,u=c,p=c.next;if(Xo(a,u,p)>=0)return!1;for(var _=a.x,v=u.x,w=p.x,E=a.y,D=u.y,M=p.y,O=_<v?_<w?_:w:v<w?v:w,N=E<D?E<M?E:M:D<M?D:M,U=_>v?_>w?_:w:v>w?v:w,G=E>D?E>M?E:M:D>M?D:M,K=p.next;K!==a;){if(K.x>=O&&K.x<=U&&K.y>=N&&K.y<=G&&Ip(_,E,v,D,w,M,K.x,K.y)&&Xo(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function mh(c,a,u,p){var _=c.prev,v=c,w=c.next;if(Xo(_,v,w)>=0)return!1;for(var E=_.x,D=v.x,M=w.x,O=_.y,N=v.y,U=w.y,G=E<D?E<M?E:M:D<M?D:M,K=O<N?O<U?O:U:N<U?N:U,te=E>D?E>M?E:M:D>M?D:M,se=O>N?O>U?O:U:N>U?N:U,_e=Us(G,K,a,u,p),De=Us(te,se,a,u,p),pe=c.prevZ,we=c.nextZ;pe&&pe.z>=_e&&we&&we.z<=De;){if(pe.x>=G&&pe.x<=te&&pe.y>=K&&pe.y<=se&&pe!==_&&pe!==w&&Ip(E,O,D,N,M,U,pe.x,pe.y)&&Xo(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,we.x>=G&&we.x<=te&&we.y>=K&&we.y<=se&&we!==_&&we!==w&&Ip(E,O,D,N,M,U,we.x,we.y)&&Xo(we.prev,we,we.next)>=0))return!1;we=we.nextZ}for(;pe&&pe.z>=_e;){if(pe.x>=G&&pe.x<=te&&pe.y>=K&&pe.y<=se&&pe!==_&&pe!==w&&Ip(E,O,D,N,M,U,pe.x,pe.y)&&Xo(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;we&&we.z<=De;){if(we.x>=G&&we.x<=te&&we.y>=K&&we.y<=se&&we!==_&&we!==w&&Ip(E,O,D,N,M,U,we.x,we.y)&&Xo(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function ZC(c,a,u){var p=c;do{var _=p.prev,v=p.next.next;!i_(_,v)&&q0(_,p,p.next,v)&&mm(_,v)&&mm(v,_)&&(a.push(_.i/u|0),a.push(p.i/u|0),a.push(v.i/u|0),gm(p),gm(p.next),p=c=v),p=p.next}while(p!==c);return ed(p)}function KC(c,a,u,p,_,v){var w=c;do{for(var E=w.next.next;E!==w.prev;){if(w.i!==E.i&&JC(w,E)){var D=Z0(w,E);return w=ed(w,w.next),D=ed(D,D.next),Mp(w,a,u,p,_,v,0),void Mp(D,a,u,p,_,v,0)}E=E.next}w=w.next}while(w!==c)}function XC(c,a){return c.x-a.x}function YC(c,a){var u=function(_,v){var w,E=v,D=_.x,M=_.y,O=-1/0;do{if(M<=E.y&&M>=E.next.y&&E.next.y!==E.y){var N=E.x+(M-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(N<=D&&N>O&&(O=N,w=E.x<E.next.x?E:E.next,N===D))return w}E=E.next}while(E!==v);if(!w)return null;var U,G=w,K=w.x,te=w.y,se=1/0;E=w;do{D>=E.x&&E.x>=K&&D!==E.x&&Ip(M<te?D:O,M,K,te,M<te?O:D,M,E.x,E.y)&&(U=Math.abs(M-E.y)/(D-E.x),mm(E,_)&&(U<se||U===se&&(E.x>w.x||E.x===w.x&&QC(w,E)))&&(w=E,se=U)),E=E.next}while(E!==G);return w}(c,a);if(!u)return a;var p=Z0(u,c);return ed(p,p.next),ed(u,u.next)}function QC(c,a){return Xo(c.prev,c,a.prev)<0&&Xo(a.next,c,c.next)<0}function Us(c,a,u,p,_){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-u)*_|0)|c<<8))|c<<4))|c<<2))|c<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-p)*_|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function Yl(c){var a=c,u=c;do{(a.x<u.x||a.x===u.x&&a.y<u.y)&&(u=a),a=a.next}while(a!==c);return u}function Ip(c,a,u,p,_,v,w,E){return(_-w)*(a-E)>=(c-w)*(v-E)&&(c-w)*(p-E)>=(u-w)*(a-E)&&(u-w)*(v-E)>=(_-w)*(p-E)}function JC(c,a){return c.next.i!==a.i&&c.prev.i!==a.i&&!function(u,p){var _=u;do{if(_.i!==u.i&&_.next.i!==u.i&&_.i!==p.i&&_.next.i!==p.i&&q0(_,_.next,u,p))return!0;_=_.next}while(_!==u);return!1}(c,a)&&(mm(c,a)&&mm(a,c)&&function(u,p){var _=u,v=!1,w=(u.x+p.x)/2,E=(u.y+p.y)/2;do{_.y>E!=_.next.y>E&&_.next.y!==_.y&&w<(_.next.x-_.x)*(E-_.y)/(_.next.y-_.y)+_.x&&(v=!v),_=_.next}while(_!==u);return v}(c,a)&&(Xo(c.prev,c,a.prev)||Xo(c,a.prev,a))||i_(c,a)&&Xo(c.prev,c,c.next)>0&&Xo(a.prev,a,a.next)>0)}function Xo(c,a,u){return(a.y-c.y)*(u.x-a.x)-(a.x-c.x)*(u.y-a.y)}function i_(c,a){return c.x===a.x&&c.y===a.y}function q0(c,a,u,p){var _=fm(Xo(c,a,u)),v=fm(Xo(c,a,p)),w=fm(Xo(u,p,c)),E=fm(Xo(u,p,a));return _!==v&&w!==E||!(0!==_||!o_(c,u,a))||!(0!==v||!o_(c,p,a))||!(0!==w||!o_(u,c,p))||!(0!==E||!o_(u,a,p))}function o_(c,a,u){return a.x<=Math.max(c.x,u.x)&&a.x>=Math.min(c.x,u.x)&&a.y<=Math.max(c.y,u.y)&&a.y>=Math.min(c.y,u.y)}function fm(c){return c>0?1:c<0?-1:0}function mm(c,a){return Xo(c.prev,c,c.next)<0?Xo(c,a,c.next)>=0&&Xo(c,c.prev,a)>=0:Xo(c,a,c.prev)<0||Xo(c,c.next,a)<0}function Z0(c,a){var u=new kp(c.i,c.x,c.y),p=new kp(a.i,a.x,a.y),_=c.next,v=a.prev;return c.next=a,a.prev=c,u.next=_,_.prev=u,p.next=u,u.prev=p,v.next=p,p.prev=v,p}function K0(c,a,u,p){var _=new kp(c,a,u);return p?(_.next=p.next,_.prev=p,p.next.prev=_,p.next=_):(_.prev=_,_.next=_),_}function gm(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function kp(c,a,u){this.i=c,this.x=a,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cl(c,a,u,p){for(var _=0,v=a,w=u-p;v<u;v+=p)_+=(c[w]-c[v])*(c[v+1]+c[w+1]),w=v;return _}function _m(c,a,u,p,_){tv(c,a,u||0,p||c.length-1,_||X0)}function tv(c,a,u,p,_){for(;p>u;){if(p-u>600){var v=p-u+1,w=a-u+1,E=Math.log(v),D=.5*Math.exp(2*E/3),M=.5*Math.sqrt(E*D*(v-D)/v)*(w-v/2<0?-1:1);tv(c,a,Math.max(u,Math.floor(a-w*D/v+M)),Math.min(p,Math.floor(a+(v-w)*D/v+M)),_)}var O=c[a],N=u,U=p;for(Ap(c,u,a),_(c[p],O)>0&&Ap(c,u,p);N<U;){for(Ap(c,N,U),N++,U--;_(c[N],O)<0;)N++;for(;_(c[U],O)>0;)U--}0===_(c[u],O)?Ap(c,u,U):Ap(c,++U,p),U<=a&&(u=U+1),a<=U&&(p=U-1)}}function Ap(c,a,u){var p=c[a];c[a]=c[u],c[u]=p}function X0(c,a){return c<a?-1:c>a?1:0}function Y0(c,a){const u=c.length;if(u<=1)return[c];const p=[];let _,v;for(let w=0;w<u;w++){const E=zi(c[w]);0!==E&&(c[w].area=Math.abs(E),void 0===v&&(v=E<0),v===E<0?(_&&p.push(_),_=[c[w]]):_.push(c[w]))}if(_&&p.push(_),a>1)for(let w=0;w<p.length;w++)p[w].length<=a||(_m(p[w],a,1,p[w].length-1,a2),p[w]=p[w].slice(0,a));return p}function a2(c,a){return a.area-c.area}function Q0(c,a,u){const p=u.patternDependencies;let _=!1;for(const v of a){const w=v.paint.get(`${c}-pattern`);w.isConstant()||(_=!0);const E=w.constantOr(null);E&&(_=!0,p[E]=!0)}return _}function ym(c,a,u,p,_){const v=_.patternDependencies;for(const w of a){const E=w.paint.get(`${c}-pattern`).value;if("constant"!==E.kind){let D=E.evaluate({zoom:p},u,{},_.availableImages);D=D&&D.name?D.name:D,v[D]=!0,u.patterns[w.id]=D}}return u}({get exports(){return ph},set exports(c){ph=c}}).exports=fh,ph.default=fh,fh.deviation=function(c,a,u,p){var _=a&&a.length,v=Math.abs(Cl(c,0,_?a[0]*u:c.length,u));if(_)for(var w=0,E=a.length;w<E;w++)v-=Math.abs(Cl(c,a[w]*u,w<E-1?a[w+1]*u:c.length,u));var D=0;for(w=0;w<p.length;w+=3){var M=p[w]*u,O=p[w+1]*u,N=p[w+2]*u;D+=Math.abs((c[M]-c[N])*(c[O+1]-c[M+1])-(c[M]-c[O])*(c[N+1]-c[M+1]))}return 0===v&&0===D?0:Math.abs((D-v)/v)},fh.flatten=function(c){for(var a=c[0][0].length,u={vertices:[],holes:[],dimensions:a},p=0,_=0;_<c.length;_++){for(var v=0;v<c[_].length;v++)for(var w=0;w<a;w++)u.vertices.push(c[_][v][w]);_>0&&u.holes.push(p+=c[_-1].length)}return u};class Pp{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Tn,this.indexArray=new Yr,this.indexArray2=new xa,this.programConfigurations=new oh(a.layers,a.zoom),this.segments=new Ko,this.segments2=new Ko,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=a.projection}populate(a,u,p,_){this.hasPattern=Q0("fill",this.layers,u);const v=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:E,id:D,index:M,sourceLayerIndex:O}of a){const N=this.layers[0]._featureFilter.needGeometry,U=hh(E,N);if(!this.layers[0]._featureFilter.filter(new $e(this.zoom),U,p))continue;const G=v?v.evaluate(U,{},p,u.availableImages):void 0,K={id:D,properties:E.properties,type:E.type,sourceLayerIndex:O,index:M,geometry:N?U.geometry:jc(E,p,_),patterns:{},sortKey:G};w.push(K)}v&&w.sort((E,D)=>E.sortKey-D.sortKey);for(const E of w){const{geometry:D,index:M,sourceLayerIndex:O}=E;if(this.hasPattern){const N=ym("fill",this.layers,E,this.zoom,u);this.patternFeatures.push(N)}else this.addFeature(E,D,M,p,{},u.availableImages);u.featureIndex.insert(a[M].feature,D,M,O,this.index)}}update(a,u,p,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,p,_)}addFeatures(a,u,p,_,v){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,u,p,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,qC),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,u,p,_,v,w=[]){for(const E of Y0(u,500)){let D=0;for(const K of E)D+=K.length;const M=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),O=M.vertexLength,N=[],U=[];for(const K of E){if(0===K.length)continue;K!==E[0]&&U.push(N.length/2);const te=this.segments2.prepareSegment(K.length,this.layoutVertexArray,this.indexArray2),se=te.vertexLength;this.layoutVertexArray.emplaceBack(K[0].x,K[0].y),this.indexArray2.emplaceBack(se+K.length-1,se),N.push(K[0].x),N.push(K[0].y);for(let _e=1;_e<K.length;_e++)this.layoutVertexArray.emplaceBack(K[_e].x,K[_e].y),this.indexArray2.emplaceBack(se+_e-1,se+_e),N.push(K[_e].x),N.push(K[_e].y);te.vertexLength+=K.length,te.primitiveLength+=K.length}const G=ph(N,U);for(let K=0;K<G.length;K+=3)this.indexArray.emplaceBack(O+G[K],O+G[K+1],O+G[K+2]);M.vertexLength+=D,M.primitiveLength+=G.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,v,w,_)}}ln(Pp,"FillBucket",{omit:["layers","patternFeatures"]});const l2=new Pt({"fill-sort-key":new lt(gt.layout_fill["fill-sort-key"])});var c2={paint:new Pt({"fill-antialias":new je(gt.paint_fill["fill-antialias"]),"fill-opacity":new lt(gt.paint_fill["fill-opacity"]),"fill-color":new lt(gt.paint_fill["fill-color"]),"fill-outline-color":new lt(gt.paint_fill["fill-outline-color"]),"fill-translate":new je(gt.paint_fill["fill-translate"]),"fill-translate-anchor":new je(gt.paint_fill["fill-translate-anchor"]),"fill-pattern":new lt(gt.paint_fill["fill-pattern"])}),layout:l2};const J0=bn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),eT=bn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),tT=bn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:nT}=J0;var r_={},ex=Ue,vm=gh;function gh(c,a,u,p,_){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=p,this._values=_,c.readFields(nv,this,a)}function nv(c,a,u){1==c?a.id=u.readVarint():2==c?function(p,_){for(var v=p.readVarint()+p.pos;p.pos<v;){var w=_._keys[p.readVarint()],E=_._values[p.readVarint()];_.properties[w]=E}}(u,a):3==c?a.type=u.readVarint():4==c&&(a._geometry=u.pos)}function iT(c){for(var a,u,p=0,_=0,v=c.length,w=v-1;_<v;w=_++)p+=((u=c[w]).x-(a=c[_]).x)*(a.y+u.y);return p}gh.types=["Unknown","Point","LineString","Polygon"],gh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var a,u=c.readVarint()+c.pos,p=1,_=0,v=0,w=0,E=[];c.pos<u;){if(_<=0){var D=c.readVarint();p=7&D,_=D>>3}if(_--,1===p||2===p)v+=c.readSVarint(),w+=c.readSVarint(),1===p&&(a&&E.push(a),a=[]),a.push(new ex(v,w));else{if(7!==p)throw new Error("unknown command "+p);a&&a.push(a[0].clone())}}return a&&E.push(a),E},gh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var a=c.readVarint()+c.pos,u=1,p=0,_=0,v=0,w=1/0,E=-1/0,D=1/0,M=-1/0;c.pos<a;){if(p<=0){var O=c.readVarint();u=7&O,p=O>>3}if(p--,1===u||2===u)(_+=c.readSVarint())<w&&(w=_),_>E&&(E=_),(v+=c.readSVarint())<D&&(D=v),v>M&&(M=v);else if(7!==u)throw new Error("unknown command "+u)}return[w,D,E,M]},gh.prototype.toGeoJSON=function(c,a,u){var p,_,v=this.extent*Math.pow(2,u),w=this.extent*c,E=this.extent*a,D=this.loadGeometry(),M=gh.types[this.type];function O(G){for(var K=0;K<G.length;K++){var te=G[K];G[K]=[360*(te.x+w)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+E)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(p=0;p<D.length;p++)N[p]=D[p][0];O(D=N);break;case 2:for(p=0;p<D.length;p++)O(D[p]);break;case 3:for(D=function(G){var K=G.length;if(K<=1)return[G];for(var te,se,_e=[],De=0;De<K;De++){var pe=iT(G[De]);0!==pe&&(void 0===se&&(se=pe<0),se===pe<0?(te&&_e.push(te),te=[G[De]]):te.push(G[De]))}return te&&_e.push(te),_e}(D),p=0;p<D.length;p++)for(_=0;_<D[p].length;_++)O(D[p][_])}1===D.length?D=D[0]:M="Multi"+M;var U={type:"Feature",geometry:{type:M,coordinates:D},properties:this.properties};return"id"in this&&(U.id=this.id),U};var po=vm,_h=tx;function tx(c,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(Co,this,a),this.length=this._features.length}function Co(c,a,u){15===c?a.version=u.readVarint():1===c?a.name=u.readString():5===c?a.extent=u.readVarint():2===c?a._features.push(u.pos):3===c?a._keys.push(u.readString()):4===c&&a._values.push(function(p){for(var _=null,v=p.readVarint()+p.pos;p.pos<v;){var w=p.readVarint()>>3;_=1===w?p.readString():2===w?p.readFloat():3===w?p.readDouble():4===w?p.readVarint64():5===w?p.readVarint():6===w?p.readSVarint():7===w?p.readBoolean():null}return _}(u))}tx.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var a=this._pbf.readVarint()+this._pbf.pos;return new po(this._pbf,a,this.extent,this._keys,this._values)};var nx=_h;function oT(c,a,u){if(3===c){var p=new nx(u,u.readVarint()+u.pos);p.length&&(a[p.name]=p)}}var iv=r_.VectorTile=function(c,a){this.layers=c.readFields(oT,{},a)},s_=r_.VectorTileFeature=vm;function a_(c,a,u,p){const _=[],v=0===p?(w,E,D,M,O,N)=>{w.push(new Ue(N,D+(N-E)/(M-E)*(O-D)))}:(w,E,D,M,O,N)=>{w.push(new Ue(E+(N-D)/(O-D)*(M-E),N))};for(const w of c){const E=[];for(const D of w){if(D.length<=2)continue;const M=[];for(let U=0;U<D.length-1;U++){const G=D[U].x,K=D[U].y,te=D[U+1].x,se=D[U+1].y,_e=0===p?G:K,De=0===p?te:se;_e<a?De>a&&v(M,G,K,te,se,a):_e>u?De<u&&v(M,G,K,te,se,u):M.push(D[U]),De<a&&_e>=a&&v(M,G,K,te,se,a),De>u&&_e<=u&&v(M,G,K,te,se,u)}let O=D[D.length-1];const N=0===p?O.x:O.y;N>=a&&N<=u&&M.push(O),M.length&&(O=M[M.length-1],M[0].x===O.x&&M[0].y===O.y||M.push(M[0]),E.push(M))}E.length&&_.push(E)}return _}r_.VectorTileLayer=_h;const ix=s_.types,u2=Math.pow(2,13);function l_(c,a,u,p,_,v,w,E){c.emplaceBack((a<<1)+w,(u<<1)+v,(Math.floor(p*u2)<<1)+_,Math.round(E))}function Wc(c,a,u){c.emplaceBack(a.x,a.y,a.z,16384*u[0],16384*u[1],16384*u[2])}class bm{constructor(){this.acc=new Ue(0,0),this.polyCount=[]}startRing(a){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ue(a.x,a.y),this.max=new Ue(a.x,a.y))}append(a,u){this.currentPolyCount.edges++,this.acc._add(a);const p=this.min,_=this.max;a.x<p.x?p.x=a.x:a.x>_.x&&(_.x=a.x),a.y<p.y?p.y=a.y:a.y>_.y&&(_.y=a.y),((0===a.x||a.x===Un)&&a.x===u.x)!=((0===a.y||a.y===Un)&&a.y===u.y)&&this.processBorderOverlap(a,u),u.x<0!=a.x<0&&this.addBorderIntersection(0,Si(u.y,a.y,(0-u.x)/(a.x-u.x))),u.x>Un!=a.x>Un&&this.addBorderIntersection(1,Si(u.y,a.y,(Un-u.x)/(a.x-u.x))),u.y<0!=a.y<0&&this.addBorderIntersection(2,Si(u.x,a.x,(0-u.y)/(a.y-u.y))),u.y>Un!=a.y>Un&&this.addBorderIntersection(3,Si(u.x,a.x,(Un-u.y)/(a.y-u.y)))}addBorderIntersection(a,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[a];u<p[0]&&(p[0]=u),u>p[1]&&(p[1]=u)}processBorderOverlap(a,u){if(a.x===u.x){if(a.y===u.y)return;const p=0===a.x?0:1;this.addBorderIntersection(p,u.y),this.addBorderIntersection(p,a.y)}else{const p=0===a.y?2:3;this.addBorderIntersection(p,u.x),this.addBorderIntersection(p,a.x)}}centroid(){const a=this.polyCount.reduce((u,p)=>u+p.edges,0);return 0!==a?this.acc.div(a)._round():new Ue(0,0)}span(){return new Ue(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((a,u)=>a+ +(u[0]!==Number.MAX_VALUE),0)}}class Op{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=a.projection,this.layoutVertexArray=new Gi,this.centroidVertexArray=new nh,this.indexArray=new Yr,this.programConfigurations=new oh(a.layers,a.zoom),this.segments=new Ko,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.enableTerrain=a.enableTerrain}populate(a,u,p,_){this.features=[],this.hasPattern=Q0("fill-extrusion",this.layers,u),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(v){const w=Math.exp(Math.PI*(1-v.y/(1<<v.z)*2));return 80150034*w/(w*w+1)/Un/(1<<v.z)}(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:v,id:w,index:E,sourceLayerIndex:D}of a){const M=this.layers[0]._featureFilter.needGeometry,O=hh(v,M);if(!this.layers[0]._featureFilter.filter(new $e(this.zoom),O,p))continue;const N={id:w,sourceLayerIndex:D,index:E,geometry:M?O.geometry:jc(v,p,_),properties:v.properties,type:v.type,patterns:{}},U=this.layoutVertexArray.length;this.hasPattern?this.features.push(ym("fill-extrusion",this.layers,N,this.zoom,u)):this.addFeature(N,N.geometry,E,p,{},u.availableImages,_),u.featureIndex.insert(v,N.geometry,E,D,this.index,U)}this.sortBorders()}addFeatures(a,u,p,_,v){for(const w of this.features){const{geometry:E}=w;this.addFeature(w,E,w.index,u,p,_,v)}this.sortBorders()}update(a,u,p,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,p,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,nT),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=a.createVertexBuffer(this.layoutVertexExtArray,tT.members,!0))),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,eT.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,u,p,_,v,w,E){const D=[new Ue(0,0),new Ue(Un,Un)],M=E.projection,O="globe"===M.name,N=this.enableTerrain&&!O?new bm:null,U="Polygon"===ix[a.type];O&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Js);const G=Y0(u,500);for(let _e=G.length-1;_e>=0;_e--){const De=G[_e];(0===De.length||(K=De[0]).every(pe=>pe.x<=0)||K.every(pe=>pe.x>=Un)||K.every(pe=>pe.y<=0)||K.every(pe=>pe.y>=Un))&&G.splice(_e,1)}var K;let te;if(O)te=rT(G,D,_);else{te=[];for(const _e of G)te.push({polygon:_e,bounds:D})}const se=U?this.edgeRadius:0;for(const{polygon:_e,bounds:De}of te){let pe=0,we=0;for(const Ee of _e)U&&!Ee[0].equals(Ee[Ee.length-1])&&Ee.push(Ee[0]),we+=U?Ee.length-1:Ee.length;const Ae=this.segments.prepareSegment((U?5:4)*we,this.layoutVertexArray,this.indexArray);if(U){const Ee=[],et=[];pe=Ae.vertexLength;for(const pt of _e){let st,at;pt.length&&pt!==_e[0]&&et.push(Ee.length/2),st=pt[1].sub(pt[0])._perp()._unit();for(let yt=1;yt<pt.length;yt++){const vt=pt[yt],It=pt[yt===pt.length-1?1:yt+1];let{x:At,y:ct}=vt;if(se){at=It.sub(vt)._perp()._unit();const jt=st.add(at)._unit(),Dn=se*Math.min(4,1/(st.x*jt.x+st.y*jt.y));At+=Dn*jt.x,ct+=Dn*jt.y,st=at}l_(this.layoutVertexArray,At,ct,0,0,1,1,0),Ae.vertexLength++,Ee.push(vt.x,vt.y),O&&Wc(this.layoutVertexExtArray,M.projectTilePoint(At,ct,_),M.upVector(_,At,ct))}}const Qe=ph(Ee,et);for(let pt=0;pt<Qe.length;pt+=3)this.indexArray.emplaceBack(pe+Qe[pt],pe+Qe[pt+2],pe+Qe[pt+1]),Ae.primitiveLength++}for(const Ee of _e){N&&Ee.length&&N.startRing(Ee[0]);let et,Qe,pt,st=Ee.length>4&&rv(Ee[Ee.length-2],Ee[0],Ee[1]),at=se?ox(Ee[Ee.length-2],Ee[0],Ee[1],se):0;Qe=Ee[1].sub(Ee[0])._perp()._unit();let yt=!0;for(let vt=1,It=0;vt<Ee.length;vt++){let At=Ee[vt-1],ct=Ee[vt];const jt=Ee[vt===Ee.length-1?1:vt+1];if(N&&U&&N.currentPolyCount.top++,sx(ct,At,De)){se&&(Qe=jt.sub(ct)._perp()._unit(),yt=!yt);continue}N&&N.append(ct,At);const Dn=ct.sub(At)._perp(),qt=Dn.x/(Math.abs(Dn.x)+Math.abs(Dn.y)),un=Dn.y>0?1:0,Wt=At.dist(ct);if(It+Wt>32768&&(It=0),se){pt=jt.sub(ct)._perp()._unit();let ui=rx(At,ct,jt,ov(Qe,pt),se);isNaN(ui)&&(ui=0);const Fn=ct.sub(At)._unit();At=At.add(Fn.mult(at))._round(),ct=ct.add(Fn.mult(-ui))._round(),at=ui,Qe=pt}const Rn=Ae.vertexLength,bi=Ee.length>4&&rv(At,ct,jt);let hi=sv(It,st,yt);if(l_(this.layoutVertexArray,At.x,At.y,qt,un,0,0,hi),l_(this.layoutVertexArray,At.x,At.y,qt,un,0,1,hi),It+=Wt,hi=sv(It,bi,!yt),st=bi,l_(this.layoutVertexArray,ct.x,ct.y,qt,un,0,0,hi),l_(this.layoutVertexArray,ct.x,ct.y,qt,un,0,1,hi),Ae.vertexLength+=4,this.indexArray.emplaceBack(Rn+0,Rn+1,Rn+2),this.indexArray.emplaceBack(Rn+1,Rn+3,Rn+2),Ae.primitiveLength+=2,se){const ui=pe+(1===vt?Ee.length-2:vt-2),Fn=1===vt?pe:ui+1;if(this.indexArray.emplaceBack(Rn+1,ui,Rn+3),this.indexArray.emplaceBack(ui,Fn,Rn+3),Ae.primitiveLength+=2,void 0===et&&(et=Rn),!sx(jt,Ee[vt],De)){const Yi=vt===Ee.length-1?et:Ae.vertexLength;this.indexArray.emplaceBack(Rn+2,Rn+3,Yi),this.indexArray.emplaceBack(Rn+3,Yi+1,Yi),this.indexArray.emplaceBack(Rn+3,Fn,Yi+1),Ae.primitiveLength+=3}yt=!yt}if(O){const ui=this.layoutVertexExtArray,Fn=M.projectTilePoint(At.x,At.y,_),Yi=M.projectTilePoint(ct.x,ct.y,_),Zn=M.upVector(_,At.x,At.y),wi=M.upVector(_,ct.x,ct.y);Wc(ui,Fn,Zn),Wc(ui,Fn,Zn),Wc(ui,Yi,wi),Wc(ui,Yi,wi)}}U&&(pe+=Ee.length-1)}}if(N&&N.polyCount.length>0){if(N.borders){N.vertexArrayOffset=this.centroidVertexArray.length;const _e=N.borders,De=this.featuresOnBorder.push(N)-1;for(let pe=0;pe<4;pe++)_e[pe][0]!==Number.MAX_VALUE&&this.borders[pe].push(De)}this.encodeCentroid(N.borders?void 0:N.centroid(),N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,v,w,_)}sortBorders(){for(let a=0;a<4;a++)this.borders[a].sort((u,p)=>this.featuresOnBorder[u].borders[a][0]-this.featuresOnBorder[p].borders[a][0])}encodeCentroid(a,u,p=!0){let _,v;if(a)if(0!==a.y){const E=u.span()._mult(this.tileToMeter);_=(Math.max(a.x,1)<<3)+Math.min(7,Math.round(E.x/10)),v=(Math.max(a.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else _=Math.ceil(7*(a.x+450)),v=0;else _=0,v=+p;let w=p?this.centroidVertexArray.length:u.vertexArrayOffset;for(const E of u.polyCount){p&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let D=0;D<E.top;D++)this.centroidVertexArray.emplace(w++,_,v);for(let D=0;D<2*E.edges;D++)this.centroidVertexArray.emplace(w++,0,v),this.centroidVertexArray.emplace(w++,_,v)}}}function ov(c,a){const u=c.add(a)._unit();return c.x*u.x+c.y*u.y}function ox(c,a,u,p){const _=a.sub(c)._perp()._unit(),v=u.sub(a)._perp()._unit();return rx(c,a,u,ov(_,v),p)}function rx(c,a,u,p,_){const v=Math.sqrt(1-p*p);return Math.min(c.dist(a)/3,a.dist(u)/3,_*v/p)}function sx(c,a,u){return c.x<u[0].x&&a.x<u[0].x||c.x>u[1].x&&a.x>u[1].x||c.y<u[0].y&&a.y<u[0].y||c.y>u[1].y&&a.y>u[1].y}function rv(c,a,u){if(c.x<0||c.x>=Un||a.x<0||a.x>=Un||u.x<0||u.x>=Un)return!1;const p=u.sub(a),_=p.perp(),v=c.sub(a);return(p.x*v.x+p.y*v.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(v.x*v.x+v.y*v.y))>-.866&&_.x*v.x+_.y*v.y<0}function sv(c,a,u){const p=a?2|c:-3&c;return u?1|p:-2&p}function c_(){const c=Math.PI/32,a=Math.tan(c),u=rm;return u*Math.sqrt(1+2*a*a)-u}function rT(c,a,u){const p=1<<u.z,_=na(u.x/p),v=na((u.x+1)/p),w=Qr(u.y/p),E=Qr((u.y+1)/p);return function(D,M,O,N,U=0,G){const K=[];if(!D.length||!O||!N)return K;const te=(Ee,et)=>{for(const Qe of Ee)K.push({polygon:Qe,bounds:et})},se=Math.ceil(Math.log2(O)),_e=Math.ceil(Math.log2(N)),De=se-_e,pe=[];for(let Ee=0;Ee<Math.abs(De);Ee++)pe.push(De>0?0:1);for(let Ee=0;Ee<Math.min(se,_e);Ee++)pe.push(0),pe.push(1);let we=D;if(we=a_(we,M[0].y-U,M[1].y+U,1),we=a_(we,M[0].x-U,M[1].x+U,0),!we.length)return K;const Ae=[];for(pe.length?Ae.push({polygons:we,bounds:M,depth:0}):te(we,M);Ae.length;){const Ee=Ae.pop(),et=Ee.depth,Qe=pe[et],pt=Ee.bounds[0],st=Ee.bounds[1],at=0===Qe?pt.x:pt.y,yt=0===Qe?st.x:st.y,vt=G?G(Qe,at,yt):.5*(at+yt),It=a_(Ee.polygons,at-U,vt+U,Qe),At=a_(Ee.polygons,vt-U,yt+U,Qe);if(It.length){const ct=[pt,new Ue(0===Qe?vt:st.x,1===Qe?vt:st.y)];pe.length>et+1?Ae.push({polygons:It,bounds:ct,depth:et+1}):te(It,ct)}if(At.length){const ct=[new Ue(0===Qe?vt:pt.x,1===Qe?vt:pt.y),st];pe.length>et+1?Ae.push({polygons:At,bounds:ct,depth:et+1}):te(At,ct)}}return K}(c,a,Math.ceil((v-_)/11.25),Math.ceil((w-E)/11.25),1,(D,M,O)=>{if(0===D)return.5*(M+O);{const N=Qr((u.y+M/Un)/p);return(Vs(.5*(Qr((u.y+O/Un)/p)+N))*p-u.y)*Un}})}ln(Op,"FillExtrusionBucket",{omit:["layers","features"]}),ln(bm,"PartMetadata");const av=new Pt({"fill-extrusion-edge-radius":new je(gt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var sT={paint:new Pt({"fill-extrusion-opacity":new je(gt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new lt(gt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new je(gt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new je(gt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lt(gt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new lt(gt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new lt(gt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new je(gt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new je(gt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new je(gt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:av};function u_(c,a,u){var p=2*Math.PI*6378137/256/Math.pow(2,u);return[c*p-2*Math.PI*6378137/2,a*p-2*Math.PI*6378137/2]}class xm{constructor(a,u,p){this.z=a,this.x=u,this.y=p,this.key=wm(0,a,a,u,p)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,u){const p=(w=this.y,E=this.z,D=u_(256*(v=this.x),256*(w=Math.pow(2,E)-w-1),E),M=u_(256*(v+1),256*(w+1),E),D[0]+","+D[1]+","+M[0]+","+M[1]),_=function(v,w,E){let D,M="";for(let O=v;O>0;O--)D=1<<O-1,M+=(w&D?1:0)+(E&D?2:0);return M}(this.z,this.x,this.y);var v,w,E,D,M;return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===u?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",_).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class lv{constructor(a,u){this.wrap=a,this.canonical=u,this.key=wm(a,u.z,u.z,u.x,u.y)}}class nr{constructor(a,u,p,_,v){this.overscaledZ=a,this.wrap=u,this.canonical=new xm(p,+_,+v),this.key=0===u&&a===p?this.canonical.key:wm(u,a,p,_,v)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){const u=this.canonical.z-a;return a>this.canonical.z?new nr(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new nr(a,this.wrap,a,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(a,u=!0){if(this.overscaledZ===a&&u)return this.key;if(a>this.canonical.z)return wm(this.wrap*+u,a,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-a;return wm(this.wrap*+u,a,a,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;const u=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>u&&a.canonical.y===this.canonical.y>>u}children(a){if(this.overscaledZ>=a)return[new nr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,p=2*this.canonical.x,_=2*this.canonical.y;return[new nr(u,this.wrap,u,p,_),new nr(u,this.wrap,u,p+1,_),new nr(u,this.wrap,u,p,_+1),new nr(u,this.wrap,u,p+1,_+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new nr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new nr(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new lv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function wm(c,a,u,p,_){const v=1<<Math.min(u,22);let w=v*(_%v)+p%v;return c&&u<22&&(w+=v*v*((c<0?-2*c-1:2*c)%(1<<2*(22-u)))),16*(32*w+u)+(a-u)}ln(xm,"CanonicalTileID"),ln(nr,"OverscaledTileID",{omit:["projMatrix"]});class td extends Ue{constructor(a,u,p){super(a,u),this.z=p}}function nd(c,a){return c.x*a.x+c.y*a.y}function ax(c,a){if(1===c.length){let u=0;const p=a[u++];let _;for(;!_||p.equals(_);)if(_=a[u++],!_)return 1/0;for(;u<a.length;u++){const v=a[u],w=c[0],E=_.sub(p),D=v.sub(p),M=w.sub(p),O=nd(E,E),N=nd(E,D),U=nd(D,D),G=nd(M,E),K=nd(M,D),te=O*U-N*N,se=(U*G-N*K)/te,_e=(O*K-N*G)/te,De=p.z*(1-se-_e)+_.z*se+v.z*_e;if(isFinite(De))return De}return 1/0}{let u=1/0;for(const p of a)u=Math.min(u,p.z);return u}}function d_(c,a,u,p,_,v,w,E){const D=w*_.getElevationAt(c,a,!0,!0),M=0!==v[0],O=M?0===v[1]?w*(v[0]/7-450):w*function(N,U,G){const K=Math.floor(U[0]/8),te=Math.floor(U[1]/8),se=10*(U[0]-8*K),_e=10*(U[1]-8*te),De=N.getElevationAt(K,te,!0,!0),pe=N.getMeterToDEM(G),we=Math.floor(.5*(se*pe-1)),Ae=Math.floor(.5*(_e*pe-1)),Ee=N.tileCoordToPixel(K,te),et=2*we+1,Qe=2*Ae+1,pt=(Dn=et,qt=Qe,[(At=N).getElevationAtPixel(ct=Ee.x-we,jt=Ee.y-Ae,!0),At.getElevationAtPixel(ct+qt,jt,!0),At.getElevationAtPixel(ct,jt+qt,!0),At.getElevationAtPixel(ct+Dn,jt+qt,!0)]),st=Math.abs(pt[0]-pt[1]),at=Math.abs(pt[2]-pt[3]),yt=Math.abs(pt[0]-pt[2])+Math.abs(pt[1]-pt[3]),vt=Math.min(.25,.5*pe*(st+at)/et),It=Math.min(.25,.5*pe*yt/Qe);var At,ct,jt,Dn,qt;return De+Math.max(vt*se,It*_e)}(_,v,E):D;return{base:D+(0===u)?-1:u,top:M?Math.max(O+p,D+u+2):D+p}}const h_=bn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Ql}=h_,lx=bn([{name:"a_packed",components:4,type:"Float32"}]),{members:cv}=lx,aT=s_.types,lT=Math.cos(Math.PI/180*37.5);class Cm{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.projection=a.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new so,this.layoutVertexArray2=new Xi,this.indexArray=new Yr,this.programConfigurations=new oh(a.layers,a.zoom),this.segments=new Ko,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,p,_){this.hasPattern=Q0("line",this.layers,u);const v=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:O,id:N,index:U,sourceLayerIndex:G}of a){const K=this.layers[0]._featureFilter.needGeometry,te=hh(O,K);if(!this.layers[0]._featureFilter.filter(new $e(this.zoom),te,p))continue;const se=v?v.evaluate(te,{},p):void 0,_e={id:N,properties:O.properties,type:O.type,sourceLayerIndex:G,index:U,geometry:K?te.geometry:jc(O,p,_),patterns:{},sortKey:se};w.push(_e)}v&&w.sort((O,N)=>O.sortKey-N.sortKey);const{lineAtlas:E,featureIndex:D}=u,M=this.addConstantDashes(E);for(const O of w){const{geometry:N,index:U,sourceLayerIndex:G}=O;if(M&&this.addFeatureDashes(O,E),this.hasPattern){const K=ym("line",this.layers,O,this.zoom,u);this.patternFeatures.push(K)}else this.addFeature(O,N,U,p,E.positions,u.availableImages);D.insert(a[U].feature,N,U,G,this.index)}}addConstantDashes(a){let u=!1;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,v=p.layout.get("line-cap").value;if("constant"!==_.kind||"constant"!==v.kind)u=!0;else{const w=v.value,E=_.value;if(!E)continue;a.addDash(E,w)}}return u}addFeatureDashes(a,u){const p=this.zoom;for(const _ of this.layers){const v=_.paint.get("line-dasharray").value,w=_.layout.get("line-cap").value;if("constant"===v.kind&&"constant"===w.kind)continue;let E,D;if("constant"===v.kind){if(E=v.value,!E)continue}else E=v.evaluate({zoom:p},a);D="constant"===w.kind?w.value:w.evaluate({zoom:p},a),u.addDash(E,D),a.patterns[_.id]=u.getKey(E,D)}}update(a,u,p,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,p,_)}addFeatures(a,u,p,_,v){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,u,p,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,cv)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ql),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,u,p,_,v,w){const E=this.layers[0].layout,D=E.get("line-join").evaluate(a,{}),M=E.get("line-cap").evaluate(a,{}),O=E.get("line-miter-limit"),N=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const U of u)this.addLine(U,a,D,M,O,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,v,w,_)}addLine(a,u,p,_,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<a.length-1;_e++)this.totalDistance+=a[_e].dist(a[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E="Polygon"===aT[u.type];let D=a.length;for(;D>=2&&a[D-1].equals(a[D-2]);)D--;let M=0;for(;M<D-1&&a[M].equals(a[M+1]);)M++;if(D<(E?3:2))return;"bevel"===p&&(v=1.05);const O=this.overscaling<=16?122880/(512*this.overscaling):0,N=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let U,G,K,te,se;this.e1=this.e2=-1,E&&(U=a[D-2],se=a[M].sub(U)._unit()._perp());for(let _e=M;_e<D;_e++){if(K=_e===D-1?E?a[M+1]:void 0:a[_e+1],K&&a[_e].equals(K))continue;se&&(te=se),U&&(G=U),U=a[_e],se=K?K.sub(U)._unit()._perp():te,te=te||se;let De=te.add(se);0===De.x&&0===De.y||De._unit();const pe=te.x*se.x+te.y*se.y,we=De.x*se.x+De.y*se.y,Ae=0!==we?1/we:1/0,Ee=2*Math.sqrt(2-2*we),et=we<lT&&G&&K,Qe=te.x*se.y-te.y*se.x>0;if(et&&_e>M){const at=U.dist(G);if(at>2*O){const yt=U.sub(U.sub(G)._mult(O/at)._round());this.updateDistance(G,yt),this.addCurrentVertex(yt,te,0,0,N),G=yt}}const pt=G&&K;let st=pt?p:E?"butt":_;if(pt&&"round"===st&&(Ae<w?st="miter":Ae<=2&&(st="fakeround")),"miter"===st&&Ae>v&&(st="bevel"),"bevel"===st&&(Ae>2&&(st="flipbevel"),Ae<v&&(st="miter")),G&&this.updateDistance(G,U),"miter"===st)De._mult(Ae),this.addCurrentVertex(U,De,0,0,N);else if("flipbevel"===st){if(Ae>100)De=se.mult(-1);else{const at=Ae*te.add(se).mag()/te.sub(se).mag();De._perp()._mult(at*(Qe?-1:1))}this.addCurrentVertex(U,De,0,0,N),this.addCurrentVertex(U,De.mult(-1),0,0,N)}else if("bevel"===st||"fakeround"===st){const at=-Math.sqrt(Ae*Ae-1),yt=Qe?at:0,vt=Qe?0:at;if(G&&this.addCurrentVertex(U,te,yt,vt,N),"fakeround"===st){const It=Math.round(180*Ee/Math.PI/20);for(let At=1;At<It;At++){let ct=At/It;if(.5!==ct){const Dn=ct-.5;ct+=ct*Dn*(ct-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*Dn*Dn+(.848013+pe*(.215638*pe-1.06021)))}const jt=se.sub(te)._mult(ct)._add(te)._unit()._mult(Qe?-1:1);this.addHalfVertex(U,jt.x,jt.y,!1,Qe,0,N)}}K&&this.addCurrentVertex(U,se,-yt,-vt,N)}else if("butt"===st)this.addCurrentVertex(U,De,0,0,N);else if("square"===st){const at=G?1:-1;G||this.addCurrentVertex(U,De,at,at,N),this.addCurrentVertex(U,De,0,0,N),G&&this.addCurrentVertex(U,De,at,at,N)}else"round"===st&&(G&&(this.addCurrentVertex(U,te,0,0,N),this.addCurrentVertex(U,te,1,1,N,!0)),K&&(this.addCurrentVertex(U,se,-1,-1,N,!0),this.addCurrentVertex(U,se,0,0,N)));if(et&&_e<D-1){const at=U.dist(K);if(at>2*O){const yt=U.add(K.sub(U)._mult(O/at)._round());this.updateDistance(U,yt),this.addCurrentVertex(yt,se,0,0,N),U=yt}}}}addCurrentVertex(a,u,p,_,v,w=!1){const E=u.y*_-u.x,D=-u.y-u.x*_;this.addHalfVertex(a,u.x+u.y*p,u.y-u.x*p,w,!1,p,v),this.addHalfVertex(a,E,D,w,!0,-_,v)}addHalfVertex({x:a,y:u},p,_,v,w,E,D){this.layoutVertexArray.emplaceBack((a<<1)+(v?1:0),(u<<1)+(w?1:0),Math.round(63*p)+128,Math.round(63*_)+128,1+(0===E?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),D.primitiveLength++),w?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const a=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=a*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(a,u){this.distance+=a.dist(u),this.updateScaledDistance()}}ln(Cm,"LineBucket",{omit:["layers","patternFeatures"]});const Rp=new Pt({"line-cap":new lt(gt.layout_line["line-cap"]),"line-join":new lt(gt.layout_line["line-join"]),"line-miter-limit":new je(gt.layout_line["line-miter-limit"]),"line-round-limit":new je(gt.layout_line["line-round-limit"]),"line-sort-key":new lt(gt.layout_line["line-sort-key"])});var cx={paint:new Pt({"line-opacity":new lt(gt.paint_line["line-opacity"]),"line-color":new lt(gt.paint_line["line-color"]),"line-translate":new je(gt.paint_line["line-translate"]),"line-translate-anchor":new je(gt.paint_line["line-translate-anchor"]),"line-width":new lt(gt.paint_line["line-width"]),"line-gap-width":new lt(gt.paint_line["line-gap-width"]),"line-offset":new lt(gt.paint_line["line-offset"]),"line-blur":new lt(gt.paint_line["line-blur"]),"line-dasharray":new lt(gt.paint_line["line-dasharray"]),"line-pattern":new lt(gt.paint_line["line-pattern"]),"line-gradient":new Mt(gt.paint_line["line-gradient"]),"line-trim-offset":new je(gt.paint_line["line-trim-offset"])}),layout:Rp};const ux=new class extends lt{possiblyEvaluate(c,a){return a=new $e(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(c,a)}evaluate(c,a,u,p){return a=Jn({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(c,a,u,p)}}(cx.paint.properties["line-width"].specification);function dx(c,a){return a>0?a+2*c:c}ux.useIntegerZoom=!0;const uv=bn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),cT=bn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),hx=bn([{name:"a_projected_pos",components:4,type:"Float32"}],4);bn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const uT=bn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),px=bn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);bn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const dT=bn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),hT=bn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);bn([{name:"triangle",components:3,type:"Uint16"}]),bn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),bn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),bn([{type:"Float32",name:"offsetX"}]),bn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ir=24;const Jl=128;function id(c,a){const{expression:u}=a;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new $e(c+1))};if("source"===u.kind)return{kind:"source"};{const{zoomStops:p,interpolationType:_}=u;let v=0;for(;v<p.length&&p[v]<=c;)v++;v=Math.max(0,v-1);let w=v;for(;w<p.length&&p[w]<c+1;)w++;w=Math.min(p.length-1,w);const E=p[v],D=p[w];return"composite"===u.kind?{kind:"composite",minZoom:E,maxZoom:D,interpolationType:_}:{kind:"camera",minZoom:E,maxZoom:D,minSize:u.evaluate(new $e(E)),maxSize:u.evaluate(new $e(D)),interpolationType:_}}}function si(c,{uSize:a,uSizeT:u},{lowerSize:p,upperSize:_}){return"source"===c.kind?p/Jl:"composite"===c.kind?Si(p/Jl,_/Jl,u):a}function Lp(c,a){let u=0,p=0;if("constant"===c.kind)p=c.layoutSize;else if("source"!==c.kind){const{interpolationType:_,minZoom:v,maxZoom:w}=c,E=_?Bn(fn.interpolationFactor(_,a,v,w),0,1):0;"camera"===c.kind?p=Si(c.minSize,c.maxSize,E):u=E}return{uSizeT:u,uSize:p}}var Tm=Object.freeze({__proto__:null,getSizeData:id,evaluateSizeForFeature:si,evaluateSizeForZoom:Lp,SIZE_PACK_FACTOR:Jl});function jr(c,a,u){return c.sections.forEach(p=>{p.text=function(_,v,w){const E=v.layout.get("text-transform").evaluate(w,{});return"uppercase"===E?_=_.toLocaleUpperCase():"lowercase"===E&&(_=_.toLocaleLowerCase()),Le.applyArabicShaping&&(_=Le.applyArabicShaping(_)),_}(p.text,a,u)}),c}const Em={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function pT(c){return"\ufe36"===c||"\ufe48"===c||"\ufe38"===c||"\ufe44"===c||"\ufe42"===c||"\ufe3e"===c||"\ufe3c"===c||"\ufe3a"===c||"\ufe18"===c||"\ufe40"===c||"\ufe10"===c||"\ufe13"===c||"\ufe14"===c||"\uff40"===c||"\uffe3"===c||"\ufe11"===c||"\ufe12"===c}function yh(c){return"\ufe35"===c||"\ufe47"===c||"\ufe37"===c||"\ufe43"===c||"\ufe41"===c||"\ufe3d"===c||"\ufe3b"===c||"\ufe39"===c||"\ufe17"===c||"\ufe3f"===c}var Sm=fo,p_=function(c,a,u,p,_){var v,w,E=8*_-p-1,D=(1<<E)-1,M=D>>1,O=-7,N=u?_-1:0,U=u?-1:1,G=c[a+N];for(N+=U,v=G&(1<<-O)-1,G>>=-O,O+=E;O>0;v=256*v+c[a+N],N+=U,O-=8);for(w=v&(1<<-O)-1,v>>=-O,O+=p;O>0;w=256*w+c[a+N],N+=U,O-=8);if(0===v)v=1-M;else{if(v===D)return w?NaN:1/0*(G?-1:1);w+=Math.pow(2,p),v-=M}return(G?-1:1)*w*Math.pow(2,v-p)},f_=function(c,a,u,p,_,v){var w,E,D,M=8*v-_-1,O=(1<<M)-1,N=O>>1,U=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,G=p?0:v-1,K=p?1:-1,te=a<0||0===a&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(E=isNaN(a)?1:0,w=O):(w=Math.floor(Math.log(a)/Math.LN2),a*(D=Math.pow(2,-w))<1&&(w--,D*=2),(a+=w+N>=1?U/D:U*Math.pow(2,1-N))*D>=2&&(w++,D/=2),w+N>=O?(E=0,w=O):w+N>=1?(E=(a*D-1)*Math.pow(2,_),w+=N):(E=a*Math.pow(2,N-1)*Math.pow(2,_),w=0));_>=8;c[u+G]=255&E,G+=K,E/=256,_-=8);for(w=w<<_|E,M+=_;M>0;c[u+G]=255&w,G+=K,w/=256,M-=8);c[u+G-K]|=128*te};function fo(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}fo.Varint=0,fo.Fixed64=1,fo.Bytes=2,fo.Fixed32=5;var Dm=4294967296,ec=1/Dm,fx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function qc(c){return c.type===fo.Bytes?c.readVarint()+c.pos:c.pos+1}function mx(c,a,u){var p=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));u.realloc(p);for(var _=u.pos-1;_>=c;_--)u.buf[_+p]=u.buf[_]}function gx(c,a){for(var u=0;u<c.length;u++)a.writeVarint(c[u])}function fT(c,a){for(var u=0;u<c.length;u++)a.writeSVarint(c[u])}function mT(c,a){for(var u=0;u<c.length;u++)a.writeFloat(c[u])}function zp(c,a){for(var u=0;u<c.length;u++)a.writeDouble(c[u])}function Zc(c,a){for(var u=0;u<c.length;u++)a.writeBoolean(c[u])}function gT(c,a){for(var u=0;u<c.length;u++)a.writeFixed32(c[u])}function _T(c,a){for(var u=0;u<c.length;u++)a.writeSFixed32(c[u])}function d2(c,a){for(var u=0;u<c.length;u++)a.writeFixed64(c[u])}function h2(c,a){for(var u=0;u<c.length;u++)a.writeSFixed64(c[u])}function Mm(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+16777216*c[a+3]}function Im(c,a,u){c[u]=a,c[u+1]=a>>>8,c[u+2]=a>>>16,c[u+3]=a>>>24}function dv(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+(c[a+3]<<24)}function _x(c,a,u){a.glyphs=[],1===c&&u.readMessage(yT,a)}function yT(c,a,u){if(3===c){const{id:p,bitmap:_,width:v,height:w,left:E,top:D,advance:M}=u.readMessage(yx,{});a.glyphs.push({id:p,bitmap:new ia({width:v+6,height:w+6},_),metrics:{width:v,height:w,left:E,top:D,advance:M}})}else 4===c?a.ascender=u.readSVarint():5===c&&(a.descender=u.readSVarint())}function yx(c,a,u){1===c?a.id=u.readVarint():2===c?a.bitmap=u.readBytes():3===c?a.width=u.readVarint():4===c?a.height=u.readVarint():5===c?a.left=u.readSVarint():6===c?a.top=u.readSVarint():7===c&&(a.advance=u.readVarint())}function hv(c){let a=0,u=0;for(const w of c)a+=w.w*w.h,u=Math.max(u,w.w);c.sort((w,E)=>E.h-w.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),u),h:1/0}];let _=0,v=0;for(const w of c)for(let E=p.length-1;E>=0;E--){const D=p[E];if(!(w.w>D.w||w.h>D.h)){if(w.x=D.x,w.y=D.y,v=Math.max(v,w.y+w.h),_=Math.max(_,w.x+w.w),w.w===D.w&&w.h===D.h){const M=p.pop();E<p.length&&(p[E]=M)}else w.h===D.h?(D.x+=w.w,D.w-=w.w):w.w===D.w?(D.y+=w.h,D.h-=w.h):(p.push({x:D.x+w.w,y:D.y,w:D.w-w.w,h:w.h}),D.y+=w.h,D.h-=w.h);break}}return{w:_,h:v,fill:a/(_*v)||0}}fo.prototype={destroy:function(){this.buf=null},readFields:function(c,a,u){for(u=u||this.length;this.pos<u;){var p=this.readVarint(),_=p>>3,v=this.pos;this.type=7&p,c(_,a,this),this.pos===v&&this.skip(p)}return a},readMessage:function(c,a){return this.readFields(c,a,this.readVarint()+this.pos)},readFixed32:function(){var c=Mm(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=dv(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=Mm(this.buf,this.pos)+Mm(this.buf,this.pos+4)*Dm;return this.pos+=8,c},readSFixed64:function(){var c=Mm(this.buf,this.pos)+dv(this.buf,this.pos+4)*Dm;return this.pos+=8,c},readFloat:function(){var c=p_(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=p_(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var a,u,p=this.buf;return a=127&(u=p[this.pos++]),u<128?a:(a|=(127&(u=p[this.pos++]))<<7,u<128?a:(a|=(127&(u=p[this.pos++]))<<14,u<128?a:(a|=(127&(u=p[this.pos++]))<<21,u<128?a:function(_,v,w){var E,D,M=w.buf;if(E=(112&(D=M[w.pos++]))>>4,D<128||(E|=(127&(D=M[w.pos++]))<<3,D<128)||(E|=(127&(D=M[w.pos++]))<<10,D<128)||(E|=(127&(D=M[w.pos++]))<<17,D<128)||(E|=(127&(D=M[w.pos++]))<<24,D<128)||(E|=(1&(D=M[w.pos++]))<<31,D<128))return function Fp(c,a,u){return u?4294967296*a+(c>>>0):4294967296*(a>>>0)+(c>>>0)}(_,E,v);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(u=p[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var c=this.readVarint()+this.pos,a=this.pos;return this.pos=c,c-a>=12&&fx?fx.decode(this.buf.subarray(a,c)):function(u,p,_){for(var v="",w=p;w<_;){var E,D,M,O=u[w],N=null,U=O>239?4:O>223?3:O>191?2:1;if(w+U>_)break;1===U?O<128&&(N=O):2===U?128==(192&(E=u[w+1]))&&(N=(31&O)<<6|63&E)<=127&&(N=null):3===U?(D=u[w+2],128==(192&(E=u[w+1]))&&128==(192&D)&&((N=(15&O)<<12|(63&E)<<6|63&D)<=2047||N>=55296&&N<=57343)&&(N=null)):4===U&&(D=u[w+2],M=u[w+3],128==(192&(E=u[w+1]))&&128==(192&D)&&128==(192&M)&&((N=(15&O)<<18|(63&E)<<12|(63&D)<<6|63&M)<=65535||N>=1114112)&&(N=null)),null===N?(N=65533,U=1):N>65535&&(N-=65536,v+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),v+=String.fromCharCode(N),w+=U}return v}(this.buf,a,c)},readBytes:function(){var c=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,c);return this.pos=c,a},readPackedVarint:function(c,a){if(this.type!==fo.Bytes)return c.push(this.readVarint(a));var u=qc(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(a));return c},readPackedSVarint:function(c){if(this.type!==fo.Bytes)return c.push(this.readSVarint());var a=qc(this);for(c=c||[];this.pos<a;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==fo.Bytes)return c.push(this.readBoolean());var a=qc(this);for(c=c||[];this.pos<a;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==fo.Bytes)return c.push(this.readFloat());var a=qc(this);for(c=c||[];this.pos<a;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==fo.Bytes)return c.push(this.readDouble());var a=qc(this);for(c=c||[];this.pos<a;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==fo.Bytes)return c.push(this.readFixed32());var a=qc(this);for(c=c||[];this.pos<a;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==fo.Bytes)return c.push(this.readSFixed32());var a=qc(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==fo.Bytes)return c.push(this.readFixed64());var a=qc(this);for(c=c||[];this.pos<a;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==fo.Bytes)return c.push(this.readSFixed64());var a=qc(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed64());return c},skip:function(c){var a=7&c;if(a===fo.Varint)for(;this.buf[this.pos++]>127;);else if(a===fo.Bytes)this.pos=this.readVarint()+this.pos;else if(a===fo.Fixed32)this.pos+=4;else{if(a!==fo.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(c,a){this.writeVarint(c<<3|a)},realloc:function(c){for(var a=this.length||16;a<this.pos+c;)a*=2;if(a!==this.length){var u=new Uint8Array(a);u.set(this.buf),this.buf=u,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),Im(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),Im(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),Im(this.buf,-1&c,this.pos),Im(this.buf,Math.floor(c*ec),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),Im(this.buf,-1&c,this.pos),Im(this.buf,Math.floor(c*ec),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(a,u){var p,_,v,E;if(a>=0?(p=a%4294967296|0,_=a/4294967296|0):(_=~(-a/4294967296),4294967295^(p=~(-a%4294967296))?p=p+1|0:(p=0,_=_+1|0)),a>=0x10000000000000000||a<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),v=p,(E=u).buf[E.pos++]=127&v|128,v>>>=7,E.buf[E.pos++]=127&v|128,v>>>=7,E.buf[E.pos++]=127&v|128,v>>>=7,E.buf[E.pos++]=127&v|128,E.buf[E.pos]=127&(v>>>=7),function(v,w){var E=(7&v)<<4;w.buf[w.pos++]|=E|((v>>>=3)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v)))))}(_,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(Boolean(c))},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var a=this.pos;this.pos=function(p,_,v){for(var w,E,D=0;D<_.length;D++){if((w=_.charCodeAt(D))>55295&&w<57344){if(!E){w>56319||D+1===_.length?(p[v++]=239,p[v++]=191,p[v++]=189):E=w;continue}if(w<56320){p[v++]=239,p[v++]=191,p[v++]=189,E=w;continue}w=E-55296<<10|w-56320|65536,E=null}else E&&(p[v++]=239,p[v++]=191,p[v++]=189,E=null);w<128?p[v++]=w:(w<2048?p[v++]=w>>6|192:(w<65536?p[v++]=w>>12|224:(p[v++]=w>>18|240,p[v++]=w>>12&63|128),p[v++]=w>>6&63|128),p[v++]=63&w|128)}return v}(this.buf,c,this.pos);var u=this.pos-a;u>=128&&mx(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),f_(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),f_(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var a=c.length;this.writeVarint(a),this.realloc(a);for(var u=0;u<a;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,a){this.pos++;var u=this.pos;c(a,this);var p=this.pos-u;p>=128&&mx(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeMessage:function(c,a,u){this.writeTag(c,fo.Bytes),this.writeRawMessage(a,u)},writePackedVarint:function(c,a){a.length&&this.writeMessage(c,gx,a)},writePackedSVarint:function(c,a){a.length&&this.writeMessage(c,fT,a)},writePackedBoolean:function(c,a){a.length&&this.writeMessage(c,Zc,a)},writePackedFloat:function(c,a){a.length&&this.writeMessage(c,mT,a)},writePackedDouble:function(c,a){a.length&&this.writeMessage(c,zp,a)},writePackedFixed32:function(c,a){a.length&&this.writeMessage(c,gT,a)},writePackedSFixed32:function(c,a){a.length&&this.writeMessage(c,_T,a)},writePackedFixed64:function(c,a){a.length&&this.writeMessage(c,d2,a)},writePackedSFixed64:function(c,a){a.length&&this.writeMessage(c,h2,a)},writeBytesField:function(c,a){this.writeTag(c,fo.Bytes),this.writeBytes(a)},writeFixed32Field:function(c,a){this.writeTag(c,fo.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(c,a){this.writeTag(c,fo.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(c,a){this.writeTag(c,fo.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(c,a){this.writeTag(c,fo.Fixed64),this.writeSFixed64(a)},writeVarintField:function(c,a){this.writeTag(c,fo.Varint),this.writeVarint(a)},writeSVarintField:function(c,a){this.writeTag(c,fo.Varint),this.writeSVarint(a)},writeStringField:function(c,a){this.writeTag(c,fo.Bytes),this.writeString(a)},writeFloatField:function(c,a){this.writeTag(c,fo.Fixed32),this.writeFloat(a)},writeDoubleField:function(c,a){this.writeTag(c,fo.Fixed64),this.writeDouble(a)},writeBooleanField:function(c,a){this.writeVarintField(c,Boolean(a))}};class pv{constructor(a,{pixelRatio:u,version:p,stretchX:_,stretchY:v,content:w}){this.paddedRect=a,this.pixelRatio=u,this.stretchX=_,this.stretchY=v,this.content=w,this.version=p}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Ka{constructor(a,u){const p={},_={};this.haveRenderCallbacks=[];const v=[];this.addImages(a,p,v),this.addImages(u,_,v);const{w,h:E}=hv(v),D=new oa({width:w||1,height:E||1});for(const M in a){const O=a[M],N=p[M].paddedRect;oa.copy(O.data,D,{x:0,y:0},{x:N.x+1,y:N.y+1},O.data)}for(const M in u){const O=u[M],N=_[M].paddedRect,U=N.x+1,G=N.y+1,K=O.data.width,te=O.data.height;oa.copy(O.data,D,{x:0,y:0},{x:U,y:G},O.data),oa.copy(O.data,D,{x:0,y:te-1},{x:U,y:G-1},{width:K,height:1}),oa.copy(O.data,D,{x:0,y:0},{x:U,y:G+te},{width:K,height:1}),oa.copy(O.data,D,{x:K-1,y:0},{x:U-1,y:G},{width:1,height:te}),oa.copy(O.data,D,{x:0,y:0},{x:U+K,y:G},{width:1,height:te})}this.image=D,this.iconPositions=p,this.patternPositions=_}addImages(a,u,p){for(const _ in a){const v=a[_],w={x:0,y:0,w:v.data.width+2,h:v.data.height+2};p.push(w),u[_]=new pv(w,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>a.hasImage(p)),a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in a.updatedImages)this.patchUpdatedImage(this.iconPositions[p],a.getImage(p),u),this.patchUpdatedImage(this.patternPositions[p],a.getImage(p),u)}patchUpdatedImage(a,u,p){if(!a||!u||a.version===u.version)return;a.version=u.version;const[_,v]=a.tl;p.update(u.data,void 0,{x:_,y:v})}}ln(pv,"ImagePosition"),ln(Ka,"ImageAtlas");const Ma={horizontal:1,vertical:2,horizontalOnly:3};class Np{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,u){const p=new Np;return p.scale=a||1,p.fontStack=u,p}static forImage(a){const u=new Np;return u.imageName=a,u}}class Bp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,u){const p=new Bp;for(let _=0;_<a.sections.length;_++){const v=a.sections[_];v.image?p.addImageSection(v):p.addTextSection(v,u)}return p}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(a){this.text=function(u,p){let _="";for(let v=0;v<u.length;v++){const w=u.charCodeAt(v+1)||null,E=u.charCodeAt(v-1)||null;_+=!p&&(w&&L(w)&&!Em[u[v+1]]||E&&L(E)&&!Em[u[v-1]])||!Em[u[v]]?u[v]:Em[u[v]]}return _}(this.text,a)}trim(){let a=0;for(let p=0;p<this.text.length&&m_[this.text.charCodeAt(p)];p++)a++;let u=this.text.length;for(let p=this.text.length-1;p>=0&&p>=a&&m_[this.text.charCodeAt(p)];p--)u--;this.text=this.text.substring(a,u),this.sectionIndex=this.sectionIndex.slice(a,u)}substring(a,u){const p=new Bp;return p.text=this.text.substring(a,u),p.sectionIndex=this.sectionIndex.slice(a,u),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,u)=>Math.max(a,this.sections[u].scale),0)}addTextSection(a,u){this.text+=a.text,this.sections.push(Np.forText(a.scale,a.fontStack||u));const p=this.sections.length-1;for(let _=0;_<a.text.length;++_)this.sectionIndex.push(p)}addImageSection(a){const u=a.image?a.image.name:"";if(0===u.length)return void vo("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Np.forImage(u)),this.sectionIndex.push(this.sections.length-1)):vo("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function fv(c,a,u,p,_,v,w,E,D,M,O,N,U,G,K){const te=Bp.fromFeature(c,_);N===Ma.vertical&&te.verticalizePunctuation(U);let se=[];const _e=function(Ee,et,Qe,pt,st,at){if(!Ee)return[];const yt=[],vt=function(jt,Dn,qt,un,Wt,Rn){let bi=0;for(let hi=0;hi<jt.length();hi++){const ui=jt.getSection(hi);bi+=mv(jt.getCharCode(hi),ui,un,Wt,Dn,Rn)}return bi/Math.max(1,Math.ceil(bi/qt))}(Ee,et,Qe,pt,st,at),It=Ee.text.indexOf("\u200b")>=0;let At=0;for(let jt=0;jt<Ee.length();jt++){const Dn=Ee.getSection(jt),qt=Ee.getCharCode(jt);if(m_[qt]||(At+=mv(qt,Dn,pt,st,et,at)),jt<Ee.length()-1){const un=!((ct=qt)<11904||!(Sy(ct)||gp(ct)||y(ct)||Rg(ct)||qf(ct)||xr(ct)||Wf(ct)||Ts(ct)||Fc(ct)||ba(ct)||Wa(ct)||x(ct)||Wu(ct)||Lc(ct)||mp(ct)||zr(ct)||$l(ct)||zc(ct)||Zf(ct)||Pg(ct)));(vT[qt]||un||Dn.imageName)&&yt.push(bx(jt+1,At,vt,yt,bT(qt,Ee.getCharCode(jt+1),un&&It),!1))}}var ct;return vi(bx(Ee.length(),At,vt,yt,0,!0))}(te,M,v,a,p,G),{processBidirectionalText:De,processStyledBidirectionalText:pe}=Le;if(De&&1===te.sections.length){const Ee=De(te.toString(),_e);for(const et of Ee){const Qe=new Bp;Qe.text=et,Qe.sections=te.sections;for(let pt=0;pt<et.length;pt++)Qe.sectionIndex.push(0);se.push(Qe)}}else if(pe){const Ee=pe(te.text,te.sectionIndex,_e);for(const et of Ee){const Qe=new Bp;Qe.text=et[0],Qe.sectionIndex=et[1],Qe.sections=te.sections,se.push(Qe)}}else se=function(Ee,et){const Qe=[],pt=Ee.text;let st=0;for(const at of et)Qe.push(Ee.substring(st,at)),st=at;return st<pt.length&&Qe.push(Ee.substring(st,pt.length)),Qe}(te,_e);const we=[],Ae={positionedLines:we,text:te.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Ee,et,Qe,pt,st,at,yt,vt,It,At,ct,jt){let Dn=0,qt=0,un=0;const Wt="right"===vt?1:"left"===vt?0:.5;let Rn=!1;for(const Zn of st){const wi=Zn.getSections();for(const ao of wi){if(ao.imageName)continue;const J=et[ao.fontStack];if(J&&(Rn=void 0!==J.ascender&&void 0!==J.descender,!Rn))break}if(!Rn)break}let bi=0;for(const Zn of st){Zn.trim();const wi=Zn.getMaxScale(),ao=(wi-1)*ir,J={positionedGlyphs:[],lineOffset:0};Ee.positionedLines[bi]=J;const mo=J.positionedGlyphs;let jn=0;if(!Zn.length()){qt+=at,++bi;continue}let B=0,ko=0;for(let F=0;F<Zn.length();F++){const V=Zn.getSection(F),Ne=Zn.getSectionIndex(F),Bi=Zn.getCharCode(F);let xn=V.scale,In=null,Ht=null,xt=null,fr=ir,Er=0;const mr=!(It===Ma.horizontal||!ct&&!P(Bi)||ct&&(m_[Bi]||(hi=Bi,Pi(hi)||Ie(hi)||Me(hi)||qu(hi)||f(hi))));if(V.imageName){const Oe=pt[V.imageName];if(!Oe)continue;xt=V.imageName,Ee.iconsInText=Ee.iconsInText||!0,Ht=Oe.paddedRect;const gr=Oe.displaySize;xn=xn*ir/jt,In={width:gr[0],height:gr[1],left:1,top:-3,advance:mr?gr[1]:gr[0],localGlyph:!1},Er=Rn?-In.height*xn:wi*ir-17-gr[1]*xn,fr=In.advance;const tu=(mr?gr[0]:gr[1])*xn-ir*wi;tu>0&&tu>jn&&(jn=tu)}else{const Oe=Qe[V.fontStack];if(!Oe)continue;Oe[Bi]&&(Ht=Oe[Bi]);const gr=et[V.fontStack];if(!gr)continue;const tu=gr.glyphs[Bi];if(!tu)continue;if(In=tu.metrics,fr=8203!==Bi?ir:0,Rn){const Ch=void 0!==gr.ascender?Math.abs(gr.ascender):0,qp=void 0!==gr.descender?Math.abs(gr.descender):0,Zp=(Ch+qp)*xn;B<Zp&&(B=Zp,ko=(Ch-qp)/2*xn),Er=-Ch*xn}else Er=(wi-xn)*ir-17}mr?(Ee.verticalizable=!0,mo.push({glyph:Bi,imageName:xt,x:Dn,y:qt+Er,vertical:mr,scale:xn,localGlyph:In.localGlyph,fontStack:V.fontStack,sectionIndex:Ne,metrics:In,rect:Ht}),Dn+=fr*xn+At):(mo.push({glyph:Bi,imageName:xt,x:Dn,y:qt+Er,vertical:mr,scale:xn,localGlyph:In.localGlyph,fontStack:V.fontStack,sectionIndex:Ne,metrics:In,rect:Ht}),Dn+=In.advance*xn+At)}0!==mo.length&&(un=Math.max(Dn-At,un),Rn?gv(mo,Wt,jn,ko,at*wi/2):gv(mo,Wt,jn,0,at/2)),Dn=0;const Hr=at*wi+jn;J.lineOffset=Math.max(jn,ao),qt+=Hr,++bi}var hi;const ui=qt,{horizontalAlign:Fn,verticalAlign:Yi}=j(yt);(function(Zn,wi,ao,J,mo,jn){const B=(wi-ao)*mo,ko=-jn*J;for(const Hr of Zn)for(const F of Hr.positionedGlyphs)F.x+=B,F.y+=ko})(Ee.positionedLines,Wt,Fn,Yi,un,ui),Ee.top+=-Yi*ui,Ee.bottom=Ee.top+ui,Ee.left+=-Fn*un,Ee.right=Ee.left+un,Ee.hasBaseline=Rn}(Ae,a,u,p,se,w,E,D,N,M,U,K),!function(Ee){for(const et of Ee)if(0!==et.positionedGlyphs.length)return!1;return!0}(we)&&Ae}const m_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},vT={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function mv(c,a,u,p,_,v){if(a.imageName){const w=p[a.imageName];return w?w.displaySize[0]*a.scale*ir/v+_:0}{const w=u[a.fontStack],E=w&&w.glyphs[c];return E?E.metrics.advance*a.scale+_:0}}function vx(c,a,u,p){const _=Math.pow(c-a,2);return p?c<a?_/2:2*_:_+Math.abs(u)*u}function bT(c,a,u){let p=0;return 10===c&&(p-=1e4),u&&(p+=150),40!==c&&65288!==c||(p+=50),41!==a&&65289!==a||(p+=50),p}function bx(c,a,u,p,_,v){let w=null,E=vx(a,u,_,v);for(const D of p){const M=vx(a-D.x,u,_,v)+D.badness;M<=E&&(w=D,E=M)}return{index:c,x:a,priorBreak:w,badness:E}}function vi(c){return c?vi(c.priorBreak).concat(c.index):[]}function j(c){let a=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:a,verticalAlign:u}}function gv(c,a,u,p,_){if(!(a||u||p||_))return;const v=c.length-1,w=c[v],E=(w.x+w.metrics.advance*w.scale)*a;for(let D=0;D<=v;D++)c[D].x-=E,c[D].y+=u+p+_}function xx(c,a,u){const{horizontalAlign:p,verticalAlign:_}=j(u),v=a[0]-c.displaySize[0]*p,w=a[1]-c.displaySize[1]*_;return{image:c,top:w,bottom:w+c.displaySize[1],left:v,right:v+c.displaySize[0]}}function wx(c,a,u,p,_,v){const w=c.image;let E;if(w.content){const se=w.content,_e=w.pixelRatio||1;E=[se[0]/_e,se[1]/_e,w.displaySize[0]-se[2]/_e,w.displaySize[1]-se[3]/_e]}const D=a.left*v,M=a.right*v;let O,N,U,G;"width"===u||"both"===u?(G=_[0]+D-p[3],N=_[0]+M+p[1]):(G=_[0]+(D+M-w.displaySize[0])/2,N=G+w.displaySize[0]);const K=a.top*v,te=a.bottom*v;return"height"===u||"both"===u?(O=_[1]+K-p[0],U=_[1]+te+p[2]):(O=_[1]+(K+te-w.displaySize[1])/2,U=O+w.displaySize[1]),{image:w,top:O,right:N,bottom:U,left:G,collisionPadding:E}}class Kc extends Ue{constructor(a,u,p,_,v){super(a,u),this.angle=_,this.z=p,void 0!==v&&(this.segment=v)}clone(){return new Kc(this.x,this.y,this.z,this.angle,this.segment)}}function _v(c,a,u,p,_){if(void 0===a.segment)return!0;let v=a,w=a.segment+1,E=0;for(;E>-u/2;){if(w--,w<0)return!1;E-=c[w].dist(v),v=c[w]}E+=c[w].dist(c[w+1]),w++;const D=[];let M=0;for(;E<u/2;){const O=c[w],N=c[w+1];if(!N)return!1;let U=c[w-1].angleTo(O)-O.angleTo(N);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:E,angleDelta:U}),M+=U;E-D[0].distance>p;)M-=D.shift().angleDelta;if(M>_)return!1;w++,E+=O.dist(N)}return!0}function Cx(c){let a=0;for(let u=0;u<c.length-1;u++)a+=c[u].dist(c[u+1]);return a}function yv(c,a,u){return c?.6*a*u:0}function Tx(c,a){return Math.max(c?c.right-c.left:0,a?a.right-a.left:0)}function xT(c,a,u,p,_,v){const w=yv(u,_,v),E=Tx(u,p)*v;let D=0;const M=Cx(c)/2;for(let O=0;O<c.length-1;O++){const N=c[O],U=c[O+1],G=N.dist(U);if(D+G>M){const K=(M-D)/G,te=Si(N.x,U.x,K),se=Si(N.y,U.y,K),_e=new Kc(te,se,0,U.angleTo(N),O);return!w||_v(c,_e,E,w,a)?_e:void 0}D+=G}}function p2(c,a,u,p,_,v,w,E,D){const M=yv(p,v,w),O=Tx(p,_),N=O*w,U=0===c[0].x||c[0].x===D||0===c[0].y||c[0].y===D;return a-N<a/4&&(a=N+a/4),vv(c,U?a/2*E%a:(O/2+2*v)*w*E%a,a,M,u,N,U,!1,D)}function vv(c,a,u,p,_,v,w,E,D){const M=v/2,O=Cx(c);let N=0,U=a-u,G=[];for(let K=0;K<c.length-1;K++){const te=c[K],se=c[K+1],_e=te.dist(se),De=se.angleTo(te);for(;U+u<N+_e;){U+=u;const pe=(U-N)/_e,we=Si(te.x,se.x,pe),Ae=Si(te.y,se.y,pe);if(we>=0&&we<D&&Ae>=0&&Ae<D&&U-M>=0&&U+M<=O){const Ee=new Kc(we,Ae,0,De,K);Ee._round(),p&&!_v(c,Ee,v,p,_)||G.push(Ee)}}N+=_e}return E||G.length||w||(G=vv(c,N/2,u,p,_,v,w,!0,D)),G}function bv(c,a,u,p,_){const v=[];for(let w=0;w<c.length;w++){const E=c[w];let D;for(let M=0;M<E.length-1;M++){let O=E[M],N=E[M+1];O.x<a&&N.x<a||(O.x<a?O=new Ue(a,O.y+(a-O.x)/(N.x-O.x)*(N.y-O.y))._round():N.x<a&&(N=new Ue(a,O.y+(a-O.x)/(N.x-O.x)*(N.y-O.y))._round()),O.y<u&&N.y<u||(O.y<u?O=new Ue(O.x+(u-O.y)/(N.y-O.y)*(N.x-O.x),u)._round():N.y<u&&(N=new Ue(O.x+(u-O.y)/(N.y-O.y)*(N.x-O.x),u)._round()),O.x>=p&&N.x>=p||(O.x>=p?O=new Ue(p,O.y+(p-O.x)/(N.x-O.x)*(N.y-O.y))._round():N.x>=p&&(N=new Ue(p,O.y+(p-O.x)/(N.x-O.x)*(N.y-O.y))._round()),O.y>=_&&N.y>=_||(O.y>=_?O=new Ue(O.x+(_-O.y)/(N.y-O.y)*(N.x-O.x),_)._round():N.y>=_&&(N=new Ue(O.x+(_-O.y)/(N.y-O.y)*(N.x-O.x),_)._round()),D&&O.equals(D[D.length-1])||(D=[O],v.push(D)),D.push(N)))))}}return v}ln(Kc,"Anchor");const Ds=1e20;function Ex(c,a,u,p,_,v,w,E,D){for(let M=a;M<a+p;M++)g_(c,u*v+M,v,_,w,E,D);for(let M=u;M<u+_;M++)g_(c,M*v+a,1,p,w,E,D)}function g_(c,a,u,p,_,v,w){v[0]=0,w[0]=-Ds,w[1]=Ds,_[0]=c[a];for(let E=1,D=0,M=0;E<p;E++){_[E]=c[a+E*u];const O=E*E;do{const N=v[D];M=(_[E]-_[N]+O-N*N)/(E-N)/2}while(M<=w[D]&&--D>-1);D++,v[D]=E,w[D]=M,w[D+1]=Ds}for(let E=0,D=0;E<p;E++){for(;w[D+1]<E;)D++;const M=v[D],O=E-M;c[a+E*u]=_[M]+O*O}}const km={none:0,ideographs:1,all:2};class Vp{constructor(a,u,p){this.requestManager=a,this.localGlyphMode=u,this.localFontFamily=p,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a){this.url=a}getGlyphs(a,u){const p=[];for(const _ in a)for(const v of a[_])p.push({stack:_,id:v});qs(p,({stack:_,id:v},w)=>{let E=this.entries[_];E||(E=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let D=E.glyphs[v];if(void 0!==D)return void w(null,{stack:_,id:v,glyph:D});if(D=this._tinySDF(E,_,v),D)return E.glyphs[v]=D,void w(null,{stack:_,id:v,glyph:D});const M=Math.floor(v/256);if(256*M>65535)return void w(new Error("glyphs > 65535 not supported"));if(E.ranges[M])return void w(null,{stack:_,id:v,glyph:D});let O=E.requests[M];O||(O=E.requests[M]=[],Vp.loadGlyphRange(_,M,this.url,this.requestManager,(N,U)=>{if(U){E.ascender=U.ascender,E.descender=U.descender;for(const G in U.glyphs)this._doesCharSupportLocalGlyph(+G)||(E.glyphs[+G]=U.glyphs[+G]);E.ranges[M]=!0}for(const G of O)G(N,U);delete E.requests[M]})),O.push((N,U)=>{N?w(N):U&&w(null,{stack:_,id:v,glyph:U.glyphs[v]||null})})},(_,v)=>{if(_)u(_);else if(v){const w={};for(const{stack:E,id:D,glyph:M}of v)void 0===w[E]&&(w[E]={}),void 0===w[E].glyphs&&(w[E].glyphs={}),w[E].glyphs[D]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},w[E].ascender=this.entries[E].ascender,w[E].descender=this.entries[E].descender;u(null,w)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==km.none&&(this.localGlyphMode===km.all?!!this.localFontFamily:!!this.localFontFamily&&(ba(a)||Og(a)||Wu(a)||$l(a)||Ts(a)))}_tinySDF(a,u,p){const _=this.localFontFamily;if(!_||!this._doesCharSupportLocalGlyph(p))return;let v=a.tinySDF;if(!v){let te="400";/bold/i.test(u)?te="900":/medium/i.test(u)?te="500":/light/i.test(u)&&(te="200"),v=a.tinySDF=new Vp.TinySDF({fontFamily:_,fontWeight:te,fontSize:48,buffer:6,radius:16}),v.fontWeight=te}if(this.localGlyphs[v.fontWeight][p])return this.localGlyphs[v.fontWeight][p];const w=String.fromCharCode(p),{data:E,width:D,height:M,glyphWidth:O,glyphHeight:N,glyphLeft:U,glyphTop:G,glyphAdvance:K}=v.draw(w);return this.localGlyphs[v.fontWeight][p]={id:p,bitmap:new ia({width:D,height:M},E),metrics:{width:O/2,height:N/2,left:U/2,top:G/2-27,advance:K/2,localGlyph:!0}}}}function wT(c,a,u,p){const _=[],v=c.image,w=v.pixelRatio,E=v.paddedRect.w-2,D=v.paddedRect.h-2,M=c.right-c.left,O=c.bottom-c.top,N=v.stretchX||[[0,E]],U=v.stretchY||[[0,D]],G=(at,yt)=>at+yt[1]-yt[0],K=N.reduce(G,0),te=U.reduce(G,0),se=E-K,_e=D-te;let De=0,pe=K,we=0,Ae=te,Ee=0,et=se,Qe=0,pt=_e;if(v.content&&p){const at=v.content;De=xv(N,0,at[0]),we=xv(U,0,at[1]),pe=xv(N,at[0],at[2]),Ae=xv(U,at[1],at[3]),Ee=at[0]-De,Qe=at[1]-we,et=at[2]-at[0]-pe,pt=at[3]-at[1]-Ae}const st=(at,yt,vt,It)=>{const At=__(at.stretch-De,pe,M,c.left),ct=Am(at.fixed-Ee,et,at.stretch,K),jt=__(yt.stretch-we,Ae,O,c.top),Dn=Am(yt.fixed-Qe,pt,yt.stretch,te),qt=__(vt.stretch-De,pe,M,c.left),un=Am(vt.fixed-Ee,et,vt.stretch,K),Wt=__(It.stretch-we,Ae,O,c.top),Rn=Am(It.fixed-Qe,pt,It.stretch,te),bi=new Ue(At,jt),hi=new Ue(qt,jt),ui=new Ue(qt,Wt),Fn=new Ue(At,Wt),Yi=new Ue(ct/w,Dn/w),Zn=new Ue(un/w,Rn/w),wi=a*Math.PI/180;if(wi){const mo=Math.sin(wi),jn=Math.cos(wi),B=[jn,-mo,mo,jn];bi._matMult(B),hi._matMult(B),Fn._matMult(B),ui._matMult(B)}const ao=at.stretch+at.fixed,J=yt.stretch+yt.fixed;return{tl:bi,tr:hi,bl:Fn,br:ui,tex:{x:v.paddedRect.x+1+ao,y:v.paddedRect.y+1+J,w:vt.stretch+vt.fixed-ao,h:It.stretch+It.fixed-J},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yi,pixelOffsetBR:Zn,minFontScaleX:et/w/M,minFontScaleY:pt/w/O,isSDF:u}};if(p&&(v.stretchX||v.stretchY)){const at=CT(N,se,K),yt=CT(U,_e,te);for(let vt=0;vt<at.length-1;vt++){const It=at[vt],At=at[vt+1];for(let ct=0;ct<yt.length-1;ct++)_.push(st(It,yt[ct],At,yt[ct+1]))}}else _.push(st({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:D+1}));return _}function xv(c,a,u){let p=0;for(const _ of c)p+=Math.max(a,Math.min(u,_[1]))-Math.max(a,Math.min(u,_[0]));return p}function CT(c,a,u){const p=[{fixed:-1,stretch:0}];for(const[_,v]of c){const w=p[p.length-1];p.push({fixed:_-w.stretch,stretch:w.stretch}),p.push({fixed:_-w.stretch,stretch:w.stretch+(v-_)})}return p.push({fixed:a+1,stretch:u}),p}function __(c,a,u,p){return c/a*u+p}function Am(c,a,u,p){return c-a*u/p}function f2(c,a,u,p){const _=a+c.positionedLines[p].lineOffset;return 0===p?u+_/2:u+(_+(a+c.positionedLines[p-1].lineOffset))/2}Vp.loadGlyphRange=function(c,a,u,p,_){const v=256*a,w=v+255,E=p.transformRequest(p.normalizeGlyphsURL(u).replace("{fontstack}",c).replace("{range}",`${v}-${w}`),Md.Glyphs);bu(E,(D,M)=>{if(D)_(D);else if(M){const O={},N=new Sm(M).readFields(_x,{});for(const U of N.glyphs)O[U.id]=U;_(null,{glyphs:O,ascender:N.ascender,descender:N.descender})}})},Vp.TinySDF=class{constructor({fontSize:c=24,buffer:a=3,radius:u=8,cutoff:p=.25,fontFamily:_="sans-serif",fontWeight:v="normal",fontStyle:w="normal"}={}){this.buffer=a,this.cutoff=p,this.radius=u;const E=this.size=c+4*a,D=this._createCanvas(E),M=this.ctx=D.getContext("2d",{willReadFrequently:!0});M.font=`${w} ${v} ${c}px ${_}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(c){const a=document.createElement("canvas");return a.width=a.height=c,a}draw(c){const{width:a,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:_,actualBoundingBoxRight:v}=this.ctx.measureText(c),w=Math.ceil(u),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-_))),D=Math.min(this.size-this.buffer,w+Math.ceil(p)),M=E+2*this.buffer,O=D+2*this.buffer,N=Math.max(M*O,0),U=new Uint8ClampedArray(N),G={data:U,width:M,height:O,glyphWidth:E,glyphHeight:D,glyphTop:w,glyphLeft:0,glyphAdvance:a};if(0===E||0===D)return G;const{ctx:K,buffer:te,gridInner:se,gridOuter:_e}=this;K.clearRect(te,te,E,D),K.fillText(c,te,te+w);const De=K.getImageData(te,te,E,D);_e.fill(Ds,0,N),se.fill(0,0,N);for(let pe=0;pe<D;pe++)for(let we=0;we<E;we++){const Ae=De.data[4*(pe*E+we)+3]/255;if(0===Ae)continue;const Ee=(pe+te)*M+we+te;if(1===Ae)_e[Ee]=0,se[Ee]=Ds;else{const et=.5-Ae;_e[Ee]=et>0?et*et:0,se[Ee]=et<0?et*et:0}}Ex(_e,0,0,M,O,M,this.f,this.v,this.z),Ex(se,te,te,E,D,M,this.f,this.v,this.z);for(let pe=0;pe<N;pe++){const we=Math.sqrt(_e[pe])-Math.sqrt(se[pe]);U[pe]=Math.round(255-255*(we/this.radius+this.cutoff))}return G}};class TT{constructor(a=[],u=Up){if(this.data=a,this.length=this.data.length,this.compare=u,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const a=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:u,compare:p}=this,_=u[a];for(;a>0;){const v=a-1>>1,w=u[v];if(p(_,w)>=0)break;u[a]=w,a=v}u[a]=_}_down(a){const{data:u,compare:p}=this,_=this.length>>1,v=u[a];for(;a<_;){let w=1+(a<<1),E=u[w];const D=w+1;if(D<this.length&&p(u[D],E)<0&&(w=D,E=u[D]),p(E,v)>=0)break;u[a]=E,a=w}u[a]=v}}function Up(c,a){return c<a?-1:c>a?1:0}function ET(c,a=1,u=!1){let p=1/0,_=1/0,v=-1/0,w=-1/0;const E=c[0];for(let G=0;G<E.length;G++){const K=E[G];(!G||K.x<p)&&(p=K.x),(!G||K.y<_)&&(_=K.y),(!G||K.x>v)&&(v=K.x),(!G||K.y>w)&&(w=K.y)}const D=Math.min(v-p,w-_);let M=D/2;const O=new TT([],Sx);if(0===D)return new Ue(p,_);for(let G=p;G<v;G+=D)for(let K=_;K<w;K+=D)O.push(new Xc(G+M,K+M,M,c));let N=function(G){let K=0,te=0,se=0;const _e=G[0];for(let De=0,pe=_e.length,we=pe-1;De<pe;we=De++){const Ae=_e[De],Ee=_e[we],et=Ae.x*Ee.y-Ee.x*Ae.y;te+=(Ae.x+Ee.x)*et,se+=(Ae.y+Ee.y)*et,K+=3*et}return new Xc(te/K,se/K,0,G)}(c),U=O.length;for(;O.length;){const G=O.pop();(G.d>N.d||!N.d)&&(N=G,u&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,U)),G.max-N.d<=a||(M=G.h/2,O.push(new Xc(G.p.x-M,G.p.y-M,M,c)),O.push(new Xc(G.p.x+M,G.p.y-M,M,c)),O.push(new Xc(G.p.x-M,G.p.y+M,M,c)),O.push(new Xc(G.p.x+M,G.p.y+M,M,c)),U+=4)}return u&&(console.log(`num probes: ${U}`),console.log(`best distance: ${N.d}`)),N.p}function Sx(c,a){return a.max-c.max}function Xc(c,a,u,p){this.p=new Ue(c,a),this.h=u,this.d=function(_,v){let w=!1,E=1/0;for(let D=0;D<v.length;D++){const M=v[D];for(let O=0,N=M.length,U=N-1;O<N;U=O++){const G=M[O],K=M[U];G.y>_.y!=K.y>_.y&&_.x<(K.x-G.x)*(_.y-G.y)/(K.y-G.y)+G.x&&(w=!w),E=Math.min(E,Zy(_,G,K))}}return(w?1:-1)*Math.sqrt(E)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}const wv=Number.POSITIVE_INFINITY,Dx=Math.sqrt(2);function Mx(c,[a,u]){let p=0,_=0;if(u===wv){a<0&&(a=0);const v=a/Dx;switch(c){case"top-right":case"top-left":_=v-7;break;case"bottom-right":case"bottom-left":_=7-v;break;case"bottom":_=7-a;break;case"top":_=a-7}switch(c){case"top-right":case"bottom-right":p=-v;break;case"top-left":case"bottom-left":p=v;break;case"left":p=a;break;case"right":p=-a}}else{switch(a=Math.abs(a),u=Math.abs(u),c){case"top-right":case"top-left":case"top":_=u-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-u}switch(c){case"top-right":case"bottom-right":case"right":p=-a;break;case"top-left":case"bottom-left":case"left":p=a}}return[p,_]}function ST(c,a,u,p,_,v,w,E,D,M){c.createArrays(),c.tilePixelRatio=Un/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const O=c.layers[0].layout,N=c.layers[0]._unevaluatedLayout._values,U={};if("composite"===c.textSizeData.kind){const{minZoom:te,maxZoom:se}=c.textSizeData;U.compositeTextSizes=[N["text-size"].possiblyEvaluate(new $e(te),E),N["text-size"].possiblyEvaluate(new $e(se),E)]}if("composite"===c.iconSizeData.kind){const{minZoom:te,maxZoom:se}=c.iconSizeData;U.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new $e(te),E),N["icon-size"].possiblyEvaluate(new $e(se),E)]}U.layoutTextSize=N["text-size"].possiblyEvaluate(new $e(D+1),E),U.layoutIconSize=N["icon-size"].possiblyEvaluate(new $e(D+1),E),U.textMaxSize=N["text-size"].possiblyEvaluate(new $e(18),E);const G="map"===O.get("text-rotation-alignment")&&"point"!==O.get("symbol-placement"),K=O.get("text-size");for(const te of c.features){const se=O.get("text-font").evaluate(te,{},E).join(","),_e=K.evaluate(te,{},E),De=U.layoutTextSize.evaluate(te,{},E),pe=(U.layoutIconSize.evaluate(te,{},E),{horizontal:{},vertical:void 0}),we=te.text;let Ae,Ee=[0,0];if(we){const pt=we.toString(),st=O.get("text-letter-spacing").evaluate(te,{},E)*ir,at=O.get("text-line-height").evaluate(te,{},E)*ir,yt=S(pt)?st:0,vt=O.get("text-anchor").evaluate(te,{},E),It=O.get("text-variable-anchor");if(!It){const qt=O.get("text-radial-offset").evaluate(te,{},E);Ee=qt?Mx(vt,[qt*ir,wv]):O.get("text-offset").evaluate(te,{},E).map(un=>un*ir)}let At=G?"center":O.get("text-justify").evaluate(te,{},E);const ct="point"===O.get("symbol-placement"),jt=ct?O.get("text-max-width").evaluate(te,{},E)*ir:1/0,Dn=qt=>{c.allowVerticalPlacement&&C(pt)&&(pe.vertical=fv(we,a,u,_,se,jt,at,vt,qt,yt,Ee,Ma.vertical,!0,De,_e))};if(!G&&It){const qt="auto"===At?It.map(Wt=>Cv(Wt)):[At];let un=!1;for(let Wt=0;Wt<qt.length;Wt++){const Rn=qt[Wt];if(!pe.horizontal[Rn])if(un)pe.horizontal[Rn]=pe.horizontal[0];else{const bi=fv(we,a,u,_,se,jt,at,"center",Rn,yt,Ee,Ma.horizontal,!1,De,_e);bi&&(pe.horizontal[Rn]=bi,un=1===bi.positionedLines.length)}}Dn("left")}else{if("auto"===At&&(At=Cv(vt)),ct||O.get("text-writing-mode").indexOf("horizontal")>=0||!C(pt)){const qt=fv(we,a,u,_,se,jt,at,vt,At,yt,Ee,Ma.horizontal,!1,De,_e);qt&&(pe.horizontal[At]=qt)}Dn(ct?"left":At)}}let et=!1;if(te.icon&&te.icon.name){const pt=p[te.icon.name];pt&&(Ae=xx(_[te.icon.name],O.get("icon-offset").evaluate(te,{},E),O.get("icon-anchor").evaluate(te,{},E)),et=pt.sdf,void 0===c.sdfIcons?c.sdfIcons=pt.sdf:c.sdfIcons!==pt.sdf&&vo("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pt.pixelRatio!==c.pixelRatio||0!==O.get("icon-rotate").constantOr(1))&&(c.iconsNeedLinear=!0))}const Qe=Ix(pe.horizontal)||pe.vertical;c.iconsInText||(c.iconsInText=!!Qe&&Qe.iconsInText),(Qe||Ae)&&DT(c,te,pe,Ae,p,U,De,0,Ee,et,w,E,M)}v&&c.generateCollisionDebugBuffers(D,c.collisionBoxArray)}function Cv(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function DT(c,a,u,p,_,v,w,E,D,M,O,N,U){let G=v.textMaxSize.evaluate(a,{},N);void 0===G&&(G=w);const K=c.layers[0].layout,te=K.get("icon-offset").evaluate(a,{},N),se=Ix(u.horizontal)||u.vertical,_e="globe"===U.name,De=w/24,pe=c.tilePixelRatio*G/24,we=(yt=c.overscaling,c.zoom>18&&yt>2&&(yt>>=1),Math.max(Un/(512*yt),1)*K.get("symbol-spacing")),Ae=K.get("text-padding")*c.tilePixelRatio,Ee=K.get("icon-padding")*c.tilePixelRatio,et=bt(K.get("text-max-angle")),Qe="map"===K.get("text-rotation-alignment")&&"point"!==K.get("symbol-placement"),pt="map"===K.get("icon-rotation-alignment")&&"point"!==K.get("symbol-placement"),st=K.get("symbol-placement"),at=we/2;var yt;const vt=K.get("icon-text-fit");let It;p&&"none"!==vt&&(c.allowVerticalPlacement&&u.vertical&&(It=wx(p,u.vertical,vt,K.get("icon-text-fit-padding"),te,De)),se&&(p=wx(p,se,vt,K.get("icon-text-fit-padding"),te,De)));const At=(ct,jt,Dn)=>{if(jt.x<0||jt.x>=Un||jt.y<0||jt.y>=Un)return;let qt=null;if(_e){const{x:un,y:Wt,z:Rn}=U.projectTilePoint(jt.x,jt.y,Dn);qt={anchor:new Kc(un,Wt,Rn,0,void 0),up:U.upVector(Dn,jt.x,jt.y)}}!function(un,Wt,Rn,bi,hi,ui,Fn,Yi,Zn,wi,ao,J,mo,jn,B,ko,Hr,F,V,Ne,Bi,xn,In,Ht,xt){const fr=un.addToLineVertexArray(Wt,bi);let Er,mr,Oe,gr,tu,Ch,qp,Zp=0,q=0,Hx=0,or=0,Qi=-1,To=-1;const Qa={};let jv=Bc("");const ld=Rn?Rn.anchor:Wt;let I_=0,k_=0;if(void 0===Zn._unevaluatedLayout.getValue("text-radial-offset")?[I_,k_]=Zn.layout.get("text-offset").evaluate(Bi,{},xt).map(Hs=>Hs*ir):(I_=Zn.layout.get("text-radial-offset").evaluate(Bi,{},xt)*ir,k_=wv),un.allowVerticalPlacement&&hi.vertical){const Hs=hi.vertical;if(B)Ch=y_(Hs),Yi&&(qp=y_(Yi));else{const hs=Zn.layout.get("text-rotate").evaluate(Bi,{},xt)+90;Oe=Pm(wi,ld,Wt,ao,J,mo,Hs,jn,hs,ko),Yi&&(gr=Pm(wi,ld,Wt,ao,J,mo,Yi,F,hs))}}if(ui){const Hs=Zn.layout.get("icon-rotate").evaluate(Bi,{},xt),hs="none"!==Zn.layout.get("icon-text-fit"),Ja=wT(ui,Hs,In,hs),Hv=Yi?wT(Yi,Hs,In,hs):void 0;mr=Pm(wi,ld,Wt,ao,J,mo,ui,F,Hs),Zp=4*Ja.length;const Gx=un.iconSizeData;let iu=null;"source"===Gx.kind?(iu=[Jl*Zn.layout.get("icon-size").evaluate(Bi,{},xt)],iu[0]>od&&vo(`${un.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Gx.kind&&(iu=[Jl*xn.compositeIconSizes[0].evaluate(Bi,{},xt),Jl*xn.compositeIconSizes[1].evaluate(Bi,{},xt)],(iu[0]>od||iu[1]>od)&&vo(`${un.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),un.addSymbols(un.icon,Ja,iu,Ne,V,Bi,!1,Rn,Wt,fr.lineStartIndex,fr.lineLength,-1,Ht,xt),Qi=un.icon.placedSymbolArray.length-1,Hv&&(q=4*Hv.length,un.addSymbols(un.icon,Hv,iu,Ne,V,Bi,Ma.vertical,Rn,Wt,fr.lineStartIndex,fr.lineLength,-1,Ht,xt),To=un.icon.placedSymbolArray.length-1)}for(const Hs in hi.horizontal){const hs=hi.horizontal[Hs];Er||(jv=Bc(hs.text),B?tu=y_(hs):Er=Pm(wi,ld,Wt,ao,J,mo,hs,jn,Zn.layout.get("text-rotate").evaluate(Bi,{},xt),ko));const Ja=1===hs.positionedLines.length;if(Hx+=Tv(un,Rn,Wt,hs,Fn,Zn,B,Bi,ko,fr,hi.vertical?Ma.horizontal:Ma.horizontalOnly,Ja?Object.keys(hi.horizontal):[Hs],Qa,Qi,xn,Ht,xt),Ja)break}hi.vertical&&(or+=Tv(un,Rn,Wt,hi.vertical,Fn,Zn,B,Bi,ko,fr,Ma.vertical,["vertical"],Qa,To,xn,Ht,xt));let nu=-1;const A_=(Hs,hs)=>Hs?Math.max(Hs,hs):hs;nu=A_(tu,nu),nu=A_(Ch,nu),nu=A_(qp,nu);const $x=nu>-1?1:0;un.glyphOffsetArray.length>=Qc.MAX_GLYPHS&&vo("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Bi.sortKey&&un.addToSortKeyRanges(un.symbolInstances.length,Bi.sortKey),un.symbolInstances.emplaceBack(ld.x,ld.y,ld.z,Wt.x,Wt.y,Qa.right>=0?Qa.right:-1,Qa.center>=0?Qa.center:-1,Qa.left>=0?Qa.left:-1,Qa.vertical>=0?Qa.vertical:-1,Qi,To,jv,void 0!==Er?Er:un.collisionBoxArray.length,void 0!==Er?Er+1:un.collisionBoxArray.length,void 0!==Oe?Oe:un.collisionBoxArray.length,void 0!==Oe?Oe+1:un.collisionBoxArray.length,void 0!==mr?mr:un.collisionBoxArray.length,void 0!==mr?mr+1:un.collisionBoxArray.length,gr||un.collisionBoxArray.length,gr?gr+1:un.collisionBoxArray.length,ao,Hx,or,Zp,q,$x,0,I_,k_,nu)}(c,jt,qt,ct,u,p,_,It,c.layers[0],c.collisionBoxArray,a.index,a.sourceLayerIndex,c.index,Ae,Qe,D,0,Ee,pt,te,a,v,M,O,N)};if("line"===st)for(const ct of bv(a.geometry,0,0,Un,Un)){const jt=p2(ct,we,et,u.vertical||se,p,24,pe,c.overscaling,Un);for(const Dn of jt)se&&Ev(c,se.text,at,Dn)||At(ct,Dn,N)}else if("line-center"===st){for(const ct of a.geometry)if(ct.length>1){const jt=xT(ct,et,u.vertical||se,p,24,pe);jt&&At(ct,jt,N)}}else if("Polygon"===a.type)for(const ct of Y0(a.geometry,0)){const jt=ET(ct,16);At(ct[0],new Kc(jt.x,jt.y,0,0,void 0),N)}else if("LineString"===a.type)for(const ct of a.geometry)At(ct,new Kc(ct[0].x,ct[0].y,0,0,void 0),N);else if("Point"===a.type)for(const ct of a.geometry)for(const jt of ct)At([jt],new Kc(jt.x,jt.y,0,0,void 0),N)}const od=32640;function Tv(c,a,u,p,_,v,w,E,D,M,O,N,U,G,K,te,se){const _e=function(we,Ae,Ee,et,Qe,pt,st,at){const yt=[];if(0===Ae.positionedLines.length)return yt;const vt=et.layout.get("text-rotate").evaluate(pt,{})*Math.PI/180,It=function(qt){const un=qt[0],Wt=qt[1],Rn=un*Wt;return Rn>0?[un,-Wt]:Rn<0?[-un,Wt]:0===un?[Wt,un]:[Wt,-un]}(Ee);let At=Math.abs(Ae.top-Ae.bottom);for(const qt of Ae.positionedLines)At-=qt.lineOffset;const ct=Ae.positionedLines.length,jt=At/ct;let Dn=Ae.top-Ee[1];for(let qt=0;qt<ct;++qt){const un=Ae.positionedLines[qt];Dn=f2(Ae,jt,Dn,qt);for(const Wt of un.positionedGlyphs){if(!Wt.rect)continue;const Rn=Wt.rect||{};let bi=4,hi=!0,ui=1,Fn=0;if(Wt.imageName){const Ht=st[Wt.imageName];if(!Ht)continue;if(Ht.sdf){vo("SDF images are not supported in formatted text and will be ignored.");continue}hi=!1,ui=Ht.pixelRatio,bi=1/ui}const Yi=(Qe||at)&&Wt.vertical,Zn=Wt.metrics.advance*Wt.scale/2,wi=Wt.metrics,ao=Wt.rect;if(null===ao)continue;at&&Ae.verticalizable&&(Fn=Wt.imageName?Zn-Wt.metrics.width*Wt.scale/2:0);const J=Qe?[Wt.x+Zn,Wt.y]:[0,0];let mo=[0,0],jn=[0,0],B=!1;Qe||(Yi?(jn=[Wt.x+Zn+It[0],Wt.y+It[1]-Fn],B=!0):mo=[Wt.x+Zn+Ee[0],Wt.y+Ee[1]-Fn]);const ko=ao.w*Wt.scale/(ui*(Wt.localGlyph?2:1)),Hr=ao.h*Wt.scale/(ui*(Wt.localGlyph?2:1));let F,V,Ne,Bi;if(Yi){const Ht=Wt.y-Dn,xt=new Ue(-Zn,Zn-Ht),fr=-Math.PI/2,Er=new Ue(...jn);F=new Ue(-Zn+mo[0],mo[1]),F._rotateAround(fr,xt)._add(Er),F.x+=-Ht+Zn,F.y-=(wi.left-bi)*Wt.scale;const mr=Wt.imageName?wi.advance*Wt.scale:ir*Wt.scale,Oe=String.fromCharCode(Wt.glyph);pT(Oe)?F.x+=(1-bi)*Wt.scale:yh(Oe)?F.x+=mr-wi.height*Wt.scale+(-bi-1)*Wt.scale:F.x+=Wt.imageName||wi.width+2*bi===ao.w&&wi.height+2*bi===ao.h?(mr-Hr)/2:(mr-(wi.height+2*bi)*Wt.scale)/2,V=new Ue(F.x,F.y-ko),Ne=new Ue(F.x+Hr,F.y),Bi=new Ue(F.x+Hr,F.y-ko)}else{const Ht=(wi.left-bi)*Wt.scale-Zn+mo[0],xt=(-wi.top-bi)*Wt.scale+mo[1],fr=Ht+ko,Er=xt+Hr;F=new Ue(Ht,xt),V=new Ue(fr,xt),Ne=new Ue(Ht,Er),Bi=new Ue(fr,Er)}if(vt){let Ht;Ht=Qe?new Ue(0,0):B?new Ue(It[0],It[1]):new Ue(Ee[0],Ee[1]),F._rotateAround(vt,Ht),V._rotateAround(vt,Ht),Ne._rotateAround(vt,Ht),Bi._rotateAround(vt,Ht)}const xn=new Ue(0,0),In=new Ue(0,0);yt.push({tl:F,tr:V,bl:Ne,br:Bi,tex:Rn,writingMode:Ae.writingMode,glyphOffset:J,sectionIndex:Wt.sectionIndex,isSDF:hi,pixelOffsetTL:xn,pixelOffsetBR:In,minFontScaleX:0,minFontScaleY:0})}}return yt}(0,p,D,v,w,E,_,c.allowVerticalPlacement),De=c.textSizeData;let pe=null;"source"===De.kind?(pe=[Jl*v.layout.get("text-size").evaluate(E,{},se)],pe[0]>od&&vo(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===De.kind&&(pe=[Jl*K.compositeTextSizes[0].evaluate(E,{},se),Jl*K.compositeTextSizes[1].evaluate(E,{},se)],(pe[0]>od||pe[1]>od)&&vo(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,_e,pe,D,w,E,O,a,u,M.lineStartIndex,M.lineLength,G,te,se);for(const we of N)U[we]=c.text.placedSymbolArray.length-1;return 4*_e.length}function Ix(c){for(const a in c)return c[a];return null}function Pm(c,a,u,p,_,v,w,E,D,M){let O=w.top,N=w.bottom,U=w.left,G=w.right;const K=w.collisionPadding;if(K&&(U-=K[0],O-=K[1],G+=K[2],N+=K[3]),D){const te=new Ue(U,O),se=new Ue(G,O),_e=new Ue(U,N),De=new Ue(G,N),pe=bt(D);let we=new Ue(0,0);M&&(we=new Ue(M[0],M[1])),te._rotateAround(pe,we),se._rotateAround(pe,we),_e._rotateAround(pe,we),De._rotateAround(pe,we),U=Math.min(te.x,se.x,_e.x,De.x),G=Math.max(te.x,se.x,_e.x,De.x),O=Math.min(te.y,se.y,_e.y,De.y),N=Math.max(te.y,se.y,_e.y,De.y)}return c.emplaceBack(a.x,a.y,a.z,u.x,u.y,U,O,G,N,E,p,_,v),c.length-1}function y_(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const a=c.bottom-c.top;return a>0?Math.max(10,a):null}function Ev(c,a,u,p){const _=c.compareText;if(a in _){const v=_[a];for(let w=v.length-1;w>=0;w--)if(p.dist(v[w])<u)return!0}else _[a]=[];return _[a].push(p),!1}function MT(c,a){const u=c.fovAboveCenter,p=c.elevation?c.elevation.getMinElevationBelowMSL()*a:0,_=(c._camera.position[2]*c.worldSize-p)/Math.cos(c._pitch),v=Math.sin(u)*_/Math.sin(Math.max(Math.PI/2-c._pitch-u,.01)),w=Math.sin(c._pitch)*v+_;return Math.min(1.01*w,_*(1/c._horizonShift))}function Yc(c,a){if(!a.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:a};const u=Math.pow(2,-c.z),p=c.x*u,_=(c.x+1)*u,v=c.y*u,w=(c.y+1)*u,E=na(p),D=na(_),M=Qr(v),O=Qr(w),N=a.project(E,M),U=a.project(D,M),G=a.project(D,O),K=a.project(E,O);let te=Math.min(N.x,U.x,G.x,K.x),se=Math.min(N.y,U.y,G.y,K.y),_e=Math.max(N.x,U.x,G.x,K.x),De=Math.max(N.y,U.y,G.y,K.y);const pe=u/16;function we(Ee,et,Qe,pt,st,at){const yt=(Qe+st)/2,vt=(pt+at)/2,It=a.project(na(yt),Qr(vt)),At=Math.max(0,te-It.x,se-It.y,It.x-_e,It.y-De);te=Math.min(te,It.x),_e=Math.max(_e,It.x),se=Math.min(se,It.y),De=Math.max(De,It.y),At>pe&&(we(Ee,It,Qe,pt,yt,vt),we(It,et,yt,vt,st,at))}we(N,U,p,v,_,v),we(U,G,_,v,_,w),we(G,K,_,w,p,w),we(K,N,p,w,p,v),te-=pe,se-=pe,_e+=pe,De+=pe;const Ae=1/Math.max(_e-te,De-se);return{scale:Ae,x:te*Ae,y:se*Ae,x2:_e*Ae,y2:De*Ae,projection:a}}const IT=Ca(new Float32Array(16));class vh{constructor(a){this.spec=a,this.name=a.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(a,u){return{x:0,y:0,z:0}}unproject(a,u){return new Mi(0,0)}projectTilePoint(a,u,p){return{x:a,y:u,z:0}}locationPoint(a,u,p=!0){return a._coordinatePoint(a.locationCoordinate(u),p)}pixelsPerMeter(a,u){return Da(1,a)*u}pixelSpaceConversion(a,u,p){return 1}farthestPixelDistance(a){return MT(a,a.pixelsPerMeter)}pointCoordinate(a,u,p,_){const v=a.horizonLineFromTop(!1),w=new Ue(u,Math.max(v,p));return a.rayIntersectionCoordinate(a.pointRayIntersection(w,_))}pointCoordinate3D(a,u,p){const _=new Ue(u,p);if(a.elevation)return a.elevation.pointCoordinate(_);{const v=this.pointCoordinate(a,_.x,_.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(a,u){if(a.elevation)return!this.pointCoordinate3D(a,u.x,u.y);const p=a.horizonLineFromTop();return u.y<p}createInversionMatrix(a,u){return IT}createTileMatrix(a,u,p){let _,v,w;const E=p.canonical,D=Ca(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=Yc(E,this);_=1,v=M.x+p.wrap*M.scale,w=M.y,rh(D,D,[_/M.scale,_/M.scale,a.pixelsPerMeter/u])}else _=u/a.zoomScale(E.z),v=(E.x+Math.pow(2,E.z)*p.wrap)*_,w=E.y*_;return ql(D,D,[v,w,0]),rh(D,D,[_/Un,_/Un,1]),D}upVector(a,u,p){return[0,0,1]}upVectorScale(a,u,p){return{metersToTile:1}}}class be extends vh{constructor(a){super(a),this.range=[4,7],this.center=a.center||[-96,37.5];const[u,p]=this.parallels=a.parallels||[29.5,45.5],_=Math.sin(bt(u));this.n=(_+Math.sin(bt(p)))/2,this.c=1+_*(2*this.n-_),this.r0=Math.sqrt(this.c)/this.n}project(a,u){const{n:p,c:_,r0:v}=this,w=bt(a-this.center[0]),E=bt(u),D=Math.sqrt(_-2*p*Math.sin(E))/p;return{x:D*Math.sin(w*p),y:D*Math.cos(w*p)-v,z:0}}unproject(a,u){const{n:p,c:_,r0:v}=this,w=v+u;let E=Math.atan2(a,Math.abs(w))*Math.sign(w);w*p<0&&(E-=Math.PI*Math.sign(a)*Math.sign(w));const D=bt(this.center[0])*p;E=lr(E,-Math.PI-D,Math.PI-D);const M=Bn(Ot(E/p)+this.center[0],-180,180),O=Math.asin(Bn((_-(a*a+w*w)*p*p)/(2*p),-1,1)),N=Bn(Ot(O),-Jr,Jr);return new Mi(M,N)}}const bh=1.340264,Om=-.081106,jp=893e-6,Rm=.003796,v_=Math.sqrt(3)/2;class b_ extends vh{project(a,u){u=u/180*Math.PI,a=a/180*Math.PI;const p=Math.asin(v_*Math.sin(u)),_=p*p,v=_*_*_;return{x:.5*(a*Math.cos(p)/(v_*(bh+3*Om*_+v*(7*jp+9*Rm*_)))/Math.PI+.5),y:1-.5*(p*(bh+Om*_+v*(jp+Rm*_))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let p=u=(2*(1-u)-1)*Math.PI,_=p*p,v=_*_*_;for(let O,N,U,G=0;G<12&&(N=p*(bh+Om*_+v*(jp+Rm*_))-u,U=bh+3*Om*_+v*(7*jp+9*Rm*_),O=N/U,p=Bn(p-O,-Math.PI/3,Math.PI/3),_=p*p,v=_*_*_,!(Math.abs(O)<1e-12));++G);const w=v_*a*(bh+3*Om*_+v*(7*jp+9*Rm*_))/Math.cos(p),E=Math.asin(Math.sin(p)/v_),D=Bn(180*w/Math.PI,-180,180),M=Bn(180*E/Math.PI,-Jr,Jr);return new Mi(D,M)}}class Hp extends vh{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){return{x:.5+a/360,y:.5-u/360,z:0}}unproject(a,u){const p=360*(a-.5),_=Bn(360*(.5-u),-Jr,Jr);return new Mi(p,_)}}const rd=Math.PI/2;function sd(c){return Math.tan((rd+c)/2)}class Sv extends vh{constructor(a){super(a),this.center=a.center||[0,30];const[u,p]=this.parallels=a.parallels||[30,30];let _=bt(u),v=bt(p);this.southernCenter=_+v<0,this.southernCenter&&(_=-_,v=-v);const w=Math.cos(_),E=sd(_);this.n=_===v?Math.sin(_):Math.log(w/Math.cos(v))/Math.log(sd(v)/E),this.f=w*Math.pow(sd(_),this.n)/this.n}project(a,u){u=bt(u),this.southernCenter&&(u=-u),a=bt(a-this.center[0]);const p=1e-6,{n:_,f:v}=this;v>0?u<-rd+p&&(u=-rd+p):u>rd-p&&(u=rd-p);const w=v/Math.pow(sd(u),_);let E=w*Math.sin(_*a),D=v-w*Math.cos(_*a);return E=.5*(E/Math.PI+.5),D=.5*(D/Math.PI+.5),{x:E,y:this.southernCenter?D:1-D,z:0}}unproject(a,u){a=(2*a-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:p,f:_}=this,v=_-u,w=Math.sign(v),E=Math.sign(p)*Math.sqrt(a*a+v*v);let D=Math.atan2(a,Math.abs(v))*w;v*p<0&&(D-=Math.PI*Math.sign(a)*w);const M=Bn(Ot(D/p)+this.center[0],-180,180),O=Bn(Ot(2*Math.atan(Math.pow(_/E,1/p))-rd),-Jr,Jr);return new Mi(M,this.southernCenter?-O:O)}}class Lm extends vh{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(a,u){return{x:wl(a),y:Vs(u),z:0}}unproject(a,u){const p=na(a),_=Qr(u);return new Mi(p,_)}}const Dv=bt(Jr);class Mv extends vh{project(a,u){const p=(u=bt(u))*u,_=p*p;return{x:.5*((a=bt(a))*(.8707-.131979*p+_*(_*(.003971*p-.001529*_)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+p*(.015085+_*(.028874*p-.044475-.005916*_)))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let p=u=(2*(1-u)-1)*Math.PI,_=25,v=0,w=p*p;do{w=p*p;const M=w*w;v=(p*(1.007226+w*(.015085+M*(.028874*w-.044475-.005916*M)))-u)/(1.007226+w*(.045255+M*(.259866*w-.311325-.005916*11*M))),p=Bn(p-v,-Dv,Dv)}while(Math.abs(v)>1e-6&&--_>0);w=p*p;const E=Bn(Ot(a/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),D=Ot(p);return new Mi(E,D)}}const x_=bt(Jr);class Iv extends vh{project(a,u){u=bt(u),a=bt(a);const p=Math.cos(u),_=2/Math.PI,v=Math.acos(p*Math.cos(a/2)),w=Math.sin(v)/v,E=.5*(a*_+2*p*Math.sin(a/2)/w)||0,D=.5*(u+Math.sin(u)/w)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(D/Math.PI+1),z:0}}unproject(a,u){let p=a=(2*a-.5)*Math.PI,_=u=(2*(1-u)-1)*Math.PI,v=25;const w=1e-6;let E=0,D=0;do{const M=Math.cos(_),O=Math.sin(_),N=2*O*M,U=O*O,G=M*M,K=Math.cos(p/2),te=Math.sin(p/2),se=2*K*te,_e=te*te,De=1-G*K*K,pe=De?1/De:0,we=De?Math.acos(M*K)*Math.sqrt(1/De):0,Ae=.5*(2*we*M*te+2*p/Math.PI)-a,Ee=.5*(we*O+_)-u,et=.5*pe*(G*_e+we*M*K*U)+1/Math.PI,Qe=pe*(se*N/4-we*O*te),pt=.125*pe*(N*te-we*O*G*se),st=.5*pe*(U*K+we*_e*M)+.5,at=Qe*pt-st*et;E=(Ee*Qe-Ae*st)/at,D=(Ae*pt-Ee*et)/at,p=Bn(p-E,-Math.PI,Math.PI),_=Bn(_-D,-x_,x_)}while((Math.abs(E)>w||Math.abs(D)>w)&&--v>0);return new Mi(Ot(p),Ot(_))}}class kv extends vh{constructor(a){super(a),this.center=a.center||[0,0],this.parallels=a.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(bt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){const{scale:p,cosPhi:_}=this;return{x:bt(a)*_*p+.5,y:-Math.sin(bt(u))/_*p+.5,z:0}}unproject(a,u){const{scale:p,cosPhi:_}=this,v=-(u-.5)/p,w=Bn(Ot((a-.5)/p)/_,-180,180),E=Math.asin(Bn(v*_,-1,1)),D=Bn(Ot(E),-Jr,Jr);return new Mi(w,D)}}class Av extends Lm{constructor(a){super(a),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(a,u,p){const _=tm(a,u,p);return Bo(_,_,Tp(Xl(p))),{x:_[0],y:_[1],z:_[2]}}locationPoint(a,u){const p=dh(u.lat,u.lng),_=Vr([],p),v=a.elevation?a.elevation.getAtPointOrZero(a.locationCoordinate(u),a._centerAltitude):a._centerAltitude;Jf(p,p,_,Da(1,0)*Un*v);const w=Ca(new Float64Array(16));return Yu(w,a.pixelMatrix,a.globeMatrix),Bo(p,p,w),new Ue(p[0],p[1])}pixelsPerMeter(a,u){return Da(1,0)*u}pixelSpaceConversion(a,u,p){const _=Da(1,a)*u,v=Si(Da(1,45)*u,_,p);return this.pixelsPerMeter(a,u)/v}createTileMatrix(a,u,p){const _=Uy(Xl(p.canonical));return Yu(new Float64Array(16),a.globeMatrix,_)}createInversionMatrix(a,u){const{center:p}=a,_=Tp(Xl(u));return Qu(_,_,bt(p.lng)),Vg(_,_,bt(p.lat)),rh(_,_,[a._pixelsPerMercatorPixel,a._pixelsPerMercatorPixel,1]),Float32Array.from(_)}pointCoordinate(a,u,p,_){return P0(a,u,p,!0)||new Sp(0,0)}pointCoordinate3D(a,u,p){const _=this.pointCoordinate(a,u,p,0);return[_.x,_.y,_.z]}isPointAboveHorizon(a,u){return!P0(a,u.x,u.y,!1)}farthestPixelDistance(a){const u=function(_,v){const w=_.cameraToCenterDistance,E=_._centerAltitude*v,D=_._camera,M=_._camera.forward(),O=Ju([],Ta([],M,-w),[0,0,E]),N=_.worldSize/(2*Math.PI),U=[0,0,-N],G=_.width/_.height,K=Math.tan(_.fovAboveCenter),te=Ta([],D.up(),K),se=Ta([],D.right(),K*G),_e=Vr([],Ju([],Ju([],M,te),se)),De=[];let pe;if(new Gg(O,_e).closestPointOnSphere(U,N,De)){const we=Ju([],De,U),Ae=Zl([],we,O);pe=Math.cos(_.fovAboveCenter)*Uc(Ae)}else{const we=Zl([],O,U),Ae=Zl([],U,O);Vr(Ae,Ae);const Ee=Uc(we)-N;pe=Math.sqrt(Ee*(Ee+2*N));const et=Math.acos(pe/(N+Ee))-Math.acos(Ea(M,Ae));pe*=Math.cos(et)}return 1.01*pe}(a,this.pixelsPerMeter(a.center.lat,a.worldSize)),p=Ep(a.zoom);if(p>0){const _=MT(a,Da(1,a.center.lat)*a.worldSize),v=a.worldSize/(2*Math.PI),w=Math.max(a.width,a.height)/a.worldSize*Math.PI;return Si(u,_+v*(1-Math.cos(w)),Math.pow(p,10))}return u}upVector(a,u,p){return tm(u,p,a,1)}upVectorScale(a){return{metersToTile:Zg(nm(Xl(a)))}}}function kx(c){const a=c.parallels,u=!!a&&Math.abs(a[0]+a[1])<.01;switch(c.name){case"mercator":return new Lm(c);case"equirectangular":return new Hp(c);case"naturalEarth":return new Mv(c);case"equalEarth":return new b_(c);case"winkelTripel":return new Iv(c);case"albers":return u?new kv(c):new be(c);case"lambertConformalConic":return u?new kv(c):new Sv(c);case"globe":return new Av(c)}throw new Error(`Invalid projection name: ${c.name}`)}const kT=s_.types,Ax=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function w_(c,a,u,p,_,v,w,E,D,M,O,N,U){const G=E?Math.min(od,Math.round(E[0])):0,K=E?Math.min(od,Math.round(E[1])):0;c.emplaceBack(a,u,Math.round(32*p),Math.round(32*_),v,w,(G<<1)+(D?1:0),K,16*M,16*O,256*N,256*U)}function Fm(c,a,u,p,_,v,w){c.emplaceBack(a,u,p,_,v,w)}function zm(c,a,u,p,_){c.emplaceBack(a,u,p,_),c.emplaceBack(a,u,p,_),c.emplaceBack(a,u,p,_),c.emplaceBack(a,u,p,_)}function AT(c){for(const a of c.sections)if(Q(a.text))return!0;return!1}class Pv{constructor(a){this.layoutVertexArray=new yl,this.indexArray=new Yr,this.programConfigurations=a,this.segments=new Ko,this.dynamicLayoutVertexArray=new Xi,this.opacityVertexArray=new co,this.placedSymbolArray=new T0,this.globeExtVertexArray=new Ni}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(a,u,p,_){this.isEmpty()||(p&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,uv.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,hx.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,Ax,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,cT.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||_)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}ln(Pv,"SymbolBuffers");class js{constructor(a,u,p){this.layoutVertexArray=new a,this.layoutAttributes=u,this.indexArray=new p,this.segments=new Ko,this.collisionVertexArray=new uo,this.collisionVertexArrayExt=new wr}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,uT.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,px.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ln(js,"CollisionBuffers");class Qc{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(w=>w.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ca([]),this.placementViewportMatrix=Ca([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=id(this.zoom,u["text-size"]),this.iconSizeData=id(this.zoom,u["icon-size"]);const p=this.layers[0].layout,_=p.get("symbol-sort-key"),v=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==v&&void 0!==_.constantOr(1),this.sortFeaturesByY=("viewport-y"===v||"auto"===v&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(w=>Ma[w]),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=a.sourceID,this.projection=a.projection}createArrays(){this.text=new Pv(new oh(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new Pv(new oh(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new E0,this.lineVertexArray=new My,this.symbolInstances=new Fg}calculateGlyphDependencies(a,u,p,_,v){for(let w=0;w<a.length;w++)if(u[a.charCodeAt(w)]=!0,_&&v){const E=Em[a.charAt(w)];E&&(u[E.charCodeAt(0)]=!0)}}populate(a,u,p,_){const v=this.layers[0],w=v.layout,E="globe"===this.projection.name,D=w.get("text-font"),M=w.get("text-field"),O=w.get("icon-image"),N=("constant"!==M.value.kind||M.value.value instanceof Zo&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&("constant"!==D.value.kind||D.value.value.length>0),U="constant"!==O.value.kind||!!O.value.value||Object.keys(O.parameters).length>0,G=w.get("symbol-sort-key");if(this.features=[],!N&&!U)return;const K=u.iconDependencies,te=u.glyphDependencies,se=u.availableImages,_e=new $e(this.zoom);for(const{feature:De,id:pe,index:we,sourceLayerIndex:Ae}of a){const Ee=v._featureFilter.needGeometry,et=hh(De,Ee);if(!v._featureFilter.filter(_e,et,p))continue;if(Ee||(et.geometry=jc(De,p,_)),E&&1!==De.type&&p.z<=5){const at=et.geometry,yt=.98078528056,vt=(It,At)=>Ea(tm(It.x,It.y,p,1),tm(At.x,At.y,p,1))<yt;for(let It=0;It<at.length;It++)at[It]=B0(at[It],vt)}let Qe,pt;if(N){const at=v.getValueAndResolveTokens("text-field",et,p,se),yt=Zo.factory(at);AT(yt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Pe()||this.hasRTLText&&Le.isParsed())&&(Qe=jr(yt,v,et))}if(U){const at=v.getValueAndResolveTokens("icon-image",et,p,se);pt=at instanceof bs?at:bs.fromString(at)}if(!Qe&&!pt)continue;const st=this.sortFeaturesByKey?G.evaluate(et,{},p):void 0;if(this.features.push({id:pe,text:Qe,icon:pt,index:we,sourceLayerIndex:Ae,geometry:et.geometry,properties:De.properties,type:kT[De.type],sortKey:st}),pt&&(K[pt.name]=!0),Qe){const at=D.evaluate(et,{},p).join(","),yt="map"===w.get("text-rotation-alignment")&&"point"!==w.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ma.vertical)>=0;for(const vt of Qe.sections)if(vt.image)K[vt.image.name]=!0;else{const It=C(Qe.toString()),At=vt.fontStack||at,ct=te[At]=te[At]||{};this.calculateGlyphDependencies(vt.text,ct,yt,this.allowVerticalPlacement,It)}}}"line"===w.get("symbol-placement")&&(this.features=function(De){const pe={},we={},Ae=[];let Ee=0;function et(at){Ae.push(De[at]),Ee++}function Qe(at,yt,vt){const It=we[at];return delete we[at],we[yt]=It,Ae[It].geometry[0].pop(),Ae[It].geometry[0]=Ae[It].geometry[0].concat(vt[0]),It}function pt(at,yt,vt){const It=pe[yt];return delete pe[yt],pe[at]=It,Ae[It].geometry[0].shift(),Ae[It].geometry[0]=vt[0].concat(Ae[It].geometry[0]),It}function st(at,yt,vt){const It=vt?yt[0][yt[0].length-1]:yt[0][0];return`${at}:${It.x}:${It.y}`}for(let at=0;at<De.length;at++){const yt=De[at],vt=yt.geometry,It=yt.text?yt.text.toString():null;if(!It){et(at);continue}const At=st(It,vt),ct=st(It,vt,!0);if(At in we&&ct in pe&&we[At]!==pe[ct]){const jt=pt(At,ct,vt),Dn=Qe(At,ct,Ae[jt].geometry);delete pe[At],delete we[ct],we[st(It,Ae[Dn].geometry,!0)]=Dn,Ae[jt].geometry=null}else At in we?Qe(At,ct,vt):ct in pe?pt(At,ct,vt):(et(at),pe[At]=Ee-1,we[ct]=Ee-1)}return Ae.filter(at=>at.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((De,pe)=>De.sortKey-pe.sortKey)}update(a,u,p,_){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,u,this.layers,p,_),this.icon.programConfigurations.updatePaintArrays(a,u,this.layers,p,_))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=kx(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,u){const p=this.lineVertexArray.length;if(void 0!==a.segment)for(const{x:_,y:v}of u)this.lineVertexArray.emplaceBack(_,v);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(a,u,p,_,v,w,E,D,M,O,N,U,G,K){const te=a.indexArray,se=a.layoutVertexArray,_e=a.globeExtVertexArray,De=a.segments.prepareSegment(4*u.length,se,te,this.canOverlap?w.sortKey:void 0),pe=this.glyphOffsetArray.length,we=De.vertexLength,Ae=this.allowVerticalPlacement&&E===Ma.vertical?Math.PI/2:0,Ee=w.text&&w.text.sections;for(let Qe=0;Qe<u.length;Qe++){const{tl:pt,tr:st,bl:at,br:yt,tex:vt,pixelOffsetTL:It,pixelOffsetBR:At,minFontScaleX:ct,minFontScaleY:jt,glyphOffset:Dn,isSDF:qt,sectionIndex:un}=u[Qe],Wt=De.vertexLength,Rn=Dn[1];if(w_(se,M.x,M.y,pt.x,Rn+pt.y,vt.x,vt.y,p,qt,It.x,It.y,ct,jt),w_(se,M.x,M.y,st.x,Rn+st.y,vt.x+vt.w,vt.y,p,qt,At.x,It.y,ct,jt),w_(se,M.x,M.y,at.x,Rn+at.y,vt.x,vt.y+vt.h,p,qt,It.x,At.y,ct,jt),w_(se,M.x,M.y,yt.x,Rn+yt.y,vt.x+vt.w,vt.y+vt.h,p,qt,At.x,At.y,ct,jt),D){const{x:bi,y:hi,z:ui}=D.anchor,[Fn,Yi,Zn]=D.up;Fm(_e,bi,hi,ui,Fn,Yi,Zn),Fm(_e,bi,hi,ui,Fn,Yi,Zn),Fm(_e,bi,hi,ui,Fn,Yi,Zn),Fm(_e,bi,hi,ui,Fn,Yi,Zn),zm(a.dynamicLayoutVertexArray,bi,hi,ui,Ae)}else zm(a.dynamicLayoutVertexArray,M.x,M.y,M.z,Ae);te.emplaceBack(Wt,Wt+1,Wt+2),te.emplaceBack(Wt+1,Wt+2,Wt+3),De.vertexLength+=4,De.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Dn[0]),Qe!==u.length-1&&un===u[Qe+1].sectionIndex||a.programConfigurations.populatePaintArrays(se.length,w,w.index,{},G,K,Ee&&Ee[un])}const et=D?D.anchor:M;a.placedSymbolArray.emplaceBack(et.x,et.y,et.z,M.x,M.y,pe,this.glyphOffsetArray.length-pe,we,O,N,M.segment,p?p[0]:0,p?p[1]:0,_[0],_[1],E,0,!1,0,U,0)}_commitLayoutVertex(a,u,p,_,v,w,E){a.emplaceBack(u,p,_,v,w,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(a,u,p,_,v,w,E){const D=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),M=D.vertexLength,O=E.tileAnchorX,N=E.tileAnchorY;for(let G=0;G<4;G++)p.collisionVertexArray.emplaceBack(0,0,0,0);p.collisionVertexArrayExt.emplaceBack(u,-a.padding,-a.padding),p.collisionVertexArrayExt.emplaceBack(u,a.padding,-a.padding),p.collisionVertexArrayExt.emplaceBack(u,a.padding,a.padding),p.collisionVertexArrayExt.emplaceBack(u,-a.padding,a.padding),this._commitLayoutVertex(p.layoutVertexArray,_,v,w,O,N,new Ue(a.x1,a.y1)),this._commitLayoutVertex(p.layoutVertexArray,_,v,w,O,N,new Ue(a.x2,a.y1)),this._commitLayoutVertex(p.layoutVertexArray,_,v,w,O,N,new Ue(a.x2,a.y2)),this._commitLayoutVertex(p.layoutVertexArray,_,v,w,O,N,new Ue(a.x1,a.y2)),D.vertexLength+=4;const U=p.indexArray;U.emplaceBack(M,M+1),U.emplaceBack(M+1,M+2),U.emplaceBack(M+2,M+3),U.emplaceBack(M+3,M),D.primitiveLength+=4}_addTextDebugCollisionBoxes(a,u,p,_,v,w){for(let E=_;E<v;E++){const D=p.get(E),M=this.getSymbolInstanceTextSize(a,w,u,E);this._addCollisionDebugVertices(D,M,this.textCollisionBox,D.projectedAnchorX,D.projectedAnchorY,D.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(a,u,p,_,v,w){for(let E=_;E<v;E++){const D=p.get(E),M=this.getSymbolInstanceIconSize(a,u,w.placedIconSymbolIndex);this._addCollisionDebugVertices(D,M,this.iconCollisionBox,D.projectedAnchorX,D.projectedAnchorY,D.projectedAnchorZ,w)}}generateCollisionDebugBuffers(a,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new js(Io,dT.members,xa),this.iconCollisionBox=new js(Io,dT.members,xa);const p=Lp(this.iconSizeData,a),_=Lp(this.textSizeData,a);for(let v=0;v<this.symbolInstances.length;v++){const w=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(_,a,u,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(_,a,u,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(p,a,u,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(p,a,u,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(a,u,p,_){const v=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:_),w=si(this.textSizeData,a,v)/ir;return this.tilePixelRatio*w}getSymbolInstanceIconSize(a,u,p){const _=this.icon.placedSymbolArray.get(p),v=si(this.iconSizeData,a,_);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(a,u,p){a.emplaceBack(u,-p,-p),a.emplaceBack(u,p,-p),a.emplaceBack(u,p,p),a.emplaceBack(u,-p,p)}_updateTextDebugCollisionBoxes(a,u,p,_,v,w){for(let E=_;E<v;E++){const D=p.get(E),M=this.getSymbolInstanceTextSize(a,w,u,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,D.padding)}}_updateIconDebugCollisionBoxes(a,u,p,_,v,w){for(let E=_;E<v;E++){const D=p.get(E),M=this.getSymbolInstanceIconSize(a,u,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,D.padding)}}updateCollisionDebugBuffers(a,u){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=Lp(this.iconSizeData,a),_=Lp(this.textSizeData,a);for(let v=0;v<this.symbolInstances.length;v++){const w=this.symbolInstances.get(v);this._updateTextDebugCollisionBoxes(_,a,u,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(_,a,u,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(p,a,u,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(p,a,u,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,u,p,_,v,w,E,D,M){const O={};if(u<p){const{x1:N,y1:U,x2:G,y2:K,padding:te,projectedAnchorX:se,projectedAnchorY:_e,projectedAnchorZ:De,tileAnchorX:pe,tileAnchorY:we,featureIndex:Ae}=a.get(u);O.textBox={x1:N,y1:U,x2:G,y2:K,padding:te,projectedAnchorX:se,projectedAnchorY:_e,projectedAnchorZ:De,tileAnchorX:pe,tileAnchorY:we},O.textFeatureIndex=Ae}if(_<v){const{x1:N,y1:U,x2:G,y2:K,padding:te,projectedAnchorX:se,projectedAnchorY:_e,projectedAnchorZ:De,tileAnchorX:pe,tileAnchorY:we,featureIndex:Ae}=a.get(_);O.verticalTextBox={x1:N,y1:U,x2:G,y2:K,padding:te,projectedAnchorX:se,projectedAnchorY:_e,projectedAnchorZ:De,tileAnchorX:pe,tileAnchorY:we},O.verticalTextFeatureIndex=Ae}if(w<E){const{x1:N,y1:U,x2:G,y2:K,padding:te,projectedAnchorX:se,projectedAnchorY:_e,projectedAnchorZ:De,tileAnchorX:pe,tileAnchorY:we,featureIndex:Ae}=a.get(w);O.iconBox={x1:N,y1:U,x2:G,y2:K,padding:te,projectedAnchorX:se,projectedAnchorY:_e,projectedAnchorZ:De,tileAnchorX:pe,tileAnchorY:we},O.iconFeatureIndex=Ae}if(D<M){const{x1:N,y1:U,x2:G,y2:K,padding:te,projectedAnchorX:se,projectedAnchorY:_e,projectedAnchorZ:De,tileAnchorX:pe,tileAnchorY:we,featureIndex:Ae}=a.get(D);O.verticalIconBox={x1:N,y1:U,x2:G,y2:K,padding:te,projectedAnchorX:se,projectedAnchorY:_e,projectedAnchorZ:De,tileAnchorX:pe,tileAnchorY:we},O.verticalIconFeatureIndex=Ae}return O}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,u){const p=a.placedSymbolArray.get(u),_=p.vertexStartIndex+4*p.numGlyphs;for(let v=p.vertexStartIndex;v<_;v+=4)a.indexArray.emplaceBack(v,v+1,v+2),a.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const u=Math.sin(a),p=Math.cos(a),_=[],v=[],w=[];for(let E=0;E<this.symbolInstances.length;++E){w.push(E);const D=this.symbolInstances.get(E);_.push(0|Math.round(u*D.tileAnchorX+p*D.tileAnchorY)),v.push(D.featureIndex)}return w.sort((E,D)=>_[E]-_[D]||v[D]-v[E]),w}addToSortKeyRanges(a,u){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===u?p.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const p=this.symbolInstances.get(u);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:_,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:M}=p;_>=0&&this.addIndicesForPlacedSymbol(this.text,_),v>=0&&v!==_&&this.addIndicesForPlacedSymbol(this.text,v),w>=0&&w!==v&&w!==_&&this.addIndicesForPlacedSymbol(this.text,w),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}ln(Qc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Qc.MAX_GLYPHS=65535,Qc.addDynamicAttributes=zm;const PT=new Pt({"symbol-placement":new je(gt.layout_symbol["symbol-placement"]),"symbol-spacing":new je(gt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new je(gt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new lt(gt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new je(gt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new je(gt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new je(gt.layout_symbol["icon-ignore-placement"]),"icon-optional":new je(gt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new je(gt.layout_symbol["icon-rotation-alignment"]),"icon-size":new lt(gt.layout_symbol["icon-size"]),"icon-text-fit":new je(gt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new je(gt.layout_symbol["icon-text-fit-padding"]),"icon-image":new lt(gt.layout_symbol["icon-image"]),"icon-rotate":new lt(gt.layout_symbol["icon-rotate"]),"icon-padding":new je(gt.layout_symbol["icon-padding"]),"icon-keep-upright":new je(gt.layout_symbol["icon-keep-upright"]),"icon-offset":new lt(gt.layout_symbol["icon-offset"]),"icon-anchor":new lt(gt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new je(gt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new je(gt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new je(gt.layout_symbol["text-rotation-alignment"]),"text-field":new lt(gt.layout_symbol["text-field"]),"text-font":new lt(gt.layout_symbol["text-font"]),"text-size":new lt(gt.layout_symbol["text-size"]),"text-max-width":new lt(gt.layout_symbol["text-max-width"]),"text-line-height":new lt(gt.layout_symbol["text-line-height"]),"text-letter-spacing":new lt(gt.layout_symbol["text-letter-spacing"]),"text-justify":new lt(gt.layout_symbol["text-justify"]),"text-radial-offset":new lt(gt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new je(gt.layout_symbol["text-variable-anchor"]),"text-anchor":new lt(gt.layout_symbol["text-anchor"]),"text-max-angle":new je(gt.layout_symbol["text-max-angle"]),"text-writing-mode":new je(gt.layout_symbol["text-writing-mode"]),"text-rotate":new lt(gt.layout_symbol["text-rotate"]),"text-padding":new je(gt.layout_symbol["text-padding"]),"text-keep-upright":new je(gt.layout_symbol["text-keep-upright"]),"text-transform":new lt(gt.layout_symbol["text-transform"]),"text-offset":new lt(gt.layout_symbol["text-offset"]),"text-allow-overlap":new je(gt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new je(gt.layout_symbol["text-ignore-placement"]),"text-optional":new je(gt.layout_symbol["text-optional"])});var Px={paint:new Pt({"icon-opacity":new lt(gt.paint_symbol["icon-opacity"]),"icon-color":new lt(gt.paint_symbol["icon-color"]),"icon-halo-color":new lt(gt.paint_symbol["icon-halo-color"]),"icon-halo-width":new lt(gt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new lt(gt.paint_symbol["icon-halo-blur"]),"icon-translate":new je(gt.paint_symbol["icon-translate"]),"icon-translate-anchor":new je(gt.paint_symbol["icon-translate-anchor"]),"text-opacity":new lt(gt.paint_symbol["text-opacity"]),"text-color":new lt(gt.paint_symbol["text-color"],{runtimeType:Ks,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new lt(gt.paint_symbol["text-halo-color"]),"text-halo-width":new lt(gt.paint_symbol["text-halo-width"]),"text-halo-blur":new lt(gt.paint_symbol["text-halo-blur"]),"text-translate":new je(gt.paint_symbol["text-translate"]),"text-translate-anchor":new je(gt.paint_symbol["text-translate-anchor"])}),layout:PT};class C_{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:xc,this.defaultValue=a}evaluate(a){if(a.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(a.formattedSection))return u.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ln(C_,"FormatSectionOverride",{omit:["defaultValue"]});class Nm extends Gl{constructor(a){super(a,Px)}recalculate(a,u){super.recalculate(a,u),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const _=[];for(const v of p)_.indexOf(v)<0&&_.push(v);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(a,u,p,_){const v=this.layout.get(a).evaluate(u,{},p,_),w=this._unevaluatedLayout._values[a];return w.isDataDriven()||Vu(w.value)||!v?v:(E=u.properties,v.replace(/{([^{}]+)}/g,(M,O)=>O in E?String(E[O]):""));var E}createBucket(a){return new Qc(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const a of Px.paint.overridableProperties){if(!Nm.hasPaintOverride(this.layout,a))continue;const u=this.paint.get(a),p=new C_(u),_=new Ff(p,u.property.specification);let v=null;v="constant"===u.value.kind||"source"===u.value.kind?new zf("source",_):new ju("composite",_,u.value.zoomStops,u.value._interpolationType),this.paint._values[a]=new kt(u.property,v,u.parameters)}}_handleOverridablePaintPropertyUpdate(a,u,p){return!(!this.layout||u.isDataDriven()||p.isDataDriven())&&Nm.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,u){const p=a.get("text-field"),_=Px.paint.properties[u];let v=!1;const w=E=>{for(const D of E)if(_.overrides&&_.overrides.hasOverride(D))return void(v=!0)};if("constant"===p.value.kind&&p.value.value instanceof Zo)w(p.value.value.sections);else if("source"===p.value.kind){const E=M=>{v||(M instanceof Fd&&cr(M.value)===xi?w(M.value.sections):M instanceof Zh?w(M.sections):M.eachChild(E))},D=p.value;D._styleExpression&&E(D._styleExpression.expression)}return v}getProgramConfiguration(a){return new Za(this,a)}}var OT={paint:new Pt({"background-color":new je(gt.paint_background["background-color"]),"background-pattern":new je(gt.paint_background["background-pattern"]),"background-opacity":new je(gt.paint_background["background-opacity"])})},RT={paint:new Pt({"raster-opacity":new je(gt.paint_raster["raster-opacity"]),"raster-hue-rotate":new je(gt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new je(gt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new je(gt.paint_raster["raster-brightness-max"]),"raster-saturation":new je(gt.paint_raster["raster-saturation"]),"raster-contrast":new je(gt.paint_raster["raster-contrast"]),"raster-resampling":new je(gt.paint_raster["raster-resampling"]),"raster-fade-duration":new je(gt.paint_raster["raster-fade-duration"])})};class LT extends Gl{constructor(a){super(a,{}),this.implementation=a}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}var Ox={paint:new Pt({"sky-type":new je(gt.paint_sky["sky-type"]),"sky-atmosphere-sun":new je(gt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new je(gt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new je(gt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new je(gt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Mt(gt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new je(gt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new je(gt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new je(gt.paint_sky["sky-opacity"])})};function Ov(c,a,u){const p=[0,0,1],_=zC([]);return BC(_,_,u?-bt(c)+Math.PI:bt(c)),NC(_,_,-bt(a)),OC(p,p,_),Vr(p,p)}const FT={circle:class extends Gl{constructor(c){super(c,dm)}createBucket(c){return new Hc(c)}queryRadius(c){const a=c;return Gc("circle-radius",this,a)+Gc("circle-stroke-width",this,a)+um(this.paint.get("circle-translate"))}queryIntersectsFeature(c,a,u,p,_,v,w,E){const D=t_(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(a,u)+this.paint.get("circle-stroke-width").evaluate(a,u);return j0(c,p,v,w,E,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),D,M)}getProgramIds(){return["circle"]}getProgramConfiguration(c){return new Za(this,c)}},heatmap:class extends Gl{createBucket(c){return new Qy(c)}constructor(c){super(c,GC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){"heatmap-color"===c&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=G0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Gc("heatmap-radius",this,c)}queryIntersectsFeature(c,a,u,p,_,v,w,E){const D=this.paint.get("heatmap-radius").evaluate(a,u);return j0(c,p,v,w,E,!0,!0,new Ue(0,0),D)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(c){return new Za(this,c)}},hillshade:class extends Gl{constructor(c){super(c,WC)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Gl{constructor(c){super(c,c2)}getProgramIds(){const c=this.paint.get("fill-pattern"),a=c&&c.constantOr(1),u=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getProgramConfiguration(c){return new Za(this,c)}recalculate(c,a){super.recalculate(c,a);const u=this.paint._values["fill-outline-color"];"constant"===u.value.kind&&void 0===u.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new Pp(c)}queryRadius(){return um(this.paint.get("fill-translate"))}queryIntersectsFeature(c,a,u,p,_,v){return!c.queryGeometry.isAboveHorizon&&U0(e_(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}},"fill-extrusion":class extends Gl{constructor(c){super(c,sT)}createBucket(c){return new Op(c)}queryRadius(){return um(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(c){return new Za(this,c)}queryIntersectsFeature(c,a,u,p,_,v,w,E,D){const M=t_(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),O=this.paint.get("fill-extrusion-height").evaluate(a,u),N=this.paint.get("fill-extrusion-base").evaluate(a,u),U=[0,0],G=E&&v.elevation,K=v.elevation?v.elevation.exaggeration():1,te=c.tile.getBucket(this);if(G&&te instanceof Op){const we=te.centroidVertexArray,Ae=D+1;Ae<we.length&&(U[0]=we.geta_centroid_pos0(Ae),U[1]=we.geta_centroid_pos1(Ae))}if(0===U[0]&&1===U[1])return!1;"globe"===v.projection.name&&(p=rT([p],[new Ue(0,0),new Ue(Un,Un)],c.tileID.canonical).map(we=>we.polygon).flat());const se=G?E:null,[_e,De]=(Ae=p,Ee=N,et=O,Qe=M,pt=w,st=se,at=U,yt=K,vt=v.center.lat,"globe"===(we=v).projection.name?function(At,ct,jt,Dn,qt,un,Wt,Rn,bi,hi,ui){const Fn=[],Yi=[],Zn=At.projection.upVectorScale(ui,At.center.lat,At.worldSize).metersToTile,wi=[0,0,0,1],ao=[0,0,0,1],J=(jn,B,ko,Hr)=>{jn[0]=B,jn[1]=ko,jn[2]=Hr,jn[3]=1},mo=c_();jt>0&&(jt+=mo),Dn+=mo;for(const jn of ct){const B=[],ko=[];for(const Hr of jn){const F=Hr.x+qt.x,V=Hr.y+qt.y,Ne=At.projection.projectTilePoint(F,V,ui),Bi=At.projection.upVector(ui,Hr.x,Hr.y);let xn=jt,In=Dn;if(Wt){const Ht=d_(F,V,jt,Dn,Wt,Rn,bi,hi);xn+=Ht.base,In+=Ht.top}0!==jt?J(wi,Ne.x+Bi[0]*Zn*xn,Ne.y+Bi[1]*Zn*xn,Ne.z+Bi[2]*Zn*xn):J(wi,Ne.x,Ne.y,Ne.z),J(ao,Ne.x+Bi[0]*Zn*In,Ne.y+Bi[1]*Zn*In,Ne.z+Bi[2]*Zn*In),Bo(wi,wi,un),Bo(ao,ao,un),B.push(new td(wi[0],wi[1],wi[2])),ko.push(new td(ao[0],ao[1],ao[2]))}Fn.push(B),Yi.push(ko)}return[Fn,Yi]}(we,Ae,Ee,et,Qe,pt,st,at,yt,vt,c.tileID.canonical):st?function(At,ct,jt,Dn,qt,un,Wt,Rn,bi){const hi=[],ui=[],Fn=[0,0,0,1];for(const Yi of At){const Zn=[],wi=[];for(const ao of Yi){const J=ao.x+Dn.x,mo=ao.y+Dn.y,jn=d_(J,mo,ct,jt,un,Wt,Rn,bi);Fn[0]=J,Fn[1]=mo,Fn[2]=jn.base,Fn[3]=1,Cp(Fn,Fn,qt),Fn[3]=Math.max(Fn[3],1e-5);const B=new td(Fn[0]/Fn[3],Fn[1]/Fn[3],Fn[2]/Fn[3]);Fn[0]=J,Fn[1]=mo,Fn[2]=jn.top,Fn[3]=1,Cp(Fn,Fn,qt),Fn[3]=Math.max(Fn[3],1e-5);const ko=new td(Fn[0]/Fn[3],Fn[1]/Fn[3],Fn[2]/Fn[3]);Zn.push(B),wi.push(ko)}hi.push(Zn),ui.push(wi)}return[hi,ui]}(Ae,Ee,et,Qe,pt,st,at,yt,vt):function(At,ct,jt,Dn,qt){const un=[],Wt=[],Rn=qt[8]*ct,bi=qt[9]*ct,hi=qt[10]*ct,ui=qt[11]*ct,Fn=qt[8]*jt,Yi=qt[9]*jt,Zn=qt[10]*jt,wi=qt[11]*jt;for(const ao of At){const J=[],mo=[];for(const jn of ao){const B=jn.x+Dn.x,ko=jn.y+Dn.y,Hr=qt[0]*B+qt[4]*ko+qt[12],F=qt[1]*B+qt[5]*ko+qt[13],V=qt[2]*B+qt[6]*ko+qt[14],Ne=qt[3]*B+qt[7]*ko+qt[15],Bi=Hr+Rn,xn=F+bi,In=V+hi,Ht=Math.max(Ne+ui,1e-5),xt=Hr+Fn,fr=F+Yi,Er=V+Zn,mr=Math.max(Ne+wi,1e-5);J.push(new td(Bi/Ht,xn/Ht,In/Ht)),mo.push(new td(xt/mr,fr/mr,Er/mr))}un.push(J),Wt.push(mo)}return[un,Wt]}(Ae,Ee,et,Qe,pt)),pe=c.queryGeometry;var we,Ae,Ee,et,Qe,pt,st,at,yt,vt;return function(we,Ae,Ee){let et=1/0;U0(Ee,Ae)&&(et=ax(Ee,Ae[0]));for(let Qe=0;Qe<Ae.length;Qe++){const pt=Ae[Qe],st=we[Qe];for(let at=0;at<pt.length-1;at++){const yt=pt[at],vt=[yt,pt[at+1],st[at+1],st[at],yt];qy(Ee,vt)&&(et=Math.min(et,ax(Ee,vt)))}}return et!==1/0&&et}(_e,De,pe.isPointQuery()?pe.screenBounds:pe.screenGeometry)}},line:class extends Gl{constructor(c){super(c,cx),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if("line-gradient"===c){const a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof Pu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,a){super.recalculate(c,a),this.paint._values["line-floorwidth"]=ux.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new Cm(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(c){return new Za(this,c)}queryRadius(c){const a=c,u=dx(Gc("line-width",this,a),Gc("line-gap-width",this,a)),p=Gc("line-offset",this,a);return u/2+Math.abs(p)+um(this.paint.get("line-translate"))}queryIntersectsFeature(c,a,u,p,_,v){if(c.queryGeometry.isAboveHorizon)return!1;const w=e_(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),E=c.pixelToTileUnitsFactor/2*dx(this.paint.get("line-width").evaluate(a,u),this.paint.get("line-gap-width").evaluate(a,u)),D=this.paint.get("line-offset").evaluate(a,u);return D&&(p=function(M,O){const N=[],U=new Ue(0,0);for(let G=0;G<M.length;G++){const K=M[G],te=[];for(let se=0;se<K.length;se++){const De=K[se],pe=K[se+1],we=0===se?U:De.sub(K[se-1])._unit()._perp(),Ae=se===K.length-1?U:pe.sub(De)._unit()._perp(),Ee=we._add(Ae)._unit();Ee._mult(1/(Ee.x*Ae.x+Ee.y*Ae.y)),te.push(Ee._mult(O)._add(De))}N.push(te)}return N}(p,D*c.pixelToTileUnitsFactor)),function(M,O,N){for(let U=0;U<O.length;U++){const G=O[U];if(M.length>=3)for(let K=0;K<G.length;K++)if($c(M,G[K]))return!0;if(s2(M,G,N))return!0}return!1}(w,p,E)}isTileClipped(){return!0}},symbol:Nm,background:class extends Gl{constructor(c){super(c,OT)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Gl{constructor(c){super(c,RT)}getProgramIds(){return["raster"]}},sky:class extends Gl{constructor(c){super(c,Ox),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){"sky-gradient"===c?this._updateColorRamp():"sky-atmosphere-sun"!==c&&"sky-atmosphere-halo-color"!==c&&"sky-atmosphere-color"!==c&&"sky-atmosphere-sun-intensity"!==c||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=G0({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const a=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}return!1}getCenter(c,a){if("atmosphere"===this.paint.get("sky-type")){const p=this.paint.get("sky-atmosphere-sun"),_=!p,v=c.style.light,w=v.properties.get("position");return _&&"viewport"===v.properties.get("anchor")&&vo("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),_?Ov(w.azimuthal,90-w.polar,a):Ov(p[0],90-p[1],a)}const u=this.paint.get("sky-gradient-center");return Ov(u[0],90-u[1],a)}is3D(){return!1}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return"atmosphere"===c?["skyboxCapture","skybox"]:"gradient"===c?["skyboxGradient"]:null}}};class xh{constructor(a,u,p,_){this.context=a,this.format=p,this.texture=a.gl.createTexture(),this.update(u,_)}update(a,u,p){const{width:_,height:v}=a,{context:w}=this,{gl:E}=w,{HTMLImageElement:D,HTMLCanvasElement:M,HTMLVideoElement:O,ImageData:N,ImageBitmap:U}=re;if(E.bindTexture(E.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!u||!1!==u.premultiply)),p||this.size&&this.size[0]===_&&this.size[1]===v){const{x:G,y:K}=p||{x:0,y:0};a instanceof D||a instanceof M||a instanceof O||a instanceof N||U&&a instanceof U?E.texSubImage2D(E.TEXTURE_2D,0,G,K,E.RGBA,E.UNSIGNED_BYTE,a):E.texSubImage2D(E.TEXTURE_2D,0,G,K,_,v,E.RGBA,E.UNSIGNED_BYTE,a.data)}else this.size=[_,v],a instanceof D||a instanceof M||a instanceof O||a instanceof N||U&&a instanceof U?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,a):E.texImage2D(E.TEXTURE_2D,0,this.format,_,v,0,this.format,E.UNSIGNED_BYTE,a.data);this.useMipmap=Boolean(u&&u.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&E.generateMipmap(E.TEXTURE_2D)}bind(a,u){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),a!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,a),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?a===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_NEAREST:a),this.filter=a),u!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,u),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class zT{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class NT{constructor(){this.tasks={},this.taskQueue=[],ma(["process"],this),this.invoker=new zT(this.process),this.nextId=0}add(a,u){const p=this.nextId++,_=function({type:v,isSymbolTile:w,zoom:E}){return E=E||0,"message"===v?0:"maybePrepare"!==v||w?"parseTile"!==v||w?"parseTile"===v&&w?300-E:"maybePrepare"===v&&w?400-E:500:200-E:100-E}(u);if(0===_){La();try{a()}finally{}return{cancel:()=>{}}}return this.tasks[p]={fn:a,metadata:u,priority:_,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){La();try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const a=this.pick();if(null===a)return;const u=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let a=null,u=1/0;for(let _=0;_<this.taskQueue.length;_++){const v=this.tasks[this.taskQueue[_]];v.priority<u&&(u=v.priority,a=_)}if(null===a)return null;const p=this.taskQueue[a];return this.taskQueue.splice(a,1),p}remove(){this.invoker.remove()}}class Rx{constructor(a){this._stringToNumber={},this._numberToString=[];for(let u=0;u<a.length;u++){const p=a[u];this._stringToNumber[p]=u,this._numberToString[u]=p}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}const BT=["tile","layer","source","sourceLayer","state"];class Lx{constructor(a,u,p,_,v){this.type="Feature",this._vectorTileFeature=a,this._z=u,this._x=p,this._y=_,this.properties=a.properties,this.id=v}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(a.id=this.id);for(const u of BT)void 0!==this[u]&&(a[u]=this[u]);return a}}const pr=32,Xa=33,ad=new Uint16Array(8184);for(let c=0;c<2046;c++){let a=c+2,u=0,p=0,_=0,v=0,w=0,E=0;for(1&a?_=v=w=pr:u=p=E=pr;(a>>=1)>1;){const M=u+_>>1,O=p+v>>1;1&a?(_=u,v=p,u=w,p=E):(u=_,p=v,_=w,v=E),w=M,E=O}const D=4*c;ad[D+0]=u,ad[D+1]=p,ad[D+2]=_,ad[D+3]=v}const tc=new Uint16Array(2178),Jc=new Uint8Array(1089),T_=new Uint16Array(1089);function Fx(c){return 0===c?-.03125:32===c?.03125:0}var zx=bn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const E_={type:2,extent:Un,loadGeometry:()=>[[new Ue(0,0),new Ue(8193,0),new Ue(8193,8193),new Ue(0,8193),new Ue(0,0)]]};class Rv{constructor(a,u,p,_,v){this.tileID=a,this.uid=Pl(),this.uses=0,this.tileSize=u,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,this.expiredRequestCount=0,this.state="loading",_&&_.transform&&(this.projection=_.transform.projection)}registerFadeDuration(a){const u=a+this.timeAdded;u<Ri.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Yc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,u,p){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(_,v){const w={};if(!v)return w;for(const E of _){const D=E.layerIds.map(M=>v.getLayer(M)).filter(Boolean);if(0!==D.length){E.layers=D,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(M=>D.filter(O=>O.id===M)[0]));for(const M of D)w[M.id]=E}}return w}(a.buckets,u.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const v=this.buckets[_];if(v instanceof Qc){if(this.hasSymbolBuckets=!0,!p)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const v=this.buckets[_];if(v instanceof Qc&&v.hasRTLText){this.hasRTLText=!0,Le.isLoading()||Le.isLoaded()||"deferred"!==Pe()||ke();break}}this.queryPadding=0;for(const _ in this.buckets){const v=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(_).queryRadius(v))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas)}else this.collisionBoxArray=new Lg}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(a){return this.buckets[a.id]}upload(a){for(const p in this.buckets){const _=this.buckets[p];_.uploadPending()&&_.upload(a)}const u=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new xh(a,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new xh(a,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new xh(a,this.lineAtlas.image,u.ALPHA),this.lineAtlas.uploaded=!0)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,u,p,_,v,w,E,D){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:_,pixelPosMatrix:E,transform:w,params:v,tileTransform:this.tileTransform},a,u,p):{}}querySourceFeatures(a,u){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const _=p.loadVTLayers(),v=u?u.sourceLayer:"",w=_._geojsonTileLayer||_[v];if(!w)return;const E=Nf(u&&u.filter),{z:D,x:M,y:O}=this.tileID.canonical,N={z:D,x:M,y:O};for(let U=0;U<w.length;U++){const G=w.feature(U);if(E.needGeometry){const se=hh(G,!0);if(!E.filter(new $e(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!E.filter(new $e(this.tileID.overscaledZ),G))continue;const K=p.getId(G,v),te=new Lx(G,D,M,O,K);te.tile=N,a.push(te)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const u=this.expirationTime;if(a.cacheControl){const p=yc(a.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const p=Date.now();let _=!1;if(this.expirationTime>p)_=!1;else if(u)if(this.expirationTime<u)_=!0;else{const v=this.expirationTime-u;v?this.expirationTime=p+Math.max(v,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(a,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(a).length||!u)return;const p=this.latestFeatureIndex.loadVTLayers(),_=u.style.listImages();for(const v in this.buckets){if(!u.style.hasLayer(v))continue;const w=this.buckets[v],E=w.layers[0].sourceLayer||"_geojsonTileLayer",D=p[E],M=a[E];if(!D||!M||0===Object.keys(M).length)continue;if(w.update(M,D,_,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof Cm||w instanceof Pp){const N=u.style._getSourceCache(w.layers[0].source);u._terrain&&u._terrain.enabled&&N&&w.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(N.id,this.tileID)}const O=u&&u.style&&u.style.getLayer(v);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(w)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ri.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=Ri.now()+a}setTexture(a,u){const p=u.context,_=p.gl;this.texture=this.texture||u.getTileTexture(a.width),this.texture?this.texture.update(a,{useMipmap:!0}):(this.texture=new xh(p,a,_.RGBA,{useMipmap:!0}),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE),p.extTextureFilterAnisotropic&&_.texParameterf(_.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax))}setDependencies(a,u){const p={};for(const _ of u)p[_]=!0;this.dependencies[a]=p}hasDependency(a,u){for(const p of a){const _=this.dependencies[p];if(_)for(const v of u)if(_[v])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,u){if(!u||"mercator"===u.name||this._tileDebugBuffer)return;const p=jc(E_,this.tileID.canonical,this.tileTransform)[0],_=new Tn,v=new Ss;for(let w=0;w<p.length;w++){const{x:E,y:D}=p[w];_.emplaceBack(E,D),v.emplaceBack(w)}v.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(v),this._tileDebugBuffer=a.createVertexBuffer(_,ah.members),this._tileDebugSegments=Ko.simpleSegment(0,0,_.length,v.length)}_makeTileBoundsBuffers(a,u){if(this._tileBoundsBuffer||!u||"mercator"===u.name)return;const p=jc(E_,this.tileID.canonical,this.tileTransform)[0];let _,v;if(this.isRaster){const w=function(E,D){const M=Yc(E,D),O=Math.pow(2,E.z);for(let se=0;se<Xa;se++)for(let _e=0;_e<Xa;_e++){const De=na((E.x+(_e+Fx(_e))/pr)/O),pe=Qr((E.y+(se+Fx(se))/pr)/O),we=D.project(De,pe),Ae=se*Xa+_e;tc[2*Ae+0]=Math.round((we.x*M.scale-M.x)*Un),tc[2*Ae+1]=Math.round((we.y*M.scale-M.y)*Un)}Jc.fill(0),T_.fill(0);for(let se=2045;se>=0;se--){const _e=4*se,De=ad[_e+0],pe=ad[_e+1],we=ad[_e+2],Ae=ad[_e+3],Ee=De+we>>1,et=pe+Ae>>1,Qe=Ee+et-pe,pt=et+De-Ee,st=pe*Xa+De,at=Ae*Xa+we,yt=et*Xa+Ee,vt=Math.hypot((tc[2*st+0]+tc[2*at+0])/2-tc[2*yt+0],(tc[2*st+1]+tc[2*at+1])/2-tc[2*yt+1])>=16;Jc[yt]=Jc[yt]||(vt?1:0),se<1022&&(Jc[yt]=Jc[yt]||Jc[(pe+pt>>1)*Xa+(De+Qe>>1)]||Jc[(Ae+pt>>1)*Xa+(we+Qe>>1)])}const N=new Gi,U=new Yr;let G=0;function K(se,_e){const De=_e*Xa+se;return 0===T_[De]&&(N.emplaceBack(tc[2*De+0],tc[2*De+1],se*Un/pr,_e*Un/pr),T_[De]=++G),T_[De]-1}function te(se,_e,De,pe,we,Ae){const Ee=se+De>>1,et=_e+pe>>1;if(Math.abs(se-we)+Math.abs(_e-Ae)>1&&Jc[et*Xa+Ee])te(we,Ae,se,_e,Ee,et),te(De,pe,we,Ae,Ee,et);else{const Qe=K(se,_e),pt=K(De,pe),st=K(we,Ae);U.emplaceBack(Qe,pt,st)}}return te(0,0,pr,pr,pr,0),te(pr,pr,0,0,0,pr),{vertices:N,indices:U}}(this.tileID.canonical,u);_=w.vertices,v=w.indices}else{_=new Gi,v=new Yr;for(const{x:E,y:D}of p)_.emplaceBack(E,D,0,0);const w=ph(_.int16,void 0,4);for(let E=0;E<w.length;E+=3)v.emplaceBack(w[E],w[E+1],w[E+2])}this._tileBoundsBuffer=a.createVertexBuffer(_,zx.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(v),this._tileBoundsSegments=Ko.simpleSegment(0,0,_.length,v.length)}_makeGlobeTileDebugBuffers(a,u){const p=u.projection;if(!p||"globe"!==p.name||u.freezeTileCoverage)return;const _=this.tileID.canonical,v=Tp(Kg(_,u)),w=Ep(u.zoom);let E;w>0&&(E=Wl(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,_,u,v,E,w),this._makeGlobeTileDebugTextBuffer(a,_,u,v,E,w)}_globePoint(a,u,p,_,v,w,E){let D=tm(a,u,p);if(w){const M=1<<p.z,O=wl(_.center.lng),N=Vs(_.center.lat),U=(p.x+.5)/M-O;let G=0;U>.5?G=-1:U<-.5&&(G=1);let K=(a/Un+p.x)/M+G,te=(u/Un+p.y)/M;K=(K-O)*_._pixelsPerMercatorPixel+O,te=(te-N)*_._pixelsPerMercatorPixel+N;const se=[K*_.worldSize,te*_.worldSize,0];Bo(se,se,w),D=Tr(D,se,E)}return Bo(D,D,v)}_makeGlobeTileDebugBorderBuffer(a,u,p,_,v,w){const E=new Tn,D=new Ss,M=new $i,O=(U,G,K,te,se)=>{const _e=(K-U)/(se-1),De=(te-G)/(se-1),pe=E.length;for(let we=0;we<se;we++){const Ae=U+we*_e,Ee=G+we*De;E.emplaceBack(Ae,Ee);const et=this._globePoint(Ae,Ee,u,p,_,v,w);M.emplaceBack(et[0],et[1],et[2]),D.emplaceBack(pe+we)}},N=Un;O(0,0,N,0,16),O(N,0,N,N,16),O(N,N,0,N,16),O(0,N,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(D),this._tileDebugBuffer=a.createVertexBuffer(E,ah.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(M,zy.members),this._tileDebugSegments=Ko.simpleSegment(0,0,E.length,D.length)}_makeGlobeTileDebugTextBuffer(a,u,p,_,v,w){const E=new Tn,D=new Yr,M=new $i,O=25;D.reserve(32),E.reserve(O),M.reserve(O);const N=(U,G)=>O*U+G;for(let U=0;U<O;U++){const G=2048*U;for(let K=0;K<O;K++){const te=2048*K;E.emplaceBack(te,G);const se=this._globePoint(te,G,u,p,_,v,w);M.emplaceBack(se[0],se[1],se[2])}}for(let U=0;U<4;U++)for(let G=0;G<4;G++){const K=N(U,G),te=N(U,G+1),se=N(U+1,G),_e=N(U+1,G+1);D.emplaceBack(K,te,se),D.emplaceBack(se,te,_e)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(D),this._tileDebugTextBuffer=a.createVertexBuffer(E,ah.members),this._globeTileDebugTextBuffer=a.createVertexBuffer(M,zy.members),this._tileDebugTextSegments=Ko.simpleSegment(0,0,O,32)}}class VT{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,u,p){const _=String(u);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][_]=this.stateChanges[a][_]||{},Jn(this.stateChanges[a][_],p),null===this.deletedStates[a]){this.deletedStates[a]={};for(const v in this.state[a])v!==_&&(this.deletedStates[a][v]=null)}else if(this.deletedStates[a]&&null===this.deletedStates[a][_]){this.deletedStates[a][_]={};for(const v in this.state[a][_])p[v]||(this.deletedStates[a][_][v]=null)}else for(const v in p)this.deletedStates[a]&&this.deletedStates[a][_]&&null===this.deletedStates[a][_][v]&&delete this.deletedStates[a][_][v]}removeFeatureState(a,u,p){if(null===this.deletedStates[a])return;const _=String(u);if(this.deletedStates[a]=this.deletedStates[a]||{},p&&void 0!==u)null!==this.deletedStates[a][_]&&(this.deletedStates[a][_]=this.deletedStates[a][_]||{},this.deletedStates[a][_][p]=null);else if(void 0!==u)if(this.stateChanges[a]&&this.stateChanges[a][_])for(p in this.deletedStates[a][_]={},this.stateChanges[a][_])this.deletedStates[a][_][p]=null;else this.deletedStates[a][_]=null;else this.deletedStates[a]=null}getState(a,u){const p=String(u),_=Jn({},(this.state[a]||{})[p],(this.stateChanges[a]||{})[p]);if(null===this.deletedStates[a])return{};if(this.deletedStates[a]){const v=this.deletedStates[a][u];if(null===v)return{};for(const w in v)delete _[w]}return _}initializeTileState(a,u){a.setFeatureState(this.state,u)}coalesceChanges(a,u){const p={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const v={};for(const w in this.stateChanges[_])this.state[_][w]||(this.state[_][w]={}),Jn(this.state[_][w],this.stateChanges[_][w]),v[w]=this.state[_][w];p[_]=v}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const v={};if(null===this.deletedStates[_])for(const w in this.state[_])v[w]={},this.state[_][w]={};else for(const w in this.deletedStates[_]){if(null===this.deletedStates[_][w])this.state[_][w]={};else if(this.state[_][w])for(const E of Object.keys(this.deletedStates[_][w]))delete this.state[_][w][E];v[w]=this.state[_][w]}p[_]=p[_]||{},Jn(p[_],v)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(p).length)for(const _ in a)a[_].setFeatureState(p,u)}}class Bm{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,u){const p=this.toIdx(a,u);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(a,u){return this.leaves[this.toIdx(a,u)]}toIdx(a,u){return u*this.size+a}}function S_(c,a,u,p){let _=0,v=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(p[w])<1e-15){if(u[w]<c[w]||u[w]>a[w])return null}else{const E=1/p[w];let D=(c[w]-u[w])*E,M=(a[w]-u[w])*E;if(D>M){const O=D;D=M,M=O}if(D>_&&(_=D),M<v&&(v=M),_>v)return null}return _}function Vm(c,a,u,p,_,v,w,E,D,M,O){const N=p-c,U=_-a,G=v-u,K=w-c,te=E-a,se=D-u,_e=O[1]*se-O[2]*te,De=O[2]*K-O[0]*se,pe=O[0]*te-O[1]*K,we=N*_e+U*De+G*pe;if(Math.abs(we)<1e-15)return null;const Ae=1/we,Ee=M[0]-c,et=M[1]-a,Qe=M[2]-u,pt=(Ee*_e+et*De+Qe*pe)*Ae;if(pt<0||pt>1)return null;const st=et*G-Qe*U,at=Qe*N-Ee*G,yt=Ee*U-et*N,vt=(O[0]*st+O[1]*at+O[2]*yt)*Ae;return vt<0||pt+vt>1?null:(K*st+te*at+se*yt)*Ae}function UT(c,a,u){return(c-a)/(u-a)}function D_(c,a,u,p,_,v,w,E,D){const M=1<<u,O=v-p,N=w-_,U=(c+1)/M*O+p,G=(a+0)/M*N+_,K=(a+1)/M*N+_;E[0]=(c+0)/M*O+p,E[1]=G,D[0]=U,D[1]=K}class jT{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(v){const w=Math.ceil(Math.log2(v.dim/8)),E=[];let D=Math.ceil(Math.pow(2,w));const M=1/D,O=(G,K,te,se,_e)=>{const De=se?1:0,pe=(G+1)*te-De,we=K*te,Ae=(K+1)*te-De;_e[0]=G*te,_e[1]=we,_e[2]=pe,_e[3]=Ae};let N=new Bm(D);const U=[];for(let G=0;G<D*D;G++){O(G%D,Math.floor(G/D),M,!1,U);const K=eu(U[0],U[1],v),te=eu(U[2],U[1],v),se=eu(U[2],U[3],v),_e=eu(U[0],U[3],v);N.minimums.push(Math.min(K,te,se,_e)),N.maximums.push(Math.max(K,te,se,_e)),N.leaves.push(1)}for(E.push(N),D/=2;D>=1;D/=2){const G=E[E.length-1];N=new Bm(D);for(let K=0;K<D*D;K++){O(K%D,Math.floor(K/D),2,!0,U);const te=G.getElevation(U[0],U[1]),se=G.getElevation(U[2],U[1]),_e=G.getElevation(U[2],U[3]),De=G.getElevation(U[0],U[3]),pe=G.isLeaf(U[0],U[1]),we=G.isLeaf(U[2],U[1]),Ae=G.isLeaf(U[2],U[3]),Ee=G.isLeaf(U[0],U[3]),et=Math.min(te.min,se.min,_e.min,De.min),Qe=Math.max(te.max,se.max,_e.max,De.max),pt=pe&&we&&Ae&&Ee;N.maximums.push(Qe),N.minimums.push(et),N.leaves.push(Qe-et<=5&&pt?1:0)}E.push(N)}return E}(this.dem),p=u.length-1,_=u[p];this._addNode(_.minimums[0],_.maximums[0],_.leaves[0]),this._construct(u,0,0,p,0)}raycastRoot(a,u,p,_,v,w,E=1){return S_([a,u,-100],[p,_,this.maximums[0]*E],v,w)}raycast(a,u,p,_,v,w,E=1){if(!this.nodeCount)return null;const D=this.raycastRoot(a,u,p,_,v,w,E);if(null==D)return null;const M=[],O=[],N=[],U=[],G=[{idx:0,t:D,nodex:0,nodey:0,depth:0}];for(;G.length>0;){const{idx:K,t:te,nodex:se,nodey:_e,depth:De}=G.pop();if(this.leaves[K]){D_(se,_e,De,a,u,p,_,N,U);const we=1<<De,Ae=(se+0)/we,Ee=(se+1)/we,et=(_e+0)/we,Qe=(_e+1)/we,pt=eu(Ae,et,this.dem)*E,st=eu(Ee,et,this.dem)*E,at=eu(Ee,Qe,this.dem)*E,yt=eu(Ae,Qe,this.dem)*E,vt=Vm(N[0],N[1],pt,U[0],N[1],st,U[0],U[1],at,v,w),It=Vm(U[0],U[1],at,N[0],U[1],yt,N[0],N[1],pt,v,w),At=Math.min(null!==vt?vt:Number.MAX_VALUE,null!==It?It:Number.MAX_VALUE);if(At!==Number.MAX_VALUE)return At;{const ct=Jf([],v,w,te);if(Lv(pt,st,yt,at,UT(ct[0],N[0],U[0]),UT(ct[1],N[1],U[1]))>=ct[2])return te}continue}let pe=0;for(let we=0;we<this._siblingOffset.length;we++){D_((se<<1)+this._siblingOffset[we][0],(_e<<1)+this._siblingOffset[we][1],De+1,a,u,p,_,N,U),N[2]=-100,U[2]=this.maximums[this.childOffsets[K]+we]*E;const Ae=S_(N,U,v,w);if(null!=Ae){const Ee=Ae;M[we]=Ee;let et=!1;for(let Qe=0;Qe<pe&&!et;Qe++)Ee>=M[O[Qe]]&&(O.splice(Qe,0,we),et=!0);et||(O[pe]=we),pe++}}for(let we=0;we<pe;we++){const Ae=O[we];G.push({idx:this.childOffsets[K]+Ae,t:M[Ae],nodex:(se<<1)+this._siblingOffset[Ae][0],nodey:(_e<<1)+this._siblingOffset[Ae][1],depth:De+1})}}return null}_addNode(a,u,p){return this.minimums.push(a),this.maximums.push(u),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(a,u,p,_,v){if(1===a[_].isLeaf(u,p))return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const w=_-1,E=a[w];let D=0,M=0;for(let O=0;O<this._siblingOffset.length;O++){const N=2*u+this._siblingOffset[O][0],U=2*p+this._siblingOffset[O][1],G=E.getElevation(N,U),K=E.isLeaf(N,U),te=this._addNode(G.min,G.max,K);K&&(D|=1<<O),M||(M=te)}for(let O=0;O<this._siblingOffset.length;O++)D&1<<O||this._construct(a,2*u+this._siblingOffset[O][0],2*p+this._siblingOffset[O][1],w,M+O)}}function Lv(c,a,u,p,_,v){return Si(Si(c,u,v),Si(a,p,v),_)}function eu(c,a,u){const p=u.dim,_=Bn(c*p-.5,0,p-1),v=Bn(a*p-.5,0,p-1),w=Math.floor(_),E=Math.floor(v),D=Math.min(w+1,p-1),M=Math.min(E+1,p-1);return Lv(u.get(w,E),u.get(D,E),u.get(w,M),u.get(D,M),_-w,v-E)}const Fv={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Um{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,u,p,_=!1,v=!1){if(this.uid=a,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(p&&"mapbox"!==p&&"terrarium"!==p)return vo(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const w=this.dim=u.height-2,E=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.encoding=p||"mapbox",this.borderReady=_,!_){for(let D=0;D<w;D++)E[this._idx(-1,D)]=E[this._idx(0,D)],E[this._idx(w,D)]=E[this._idx(w-1,D)],E[this._idx(D,-1)]=E[this._idx(D,0)],E[this._idx(D,w)]=E[this._idx(D,w-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(w,-1)]=E[this._idx(w-1,0)],E[this._idx(-1,w)]=E[this._idx(0,w-1)],E[this._idx(w,w)]=E[this._idx(w-1,w-1)],v&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new jT(this)}get(a,u,p=!1){p&&(a=Bn(a,-1,this.dim),u=Bn(u,-1,this.dim));const _=4*this._idx(a,u);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[_],this.pixels[_+1],this.pixels[_+2])}static getUnpackVector(a){return Fv[a]}get unpackVector(){return Fv[this.encoding]}_idx(a,u){if(a<-1||a>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(a+1)}_unpackMapbox(a,u,p){return(256*a*256+256*u+p)/10-1e4}_unpackTerrarium(a,u,p){return 256*a+u+p/256-32768}static pack(a,u){const p=[0,0,0,0],_=Um.getUnpackVector(u);let v=Math.floor((a+_[3])/_[2]);return p[2]=v%256,v=Math.floor(v/256),p[1]=v%256,v=Math.floor(v/256),p[0]=v,p}getPixels(){return new oa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(a,u,p){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let _=u*this.dim,v=u*this.dim+this.dim,w=p*this.dim,E=p*this.dim+this.dim;switch(u){case-1:_=v-1;break;case 1:v=_+1}switch(p){case-1:w=E-1;break;case 1:E=w+1}const D=-u*this.dim,M=-p*this.dim;for(let O=w;O<E;O++)for(let N=_;N<v;N++){const U=4*this._idx(N,O),G=4*this._idx(N+D,O+M);this.pixels[U+0]=a.pixels[G+0],this.pixels[U+1]=a.pixels[G+1],this.pixels[U+2]=a.pixels[G+2],this.pixels[U+3]=a.pixels[G+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}ln(Um,"DEMData"),ln(jT,"DemMinMaxQuadTree",{omit:["dem"]});class zv{constructor(a,u){this.max=a,this.onRemove=u,this.reset()}reset(){for(const a in this.data)for(const u of this.data[a])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(a,u,p){const _=a.wrapped().key;void 0===this.data[_]&&(this.data[_]=[]);const v={value:u,timeout:void 0};if(void 0!==p&&(v.timeout=setTimeout(()=>{this.remove(a,v)},p)),this.data[_].push(v),this.order.push(_),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const u=this.data[a].shift();return u.timeout&&clearTimeout(u.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),u.value}getByKey(a){const u=this.data[a];return u?u[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,u){if(!this.has(a))return this;const p=a.wrapped().key,_=void 0===u?0:this.data[p].indexOf(u),v=this.data[p][_];return this.data[p].splice(_,1),v.timeout&&clearTimeout(v.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(v.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(a){const u=[];for(const p in this.data)for(const _ of this.data[p])a(_.value)||u.push(_);for(const p of u)this.remove(p.value.tileID,p)}}class ra{constructor(a,u,p){this.func=a,this.mask=u,this.range=p}}ra.ReadOnly=!1,ra.ReadWrite=!0,ra.disabled=new ra(519,ra.ReadOnly,[0,1]);class Gp{constructor(a,u,p,_,v,w){this.test=a,this.ref=u,this.mask=p,this.fail=_,this.depthFail=v,this.pass=w}}Gp.disabled=new Gp({func:519,mask:0},0,0,7680,7680,7680);class sa{constructor(a,u,p){this.blendFunction=a,this.blendColor=u,this.mask=p}}sa.Replace=[1,0],sa.disabled=new sa(sa.Replace,qo.transparent,[!1,!1,!1,!1]),sa.unblended=new sa(sa.Replace,qo.transparent,[!0,!0,!0,!0]),sa.alphaBlended=new sa([1,771],qo.transparent,[!0,!0,!0,!0]);class Ya{constructor(a,u,p){this.enable=a,this.mode=u,this.frontFace=p}}Ya.disabled=new Ya(!1,1029,2305),Ya.backCCW=new Ya(!0,1029,2305),Ya.backCW=new Ya(!0,1029,2304),Ya.frontCW=new Ya(!0,1028,2304),Ya.frontCCW=new Ya(!0,1028,2305);class wh extends Ba{constructor(a,u,p){super(),this.id=a,this._onlySymbols=p,u.on("data",_=>{"source"===_.dataType&&"metadata"===_.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===_.dataType&&"content"===_.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new zv(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new VT,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(a){this.map=a,this._minTileCacheSize=void 0===this._minTileCacheSize&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const u=this._tiles[a];if("loaded"!==u.state&&"errored"!==u.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,u){return a.isSymbolTile=this._onlySymbols,this._source.loadTile(a,u)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a,()=>{})}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const p=this._tiles[u];p.upload(a),p.prepare(this.map.style.imageManager)}}getIds(){return Ps(this._tiles).map(a=>a.tileID).sort(Nx).map(a=>a.key)}getRenderableIds(a){const u=[];for(const p in this._tiles)this._isIdRenderable(+p,a)&&u.push(this._tiles[p]);return a?u.sort((p,_)=>{const v=p.tileID,w=_.tileID,E=new Ue(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),D=new Ue(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-w.overscaledZ||D.y-E.y||D.x-E.x}).map(p=>p.tileID.key):u.map(p=>p.tileID).sort(Nx).map(p=>p.key)}hasRenderableParent(a){const u=this.findLoadedParent(a,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(a,u){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(u||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)"errored"!==this._tiles[a].state&&this._reloadTile(+a,"reloading")}}_reloadTile(a,u){const p=this._tiles[a];p&&("loading"!==p.state&&(p.state=u),this._loadTile(p,this._tileLoaded.bind(this,p,a,u)))}_tileLoaded(a,u,p,_){if(_)if(a.state="errored",404!==_.status)this._source.fire(new ll(_,{tile:a}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform);else a.timeAdded=Ri.now(),"expired"===p&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(u,a),"raster-dem"===this._source.type&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new oo("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const u=this.getRenderableIds();for(let _=0;_<u.length;_++){const v=u[_];if(a.neighboringTiles&&a.neighboringTiles[v]){const w=this.getTileByID(v);p(a,w),p(w,a)}}function p(_,v){if(!_.dem||_.dem.borderReady)return;_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0;let w=v.tileID.canonical.x-_.tileID.canonical.x;const E=v.tileID.canonical.y-_.tileID.canonical.y,D=Math.pow(2,_.tileID.canonical.z),M=v.tileID.key;0===w&&0===E||Math.abs(E)>1||(Math.abs(w)>1&&(1===Math.abs(w+D)?w+=D:1===Math.abs(w-D)&&(w-=D)),v.dem&&_.dem&&(_.dem.backfillBorder(v.dem,w,E),_.neighboringTiles&&_.neighboringTiles[M]&&(_.neighboringTiles[M].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,u,p,_){for(const v in this._tiles){let w=this._tiles[v];if(_[v]||!w.hasData()||w.tileID.overscaledZ<=u||w.tileID.overscaledZ>p)continue;let E=w.tileID;for(;w&&w.tileID.overscaledZ>u+1;){const M=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[M.key],w&&w.hasData()&&(E=M)}let D=E;for(;D.overscaledZ>u;)if(D=D.scaledTo(D.overscaledZ-1),a[D.key]){_[E.key]=E;break}}}findLoadedParent(a,u){if(a.key in this._loadedParentTiles){const p=this._loadedParentTiles[a.key];return p&&p.tileID.overscaledZ>=u?p:null}for(let p=a.overscaledZ-1;p>=u;p--){const _=a.scaledTo(p),v=this._getLoadedTile(_);if(v)return v}}_getLoadedTile(a){const u=this._tiles[a.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,u){u=u||this._source.tileSize;const p=Math.ceil(a.width/u)+1,_=Math.ceil(a.height/u)+1,v=Math.floor(p*_*5),w="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,v):v,E="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(E)}handleWrapJump(a){const u=Math.round((a-(void 0===this._prevLng?a:this._prevLng))/360);if(this._prevLng=a,u){const p={};for(const _ in this._tiles){const v=this._tiles[_];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+u),p[v.tileID.key]=v}this._tiles=p;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(+_,this._tiles[_])}}update(a,u,p){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;let _;this.updateCacheSize(a,u),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?_=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new nr(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(_=a.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(_=_.filter(E=>this._source.hasTile(E)))):_=[];const v=this._updateRetainedTiles(_);if(Wp(this._source.type)&&0!==_.length){const E={},D={},M=Object.keys(v);for(const N of M){const U=v[N],G=this._tiles[N];if(!G||G.fadeEndTime&&G.fadeEndTime<=Ri.now())continue;const K=this.findLoadedParent(U,Math.max(U.overscaledZ-wh.maxOverzooming,this._source.minzoom));K&&(this._addTile(K.tileID),E[K.tileID.key]=K.tileID),D[N]=U}const O=_[_.length-1].overscaledZ;for(const N in this._tiles){const U=this._tiles[N];if(v[N]||!U.hasData())continue;let G=U.tileID;for(;G.overscaledZ>O;){G=G.scaledTo(G.overscaledZ-1);const K=this._tiles[G.key];if(K&&K.hasData()&&D[G.key]){v[N]=U.tileID;break}}}for(const N in E)v[N]||(this._coveredTiles[N]=!0,v[N]=E[N])}for(const E in v)this._tiles[E].clearFadeHold();const w=function(E,D){const M=[];for(const O in E)O in D||M.push(O);return M}(this._tiles,v);for(const E of w){const D=this._tiles[E];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const u={};if(0===a.length)return u;const p={},_=a.reduce((M,O)=>Math.min(M,O.overscaledZ),1/0),v=a[0].overscaledZ,w=Math.max(v-wh.maxOverzooming,this._source.minzoom),E=Math.max(v+wh.maxUnderzooming,this._source.minzoom),D={};for(const M of a){const O=this._addTile(M);u[M.key]=M,O.hasData()||_<this._source.maxzoom&&(D[M.key]=M)}this._retainLoadedChildren(D,_,E,u);for(const M of a){let O=this._tiles[M.key];if(O.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const U=M.children(this._source.maxzoom)[0],G=this.getTile(U);if(G&&G.hasData()){u[U.key]=U;continue}}else{const U=M.children(this._source.maxzoom);if(u[U[0].key]&&u[U[1].key]&&u[U[2].key]&&u[U[3].key])continue}let N=O.wasRequested();for(let U=M.overscaledZ-1;U>=w;--U){const G=M.scaledTo(U);if(p[G.key]||(p[G.key]=!0,O=this.getTile(G),!O&&N&&(O=this._addTile(G)),O&&(u[G.key]=G,N=O.wasRequested(),O.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const u=[];let p,_=this._tiles[a].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){p=this._loadedParentTiles[_.key];break}u.push(_.key);const v=_.scaledTo(_.overscaledZ-1);if(p=this._getLoadedTile(v),p)break;_=v}for(const v of u)this._loadedParentTiles[v]=p}}_addTile(a){let u=this._tiles[a.key];if(u)return u;u=this._cache.getAndRemove(a),u&&(this._setTileReloadTimer(a.key,u),u.tileID=a,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,u)));const p=Boolean(u);if(!p){const _=this.map?this.map.painter:null;u=new Rv(a,this._source.tileSize*a.overscaleFactor(),this.transform.tileZoom,_,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,a.key,u.state))}return u?(u.uses++,this._tiles[a.key]=u,p||this._source.fire(new oo("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(a,u){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const p=u.getExpiryTimeout();p&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},p))}_removeTile(a){const u=this._tiles[a];u&&(u.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),u.uses>0||(u.hasData()&&"reloading"!==u.state?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,u,p){const _=[],v=this.transform;if(!v)return _;const w="globe"===v.projection.name,E=wl(v.center.lng);for(const D in this._tiles){const M=this._tiles[D];if(p&&M.clearQueryDebugViz(),M.holdingForFade())continue;let O;if(w){const N=M.tileID.canonical;if(0===N.z){const U=[Math.abs(Bn(E,...jm(N,-1))-E),Math.abs(Bn(E,...jm(N,1))-E)];O=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(Bn(E,...jm(N,-1))-E),Math.abs(Bn(E,...jm(N,0))-E),Math.abs(Bn(E,...jm(N,1))-E)];O=[U.indexOf(Math.min(...U))-1]}}else O=[0];for(const N of O){const U=a.containsTile(M,v,u,N);U&&_.push(U)}}return _}getVisibleCoordinates(a){const u=this.getRenderableIds(a).map(p=>this._tiles[p].tileID);for(const p of u)p.projMatrix=this.transform.calculateProjMatrix(p.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(Wp(this._source.type))for(const a in this._tiles){const u=this._tiles[a];if(void 0!==u.fadeEndTime&&u.fadeEndTime>=Ri.now())return!0}return!1}setFeatureState(a,u,p){this._state.updateState(a=a||"_geojsonTileLayer",u,p)}removeFeatureState(a,u,p){this._state.removeFeatureState(a=a||"_geojsonTileLayer",u,p)}getFeatureState(a,u){return this._state.getState(a=a||"_geojsonTileLayer",u)}setDependencies(a,u,p){const _=this._tiles[a];_&&_.setDependencies(u,p)}reloadTilesForDependencies(a,u){for(const p in this._tiles)this._tiles[p].hasDependency(a,u)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(a,u))}_preloadTiles(a,u){const p=new Map,_=Array.isArray(a)?a:[a],v=this.map.painter.terrain,w=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const E of _){const D=E.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of D)p.set(M.key,M);this.usedForTerrain&&E.updateElevation(!1)}qs(Array.from(p.values()),(E,D)=>{const M=new Rv(E,this._source.tileSize*E.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,O=>{"raster-dem"===this._source.type&&M.dem&&this._backfillDEM(M),D(O,M)})},u)}}function Nx(c,a){const u=Math.abs(2*c.wrap)-+(c.wrap<0),p=Math.abs(2*a.wrap)-+(a.wrap<0);return c.overscaledZ-a.overscaledZ||p-u||a.canonical.y-c.canonical.y||a.canonical.x-c.canonical.x}function Wp(c){return"raster"===c||"image"===c||"video"===c||"custom"===c}function jm(c,a){const u=1<<c.z;return[c.x/u+a,(c.x+1)/u+a]}wh.maxOverzooming=10,wh.maxUnderzooming=3;class Bv{constructor(a,u,p){this._demTile=a,this._dem=this._demTile.dem,this._scale=u,this._offset=p}static create(a,u,p){const _=p||a.findDEMTileFor(u);if(!_||!_.dem)return;const v=_.dem,w=_.tileID,E=1<<u.canonical.z-w.canonical.z;return new Bv(_,_.tileSize/Un/E,[(u.canonical.x/E-w.canonical.x)*v.dim,(u.canonical.y/E-w.canonical.y)*v.dim])}tileCoordToPixel(a,u){const p=u*this._scale+this._offset[1],_=Math.floor(a*this._scale+this._offset[0]),v=Math.floor(p);return new Ue(_,v)}getElevationAt(a,u,p,_){const v=a*this._scale+this._offset[0],w=u*this._scale+this._offset[1],E=Math.floor(v),D=Math.floor(w),M=this._dem;return _=!!_,p?Si(Si(M.get(E,D,_),M.get(E,D+1,_),w-D),Si(M.get(E+1,D,_),M.get(E+1,D+1,_),w-D),v-E):M.get(E,D,_)}getElevationAtPixel(a,u,p){return this._dem.get(a,u,!!p)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*Da(1,a)*this._dem.stride}}class Bx{constructor(a,u){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Yd(Un,16,0),this.featureIndexArray=new th,this.promoteId=u}insert(a,u,p,_,v,w=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,_,v,w);const D=this.grid;for(let M=0;M<u.length;M++){const O=u[M],N=[1/0,1/0,-1/0,-1/0];for(let U=0;U<O.length;U++){const G=O[U];N[0]=Math.min(N[0],G.x),N[1]=Math.min(N[1],G.y),N[2]=Math.max(N[2],G.x),N[3]=Math.max(N[3],G.y)}N[0]<Un&&N[1]<Un&&N[2]>=0&&N[3]>=0&&D.insert(E,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new iv(new Sm(this.rawTileData)).layers,this.sourceLayerCoder=new Rx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const a in this.vtLayers)this.vtFeatures[a]=[]}return this.vtLayers}query(a,u,p,_){this.loadVTLayers();const v=a.params||{},w=Nf(v.filter),E=a.tileResult,D=a.transform,M=E.bufferedTilespaceBounds,O=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(K,te,se,_e)=>Xy(E.bufferedTilespaceGeometry,K,te,se,_e));O.sort(HT);let N=null;D.elevation&&O.length>0&&(N=Bv.create(D.elevation,this.tileID));const U={};let G;for(let K=0;K<O.length;K++){const te=O[K];if(te===G)continue;G=te;const se=this.featureIndexArray.get(te);let _e=null;this.loadMatchingFeature(U,se,w,v.layers,v.availableImages,u,p,_,(De,pe,we,Ae=0)=>(_e||(_e=jc(De,this.tileID.canonical,a.tileTransform)),pe.queryIntersectsFeature(E,De,we,_e,this.z,a.transform,a.pixelPosMatrix,N,Ae)))}return U}loadMatchingFeature(a,u,p,_,v,w,E,D,M){const{featureIndex:O,bucketIndex:N,sourceLayerIndex:U,layoutVertexArrayOffset:G}=u,K=this.bucketLayerIDs[N];if(_&&!function(De,pe){for(let we=0;we<De.length;we++)if(pe.indexOf(De[we])>=0)return!0;return!1}(_,K))return;const te=this.sourceLayerCoder.decode(U),se=this.vtLayers[te].feature(O);if(p.needGeometry){const De=hh(se,!0);if(!p.filter(new $e(this.tileID.overscaledZ),De,this.tileID.canonical))return}else if(!p.filter(new $e(this.tileID.overscaledZ),se))return;const _e=this.getId(se,te);for(let De=0;De<K.length;De++){const pe=K[De];if(_&&_.indexOf(pe)<0)continue;const we=w[pe];if(!we)continue;let Ae={};void 0!==_e&&D&&(Ae=D.getState(we.sourceLayer||"_geojsonTileLayer",_e));const Ee=Jn({},E[pe]);Ee.paint=Vx(Ee.paint,we.paint,se,Ae,v),Ee.layout=Vx(Ee.layout,we.layout,se,Ae,v);const et=!M||M(se,we,Ae,G);if(!et)continue;const Qe=new Lx(se,this.z,this.x,this.y,_e);Qe.layer=Ee;let pt=a[pe];void 0===pt&&(pt=a[pe]=[]),pt.push({featureIndex:O,feature:Qe,intersectionZ:et})}}lookupSymbolFeatures(a,u,p,_,v,w,E,D){const M={};this.loadVTLayers();const O=Nf(v);for(const N of a)this.loadMatchingFeature(M,{bucketIndex:p,sourceLayerIndex:_,featureIndex:N,layoutVertexArrayOffset:0},O,w,E,D,u);return M}loadFeature(a){const{featureIndex:u,sourceLayerIndex:p}=a;this.loadVTLayers();const _=this.sourceLayerCoder.decode(p),v=this.vtFeatures[_];if(v[u])return v[u];const w=this.vtLayers[_].feature(u);return v[u]=w,w}hasLayer(a){for(const u of this.bucketLayerIDs)for(const p of u)if(a===p)return!0;return!1}getId(a,u){let p=a.id;if(this.promoteId){const _="string"==typeof this.promoteId?this.promoteId:this.promoteId[u];null!=_&&(p=a.properties[_]),"boolean"==typeof p&&(p=Number(p))}return p}}function Vx(c,a,u,p,_){return ji(c,(v,w)=>{const E=a instanceof it?a.get(w):null;return E&&E.evaluate?E.evaluate(u,p,_):E})}function HT(c,a){return a-c}ln(Bx,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Ux{constructor(a,u){this.width=a,this.height=u,this.nextRow=0,this.image=new ia({width:a,height:u}),this.positions={},this.uploaded=!1}getDash(a,u){const p=this.getKey(a,u);return this.positions[p]}trim(){const a=this.width,u=this.height=ss(this.nextRow);this.image.resize({width:a,height:u})}getKey(a,u){return a.join(",")+u}getDashRanges(a,u,p){const _=[];let v=a.length%2==1?-a[a.length-1]*p:0,w=a[0]*p,E=!0;_.push({left:v,right:w,isDash:E,zeroLength:0===a[0]});let D=a[0];for(let M=1;M<a.length;M++){E=!E;const O=a[M];v=D*p,D+=O,w=D*p,_.push({left:v,right:w,isDash:E,zeroLength:0===O})}return _}addRoundDash(a,u,p){const _=u/2;for(let v=-p;v<=p;v++){const w=this.width*(this.nextRow+p+v);let E=0,D=a[E];for(let M=0;M<this.width;M++){M/D.right>1&&(D=a[++E]);const O=Math.abs(M-D.left),N=Math.abs(M-D.right),U=Math.min(O,N);let G;const K=v/p*(_+1);if(D.isDash){const te=_-Math.abs(K);G=Math.sqrt(U*U+te*te)}else G=_-Math.sqrt(U*U+K*K);this.image.data[w+M]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(a,u){for(let D=a.length-1;D>=0;--D){const M=a[D],O=a[D+1];M.zeroLength?a.splice(D,1):O&&O.isDash===M.isDash&&(O.left=M.left,a.splice(D,1))}const p=a[0],_=a[a.length-1];p.isDash===_.isDash&&(p.left=_.left-this.width,_.right=p.right+this.width);const v=this.width*this.nextRow;let w=0,E=a[w];for(let D=0;D<this.width;D++){D/E.right>1&&(E=a[++w]);const M=Math.abs(D-E.left),O=Math.abs(D-E.right),N=Math.min(M,O);this.image.data[v+D]=Math.max(0,Math.min(255,(E.isDash?N:-N)+u+128))}}addDash(a,u){const p=this.getKey(a,u);if(this.positions[p])return this.positions[p];const _="round"===u,v=_?7:0,w=2*v+1;if(this.nextRow+w>this.height)return vo("LineAtlas out of space"),null;0===a.length&&a.push(1);let E=0;for(let O=0;O<a.length;O++)a[O]<0&&(vo("Negative value is found in line dasharray, replacing values with 0"),a[O]=0),E+=a[O];if(0!==E){const O=this.width/E,N=this.getDashRanges(a,this.width,O);_?this.addRoundDash(N,O,v):this.addRegularDash(N,"square"===u?.5*O:0)}const D=this.nextRow+v;this.nextRow+=w;const M={tl:[D,v],br:[E,0]};return this.positions[p]=M,M}}ln(Ux,"LineAtlas");class jx{constructor(a){const u={},p=[];for(const E in a){const D=a[E],M=u[E]={};for(const O in D.glyphs){const N=D.glyphs[+O];if(!N||0===N.bitmap.width||0===N.bitmap.height)continue;const U=N.metrics.localGlyph?2:1,G={x:0,y:0,w:N.bitmap.width+2*U,h:N.bitmap.height+2*U};p.push(G),M[O]=G}}const{w:_,h:v}=hv(p),w=new ia({width:_||1,height:v||1});for(const E in a){const D=a[E];for(const M in D.glyphs){const O=D.glyphs[+M];if(!O||0===O.bitmap.width||0===O.bitmap.height)continue;const N=u[E][M],U=O.metrics.localGlyph?2:1;ia.copy(O.bitmap,w,{x:0,y:0},{x:N.x+U,y:N.y+U},O.bitmap)}}this.image=w,this.positions=u}}ln(jx,"GlyphAtlas");class $T{constructor(a){this.tileID=new nr(a.tileID.overscaledZ,a.tileID.wrap,a.tileID.canonical.z,a.tileID.canonical.x,a.tileID.canonical.y),this.tileZoom=a.tileZoom,this.uid=a.uid,this.zoom=a.zoom,this.canonical=a.tileID.canonical,this.pixelRatio=a.pixelRatio,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=a.showCollisionBoxes,this.collectResourceTiming=!!a.collectResourceTiming,this.returnDependencies=!!a.returnDependencies,this.promoteId=a.promoteId,this.enableTerrain=!!a.enableTerrain,this.isSymbolTile=a.isSymbolTile,this.tileTransform=Yc(a.tileID.canonical,a.projection),this.projection=a.projection}parse(a,u,p,_,v){this.status="parsing",this.data=a,this.collisionBoxArray=new Lg;const w=new Rx(Object.keys(a.layers).sort()),E=new Bx(this.tileID,this.promoteId);E.bucketLayerIDs=[];const D={},M=new Ux(256,256),O={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:p},N=u.familiesBySource[this.source];for(const Ae in N){const Ee=a.layers[Ae];if(!Ee)continue;let et=!1,Qe=!1;for(const at of N[Ae])"symbol"===at[0].type?et=!0:Qe=!0;if(!0===this.isSymbolTile&&!et||!1===this.isSymbolTile&&!Qe)continue;1===Ee.version&&vo(`Vector tile source "${this.source}" layer "${Ae}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const pt=w.encode(Ae),st=[];for(let at=0;at<Ee.length;at++){const yt=Ee.feature(at),vt=E.getId(yt,Ae);st.push({feature:yt,id:vt,index:at,sourceLayerIndex:pt})}for(const at of N[Ae]){const yt=at[0];void 0!==this.isSymbolTile&&"symbol"===yt.type!==this.isSymbolTile||yt.minzoom&&this.zoom<Math.floor(yt.minzoom)||yt.maxzoom&&this.zoom>=yt.maxzoom||"none"!==yt.visibility&&(Vv(at,this.zoom,p),(D[yt.id]=yt.createBucket({index:E.bucketLayerIDs.length,layers:at,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:p})).populate(st,O,this.tileID.canonical,this.tileTransform),E.bucketLayerIDs.push(at.map(vt=>vt.id)))}}let U,G,K,te;M.trim();const se={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},_e=ji(O.glyphDependencies,Ae=>Object.keys(Ae).map(Number));Object.keys(_e).length?_.send("getGlyphs",{uid:this.uid,stacks:_e},(Ae,Ee)=>{U||(U=Ae,G=Ee,we.call(this))},void 0,!1,se):G={};const De=Object.keys(O.iconDependencies);De.length?_.send("getImages",{icons:De,source:this.source,tileID:this.tileID,type:"icons"},(Ae,Ee)=>{U||(U=Ae,K=Ee,we.call(this))},void 0,!1,se):K={};const pe=Object.keys(O.patternDependencies);function we(){if(U)return v(U);if(G&&K&&te){const Ae=new jx(G),Ee=new Ka(K,te);for(const et in D){const Qe=D[et];Qe instanceof Qc?(Vv(Qe.layers,this.zoom,p),ST(Qe,G,Ae.positions,K,Ee.iconPositions,this.showCollisionBoxes,p,this.tileID.canonical,this.tileZoom,this.projection)):Qe.hasPattern&&(Qe instanceof Cm||Qe instanceof Pp||Qe instanceof Op)&&(Vv(Qe.layers,this.zoom,p),Qe.addFeatures(O,this.tileID.canonical,Ee.patternPositions,p,this.tileTransform))}this.status="done",v(null,{buckets:Ps(D).filter(et=>!et.isEmpty()),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ae.image,lineAtlas:M,imageAtlas:Ee,glyphMap:this.returnDependencies?G:null,iconMap:this.returnDependencies?K:null,glyphPositions:this.returnDependencies?Ae.positions:null})}}pe.length?_.send("getImages",{icons:pe,source:this.source,tileID:this.tileID,type:"patterns"},(Ae,Ee)=>{U||(U=Ae,te=Ee,we.call(this))},void 0,!1,se):te={},we.call(this)}}function Vv(c,a,u){const p=new $e(a);for(const _ of c)_.recalculate(p,u)}class Uv{constructor(a){this.entries={},this.scheduler=a}request(a,u,p,_){const v=this.entries[a]=this.entries[a]||{callbacks:[]};if(v.result){const[w,E]=v.result;return this.scheduler?this.scheduler.add(()=>{_(w,E)},u):_(w,E),()=>{}}return v.callbacks.push(_),v.cancel||(v.cancel=p((w,E)=>{v.result=[w,E];for(const D of v.callbacks)this.scheduler?this.scheduler.add(()=>{D(w,E)},u):D(w,E);setTimeout(()=>delete this.entries[a],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(w=>w!==_),v.callbacks.length||(v.cancel(),delete this.entries[a]))}}}function Li(c,a,u){const p=JSON.stringify(c.request);return c.data&&(this.deduped.entries[p]={result:[null,c.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},_=>{const v=bu(c.request,(w,E,D,M)=>{w?_(w):E&&_(null,{vectorTile:u?void 0:new iv(new Sm(E)),rawData:E,cacheControl:D,expires:M})});return()=>{v.cancel(),_()}},a)}m.ARRAY_TYPE=ea,m.AUTH_ERR_MSG=Cu,m.Aabb=wo,m.Actor=class{constructor(c,a,u){this.target=c,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},ma(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=La()?c:re,this.scheduler=new NT}send(c,a,u,p,_=!1,v){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[w]=u);const E=Ol(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:c,hasCallback:!!u,targetMapId:p,mustQueue:_,sourceMapId:this.mapId,data:Jd(a,E)},E),{cancel:()=>{u&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(c){const a=c.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if("<cancel>"===a.type){const p=this.cancelCallbacks[u];delete this.cancelCallbacks[u],p&&p.cancel()}else if(a.mustQueue||La()){const p=this.callbacks[u];this.cancelCallbacks[u]=this.scheduler.add(()=>this.processTask(u,a),p&&p.metadata||{type:"message"})}else this.processTask(u,a)}processTask(c,a){if("<response>"===a.type){const u=this.callbacks[c];delete this.callbacks[c],u&&(a.error?u(Lt(a.error)):u(null,Lt(a.data)))}else{const u=Ol(this.globalScope)?void 0:[],p=a.hasCallback?(v,w)=>{delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:v?Jd(v):null,data:Jd(w,u)},u)}:v=>{},_=Lt(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,_,p);else if(this.parent.getWorkerSource){const v=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,v[0],_.source)[v[1]](_,p)}else p(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},m.CanonicalTileID=xm,m.Color=qo,m.ColorMode=sa,m.CullFaceMode=Ya,m.DEMData=Um,m.DataConstantProperty=je,m.DedupedRequest=Uv,m.DepthMode=ra,m.EXTENT=Un,m.Elevation=class{isDataAvailableAtPoint(c){const a=this._source();if(this.isUsingMockSource()||!a||c.y<0||c.y>1)return!1;const u=a.getSource().maxzoom,p=1<<u,_=Math.floor(c.x),v=Math.floor((c.x-_)*p),w=Math.floor(c.y*p),E=this.findDEMTileFor(new nr(u,_,u,v,w));return!(!E||!E.dem)}getAtPointOrZero(c,a=0){return this.getAtPoint(c,a)||0}getAtPoint(c,a,u=!0){if(this.isUsingMockSource())return null;null==a&&(a=null);const p=this._source();if(!p||c.y<0||c.y>1)return a;const _=p.getSource().maxzoom,v=1<<_,w=Math.floor(c.x),E=c.x-w,D=new nr(_,w,_,Math.floor(E*v),Math.floor(c.y*v)),M=this.findDEMTileFor(D);if(!M||!M.dem)return a;const O=M.dem,N=1<<M.tileID.canonical.z,U=(E*N-M.tileID.canonical.x)*O.dim,G=(c.y*N-M.tileID.canonical.y)*O.dim,K=Math.floor(U),te=Math.floor(G);return(u?this.exaggeration():1)*Si(Si(O.get(K,te),O.get(K,te+1),G-te),Si(O.get(K+1,te),O.get(K+1,te+1),G-te),U-K)}getAtTileOffset(c,a,u){const p=1<<c.canonical.z;return this.getAtPointOrZero(new Sp(c.wrap+(c.canonical.x+a/Un)/p,(c.canonical.y+u/Un)/p))}getAtTileOffsetFunc(c,a,u,p){return _=>{const v=this.getAtTileOffset(c,_.x,_.y),w=p.upVector(c.canonical,_.x,_.y);return Ta(w,w,v*p.upVectorScale(c.canonical,a,u).metersToTile),w}}getForTilePoints(c,a,u,p){if(this.isUsingMockSource())return!1;const _=Bv.create(this,c,p);return!!_&&(a.forEach(v=>{v[2]=this.exaggeration()*_.getElevationAt(v[0],v[1],u)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const a=this.findDEMTileFor(c);if(!a||!a.dem)return null;const u=a.dem.tree,p=a.tileID,_=1<<c.canonical.z-p.canonical.z;let v=c.canonical.x/_-p.canonical.x,w=c.canonical.y/_-p.canonical.y,E=0;for(let D=0;D<c.canonical.z-p.canonical.z&&!u.leaves[E];D++){v*=2,w*=2;const M=2*Math.floor(w)+Math.floor(v);E=u.childOffsets[E]+M,v%=1,w%=1}return{min:this.exaggeration()*u.minimums[E],max:this.exaggeration()*u.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,a,u){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},m.ErrorEvent=ll,m.EvaluationParameters=$e,m.Event=oo,m.Evented=Ba,m.FillExtrusionBucket=Op,m.Frustum=qg,m.FrustumCorners=Wg,m.GLOBE_RADIUS=Kl,m.GLOBE_SCALE_MATCH_LATITUDE=45,m.GLOBE_ZOOM_THRESHOLD_MAX=6,m.GLOBE_ZOOM_THRESHOLD_MIN=5,m.GlobeSharedBuffers=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const c of this._wireframeSegments)c.destroy()}}_fillGridMeshWithLods(c,a){const u=new Tn,p=new Yr,_=[],v=c+1+2,w=a[0]+1,E=a[0]+1+(1+a.length),D=(M,O,N)=>{let U=M===v-1?M-2:0===M?M:M-1;return U+=N?24575:0,[U,O]};for(let M=0;M<v;++M)u.emplaceBack(...D(M,0,!0));for(let M=0;M<w;++M)for(let O=0;O<v;++O)u.emplaceBack(...D(O,M,(0===O||O===v-1)&&!0));for(let M=0;M<a.length;++M){const O=a[M];for(let N=0;N<v;++N)u.emplaceBack(...D(N,O,!0))}for(let M=0;M<a.length;++M){const O=p.length,N=a[M]+1+2,U=new Yr;for(let te=0;te<N-1;te++){const se=te===N-2,_e=se?v*(E-a.length+M-te):v;for(let De=0;De<v-1;De++){const pe=te*v+De;0===te||se||0===De||De===v-2?(U.emplaceBack(pe+1,pe,pe+_e),U.emplaceBack(pe+_e,pe+_e+1,pe+1)):(p.emplaceBack(pe+1,pe,pe+_e),p.emplaceBack(pe+_e,pe+_e+1,pe+1))}}const G=Ko.simpleSegment(0,O,u.length,p.length-O);for(let te=0;te<U.uint16.length;te+=3)p.emplaceBack(U.uint16[te],U.uint16[te+1],U.uint16[te+2]);const K=Ko.simpleSegment(0,O,u.length,p.length-O);_.push({withoutSkirts:G,withSkirts:K})}return{vertices:u,indices:p,segments:_}}_createGrid(c){const a=this._fillGridMeshWithLods(64,em);this._gridSegments=a.segments,this._gridBuffer=c.createVertexBuffer(a.vertices,ah.members),this._gridIndexBuffer=c.createIndexBuffer(a.indices,!0)}_createPoles(c){const a=new Yr;for(let _=0;_<=64;_++)a.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=c.createIndexBuffer(a,!0);const u=new Ns,p=new Ns;this._poleSegments=[];for(let _=0,v=0;_<5;_++){const w=360/(1<<_);u.emplaceBack(0,-Kl,0,.5,0),p.emplaceBack(0,-Kl,0,.5,1);for(let E=0;E<=64;E++){const D=E/64,M=Si(0,w,D),[O,N,U]=uh(UC,om,M,Kl);u.emplaceBack(O,N,U,D,0),p.emplaceBack(O,N,U,D,1)}this._poleSegments.push(Ko.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(u,A0,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(p,A0,!1)}getGridBuffers(c,a){return[this._gridBuffer,this._gridIndexBuffer,a?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}getWirefameBuffers(c,a){if(!this._wireframeSegments){const u=new xa,p=64,_=p+1+2,v=1;this._wireframeSegments=[];for(let w=0,E=0;w<em.length;w++){const D=em[w];for(let O=v;O<D+v;O++)for(let N=v;N<p+v;N++){const U=O*_+N;u.emplaceBack(U,U+1),u.emplaceBack(U,U+_),u.emplaceBack(U,U+_+1)}const M=D*p*3;this._wireframeSegments.push(Ko.simpleSegment(0,E,(D+1)*_,M)),E+=M}this._wireframeIndexBuffer=c.createIndexBuffer(u)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[a]]}},m.GlyphManager=Vp,m.ImagePosition=pv,m.LivePerformanceUtils=wt,m.LngLat=Mi,m.LngLatBounds=Xu,m.LocalGlyphMode=km,m.MAX_MERCATOR_LATITUDE=Jr,m.MercatorCoordinate=Sp,m.ONE_EM=ir,m.OverscaledTileID=nr,m.PerformanceMarkers=tt,m.Properties=Pt,m.RGBAImage=oa,m.Ray=Gg,m.RequestManager=class{constructor(c,a,u){this._transformRequestFn=c,this._customAccessToken=a,this._silenceAuthErrors=!!u,this._createSkuToken()}_createSkuToken(){const c=function(){let a="";for(let u=0;u<10;u++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Bt,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,a){return this._transformRequestFn&&this._transformRequestFn(c,a)||{url:c}}normalizeStyleURL(c,a){if(!Na(c))return c;const u=vs(c);return u.path=`/styles/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeGlyphsURL(c,a){if(!Na(c))return c;const u=vs(c);return u.path=`/fonts/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeSourceURL(c,a,u,p){if(!Na(c))return c;const _=vs(c);return _.path=`/v4/${_.authority}.json`,_.params.push("secure"),u&&_.params.push(`language=${u}`),p&&_.params.push(`worldview=${p}`),this._makeAPIURL(_,this._customAccessToken||a)}normalizeSpriteURL(c,a,u,p){const _=vs(c);return Na(c)?(_.path=`/styles/v1${_.path}/sprite${a}${u}`,this._makeAPIURL(_,this._customAccessToken||p)):(_.path+=`${a}${u}`,Fl(_))}normalizeTileURL(c,a,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!Na(c))return c;const p=vs(c);p.path=p.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${a||u&&"raster"!==p.authority&&512===u?"@2x":""}${Ye.supported?".webp":"$1"}`),"raster"===p.authority?p.path=`/${Ve.RASTER_URL_PREFIX}${p.path}`:(p.path=p.path.replace(/^.+\/v4\//,"/"),p.path=`/${Ve.TILE_URL_VERSION}${p.path}`);const _=this._customAccessToken||function(v){for(const w of v){const E=w.match(/^access_token=(.*)$/);if(E)return E[1]}return null}(p.params)||Ve.ACCESS_TOKEN;return Ve.REQUIRE_ACCESS_TOKEN&&_&&this._skuToken&&p.params.push(`sku=${this._skuToken}`),this._makeAPIURL(p,_)}canonicalizeTileURL(c,a){const u=vs(c);if(!u.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!u.path.match(/\.[\w]+$/))return c;let p="mapbox://";u.path.match(/^\/raster\/v1\//)?p+=`raster/${u.path.replace(`/${Ve.RASTER_URL_PREFIX}/`,"")}`:p+=`tiles/${u.path.replace(`/${Ve.TILE_URL_VERSION}/`,"")}`;let _=u.params;return a&&(_=_.filter(v=>!v.match(/^access_token=/))),_.length&&(p+=`?${_.join("&")}`),p}canonicalizeTileset(c,a){const u=!!a&&Na(a),p=[];for(const _ of c.tiles||[])Tu(_)?p.push(this.canonicalizeTileURL(_,u)):p.push(_);return p}_makeAPIURL(c,a){const u="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",p=vs(Ve.API_URL);if(c.protocol=p.protocol,c.authority=p.authority,"http"===c.protocol){const _=c.params.indexOf("secure");_>=0&&c.params.splice(_,1)}if("/"!==p.path&&(c.path=`${p.path}${c.path}`),!Ve.REQUIRE_ACCESS_TOKEN)return Fl(c);if(a=a||Ve.ACCESS_TOKEN,!this._silenceAuthErrors){if(!a)throw new Error(`An API access token is required to use Mapbox GL. ${u}`);if("s"===a[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${u}`)}return c.params=c.params.filter(_=>-1===_.indexOf("access_token")),c.params.push(`access_token=${a||""}`),Fl(c)}},m.ResourceType=Md,m.SegmentVector=Ko,m.SourceCache=wh,m.StencilMode=Gp,m.StructArrayLayout1ui2=Ss,m.StructArrayLayout2f1f2i16=Nr,m.StructArrayLayout2i4=Tn,m.StructArrayLayout2ui4=xa,m.StructArrayLayout3f12=wr,m.StructArrayLayout3ui6=Yr,m.StructArrayLayout4i8=Gi,m.StructArrayLayout5f20=Ns,m.Texture=xh,m.Tile=Rv,m.Transitionable=zt,m.Uniform1f=Py,m.Uniform1i=class extends Ku{constructor(c){super(c),this.current=0}set(c,a,u){this.fetchUniformLocation(c,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},m.Uniform2f=class extends Ku{constructor(c){super(c),this.current=[0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}},m.Uniform3f=class extends Ku{constructor(c){super(c),this.current=[0,0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}},m.Uniform4f=bp,m.UniformColor=IC,m.UniformMatrix2f=class extends Ku{constructor(c){super(c),this.current=Oy}set(c,a,u){if(this.fetchUniformLocation(c,a))for(let p=0;p<4;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}},m.UniformMatrix3f=class extends Ku{constructor(c){super(c),this.current=Br}set(c,a,u){if(this.fetchUniformLocation(c,a))for(let p=0;p<9;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}},m.UniformMatrix4f=class extends Ku{constructor(c){super(c),this.current=e2}set(c,a,u){if(this.fetchUniformLocation(c,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let p=1;p<16;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}},m.UnwrappedTileID=lv,m.ValidationError=Yt,m.VectorTileFeature=s_,m.VectorTileWorkerSource=class extends Ba{constructor(c,a,u,p,_){super(),this.actor=c,this.layerIndex=a,this.availableImages=u,this.loadVectorData=_||Li,this.loading={},this.loaded={},this.deduped=new Uv(c.scheduler),this.isSpriteLoaded=p,this.scheduler=c.scheduler}loadTile(c,a){const u=c.uid,p=c&&c.request,_=p&&p.collectResourceTiming,v=this.loading[u]=new $T(c);v.abort=this.loadVectorData(c,(w,E)=>{const D=!this.loading[u];if(delete this.loading[u],D||w||!E)return v.status="done",D||(this.loaded[u]=v),a(w);const M=E.rawData,O={};E.expires&&(O.expires=E.expires),E.cacheControl&&(O.cacheControl=E.cacheControl),v.vectorTile=E.vectorTile||new iv(new Sm(M));const N=()=>{v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,(U,G)=>{if(U||!G)return a(U);const K={};if(_){const te=Sn(p);te.length>0&&(K.resourceTiming=JSON.parse(JSON.stringify(te)))}a(null,Jn({rawTileData:M.slice(0)},G,O,K))})};this.isSpriteLoaded?N():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(N,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom}):N()}),this.loaded=this.loaded||{},this.loaded[u]=v})}reloadTile(c,a){const u=this.loaded,p=c.uid,_=this;if(u&&u[p]){const v=u[p];v.showCollisionBoxes=c.showCollisionBoxes,v.enableTerrain=!!c.enableTerrain,v.projection=c.projection,v.tileTransform=Yc(c.tileID.canonical,c.projection);const w=(E,D)=>{const M=v.reloadCallback;M&&(delete v.reloadCallback,v.parse(v.vectorTile,_.layerIndex,this.availableImages,_.actor,M)),a(E,D)};"parsing"===v.status?v.reloadCallback=w:"done"===v.status&&(v.vectorTile?v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(c,a){const u=c.uid,p=this.loading[u];p&&(p.abort&&p.abort(),delete this.loading[u]),a()}removeTile(c,a){const u=this.loaded,p=c.uid;u&&u[p]&&delete u[p],a()}},m.WritingMode=Ma,m.ZoomDependentExpression=ju,m.add=Ju,m.addDynamicAttributes=zm,m.adjoint=function(c,a){var u=a[0],p=a[1],_=a[2],v=a[3],w=a[4],E=a[5],D=a[6],M=a[7],O=a[8];return c[0]=w*O-E*M,c[1]=_*M-p*O,c[2]=p*E-_*w,c[3]=E*D-v*O,c[4]=u*O-_*D,c[5]=_*v-u*E,c[6]=v*M-w*D,c[7]=p*D-u*M,c[8]=u*w-p*v,c},m.asyncAll=qs,m.bezier=ho,m.bindAll=ma,m.boundsAttributes=zx,m.bufferConvexPolygon=function(c,a){const u=[];for(let p=0;p<c.length;p++){const _=lr(p-1,-1,c.length-1),v=lr(p+1,-1,c.length-1),w=c[p],E=c[v],D=c[_].sub(w).unit(),M=E.sub(w).unit(),O=M.angleWithSep(D.x,D.y),N=D.add(M).unit().mult(-1*a/Math.sin(O/2));u.push(w.add(N))}return u},m.cacheEntryPossiblyAdded=function(c){Dd++,Dd>vc&&(c.getActor().send("enforceCacheSizeLimit",Sd),Dd=0)},m.calculateGlobeLabelMatrix=function(c,a){const{x:u,y:p}=c.point,_=jy(u,p,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Yu(_,_,Uy(Xl(a)))},m.calculateGlobeMatrix=function(c){const{x:a,y:u}=c.point,{lng:p,lat:_}=c._center;return jy(a,u,c.worldSize,p,_)},m.calculateGlobeMercatorMatrix=function(c){const a=c.pixelsPerMeter,u=a/Da(1,c.center.lat),p=Ca(new Float64Array(16));return ql(p,p,[c.point.x,c.point.y,0]),rh(p,p,[u,u,a]),Float32Array.from(p)},m.circumferenceAtLatitude=sm,m.clamp=Bn,m.clearTileCache=function(c){if(!$h())return;const a=re.caches.delete(Ed);c&&a.catch(c).then(()=>c())},m.clipLine=bv,m.clone=function(c){var a=new ea(16);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},m.clone$1=Vo,m.collisionCircleLayout=hT,m.config=Ve,m.conjugate=function(c,a){return c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c[3]=a[3],c},m.create=function(){var c=new ea(16);return ea!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},m.create$1=Bg,m.createExpression=Uu,m.createLayout=bn,m.createStyleLayer=function(c){return"custom"===c.type?new LT(c):new FT[c.type](c)},m.cross=Fy,m.degToRad=bt,m.distance=function(c,a){return Math.hypot(a[0]-c[0],a[1]-c[1],a[2]-c[2])},m.div=function(c,a,u){return c[0]=a[0]/u[0],c[1]=a[1]/u[1],c[2]=a[2]/u[2],c},m.dot=Ea,m.earthRadius=rm,m.ease=xo,m.easeCubicInOut=zn,m.ecefToLatLng=function([c,a,u]){const p=Math.hypot(c,a,u),_=Math.atan2(c,u),v=.5*Math.PI-Math.acos(-a/p);return new Mi(Ot(_),Ot(v))},m.emitValidationErrors=$f,m.endsWith=Rs,m.enforceCacheSizeLimit=function(c){al(),Fa&&Fa.then(a=>{a.keys().then(u=>{for(let p=0;p<u.length-c;p++)a.delete(u[p])})})},m.evaluateSizeForFeature=si,m.evaluateSizeForZoom=Lp,m.evaluateVariableOffset=Mx,m.evented=Ce,m.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]},m.exactEquals$1=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]},m.exported=Ri,m.exported$1=Ye,m.extend=Jn,m.extend$1=cl,m.fillExtrusionHeightLift=c_,m.filterObject=Yn,m.fromMat4=function(c,a){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[4],c[4]=a[5],c[5]=a[6],c[6]=a[8],c[7]=a[9],c[8]=a[10],c},m.fromQuat=function(c,a){var u=a[0],p=a[1],_=a[2],v=a[3],w=u+u,E=p+p,D=_+_,M=u*w,O=p*w,N=p*E,U=_*w,G=_*E,K=_*D,te=v*w,se=v*E,_e=v*D;return c[0]=1-N-K,c[1]=O+_e,c[2]=U-se,c[3]=0,c[4]=O-_e,c[5]=1-M-K,c[6]=G+te,c[7]=0,c[8]=U+se,c[9]=G-te,c[10]=1-M-N,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},m.fromRotation=function(c,a){var u=Math.sin(a),p=Math.cos(a);return c[0]=p,c[1]=u,c[2]=0,c[3]=-u,c[4]=p,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},m.fromScaling=Yf,m.furthestTileCorner=function(c){const a=Math.round((c+45+360)%360/90)%4;return nn[a]},m.getAABBPointSquareDist=function(c,a,u){let p=0;for(let _=0;_<2;++_){const v=u?u[_]:0;c[_]>v&&(p+=(c[_]-v)*(c[_]-v)),a[_]<v&&(p+=(v-a[_])*(v-a[_]))}return p},m.getAnchorAlignment=j,m.getAnchorJustification=Cv,m.getBounds=function(c){let a=1/0,u=1/0,p=-1/0,_=-1/0;for(const v of c)a=Math.min(a,v.x),u=Math.min(u,v.y),p=Math.max(p,v.x),_=Math.max(_,v.y);return{min:new Ue(a,u),max:new Ue(p,_)}},m.getColumn=yu,m.getGridMatrix=function(c,a,u,p){const _=a.getNorth(),v=a.getSouth(),w=a.getWest(),E=a.getEast(),D=1<<c.z,M=E-w,O=_-v,N=M/64,U=-O/em[u],G=[0,N,0,U,0,0,_,w,0];if(c.z>0){const K=180/p;Xf(G,G,[K/M+1,0,0,0,K/O+1,0,-.5*K/N,.5*K/U,1])}return G[2]=D,G[5]=c.x,G[8]=c.y,G},m.getImage=Gh,m.getJSON=function(c,a){return Rl(Jn(c,{type:"json"}),a)},m.getLatitudinalLod=function(c){const a=Jr-5;c=Bn(c,-a,a)/a*90;const u=Math.pow(Math.abs(Math.sin(bt(c))),3);return Math.round(u*(em.length-1))},m.getMapSessionAPI=We,m.getPerformanceMeasurement=Sn,m.getProjection=kx,m.getRTLTextPluginStatus=Pe,m.getReferrer=ga,m.getTilePoint=function(c,{x:a,y:u},p=0){return new Ue(((a-p)*c.scale-c.x)*Un,(u*c.scale-c.y)*Un)},m.getTileVec3=function(c,a,u=0){return xp(((a.x-u)*c.scale-c.x)*Un,(a.y*c.scale-c.y)*Un,Yg(a.z,a.y))},m.getVideo=function(c,a){const u=re.document.createElement("video");u.muted=!0,u.onloadstart=function(){a(null,u)};for(let p=0;p<c.length;p++){const _=re.document.createElement("source");Id(c[p])||(u.crossOrigin="Anonymous"),_.src=c[p],u.appendChild(_)}return{cancel:()=>{}}},m.globeCenterToScreenPoint=function(c){const a=[0,0,0],u=Ca(new Float64Array(16));return Yu(u,c.pixelMatrix,c.globeMatrix),Bo(a,a,u),new Ue(a[0],a[1])},m.globeDenormalizeECEF=Uy,m.globeECEFOrigin=function(c,a){const u=[0,0,0];return Bo(u,u,Tp(Xl(a.canonical))),Bo(u,u,c),u},m.globeMetersToEcef=Zg,m.globeNormalizeECEF=Tp,m.globePixelsToTileUnits=function(c,a){return Un/(512*Math.pow(2,c))*nm(Xl(a))},m.globePoleMatrixForTile=function(c,a,u){const p=Ca(new Float64Array(16)),_=(a/(1<<c)-.5)*Math.PI*2;return Qu(p,u.globeMatrix,_),Float32Array.from(p)},m.globeTileBounds=Xl,m.globeTiltAtLngLat=L0,m.globeToMercatorTransition=Ep,m.globeUseCustomAntiAliasing=function(c,a,u){const p=Ep(u.zoom),_=c.style.map._antialias,v=!!a.extStandardDerivatives,w=a.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return 0===p&&!_&&!w&&v},m.identity=Ca,m.identity$1=zC,m.invert=Wl,m.isFullscreen=function(){return!!re.document.fullscreenElement||!!re.document.webkitFullscreenElement},m.isLngLatBehindGlobe=im,m.isMapAuthenticated=function(c){return ze.has(c)},m.isMapboxURL=Na,m.isSafariWithAntialiasingBug=function(c){const a=c.navigator?c.navigator.userAgent:null;return!!Ol(c)&&a&&(a.match("Version/15.4")||a.match("Version/15.5")||a.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},m.latFromMercatorY=Qr,m.latLngToECEF=dh,m.len=LC,m.length=Uc,m.length$1=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},m.lngFromMercatorX=na,m.loadVectorTile=Li,m.makeRequest=Rl,m.mapValue=function(c,a,u,p,_){return Bn((c-a)/(u-a)*(_-p)+p,p,_)},m.mercatorScale=z0,m.mercatorXfromLng=wl,m.mercatorYfromLat=Vs,m.mercatorZfromAltitude=Da,m.mul=PC,m.mul$1=RC,m.multiply=Yu,m.multiply$1=Xf,m.multiply$2=k0,m.nextPowerOfTwo=ss,m.normalize=Vr,m.normalize$1=o2,m.normalize$2=FC,m.number=Si,m.ortho=function(c,a,u,p,_,v,w){var E=1/(a-u),D=1/(p-_),M=1/(v-w);return c[0]=-2*E,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*D,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*M,c[11]=0,c[12]=(a+u)*E,c[13]=(_+p)*D,c[14]=(w+v)*M,c[15]=1,c},m.pbf=Sm,m.perspective=function(c,a,u,p,_){var v,w=1/Math.tan(a/2);return c[0]=w/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=w,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,null!=_&&_!==1/0?(c[10]=(_+p)*(v=1/(p-_)),c[14]=2*_*p*v):(c[10]=-1,c[14]=-2*p),c},m.pick=function(c,a){const u={};for(let p=0;p<a.length;p++){const _=a[p];_ in c&&(u[_]=c[_])}return u},m.plugin=Le,m.pointGeometry=Ue,m.polesInViewport=function(c){const a=Ca(new Float64Array(16));Yu(a,c.pixelMatrix,c.globeMatrix);const u=[0,Sa,0],p=[0,ta,0];return Bo(u,u,a),Bo(p,p,a),[u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!im(c,new Mi(c.center.lat,90)),p[0]>0&&p[0]<=c.width&&p[1]>0&&p[1]<=c.height&&!im(c,new Mi(c.center.lat,-90))]},m.polygonContainsPoint=$c,m.polygonIntersectsBox=Xy,m.polygonIntersectsPolygon=qy,m.polygonizeBounds=function(c,a,u=0,p=!0){const _=new Ue(u,u),v=c.sub(_),w=a.add(_),E=[v,new Ue(w.x,v.y),w,new Ue(v.x,w.y)];return p&&E.push(v.clone()),E},m.posAttributes=ah,m.postMapLoadEvent=fe,m.postPerformanceEvent=Re,m.postTurnstileEvent=Y,m.potpack=hv,m.prevPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},m.radToDeg=Ot,m.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],m.registerForPluginStateChange=function(c){return c({pluginStatus:he,pluginURL:ie}),Ce.on("pluginStateChange",c),c},m.removeAuthState=function(c){ze.delete(c)},m.renderColorRamp=G0,m.resample=N0,m.rotateX=Vg,m.rotateX$1=NC,m.rotateY=Qu,m.rotateY$1=BC,m.rotateZ=function(c,a,u){var p=Math.sin(u),_=Math.cos(u),v=a[0],w=a[1],E=a[2],D=a[3],M=a[4],O=a[5],N=a[6],U=a[7];return a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=v*_+M*p,c[1]=w*_+O*p,c[2]=E*_+N*p,c[3]=D*_+U*p,c[4]=M*_-v*p,c[5]=O*_-w*p,c[6]=N*_-E*p,c[7]=U*_-D*p,c},m.rotateZ$1=function(c,a,u){u*=.5;var p=a[0],_=a[1],v=a[2],w=a[3],E=Math.sin(u),D=Math.cos(u);return c[0]=p*D+_*E,c[1]=_*D-p*E,c[2]=v*D+w*E,c[3]=w*D-v*E,c},m.scale=rh,m.scale$1=Hg,m.scale$2=Ta,m.scaleAndAdd=Jf,m.set=function(c,a,u,p){return c[0]=a,c[1]=u,c[2]=p,c},m.setCacheLimits=function(c,a){Sd=c,vc=a},m.setColumn=function(c,a,u){c[4*a+0]=u[0],c[4*a+1]=u[1],c[4*a+2]=u[2],c[4*a+3]=u[3]},m.setRTLTextPlugin=function(c,a,u=!1){if(he===oe||he===ue||he===ae)throw new Error("setRTLTextPlugin cannot be called multiple times.");ie=Ri.resolveURL(c),he=oe,de=a,ge(),u||ke()},m.smoothstep=vr,m.spec=gt,m.squaredLength=function(c){var a=c[0],u=c[1],p=c[2];return a*a+u*u+p*p},m.storeAuthState=function(c,a){a?ze.add(c):ze.delete(c)},m.sub=Zl,m.subtract=Ug,m.symbolSize=Tm,m.tileAABB=function(c,a,u,p,_,v,w,E,D){if("globe"===D.name)return function Vy(c,a,u){const p=a/c.worldSize,_=c.globeMatrix;if(u.z<=1){const Qe=Xl(u).getCorners();return By(Qe,_,p),wo.fromPoints(Qe)}const v=Ur(u),w=ch(v);By(w,_,p);const E=Number.MAX_VALUE,D=[-E,-E,-E],M=[E,E,E];if(v.contains(c.center)){for(const st of w)jg(M,M,st),Qf(D,D,st);D[2]=0;const Qe=c.point,pt=[Qe.x*p,Qe.y*p,0];return jg(M,M,pt),Qf(D,D,pt),new wo(M,D)}const O=[_[12]*p,_[13]*p,_[14]*p],N=v.getCenter(),U=Bn(c.center.lat,-Jr,Jr),G=Bn(N.lat,-Jr,Jr),K=wl(c.center.lng),te=Vs(U);let se=K-wl(N.lng);const _e=te-Vs(G);se>.5?se-=1:se<-.5&&(se+=1);let De=0;Math.abs(se)>Math.abs(_e)?De=se>=0?1:3:(De=_e>=0?0:2,Jf(O,O,[_[4]*p,_[5]*p,_[6]*p],-Math.sin(bt(_e>=0?v.getSouth():v.getNorth()))*Kl));const pe=w[De],we=w[(De+1)%4],Ae=new O0(pe,we,O),Ee=[Ny(Ae,0)||pe[0],Ny(Ae,1)||pe[1],Ny(Ae,2)||pe[2]],et=Ep(c.zoom);if(et>0){const Qe=function({x:st,y:at,z:yt},vt,It,At,ct){const jt=1/(1<<yt);let Dn=st*jt,qt=Dn+jt,un=at*jt,Wt=un+jt,Rn=0;const bi=(Dn+qt)/2-At;return bi>.5?Rn=-1:bi<-.5&&(Rn=1),Dn=((Dn+Rn)*vt-(At*=vt))*It+At,qt=((qt+Rn)*vt-At)*It+At,un=(un*vt-(ct*=vt))*It+ct,Wt=(Wt*vt-ct)*It+ct,[[Dn,Wt,0],[qt,Wt,0],[qt,un,0],[Dn,un,0]]}(u,a,c._pixelsPerMercatorPixel,K,te);for(let st=0;st<w.length;st++)Tr(w[st],Qe[st],et);const pt=Ju([],Qe[De],Qe[(De+1)%4]);Ta(pt,pt,.5),Tr(Ee,pt,et)}for(const Qe of w)jg(M,M,Qe),Qf(D,D,Qe);return M[2]=Math.min(pe[2],we[2]),jg(M,M,Ee),Qf(D,D,Ee),new wo(M,D)}(c,a,new xm(u,p,_));const M=Yc({z:u,x:p,y:_},D);return new wo([(v+M.x/M.scale)*a,a*(M.y/M.scale),w],[(v+M.x2/M.scale)*a,a*(M.y2/M.scale),E])},m.tileCornersToBounds=Ur,m.tileTransform=Yc,m.transformMat3=function(c,a,u){var p=a[0],_=a[1],v=a[2];return c[0]=p*u[0]+_*u[3]+v*u[6],c[1]=p*u[1]+_*u[4]+v*u[7],c[2]=p*u[2]+_*u[5]+v*u[8],c},m.transformMat4=Bo,m.transformMat4$1=Cp,m.transformQuat=OC,m.transitionTileAABBinECEF=Kg,m.translate=ql,m.transpose=function(c,a){if(c===a){var u=a[1],p=a[2],_=a[5];c[1]=a[3],c[2]=a[6],c[3]=u,c[5]=a[7],c[6]=p,c[7]=_}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c},m.triggerPluginCompletionEvent=ye,m.uniqueId=Pl,m.updateGlobeVertexNormal=function(c,a,u,p,_){const v=5*a+2;c.float32[v+0]=u,c.float32[v+1]=p,c.float32[v+2]=_},m.validateCustomStyleLayer=function(c){const a=[],u=c.id;return void 0===u&&a.push({message:`layers.${u}: missing required property "id"`}),void 0===c.render&&a.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&"2d"!==c.renderingMode&&"3d"!==c.renderingMode&&a.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),a},m.validateFilter=c=>Kn(Xd(c)),m.validateFog=c=>Kn(Cs(c)),m.validateLayer=c=>Kn(dr(c)),m.validateLight=c=>Kn(Hf(c)),m.validateSource=c=>Kn(Fr(c)),m.validateStyle=_l,m.validateTerrain=c=>Kn(Hl(c)),m.values=Ps,m.vectorTile=r_,m.version=Je,m.warnOnce=vo,m.window=re,m.wrap=lr}),mt(0,function(m){function re(me){if("number"==typeof me||"boolean"==typeof me||"string"==typeof me||null==me)return JSON.stringify(me);if(Array.isArray(me)){let ne="[";for(const fe of me)ne+=`${re(fe)},`;return`${ne}]`}let Y="{";for(const ne of Object.keys(me).sort())Y+=`${ne}:${re(me[ne])},`;return`${Y}}`}function Je(me){let Y="";for(const ne of m.refProperties)Y+=`/${re(me[ne])}`;return Y}class Xe{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y){this._layerConfigs={},this._layers={},this.update(Y,[])}update(Y,ne){for(const Te of Y)this._layerConfigs[Te.id]=Te,(this._layers[Te.id]=m.createStyleLayer(Te)).compileFilter(),this.keyCache[Te.id]&&delete this.keyCache[Te.id];for(const Te of ne)delete this.keyCache[Te],delete this._layerConfigs[Te],delete this._layers[Te];this.familiesBySource={};const fe=function(Te,Re){const qe={};for(let ze=0;ze<Te.length;ze++){const tt=Re&&Re[Te[ze].id]||Je(Te[ze]);Re&&(Re[Te[ze].id]=tt);let wt=qe[tt];wt||(wt=qe[tt]=[]),wt.push(Te[ze])}const We=[];for(const ze in qe)We.push(qe[ze]);return We}(m.values(this._layerConfigs),this.keyCache);for(const Te of fe){const Re=Te.map(Xt=>this._layers[Xt.id]),qe=Re[0];if("none"===qe.visibility)continue;const We=qe.source||"";let ze=this.familiesBySource[We];ze||(ze=this.familiesBySource[We]={});const tt=qe.sourceLayer||"_geojsonTileLayer";let wt=ze[tt];wt||(wt=ze[tt]=[]),wt.push(Re)}}}class Ve{loadTile(Y,ne){const{uid:fe,encoding:Te,rawImageData:Re,padding:qe,buildQuadTree:We}=Y,ze=m.window.ImageBitmap&&Re instanceof m.window.ImageBitmap?this.getImageData(Re,qe):Re;ne(null,new m.DEMData(fe,ze,Te,qe<1,We))}getImageData(Y,ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const fe=this.offscreenCanvasContext.getImageData(-ne,-ne,Y.width+2*ne,Y.height+2*ne);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),fe}}var Ye=function me(Y,ne){var fe,Te=Y&&Y.type;if("FeatureCollection"===Te)for(fe=0;fe<Y.features.length;fe++)me(Y.features[fe],ne);else if("GeometryCollection"===Te)for(fe=0;fe<Y.geometries.length;fe++)me(Y.geometries[fe],ne);else if("Feature"===Te)me(Y.geometry,ne);else if("Polygon"===Te)Ft(Y.coordinates,ne);else if("MultiPolygon"===Te)for(fe=0;fe<Y.coordinates.length;fe++)Ft(Y.coordinates[fe],ne);return Y};function Ft(me,Y){if(0!==me.length){pn(me[0],Y);for(var ne=1;ne<me.length;ne++)pn(me[ne],!Y)}}function pn(me,Y){for(var ne=0,fe=0,Te=0,Re=me.length,qe=Re-1;Te<Re;qe=Te++){var We=(me[Te][0]-me[qe][0])*(me[qe][1]+me[Te][1]),ze=ne+We;fe+=Math.abs(ne)>=Math.abs(We)?ne-ze+We:We-ze+ne,ne=ze}ne+fe>=0!=!!Y&&me.reverse()}const Kt=m.VectorTileFeature.prototype.toGeoJSON;class rn{constructor(Y){this._feature=Y,this.extent=m.EXTENT,this.type=Y.type,this.properties=Y.tags,"id"in Y&&!isNaN(Y.id)&&(this.id=parseInt(Y.id,10))}loadGeometry(){if(1===this._feature.type){const Y=[];for(const ne of this._feature.geometry)Y.push([new m.pointGeometry(ne[0],ne[1])]);return Y}{const Y=[];for(const ne of this._feature.geometry){const fe=[];for(const Te of ne)fe.push(new m.pointGeometry(Te[0],Te[1]));Y.push(fe)}return Y}}toGeoJSON(Y,ne,fe){return Kt.call(this,Y,ne,fe)}}class $t{constructor(Y){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=m.EXTENT,this.length=Y.length,this._features=Y}feature(Y){return new rn(this._features[Y])}}var Bt={},Se={get exports(){return Bt},set exports(me){Bt=me}},ht=m.pointGeometry,Ue=m.vectorTile.VectorTileFeature,rt=He;function He(me,Y){this.options=Y||{},this.features=me,this.length=me.length}function Et(me,Y){this.id="number"==typeof me.id?me.id:void 0,this.type=me.type,this.rawGeometry=1===me.type?[me.geometry]:me.geometry,this.properties=me.tags,this.extent=Y||4096}He.prototype.feature=function(me){return new Et(this.features[me],this.options.extent)},Et.prototype.loadGeometry=function(){var me=this.rawGeometry;this.geometry=[];for(var Y=0;Y<me.length;Y++){for(var ne=me[Y],fe=[],Te=0;Te<ne.length;Te++)fe.push(new ht(ne[Te][0],ne[Te][1]));this.geometry.push(fe)}return this.geometry},Et.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var me=this.geometry,Y=1/0,ne=-1/0,fe=1/0,Te=-1/0,Re=0;Re<me.length;Re++)for(var qe=me[Re],We=0;We<qe.length;We++){var ze=qe[We];Y=Math.min(Y,ze.x),ne=Math.max(ne,ze.x),fe=Math.min(fe,ze.y),Te=Math.max(Te,ze.y)}return[Y,fe,ne,Te]},Et.prototype.toGeoJSON=Ue.prototype.toGeoJSON;var bt=m.pbf,Ot=rt;function nn(me){var Y=new bt;return function(ne,fe){for(var Te in ne.layers)fe.writeMessage(3,zn,ne.layers[Te])}(me,Y),Y.finish()}function zn(me,Y){var ne;Y.writeVarintField(15,me.version||1),Y.writeStringField(1,me.name||""),Y.writeVarintField(5,me.extent||4096);var fe={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<me.length;ne++)fe.feature=me.feature(ne),Y.writeMessage(2,ho,fe);var Te=fe.keys;for(ne=0;ne<Te.length;ne++)Y.writeStringField(3,Te[ne]);var Re=fe.values;for(ne=0;ne<Re.length;ne++)Y.writeMessage(4,qs,Re[ne])}function ho(me,Y){var ne=me.feature;void 0!==ne.id&&Y.writeVarintField(1,ne.id),Y.writeMessage(2,xo,me),Y.writeVarintField(3,ne.type),Y.writeMessage(4,lr,ne)}function xo(me,Y){var ne=me.feature,fe=me.keys,Te=me.values,Re=me.keycache,qe=me.valuecache;for(var We in ne.properties){var ze=ne.properties[We],tt=Re[We];if(null!==ze){void 0===tt&&(fe.push(We),Re[We]=tt=fe.length-1),Y.writeVarint(tt);var wt=typeof ze;"string"!==wt&&"boolean"!==wt&&"number"!==wt&&(ze=JSON.stringify(ze));var Xt=wt+":"+ze,St=qe[Xt];void 0===St&&(Te.push(ze),qe[Xt]=St=Te.length-1),Y.writeVarint(St)}}}function Bn(me,Y){return(Y<<3)+(7&me)}function vr(me){return me<<1^me>>31}function lr(me,Y){for(var ne=me.loadGeometry(),fe=me.type,Te=0,Re=0,qe=ne.length,We=0;We<qe;We++){var ze=ne[We],tt=1;1===fe&&(tt=ze.length),Y.writeVarint(Bn(1,tt));for(var wt=3===fe?ze.length-1:ze.length,Xt=0;Xt<wt;Xt++){1===Xt&&1!==fe&&Y.writeVarint(Bn(2,wt-1));var St=ze[Xt].x-Te,Sn=ze[Xt].y-Re;Y.writeVarint(vr(St)),Y.writeVarint(vr(Sn)),Te+=St,Re+=Sn}3===fe&&Y.writeVarint(Bn(7,1))}}function qs(me,Y){var ne=typeof me;"string"===ne?Y.writeStringField(1,me):"boolean"===ne?Y.writeBooleanField(7,me):"number"===ne&&(me%1!=0?Y.writeDoubleField(3,me):me<0?Y.writeSVarintField(6,me):Y.writeVarintField(5,me))}function Ps(me,Y,ne,fe,Te,Re){if(Te-fe<=ne)return;const qe=fe+Te>>1;Jn(me,Y,qe,fe,Te,Re%2),Ps(me,Y,ne,fe,qe-1,Re+1),Ps(me,Y,ne,qe+1,Te,Re+1)}function Jn(me,Y,ne,fe,Te,Re){for(;Te>fe;){if(Te-fe>600){const tt=Te-fe+1,wt=ne-fe+1,Xt=Math.log(tt),St=.5*Math.exp(2*Xt/3),Sn=.5*Math.sqrt(Xt*St*(tt-St)/tt)*(wt-tt/2<0?-1:1);Jn(me,Y,ne,Math.max(fe,Math.floor(ne-wt*St/tt+Sn)),Math.min(Te,Math.floor(ne+(tt-wt)*St/tt+Sn)),Re)}const qe=Y[2*ne+Re];let We=fe,ze=Te;for(fa(me,Y,fe,ne),Y[2*Te+Re]>qe&&fa(me,Y,fe,Te);We<ze;){for(fa(me,Y,We,ze),We++,ze--;Y[2*We+Re]<qe;)We++;for(;Y[2*ze+Re]>qe;)ze--}Y[2*fe+Re]===qe?fa(me,Y,fe,ze):(ze++,fa(me,Y,ze,Te)),ze<=ne&&(fe=ze+1),ne<=ze&&(Te=ze-1)}}function fa(me,Y,ne,fe){Pl(me,ne,fe),Pl(Y,2*ne,2*fe),Pl(Y,2*ne+1,2*fe+1)}function Pl(me,Y,ne){const fe=me[Y];me[Y]=me[ne],me[ne]=fe}function Os(me,Y,ne,fe){const Te=me-ne,Re=Y-fe;return Te*Te+Re*Re}Se.exports=nn,Bt.fromVectorTileJs=nn,Bt.fromGeojsonVt=function(me,Y){Y=Y||{};var ne={};for(var fe in me)ne[fe]=new Ot(me[fe].features,Y),ne[fe].name=fe,ne[fe].version=Y.version,ne[fe].extent=Y.extent;return nn({layers:ne})},Bt.GeoJSONWrapper=Ot;const ss=me=>me[0],gi=me=>me[1];class ma{constructor(Y,ne=ss,fe=gi,Te=64,Re=Float64Array){this.nodeSize=Te,this.points=Y;const qe=Y.length<65536?Uint16Array:Uint32Array,We=this.ids=new qe(Y.length),ze=this.coords=new Re(2*Y.length);for(let tt=0;tt<Y.length;tt++)We[tt]=tt,ze[2*tt]=ne(Y[tt]),ze[2*tt+1]=fe(Y[tt]);Ps(We,ze,Te,0,We.length-1,0)}range(Y,ne,fe,Te){return function(Re,qe,We,ze,tt,wt,Xt){const St=[0,Re.length-1,0],Sn=[];let dn,Mn;for(;St.length;){const Vn=St.pop(),oi=St.pop(),Ri=St.pop();if(oi-Ri<=Xt){for(let oo=Ri;oo<=oi;oo++)dn=qe[2*oo],Mn=qe[2*oo+1],dn>=We&&dn<=tt&&Mn>=ze&&Mn<=wt&&Sn.push(Re[oo]);continue}const On=Math.floor((Ri+oi)/2);dn=qe[2*On],Mn=qe[2*On+1],dn>=We&&dn<=tt&&Mn>=ze&&Mn<=wt&&Sn.push(Re[On]);const Vi=(Vn+1)%2;(0===Vn?We<=dn:ze<=Mn)&&(St.push(Ri),St.push(On-1),St.push(Vi)),(0===Vn?tt>=dn:wt>=Mn)&&(St.push(On+1),St.push(oi),St.push(Vi))}return Sn}(this.ids,this.coords,Y,ne,fe,Te,this.nodeSize)}within(Y,ne,fe){return function(Te,Re,qe,We,ze,tt){const wt=[0,Te.length-1,0],Xt=[],St=ze*ze;for(;wt.length;){const Sn=wt.pop(),dn=wt.pop(),Mn=wt.pop();if(dn-Mn<=tt){for(let Vi=Mn;Vi<=dn;Vi++)Os(Re[2*Vi],Re[2*Vi+1],qe,We)<=St&&Xt.push(Te[Vi]);continue}const Vn=Math.floor((Mn+dn)/2),oi=Re[2*Vn],Ri=Re[2*Vn+1];Os(oi,Ri,qe,We)<=St&&Xt.push(Te[Vn]);const On=(Sn+1)%2;(0===Sn?qe-ze<=oi:We-ze<=Ri)&&(wt.push(Mn),wt.push(Vn-1),wt.push(On)),(0===Sn?qe+ze>=oi:We+ze>=Ri)&&(wt.push(Vn+1),wt.push(dn),wt.push(On))}return Xt}(this.ids,this.coords,Y,ne,fe,this.nodeSize)}}const Rs={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:me=>me},ji=Math.fround||(Yn=new Float32Array(1),me=>(Yn[0]=+me,Yn[0]));var Yn;class Vo{constructor(Y){this.options=Ol(Object.create(Rs),Y),this.trees=new Array(this.options.maxZoom+1)}load(Y){const{log:ne,minZoom:fe,maxZoom:Te,nodeSize:Re}=this.options;ne&&console.time("total time");const qe=`prepare ${Y.length} points`;ne&&console.time(qe),this.points=Y;let We=[];for(let ze=0;ze<Y.length;ze++)Y[ze].geometry&&We.push(vo(Y[ze],ze));this.trees[Te+1]=new ma(We,Hh,yu,Re,Float32Array),ne&&console.timeEnd(qe);for(let ze=Te;ze>=fe;ze--){const tt=+Date.now();We=this._cluster(We,ze),this.trees[ze]=new ma(We,Hh,yu,Re,Float32Array),ne&&console.log("z%d: %d clusters in %dms",ze,We.length,+Date.now()-tt)}return ne&&console.timeEnd("total time"),this}getClusters(Y,ne){let fe=((Y[0]+180)%360+360)%360-180;const Te=Math.max(-90,Math.min(90,Y[1]));let Re=180===Y[2]?180:((Y[2]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)fe=-180,Re=180;else if(fe>Re){const wt=this.getClusters([fe,Te,180,qe],ne),Xt=this.getClusters([-180,Te,Re,qe],ne);return wt.concat(Xt)}const We=this.trees[this._limitZoom(ne)],ze=We.range(La(fe),yc(qe),La(Re),yc(Te)),tt=[];for(const wt of ze){const Xt=We.points[wt];tt.push(Xt.numPoints?Ra(Xt):this.points[Xt.index])}return tt}getChildren(Y){const ne=this._getOriginId(Y),fe=this._getOriginZoom(Y),Te="No cluster with the specified id.",Re=this.trees[fe];if(!Re)throw new Error(Te);const qe=Re.points[ne];if(!qe)throw new Error(Te);const We=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),ze=Re.within(qe.x,qe.y,We),tt=[];for(const wt of ze){const Xt=Re.points[wt];Xt.parentId===Y&&tt.push(Xt.numPoints?Ra(Xt):this.points[Xt.index])}if(0===tt.length)throw new Error(Te);return tt}getLeaves(Y,ne,fe){const Te=[];return this._appendLeaves(Te,Y,ne=ne||10,fe=fe||0,0),Te}getTile(Y,ne,fe){const Te=this.trees[this._limitZoom(Y)],Re=Math.pow(2,Y),{extent:qe,radius:We}=this.options,ze=We/qe,tt=(fe-ze)/Re,wt=(fe+1+ze)/Re,Xt={features:[]};return this._addTileFeatures(Te.range((ne-ze)/Re,tt,(ne+1+ze)/Re,wt),Te.points,ne,fe,Re,Xt),0===ne&&this._addTileFeatures(Te.range(1-ze/Re,tt,1,wt),Te.points,Re,fe,Re,Xt),ne===Re-1&&this._addTileFeatures(Te.range(0,tt,ze/Re,wt),Te.points,-1,fe,Re,Xt),Xt.features.length?Xt:null}getClusterExpansionZoom(Y){let ne=this._getOriginZoom(Y)-1;for(;ne<=this.options.maxZoom;){const fe=this.getChildren(Y);if(ne++,1!==fe.length)break;Y=fe[0].properties.cluster_id}return ne}_appendLeaves(Y,ne,fe,Te,Re){const qe=this.getChildren(ne);for(const We of qe){const ze=We.properties;if(ze&&ze.cluster?Re+ze.point_count<=Te?Re+=ze.point_count:Re=this._appendLeaves(Y,ze.cluster_id,fe,Te,Re):Re<Te?Re++:Y.push(We),Y.length===fe)break}return Re}_addTileFeatures(Y,ne,fe,Te,Re,qe){for(const We of Y){const ze=ne[We],tt=ze.numPoints;let wt,Xt,St;if(tt)wt=zi(ze),Xt=ze.x,St=ze.y;else{const Mn=this.points[ze.index];wt=Mn.properties,Xt=La(Mn.geometry.coordinates[0]),St=yc(Mn.geometry.coordinates[1])}const Sn={type:1,geometry:[[Math.round(this.options.extent*(Xt*Re-fe)),Math.round(this.options.extent*(St*Re-Te))]],tags:wt};let dn;tt?dn=ze.id:this.options.generateId?dn=ze.index:this.points[ze.index].id&&(dn=this.points[ze.index].id),void 0!==dn&&(Sn.id=dn),qe.features.push(Sn)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,ne){const fe=[],{radius:Te,extent:Re,reduce:qe,minPoints:We}=this.options,ze=Te/(Re*Math.pow(2,ne));for(let tt=0;tt<Y.length;tt++){const wt=Y[tt];if(wt.zoom<=ne)continue;wt.zoom=ne;const Xt=this.trees[ne+1],St=Xt.within(wt.x,wt.y,ze),Sn=wt.numPoints||1;let dn=Sn;for(const Mn of St){const Vn=Xt.points[Mn];Vn.zoom>ne&&(dn+=Vn.numPoints||1)}if(dn>Sn&&dn>=We){let Mn=wt.x*Sn,Vn=wt.y*Sn,oi=qe&&Sn>1?this._map(wt,!0):null;const Ri=(tt<<5)+(ne+1)+this.points.length;for(const On of St){const Vi=Xt.points[On];if(Vi.zoom<=ne)continue;Vi.zoom=ne;const oo=Vi.numPoints||1;Mn+=Vi.x*oo,Vn+=Vi.y*oo,Vi.parentId=Ri,qe&&(oi||(oi=this._map(wt,!0)),qe(oi,this._map(Vi)))}wt.parentId=Ri,fe.push(Nn(Mn/dn,Vn/dn,Ri,dn,oi))}else if(fe.push(wt),dn>1)for(const Mn of St){const Vn=Xt.points[Mn];Vn.zoom<=ne||(Vn.zoom=ne,fe.push(Vn))}}return fe}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,ne){if(Y.numPoints)return ne?Ol({},Y.properties):Y.properties;const fe=this.points[Y.index].properties,Te=this.options.map(fe);return ne&&Te===fe?Ol({},Te):Te}}function Nn(me,Y,ne,fe,Te){return{x:ji(me),y:ji(Y),zoom:1/0,id:ne,parentId:-1,numPoints:fe,properties:Te}}function vo(me,Y){const[ne,fe]=me.geometry.coordinates;return{x:ji(La(ne)),y:ji(yc(fe)),zoom:1/0,index:Y,parentId:-1}}function Ra(me){return{type:"Feature",id:me.id,properties:zi(me),geometry:{type:"Point",coordinates:[(Y=me.x,360*(Y-.5)),jh(me.y)]}};var Y}function zi(me){const Y=me.numPoints,ne=Y>=1e4?`${Math.round(Y/1e3)}k`:Y>=1e3?Math.round(Y/100)/10+"k":Y;return Ol(Ol({},me.properties),{cluster:!0,cluster_id:me.id,point_count:Y,point_count_abbreviated:ne})}function La(me){return me/360+.5}function yc(me){const Y=Math.sin(me*Math.PI/180),ne=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return ne<0?0:ne>1?1:ne}function jh(me){const Y=(180-360*me)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Ol(me,Y){for(const ne in Y)me[ne]=Y[ne];return me}function Hh(me){return me.x}function yu(me){return me.y}function Ed(me,Y,ne,fe){for(var Te,Re=fe,qe=ne-Y>>1,We=ne-Y,ze=me[Y],tt=me[Y+1],wt=me[ne],Xt=me[ne+1],St=Y+3;St<ne;St+=3){var Sn=Fa(me[St],me[St+1],ze,tt,wt,Xt);if(Sn>Re)Te=St,Re=Sn;else if(Sn===Re){var dn=Math.abs(St-qe);dn<We&&(Te=St,We=dn)}}Re>fe&&(Te-Y>3&&Ed(me,Y,Te,fe),me[Te+2]=Re,ne-Te>3&&Ed(me,Te,ne,fe))}function Fa(me,Y,ne,fe,Te,Re){var qe=Te-ne,We=Re-fe;if(0!==qe||0!==We){var ze=((me-ne)*qe+(Y-fe)*We)/(qe*qe+We*We);ze>1?(ne=Te,fe=Re):ze>0&&(ne+=qe*ze,fe+=We*ze)}return(qe=me-ne)*qe+(We=Y-fe)*We}function za(me,Y,ne,fe){var Te={id:void 0===me?null:me,type:Y,geometry:ne,tags:fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Re){var qe=Re.geometry,We=Re.type;if("Point"===We||"MultiPoint"===We||"LineString"===We)Sd(Re,qe);else if("Polygon"===We||"MultiLineString"===We)for(var ze=0;ze<qe.length;ze++)Sd(Re,qe[ze]);else if("MultiPolygon"===We)for(ze=0;ze<qe.length;ze++)for(var tt=0;tt<qe[ze].length;tt++)Sd(Re,qe[ze][tt])}(Te),Te}function Sd(me,Y){for(var ne=0;ne<Y.length;ne+=3)me.minX=Math.min(me.minX,Y[ne]),me.minY=Math.min(me.minY,Y[ne+1]),me.maxX=Math.max(me.maxX,Y[ne]),me.maxY=Math.max(me.maxY,Y[ne+1])}function vc(me,Y,ne,fe){if(Y.geometry){var Te=Y.geometry.coordinates,Re=Y.geometry.type,qe=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2),We=[],ze=Y.id;if(ne.promoteId?ze=Y.properties[ne.promoteId]:ne.generateId&&(ze=fe||0),"Point"===Re)$h(Te,We);else if("MultiPoint"===Re)for(var tt=0;tt<Te.length;tt++)$h(Te[tt],We);else if("LineString"===Re)al(Te,We,qe,!1);else if("MultiLineString"===Re){if(ne.lineMetrics){for(tt=0;tt<Te.length;tt++)al(Te[tt],We=[],qe,!1),me.push(za(ze,"LineString",We,Y.properties));return}vu(Te,We,qe,!1)}else if("Polygon"===Re)vu(Te,We,qe,!0);else{if("MultiPolygon"!==Re){if("GeometryCollection"===Re){for(tt=0;tt<Y.geometry.geometries.length;tt++)vc(me,{id:ze,geometry:Y.geometry.geometries[tt],properties:Y.properties},ne,fe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(tt=0;tt<Te.length;tt++){var wt=[];vu(Te[tt],wt,qe,!0),We.push(wt)}}me.push(za(ze,Re,We,Y.properties))}}function $h(me,Y){Y.push(Dd(me[0])),Y.push(Md(me[1])),Y.push(0)}function al(me,Y,ne,fe){for(var Te,Re,qe=0,We=0;We<me.length;We++){var ze=Dd(me[We][0]),tt=Md(me[We][1]);Y.push(ze),Y.push(tt),Y.push(0),We>0&&(qe+=fe?(Te*tt-ze*Re)/2:Math.sqrt(Math.pow(ze-Te,2)+Math.pow(tt-Re,2))),Te=ze,Re=tt}var wt=Y.length-3;Y[2]=1,Ed(Y,0,wt,ne),Y[wt+2]=1,Y.size=Math.abs(qe),Y.start=0,Y.end=Y.size}function vu(me,Y,ne,fe){for(var Te=0;Te<me.length;Te++){var Re=[];al(me[Te],Re,ne,fe),Y.push(Re)}}function Dd(me){return me/360+.5}function Md(me){var Y=Math.sin(me*Math.PI/180),ne=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return ne<0?0:ne>1?1:ne}function Zs(me,Y,ne,fe,Te,Re,qe,We){if(fe/=Y,Re>=(ne/=Y)&&qe<fe)return me;if(qe<ne||Re>=fe)return null;for(var ze=[],tt=0;tt<me.length;tt++){var wt=me[tt],Xt=wt.geometry,St=wt.type,Sn=0===Te?wt.minX:wt.minY,dn=0===Te?wt.maxX:wt.maxY;if(Sn>=ne&&dn<fe)ze.push(wt);else if(!(dn<ne||Sn>=fe)){var Mn=[];if("Point"===St||"MultiPoint"===St)ga(Xt,Mn,ne,fe,Te);else if("LineString"===St)Rl(Xt,Mn,ne,fe,Te,!1,We.lineMetrics);else if("MultiLineString"===St)Id(Xt,Mn,ne,fe,Te,!1);else if("Polygon"===St)Id(Xt,Mn,ne,fe,Te,!0);else if("MultiPolygon"===St)for(var Vn=0;Vn<Xt.length;Vn++){var oi=[];Id(Xt[Vn],oi,ne,fe,Te,!0),oi.length&&Mn.push(oi)}if(Mn.length){if(We.lineMetrics&&"LineString"===St){for(Vn=0;Vn<Mn.length;Vn++)ze.push(za(wt.id,St,Mn[Vn],wt.tags));continue}"LineString"!==St&&"MultiLineString"!==St||(1===Mn.length?(St="LineString",Mn=Mn[0]):St="MultiLineString"),"Point"!==St&&"MultiPoint"!==St||(St=3===Mn.length?"Point":"MultiPoint"),ze.push(za(wt.id,St,Mn,wt.tags))}}}return ze.length?ze:null}function ga(me,Y,ne,fe,Te){for(var Re=0;Re<me.length;Re+=3){var qe=me[Re+Te];qe>=ne&&qe<=fe&&(Y.push(me[Re]),Y.push(me[Re+1]),Y.push(me[Re+2]))}}function Rl(me,Y,ne,fe,Te,Re,qe){for(var We,ze,tt=bu(me),wt=0===Te?xu:wu,Xt=me.start,St=0;St<me.length-3;St+=3){var Sn=me[St],dn=me[St+1],Mn=me[St+2],Vn=me[St+3],oi=me[St+4],Ri=0===Te?Sn:dn,On=0===Te?Vn:oi,Vi=!1;qe&&(We=Math.sqrt(Math.pow(Sn-Vn,2)+Math.pow(dn-oi,2))),Ri<ne?On>ne&&(ze=wt(tt,Sn,dn,Vn,oi,ne),qe&&(tt.start=Xt+We*ze)):Ri>fe?On<fe&&(ze=wt(tt,Sn,dn,Vn,oi,fe),qe&&(tt.start=Xt+We*ze)):kd(tt,Sn,dn,Mn),On<ne&&Ri>=ne&&(ze=wt(tt,Sn,dn,Vn,oi,ne),Vi=!0),On>fe&&Ri<=fe&&(ze=wt(tt,Sn,dn,Vn,oi,fe),Vi=!0),!Re&&Vi&&(qe&&(tt.end=Xt+We*ze),Y.push(tt),tt=bu(me)),qe&&(Xt+=We)}var oo=me.length-3;Sn=me[oo],dn=me[oo+1],Mn=me[oo+2],(Ri=0===Te?Sn:dn)>=ne&&Ri<=fe&&kd(tt,Sn,dn,Mn),oo=tt.length-3,Re&&oo>=3&&(tt[oo]!==tt[0]||tt[oo+1]!==tt[1])&&kd(tt,tt[0],tt[1],tt[2]),tt.length&&Y.push(tt)}function bu(me){var Y=[];return Y.size=me.size,Y.start=me.start,Y.end=me.end,Y}function Id(me,Y,ne,fe,Te,Re){for(var qe=0;qe<me.length;qe++)Rl(me[qe],Y,ne,fe,Te,Re,!1)}function kd(me,Y,ne,fe){me.push(Y),me.push(ne),me.push(fe)}function xu(me,Y,ne,fe,Te,Re){var qe=(Re-Y)/(fe-Y);return me.push(Re),me.push(ne+(Te-ne)*qe),me.push(1),qe}function wu(me,Y,ne,fe,Te,Re){var qe=(Re-ne)/(Te-ne);return me.push(Y+(fe-Y)*qe),me.push(Re),me.push(1),qe}function Gh(me,Y){for(var ne=[],fe=0;fe<me.length;fe++){var Te,Re=me[fe],qe=Re.type;if("Point"===qe||"MultiPoint"===qe||"LineString"===qe)Te=Cu(Re.geometry,Y);else if("MultiLineString"===qe||"Polygon"===qe){Te=[];for(var We=0;We<Re.geometry.length;We++)Te.push(Cu(Re.geometry[We],Y))}else if("MultiPolygon"===qe)for(Te=[],We=0;We<Re.geometry.length;We++){for(var ze=[],tt=0;tt<Re.geometry[We].length;tt++)ze.push(Cu(Re.geometry[We][tt],Y));Te.push(ze)}ne.push(za(Re.id,qe,Te,Re.tags))}return ne}function Cu(me,Y){var ne=[];ne.size=me.size,void 0!==me.start&&(ne.start=me.start,ne.end=me.end);for(var fe=0;fe<me.length;fe+=3)ne.push(me[fe]+Y,me[fe+1],me[fe+2]);return ne}function Na(me,Y){if(me.transformed)return me;var ne,fe,Te,Re=1<<me.z,qe=me.x,We=me.y;for(ne=0;ne<me.features.length;ne++){var ze=me.features[ne],tt=ze.geometry,wt=ze.type;if(ze.geometry=[],1===wt)for(fe=0;fe<tt.length;fe+=2)ze.geometry.push(Tu(tt[fe],tt[fe+1],Y,Re,qe,We));else for(fe=0;fe<tt.length;fe++){var Xt=[];for(Te=0;Te<tt[fe].length;Te+=2)Xt.push(Tu(tt[fe][Te],tt[fe][Te+1],Y,Re,qe,We));ze.geometry.push(Xt)}}return me.transformed=!0,me}function Tu(me,Y,ne,fe,Te,Re){return[Math.round(ne*(me*fe-Te)),Math.round(ne*(Y*fe-Re))]}function Eu(me,Y,ne,fe,Te){for(var Re=Y===Te.maxZoom?0:Te.tolerance/((1<<Y)*Te.extent),qe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ne,y:fe,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},We=0;We<me.length;We++){qe.numFeatures++,Ad(qe,me[We],Re,Te);var ze=me[We].minX,tt=me[We].minY,wt=me[We].maxX,Xt=me[We].maxY;ze<qe.minX&&(qe.minX=ze),tt<qe.minY&&(qe.minY=tt),wt>qe.maxX&&(qe.maxX=wt),Xt>qe.maxY&&(qe.maxY=Xt)}return qe}function Ad(me,Y,ne,fe){var Te=Y.geometry,Re=Y.type,qe=[];if("Point"===Re||"MultiPoint"===Re)for(var We=0;We<Te.length;We+=3)qe.push(Te[We]),qe.push(Te[We+1]),me.numPoints++,me.numSimplified++;else if("LineString"===Re)bc(qe,Te,me,ne,!1,!1);else if("MultiLineString"===Re||"Polygon"===Re)for(We=0;We<Te.length;We++)bc(qe,Te[We],me,ne,"Polygon"===Re,0===We);else if("MultiPolygon"===Re)for(var ze=0;ze<Te.length;ze++){var tt=Te[ze];for(We=0;We<tt.length;We++)bc(qe,tt[We],me,ne,!0,0===We)}if(qe.length){var wt=Y.tags||null;if("LineString"===Re&&fe.lineMetrics){for(var Xt in wt={},Y.tags)wt[Xt]=Y.tags[Xt];wt.mapbox_clip_start=Te.start/Te.size,wt.mapbox_clip_end=Te.end/Te.size}var St={geometry:qe,type:"Polygon"===Re||"MultiPolygon"===Re?3:"LineString"===Re||"MultiLineString"===Re?2:1,tags:wt};null!==Y.id&&(St.id=Y.id),me.features.push(St)}}function bc(me,Y,ne,fe,Te,Re){var qe=fe*fe;if(fe>0&&Y.size<(Te?qe:fe))ne.numPoints+=Y.length/3;else{for(var We=[],ze=0;ze<Y.length;ze+=3)(0===fe||Y[ze+2]>qe)&&(ne.numSimplified++,We.push(Y[ze]),We.push(Y[ze+1])),ne.numPoints++;Te&&function(tt,wt){for(var Xt=0,St=0,Sn=tt.length,dn=Sn-2;St<Sn;dn=St,St+=2)Xt+=(tt[St]-tt[dn])*(tt[St+1]+tt[dn+1]);if(Xt>0===wt)for(St=0,Sn=tt.length;St<Sn/2;St+=2){var Mn=tt[St],Vn=tt[St+1];tt[St]=tt[Sn-2-St],tt[St+1]=tt[Sn-1-St],tt[Sn-2-St]=Mn,tt[Sn-1-St]=Vn}}(We,Re),me.push(We)}}function Ll(me,Y){var ne=(Y=this.options=function(Te,Re){for(var qe in Re)Te[qe]=Re[qe];return Te}(Object.create(this.options),Y)).debug;if(ne&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");var Te,Re,qe,We,ze,tt,fe=function(Te,Re){var qe=[];if("FeatureCollection"===Te.type)for(var We=0;We<Te.features.length;We++)vc(qe,Te.features[We],Re,We);else vc(qe,"Feature"===Te.type?Te:{geometry:Te},Re);return qe}(me,Y);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),We=Te=fe,ze=Zs(Te,1,-1-(qe=(Re=Y).buffer/Re.extent),qe,0,-1,2,Re),tt=Zs(Te,1,1-qe,2+qe,0,-1,2,Re),(ze||tt)&&(We=Zs(Te,1,-qe,1+qe,0,-1,2,Re)||[],ze&&(We=Gh(ze,1).concat(We)),tt&&(We=We.concat(Gh(tt,-1)))),(fe=We).length&&this.splitTile(fe,0,0,0),ne&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function vs(me,Y,ne){return 32*((1<<me)*ne+Y)+me}function Fl(me,Y){const ne=me.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);const fe=this._geoJSONIndex.getTile(ne.z,ne.x,ne.y);if(!fe)return Y(null,null);const Te=new $t(fe.features);let Re=Bt(Te);0===Re.byteOffset&&Re.byteLength===Re.buffer.byteLength||(Re=new Uint8Array(Re)),Y(null,{vectorTile:Te,rawData:Re.buffer})}Ll.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ll.prototype.splitTile=function(me,Y,ne,fe,Te,Re,qe){for(var We=[me,Y,ne,fe],ze=this.options,tt=ze.debug;We.length;){fe=We.pop(),ne=We.pop(),Y=We.pop(),me=We.pop();var wt=1<<Y,Xt=vs(Y,ne,fe),St=this.tiles[Xt];if(!St&&(tt>1&&console.time("creation"),St=this.tiles[Xt]=Eu(me,Y,ne,fe,ze),this.tileCoords.push({z:Y,x:ne,y:fe}),tt)){tt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,ne,fe,St.numFeatures,St.numPoints,St.numSimplified),console.timeEnd("creation"));var Sn="z"+Y;this.stats[Sn]=(this.stats[Sn]||0)+1,this.total++}if(St.source=me,Te){if(Y===ze.maxZoom||Y===Te)continue;var dn=1<<Te-Y;if(ne!==Math.floor(Re/dn)||fe!==Math.floor(qe/dn))continue}else if(Y===ze.indexMaxZoom||St.numPoints<=ze.indexMaxPoints)continue;if(St.source=null,0!==me.length){tt>1&&console.time("clipping");var Mn,Vn,oi,Ri,On,Vi,oo=.5*ze.buffer/ze.extent,ll=.5-oo,Ba=.5+oo,gt=1+oo;Mn=Vn=oi=Ri=null,On=Zs(me,wt,ne-oo,ne+Ba,0,St.minX,St.maxX,ze),Vi=Zs(me,wt,ne+ll,ne+gt,0,St.minX,St.maxX,ze),me=null,On&&(Mn=Zs(On,wt,fe-oo,fe+Ba,1,St.minY,St.maxY,ze),Vn=Zs(On,wt,fe+ll,fe+gt,1,St.minY,St.maxY,ze),On=null),Vi&&(oi=Zs(Vi,wt,fe-oo,fe+Ba,1,St.minY,St.maxY,ze),Ri=Zs(Vi,wt,fe+ll,fe+gt,1,St.minY,St.maxY,ze),Vi=null),tt>1&&console.timeEnd("clipping"),We.push(Mn||[],Y+1,2*ne,2*fe),We.push(Vn||[],Y+1,2*ne,2*fe+1),We.push(oi||[],Y+1,2*ne+1,2*fe),We.push(Ri||[],Y+1,2*ne+1,2*fe+1)}}},Ll.prototype.getTile=function(me,Y,ne){var fe=this.options,Te=fe.extent,Re=fe.debug;if(me<0||me>24)return null;var qe=1<<me,We=vs(me,Y=(Y%qe+qe)%qe,ne);if(this.tiles[We])return Na(this.tiles[We],Te);Re>1&&console.log("drilling down to z%d-%d-%d",me,Y,ne);for(var ze,tt=me,wt=Y,Xt=ne;!ze&&tt>0;)tt--,wt=Math.floor(wt/2),Xt=Math.floor(Xt/2),ze=this.tiles[vs(tt,wt,Xt)];return ze&&ze.source?(Re>1&&console.log("found parent tile z%d-%d-%d",tt,wt,Xt),Re>1&&console.time("drilling down"),this.splitTile(ze.source,tt,wt,Xt,me,Y,ne),Re>1&&console.timeEnd("drilling down"),this.tiles[We]?Na(this.tiles[We],Te):null):null};class Pd extends m.VectorTileWorkerSource{constructor(Y,ne,fe,Te,Re){super(Y,ne,fe,Te,Fl),Re&&(this.loadGeoJSON=Re)}loadData(Y,ne){const fe=Y&&Y.request,Te=fe&&fe.collectResourceTiming;this.loadGeoJSON(Y,(Re,qe)=>{if(Re||!qe)return ne(Re);if("object"!=typeof qe)return ne(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{Ye(qe,!0);try{if(Y.filter){const ze=m.createExpression(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ze.result)throw new Error(ze.value.map(wt=>`${wt.key}: ${wt.message}`).join(", "));qe={type:"FeatureCollection",features:qe.features.filter(wt=>ze.value.evaluate({zoom:0},wt))}}this._geoJSONIndex=Y.cluster?new Vo(function({superclusterOptions:ze,clusterProperties:tt}){if(!tt||!ze)return ze;const wt={},Xt={},St={accumulated:null,zoom:0},Sn={properties:null},dn=Object.keys(tt);for(const Mn of dn){const[Vn,oi]=tt[Mn],Ri=m.createExpression(oi),On=m.createExpression("string"==typeof Vn?[Vn,["accumulated"],["get",Mn]]:Vn);wt[Mn]=Ri.value,Xt[Mn]=On.value}return ze.map=Mn=>{Sn.properties=Mn;const Vn={};for(const oi of dn)Vn[oi]=wt[oi].evaluate(St,Sn);return Vn},ze.reduce=(Mn,Vn)=>{Sn.properties=Vn;for(const oi of dn)St.accumulated=Mn[oi],Mn[oi]=Xt[oi].evaluate(St,Sn)},ze}(Y)).load(qe.features):new Ll(ze=qe,Y.geojsonVtOptions)}catch(ze){return ne(ze)}this.loaded={};const We={};if(Te){const ze=m.getPerformanceMeasurement(fe);ze&&(We.resourceTiming={},We.resourceTiming[Y.source]=JSON.parse(JSON.stringify(ze)))}ne(null,We)}var ze})}reloadTile(Y,ne){const fe=this.loaded;return fe&&fe[Y.uid]?super.reloadTile(Y,ne):this.loadTile(Y,ne)}loadGeoJSON(Y,ne){if(Y.request)m.getJSON(Y.request,ne);else{if("string"!=typeof Y.data)return ne(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));try{return ne(null,JSON.parse(Y.data))}catch{return ne(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Y,ne){try{ne(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(fe){ne(fe)}}getClusterChildren(Y,ne){try{ne(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(fe){ne(fe)}}getClusterLeaves(Y,ne){try{ne(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(fe){ne(fe)}}}class zl{constructor(Y){this.self=Y,this.actor=new m.Actor(Y,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=m.getProjection({name:"mercator"}),this.workerSourceTypes={vector:m.VectorTileWorkerSource,geojson:Pd},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ne,fe)=>{if(this.workerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.workerSourceTypes[ne]=fe},this.self.registerRTLTextPlugin=ne=>{if(m.plugin.isParsed())throw new Error("RTL text plugin already registered.");m.plugin.applyArabicShaping=ne.applyArabicShaping,m.plugin.processBidirectionalText=ne.processBidirectionalText,m.plugin.processStyledBidirectionalText=ne.processStyledBidirectionalText}}clearCaches(Y,ne,fe){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y],fe()}checkIfReady(Y,ne,fe){fe()}setReferrer(Y,ne){this.referrer=ne}spriteLoaded(Y,ne){this.isSpriteLoaded[Y]=ne;for(const fe in this.workerSources[Y]){const Te=this.workerSources[Y][fe];for(const Re in Te)Te[Re]instanceof m.VectorTileWorkerSource&&(Te[Re].isSpriteLoaded=ne,Te[Re].fire(new m.Event("isSpriteLoaded")))}}setImages(Y,ne,fe){this.availableImages[Y]=ne;for(const Te in this.workerSources[Y]){const Re=this.workerSources[Y][Te];for(const qe in Re)Re[qe].availableImages=ne}fe()}enableTerrain(Y,ne,fe){this.terrain=ne,fe()}setProjection(Y,ne){this.projections[Y]=m.getProjection(ne)}setLayers(Y,ne,fe){this.getLayerIndex(Y).replace(ne),fe()}updateLayers(Y,ne,fe){this.getLayerIndex(Y).update(ne.layers,ne.removedIds),fe()}loadTile(Y,ne,fe){const Te=this.enableTerrain?m.extend({enableTerrain:this.terrain},ne):ne;Te.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ne.type,ne.source).loadTile(Te,fe)}loadDEMTile(Y,ne,fe){const Te=this.enableTerrain?m.extend({buildQuadTree:this.terrain},ne):ne;this.getDEMWorkerSource(Y,ne.source).loadTile(Te,fe)}reloadTile(Y,ne,fe){const Te=this.enableTerrain?m.extend({enableTerrain:this.terrain},ne):ne;Te.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ne.type,ne.source).reloadTile(Te,fe)}abortTile(Y,ne,fe){this.getWorkerSource(Y,ne.type,ne.source).abortTile(ne,fe)}removeTile(Y,ne,fe){this.getWorkerSource(Y,ne.type,ne.source).removeTile(ne,fe)}removeSource(Y,ne,fe){if(!this.workerSources[Y]||!this.workerSources[Y][ne.type]||!this.workerSources[Y][ne.type][ne.source])return;const Te=this.workerSources[Y][ne.type][ne.source];delete this.workerSources[Y][ne.type][ne.source],void 0!==Te.removeSource?Te.removeSource(ne,fe):fe()}loadWorkerSource(Y,ne,fe){try{this.self.importScripts(ne.url),fe()}catch(Te){fe(Te.toString())}}syncRTLPluginState(Y,ne,fe){try{m.plugin.setState(ne);const Te=m.plugin.getPluginURL();if(m.plugin.isLoaded()&&!m.plugin.isParsed()&&null!=Te){this.self.importScripts(Te);const Re=m.plugin.isParsed();fe(Re?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Te}`),Re)}}catch(Te){fe(Te.toString())}}getAvailableImages(Y){let ne=this.availableImages[Y];return ne||(ne=[]),ne}getLayerIndex(Y){let ne=this.layerIndexes[Y];return ne||(ne=this.layerIndexes[Y]=new Xe),ne}getWorkerSource(Y,ne,fe){return this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][ne]||(this.workerSources[Y][ne]={}),this.workerSources[Y][ne][fe]||(this.workerSources[Y][ne][fe]=new this.workerSourceTypes[ne]({send:(Re,qe,We,ze,tt,wt)=>{this.actor.send(Re,qe,We,Y,tt,wt)},scheduler:this.actor.scheduler},this.getLayerIndex(Y),this.getAvailableImages(Y),this.isSpriteLoaded[Y])),this.workerSources[Y][ne][fe]}getDEMWorkerSource(Y,ne){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][ne]||(this.demWorkerSources[Y][ne]=new Ve),this.demWorkerSources[Y][ne]}enforceCacheSizeLimit(Y,ne){m.enforceCacheSizeLimit(ne)}getWorkerPerformanceMetrics(Y,ne,fe){fe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new zl(self)),zl}),mt(0,function(m){function re(y,d){if(Array.isArray(y)){if(!Array.isArray(d)||y.length!==d.length)return!1;for(let f=0;f<y.length;f++)if(!re(y[f],d[f]))return!1;return!0}if("object"==typeof y&&null!==y&&null!==d){if("object"!=typeof d||Object.keys(y).length!==Object.keys(d).length)return!1;for(const f in y)if(!re(y[f],d[f]))return!1;return!0}return y===d}var Je=Xe;function Xe(y){return d=y,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,C,S=new Blob([""],{type:"text/javascript"}),k=URL.createObjectURL(S);try{C=new Worker(k),x=!0}catch{x=!1}return C&&C.terminate(),URL.revokeObjectURL(k),x}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var x=document.createElement("canvas");x.width=x.height=1;var C=x.getContext("2d");if(!C)return!1;var S=C.getImageData(0,0,1,1);return S&&S.width===x.width}()||(void 0===Ve[f=d&&d.failIfMajorPerformanceCaveat]&&(Ve[f]=function(x){var C,k,P,L,S=(k=x,P=document.createElement("canvas"),(L=Object.create(Xe.webGLContextAttributes)).failIfMajorPerformanceCaveat=k,P.getContext("webgl",L)||P.getContext("experimental-webgl",L));if(!S)return!1;try{C=S.createShader(S.VERTEX_SHADER)}catch{return!1}return!(!C||S.isContextLost())&&(S.shaderSource(C,"void main() {}"),S.compileShader(C),!0===S.getShaderParameter(C,S.COMPILE_STATUS))}(f)),!Ve[f]||document.documentMode));var d,f}var Ve={};function Ye(y,d,f){const x=m.window.document.createElement(y);return void 0!==d&&(x.className=d),f&&f.appendChild(x),x}function Ft(y,d,f){const x=m.window.document.createElementNS("http://www.w3.org/2000/svg",y);for(const C of Object.keys(d))x.setAttributeNS(null,C,d[C]);return f&&f.appendChild(x),x}Xe.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const pn=m.window.document&&m.window.document.documentElement.style,Kt=pn&&void 0!==pn.userSelect?"userSelect":"WebkitUserSelect";let rn;function $t(){pn&&Kt&&(rn=pn[Kt],pn[Kt]="none")}function Bt(){pn&&Kt&&(pn[Kt]=rn)}function Se(y){y.preventDefault(),y.stopPropagation(),m.window.removeEventListener("click",Se,!0)}function ht(){m.window.addEventListener("click",Se,!0),m.window.setTimeout(()=>{m.window.removeEventListener("click",Se,!0)},0)}function Ue(y,d){const f=y.getBoundingClientRect();return Et(y,f,d)}function rt(y,d){const f=y.getBoundingClientRect(),x=[];for(let C=0;C<d.length;C++)x.push(Et(y,f,d[C]));return x}function He(y){return void 0!==m.window.InstallTrigger&&2===y.button&&y.ctrlKey&&m.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:y.button}function Et(y,d,f){const x=y.offsetWidth===d.width?1:y.offsetWidth/d.width;return new m.pointGeometry((f.clientX-d.left)*x,(f.clientY-d.top)*x)}function bt(y,d){var f=d[0],x=d[1],C=d[2],S=d[3],k=f*S-C*x;return k?(y[0]=S*(k=1/k),y[1]=-x*k,y[2]=-C*k,y[3]=f*k,y):null}function Ot(y){const{userImage:d}=y;return!!(d&&d.render&&d.render())&&(y.data.replace(new Uint8Array(d.data.buffer)),!0)}class nn extends m.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new m.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(d){if(this.loaded!==d&&(this.loaded=d,d)){for(const{ids:f,callback:x}of this.requestors)this._notify(f,x);this.requestors=[]}}hasImage(d){return!!this.getImage(d)}getImage(d){return this.images[d]}addImage(d,f){this._validate(d,f)&&(this.images[d]=f)}_validate(d,f){let x=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new m.ErrorEvent(new Error(`Image "${d}" has invalid "stretchX" value`))),x=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new m.ErrorEvent(new Error(`Image "${d}" has invalid "stretchY" value`))),x=!1),this._validateContent(f.content,f)||(this.fire(new m.ErrorEvent(new Error(`Image "${d}" has invalid "content" value`))),x=!1),x}_validateStretch(d,f){if(!d)return!0;let x=0;for(const C of d){if(C[0]<x||C[1]<C[0]||f<C[1])return!1;x=C[1]}return!0}_validateContent(d,f){return!(d&&(4!==d.length||d[0]<0||f.data.width<d[0]||d[1]<0||f.data.height<d[1]||d[2]<0||f.data.width<d[2]||d[3]<0||f.data.height<d[3]||d[2]<d[0]||d[3]<d[1]))}updateImage(d,f){f.version=this.images[d].version+1,this.images[d]=f,this.updatedImages[d]=!0}removeImage(d){const f=this.images[d];delete this.images[d],delete this.patterns[d],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(d,f){let x=!0;if(!this.isLoaded())for(const C of d)this.images[C]||(x=!1);this.isLoaded()||x?this._notify(d,f):this.requestors.push({ids:d,callback:f})}_notify(d,f){const x={};for(const C of d){this.images[C]||this.fire(new m.Event("styleimagemissing",{id:C}));const S=this.images[C];S?x[C]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:Boolean(S.userImage&&S.userImage.render)}:m.warnOnce(`Image "${C}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,x)}getPixelSize(){const{width:d,height:f}=this.atlasImage;return{width:d,height:f}}getPattern(d){const f=this.patterns[d],x=this.getImage(d);if(!x)return null;if(f&&f.position.version===x.version)return f.position;if(f)f.position.version=x.version;else{const C={w:x.data.width+2,h:x.data.height+2,x:0,y:0},S=new m.ImagePosition(C,x);this.patterns[d]={bin:C,position:S}}return this._updatePatternAtlas(),this.patterns[d].position}bind(d){const f=d.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new m.Texture(d,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const d=[];for(const S in this.patterns)d.push(this.patterns[S].bin);const{w:f,h:x}=m.potpack(d),C=this.atlasImage;C.resize({width:f||1,height:x||1});for(const S in this.patterns){const{bin:k}=this.patterns[S],P=k.x+1,L=k.y+1,H=this.images[S].data,$=H.width,Q=H.height;m.RGBAImage.copy(H,C,{x:0,y:0},{x:P,y:L},{width:$,height:Q}),m.RGBAImage.copy(H,C,{x:0,y:Q-1},{x:P,y:L-1},{width:$,height:1}),m.RGBAImage.copy(H,C,{x:0,y:0},{x:P,y:L+Q},{width:$,height:1}),m.RGBAImage.copy(H,C,{x:$-1,y:0},{x:P-1,y:L},{width:1,height:Q}),m.RGBAImage.copy(H,C,{x:0,y:0},{x:P+$,y:L},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(d){for(const f of d){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const x=this.images[f];Ot(x)&&this.updateImage(f,x)}}}const zn=new m.Properties({anchor:new m.DataConstantProperty(m.spec.light.anchor),position:new class{constructor(){this.specification=m.spec.light.position}possiblyEvaluate(y,d){return function([f,x,C]){const S=m.degToRad(x+90),k=m.degToRad(C);return{x:f*Math.cos(S)*Math.sin(k),y:f*Math.sin(S)*Math.sin(k),z:f*Math.cos(k),azimuthal:x,polar:C}}(y.expression.evaluate(d))}interpolate(y,d,f){return{x:m.number(y.x,d.x,f),y:m.number(y.y,d.y,f),z:m.number(y.z,d.z,f),azimuthal:m.number(y.azimuthal,d.azimuthal,f),polar:m.number(y.polar,d.polar,f)}}},color:new m.DataConstantProperty(m.spec.light.color),intensity:new m.DataConstantProperty(m.spec.light.intensity)}),ho="-transition";class xo extends m.Evented{constructor(d){super(),this._transitionable=new m.Transitionable(zn),this.setLight(d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(d,f={}){if(!this._validate(m.validateLight,d,f))for(const x in d){const C=d[x];m.endsWith(x,ho)?this._transitionable.setTransition(x.slice(0,-ho.length),C):this._transitionable.setValue(x,C)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,f,x){return(!x||!1!==x.validate)&&m.emitValidationErrors(this,d.call(m.validateStyle,m.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:m.spec})))}}const Bn=new m.Properties({source:new m.DataConstantProperty(m.spec.terrain.source),exaggeration:new m.DataConstantProperty(m.spec.terrain.exaggeration)}),vr="-transition";class lr extends m.Evented{constructor(d,f){super(),this._transitionable=new m.Transitionable(Bn),this.set(d),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=f}get(){return this._transitionable.serialize()}set(d){for(const f in d){const x=d[f];m.endsWith(f,vr)?this._transitionable.setTransition(f.slice(0,-vr.length),x):this._transitionable.setValue(f,x)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}}function qs(y,d,f,x){const C=m.smoothstep(45,65,f),[S,k]=Ps(y,x),P=m.length(d);let L=1-Math.min(1,Math.exp((P-S)/(k-S)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*C*y.alpha}function Ps(y,d){const f=.5/Math.tan(.5*d);return[y.range[0]+f,y.range[1]+f]}const Jn=new m.Properties({range:new m.DataConstantProperty(m.spec.fog.range),color:new m.DataConstantProperty(m.spec.fog.color),"high-color":new m.DataConstantProperty(m.spec.fog["high-color"]),"space-color":new m.DataConstantProperty(m.spec.fog["space-color"]),"horizon-blend":new m.DataConstantProperty(m.spec.fog["horizon-blend"]),"star-intensity":new m.DataConstantProperty(m.spec.fog["star-intensity"])}),fa="-transition";class Pl extends m.Evented{constructor(d,f){super(),this._transitionable=new m.Transitionable(Jn),this.set(d),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){const d=this._transform,f="globe"===d.projection.name,x=m.globeToMercatorTransition(d.zoom),C=this.properties.get("range"),S=[.5,3];return{range:f?[m.number(S[0],C[0],x),m.number(S[1],C[1],x)]:C,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(d,f={}){if(!this._validate(m.validateFog,d,f)){for(const x of Object.keys(m.spec.fog))d&&void 0===d[x]&&(d[x]=m.spec.fog[x].default);for(const x in d){const C=d[x];m.endsWith(x,fa)?this._transitionable.setTransition(x.slice(0,-fa.length),C):this._transitionable.setValue(x,C)}}}getOpacity(d){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:m.smoothstep(45,65,d))*f.a}getOpacityAtLatLng(d,f){return this._transform.projection.supportsFog?function(x,C,S){const k=m.MercatorCoordinate.fromLngLat(C),P=S.elevation?S.elevation.getAtPointOrZero(k):0,L=[k.x,k.y,P];return m.transformMat4(L,L,S.mercatorFogMatrix),qs(x,L,S.pitch,S._fov)}(this.state,d,f):0}getFovAdjustedRange(d){return this._transform.projection.supportsFog?Ps(this.state,d):[0,1]}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,f,x){return(!x||!1!==x.validate)&&m.emitValidationErrors(this,d.call(m.validateStyle,m.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:m.spec})))}}class Os{constructor(d,f){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=m.uniqueId();const x=this.workerPool.acquire(this.id);for(let C=0;C<x.length;C++){const S=new Os.Actor(x[C],f,this.id);S.name=`Worker ${C}`,this.actors.push(S)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(d,f,x){m.asyncAll(this.actors,(C,S)=>{C.send(d,f,S)},x=x||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(d=>{d.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ss(y,d,f){return d*(m.EXTENT/(y.tileSize*Math.pow(2,f-y.tileID.overscaledZ)))}Os.Actor=m.Actor;class gi{constructor(d,f,x,C){this.screenBounds=d,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=x,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,C)}static createFromScreenPoints(d,f){let x,C;if(d instanceof m.pointGeometry||"number"==typeof d[0]){const S=m.pointGeometry.convert(d);x=[S],C=f.isPointAboveHorizon(S)}else{const S=m.pointGeometry.convert(d[0]),k=m.pointGeometry.convert(d[1]);x=[S,k],C=m.polygonizeBounds(S,k).every(P=>f.isPointAboveHorizon(P))}return new gi(x,f.getCameraPoint(),C,f)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(d){return m.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],d)}bufferedCameraGeometry(d){const f=this.screenBounds[0],x=1===this.screenBounds.length?this.screenBounds[0].add(new m.pointGeometry(1,1)):this.screenBounds[1],C=m.polygonizeBounds(f,x,0,!1);return this.cameraPoint.y>x.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<x.x?C.splice(3,0,this.cameraPoint):this.cameraPoint.x>=x.x?C[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(C[3]=this.cameraPoint)),m.bufferConvexPolygon(C,d)}bufferedCameraGeometryGlobe(d){const f=this.screenBounds[0],x=1===this.screenBounds.length?this.screenBounds[0].add(new m.pointGeometry(1,1)):this.screenBounds[1],C=m.polygonizeBounds(f,x,d),S=this.cameraPoint.clone();switch(3*((S.y>f.y)+(S.y>x.y))+((S.x>f.x)+(S.x>x.x))){case 0:C[0]=S,C[4]=S.clone();break;case 1:C.splice(1,0,S);break;case 2:C[1]=S;break;case 3:C.splice(4,0,S);break;case 5:C.splice(2,0,S);break;case 6:C[3]=S;break;case 7:C.splice(3,0,S);break;case 8:C[2]=S}return C}containsTile(d,f,x,C=0){const S=d.queryPadding/f._pixelsPerMercatorPixel+1,k=x?this._bufferedCameraMercator(S,f):this._bufferedScreenMercator(S,f);let P=d.tileID.wrap+(k.unwrapped?C:0);const L=k.polygon.map(he=>m.getTilePoint(d.tileTransform,he,P));if(!m.polygonIntersectsBox(L,0,0,m.EXTENT,m.EXTENT))return;P=d.tileID.wrap+(this.screenGeometryMercator.unwrapped?C:0);const H=this.screenGeometryMercator.polygon.map(he=>m.getTileVec3(d.tileTransform,he,P)),$=H.map(he=>new m.pointGeometry(he[0],he[1])),Q=f.getFreeCameraOptions().position||new m.MercatorCoordinate(0,0,0),oe=m.getTileVec3(d.tileTransform,Q,P),ue=H.map(he=>{const ie=m.sub(he,he,oe);return m.normalize(ie,ie),new m.Ray(oe,ie)}),ae=ss(d,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:ue,bufferedTilespaceGeometry:L,bufferedTilespaceBounds:(de=m.getBounds(L),de.min.x=m.clamp(de.min.x,0,m.EXTENT),de.min.y=m.clamp(de.min.y,0,m.EXTENT),de.max.x=m.clamp(de.max.x,0,m.EXTENT),de.max.y=m.clamp(de.max.y,0,m.EXTENT),de),tile:d,tileID:d.tileID,pixelToTileUnitsFactor:ae};var de}_bufferedScreenMercator(d,f){const x=ji(d);if(this._screenRaycastCache[x])return this._screenRaycastCache[x];{let C;return C="globe"===f.projection.name?this._projectAndResample(this.bufferedScreenGeometry(d),f):{polygon:this.bufferedScreenGeometry(d).map(S=>f.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[x]=C,C}}_bufferedCameraMercator(d,f){const x=ji(d);if(this._cameraRaycastCache[x])return this._cameraRaycastCache[x];{let C;return C="globe"===f.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(d),f):{polygon:this.bufferedCameraGeometry(d).map(S=>f.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[x]=C,C}}_projectAndResample(d,f){const x=function(S,k){const P=m.multiply([],k.pixelMatrix,k.globeMatrix),L=[0,-m.GLOBE_RADIUS,0,1],H=[0,m.GLOBE_RADIUS,0,1],$=[0,0,0,1];m.transformMat4$1(L,L,P),m.transformMat4$1(H,H,P),m.transformMat4$1($,$,P);const Q=new m.pointGeometry(L[0]/L[3],L[1]/L[3]),oe=new m.pointGeometry(H[0]/H[3],H[1]/H[3]),ue=m.polygonContainsPoint(S,Q)&&L[3]<$[3],ae=m.polygonContainsPoint(S,oe)&&H[3]<$[3];if(!ue&&!ae)return null;const de=function(Le,$e,nt){for(let ot=1;ot<Le.length;ot++){const zt=Rs($e.pointCoordinate3D(Le[ot-1]).x),Ze=Rs($e.pointCoordinate3D(Le[ot]).x);if(nt<0){if(zt<Ze)return{idx:ot,t:-zt/(Ze-1-zt)}}else if(Ze<zt)return{idx:ot,t:(1-zt)/(Ze+1-zt)}}return null}(S,k,ue?-1:1);if(!de)return null;const{idx:he,t:ie}=de;let ye=he>1?ma(S.slice(0,he),k):[],ge=he<S.length?ma(S.slice(he),k):[];ye=ye.map(Le=>new m.pointGeometry(Rs(Le.x),Le.y)),ge=ge.map(Le=>new m.pointGeometry(Rs(Le.x),Le.y));const Ce=[...ye];0===Ce.length&&Ce.push(ge[ge.length-1]);const Pe=m.number(Ce[Ce.length-1].y,(0===ge.length?ye[0]:ge[0]).y,ie);let ke;return ke=ue?[new m.pointGeometry(0,Pe),new m.pointGeometry(0,0),new m.pointGeometry(1,0),new m.pointGeometry(1,Pe)]:[new m.pointGeometry(1,Pe),new m.pointGeometry(1,1),new m.pointGeometry(0,1),new m.pointGeometry(0,Pe)],Ce.push(...ke),0===ge.length?Ce.push(ye[0]):Ce.push(...ge),{polygon:Ce.map(Le=>new m.MercatorCoordinate(Le.x,Le.y)),unwrapped:!1}}(d,f);if(x)return x;const C=function(S,k){let P=!1,L=-1/0,H=0;for(let Q=0;Q<S.length-1;Q++)S[Q].x>L&&(L=S[Q].x,H=Q);for(let Q=0;Q<S.length-1;Q++){const oe=(H+Q)%(S.length-1),ue=S[oe],ae=S[oe+1];Math.abs(ue.x-ae.x)>.5&&(ue.x<ae.x?(ue.x+=1,0===oe&&(S[S.length-1].x+=1)):(ae.x+=1,oe+1===S.length-1&&(S[0].x+=1)),P=!0)}const $=m.mercatorXfromLng(k.center.lng);return P&&$<Math.abs($-1)&&S.forEach(Q=>{Q.x-=1}),{polygon:S,unwrapped:P}}(ma(d,f).map(S=>new m.pointGeometry(Rs(S.x),S.y)),f);return{polygon:C.polygon.map(S=>new m.MercatorCoordinate(S.x,S.y)),unwrapped:C.unwrapped}}}function ma(y,d){return m.resample(y,f=>{const x=d.pointCoordinate3D(f);f.x=x.x,f.y=x.y},1/256)}function Rs(y){return y<0?1+y%1:y%1}function ji(y){return 100*y|0}function Yn(y,d,f,x,C){const S=function(k,P){if(k)return C(k);if(P){y.url&&P.tiles&&y.tiles&&delete y.tiles;const L=m.pick(m.extend(P,y),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);P.vector_layers&&(L.vectorLayers=P.vector_layers,L.vectorLayerIds=L.vectorLayers.map(H=>H.id)),L.tiles=d.canonicalizeTileset(L,y.url),C(null,L)}};return y.url?m.getJSON(d.transformRequest(d.normalizeSourceURL(y.url,null,f,x),m.ResourceType.Source),S):m.exported.frame(()=>S(null,y))}class Vo{constructor(d,f,x){this.bounds=m.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=f||0,this.maxzoom=x||24}validateBounds(d){return Array.isArray(d)&&4===d.length?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]}contains(d){const f=Math.pow(2,d.z),x=Math.floor(m.mercatorXfromLng(this.bounds.getWest())*f),C=Math.floor(m.mercatorYfromLat(this.bounds.getNorth())*f),S=Math.ceil(m.mercatorXfromLng(this.bounds.getEast())*f),k=Math.ceil(m.mercatorYfromLat(this.bounds.getSouth())*f);return d.x>=x&&d.x<S&&d.y>=C&&d.y<k}}class Nn{constructor(d,f,x){this.context=d;const C=d.gl;this.buffer=C.createBuffer(),this.dynamicDraw=Boolean(x),this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(d){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const vo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ra{constructor(d,f,x,C){this.length=f.length,this.attributes=x,this.itemSize=f.bytesPerElement,this.dynamicDraw=C,this.context=d;const S=d.gl;this.buffer=S.createBuffer(),d.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(d){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,d.arrayBuffer)}enableAttributes(d,f){for(let x=0;x<this.attributes.length;x++){const C=f.attributes[this.attributes[x].name];void 0!==C&&d.enableVertexAttribArray(C)}}setVertexAttribPointers(d,f,x){for(let C=0;C<this.attributes.length;C++){const S=this.attributes[C],k=f.attributes[S.name];void 0!==k&&d.vertexAttribPointer(k,S.components,d[vo[S.type]],!1,this.itemSize,S.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class zi{constructor(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(d){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class La extends zi{getDefault(){return m.Color.transparent}set(d){const f=this.current;(d.r!==f.r||d.g!==f.g||d.b!==f.b||d.a!==f.a||this.dirty)&&(this.gl.clearColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class yc extends zi{getDefault(){return 1}set(d){(d!==this.current||this.dirty)&&(this.gl.clearDepth(d),this.current=d,this.dirty=!1)}}class jh extends zi{getDefault(){return 0}set(d){(d!==this.current||this.dirty)&&(this.gl.clearStencil(d),this.current=d,this.dirty=!1)}}class Ol extends zi{getDefault(){return[!0,!0,!0,!0]}set(d){const f=this.current;(d[0]!==f[0]||d[1]!==f[1]||d[2]!==f[2]||d[3]!==f[3]||this.dirty)&&(this.gl.colorMask(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class Hh extends zi{getDefault(){return!0}set(d){(d!==this.current||this.dirty)&&(this.gl.depthMask(d),this.current=d,this.dirty=!1)}}class yu extends zi{getDefault(){return 255}set(d){(d!==this.current||this.dirty)&&(this.gl.stencilMask(d),this.current=d,this.dirty=!1)}}class Ed extends zi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(d){const f=this.current;(d.func!==f.func||d.ref!==f.ref||d.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(d.func,d.ref,d.mask),this.current=d,this.dirty=!1)}}class Fa extends zi{getDefault(){const d=this.gl;return[d.KEEP,d.KEEP,d.KEEP]}set(d){const f=this.current;(d[0]!==f[0]||d[1]!==f[1]||d[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(d[0],d[1],d[2]),this.current=d,this.dirty=!1)}}class za extends zi{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;d?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=d,this.dirty=!1}}class Sd extends zi{getDefault(){return[0,1]}set(d){const f=this.current;(d[0]!==f[0]||d[1]!==f[1]||this.dirty)&&(this.gl.depthRange(d[0],d[1]),this.current=d,this.dirty=!1)}}class vc extends zi{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;d?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=d,this.dirty=!1}}class $h extends zi{getDefault(){return this.gl.LESS}set(d){(d!==this.current||this.dirty)&&(this.gl.depthFunc(d),this.current=d,this.dirty=!1)}}class al extends zi{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;d?f.enable(f.BLEND):f.disable(f.BLEND),this.current=d,this.dirty=!1}}class vu extends zi{getDefault(){const d=this.gl;return[d.ONE,d.ZERO]}set(d){const f=this.current;(d[0]!==f[0]||d[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(d[0],d[1]),this.current=d,this.dirty=!1)}}class Dd extends zi{getDefault(){return m.Color.transparent}set(d){const f=this.current;(d.r!==f.r||d.g!==f.g||d.b!==f.b||d.a!==f.a||this.dirty)&&(this.gl.blendColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class Md extends zi{getDefault(){return this.gl.FUNC_ADD}set(d){(d!==this.current||this.dirty)&&(this.gl.blendEquation(d),this.current=d,this.dirty=!1)}}class Zs extends zi{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;d?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=d,this.dirty=!1}}class ga extends zi{getDefault(){return this.gl.BACK}set(d){(d!==this.current||this.dirty)&&(this.gl.cullFace(d),this.current=d,this.dirty=!1)}}class Rl extends zi{getDefault(){return this.gl.CCW}set(d){(d!==this.current||this.dirty)&&(this.gl.frontFace(d),this.current=d,this.dirty=!1)}}class bu extends zi{getDefault(){return null}set(d){(d!==this.current||this.dirty)&&(this.gl.useProgram(d),this.current=d,this.dirty=!1)}}class Id extends zi{getDefault(){return this.gl.TEXTURE0}set(d){(d!==this.current||this.dirty)&&(this.gl.activeTexture(d),this.current=d,this.dirty=!1)}}class kd extends zi{getDefault(){const d=this.gl;return[0,0,d.drawingBufferWidth,d.drawingBufferHeight]}set(d){const f=this.current;(d[0]!==f[0]||d[1]!==f[1]||d[2]!==f[2]||d[3]!==f[3]||this.dirty)&&(this.gl.viewport(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class xu extends zi{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,d),this.current=d,this.dirty=!1}}class wu extends zi{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class Gh extends zi{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,d),this.current=d,this.dirty=!1}}class Cu extends zi{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class Na extends zi{getDefault(){return null}set(d){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class Tu extends zi{constructor(d){super(d),this.vao=d.extVertexArrayObject}getDefault(){return null}set(d){this.vao&&(d!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(d),this.current=d,this.dirty=!1)}}class Eu extends zi{getDefault(){return 4}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,d),this.current=d,this.dirty=!1}}class Ad extends zi{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),this.current=d,this.dirty=!1}}class bc extends zi{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,d),this.current=d,this.dirty=!1}}class Ll extends zi{constructor(d,f){super(d),this.context=d,this.parent=f}getDefault(){return null}}class vs extends Ll{setDirty(){this.dirty=!0}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,d,0),this.current=d,this.dirty=!1}}class Fl extends Ll{attachment(){return this.gl.DEPTH_ATTACHMENT}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class Pd extends Fl{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class zl{constructor(d,f,x,C){this.context=d,this.width=f,this.height=x;const S=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new vs(d,S),C&&(this.depthAttachment=new Fl(d,S))}destroy(){const d=this.context.gl,f=this.colorAttachment.get();if(f&&d.deleteTexture(f),this.depthAttachment){const x=this.depthAttachment.get();x&&d.deleteRenderbuffer(x)}d.deleteFramebuffer(this.framebuffer)}}class me{constructor(d,f=!1){if(this.gl=d,this.isWebGL2=f,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),f){const x=d;this.extVertexArrayObject={createVertexArrayOES:x.createVertexArray.bind(d),deleteVertexArrayOES:x.deleteVertexArray.bind(d),bindVertexArrayOES:x.bindVertexArray.bind(d)}}this.clearColor=new La(this),this.clearDepth=new yc(this),this.clearStencil=new jh(this),this.colorMask=new Ol(this),this.depthMask=new Hh(this),this.stencilMask=new yu(this),this.stencilFunc=new Ed(this),this.stencilOp=new Fa(this),this.stencilTest=new za(this),this.depthRange=new Sd(this),this.depthTest=new vc(this),this.depthFunc=new $h(this),this.blend=new al(this),this.blendFunc=new vu(this),this.blendColor=new Dd(this),this.blendEquation=new Md(this),this.cullFace=new Zs(this),this.cullFaceSide=new ga(this),this.frontFace=new Rl(this),this.program=new bu(this),this.activeTexture=new Id(this),this.viewport=new kd(this),this.bindFramebuffer=new xu(this),this.bindRenderbuffer=new wu(this),this.bindTexture=new Gh(this),this.bindVertexBuffer=new Cu(this),this.bindElementBuffer=new Na(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Tu(this),this.pixelStoreUnpack=new Eu(this),this.pixelStoreUnpackPremultiplyAlpha=new Ad(this),this.pixelStoreUnpackFlipY=new bc(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=d.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=d.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=d.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),f||(this.extTextureHalfFloat=d.getExtension("OES_texture_half_float")),(f||this.extTextureHalfFloat&&d.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=f||d.getExtension("OES_standard_derivatives"),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(d,f){return new Nn(this,d,f)}createVertexBuffer(d,f,x){return new Ra(this,d,f,x)}createRenderbuffer(d,f,x){const C=this.gl,S=C.createRenderbuffer();return this.bindRenderbuffer.set(S),C.renderbufferStorage(C.RENDERBUFFER,d,f,x),this.bindRenderbuffer.set(null),S}createFramebuffer(d,f,x){return new zl(this,d,f,x)}clear({color:d,depth:f,stencil:x}){const C=this.gl;let S=0;d&&(S|=C.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),void 0!==f&&(S|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),void 0!==x&&(S|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),C.clear(S)}setCullFace(d){!1===d.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))}setDepthMode(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)}setStencilMode(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)}setColorMode(d){re(d.blendFunction,m.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Y extends m.Evented{constructor(d,f,x,C){if(super(),this.id=d,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,m.extend(this,m.pick(f,["url","scheme","tileSize","promoteId"])),this._options=m.extend({type:"vector"},f),this._collectResourceTiming=f.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C),this._tileWorkers={},this._deduped=new m.DedupedRequest}load(d){this._loaded=!1,this.fire(new m.Event("dataloading",{dataType:"source"}));const f=Array.isArray(this.map._language)?this.map._language.join():this.map._language,x=this.map._worldview;this._tileJSONRequest=Yn(this._options,this.map._requestManager,f,x,(C,S)=>{this._tileJSONRequest=null,this._loaded=!0,C?(f&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${f}`),x&&2!==x.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${x}`),this.fire(new m.ErrorEvent(C))):S&&(m.extend(this,S),S.bounds&&(this.tileBounds=new Vo(S.bounds,this.minzoom,this.maxzoom)),m.postTurnstileEvent(S.tiles,this.map._requestManager._customAccessToken),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(C)})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return m.extend({},this._options)}loadTile(d,f){const x=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),C={request:this.map._requestManager.transformRequest(x,m.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:m.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(C.request.collectResourceTiming=this._collectResourceTiming,d.actor&&"expired"!==d.state)"loading"===d.state?d.reloadCallback=f:d.request=d.actor.send("reloadTile",C,S.bind(this));else if(d.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",C,S.bind(this),void 0,!0);else{const k=m.loadVectorTile.call({deduped:this._deduped},C,(P,L)=>{P||!L?S.call(this,P):(C.data={cacheControl:L.cacheControl,expires:L.expires,rawData:L.rawData.slice(0)},d.actor&&d.actor.send("loadTile",C,S.bind(this),void 0,!0))},!0);d.request={cancel:k}}function S(k,P){return delete d.request,d.aborted?f(null):k&&404!==k.status?f(k):(P&&P.resourceTiming&&(d.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&d.setExpiryData(P),d.loadVectorData(P,this.map.painter),m.cacheEntryPossiblyAdded(this.dispatcher),f(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ne extends m.Evented{constructor(d,f,x,C){super(),this.id=d,this.dispatcher=x,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=m.extend({type:"raster"},f),m.extend(this,m.pick(f,["url","scheme","tileSize"]))}load(d){this._loaded=!1,this.fire(new m.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Yn(this._options,this.map._requestManager,null,null,(f,x)=>{this._tileJSONRequest=null,this._loaded=!0,f?this.fire(new m.ErrorEvent(f)):x&&(m.extend(this,x),x.bounds&&(this.tileBounds=new Vo(x.bounds,this.minzoom,this.maxzoom)),m.postTurnstileEvent(x.tiles),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(f)})}loaded(){return this._loaded}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return m.extend({},this._options)}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,f){const x=m.exported.devicePixelRatio>=2,C=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),x,this.tileSize);d.request=m.getImage(this.map._requestManager.transformRequest(C,m.ResourceType.Tile),(S,k,P,L)=>(delete d.request,d.aborted?(d.state="unloaded",f(null)):S?(d.state="errored",f(S)):k?(this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:P,expires:L}),d.setTexture(k,this.map.painter),d.state="loaded",m.cacheEntryPossiblyAdded(this.dispatcher),void f(null)):f(null)))}static loadTileData(d,f,x){d.setTexture(f,x)}static unloadTileData(d,f){d.texture&&f.saveTileTexture(d.texture)}abortTile(d,f){d.request&&(d.request.cancel(),delete d.request),f()}unloadTile(d,f){d.texture&&this.map.painter.saveTileTexture(d.texture),f()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let fe;function Te(y,d,f,x,C,S,k,P){const L=[y,f,C,d,x,S,1,1,1],H=[k,P,1],$=m.adjoint([],L),[Q,oe,ue]=m.transformMat3(H,H,m.transpose($,$));return m.multiply$1(L,[Q,0,0,0,oe,0,0,0,ue],L)}class Re extends m.Evented{constructor(d,f,x,C){super(),this.id=d,this.dispatcher=x,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=f,this._dirty=!1}load(d,f){this._loaded=f||!1,this.fire(new m.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=m.getImage(this.map._requestManager.transformRequest(this.url,m.ResourceType.Image),(x,C)=>{if(this._imageRequest=null,this._loaded=!0,x)this.fire(new m.ErrorEvent(x));else if(C){const{HTMLImageElement:S}=m.window;this.image=C instanceof S?m.exported.getImageData(C):C,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,d&&(this.coordinates=d),this._finishLoading()}})}loaded(){return this._loaded}updateImage(d){return this.image&&d.url?(this._imageRequest&&d.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=d.url,this.load(d.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(d){this.map=d,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(d){this.coordinates=d,this._boundsArray=void 0;const f=d.map(m.MercatorCoordinate.fromLngLat);return this.tileID=function(x){let C=1/0,S=1/0,k=-1/0,P=-1/0;for(const Q of x)C=Math.min(C,Q.x),S=Math.min(S,Q.y),k=Math.max(k,Q.x),P=Math.max(P,Q.y);const L=Math.max(k-C,P-S),H=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),$=Math.pow(2,H);return new m.CanonicalTileID(H,Math.floor((C+k)/2*$),Math.floor((S+P)/2*$))}(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(d){for(const L in this.tiles){const H=this.tiles[L];"loaded"!==H.state&&(H.state="loaded",H.texture=this.texture)}if(this._boundsArray)return;const f=m.tileTransform(this.tileID,this.map.transform.projection),[x,C,S,k]=this.coordinates.map(L=>{const H=f.projection.project(L[0],L[1]);return m.getTilePoint(f,H)._round()});this.perspectiveTransform=function(L,H,$,Q,oe,ue,ae,de,he,ie){const ye=Te(0,0,L,0,0,H,L,H),ge=Te($,Q,oe,ue,ae,de,he,ie);return m.multiply$1(ge,m.adjoint(ye,ye),ge),[ge[6]/ge[8]*L/m.EXTENT,ge[7]/ge[8]*H/m.EXTENT]}(this.width,this.height,x.x,x.y,C.x,C.y,k.x,k.y,S.x,S.y);const P=this._boundsArray=new m.StructArrayLayout4i8;P.emplaceBack(x.x,x.y,0,0),P.emplaceBack(C.x,C.y,m.EXTENT,0),P.emplaceBack(k.x,k.y,0,m.EXTENT),P.emplaceBack(S.x,S.y,m.EXTENT,m.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=d.createVertexBuffer(P,m.boundsAttributes.members),this.boundsSegments=m.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const d=this.map.painter.context,f=d.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new m.Texture(d,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(d)}loadTile(d,f){this.tileID&&this.tileID.equals(d.tileID.canonical)?(this.tiles[String(d.tileID.wrap)]=d,d.buckets={},f(null)):(d.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const qe={vector:Y,raster:ne,"raster-dem":class extends ne{constructor(y,d,f,x){super(y,d,f,x),this.type="raster-dem",this.maxzoom=22,this._options=m.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}loadTile(y,d){const f=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function x(C,S){C&&(y.state="errored",d(C)),S&&(y.dem=S,y.dem.onDeserialize(),y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0,y.state="loaded",d(null))}y.request=m.getImage(this.map._requestManager.transformRequest(f,m.ResourceType.Tile),function(C,S,k,P){if(delete y.request,y.aborted)y.state="unloaded",d(null);else if(C)y.state="errored",d(C);else if(S){this.map._refreshExpiredTiles&&y.setExpiryData({cacheControl:k,expires:P});const L=m.window.ImageBitmap&&S instanceof m.window.ImageBitmap&&(null==fe&&(fe=m.window.OffscreenCanvas&&new m.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof m.window.createImageBitmap),fe),H=1-(S.width-m.prevPowerOfTwo(S.width))/2;H<1||y.neighboringTiles||(y.neighboringTiles=this._getNeighboringTiles(y.tileID));const $=L?S:m.exported.getImageData(S,H),Q={uid:y.uid,coord:y.tileID,source:this.id,rawImageData:$,encoding:this.encoding,padding:H};y.actor&&"expired"!==y.state||(y.actor=this.dispatcher.getActor(),y.actor.send("loadDEMTile",Q,x.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(y){const d=y.canonical,f=Math.pow(2,d.z),x=(d.x-1+f)%f,C=0===d.x?y.wrap-1:y.wrap,S=(d.x+1+f)%f,k=d.x+1===f?y.wrap+1:y.wrap,P={};return P[new m.OverscaledTileID(y.overscaledZ,C,d.z,x,d.y).key]={backfilled:!1},P[new m.OverscaledTileID(y.overscaledZ,k,d.z,S,d.y).key]={backfilled:!1},d.y>0&&(P[new m.OverscaledTileID(y.overscaledZ,C,d.z,x,d.y-1).key]={backfilled:!1},P[new m.OverscaledTileID(y.overscaledZ,y.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},P[new m.OverscaledTileID(y.overscaledZ,k,d.z,S,d.y-1).key]={backfilled:!1}),d.y+1<f&&(P[new m.OverscaledTileID(y.overscaledZ,C,d.z,x,d.y+1).key]={backfilled:!1},P[new m.OverscaledTileID(y.overscaledZ,y.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},P[new m.OverscaledTileID(y.overscaledZ,k,d.z,S,d.y+1).key]={backfilled:!1}),P}unloadTile(y){y.demTexture&&this.map.painter.saveTileTexture(y.demTexture),y.fbo&&(y.fbo.destroy(),delete y.fbo),y.dem&&delete y.dem,delete y.neighboringTiles,y.state="unloaded"}},geojson:class extends m.Evented{constructor(y,d,f,x){super(),this.id=y,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(x),this._data=d.data,this._options=m.extend({},d),this._collectResourceTiming=d.collectResourceTiming,void 0!==d.maxzoom&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const C=m.EXTENT/this.tileSize;this.workerOptions=m.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(void 0!==d.buffer?d.buffer:128)*C,tolerance:(void 0!==d.tolerance?d.tolerance:.375)*C,extent:m.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:void 0!==d.clusterMaxZoom?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:m.EXTENT,radius:(void 0!==d.clusterRadius?d.clusterRadius:50)*C,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}onAdd(y){this.map=y,this.setData(this._data)}setData(y){return this._data=y,this._updateWorkerData(),this}getClusterExpansionZoom(y,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:y,source:this.id},d),this}getClusterChildren(y,d){return this.actor.send("geojson.getClusterChildren",{clusterId:y,source:this.id},d),this}getClusterLeaves(y,d,f,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:y,limit:d,offset:f},x),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new m.Event("dataloading",{dataType:"source"})),this._loaded=!1;const y=m.extend({},this.workerOptions),d=this._data;"string"==typeof d?(y.request=this.map._requestManager.transformRequest(m.exported.resolveURL(d),m.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,y,(f,x)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new m.ErrorEvent(f));else{const C={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(C.resourceTiming=x.resourceTiming[this.id]),this.fire(new m.Event("data",C)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(y,d){const f=y.actor?"reloadTile":"loadTile";y.actor=this.actor,y.request=this.actor.send(f,{type:this.type,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:m.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(x,C)=>(delete y.request,y.unloadVectorData(),y.aborted?d(null):x?d(x):(y.loadVectorData(C,this.map.painter,"reloadTile"===f),d(null))),void 0,"loadTile"===f)}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.aborted=!0}unloadTile(y){y.unloadVectorData(),this.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return m.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Re{constructor(y,d,f,x){super(y,d,f,x),this.roundZoom=!0,this.type="video",this.options=d}load(){this._loaded=!1;const y=this.options;this.urls=[];for(const d of y.urls)this.urls.push(this.map._requestManager.transformRequest(d,m.ResourceType.Source).url);m.getVideo(this.urls,(d,f)=>{this._loaded=!0,d?this.fire(new m.ErrorEvent(d)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(y){if(this.video){const d=this.video.seekable;y<d.start(0)||y>d.end(0)?this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=y}}getVideo(){return this.video}onAdd(y){this.map||(this.map=y,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const y=this.map.painter.context,d=y.gl;this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new m.Texture(y,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(y)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Re,canvas:class extends Re{constructor(y,d,f,x){super(y,d,f,x),d.coordinates?Array.isArray(d.coordinates)&&4===d.coordinates.length&&!d.coordinates.some(C=>!Array.isArray(C)||2!==C.length||C.some(S=>"number"!=typeof S))||this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${y}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${y}`,null,'missing required property "coordinates"'))),d.animate&&"boolean"!=typeof d.animate&&this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${y}`,null,'optional "animate" property must be a boolean value'))),d.canvas?"string"==typeof d.canvas||d.canvas instanceof m.window.HTMLCanvasElement||this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${y}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${y}`,null,'missing required property "canvas"'))),this.options=d,this.animate=void 0===d.animate||d.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof m.window.HTMLCanvasElement?this.options.canvas:m.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new m.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(y){this.map=y,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const d=this.map.painter.context;this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new m.Texture(d,this.canvas,d.gl.RGBA,{premultiply:!0}),this._prepareData(d)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const y of[this.canvas.width,this.canvas.height])if(isNaN(y)||y<=0)return!0;return!1}},custom:class extends m.Evented{constructor(y,d,f,x){super(),this.id=y,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=d,this.setEventedParent(x),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new m.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new m.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Vo(this._implementation.bounds,this.minzoom,this.maxzoom)),d.update=this._update.bind(this),d.clearTiles=this._clearTiles.bind(this),d.coveringTiles=this._coveringTiles.bind(this),m.extend(this,m.pick(d,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return m.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(y){this._map=y,this._loaded=!1,this.fire(new m.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(y),this.load()}onRemove(y){this._implementation.onRemove&&this._implementation.onRemove(y)}hasTile(y){if(this._implementation.hasTile){const{x:d,y:f,z:x}=y.canonical;return this._implementation.hasTile({x:d,y:f,z:x})}return!this.tileBounds||this.tileBounds.contains(y.canonical)}loadTile(y,d){const{x:f,y:x,z:C}=y.tileID.canonical,S=new m.window.AbortController;y.request=Promise.resolve(this._implementation.loadTile({x:f,y:x,z:C},{signal:S.signal})).then(function(k){return delete y.request,y.aborted?(y.state="unloaded",d(null)):void 0===k?(y.state="errored",d(null)):null===k?(this.loadTileData(y,{width:this.tileSize,height:this.tileSize,data:null}),y.state="loaded",d(null)):(P=k)instanceof m.window.ImageData||P instanceof m.window.HTMLCanvasElement||P instanceof m.window.ImageBitmap||P instanceof m.window.HTMLImageElement?(this.loadTileData(y,k),y.state="loaded",void d(null)):(y.state="errored",d(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var P}.bind(this)).catch(k=>{20!==k.code&&(y.state="errored",d(k))}),y.request.cancel=()=>S.abort()}loadTileData(y,d){ne.loadTileData(y,d,this._map.painter)}unloadTileData(y){ne.unloadTileData(y,this._map.painter)}unloadTile(y,d){if(this.unloadTileData(y),this._implementation.unloadTile){const{x:f,y:x,z:C}=y.tileID.canonical;this._implementation.unloadTile({x:f,y:x,z:C})}d()}abortTile(y,d){y.request&&y.request.cancel&&(y.request.cancel(),delete y.request),d()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(y=>({x:y.canonical.x,y:y.canonical.y,z:y.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"}))}}},We=function(y,d,f,x){const C=new qe[d.type](y,d,f,x);if(C.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${C.id}`);return m.bindAll(["load","abort","unload","serialize","prepare"],C),C};function ze(y,d){const f=m.identity([]);return m.scale(f,f,[.5*y.width,.5*-y.height,1]),m.translate(f,f,[1,-1,0]),m.multiply(f,f,y.calculateProjMatrix(d.toUnwrapped())),Float32Array.from(f)}function tt(y,d,f,x,C,S,k,P=!1){const L=y.tilesIn(x,k,P);L.sort(Xt);const H=[];for(const Q of L)H.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(d,f,y._state,Q,C,S,ze(y.transform,Q.tile.tileID),P)});const $=function(Q){const oe={},ue={};for(const ae of Q){const de=ae.queryResults,he=ae.wrappedTileID,ie=ue[he]=ue[he]||{};for(const ye in de){const ge=de[ye],Ce=ie[ye]=ie[ye]||{},Pe=oe[ye]=oe[ye]||[];for(const ke of ge)Ce[ke.featureIndex]||(Ce[ke.featureIndex]=!0,Pe.push(ke))}}return oe}(H);for(const Q in $)$[Q].forEach(oe=>{const ue=oe.feature,ae=ue.layer;ae&&"background"!==ae.type&&"sky"!==ae.type&&(ue.source=ae.source,ae["source-layer"]&&(ue.sourceLayer=ae["source-layer"]),ue.state=void 0!==ue.id?y.getFeatureState(ae["source-layer"],ue.id):{})});return $}function wt(y,d){const f=y.getRenderableIds().map(S=>y.getTileByID(S)),x=[],C={};for(let S=0;S<f.length;S++){const k=f[S],P=k.tileID.canonical.key;C[P]||(C[P]=!0,k.querySourceFeatures(x,d))}return x}function Xt(y,d){const f=y.tileID,x=d.tileID;return f.overscaledZ-x.overscaledZ||f.canonical.y-x.canonical.y||f.wrap-x.wrap||f.canonical.x-x.canonical.x}function St(){return null!=zc.workerClass?new zc.workerClass:new m.window.Worker(zc.workerUrl)}const Sn="mapboxgl_preloaded_worker_pool";class dn{constructor(){this.active={}}acquire(d){if(!this.workers)for(this.workers=[];this.workers.length<dn.workerCount;)this.workers.push(new St);return this.active[d]=!0,this.workers.slice()}release(d){delete this.active[d],0===this.numActive()&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Sn]}numActive(){return Object.keys(this.active).length}}let Mn;function Vn(){return Mn||(Mn=new dn),Mn}function oi(y,d){const f={};for(const x in y)"ref"!==x&&(f[x]=y[x]);return m.refProperties.forEach(x=>{x in d&&(f[x]=d[x])}),f}function Ri(y){y=y.slice();const d=Object.create(null);for(let f=0;f<y.length;f++)d[y[f].id]=y[f];for(let f=0;f<y.length;f++)"ref"in y[f]&&(y[f]=oi(y[f],d[y[f].ref]));return y}dn.workerCount=2;const On={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Vi(y,d,f){f.push({command:On.addSource,args:[y,d[y]]})}function oo(y,d,f){d.push({command:On.removeSource,args:[y]}),f[y]=!0}function ll(y,d,f,x){oo(y,f,x),Vi(y,d,f)}function Ba(y,d,f){let x;for(x in y[f])if(y[f].hasOwnProperty(x)&&"data"!==x&&!re(y[f][x],d[f][x]))return!1;for(x in d[f])if(d[f].hasOwnProperty(x)&&"data"!==x&&!re(y[f][x],d[f][x]))return!1;return!0}function gt(y,d,f,x,C,S){let k;for(k in d=d||{},y=y||{})y.hasOwnProperty(k)&&(re(y[k],d[k])||f.push({command:S,args:[x,k,d[k],C]}));for(k in d)d.hasOwnProperty(k)&&!y.hasOwnProperty(k)&&(re(y[k],d[k])||f.push({command:S,args:[x,k,d[k],C]}))}function cl(y){return y.id}function Go(y,d){return y[d.id]=d,y}class Nl{constructor(d,f){this.reset(d,f)}reset(d,f){this.points=d||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(d){if(1===this.points.length)return this.points[0];d=m.clamp(d,0,1);let f=1,x=this._distances[f];const C=d*this.paddedLength+this.padding;for(;x<C&&f<this._distances.length;)x=this._distances[++f];const S=f-1,k=this._distances[S],P=x-k,L=P>0?(C-k)/P:0;return this.points[S].mult(1-L).add(this.points[f].mult(L))}}class Tf{constructor(d,f,x){const C=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(d/x),this.yCellCount=Math.ceil(f/x);for(let k=0;k<this.xCellCount*this.yCellCount;k++)C.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=f,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(d,f,x,C,S){this._forEachCell(f,x,C,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(f),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(S)}insertCircle(d,f,x,C){this._forEachCell(f-C,x-C,f+C,x+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(f),this.circles.push(x),this.circles.push(C)}_insertBoxCell(d,f,x,C,S,k){this.boxCells[S].push(k)}_insertCircleCell(d,f,x,C,S,k){this.circleCells[S].push(k)}_query(d,f,x,C,S,k){if(x<0||d>this.width||C<0||f>this.height)return!S&&[];const P=[];if(d<=0&&f<=0&&this.width<=x&&this.height<=C){if(S)return!0;for(let L=0;L<this.boxKeys.length;L++)P.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const H=this.circles[3*L],$=this.circles[3*L+1],Q=this.circles[3*L+2];P.push({key:this.circleKeys[L],x1:H-Q,y1:$-Q,x2:H+Q,y2:$+Q})}return k?P.filter(k):P}return this._forEachCell(d,f,x,C,this._queryCell,P,{hitTest:S,seenUids:{box:{},circle:{}}},k),S?P.length>0:P}_queryCircle(d,f,x,C,S){const k=d-x,P=d+x,L=f-x,H=f+x;if(P<0||k>this.width||H<0||L>this.height)return!C&&[];const $=[];return this._forEachCell(k,L,P,H,this._queryCellCircle,$,{hitTest:C,circle:{x:d,y:f,radius:x},seenUids:{box:{},circle:{}}},S),C?$.length>0:$}query(d,f,x,C,S){return this._query(d,f,x,C,!1,S)}hitTest(d,f,x,C,S){return this._query(d,f,x,C,!0,S)}hitTestCircle(d,f,x,C){return this._queryCircle(d,f,x,!0,C)}_queryCell(d,f,x,C,S,k,P,L){const H=P.seenUids,$=this.boxCells[S];if(null!==$){const oe=this.bboxes;for(const ue of $)if(!H.box[ue]){H.box[ue]=!0;const ae=4*ue;if(d<=oe[ae+2]&&f<=oe[ae+3]&&x>=oe[ae+0]&&C>=oe[ae+1]&&(!L||L(this.boxKeys[ue]))){if(P.hitTest)return k.push(!0),!0;k.push({key:this.boxKeys[ue],x1:oe[ae],y1:oe[ae+1],x2:oe[ae+2],y2:oe[ae+3]})}}}const Q=this.circleCells[S];if(null!==Q){const oe=this.circles;for(const ue of Q)if(!H.circle[ue]){H.circle[ue]=!0;const ae=3*ue;if(this._circleAndRectCollide(oe[ae],oe[ae+1],oe[ae+2],d,f,x,C)&&(!L||L(this.circleKeys[ue]))){if(P.hitTest)return k.push(!0),!0;{const de=oe[ae],he=oe[ae+1],ie=oe[ae+2];k.push({key:this.circleKeys[ue],x1:de-ie,y1:he-ie,x2:de+ie,y2:he+ie})}}}}}_queryCellCircle(d,f,x,C,S,k,P,L){const H=P.circle,$=P.seenUids,Q=this.boxCells[S];if(null!==Q){const ue=this.bboxes;for(const ae of Q)if(!$.box[ae]){$.box[ae]=!0;const de=4*ae;if(this._circleAndRectCollide(H.x,H.y,H.radius,ue[de+0],ue[de+1],ue[de+2],ue[de+3])&&(!L||L(this.boxKeys[ae])))return k.push(!0),!0}}const oe=this.circleCells[S];if(null!==oe){const ue=this.circles;for(const ae of oe)if(!$.circle[ae]){$.circle[ae]=!0;const de=3*ae;if(this._circlesCollide(ue[de],ue[de+1],ue[de+2],H.x,H.y,H.radius)&&(!L||L(this.circleKeys[ae])))return k.push(!0),!0}}}_forEachCell(d,f,x,C,S,k,P,L){const H=this._convertToXCellCoord(d),$=this._convertToYCellCoord(f),Q=this._convertToXCellCoord(x),oe=this._convertToYCellCoord(C);for(let ue=H;ue<=Q;ue++)for(let ae=$;ae<=oe;ae++)if(S.call(this,d,f,x,C,this.xCellCount*ae+ue,k,P,L))return}_convertToXCellCoord(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))}_convertToYCellCoord(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))}_circlesCollide(d,f,x,C,S,k){const P=C-d,L=S-f,H=x+k;return H*H>P*P+L*L}_circleAndRectCollide(d,f,x,C,S,k,P){const L=(k-C)/2,H=Math.abs(d-(C+L));if(H>L+x)return!1;const $=(P-S)/2,Q=Math.abs(f-(S+$));if(Q>$+x)return!1;if(H<=L||Q<=$)return!0;const oe=H-L,ue=Q-$;return oe*oe+ue*ue<=x*x}}const Va=Math.tan(85*Math.PI/180);function Su(y,d,f,x,C,S,k){const P=m.create();if(f)if("globe"===S.name){const L=m.calculateGlobeLabelMatrix(C,d);m.multiply(P,P,L)}else{const L=bt([],k);P[0]=L[0],P[1]=L[1],P[4]=L[2],P[5]=L[3],x||m.rotateZ(P,P,C.angle)}else m.multiply(P,C.labelPlaneMatrix,y);return P}function Wo(y,d,f,x,C,S,k){const P=Su(y,d,f,x,C,S,k);return"globe"===S.name&&f||(P[2]=P[6]=P[10]=P[14]=0),P}function xc(y,d,f,x,C,S,k){if(f){if("globe"===S.name){const P=Su(y,d,f,x,C,S,k);return m.invert(P,P),m.multiply(P,y,P),P}{const P=m.clone(y),L=m.identity([]);return L[0]=k[0],L[1]=k[1],L[4]=k[2],L[5]=k[3],m.multiply(P,P,L),x||m.rotateZ(P,P,-C.angle),P}}return C.glCoordMatrix}function Gt(y,d,f,x){const C=[y,d,f,1];f?m.transformMat4$1(C,C,x):by(C,C,x);const S=C[3];return C[0]/=S,C[1]/=S,C[2]/=S,C}function _i(y,d){return Math.min(.5+y/d*.5,1.5)}function Cn(y,d){const f=y[0]/y[3],x=y[1]/y[3];return f>=-d[0]&&f<=d[0]&&x>=-d[1]&&x<=d[1]}function Ks(y,d,f,x,C,S,k,P,L,H){const $=f.transform,Q=x?y.textSizeData:y.iconSizeData,oe=m.evaluateSizeForZoom(Q,f.transform.zoom),ue="globe"===$.projection.name,ae=[256/f.width*2+1,256/f.height*2+1],de=x?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;de.clear();let he=null;ue&&(he=x?y.text.globeExtVertexArray:y.icon.globeExtVertexArray);const ie=y.lineVertexArray,ye=x?y.text.placedSymbolArray:y.icon.placedSymbolArray,ge=f.transform.width/f.transform.height;let Ce,Pe=!1;for(let ke=0;ke<ye.length;ke++){const Le=ye.get(ke),{numGlyphs:$e,writingMode:nt}=Le;if(nt!==m.WritingMode.vertical||Pe||Ce===m.WritingMode.horizontal||(Pe=!0),Ce=nt,(Le.hidden||nt===m.WritingMode.vertical)&&!Pe){ro($e,de);continue}Pe=!1;const ot=new m.pointGeometry(Le.tileAnchorX,Le.tileAnchorY);let{x:zt,y:Ze,z:Ct}=$.projection.projectTilePoint(ot.x,ot.y,H.canonical);if(L){const[ni,cn,Zt]=L(ot);zt+=ni,Ze+=cn,Ct+=Zt}const ut=[zt,Ze,Ct,1];if(m.transformMat4$1(ut,ut,d),!Cn(ut,ae)){ro($e,de);continue}const kt=_i(f.transform.cameraToCenterDistance,ut[3]),it=m.evaluateSizeForFeature(Q,oe,Le),je=k?it/kt:it*kt,lt=Gt(zt,Ze,Ct,C);if(lt[3]<=0){ro($e,de);continue}let Mt={};const Pt=k?null:L,hn=Od(Le,je,!1,P,d,C,S,y.glyphOffsetArray,ie,de,he,lt,ot,Mt,ge,Pt,$.projection,H,k);Pe=hn.useVertical,Pt&&hn.needsFlipping&&(Mt={}),(hn.notEnoughRoom||Pe||hn.needsFlipping&&Od(Le,je,!0,P,d,C,S,y.glyphOffsetArray,ie,de,he,lt,ot,Mt,ge,Pt,$.projection,H,k).notEnoughRoom)&&ro($e,de)}x?(y.text.dynamicLayoutVertexBuffer.updateData(de),he&&y.text.globeExtVertexBuffer.updateData(he)):(y.icon.dynamicLayoutVertexBuffer.updateData(de),he&&y.icon.globeExtVertexBuffer.updateData(he))}function eo(y,d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae,de){const{lineStartIndex:he,glyphStartIndex:ie,segment:ye}=P,ge=ie+P.numGlyphs,Ce=he+P.lineLength,Pe=d.getoffsetX(ie),ke=d.getoffsetX(ge-1),Le=kr(y*Pe,f,x,C,S,k,ye,he,Ce,L,H,$,Q,oe,!0,ue,ae,de);if(!Le)return null;const $e=kr(y*ke,f,x,C,S,k,ye,he,Ce,L,H,$,Q,oe,!0,ue,ae,de);return $e?{first:Le,last:$e}:null}function ci(y,d,f,x){return y===m.WritingMode.horizontal&&Math.abs(x)>Math.abs(f)?{useVertical:!0}:y===m.WritingMode.vertical?x>0?{needsFlipping:!0}:null:0!==d&&(0===(C=f)||Math.abs(x/C)>Va)?1===d?{needsFlipping:!0}:null:f<0?{needsFlipping:!0}:null;var C}function Od(y,d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae,de,he,ie,ye){const ge=d/24,Ce=y.lineOffsetX*ge,Pe=y.lineOffsetY*ge,{lineStartIndex:ke,glyphStartIndex:Le,numGlyphs:$e,segment:nt,writingMode:ot,flipState:zt}=y,Ze=ke+y.lineLength,Ct=ut=>{if($){const[lt,Mt,Pt]=ut.up,hn=H.length;m.updateGlobeVertexNormal($,hn+0,lt,Mt,Pt),m.updateGlobeVertexNormal($,hn+1,lt,Mt,Pt),m.updateGlobeVertexNormal($,hn+2,lt,Mt,Pt),m.updateGlobeVertexNormal($,hn+3,lt,Mt,Pt)}const[kt,it,je]=ut.point;m.addDynamicAttributes(H,kt,it,je,ut.angle)};if($e>1){const ut=eo(ge,P,Ce,Pe,f,Q,oe,y,L,S,ue,de,!1,he,ie,ye);if(!ut)return{notEnoughRoom:!0};if(x&&!f){let[kt,it,je]=ut.first.point,[lt,Mt,Pt]=ut.last.point;[kt,it]=Gt(kt,it,je,k),[lt,Mt]=Gt(lt,Mt,Pt,k);const hn=ci(ot,zt,(lt-kt)*ae,Mt-it);if(y.flipState=hn&&hn.needsFlipping?1:2,hn)return hn}Ct(ut.first);for(let kt=Le+1;kt<Le+$e-1;kt++){const it=kr(ge*P.getoffsetX(kt),Ce,Pe,f,Q,oe,nt,ke,Ze,L,S,ue,de,!1,!1,he,ie,ye);if(!it)return H.length-=4*(kt-Le),{notEnoughRoom:!0};Ct(it)}Ct(ut.last)}else{if(x&&!f){const kt=Gt(oe.x,oe.y,0,C),it=ke+nt+1,je=new m.pointGeometry(L.getx(it),L.gety(it)),lt=Gt(je.x,je.y,0,C),Mt=lt[3]>0?lt:$n(oe,je,kt,1,C,void 0,he,ie.canonical),Pt=ci(ot,zt,(Mt[0]-kt[0])*ae,Mt[1]-kt[1]);if(y.flipState=Pt&&Pt.needsFlipping?1:2,Pt)return Pt}const ut=kr(ge*P.getoffsetX(Le),Ce,Pe,f,Q,oe,nt,ke,Ze,L,S,ue,de,!1,!1,he,ie,ye);if(!ut)return{notEnoughRoom:!0};Ct(ut)}return{}}function xi(y,d,f,x,C){const{x:S,y:k,z:P}=x.projectTilePoint(y.x,y.y,d);if(!C)return Gt(S,k,P,f);const[L,H,$]=C(y);return Gt(S+L,k+H,P+$,f)}function $n(y,d,f,x,C,S,k,P){const L=xi(y.sub(d)._unit()._add(y),P,C,k,S);return m.sub(L,f,L),m.normalize(L,L),m.scaleAndAdd(L,f,L,x)}function kr(y,d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae,de,he,ie){const ye=x?y-d:y+d;let ge=ye>0?1:-1,Ce=0;x&&(ge*=-1,Ce=Math.PI),ge<0&&(Ce+=Math.PI);let Pe=P+k+(ge>0?0:1)|0,ke=C,Le=C,$e=0,nt=0;const ot=Math.abs(ye),zt=[],Ze=[];let Ct=S,ut=Ct;const kt=()=>$n(ut,Ct,Le,ot-$e+1,$,oe,de,he.canonical);for(;$e+nt<=ot;){if(Pe+=ge,Pe<P||Pe>=L)return null;if(Le=ke,ut=Ct,zt.push(Le),ue&&Ze.push(ut),Ct=new m.pointGeometry(H.getx(Pe),H.gety(Pe)),ke=Q[Pe],!ke){const Zt=xi(Ct,he.canonical,$,de,oe);ke=Zt[3]>0?Q[Pe]=Zt:kt()}$e+=nt,nt=m.distance(Le,ke)}ae&&oe&&(Q[Pe]&&(ke=kt(),nt=m.distance(Le,ke)),Q[Pe]=ke);const it=(ot-$e)/nt,je=Ct.sub(ut)._mult(it)._add(ut),lt=m.sub([],ke,Le),Mt=m.scaleAndAdd([],Le,lt,it);let Pt=[0,0,1],hn=lt[0],ni=lt[1];if(ie&&(Pt=de.upVector(he.canonical,je.x,je.y),0!==Pt[0]||0!==Pt[1]||1!==Pt[2])){const Zt=[Pt[2],0,-Pt[0]],bn=m.cross([],Pt,Zt);m.normalize(Zt,Zt),m.normalize(bn,bn),hn=m.dot(lt,Zt),ni=m.dot(lt,bn)}if(f){const Zt=m.cross([],Pt,lt);m.normalize(Zt,Zt),m.scaleAndAdd(Mt,Mt,Zt,f*ge)}const cn=Ce+Math.atan2(ni,hn);return zt.push(Mt),ue&&Ze.push(je),{point:Mt,angle:cn,path:zt,tilePath:Ze,up:Pt}}function ro(y,d){const f=d.length,x=f+4*y;d.resize(x),d.float32.fill(-1/0,4*f,4*x)}function by(y,d,f){const x=d[0],C=d[1];return y[0]=f[0]*x+f[4]*C+f[12],y[1]=f[1]*x+f[5]*C+f[13],y[3]=f[3]*x+f[7]*C+f[15],y}const Ar=100;class Dt{constructor(d,f,x=new Tf(d.width+200,d.height+200,25),C=new Tf(d.width+200,d.height+200,25)){this.transform=d,this.grid=x,this.ignoredGrid=C,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+Ar,this.screenBottomBoundary=d.height+Ar,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200,this.fogState=f}placeCollisionBox(d,f,x,C,S,k,P,L){let H=x.projectedAnchorX,$=x.projectedAnchorY,Q=x.projectedAnchorZ;const oe=x.elevation,ue=x.tileID,ae=d.getProjection();if(oe&&ue){const[ke,Le,$e]=ae.upVector(ue.canonical,x.tileAnchorX,x.tileAnchorY),nt=ae.upVectorScale(ue.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=ke*oe*nt,$+=Le*oe*nt,Q+=$e*oe*nt}const de=this.projectAndGetPerspectiveRatio(P,H,$,Q,x.tileID,"globe"===ae.name||!!oe||this.transform.pitch>0,ae),he=k*de.perspectiveRatio,ie=(x.x1*f+C.x-x.padding)*he+de.point.x,ye=(x.y1*f+C.y-x.padding)*he+de.point.y,ge=(x.x2*f+C.x+x.padding)*he+de.point.x,Ce=(x.y2*f+C.y+x.padding)*he+de.point.y,Pe=de.perspectiveRatio<=.55||de.occluded;return!this.isInsideGrid(ie,ye,ge,Ce)||!S&&this.grid.hitTest(ie,ye,ge,Ce,L)||Pe?{box:[],offscreen:!1,occluded:de.occluded}:{box:[ie,ye,ge,Ce],offscreen:this.isOffscreen(ie,ye,ge,Ce),occluded:!1}}placeCollisionCircles(d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae,de){const he=[],ie=this.transform.elevation,ye=d.getProjection(),ge=ie?ie.getAtTileOffsetFunc(de,this.transform.center.lat,this.transform.worldSize,ye):null,Ce=new m.pointGeometry(x.tileAnchorX,x.tileAnchorY);let{x:Pe,y:ke,z:Le}=ye.projectTilePoint(Ce.x,Ce.y,de.canonical);if(ge){const[je,lt,Mt]=ge(Ce);Pe+=je,ke+=lt,Le+=Mt}const $e="globe"===ye.name,nt=this.projectAndGetPerspectiveRatio(P,Pe,ke,Le,de,$e||!!ie||this.transform.pitch>0,ye),{perspectiveRatio:ot}=nt,zt=(Q?k/ot:k*ot)/m.ONE_EM,Ze=Gt(Pe,ke,Le,L),Ct=nt.signedDistanceFromCamera>0?eo(zt,S,x.lineOffsetX*zt,x.lineOffsetY*zt,!1,Ze,Ce,x,C,L,{},ie&&!Q?ge:null,Q&&!!ie,ye,de,Q):null;let ut=!1,kt=!1,it=!0;if(Ct&&!nt.occluded){const je=.5*ue*ot+ae,lt=new m.pointGeometry(-100,-100),Mt=new m.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Pt=new Nl,{first:hn,last:ni}=Ct,cn=hn.path.length;let Zt=[];for(let Tn=cn-1;Tn>=1;Tn--)Zt.push(hn.path[Tn]);for(let Tn=1;Tn<ni.path.length;Tn++)Zt.push(ni.path[Tn]);const bn=2.5*je;H&&(Zt=Zt.map(([Tn,$i,Gi],so)=>(ge&&!$e&&(Gi=ge(so<cn-1?hn.tilePath[cn-1-so]:ni.tilePath[so-cn+2])[2]),Gt(Tn,$i,Gi,H))),Zt.some(Tn=>Tn[3]<=0)&&(Zt=[]));let yi=[];if(Zt.length>0){let Tn=1/0,$i=-1/0,Gi=1/0,so=-1/0;for(const Xi of Zt)Tn=Math.min(Tn,Xi[0]),Gi=Math.min(Gi,Xi[1]),$i=Math.max($i,Xi[0]),so=Math.max(so,Xi[1]);$i>=lt.x&&Tn<=Mt.x&&so>=lt.y&&Gi<=Mt.y&&(yi=[Zt.map(Xi=>new m.pointGeometry(Xi[0],Xi[1]))],(Tn<lt.x||$i>Mt.x||Gi<lt.y||so>Mt.y)&&(yi=m.clipLine(yi,lt.x,lt.y,Mt.x,Mt.y)))}for(const Tn of yi){Pt.reset(Tn,.25*je);let $i=0;$i=Pt.length<=.5*je?1:Math.ceil(Pt.paddedLength/bn)+1;for(let Gi=0;Gi<$i;Gi++){const so=Gi/Math.max($i-1,1),Xi=Pt.lerp(so),tr=Xi.x+Ar,us=Xi.y+Ar;he.push(tr,us,je,0);const Js=tr-je,yl=us-je,Ni=tr+je,co=us+je;if(it=it&&this.isOffscreen(Js,yl,Ni,co),kt=kt||this.isInsideGrid(Js,yl,Ni,co),!f&&this.grid.hitTestCircle(tr,us,je,oe)&&(ut=!0,!$))return{circles:[],offscreen:!1,collisionDetected:ut,occluded:!1}}}}return{circles:!$&&ut||!kt?[]:he,offscreen:it,collisionDetected:ut,occluded:nt.occluded}}queryRenderedSymbols(d){if(0===d.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const f=[];let x=1/0,C=1/0,S=-1/0,k=-1/0;for(const $ of d){const Q=new m.pointGeometry($.x+Ar,$.y+Ar);x=Math.min(x,Q.x),C=Math.min(C,Q.y),S=Math.max(S,Q.x),k=Math.max(k,Q.y),f.push(Q)}const P=this.grid.query(x,C,S,k).concat(this.ignoredGrid.query(x,C,S,k)),L={},H={};for(const $ of P){const Q=$.key;if(void 0===L[Q.bucketInstanceId]&&(L[Q.bucketInstanceId]={}),L[Q.bucketInstanceId][Q.featureIndex])continue;const oe=[new m.pointGeometry($.x1,$.y1),new m.pointGeometry($.x2,$.y1),new m.pointGeometry($.x2,$.y2),new m.pointGeometry($.x1,$.y2)];m.polygonIntersectsPolygon(f,oe)&&(L[Q.bucketInstanceId][Q.featureIndex]=!0,void 0===H[Q.bucketInstanceId]&&(H[Q.bucketInstanceId]=[]),H[Q.bucketInstanceId].push(Q.featureIndex))}return H}insertCollisionBox(d,f,x,C,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:C,collisionGroupID:S},d[0],d[1],d[2],d[3])}insertCollisionCircles(d,f,x,C,S){const k=f?this.ignoredGrid:this.grid,P={bucketInstanceId:x,featureIndex:C,collisionGroupID:S};for(let L=0;L<d.length;L+=4)k.insertCircle(P,d[L],d[L+1],d[L+2])}projectAndGetPerspectiveRatio(d,f,x,C,S,k,P){const L=[f,x,C,1];let H=!1;C||this.transform.pitch>0?(m.transformMat4$1(L,L,d),this.fogState&&S&&"globe"!==P.name&&(H=function(ue,ae,de,he,ie,ye){const ge=ye.calculateFogTileMatrix(ie),Ce=[ae,de,he];return m.transformMat4(Ce,Ce,ge),qs(ue,Ce,ye.pitch,ye._fov)}(this.fogState,f,x,C,S.toUnwrapped(),this.transform)>.9)):by(L,L,d);const $=L[3];return{point:new m.pointGeometry((L[0]/$+1)/2*this.transform.width+Ar,(-L[1]/$+1)/2*this.transform.height+Ar),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(P)/$*.5,1.5),signedDistanceFromCamera:$,occluded:k&&L[2]>$||H}}isOffscreen(d,f,x,C){return x<Ar||d>=this.screenRightBoundary||C<Ar||f>this.screenBottomBoundary}isInsideGrid(d,f,x,C){return x>=0&&d<this.gridRightBoundary&&C>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const d=m.identity([]);return m.translate(d,d,[-100,-100,0]),d}}function Ua(y,d,f){const x=d.createTileMatrix(y,y.worldSize,f.toUnwrapped());return m.multiply(new Float32Array(16),y.projMatrix,x)}function ri(y,d,f){if(d.projection.name===f.projection.name)return y.projMatrix;const x=f.clone();return x.setProjection(d.projection),Ua(x,d.getProjection(),y)}function Zi(y,d,f){return d.name===f.projection.name?y.projMatrix:Ua(f,d,y)}class Rd{constructor(d,f,x,C){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?f:-f))):C&&x?1:0,this.placed=x}isHidden(){return 0===this.opacity&&!this.placed}}class Du{constructor(d,f,x,C,S,k=!1){this.text=new Rd(d?d.text:null,f,x,S),this.icon=new Rd(d?d.icon:null,f,C,S),this.clipped=k}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Mu{constructor(d,f,x,C=!1){this.text=d,this.icon=f,this.skipFade=x,this.clipped=C}}class Iu{constructor(){this.invProjMatrix=m.create(),this.viewportMatrix=m.create(),this.circles=[]}}class Do{constructor(d,f,x,C,S){this.bucketInstanceId=d,this.featureIndex=f,this.sourceLayerIndex=x,this.bucketIndex=C,this.tileID=S}}class qo{constructor(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}}get(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){const f=++this.maxGroupID;this.collisionGroups[d]={ID:f,predicate:x=>x.collisionGroupID===f}}return this.collisionGroups[d]}}function Wh(y,d,f,x,C){const{horizontalAlign:S,verticalAlign:k}=m.getAnchorAlignment(y),P=-(S-.5)*d,L=-(k-.5)*f,H=m.evaluateVariableOffset(y,x);return new m.pointGeometry(P+H[0]*C,L+H[1]*C)}function qh(y,d,f,x,C){const S=new m.pointGeometry(y,d);return f&&S._rotate(x?C:-C),S}class Zo{constructor(d,f,x,C,S){this.transform=d.clone(),this.projection=d.projection.name,this.collisionIndex=new Dt(this.transform,S),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new qo(x),this.collisionCircleArrays={},this.prevPlacement=C,C&&(C.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(d,f,x,C){const S=x.getBucket(f),k=x.latestFeatureIndex;if(!S||!k||f.id!==S.layerIds[0])return;const P=S.layers[0].layout,L=x.collisionBoxArray,H=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),$=x.tileSize/m.EXTENT,Q=x.tileID.toUnwrapped();this.transform.setProjection(S.projection);const oe=(ue=x.tileID,ae=S.getProjection(),de=this.transform,ae.name===this.projection?de.calculateProjMatrix(ue.toUnwrapped()):Ua(de,ae,ue));var ue,ae,de;const he="map"===P.get("text-pitch-alignment"),ie="map"===P.get("text-rotation-alignment");f.compileFilter();const ye=f.dynamicFilter(),ge=f.dynamicFilterNeedsFeature(),Ce=this.transform.calculatePixelsToTileUnitsMatrix(x),Pe=Wo(oe,x.tileID.canonical,he,ie,this.transform,S.getProjection(),Ce);let ke=null;if(he){const nt=xc(oe,x.tileID.canonical,he,ie,this.transform,S.getProjection(),Ce);ke=m.multiply([],this.transform.labelPlaneMatrix,nt)}let Le=null;ye&&x.latestFeatureIndex&&(Le={unwrappedTileID:Q,dynamicFilter:ye,dynamicFilterNeedsFeature:ge,featureIndex:x.latestFeatureIndex}),this.retainedQueryData[S.bucketInstanceId]=new Do(S.bucketInstanceId,k,S.sourceLayerIndex,S.index,x.tileID);const $e={bucket:S,layout:P,posMatrix:oe,textLabelPlaneMatrix:Pe,labelToScreenMatrix:ke,clippingData:Le,scale:H,textPixelRatio:$,holdingForFade:x.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:m.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:m.evaluateSizeForZoom(S.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(C)for(const nt of S.sortKeyRanges){const{sortKey:ot,symbolInstanceStart:zt,symbolInstanceEnd:Ze}=nt;d.push({sortKey:ot,symbolInstanceStart:zt,symbolInstanceEnd:Ze,parameters:$e})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:$e})}attemptAnchorPlacement(d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae,de,he,ie,ye){const{textOffset0:ge,textOffset1:Ce,crossTileID:Pe}=oe,ke=[ge,Ce],Le=Wh(d,x,C,ke,S),$e=this.collisionIndex.placeCollisionBox(ae,S,f,qh(Le.x,Le.y,k,P,this.transform.angle),Q,L,H,$.predicate);if(he){const nt=ae.getSymbolInstanceIconSize(ye,this.transform.zoom,oe.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(ae,nt,he,qh(Le.x,Le.y,k,P,this.transform.angle),Q,L,H,$.predicate).box.length)return}if($e.box.length>0){let nt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Pe]&&this.prevPlacement.placements[Pe]&&this.prevPlacement.placements[Pe].text&&(nt=this.prevPlacement.variableOffsets[Pe].anchor),this.variableOffsets[Pe]={textOffset:ke,width:x,height:C,anchor:d,textScale:S,prevAnchor:nt},this.markUsedJustification(ae,d,oe,de),ae.allowVerticalPlacement&&(this.markUsedOrientation(ae,de,oe),this.placedOrientations[Pe]=de),{shift:Le,placedGlyphBoxes:$e}}}placeLayerBucketPart(d,f,x,C){const{bucket:S,layout:k,posMatrix:P,textLabelPlaneMatrix:L,labelToScreenMatrix:H,clippingData:$,textPixelRatio:Q,holdingForFade:oe,collisionBoxArray:ue,partiallyEvaluatedTextSize:ae,partiallyEvaluatedIconSize:de,collisionGroup:he}=d.parameters,ie=k.get("text-optional"),ye=k.get("icon-optional"),ge=k.get("text-allow-overlap"),Ce=k.get("icon-allow-overlap"),Pe="map"===k.get("text-rotation-alignment"),ke="map"===k.get("text-pitch-alignment"),Le="none"!==k.get("icon-text-fit"),$e="viewport-y"===k.get("symbol-z-order");this.transform.setProjection(S.projection);let nt=ge&&(Ce||!S.hasIconData()||ye),ot=Ce&&(ge||!S.hasTextData()||ie);!S.collisionArrays&&ue&&S.deserializeCollisionBoxes(ue),x&&C&&S.updateCollisionDebugBuffers(this.transform.zoom,ue);const zt=(Ze,Ct,ut)=>{const{crossTileID:kt,numVerticalGlyphVertices:it}=Ze;if($){const Ni={zoom:this.transform.zoom,pitch:this.transform.pitch};let co=null;if($.dynamicFilterNeedsFeature){const Di=this.retainedQueryData[S.bucketInstanceId];co=$.featureIndex.loadFeature({featureIndex:Ze.featureIndex,bucketIndex:Di.bucketIndex,sourceLayerIndex:Di.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,$.dynamicFilter)(Ni,co,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new m.pointGeometry(Ze.tileAnchorX,Ze.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[kt]=new Mu(!1,!1,!1,!0),void(f[kt]=!0)}if(f[kt])return;if(oe)return void(this.placements[kt]=new Mu(!1,!1,!1));let je=!1,lt=!1,Mt=!0,Pt=!1,hn=!1,ni=null,cn={box:null,offscreen:null,occluded:null},Zt={box:null,offscreen:null,occluded:null},bn=null,yi=null,Tn=null,$i=0,Gi=0,so=0;ut.textFeatureIndex?$i=ut.textFeatureIndex:Ze.useRuntimeCollisionCircles&&($i=Ze.featureIndex),ut.verticalTextFeatureIndex&&(Gi=ut.verticalTextFeatureIndex);const Xi=Ni=>{Ni.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const co=this.transform.elevation;(co||Ni.elevation)&&(Ni.elevation=co?co.getAtTileOffset(Ni.tileID,Ni.tileAnchorX,Ni.tileAnchorY):0)},tr=ut.textBox;if(tr){Xi(tr);const Ni=Di=>{let Io=m.WritingMode.horizontal;if(S.allowVerticalPlacement&&!Di&&this.prevPlacement){const Nr=this.prevPlacement.placedOrientations[kt];Nr&&(this.placedOrientations[kt]=Nr,Io=Nr,this.markUsedOrientation(S,Io,Ze))}return Io},co=(Di,Io)=>{if(S.allowVerticalPlacement&&it>0&&ut.verticalTextBox){for(const Nr of S.writingModes)if(Nr===m.WritingMode.vertical?(cn=Io(),Zt=cn):cn=Di(),cn&&cn.box&&cn.box.length)break}else cn=Di()};if(k.get("text-variable-anchor")){let Di=k.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[kt]){const uo=this.prevPlacement.variableOffsets[kt];Di.indexOf(uo.anchor)>0&&(Di=Di.filter(wr=>wr!==uo.anchor),Di.unshift(uo.anchor))}const Io=(uo,wr,Yr)=>{const vl=S.getSymbolInstanceTextSize(ae,Ze,this.transform.zoom,Ct),Nc=(uo.x2-uo.x1)*vl+2*uo.padding,Es=(uo.y2-uo.y1)*vl+2*uo.padding,Ns=Le&&!Ce?wr:null;Ns&&Xi(Ns);let bl={box:[],offscreen:!1,occluded:!1};const xa=ge?2*Di.length:Di.length;for(let Ss=0;Ss<xa;++Ss){const Zu=this.attemptAnchorPlacement(Di[Ss%Di.length],uo,Nc,Es,vl,Pe,ke,Q,P,he,Ss>=Di.length,Ze,Ct,S,Yr,Ns,ae,de);if(Zu&&(bl=Zu.placedGlyphBoxes,bl&&bl.box&&bl.box.length)){je=!0,ni=Zu.shift;break}}return bl};co(()=>Io(tr,ut.iconBox,m.WritingMode.horizontal),()=>{const uo=ut.verticalTextBox;return uo&&Xi(uo),S.allowVerticalPlacement&&!(cn&&cn.box&&cn.box.length)&&it>0&&uo?Io(uo,ut.verticalIconBox,m.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),cn&&(je=cn.box,Mt=cn.offscreen,Pt=cn.occluded);const Nr=Ni(cn&&cn.box);if(!je&&this.prevPlacement){const uo=this.prevPlacement.variableOffsets[kt];uo&&(this.variableOffsets[kt]=uo,this.markUsedJustification(S,uo.anchor,Ze,Nr))}}else{const Di=(Io,Nr)=>{const uo=S.getSymbolInstanceTextSize(ae,Ze,this.transform.zoom,Ct),wr=this.collisionIndex.placeCollisionBox(S,uo,Io,new m.pointGeometry(0,0),ge,Q,P,he.predicate);return wr&&wr.box&&wr.box.length&&(this.markUsedOrientation(S,Nr,Ze),this.placedOrientations[kt]=Nr),wr};co(()=>Di(tr,m.WritingMode.horizontal),()=>{const Io=ut.verticalTextBox;return S.allowVerticalPlacement&&it>0&&Io?(Xi(Io),Di(Io,m.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Ni(cn&&cn.box&&cn.box.length)}}if(bn=cn,je=bn&&bn.box&&bn.box.length>0,Mt=bn&&bn.offscreen,Pt=bn&&bn.occluded,Ze.useRuntimeCollisionCircles){const Ni=S.text.placedSymbolArray.get(Ze.centerJustifiedTextSymbolIndex>=0?Ze.centerJustifiedTextSymbolIndex:Ze.verticalPlacedTextSymbolIndex),co=m.evaluateSizeForFeature(S.textSizeData,ae,Ni),Di=k.get("text-padding");yi=this.collisionIndex.placeCollisionCircles(S,ge,Ni,S.lineVertexArray,S.glyphOffsetArray,co,P,L,H,x,ke,he.predicate,Ze.collisionCircleDiameter*co/m.ONE_EM,Di,this.retainedQueryData[S.bucketInstanceId].tileID),je=ge||yi.circles.length>0&&!yi.collisionDetected,Mt=Mt&&yi.offscreen,Pt=yi.occluded}if(ut.iconFeatureIndex&&(so=ut.iconFeatureIndex),ut.iconBox){const Ni=co=>{Xi(co);const Di=Le&&ni?qh(ni.x,ni.y,Pe,ke,this.transform.angle):new m.pointGeometry(0,0),Io=S.getSymbolInstanceIconSize(de,this.transform.zoom,Ze.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,Io,co,Di,Ce,Q,P,he.predicate)};Zt&&Zt.box&&Zt.box.length&&ut.verticalIconBox?(Tn=Ni(ut.verticalIconBox),lt=Tn.box.length>0):(Tn=Ni(ut.iconBox),lt=Tn.box.length>0),Mt=Mt&&Tn.offscreen,hn=Tn.occluded}const us=ie||0===Ze.numHorizontalGlyphVertices&&0===it,Js=ye||0===Ze.numIconVertices;if(us||Js?Js?us||(lt=lt&&je):je=lt&&je:lt=je=lt&&je,je&&bn&&bn.box&&this.collisionIndex.insertCollisionBox(bn.box,k.get("text-ignore-placement"),S.bucketInstanceId,Zt&&Zt.box&&Gi?Gi:$i,he.ID),lt&&Tn&&this.collisionIndex.insertCollisionBox(Tn.box,k.get("icon-ignore-placement"),S.bucketInstanceId,so,he.ID),yi&&(je&&this.collisionIndex.insertCollisionCircles(yi.circles,k.get("text-ignore-placement"),S.bucketInstanceId,$i,he.ID),x)){const Ni=S.bucketInstanceId;let co=this.collisionCircleArrays[Ni];void 0===co&&(co=this.collisionCircleArrays[Ni]=new Iu);for(let Di=0;Di<yi.circles.length;Di+=4)co.circles.push(yi.circles[Di+0]),co.circles.push(yi.circles[Di+1]),co.circles.push(yi.circles[Di+2]),co.circles.push(yi.collisionDetected?1:0)}const yl="globe"!==S.projection.name;nt=nt&&(yl||!Pt),ot=ot&&(yl||!hn),this.placements[kt]=new Mu(je||nt,lt||ot,Mt||S.justReloaded),f[kt]=!0};if($e){const Ze=S.getSortedSymbolIndexes(this.transform.angle);for(let Ct=Ze.length-1;Ct>=0;--Ct){const ut=Ze[Ct];zt(S.symbolInstances.get(ut),ut,S.collisionArrays[ut])}}else for(let Ze=d.symbolInstanceStart;Ze<d.symbolInstanceEnd;Ze++)zt(S.symbolInstances.get(Ze),Ze,S.collisionArrays[Ze]);if(x&&S.bucketInstanceId in this.collisionCircleArrays){const Ze=this.collisionCircleArrays[S.bucketInstanceId];m.invert(Ze.invProjMatrix,P),Ze.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(d,f,x,C){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:L,crossTileID:H}=x,$=m.getAnchorJustification(f),Q=C===m.WritingMode.vertical?L:"left"===$?S:"center"===$?k:"right"===$?P:-1;S>=0&&(d.text.placedSymbolArray.get(S).crossTileID=Q>=0&&S!==Q?0:H),k>=0&&(d.text.placedSymbolArray.get(k).crossTileID=Q>=0&&k!==Q?0:H),P>=0&&(d.text.placedSymbolArray.get(P).crossTileID=Q>=0&&P!==Q?0:H),L>=0&&(d.text.placedSymbolArray.get(L).crossTileID=Q>=0&&L!==Q?0:H)}markUsedOrientation(d,f,x){const C=f===m.WritingMode.horizontal||f===m.WritingMode.horizontalOnly?f:0,S=f===m.WritingMode.vertical?f:0,{leftJustifiedTextSymbolIndex:k,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:H}=x,$=d.text.placedSymbolArray;k>=0&&($.get(k).placedOrientation=C),P>=0&&($.get(P).placedOrientation=C),L>=0&&($.get(L).placedOrientation=C),H>=0&&($.get(H).placedOrientation=S)}commit(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let x=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const C=f?f.symbolFadeChange(d):1,S=f?f.opacities:{},k=f?f.variableOffsets:{},P=f?f.placedOrientations:{};for(const L in this.placements){const H=this.placements[L],$=S[L];$?(this.opacities[L]=new Du($,C,H.text,H.icon,null,H.clipped),x=x||H.text!==$.text.placed||H.icon!==$.icon.placed):(this.opacities[L]=new Du(null,C,H.text,H.icon,H.skipFade,H.clipped),x=x||H.text||H.icon)}for(const L in S){const H=S[L];if(!this.opacities[L]){const $=new Du(H,C,!1,!1);$.isHidden()||(this.opacities[L]=$,x=x||H.text.placed||H.icon.placed)}}for(const L in k)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=k[L]);for(const L in P)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=P[L]);x?this.lastPlacementChangeTime=d:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:d)}updateLayerOpacities(d,f){const x={};for(const C of f){const S=C.getBucket(d);S&&C.latestFeatureIndex&&d.id===S.layerIds[0]&&this.updateBucketOpacities(S,x,C.collisionBoxArray)}}updateBucketOpacities(d,f,x){d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();const C=d.layers[0].layout,S=!!d.layers[0].dynamicFilter(),k=new Du(null,0,!1,!1,!0),P=C.get("text-allow-overlap"),L=C.get("icon-allow-overlap"),H=C.get("text-variable-anchor"),$="map"===C.get("text-rotation-alignment"),Q="map"===C.get("text-pitch-alignment"),oe="none"!==C.get("icon-text-fit"),ue=new Du(null,0,P&&(L||!d.hasIconData()||C.get("icon-optional")),L&&(P||!d.hasTextData()||C.get("text-optional")),!0);!d.collisionArrays&&x&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(x);const ae=(he,ie,ye)=>{for(let ge=0;ge<ie/4;ge++)he.opacityVertexArray.emplaceBack(ye)};let de=0;for(let he=0;he<d.symbolInstances.length;he++){const ie=d.symbolInstances.get(he),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:ge,crossTileID:Ce,numIconVertices:Pe}=ie;let ke=this.opacities[Ce];f[Ce]?ke=k:ke||(ke=ue,this.opacities[Ce]=ke),f[Ce]=!0;const Le=ye>0||ge>0,$e=Pe>0,nt=this.placedOrientations[Ce],ot=nt===m.WritingMode.vertical,zt=nt===m.WritingMode.horizontal||nt===m.WritingMode.horizontalOnly;if(!Le&&!$e||ke.isHidden()||de++,Le){const Ze=as(ke.text);ae(d.text,ye,ot?Ui:Ze),ae(d.text,ge,zt?Ui:Ze);const Ct=ke.text.isHidden(),{leftJustifiedTextSymbolIndex:ut,centerJustifiedTextSymbolIndex:kt,rightJustifiedTextSymbolIndex:it,verticalPlacedTextSymbolIndex:je}=ie,lt=d.text.placedSymbolArray,Mt=Ct||ot?1:0;ut>=0&&(lt.get(ut).hidden=Mt),kt>=0&&(lt.get(kt).hidden=Mt),it>=0&&(lt.get(it).hidden=Mt),je>=0&&(lt.get(je).hidden=Ct||zt?1:0);const Pt=this.variableOffsets[Ce];Pt&&this.markUsedJustification(d,Pt.anchor,ie,nt);const hn=this.placedOrientations[Ce];hn&&(this.markUsedJustification(d,"left",ie,hn),this.markUsedOrientation(d,hn,ie))}if($e){const Ze=as(ke.icon),{placedIconSymbolIndex:Ct,verticalPlacedIconSymbolIndex:ut}=ie,kt=d.icon.placedSymbolArray,it=ke.icon.isHidden()?1:0;Ct>=0&&(ae(d.icon,Pe,ot?Ui:Ze),kt.get(Ct).hidden=it),ut>=0&&(ae(d.icon,ie.numVerticalIconVertices,zt?Ui:Ze),kt.get(ut).hidden=it)}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){const Ze=d.collisionArrays[he];if(Ze){let Ct=new m.pointGeometry(0,0),ut=!0;if(Ze.textBox||Ze.verticalTextBox){if(H){const it=this.variableOffsets[Ce];it?(Ct=Wh(it.anchor,it.width,it.height,it.textOffset,it.textScale),$&&Ct._rotate(Q?this.transform.angle:-this.transform.angle)):ut=!1}S&&(ut=!ke.clipped),Ze.textBox&&bs(d.textCollisionBox.collisionVertexArray,ke.text.placed,!ut||ot,Ct.x,Ct.y),Ze.verticalTextBox&&bs(d.textCollisionBox.collisionVertexArray,ke.text.placed,!ut||zt,Ct.x,Ct.y)}const kt=ut&&Boolean(!zt&&Ze.verticalIconBox);Ze.iconBox&&bs(d.iconCollisionBox.collisionVertexArray,ke.icon.placed,kt,oe?Ct.x:0,oe?Ct.y:0),Ze.verticalIconBox&&bs(d.iconCollisionBox.collisionVertexArray,ke.icon.placed,!kt,oe?Ct.x:0,oe?Ct.y:0)}}}if(d.fullyClipped=0===de,d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){const he=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=he.invProjMatrix,d.placementViewportMatrix=he.viewportMatrix,d.collisionCircleArray=he.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}}symbolFadeChange(d){return 0===this.fadeDuration?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(d){return Math.max(0,(this.transform.zoom-d)/1.5)}hasTransitions(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(d,f){const x=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*x>d}setStale(){this.stale=!0}}function bs(y,d,f,x,C){y.emplaceBack(d?1:0,f?1:0,x||0,C||0),y.emplaceBack(d?1:0,f?1:0,x||0,C||0),y.emplaceBack(d?1:0,f?1:0,x||0,C||0),y.emplaceBack(d?1:0,f?1:0,x||0,C||0)}const xy=Math.pow(2,25),Ef=Math.pow(2,24),cr=Math.pow(2,17),Ld=Math.pow(2,16),xg=Math.pow(2,9),Fd=Math.pow(2,8),Kr=Math.pow(2,1);function as(y){if(0===y.opacity&&!y.placed)return 0;if(1===y.opacity&&y.placed)return 4294967295;const d=y.placed?1:0,f=Math.floor(127*y.opacity);return f*xy+d*Ef+f*cr+d*Ld+f*xg+d*Fd+f*Kr+d}const Ui=0;class Bl{constructor(d){this._sortAcrossTiles="viewport-y"!==d.layout.get("symbol-z-order")&&void 0!==d.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(d,f,x,C,S){const k=this._bucketParts;for(;this._currentTileIndex<d.length;)if(f.getBucketParts(k,C,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort((P,L)=>P.sortKey-L.sortKey));this._currentPartIndex<k.length;){const P=k[this._currentPartIndex];if(f.placeLayerBucketPart(P,this._seenCrossTileIDs,x,0===P.symbolInstanceStart),this._currentPartIndex++,S())return!0}return!1}}class Zh{constructor(d,f,x,C,S,k,P,L){this.placement=new Zo(d,S,k,P,L),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=C,this._done=!1}isDone(){return this._done}continuePlacement(d,f,x){const C=m.exported.now(),S=()=>{const k=m.exported.now()-C;return!this._forceFullPlacement&&k>2};for(;this._currentPlacementIndex>=0;){const k=f[d[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if("symbol"===k.type&&(!k.minzoom||k.minzoom<=P)&&(!k.maxzoom||k.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new Bl(k)),this._inProgressLayer.continuePlacement(x[k.source],this.placement,this._showCollisionBoxes,k,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(d){return this.placement.commit(d),this.placement}}const Sf=512/m.EXTENT/2;class an{constructor(d,f,x){this.tileID=d,this.indexedSymbolInstances={},this.bucketInstanceId=x;for(let C=0;C<f.length;C++){const S=f.get(C),k=S.key;this.indexedSymbolInstances[k]||(this.indexedSymbolInstances[k]=[]),this.indexedSymbolInstances[k].push({crossTileID:S.crossTileID,coord:this.getScaledCoordinates(S,d)})}}getScaledCoordinates(d,f){const x=Sf/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*m.EXTENT+d.tileAnchorX)*x),y:Math.floor((f.canonical.y*m.EXTENT+d.tileAnchorY)*x)}}findMatches(d,f,x){const C=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let S=0;S<d.length;S++){const k=d.get(S);if(k.crossTileID)continue;const P=this.indexedSymbolInstances[k.key];if(!P)continue;const L=this.getScaledCoordinates(k,f);for(const H of P)if(Math.abs(H.coord.x-L.x)<=C&&Math.abs(H.coord.y-L.y)<=C&&!x[H.crossTileID]){x[H.crossTileID]=!0,k.crossTileID=H.crossTileID;break}}}}class wg{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class wn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(d){const f=Math.round((d-this.lng)/360);if(0!==f)for(const x in this.indexes){const C=this.indexes[x],S={};for(const k in C){const P=C[k];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+f),S[P.tileID.key]=P}this.indexes[x]=S}this.lng=d}addBucket(d,f,x){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(let S=0;S<f.symbolInstances.length;S++)f.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});const C=this.usedCrossTileIDs[d.overscaledZ];for(const S in this.indexes){const k=this.indexes[S];if(Number(S)>d.overscaledZ)for(const P in k){const L=k[P];L.tileID.isChildOf(d)&&L.findMatches(f.symbolInstances,d,C)}else{const P=k[d.scaledTo(Number(S)).key];P&&P.findMatches(f.symbolInstances,d,C)}}for(let S=0;S<f.symbolInstances.length;S++){const k=f.symbolInstances.get(S);k.crossTileID||(k.crossTileID=x.generate(),C[k.crossTileID]=!0)}return void 0===this.indexes[d.overscaledZ]&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new an(d,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(d,f){for(const x in f.indexedSymbolInstances)for(const C of f.indexedSymbolInstances[x])delete this.usedCrossTileIDs[d][C.crossTileID]}removeStaleBuckets(d){let f=!1;for(const x in this.indexes){const C=this.indexes[x];for(const S in C)d[C[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,C[S]),delete C[S],f=!0)}return f}}class zd{constructor(){this.layerIndexes={},this.crossTileIDs=new wg,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(d,f,x,C){let S=this.layerIndexes[d.id];void 0===S&&(S=this.layerIndexes[d.id]=new wn);let k=!1;const P={};"globe"!==C.name&&S.handleWrapJump(x);for(const L of f){const H=L.getBucket(d);H&&d.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(L.tileID,H,this.crossTileIDs)&&(k=!0),P[H.bucketInstanceId]=!0)}return S.removeStaleBuckets(P)&&(k=!0),k}pruneUnusedLayers(d){const f={};d.forEach(x=>{f[x]=!0});for(const x in this.layerIndexes)f[x]||delete this.layerIndexes[x]}}const Nd=(y,d)=>m.emitValidationErrors(y,d&&d.filter(f=>"source.canvas"!==f.identifier)),wc=m.pick(On,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Vl=m.pick(On,["setCenter","setZoom","setBearing","setPitch"]),Kh={version:8,layers:[],sources:{}},ul={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ls extends m.Evented{constructor(d,f={}){super(),this.map=d,this.dispatcher=new Os(Vn(),this),this.imageManager=new nn,this.imageManager.setEventedParent(this),this.glyphManager=new m.GlyphManager(d._requestManager,f.localFontFamily?m.LocalGlyphMode.all:f.localIdeographFontFamily?m.LocalGlyphMode.ideographs:m.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.crossTileSymbolIndex=new zd,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",m.getReferrer());const x=this;this._rtlTextPluginCallback=ls.registerForPluginStateChange(C=>{x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},(S,k)=>{if(m.triggerPluginCompletionEvent(S),k&&k.every(P=>P))for(const P in x._sourceCaches){const L=x._sourceCaches[P],H=L.getSource().type;"vector"!==H&&"geojson"!==H||L.reload()}})}),this.on("data",C=>{if("source"!==C.dataType||"metadata"!==C.sourceDataType)return;const S=this.getSource(C.sourceId);if(S&&S.vectorLayerIds)for(const k in this._layers){const P=this._layers[k];P.source===S.id&&this._validateLayer(P)}})}loadURL(d,f={}){this.fire(new m.Event("dataloading",{dataType:"style"}));const x="boolean"==typeof f.validate?f.validate:!m.isMapboxURL(d);d=this.map._requestManager.normalizeStyleURL(d,f.accessToken);const C=this.map._requestManager.transformRequest(d,m.ResourceType.Style);this._request=m.getJSON(C,(S,k)=>{this._request=null,S?this.fire(new m.ErrorEvent(S)):k&&this._load(k,x)})}loadJSON(d,f={}){this.fire(new m.Event("dataloading",{dataType:"style"})),this._request=m.exported.frame(()=>{this._request=null,this._load(d,!1!==f.validate)})}loadEmpty(){this.fire(new m.Event("dataloading",{dataType:"style"})),this._load(Kh,!1)}_updateLayerCount(d,f){const x=f?1:-1;d.is3D()&&(this._num3DLayers+=x),"circle"===d.type&&(this._numCircleLayers+=x),"symbol"===d.type&&(this._numSymbolLayers+=x)}_load(d,f){if(f&&Nd(this,m.validateStyle(d)))return;this._loaded=!0,this.stylesheet=m.clone$1(d),this._updateMapProjection();for(const C in d.sources)this.addSource(C,d.sources[C],{validate:!1});this._changed=!1,d.sprite?this._loadSprite(d.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(d.glyphs);const x=Ri(this.stylesheet.layers);this._order=x.map(C=>C.id),this._layers={},this._serializedLayers={};for(let C of x)C=m.createStyleLayer(C),C.setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new xo(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new m.Event("data",{dataType:"style"})),this.fire(new m.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(d){d?this.stylesheet.projection=d:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(d){this._spriteRequest=function(f,x,C){let S,k,P;const L=m.exported.devicePixelRatio>1?"@2x":"";let H=m.getJSON(x.transformRequest(x.normalizeSpriteURL(f,L,".json"),m.ResourceType.SpriteJSON),(oe,ue)=>{H=null,P||(P=oe,S=ue,Q())}),$=m.getImage(x.transformRequest(x.normalizeSpriteURL(f,L,".png"),m.ResourceType.SpriteImage),(oe,ue)=>{$=null,P||(P=oe,k=ue,Q())});function Q(){if(P)C(P);else if(S&&k){const oe=m.exported.getImageData(k),ue={};for(const ae in S){const{width:de,height:he,x:ie,y:ye,sdf:ge,pixelRatio:Ce,stretchX:Pe,stretchY:ke,content:Le}=S[ae],$e=new m.RGBAImage({width:de,height:he});m.RGBAImage.copy(oe,$e,{x:ie,y:ye},{x:0,y:0},{width:de,height:he}),ue[ae]={data:$e,pixelRatio:Ce,sdf:ge,stretchX:Pe,stretchY:ke,content:Le}}C(null,ue)}}return{cancel(){H&&(H.cancel(),H=null),$&&($.cancel(),$=null)}}}(d,this.map._requestManager,(f,x)=>{if(this._spriteRequest=null,f)this.fire(new m.ErrorEvent(f));else if(x)for(const C in x)this.imageManager.addImage(C,x[C]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new m.Event("data",{dataType:"style"}))})}_validateLayer(d){const f=this.getSource(d.source);if(!f)return;const x=d.sourceLayer;x&&("geojson"===f.type||f.vectorLayerIds&&-1===f.vectorLayerIds.indexOf(x))&&this.fire(new m.ErrorEvent(new Error(`Source layer "${x}" does not exist on source "${f.id}" as specified by style layer "${d.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const d in this._sourceCaches)if(!this._sourceCaches[d].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(d){const f=[];for(const x of d){const C=this._layers[x];"custom"!==C.type&&f.push(C.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const d in this._sourceCaches)if(this._sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(d){return!!this.terrain&&("function"==typeof d.isLayerDraped?d.isLayerDraped():ul[d.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(d){if(!this._loaded)return;const f=this._changed;if(this._changed){const C=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(C.length||S.length)&&this._updateWorkerLayers(C,S);for(const k in this._updatedSources){const P=this._updatedSources[k];"reload"===P?this._reloadSource(k):"clear"===P&&this._clearSource(k)}this._updateTilesForChangedImages();for(const k in this._updatedPaintProps)this._layers[k].updateTransitions(d);this.light.updateTransitions(d),this.fog&&this.fog.updateTransitions(d),this._resetUpdates()}const x={};for(const C in this._sourceCaches){const S=this._sourceCaches[C];x[C]=S.used,S.used=!1}for(const C of this._order){const S=this._layers[C];if(S.recalculate(d,this._availableImages),!S.isHidden(d.zoom)){const P=this._getLayerSourceCache(S);P&&(P.used=!0)}const k=this.map.painter;if(k){const P=S.getProgramIds();if(!P)continue;const L=S.getProgramConfiguration(d.zoom);for(const H of P)k.useProgram(H,L)}}for(const C in x){const S=this._sourceCaches[C];x[C]!==S.used&&S.getSource().fire(new m.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:S.getSource().id}))}this.light.recalculate(d),this.terrain&&this.terrain.recalculate(d),this.fog&&this.fog.recalculate(d),this.z=d.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new m.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const d=Object.keys(this._changedImages);if(d.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],d);this._changedImages={}}}_updateWorkerLayers(d,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(d),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(d){if(this._checkLoaded(),Nd(this,m.validateStyle(d)))return!1;(d=m.clone$1(d)).layers=Ri(d.layers);const f=function(C,S){if(!C)return[{command:On.setStyle,args:[S]}];let k=[];try{if(!re(C.version,S.version))return[{command:On.setStyle,args:[S]}];re(C.center,S.center)||k.push({command:On.setCenter,args:[S.center]}),re(C.zoom,S.zoom)||k.push({command:On.setZoom,args:[S.zoom]}),re(C.bearing,S.bearing)||k.push({command:On.setBearing,args:[S.bearing]}),re(C.pitch,S.pitch)||k.push({command:On.setPitch,args:[S.pitch]}),re(C.sprite,S.sprite)||k.push({command:On.setSprite,args:[S.sprite]}),re(C.glyphs,S.glyphs)||k.push({command:On.setGlyphs,args:[S.glyphs]}),re(C.transition,S.transition)||k.push({command:On.setTransition,args:[S.transition]}),re(C.light,S.light)||k.push({command:On.setLight,args:[S.light]}),re(C.fog,S.fog)||k.push({command:On.setFog,args:[S.fog]}),re(C.projection,S.projection)||k.push({command:On.setProjection,args:[S.projection]});const P={},L=[];!function(Q,oe,ue,ae){let de;for(de in oe=oe||{},Q=Q||{})Q.hasOwnProperty(de)&&(oe.hasOwnProperty(de)||oo(de,ue,ae));for(de in oe)oe.hasOwnProperty(de)&&(Q.hasOwnProperty(de)?re(Q[de],oe[de])||("geojson"===Q[de].type&&"geojson"===oe[de].type&&Ba(Q,oe,de)?ue.push({command:On.setGeoJSONSourceData,args:[de,oe[de].data]}):ll(de,oe,ue,ae)):Vi(de,oe,ue))}(C.sources,S.sources,L,P);const H=[];C.layers&&C.layers.forEach(Q=>{Q.source&&P[Q.source]?k.push({command:On.removeLayer,args:[Q.id]}):H.push(Q)});let $=C.terrain;$&&P[$.source]&&(k.push({command:On.setTerrain,args:[void 0]}),$=void 0),k=k.concat(L),re($,S.terrain)||k.push({command:On.setTerrain,args:[S.terrain]}),function(Q,oe,ue){oe=oe||[];const ae=(Q=Q||[]).map(cl),de=oe.map(cl),he=Q.reduce(Go,{}),ie=oe.reduce(Go,{}),ye=ae.slice(),ge=Object.create(null);let Ce,Pe,ke,Le,$e,nt,ot;for(Ce=0,Pe=0;Ce<ae.length;Ce++)ke=ae[Ce],ie.hasOwnProperty(ke)?Pe++:(ue.push({command:On.removeLayer,args:[ke]}),ye.splice(ye.indexOf(ke,Pe),1));for(Ce=0,Pe=0;Ce<de.length;Ce++)ke=de[de.length-1-Ce],ye[ye.length-1-Ce]!==ke&&(he.hasOwnProperty(ke)?(ue.push({command:On.removeLayer,args:[ke]}),ye.splice(ye.lastIndexOf(ke,ye.length-Pe),1)):Pe++,nt=ye[ye.length-Ce],ue.push({command:On.addLayer,args:[ie[ke],nt]}),ye.splice(ye.length-Ce,0,ke),ge[ke]=!0);for(Ce=0;Ce<de.length;Ce++)if(ke=de[Ce],Le=he[ke],$e=ie[ke],!ge[ke]&&!re(Le,$e))if(re(Le.source,$e.source)&&re(Le["source-layer"],$e["source-layer"])&&re(Le.type,$e.type)){for(ot in gt(Le.layout,$e.layout,ue,ke,null,On.setLayoutProperty),gt(Le.paint,$e.paint,ue,ke,null,On.setPaintProperty),re(Le.filter,$e.filter)||ue.push({command:On.setFilter,args:[ke,$e.filter]}),re(Le.minzoom,$e.minzoom)&&re(Le.maxzoom,$e.maxzoom)||ue.push({command:On.setLayerZoomRange,args:[ke,$e.minzoom,$e.maxzoom]}),Le)Le.hasOwnProperty(ot)&&"layout"!==ot&&"paint"!==ot&&"filter"!==ot&&"metadata"!==ot&&"minzoom"!==ot&&"maxzoom"!==ot&&(0===ot.indexOf("paint.")?gt(Le[ot],$e[ot],ue,ke,ot.slice(6),On.setPaintProperty):re(Le[ot],$e[ot])||ue.push({command:On.setLayerProperty,args:[ke,ot,$e[ot]]}));for(ot in $e)$e.hasOwnProperty(ot)&&!Le.hasOwnProperty(ot)&&"layout"!==ot&&"paint"!==ot&&"filter"!==ot&&"metadata"!==ot&&"minzoom"!==ot&&"maxzoom"!==ot&&(0===ot.indexOf("paint.")?gt(Le[ot],$e[ot],ue,ke,ot.slice(6),On.setPaintProperty):re(Le[ot],$e[ot])||ue.push({command:On.setLayerProperty,args:[ke,ot,$e[ot]]}))}else ue.push({command:On.removeLayer,args:[ke]}),nt=ye[ye.lastIndexOf(ke)+1],ue.push({command:On.addLayer,args:[$e,nt]})}(H,S.layers,k)}catch(P){console.warn("Unable to compute style diff:",P),k=[{command:On.setStyle,args:[S]}]}return k}(this.serialize(),d).filter(C=>!(C.command in Vl));if(0===f.length)return!1;const x=f.filter(C=>!(C.command in wc));if(x.length>0)throw new Error(`Unimplemented: ${x.map(C=>C.command).join(", ")}.`);return f.forEach(C=>{"setTransition"!==C.command&&"setProjection"!==C.command&&this[C.command].apply(this,C.args)}),this.stylesheet=d,this._updateMapProjection(),!0}addImage(d,f){return this.getImage(d)?this.fire(new m.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(d,f),this._afterImageUpdated(d),this)}updateImage(d,f){this.imageManager.updateImage(d,f)}getImage(d){return this.imageManager.getImage(d)}removeImage(d){return this.getImage(d)?(this.imageManager.removeImage(d),this._afterImageUpdated(d),this):this.fire(new m.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(d){this._availableImages=this.imageManager.listImages(),this._changedImages[d]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new m.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(d,f,x={}){if(this._checkLoaded(),void 0!==this.getSource(d))throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(m.validateSource,`sources.${d}`,f,null,x))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const C=We(d,f,this.dispatcher,this);C.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(d),source:C.serialize(),sourceId:d}));const S=k=>{const P=(k?"symbol:":"other:")+d,L=this._sourceCaches[P]=new m.SourceCache(P,C,k);(k?this._symbolSourceCaches:this._otherSourceCaches)[d]=L,L.style=this,L.onAdd(this.map)};S(!1),"vector"!==f.type&&"geojson"!==f.type||S(!0),C.onAdd&&C.onAdd(this.map),this._changed=!0}removeSource(d){this._checkLoaded();const f=this.getSource(d);if(!f)throw new Error("There is no source with this ID");for(const C in this._layers)if(this._layers[C].source===d)return this.fire(new m.ErrorEvent(new Error(`Source "${d}" cannot be removed while layer "${C}" is using it.`)));if(this.terrain&&this.terrain.get().source===d)return this.fire(new m.ErrorEvent(new Error(`Source "${d}" cannot be removed while terrain is using it.`)));const x=this._getSourceCaches(d);for(const C of x)delete this._sourceCaches[C.id],delete this._updatedSources[C.id],C.fire(new m.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:C.getSource().id})),C.setEventedParent(null),C.clearTiles();return delete this._otherSourceCaches[d],delete this._symbolSourceCaches[d],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(d,f){this._checkLoaded(),this.getSource(d).setData(f),this._changed=!0}getSource(d){const f=this._getSourceCache(d);return f&&f.getSource()}_getSources(){const d=[];for(const f in this._otherSourceCaches){const x=this._getSourceCache(f);x&&d.push(x.getSource())}return d}addLayer(d,f,x={}){this._checkLoaded();const C=d.id;if(this.getLayer(C))return void this.fire(new m.ErrorEvent(new Error(`Layer with id "${C}" already exists on this map`)));let S;if("custom"===d.type){if(Nd(this,m.validateCustomStyleLayer(d)))return;S=m.createStyleLayer(d)}else{if("object"==typeof d.source&&(this.addSource(C,d.source),d=m.clone$1(d),d=m.extend(d,{source:C})),this._validate(m.validateLayer,`layers.${C}`,d,{arrayIndex:-1},x))return;S=m.createStyleLayer(d),this._validateLayer(S),S.setEventedParent(this,{layer:{id:C}}),this._serializedLayers[S.id]=S.serialize(),this._updateLayerCount(S,!0)}const k=f?this._order.indexOf(f):this._order.length;if(f&&-1===k)return void this.fire(new m.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(k,0,C),this._layerOrderChanged=!0,this._layers[C]=S;const P=this._getLayerSourceCache(S);if(this._removedLayers[C]&&S.source&&P&&"custom"!==S.type){const L=this._removedLayers[C];delete this._removedLayers[C],L.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",P.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(d,f){if(this._checkLoaded(),this._changed=!0,!this._layers[d])return void this.fire(new m.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be moved.`)));if(d===f)return;const x=this._order.indexOf(d);this._order.splice(x,1);const C=f?this._order.indexOf(f):this._order.length;f&&-1===C?this.fire(new m.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(C,0,d),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(d){this._checkLoaded();const f=this._layers[d];if(!f)return void this.fire(new m.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const x=this._order.indexOf(d);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[d]=f,delete this._layers[d],delete this._serializedLayers[d],delete this._updatedLayers[d],delete this._updatedPaintProps[d],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(d){return this._layers[d]}hasLayer(d){return d in this._layers}hasLayerType(d){for(const f in this._layers)if(this._layers[f].type===d)return!0;return!1}setLayerZoomRange(d,f,x){this._checkLoaded();const C=this.getLayer(d);C?C.minzoom===f&&C.maxzoom===x||(null!=f&&(C.minzoom=f),null!=x&&(C.maxzoom=x),this._updateLayer(C)):this.fire(new m.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(d,f,x={}){this._checkLoaded();const C=this.getLayer(d);if(C){if(!re(C.filter,f))return null==f?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(m.validateFilter,`layers.${C.id}.filter`,f,{layerType:C.type},x)||(C.filter=m.clone$1(f),this._updateLayer(C)))}else this.fire(new m.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be filtered.`)))}getFilter(d){const f=this.getLayer(d);return f&&m.clone$1(f.filter)}setLayoutProperty(d,f,x,C={}){this._checkLoaded();const S=this.getLayer(d);S?re(S.getLayoutProperty(f),x)||(S.setLayoutProperty(f,x,C),this._updateLayer(S)):this.fire(new m.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(d,f){const x=this.getLayer(d);if(x)return x.getLayoutProperty(f);this.fire(new m.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style.`)))}setPaintProperty(d,f,x,C={}){this._checkLoaded();const S=this.getLayer(d);S?re(S.getPaintProperty(f),x)||(S.setPaintProperty(f,x,C)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[d]=!0):this.fire(new m.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(d,f){const x=this.getLayer(d);return x&&x.getPaintProperty(f)}setFeatureState(d,f){this._checkLoaded();const x=d.source,C=d.sourceLayer,S=this.getSource(x);if(!S)return void this.fire(new m.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const k=S.type;if("geojson"===k&&C)return void this.fire(new m.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===k&&!C)return void this.fire(new m.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===d.id&&this.fire(new m.ErrorEvent(new Error("The feature id parameter must be provided.")));const P=this._getSourceCaches(x);for(const L of P)L.setFeatureState(C,d.id,f)}removeFeatureState(d,f){this._checkLoaded();const x=d.source,C=this.getSource(x);if(!C)return void this.fire(new m.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const S=C.type,k="vector"===S?d.sourceLayer:void 0;if("vector"===S&&!k)return void this.fire(new m.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&"string"!=typeof d.id&&"number"!=typeof d.id)return void this.fire(new m.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const P=this._getSourceCaches(x);for(const L of P)L.removeFeatureState(k,d.id,f)}getFeatureState(d){this._checkLoaded();const f=d.source,x=d.sourceLayer,C=this.getSource(f);if(C){if("vector"!==C.type||x)return void 0===d.id&&this.fire(new m.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(x,d.id);this.fire(new m.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new m.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return m.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const d={};for(const f in this._sourceCaches){const x=this._sourceCaches[f].getSource();d[x.id]||(d[x.id]=x.serialize())}return m.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:d,layers:this._serializeLayers(this._order)},f=>void 0!==f)}_updateLayer(d){this._updatedLayers[d.id]=!0;const f=this._getLayerSourceCache(d);d.source&&!this._updatedSources[d.source]&&f&&"raster"!==f.getSource().type&&(this._updatedSources[d.source]="reload",f.pause()),this._changed=!0,d.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(d){const f=k=>"fill-extrusion"===this._layers[k].type,x={},C=[];for(let k=this._order.length-1;k>=0;k--){const P=this._order[k];if(f(P)){x[P]=k;for(const L of d){const H=L[P];if(H)for(const $ of H)C.push($)}}}C.sort((k,P)=>P.intersectionZ-k.intersectionZ);const S=[];for(let k=this._order.length-1;k>=0;k--){const P=this._order[k];if(f(P))for(let L=C.length-1;L>=0;L--){const H=C[L].feature;if(x[H.layer.id]<k)break;S.push(H),C.pop()}else for(const L of d){const H=L[P];if(H)for(const $ of H)S.push($.feature)}}return S}queryRenderedFeatures(d,f,x){f&&f.filter&&this._validate(m.validateFilter,"queryRenderedFeatures.filter",f.filter,null,f);const C={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new m.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const L of f.layers){const H=this._layers[L];if(!H)return this.fire(new m.ErrorEvent(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];C[H.source]=!0}}const S=[];f.availableImages=this._availableImages;const k=f&&f.layers?f.layers.some(L=>{const H=this.getLayer(L);return H&&H.is3D()}):this.has3DLayers(),P=gi.createFromScreenPoints(d,x);for(const L in this._sourceCaches){const H=this._sourceCaches[L].getSource().id;f.layers&&!C[H]||S.push(tt(this._sourceCaches[L],this._layers,this._serializedLayers,P,f,x,k,!!this.map._showQueryGeometry))}return this.placement&&S.push(function(L,H,$,Q,oe,ue,ae){const de={},he=ue.queryRenderedSymbols(Q),ie=[];for(const ye of Object.keys(he).map(Number))ie.push(ae[ye]);ie.sort(Xt);for(const ye of ie){const ge=ye.featureIndex.lookupSymbolFeatures(he[ye.bucketInstanceId],H,ye.bucketIndex,ye.sourceLayerIndex,oe.filter,oe.layers,oe.availableImages,L);for(const Ce in ge){const Pe=de[Ce]=de[Ce]||[],ke=ge[Ce];ke.sort((Le,$e)=>{const nt=ye.featureSortOrder;if(nt){const ot=nt.indexOf(Le.featureIndex);return nt.indexOf($e.featureIndex)-ot}return $e.featureIndex-Le.featureIndex});for(const Le of ke)Pe.push(Le)}}for(const ye in de)de[ye].forEach(ge=>{const Ce=ge.feature,Pe=$(L[ye]).getFeatureState(Ce.layer["source-layer"],Ce.id);Ce.source=Ce.layer.source,Ce.layer["source-layer"]&&(Ce.sourceLayer=Ce.layer["source-layer"]),Ce.state=Pe});return de}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),P.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(d,f){f&&f.filter&&this._validate(m.validateFilter,"querySourceFeatures.filter",f.filter,null,f);const x=this._getSourceCaches(d);let C=[];for(const S of x)C=C.concat(wt(S,f));return C}addSourceType(d,f,x){return ls.getSourceType(d)?x(new Error(`A source type called "${d}" already exists.`)):(ls.setSourceType(d,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:d,url:f.workerSourceURL},x):x(null,null))}getLight(){return this.light.getLight()}setLight(d,f={}){this._checkLoaded();const x=this.light.getLight();let C=!1;for(const k in d)if(!re(d[k],x[k])){C=!0;break}if(!C)return;const S=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(d,f),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(d,f=1){if(this._checkLoaded(),!d)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===f){if("object"==typeof d.source){const x="terrain-dem-src";this.addSource(x,d.source),d=m.clone$1(d),d=m.extend(d,{source:x})}if(this._validate(m.validateTerrain,"terrain",d))return}if(!this.terrain||this.terrain&&f!==this.terrain.drapeRenderMode)this._createTerrain(d,f);else{const x=this.terrain,C=x.get();for(const S of Object.keys(m.spec.terrain))!d.hasOwnProperty(S)&&m.spec.terrain[S].default&&(d[S]=m.spec.terrain[S].default);for(const S in d)if(!re(d[S],C[S])){x.set(d),this.stylesheet.terrain=d;const k=this._setTransitionParameters({duration:0});x.updateTransitions(k);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(d){const f=this.fog=new Pl(d,this.map.transform);this.stylesheet.fog=d;const x=this._setTransitionParameters({duration:0});f.updateTransitions(x)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const d of this.map._markers)d._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(d){if(this._checkLoaded(),!d)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,x=f.get();0===Object.keys(d).length&&f.set(d);for(const C in d)if(!re(d[C],x[C])){f.set(d),this.stylesheet.fog=d;const S=this._setTransitionParameters({duration:0});f.updateTransitions(S);break}}else this._createFog(d);this._markersNeedUpdate=!0}_setTransitionParameters(d){return{now:m.exported.now(),transition:m.extend(d,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const d=this._order.filter(x=>this.isLayerDraped(this._layers[x])),f=this._order.filter(x=>!this.isLayerDraped(this._layers[x]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...d),this._drapedFirstOrder.push(...f)}_createTerrain(d,f){const x=this.terrain=new lr(d,f);this.stylesheet.terrain=d,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const C=this._setTransitionParameters({duration:0});x.updateTransitions(C)}_force3DLayerUpdate(){for(const d in this._layers){const f=this._layers[d];"fill-extrusion"===f.type&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const d in this._layers){const f=this._layers[d];"symbol"===f.type&&this._updateLayer(f)}}_validate(d,f,x,C,S={}){return(!S||!1!==S.validate)&&Nd(this,d.call(m.validateStyle,m.extend({key:f,style:this.serialize(),value:x,styleSpec:m.spec},C)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),m.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this._sourceCaches)this._sourceCaches[d].clearTiles(),this._sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(d){const f=this._getSourceCaches(d);for(const x of f)x.clearTiles()}_reloadSource(d){const f=this._getSourceCaches(d);for(const x of f)x.resume(),x.reload()}_reloadSources(){for(const d of this._getSources())d.reload&&d.reload()}_updateSources(d){for(const f in this._sourceCaches)this._sourceCaches[f].update(d)}_generateCollisionBoxes(){for(const d in this._sourceCaches){const f=this._sourceCaches[d];f.resume(),f.reload()}}_updatePlacement(d,f,x,C,S=!1){let k=!1,P=!1;const L={};for(const H of this._order){const $=this._layers[H];if("symbol"!==$.type)continue;if(!L[$.source]){const oe=this._getLayerSourceCache($);if(!oe)continue;L[$.source]=oe.getRenderableIds(!0).map(ue=>oe.getTileByID(ue)).sort((ue,ae)=>ae.tileID.overscaledZ-ue.tileID.overscaledZ||(ue.tileID.isLessThan(ae.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer($,L[$.source],d.center.lng,d.projection);k=k||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),S=S||this._layerOrderChanged||0===x,this._layerOrderChanged&&this.fire(new m.Event("neworder")),(S||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(m.exported.now(),d.zoom))&&(this.pauseablePlacement=new Zh(d,this._order,S,f,x,C,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(m.exported.now()),P=!0),k&&this.pauseablePlacement.placement.setStale()),P||k)for(const H of this._order){const $=this._layers[H];"symbol"===$.type&&this.placement.updateLayerOpacities($,L[$.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(m.exported.now())}_releaseSymbolFadeTiles(){for(const d in this._sourceCaches)this._sourceCaches[d].releaseSymbolFadeTiles()}getImages(d,f,x){this.imageManager.getImages(f.icons,x),this._updateTilesForChangedImages();const C=S=>{S&&S.setDependencies(f.tileID.key,f.type,f.icons)};C(this._otherSourceCaches[f.source]),C(this._symbolSourceCaches[f.source])}getGlyphs(d,f,x){this.glyphManager.getGlyphs(f.stacks,x)}getResource(d,f,x){return m.makeRequest(f,x)}_getSourceCache(d){return this._otherSourceCaches[d]}_getLayerSourceCache(d){return"symbol"===d.type?this._symbolSourceCaches[d.source]:this._otherSourceCaches[d.source]}_getSourceCaches(d){const f=[];return this._otherSourceCaches[d]&&f.push(this._otherSourceCaches[d]),this._symbolSourceCaches[d]&&f.push(this._symbolSourceCaches[d]),f}_isSourceCacheLoaded(d){const f=this._getSourceCaches(d);return 0===f.length?(this.fire(new m.ErrorEvent(new Error(`There is no source with ID '${d}'`))),!1):f.every(x=>x.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ls.getSourceType=function(y){return qe[y]},ls.setSourceType=function(y,d){qe[y]=d},ls.registerForPluginStateChange=m.registerForPluginStateChange;var Cc="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Df="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Cg="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Wn="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Xh="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Mf={},xs={};const Tc=[];ku(Cc,Tc),ku(Cg,Tc),ku(Wn,Tc),ku(Xh,Tc),Mf=Ai("",Cg),xs=Ai(Xh,Wn);const wy=Ai("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),bo=Cc,If="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Tg={background:Ai("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Ai("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Ai("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Ai("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ai("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Ai("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ai("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ai("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ai("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Ai("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Ai("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Ai("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Ai("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Ai("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Ai("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Ai("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ai("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Ai("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Ai("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Ai("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Ai("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Ai("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Ai("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Ai("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Ai("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Ai("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Df),skyboxGradient:Ai("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Df),skyboxCapture:Ai("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ai("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Ai("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ku(y,d){const f=y.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let x of f)if(x=x.trim(),"#"===x[0]&&x.includes("if")&&!x.includes("endif")){x=x.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const C=x.split(" ");for(const S of C)d.includes(S)||d.push(S)}}function Ai(y,d){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=d.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),C={},S=[...Tc];return ku(y,S),ku(d,S),{fragmentSource:y=y.replace(f,(k,P,L,H,$)=>(C[$]=!0,"define"===P?`\n#ifndef HAS_UNIFORM_u_${$}\nvarying ${L} ${H} ${$};\n#else\nuniform ${L} ${H} u_${$};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${$}\n    ${L} ${H} ${$} = u_${$};\n#endif\n`)),vertexSource:d=d.replace(f,(k,P,L,H,$)=>{const Q="float"===H?"vec2":"vec4",oe=$.match(/color/)?"color":Q;return C[$]?"define"===P?`\n#ifndef HAS_UNIFORM_u_${$}\nuniform lowp float u_${$}_t;\nattribute ${L} ${Q} a_${$};\nvarying ${L} ${H} ${$};\n#else\nuniform ${L} ${H} u_${$};\n#endif\n`:"vec4"===oe?`\n#ifndef HAS_UNIFORM_u_${$}\n    ${$} = a_${$};\n#else\n    ${L} ${H} ${$} = u_${$};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${$}\n    ${$} = unpack_mix_${oe}(a_${$}, u_${$}_t);\n#else\n    ${L} ${H} ${$} = u_${$};\n#endif\n`:"define"===P?`\n#ifndef HAS_UNIFORM_u_${$}\nuniform lowp float u_${$}_t;\nattribute ${L} ${Q} a_${$};\n#else\nuniform ${L} ${H} u_${$};\n#endif\n`:"vec4"===oe?`\n#ifndef HAS_UNIFORM_u_${$}\n    ${L} ${H} ${$} = a_${$};\n#else\n    ${L} ${H} ${$} = u_${$};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${$}\n    ${L} ${H} ${$} = unpack_mix_${oe}(a_${$}, u_${$}_t);\n#else\n    ${L} ${H} ${$} = u_${$};\n#endif\n`}),staticAttributes:x,usedDefines:S}}class Ec{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(d,f,x,C,S,k,P){this.context=d;let L=this.boundPaintVertexBuffers.length!==C.length;for(let $=0;!L&&$<C.length;$++)this.boundPaintVertexBuffers[$]!==C[$]&&(L=!0);let H=this.boundDynamicVertexBuffers.length!==P.length;for(let $=0;!H&&$<P.length;$++)this.boundDynamicVertexBuffers[$]!==P[$]&&(H=!0);if(!d.extVertexArrayObject||!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==x||L||H||this.boundIndexBuffer!==S||this.boundVertexOffset!==k)this.freshBind(f,x,C,S,k,P);else{d.bindVertexArrayOES.set(this.vao);for(const $ of P)$&&$.bind();S&&S.dynamicDraw&&S.bind()}}freshBind(d,f,x,C,S,k){let P;const L=d.numAttributes,H=this.context,$=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=d,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=C,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=k;else{P=H.currentNumAttributes||0;for(let Q=L;Q<P;Q++)$.disableVertexAttribArray(Q)}f.enableAttributes($,d),f.bind(),f.setVertexAttribPointers($,d,S);for(const Q of x)Q.enableAttributes($,d),Q.bind(),Q.setVertexAttribPointers($,d,S);for(const Q of k)Q&&(Q.enableAttributes($,d),Q.bind(),Q.setVertexAttribPointers($,d,S));C&&C.bind(),H.currentNumAttributes=L}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Au(y,d){const f=Math.pow(2,d.canonical.z),x=d.canonical.y;return[new m.MercatorCoordinate(0,x/f).toLngLat().lat,new m.MercatorCoordinate(0,(x+1)/f).toLngLat().lat]}function Bd(y,d,f,x,C,S,k){const P=y.context,L=P.gl,H=f.fbo;if(!H)return;y.prepareDrawTile();const $=y.useProgram("hillshade");P.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,H.colorAttachment.get());const Q=((de,he,ie,ye)=>{const ge=ie.paint.get("hillshade-shadow-color"),Ce=ie.paint.get("hillshade-highlight-color"),Pe=ie.paint.get("hillshade-accent-color");let ke=ie.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ie.paint.get("hillshade-illumination-anchor")&&(ke-=de.transform.angle);const Le=!de.options.moving;return{u_matrix:ye||de.transform.calculateProjMatrix(he.tileID.toUnwrapped(),Le),u_image:0,u_latrange:Au(0,he.tileID),u_light:[ie.paint.get("hillshade-exaggeration"),ke],u_shadow:ge,u_highlight:Ce,u_accent:Pe}})(y,f,x,y.terrain?d.projMatrix:null);y.prepareDrawProgram(P,$,d.toUnwrapped());const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:ue,tileBoundsSegments:ae}=y.getTileBoundsBuffers(f);$.draw(P,L.TRIANGLES,C,S,k,m.CullFaceMode.disabled,Q,x.id,oe,ue,ae)}function Vd(y,d,f){if(!d.needsDEMTextureUpload)return;const x=y.context,C=x.gl;x.pixelStoreUnpackPremultiplyAlpha.set(!1),d.demTexture=d.demTexture||y.getTileTexture(f.stride);const S=f.getPixels();d.demTexture?d.demTexture.update(S,{premultiply:!1}):d.demTexture=new m.Texture(x,S,C.RGBA,{premultiply:!1}),d.needsDEMTextureUpload=!1}function Yh(y,d,f,x,C,S){const k=y.context,P=k.gl;if(!d.dem)return;const L=d.dem;if(k.activeTexture.set(P.TEXTURE1),Vd(y,d,L),!d.demTexture)return;d.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE);const H=L.dim;k.activeTexture.set(P.TEXTURE0);let $=d.fbo;if(!$){const ae=new m.Texture(k,{width:H,height:H,data:null},P.RGBA);ae.bind(P.LINEAR,P.CLAMP_TO_EDGE),$=d.fbo=k.createFramebuffer(H,H,!0),$.colorAttachment.set(ae.texture)}k.bindFramebuffer.set($.framebuffer),k.viewport.set([0,0,H,H]);const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:oe,tileBoundsSegments:ue}=y.getMercatorTileBoundsBuffers();y.useProgram("hillshadePrepare").draw(k,P.TRIANGLES,x,C,S,m.CullFaceMode.disabled,((ae,de)=>{const he=de.stride,ie=m.create();return m.ortho(ie,0,m.EXTENT,-m.EXTENT,0,0,1),m.translate(ie,ie,[0,-m.EXTENT,0]),{u_matrix:ie,u_image:1,u_dimension:[he,he],u_zoom:ae.overscaledZ,u_unpack:de.unpackVector}})(d.tileID,L),f.id,Q,oe,ue),d.needsHillshadePrepare=!1}const Ud=y=>({u_matrix:new m.UniformMatrix4f(y),u_image0:new m.Uniform1i(y),u_skirt_height:new m.Uniform1f(y)}),Sc=(y,d)=>({u_matrix:y,u_image0:0,u_skirt_height:d}),dl=(y,d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae)=>({u_proj_matrix:Float32Array.from(y),u_globe_matrix:d,u_normalize_matrix:Float32Array.from(x),u_merc_matrix:f,u_zoom_transition:C,u_merc_center:S,u_image0:0,u_frustum_tl:k,u_frustum_tr:P,u_frustum_br:L,u_frustum_bl:H,u_globe_pos:$,u_globe_radius:Q,u_viewport:oe,u_grid_matrix:ae?Float32Array.from(ae):new Float32Array(9),u_skirt_height:ue});function kf(y,d){return null!=y&&null!=d&&!(!y.hasData()||!d.hasData())&&null!=y.demTexture&&null!=d.demTexture&&y.tileID.key!==d.tileID.key}const Rt=new class{constructor(){this.operations={}}newMorphing(y,d,f,x,C){if(y in this.operations){const S=this.operations[y];S.to.tileID.key!==f.tileID.key&&(S.queued=f)}else this.operations[y]={startTime:x,phase:0,duration:C,from:d,to:f,queued:null}}getMorphValuesForProxy(y){if(!(y in this.operations))return null;const d=this.operations[y];return{from:d.from,to:d.to,phase:d.phase}}update(y){for(const d in this.operations){const f=this.operations[d];for(f.phase=(y-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,y)){delete this.operations[d];break}}}_nextOp(y,d){return!!y.queued&&(y.from=y.to,y.to=y.queued,y.queued=null,y.phase=0,y.startTime=d,!0)}_validOp(y){return y.from.hasData()&&y.to.hasData()}},Ul={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function ti(y){return 6*Math.pow(1.5,22-y)}function Pu(y,d){const f=1<<y.z;return!d&&(0===y.x||y.x===f-1)||0===y.y||y.y===f-1}const Si=y=>({u_matrix:y});function hl(y,d,f,x,C){if(C>0){const S=m.exported.now(),k=(S-y.timeAdded)/C,P=d?(S-d.timeAdded)/C:-1,L=f.getSource(),H=x.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),$=!d||Math.abs(d.tileID.overscaledZ-H)>Math.abs(y.tileID.overscaledZ-H),Q=$&&y.refreshedUponExpiration?1:m.clamp($?k:1-P,0,1);return y.refreshedUponExpiration&&k>=1&&(y.refreshedUponExpiration=!1),d?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}class Eg extends m.SourceCache{constructor(d){const f={type:"raster-dem",maxzoom:d.transform.maxZoom},x=new Os(Vn(),null),C=We("mock-dem",f,x,d.style);super("mock-dem",C,!1),C.setEventedParent(this),this._sourceLoaded=!0}_loadTile(d,f){d.state="loaded",f(null)}}class Sg extends m.SourceCache{constructor(d){const f=We("proxy",{type:"geojson",maxzoom:d.transform.maxZoom},new Os(Vn(),null),d.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=d,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(d,f,x){if(d.freezeTileCoverage)return;this.transform=d;const C=d.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,k)=>{if(S[k.key]="",!this._tiles[k.key]){const P=new m.Tile(k,this._source.tileSize*k.overscaleFactor(),d.tileZoom);P.state="loaded",this._tiles[k.key]=P}return S},{});for(const S in this._tiles)S in C||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(d){const f=this.proxyCachedFBO[d];if(void 0!==f){const x=Object.values(f);this.renderCachePool.push(...x),delete this.proxyCachedFBO[d]}}deallocRenderCache(){this.renderCache.forEach(d=>d.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Af extends m.OverscaledTileID{constructor(d,f,x){super(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y),this.proxyTileKey=f,this.projMatrix=x}}class ja extends m.Elevation{constructor(d,f){super(),this.painter=d,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[x,C,S]=function(L){const H=new m.StructArrayLayout2i4,$=new m.StructArrayLayout3ui6,Q=131;H.reserve(17161),$.reserve(33800);const oe=m.EXTENT/128,ue=m.EXTENT+oe/2,ae=ue+oe;for(let he=-oe;he<ae;he+=oe)for(let ie=-oe;ie<ae;ie+=oe){const ye=ie<0||ie>ue||he<0||he>ue?24575:0,ge=m.clamp(Math.round(ie),0,m.EXTENT),Ce=m.clamp(Math.round(he),0,m.EXTENT);H.emplaceBack(ge+ye,Ce)}const de=(he,ie)=>{const ye=ie*Q+he;$.emplaceBack(ye+1,ye,ye+Q),$.emplaceBack(ye+Q,ye+Q+1,ye+1)};for(let he=1;he<129;he++)for(let ie=1;ie<129;ie++)de(ie,he);return[0,129].forEach(he=>{for(let ie=0;ie<130;ie++)de(ie,he),de(he,ie)}),[H,$,32768]}(),k=d.context;this.gridBuffer=k.createVertexBuffer(x,m.posAttributes.members),this.gridIndexBuffer=k.createIndexBuffer(C),this.gridSegments=m.SegmentVector.simpleSegment(0,0,x.length,C.length),this.gridNoSkirtSegments=m.SegmentVector.simpleSegment(0,0,x.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Sg(f.map),this.orthoMatrix=m.create(),m.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,m.EXTENT,0,m.EXTENT,0,1);const P=k.gl;this._overlapStencilMode=new m.StencilMode({func:P.GEQUAL,mask:255},0,255,P.KEEP,P.KEEP,P.REPLACE),this._previousZoom=d.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Eg(f.map)}set style(d){d.on("data",this._onStyleDataEvent.bind(this)),d.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=d,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(d,f,x){if(d&&d.terrain){this._style!==d&&(this.style=d),this.enabled=!0;const C=d.terrain.properties;this.sourceCache=0===d.terrain.drapeRenderMode?this._mockSourceCache:d._getSourceCache(C.get("source")),this._exaggeration=C.get("exaggeration");const S=()=>{this.sourceCache.used&&m.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const k=this.getScaledDemTileSize();this.sourceCache.update(f,k,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,S(),this._initializing=!0),S(),f.updateElevation(!0,x),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(d){this._findCoveringTileCache[d]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const d=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==d.efficiency&&m.warnOnce(`Terrain render cache efficiency is not optimal (${d.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${d.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(d){d.coord&&"source"===d.dataType?this._clearRenderCacheForTile(d.sourceCacheId,d.coord):"style"===d.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const d in this._style._sourceCaches)this._style._sourceCaches[d].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(d=>d.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const d=2*this.proxySourceCache.getSource().tileSize;return[d,d]}set useVertexMorphing(d){this._useVertexMorphing=d}updateTileBinding(d){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,x=this.painter.transform;this._initializing&&(this._initializing=0===x._centerAltitude&&-1===this.getAtPointOrZero(m.MercatorCoordinate.fromLngLat(x.center),-1),this._emptyDEMTextureDirty=!this._initializing);const C=this.proxyCoords=f.getIds().map(L=>{const H=f.getTileByID(L).tileID;return H.projMatrix=x.calculateProjMatrix(H.toUnwrapped()),H});(function(L,H){const $=H.transform.pointCoordinate(H.transform.getCameraPoint()),Q=new m.pointGeometry($.x,$.y);L.sort((oe,ue)=>{if(ue.overscaledZ-oe.overscaledZ)return ue.overscaledZ-oe.overscaledZ;const ae=new m.pointGeometry(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),de=new m.pointGeometry(ue.canonical.x+(1<<ue.canonical.z)*ue.wrap,ue.canonical.y),he=Q.mult(1<<oe.canonical.z);return he.x-=.5,he.y-=.5,he.distSqr(ae)-he.distSqr(de)})})(C,this.painter),this._previousZoom=x.zoom;const S=this.proxyToSource||{};this.proxyToSource={},C.forEach(L=>{this.proxyToSource[L.key]={}}),this.terrainTileForTile={};const k=this._style._sourceCaches;for(const L in k){const H=k[L];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,d[L],S),H.usedForTerrain))continue;const $=d[L];H.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[f.id]=C.map(L=>new Af(L,L.key,this.orthoMatrix)),this._assignTerrainTiles(C),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1,this._updateTimestamp=m.exported.now();const P={};this._visibleDemTiles=[];for(const L of this.proxyCoords){const H=this.terrainTileForTile[L.key];if(!H)continue;const $=H.tileID.key;$ in P||(this._visibleDemTiles.push(H),P[$]=$)}}_assignTerrainTiles(d){this._initializing||d.forEach(f=>{if(this.terrainTileForTile[f.key])return;const x=this._findTileCoveringTileID(f,this.sourceCache);x&&(this.terrainTileForTile[f.key]=x)})}_prepareDEMTextures(){const d=this.painter.context,f=d.gl;for(const x in this.terrainTileForTile){const C=this.terrainTileForTile[x],S=C.dem;!S||C.demTexture&&!C.needsDEMTextureUpload||(d.activeTexture.set(f.TEXTURE1),Vd(this.painter,C,S))}}_prepareDemTileUniforms(d,f,x,C){if(!f||null==f.demTexture)return!1;const S=d.tileID.canonical,k=Math.pow(2,f.tileID.canonical.z-S.z),P=C||"";return x[`u_dem_tl${P}`]=[S.x*k%1,S.y*k%1],x[`u_dem_scale${P}`]=k,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const d=this.painter.context,f=d.gl;if(!this._emptyDepthBufferTexture){const x=new m.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new m.Texture(d,x,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let d=0;const f=this._visibleDemTiles.reduce((x,C)=>{if(!C.dem)return x;const S=C.dem.tree.minimums[0];return S>0&&d++,x+S},0);return d?f/d:0}_updateEmptyDEMTexture(){const d=this.painter.context,f=d.gl;d.activeTexture.set(f.TEXTURE2);const x=this._getLoadedAreaMinimum(),C=new m.RGBAImage({width:1,height:1},new Uint8Array(m.DEMData.pack(x,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(C,{premultiply:!1}):S=this._emptyDEMTexture=new m.Texture(d,C,f.RGBA,{premultiply:!1}),S}setupElevationDraw(d,f,x){const C=this.painter.context,S=C.gl,k=(P=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:m.DEMData.getUnpackVector(P),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var P;k.u_dem_size=this.sourceCache.getSource().tileSize,k.u_exaggeration=this.exaggeration();let L=null,H=null,$=1;if(x&&x.morphing&&this._useVertexMorphing){const Q=x.morphing.srcDemTile,oe=x.morphing.dstDemTile;$=x.morphing.phase,Q&&oe&&(this._prepareDemTileUniforms(d,Q,k,"_prev")&&(H=Q),this._prepareDemTileUniforms(d,oe,k)&&(L=oe))}if(H&&L?(C.activeTexture.set(S.TEXTURE2),L.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),C.activeTexture.set(S.TEXTURE4),H.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),k.u_dem_lerp=$):(L=this.terrainTileForTile[d.tileID.key],C.activeTexture.set(S.TEXTURE2),(this._prepareDemTileUniforms(d,L,k)?L.demTexture:this.emptyDEMTexture).bind(S.NEAREST,S.CLAMP_TO_EDGE)),C.activeTexture.set(S.TEXTURE3),x&&x.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),this._depthFBO&&(k.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),k.u_depth_size_inv=[1,1]),x&&x.useMeterToDem&&L){const Q=(1<<L.tileID.canonical.z)*m.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;k.u_meter_to_dem=Q}if(x&&x.labelPlaneMatrixInv&&(k.u_label_plane_matrix_inv=x.labelPlaneMatrixInv),f.setTerrainUniformValues(C,k),"globe"===this.painter.transform.projection.name){const Q=this.globeUniformValues(this.painter.transform,d.tileID.canonical,x&&x.useDenormalizedUpVectorScale);f.setGlobeUniformValues(C,Q)}}globeUniformValues(d,f,x){const C=d.projection;return{u_tile_tl_up:C.upVector(f,0,0),u_tile_tr_up:C.upVector(f,m.EXTENT,0),u_tile_br_up:C.upVector(f,m.EXTENT,m.EXTENT),u_tile_bl_up:C.upVector(f,0,m.EXTENT),u_tile_up_scale:x?m.globeMetersToEcef(1):C.upVectorScale(f,d.center.lat,d.worldSize).metersToTile}}renderToBackBuffer(d){const f=this.painter,x=this.painter.context;0!==d.length&&(x.bindFramebuffer.set(null),x.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(C,S,k,P,L){if("globe"===C.transform.projection.name)!function(H,$,Q,oe,ue){const ae=H.context,de=ae.gl;let he,ie;const ye=H.options.showTerrainWireframe?2:0,ge=H.transform,Ce=m.globeUseCustomAntiAliasing(H,ae,ge),Pe=(kt,it)=>{if(ie===kt)return;const je=[Ul[kt],"PROJECTION_GLOBE_VIEW"];Ce&&je.push("CUSTOM_ANTIALIASING"),it&&je.push(Ul[ye]),he=H.useProgram("globeRaster",null,je),ie=kt},ke=H.colorModeForRenderPass(),Le=new m.DepthMode(de.LEQUAL,m.DepthMode.ReadWrite,H.depthRangeFor3D);Rt.update(ue);const $e=m.calculateGlobeMercatorMatrix(ge),nt=[m.mercatorXfromLng(ge.center.lng),m.mercatorYfromLat(ge.center.lat)],ot=ye?[!1,!0]:[!1],zt=H.globeSharedBuffers,Ze=[ge.width*m.exported.devicePixelRatio,ge.height*m.exported.devicePixelRatio],Ct=Float32Array.from(ge.globeMatrix),ut={useDenormalizedUpVectorScale:!0};if(ot.forEach(kt=>{const it=H.transform,je=ti(it.zoom)*$.exaggeration();ie=-1;const lt=kt?de.LINES:de.TRIANGLES;for(const Mt of oe){const Pt=Q.getTile(Mt),hn=m.StencilMode.disabled,ni=$.prevTerrainTileForTile[Mt.key],cn=$.terrainTileForTile[Mt.key];kf(ni,cn)&&Rt.newMorphing(Mt.key,ni,cn,ue,250),ae.activeTexture.set(de.TEXTURE0),Pt.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);const Zt=Rt.getMorphValuesForProxy(Mt.key),bn=Zt?1:0;Zt&&m.extend$1(ut,{morphing:{srcDemTile:Zt.from,dstDemTile:Zt.to,phase:m.easeCubicInOut(Zt.phase)}});const yi=m.tileCornersToBounds(Mt.canonical),Tn=m.getLatitudinalLod(yi.getCenter().lat),$i=m.getGridMatrix(Mt.canonical,yi,Tn,it.worldSize/it._pixelsPerMercatorPixel),Gi=m.globeNormalizeECEF(m.globeTileBounds(Mt.canonical)),so=dl(it.projMatrix,Ct,$e,Gi,m.globeToMercatorTransition(it.zoom),nt,it.frustumCorners.TL,it.frustumCorners.TR,it.frustumCorners.BR,it.frustumCorners.BL,it.globeCenterInViewSpace,it.globeRadius,Ze,je,$i);if(Pe(bn,kt),$.setupElevationDraw(Pt,he,ut),H.prepareDrawProgram(ae,he,Mt.toUnwrapped()),zt){const[Xi,tr,us]=kt?zt.getWirefameBuffers(H.context,Tn):zt.getGridBuffers(Tn,0!==je);he.draw(ae,lt,Le,hn,ke,m.CullFaceMode.backCCW,so,"globe_raster",Xi,tr,us)}}}),zt){const kt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ce&&kt.push("CUSTOM_ANTIALIASING"),he=H.useProgram("globeRaster",null,kt);for(const it of oe){const{x:je,y:lt,z:Mt}=it.canonical,Pt=0===lt,hn=lt===(1<<Mt)-1,[ni,cn,Zt,bn]=zt.getPoleBuffers(Mt);if(bn&&(Pt||hn)){const yi=Q.getTile(it);ae.activeTexture.set(de.TEXTURE0),yi.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);let Tn=m.globePoleMatrixForTile(Mt,je,ge);const $i=m.globeNormalizeECEF(m.globeTileBounds(it.canonical)),Gi=(so,Xi)=>so.draw(ae,de.TRIANGLES,Le,m.StencilMode.disabled,ke,m.CullFaceMode.disabled,dl(ge.projMatrix,Tn,Tn,$i,0,nt,ge.frustumCorners.TL,ge.frustumCorners.TR,ge.frustumCorners.BR,ge.frustumCorners.BL,ge.globeCenterInViewSpace,ge.globeRadius,Ze,0),"globe_pole_raster",Xi,Zt,bn);$.setupElevationDraw(yi,he,ut),H.prepareDrawProgram(ae,he,it.toUnwrapped()),Pt&&Gi(he,ni),hn&&(Tn=m.scale(m.create(),Tn,[1,-1,1]),Gi(he,cn))}}}}(C,S,k,P,L);else{const H=C.context,$=H.gl;let Q,oe;const ue=C.options.showTerrainWireframe?2:0,ae=(ge,Ce)=>{if(oe===ge)return;const Pe=[Ul[ge]];Ce&&Pe.push(Ul[ue]),Q=C.useProgram("terrainRaster",null,Pe),oe=ge},de=C.colorModeForRenderPass(),he=new m.DepthMode($.LEQUAL,m.DepthMode.ReadWrite,C.depthRangeFor3D);Rt.update(L);const ie=C.transform,ye=ti(ie.zoom)*S.exaggeration();(ue?[!1,!0]:[!1]).forEach(ge=>{oe=-1;const Ce=ge?$.LINES:$.TRIANGLES,[Pe,ke]=ge?S.getWirefameBuffer():[S.gridIndexBuffer,S.gridSegments];for(const Le of P){const $e=k.getTile(Le),nt=m.StencilMode.disabled,ot=S.prevTerrainTileForTile[Le.key],zt=S.terrainTileForTile[Le.key];kf(ot,zt)&&Rt.newMorphing(Le.key,ot,zt,L,250),H.activeTexture.set($.TEXTURE0),$e.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST);const Ze=Rt.getMorphValuesForProxy(Le.key),Ct=Ze?1:0;let ut;Ze&&(ut={morphing:{srcDemTile:Ze.from,dstDemTile:Ze.to,phase:m.easeCubicInOut(Ze.phase)}});const kt=Sc(Le.projMatrix,Pu(Le.canonical,ie.renderWorldCopies)?ye/10:ye);ae(Ct,ge),S.setupElevationDraw($e,Q,ut),C.prepareDrawProgram(H,Q,Le.toUnwrapped()),Q.draw(H,Ce,he,nt,de,m.CullFaceMode.backCCW,kt,"terrain_raster",S.gridBuffer,Pe,ke)}})}}(f,this,this.proxySourceCache,d,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),d.splice(0,d.length))}renderBatch(d){if(0===this._drapedRenderBatches.length)return d+1;this.renderingToTexture=!0;const f=this.painter,x=this.painter.context,C=this.proxySourceCache,S=this.proxiedCoords[C.id],k=this._drapedRenderBatches.shift(),P=[],L=f.style.order;let H=0;for(const $ of S){const Q=C.getTileByID($.proxyTileKey),oe=C.proxyCachedFBO[$.key]?C.proxyCachedFBO[$.key][d]:void 0,ue=void 0!==oe?C.renderCache[oe]:this.pool[H++],ae=void 0!==oe;if(Q.texture=ue.tex,ae&&!ue.dirty){P.push(Q.tileID);continue}let de;x.bindFramebuffer.set(ue.fb.framebuffer),this.renderedToTile=!1,ue.dirty&&(x.clear({color:m.Color.transparent,stencil:0}),ue.dirty=!1);for(let he=k.start;he<=k.end;++he){const ie=f.style._layers[L[he]];if(ie.isHidden(f.transform.zoom))continue;const ye=f.style._getLayerSourceCache(ie),ge=ye?this.proxyToSource[$.key][ye.id]:[$];if(!ge)continue;const Ce=ge;x.viewport.set([0,0,ue.fb.width,ue.fb.height]),de!==(ye?ye.id:null)&&(this._setupStencil(ue,ge,ie,ye),de=ye?ye.id:null),f.renderLayer(f,ye,ie,Ce)}this.renderedToTile?(ue.dirty=!0,P.push(Q.tileID)):ae||--H,5===H&&(H=0,this.renderToBackBuffer(P))}return this.renderToBackBuffer(P),this.renderingToTexture=!1,x.bindFramebuffer.set(null),x.viewport.set([0,0,f.width,f.height]),k.end+1}postRender(){}renderCacheEfficiency(d){const f=d.order.length;if(0===f)return{efficiency:100};let x,C=0,S=0,k=!1;for(let P=0;P<f;++P){const L=d._layers[d.order[P]];this._style.isLayerDraped(L)?(k&&++C,++S):k||(k=!0,x=L.id)}return 0===S?{efficiency:100}:{efficiency:100*(1-C/S),firstUndrapedLayer:x}}getMinElevationBelowMSL(){let d=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{d=Math.min(d,f.dem.tree.minimums[0])}),0===d?d:(d-30)*this._exaggeration}raycast(d,f,x){if(!this._visibleDemTiles)return null;const C=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const k=S.tileID,P=1<<k.overscaledZ,{x:L,y:H}=k.canonical,$=L/P,Q=(L+1)/P,oe=H/P,ue=(H+1)/P;return{minx:$,miny:oe,maxx:Q,maxy:ue,t:S.dem.tree.raycastRoot($,oe,Q,ue,d,f,x),tile:S}});C.sort((S,k)=>(null!==S.t?S.t:Number.MAX_VALUE)-(null!==k.t?k.t:Number.MAX_VALUE));for(const S of C){if(null==S.t)return null;const k=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,d,f,x);if(null!=k)return k}return null}_createFBO(){const d=this.painter.context,f=d.gl,x=this.drapeBufferSize;d.activeTexture.set(f.TEXTURE0);const C=new m.Texture(d,{width:x[0],height:x[1],data:null},f.RGBA);C.bind(f.LINEAR,f.CLAMP_TO_EDGE);const S=d.createFramebuffer(x[0],x[1],!1);return S.colorAttachment.set(C.texture),S.depthAttachment=new Pd(d,S.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=d.createRenderbuffer(d.gl.DEPTH_STENCIL,x[0],x[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),d.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),d.extTextureFilterAnisotropic&&!d.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax),{fb:S,tex:C,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d].hasTransition())return!0;return this._style.order.some(d=>{const f=this._style._layers[d],x=f.isHidden(this.painter.transform.zoom);return"custom"===f.type?!x&&f.shouldRedrape():!x&&f.hasTransition()})}_clearLineLayersFromRenderCache(){let d=!1;for(const x of this._style._getSources())if(x instanceof Y){d=!0;break}if(!d)return;const f={};for(let x=0;x<this._style.order.length;++x){const C=this._style._layers[this._style.order[x]],S=this._style._getLayerSourceCache(C);if(S&&!f[S.id]&&!C.isHidden(this.painter.transform.zoom)&&"line"===C.type&&C.widthExpression()instanceof m.ZoomDependentExpression){f[S.id]=!0;for(const k of this.proxyCoords){const P=this.proxyToSource[k.key][S.id];if(P)for(const L of P)this._clearRenderCacheForTile(S.id,L)}}}}_clearRasterLayersFromRenderCache(){let d=!1;for(const x in this._style._sourceCaches)if(this._style._sourceCaches[x]._source instanceof ne){d=!0;break}if(!d)return;const f={};for(let x=0;x<this._style.order.length;++x){const C=this._style._layers[this._style.order[x]],S=this._style._getLayerSourceCache(C);if(!S||f[S.id]||C.isHidden(this.painter.transform.zoom)||"raster"!==C.type)continue;const k=C.paint.get("raster-fade-duration");for(const P of this.proxyCoords){const L=this.proxyToSource[P.key][S.id];if(L)for(const H of L){const $=hl(S.getTile(H),S.findLoadedParent(H,0),S,this.painter.transform,k);(1!==$.opacity||0!==$.mix)&&this._clearRenderCacheForTile(S.id,H)}}}}_setupDrapedRenderBatches(){const d=this._style.order,f=d.length;if(0===f)return;const x=[];let C,S=0,k=this._style._layers[d[S]];for(;!this._style.isLayerDraped(k)&&k.isHidden(this.painter.transform.zoom)&&++S<f;)k=this._style._layers[d[S]];for(;S<f;++S){const P=this._style._layers[d[S]];P.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(P)?void 0===C&&(C=S):void 0!==C&&(x.push({start:C,end:S-1}),C=void 0))}void 0!==C&&x.push({start:C,end:S-1}),this._drapedRenderBatches=x}_setupRenderCache(d){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const k=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let P=0;P<k.length;++P){const L=Object.values(k[P]);f.renderCachePool.push(...L)}}return}this._clearRasterLayersFromRenderCache();const x=this.proxyCoords,C=this._tilesDirty;for(let k=x.length-1;k>=0;k--){const P=x[k];if(f.getTileByID(P.key),void 0!==f.proxyCachedFBO[P.key]){const L=d[P.key],H=this.proxyToSource[P.key];let $=0;for(const Q in H){const oe=H[Q],ue=L[Q];if(!ue||ue.length!==oe.length||oe.some((ae,de)=>ae!==ue[de]||C[Q]&&C[Q].hasOwnProperty(ae.key))){$=-1;break}++$}for(const Q in f.proxyCachedFBO[P.key])f.renderCache[f.proxyCachedFBO[P.key][Q]].dirty=$<0||$!==Object.values(L).length}}const S=[...this._drapedRenderBatches];S.sort((k,P)=>P.end-P.start-(k.end-k.start));for(const k of S)for(const P of x){if(f.proxyCachedFBO[P.key])continue;let L=f.renderCachePool.pop();void 0===L&&f.renderCache.length<50&&(L=f.renderCache.length,f.renderCache.push(this._createFBO())),void 0!==L&&(f.proxyCachedFBO[P.key]={},f.proxyCachedFBO[P.key][k.start]=L,f.renderCache[L].dirty=!0)}this._tilesDirty={}}_setupStencil(d,f,x,C){if(!C||!this._sourceTilesOverlap[C.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,k=S.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let P;if(x.isTileClipped())P=f.length,this._overlapStencilMode.test={func:k.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);P=1,this._overlapStencilMode.test={func:k.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+P>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=P,this._overlapStencilMode.ref=this._stencilRef,x.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(d){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[d.key]),this._overlapStencilMode):m.StencilMode.disabled}_renderTileClippingMasks(d,f){const x=this.painter,C=this.painter.context,S=C.gl;x._tileClippingMaskIDs={},C.setColorMode(m.ColorMode.disabled),C.setDepthMode(m.DepthMode.disabled);const k=x.useProgram("clippingMask");for(const P of d){const L=x._tileClippingMaskIDs[P.key]=--f;k.draw(C,S.TRIANGLES,m.DepthMode.disabled,new m.StencilMode({func:S.ALWAYS,mask:0},L,255,S.KEEP,S.KEEP,S.REPLACE),m.ColorMode.disabled,m.CullFaceMode.disabled,Si(P.projMatrix),"$clipping",x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}pointCoordinate(d){const f=this.painter.transform;if(d.x<0||d.x>f.width||d.y<0||d.y>f.height)return null;const x=[d.x,d.y,1,1];m.transformMat4$1(x,x,f.pixelMatrixInverse),m.scale$1(x,x,1/x[3]),x[0]/=f.worldSize,x[1]/=f.worldSize;const C=f._camera.position,S=m.mercatorZfromAltitude(1,f.center.lat),k=[C[0],C[1],C[2]/S,0],P=m.subtract([],x.slice(0,3),k);m.normalize(P,P);const L=this.raycast(k,P,this._exaggeration);return null!==L&&L?(m.scaleAndAdd(k,k,P,L),k[3]=k[2],k[2]*=S,k):null}drawDepth(){const d=this.painter,f=d.context,x=this.proxySourceCache,C=Math.ceil(d.width),S=Math.ceil(d.height);if(!this._depthFBO||this._depthFBO.width===C&&this._depthFBO.height===S||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const k=f.gl,P=f.createFramebuffer(C,S,!0);f.activeTexture.set(k.TEXTURE0);const L=new m.Texture(f,{width:C,height:S,data:null},k.RGBA);L.bind(k.NEAREST,k.CLAMP_TO_EDGE),P.colorAttachment.set(L.texture);const H=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,C,S);P.depthAttachment.set(H),this._depthFBO=P,this._depthTexture=L}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,C,S]),function(k,P,L,H){if("globe"===k.transform.projection.name)return;const $=k.context,Q=$.gl;$.clear({depth:1});const oe=k.useProgram("terrainDepth"),ue=new m.DepthMode(Q.LESS,m.DepthMode.ReadWrite,k.depthRangeFor3D);for(const ae of H){const de=L.getTile(ae),he=Sc(ae.projMatrix,0);P.setupElevationDraw(de,oe),oe.draw($,Q.TRIANGLES,ue,m.StencilMode.disabled,m.ColorMode.unblended,m.CullFaceMode.backCCW,he,"terrain_depth",P.gridBuffer,P.gridIndexBuffer,P.gridNoSkirtSegments)}}(d,this,x,this.proxyCoords)}_setupProxiedCoordsForOrtho(d,f,x){if(d.getSource()instanceof Re)return this._setupProxiedCoordsForImageSource(d,f,x);this._findCoveringTileCache[d.id]=this._findCoveringTileCache[d.id]||{};const C=this.proxiedCoords[d.id]=[],S=this.proxyCoords;for(let P=0;P<S.length;P++){const L=S[P],H=this._findTileCoveringTileID(L,d);if(H){const $=this._createProxiedId(L,H,x[L.key]&&x[L.key][d.id]);C.push($),this.proxyToSource[L.key][d.id]=[$]}}let k=!1;for(let P=0;P<f.length;P++){const L=d.getTile(f[P]);if(!L||!L.hasData())continue;const H=this._findTileCoveringTileID(L.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==L.tileID.canonical.z){const $=this.proxyToSource[H.tileID.key][d.id],Q=this._createProxiedId(H.tileID,L,x[H.tileID.key]&&x[H.tileID.key][d.id]);$?$.splice($.length-1,0,Q):this.proxyToSource[H.tileID.key][d.id]=[Q],C.push(Q),k=!0}}this._sourceTilesOverlap[d.id]=k}_setupProxiedCoordsForImageSource(d,f,x){if(!d.getSource().loaded())return;const C=this.proxiedCoords[d.id]=[],S=this.proxyCoords,k=d.getSource(),P=new m.pointGeometry(k.tileID.x,k.tileID.y)._div(1<<k.tileID.z),L=k.coordinates.map(m.MercatorCoordinate.fromLngLat).reduce(($,Q)=>($.min.x=Math.min($.min.x,Q.x-P.x),$.min.y=Math.min($.min.y,Q.y-P.y),$.max.x=Math.max($.max.x,Q.x-P.x),$.max.y=Math.max($.max.y,Q.y-P.y),$),{min:new m.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new m.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=($,Q)=>{const oe=$.wrap+$.canonical.x/(1<<$.canonical.z),ue=$.canonical.y/(1<<$.canonical.z),ae=m.EXTENT/(1<<$.canonical.z),de=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),he=Q.canonical.y/(1<<Q.canonical.z);return oe+ae<de+L.min.x||oe>de+L.max.x||ue+ae<he+L.min.y||ue>he+L.max.y};for(let $=0;$<S.length;$++){const Q=S[$];for(let oe=0;oe<f.length;oe++){const ue=d.getTile(f[oe]);if(!ue||!ue.hasData()||H(Q,ue.tileID))continue;const ae=this._createProxiedId(Q,ue,x[Q.key]&&x[Q.key][d.id]),de=this.proxyToSource[Q.key][d.id];de?de.push(ae):this.proxyToSource[Q.key][d.id]=[ae],C.push(ae)}}}_createProxiedId(d,f,x){let C=this.orthoMatrix;if(x){const S=x.find(k=>k.key===f.tileID.key);if(S)return S}if(f.tileID.key!==d.key){const S=d.canonical.z-f.tileID.canonical.z;let k,P,L;C=m.create();const H=f.tileID.wrap-d.wrap<<d.overscaledZ;S>0?(k=m.EXTENT>>S,P=k*((f.tileID.canonical.x<<S)-d.canonical.x+H),L=k*((f.tileID.canonical.y<<S)-d.canonical.y)):(k=m.EXTENT<<-S,P=m.EXTENT*(f.tileID.canonical.x-(d.canonical.x+H<<-S)),L=m.EXTENT*(f.tileID.canonical.y-(d.canonical.y<<-S))),m.ortho(C,0,k,0,k,0,1),m.translate(C,C,[P,L,0])}return new Af(f.tileID,d.key,C)}_findTileCoveringTileID(d,f){let x=f.getTile(d);if(x&&x.hasData())return x;const C=this._findCoveringTileCache[f.id],S=C[d.key];if(x=S?f.getTileByID(S):null,x&&x.hasData()||null===S)return x;let k=x?x.tileID:d,P=k.overscaledZ;const L=f.getSource().minzoom,H=[];if(!S){const Q=f.getSource().maxzoom;if(d.canonical.z>=Q){const oe=d.canonical.z-Q;f.getSource().reparseOverscaled?(P=Math.max(d.canonical.z+2,f.transform.tileZoom),k=new m.OverscaledTileID(P,d.wrap,Q,d.canonical.x>>oe,d.canonical.y>>oe)):0!==oe&&(P=Q,k=new m.OverscaledTileID(P,d.wrap,Q,d.canonical.x>>oe,d.canonical.y>>oe))}k.key!==d.key&&(H.push(k.key),x=f.getTile(k))}const $=Q=>{H.forEach(oe=>{C[oe]=Q}),H.length=0};for(P-=1;P>=L&&(!x||!x.hasData());P--){x&&$(x.tileID.key);const Q=k.calculateScaledKey(P);if(x=f.getTileByID(Q),x&&x.hasData())break;const oe=C[Q];if(null===oe)break;void 0===oe?H.push(Q):x=f.getTileByID(oe)}return $(x?x.tileID.key:null),x&&x.hasData()?x:null}findDEMTileFor(d){return this.enabled?this._findTileCoveringTileID(d,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(d,f){let x=this._tilesDirty[d];x||(x=this._tilesDirty[d]={}),x[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const d=function(f){let x=0;const C=new m.StructArrayLayout2ui4,S=131;for(let k=1;k<129;k++){for(let P=1;P<129;P++)x=k*S+P,C.emplaceBack(x,x+1),C.emplaceBack(x,x+S),C.emplaceBack(x+1,x+S),128===k&&C.emplaceBack(x+S,x+S+1);C.emplaceBack(x+1,x+1+S)}return C}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(d),this.wireframeSegments=m.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,d.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Xs{static cacheKey(d,f,x,C){let S=`${f}${C?C.cacheKey:""}`;for(const k of x)d.usedDefines.includes(k)&&(S+=`/${k}`);return S}constructor(d,f,x,C,S,k){const P=d.gl;this.program=P.createProgram();const L=function(ie){const ye=[];for(let ge=0;ge<ie.length;ge++){if(null===ie[ge])continue;const Ce=ie[ge].split(" ");ye.push(Ce.pop())}return ye}(x.staticAttributes),H=C?C.getBinderAttributes():[],$=L.concat(H);let Q=C?C.defines():[];Q=Q.concat(k.map(ie=>`#define ${ie}`));const oe=d.isWebGL2?"#version 300 es\n":"",ue=oe+Q.concat(d.extStandardDerivatives&&0===oe.length?"#extension GL_OES_standard_derivatives : enable\n".concat(If):If,If,bo,wy.fragmentSource,xs.fragmentSource,x.fragmentSource).join("\n"),ae=oe+Q.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",bo,wy.vertexSource,xs.vertexSource,Mf.vertexSource,x.vertexSource).join("\n"),de=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);P.shaderSource(de,ue),P.compileShader(de),P.attachShader(this.program,de);const he=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())this.failedToCreate=!0;else{P.shaderSource(he,ae),P.compileShader(he),P.attachShader(this.program,he),this.attributes={},this.numAttributes=$.length;for(let ie=0;ie<this.numAttributes;ie++)$[ie]&&(P.bindAttribLocation(this.program,ie,$[ie]),this.attributes[$[ie]]=ie);P.linkProgram(this.program),P.deleteShader(he),P.deleteShader(de),this.fixedUniforms=S(d),this.binderUniforms=C?C.getUniforms(d):[],k.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new m.Uniform1i(ie=d),u_dem_prev:new m.Uniform1i(ie),u_dem_unpack:new m.Uniform4f(ie),u_dem_tl:new m.Uniform2f(ie),u_dem_scale:new m.Uniform1f(ie),u_dem_tl_prev:new m.Uniform2f(ie),u_dem_scale_prev:new m.Uniform1f(ie),u_dem_size:new m.Uniform1f(ie),u_dem_lerp:new m.Uniform1f(ie),u_exaggeration:new m.Uniform1f(ie),u_depth:new m.Uniform1i(ie),u_depth_size_inv:new m.Uniform2f(ie),u_meter_to_dem:new m.Uniform1f(ie),u_label_plane_matrix_inv:new m.UniformMatrix4f(ie)}),k.includes("GLOBE")&&(this.globeUniforms=(ie=>({u_tile_tl_up:new m.Uniform3f(ie),u_tile_tr_up:new m.Uniform3f(ie),u_tile_br_up:new m.Uniform3f(ie),u_tile_bl_up:new m.Uniform3f(ie),u_tile_up_scale:new m.Uniform1f(ie)}))(d)),k.includes("FOG")&&(this.fogUniforms=(ie=>({u_fog_matrix:new m.UniformMatrix4f(ie),u_fog_range:new m.Uniform2f(ie),u_fog_color:new m.Uniform4f(ie),u_fog_horizon_blend:new m.Uniform1f(ie),u_fog_temporal_offset:new m.Uniform1f(ie),u_frustum_tl:new m.Uniform3f(ie),u_frustum_tr:new m.Uniform3f(ie),u_frustum_br:new m.Uniform3f(ie),u_frustum_bl:new m.Uniform3f(ie),u_globe_pos:new m.Uniform3f(ie),u_globe_radius:new m.Uniform1f(ie),u_globe_transition:new m.Uniform1f(ie),u_is_globe:new m.Uniform1i(ie),u_viewport:new m.Uniform2f(ie)}))(d))}var ie}setTerrainUniformValues(d,f){if(!this.terrainUniforms)return;const x=this.terrainUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const C in f)x[C]&&x[C].set(this.program,C,f[C])}}setGlobeUniformValues(d,f){if(!this.globeUniforms)return;const x=this.globeUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const C in f)x[C]&&x[C].set(this.program,C,f[C])}}setFogUniformValues(d,f){if(!this.fogUniforms)return;const x=this.fogUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const C in f)x[C].set(this.program,C,f[C])}}draw(d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae,de){const he=d.gl;if(this.failedToCreate)return;d.program.set(this.program),d.setDepthMode(x),d.setStencilMode(C),d.setColorMode(S),d.setCullFace(k);for(const ye of Object.keys(this.fixedUniforms))this.fixedUniforms[ye].set(this.program,ye,P[ye]);ae&&ae.setUniforms(this.program,d,this.binderUniforms,oe,{zoom:ue});const ie={[he.LINES]:2,[he.TRIANGLES]:3,[he.LINE_STRIP]:1}[f];for(const ye of Q.get()){const ge=ye.vaos||(ye.vaos={});(ge[L]||(ge[L]=new Ec)).bind(d,this,H,ae?ae.getPaintVertexBuffers():[],$,ye.vertexOffset,de||[]),he.drawElements(f,ye.primitiveLength*ie,he.UNSIGNED_SHORT,ye.primitiveOffset*ie*2)}}}function Ys(y,d){const f=Math.pow(2,d.tileID.overscaledZ),x=d.tileSize*Math.pow(2,y.transform.tileZoom)/f,C=x*(d.tileID.canonical.x+d.tileID.wrap*f),S=x*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_tile_units_to_pixels:1/ss(d,1,y.transform.tileZoom),u_pixel_coord_upper:[C>>16,S>>16],u_pixel_coord_lower:[65535&C,65535&S]}}const pl=m.create(),Hi=(y,d,f,x,C,S,k,P,L,H,$)=>{const Q=d.style.light,oe=Q.properties.get("position"),ue=[oe.x,oe.y,oe.z],ae=m.create$1();"viewport"===Q.properties.get("anchor")&&(m.fromRotation(ae,-d.transform.angle),m.transformMat3(ue,ue,ae));const de=Q.properties.get("color"),he=d.transform,ie={u_matrix:y,u_lightpos:ue,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[de.r,de.g,de.b],u_vertical_gradient:+f,u_opacity:x,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:pl,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:C,u_edge_radius:S};return"globe"===he.projection.name&&(ie.u_tile_id=[k.canonical.x,k.canonical.y,1<<k.canonical.z],ie.u_zoom_transition=L,ie.u_inv_rot_matrix=$,ie.u_merc_center=H,ie.u_up_dir=he.projection.upVector(new m.CanonicalTileID(0,0,0),H[0]*m.EXTENT,H[1]*m.EXTENT),ie.u_height_lift=P),ie},Ou=(y,d,f,x,C,S,k,P,L,H,$,Q)=>{const oe=Hi(y,d,f,x,C,S,k,L,H,$,Q),ue={u_height_factor:-Math.pow(2,k.overscaledZ)/P.tileSize/8};return m.extend(oe,Ys(d,P),ue)},Ru=y=>({u_matrix:y}),Lu=(y,d,f)=>m.extend(Ru(y),Ys(d,f)),Pf=(y,d)=>({u_matrix:y,u_world:d}),Ha=(y,d,f,x)=>m.extend(Lu(y,d,f),{u_world:x}),jd=m.create(),Hd=(y,d,f,x,C,S)=>{const k=y.transform,P="globe"===k.projection.name;let L;if("map"===S.paint.get("circle-pitch-alignment"))if(P){const $=m.globePixelsToTileUnits(k.zoom,d.canonical)*k._pixelsPerMercatorPixel;L=Float32Array.from([$,0,0,$])}else L=k.calculatePixelsToTileUnitsMatrix(f);else L=new Float32Array([k.pixelsToGLUnits[0],0,0,k.pixelsToGLUnits[1]]);const H={u_camera_to_center_distance:k.cameraToCenterDistance,u_matrix:y.translatePosMatrix(d.projMatrix,f,S.paint.get("circle-translate"),S.paint.get("circle-translate-anchor")),u_device_pixel_ratio:m.exported.devicePixelRatio,u_extrude_scale:L,u_inv_rot_matrix:jd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){H.u_inv_rot_matrix=x,H.u_merc_center=C,H.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],H.u_zoom_transition=m.globeToMercatorTransition(k.zoom);const $=C[0]*m.EXTENT,Q=C[1]*m.EXTENT;H.u_up_dir=k.projection.upVector(new m.CanonicalTileID(0,0,0),$,Q)}return H},on=y=>{const d=[];return"map"===y.paint.get("circle-pitch-alignment")&&d.push("PITCH_WITH_MAP"),"map"===y.paint.get("circle-pitch-scale")&&d.push("SCALE_WITH_MAP"),d},$d=(y,d,f,x)=>{const C=m.EXTENT/f.tileSize;return{u_matrix:y,u_camera_to_center_distance:d.getCameraToCenterDistance(x),u_extrude_scale:[d.pixelsToGLUnits[0]/C,d.pixelsToGLUnits[1]/C]}},Fu=(y,d,f=1)=>({u_matrix:y,u_color:d,u_overlay:0,u_overlay_scale:f}),Qh=m.create(),fn=(y,d,f,x,C,S,k)=>{const P=y.transform,L="globe"===P.projection.name,H=L?m.globePixelsToTileUnits(P.zoom,d.canonical)*P._pixelsPerMercatorPixel:ss(f,1,S),$={u_matrix:d.projMatrix,u_extrude_scale:H,u_intensity:k,u_inv_rot_matrix:Qh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){$.u_inv_rot_matrix=x,$.u_merc_center=C,$.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],$.u_zoom_transition=m.globeToMercatorTransition(P.zoom);const Q=C[0]*m.EXTENT,oe=C[1]*m.EXTENT;$.u_up_dir=P.projection.upVector(new m.CanonicalTileID(0,0,0),Q,oe)}return $},Of=(y,d,f,x,C,S,k)=>{const P=y.transform,L=P.calculatePixelsToTileUnitsMatrix(d);return{u_matrix:Pr(y,d,f,x),u_pixels_to_tile_units:L,u_device_pixel_ratio:S,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:C,u_texsize:Ki(f)?d.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:kn(d,y.transform),u_alpha_discard_threshold:0,u_trim_offset:k}},Rf=(y,d,f,x,C)=>{const S=y.transform;return{u_matrix:Pr(y,d,f,x),u_texsize:d.imageAtlasTexture.size,u_pixels_to_tile_units:S.calculatePixelsToTileUnitsMatrix(d),u_device_pixel_ratio:C,u_image:0,u_tile_units_to_pixels:kn(d,S),u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function kn(y,d){return 1/ss(y,1,d.tileZoom)}function Pr(y,d,f,x){return y.translatePosMatrix(x||d.tileID.projMatrix,d,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}function Ki(y){const d=y.paint.get("line-dasharray").value;return d.value||"constant"!==d.kind}const Xr=(y,d,f,x,C,S)=>{return{u_matrix:y,u_tl_parent:d,u_scale_parent:f,u_fade_t:x.mix,u_opacity:x.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:(P=C.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(k=C.paint.get("raster-contrast"),k>0?1/(1-k):1+k),u_spin_weights:Or(C.paint.get("raster-hue-rotate")),u_perspective_transform:S};var k,P};function Or(y){y*=Math.PI/180;const d=Math.sin(y),f=Math.cos(y);return[(2*f+1)/3,(-Math.sqrt(3)*d-f+1)/3,(Math.sqrt(3)*d-f+1)/3]}const Dc=m.create(),Rr=(y,d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae,de)=>{const he=C.transform,ie={u_is_size_zoom_constant:+("constant"===y||"source"===y),u_is_size_feature_constant:+("constant"===y||"camera"===y),u_size_t:d?d.uSizeT:0,u_size:d?d.uSize:0,u_camera_to_center_distance:he.cameraToCenterDistance,u_rotate_symbol:+f,u_aspect_ratio:he.width/he.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:k,u_coord_matrix:P,u_is_text:+L,u_pitch_with_map:+x,u_texsize:H,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Dc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Dc,u_up_vector:[0,-1,0]};return"globe"===de.name&&(ie.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],ie.u_zoom_transition=Q,ie.u_inv_rot_matrix=ue,ie.u_merc_center=oe,ie.u_camera_forward=he._camera.forward(),ie.u_ecef_origin=m.globeECEFOrigin(he.globeMatrix,$.toUnwrapped()),ie.u_tile_matrix=Float32Array.from(he.globeMatrix),ie.u_up_vector=ae),ie},$a=(y,d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae,de,he)=>m.extend(Rr(y,d,f,x,C,S,k,P,L,H,Q,oe,ue,ae,de,he),{u_gamma_scale:x?C.transform.cameraToCenterDistance*Math.cos(C.terrain?0:C.transform._pitch):1,u_device_pixel_ratio:m.exported.devicePixelRatio,u_is_halo:+$}),vn=(y,d,f,x,C,S,k,P,L,H,$,Q,oe,ue,ae,de)=>m.extend($a(y,d,f,x,C,S,k,P,!0,L,!0,$,Q,oe,ue,ae,de),{u_texsize_icon:H,u_texture_icon:1}),Ci=(y,d,f)=>({u_matrix:y,u_opacity:d,u_color:f}),Fo=(y,d,f,x,C)=>m.extend(function(S,k,P){const L=k.imageManager.getPattern(S.toString()),{width:H,height:$}=k.imageManager.getPixelSize(),Q=Math.pow(2,P.tileID.overscaledZ),oe=P.tileSize*Math.pow(2,k.transform.tileZoom)/Q,ue=oe*(P.tileID.canonical.x+P.tileID.wrap*Q),ae=oe*P.tileID.canonical.y;return{u_image:0,u_pattern_tl:L.tl,u_pattern_br:L.br,u_texsize:[H,$],u_pattern_size:L.displaySize,u_tile_units_to_pixels:1/ss(P,1,k.transform.tileZoom),u_pixel_coord_upper:[ue>>16,ae>>16],u_pixel_coord_lower:[65535&ue,65535&ae]}}(x,f,C),{u_matrix:y,u_opacity:d}),_a={fillExtrusion:y=>({u_matrix:new m.UniformMatrix4f(y),u_lightpos:new m.Uniform3f(y),u_lightintensity:new m.Uniform1f(y),u_lightcolor:new m.Uniform3f(y),u_vertical_gradient:new m.Uniform1f(y),u_opacity:new m.Uniform1f(y),u_edge_radius:new m.Uniform1f(y),u_ao:new m.Uniform2f(y),u_tile_id:new m.Uniform3f(y),u_zoom_transition:new m.Uniform1f(y),u_inv_rot_matrix:new m.UniformMatrix4f(y),u_merc_center:new m.Uniform2f(y),u_up_dir:new m.Uniform3f(y),u_height_lift:new m.Uniform1f(y)}),fillExtrusionPattern:y=>({u_matrix:new m.UniformMatrix4f(y),u_lightpos:new m.Uniform3f(y),u_lightintensity:new m.Uniform1f(y),u_lightcolor:new m.Uniform3f(y),u_vertical_gradient:new m.Uniform1f(y),u_height_factor:new m.Uniform1f(y),u_edge_radius:new m.Uniform1f(y),u_ao:new m.Uniform2f(y),u_tile_id:new m.Uniform3f(y),u_zoom_transition:new m.Uniform1f(y),u_inv_rot_matrix:new m.UniformMatrix4f(y),u_merc_center:new m.Uniform2f(y),u_up_dir:new m.Uniform3f(y),u_height_lift:new m.Uniform1f(y),u_image:new m.Uniform1i(y),u_texsize:new m.Uniform2f(y),u_pixel_coord_upper:new m.Uniform2f(y),u_pixel_coord_lower:new m.Uniform2f(y),u_tile_units_to_pixels:new m.Uniform1f(y),u_opacity:new m.Uniform1f(y)}),fill:y=>({u_matrix:new m.UniformMatrix4f(y)}),fillPattern:y=>({u_matrix:new m.UniformMatrix4f(y),u_image:new m.Uniform1i(y),u_texsize:new m.Uniform2f(y),u_pixel_coord_upper:new m.Uniform2f(y),u_pixel_coord_lower:new m.Uniform2f(y),u_tile_units_to_pixels:new m.Uniform1f(y)}),fillOutline:y=>({u_matrix:new m.UniformMatrix4f(y),u_world:new m.Uniform2f(y)}),fillOutlinePattern:y=>({u_matrix:new m.UniformMatrix4f(y),u_world:new m.Uniform2f(y),u_image:new m.Uniform1i(y),u_texsize:new m.Uniform2f(y),u_pixel_coord_upper:new m.Uniform2f(y),u_pixel_coord_lower:new m.Uniform2f(y),u_tile_units_to_pixels:new m.Uniform1f(y)}),circle:y=>({u_camera_to_center_distance:new m.Uniform1f(y),u_extrude_scale:new m.UniformMatrix2f(y),u_device_pixel_ratio:new m.Uniform1f(y),u_matrix:new m.UniformMatrix4f(y),u_inv_rot_matrix:new m.UniformMatrix4f(y),u_merc_center:new m.Uniform2f(y),u_tile_id:new m.Uniform3f(y),u_zoom_transition:new m.Uniform1f(y),u_up_dir:new m.Uniform3f(y)}),collisionBox:y=>({u_matrix:new m.UniformMatrix4f(y),u_camera_to_center_distance:new m.Uniform1f(y),u_extrude_scale:new m.Uniform2f(y)}),collisionCircle:y=>({u_matrix:new m.UniformMatrix4f(y),u_inv_matrix:new m.UniformMatrix4f(y),u_camera_to_center_distance:new m.Uniform1f(y),u_viewport_size:new m.Uniform2f(y)}),debug:y=>({u_color:new m.UniformColor(y),u_matrix:new m.UniformMatrix4f(y),u_overlay:new m.Uniform1i(y),u_overlay_scale:new m.Uniform1f(y)}),clippingMask:y=>({u_matrix:new m.UniformMatrix4f(y)}),heatmap:y=>({u_extrude_scale:new m.Uniform1f(y),u_intensity:new m.Uniform1f(y),u_matrix:new m.UniformMatrix4f(y),u_inv_rot_matrix:new m.UniformMatrix4f(y),u_merc_center:new m.Uniform2f(y),u_tile_id:new m.Uniform3f(y),u_zoom_transition:new m.Uniform1f(y),u_up_dir:new m.Uniform3f(y)}),heatmapTexture:y=>({u_image:new m.Uniform1i(y),u_color_ramp:new m.Uniform1i(y),u_opacity:new m.Uniform1f(y)}),hillshade:y=>({u_matrix:new m.UniformMatrix4f(y),u_image:new m.Uniform1i(y),u_latrange:new m.Uniform2f(y),u_light:new m.Uniform2f(y),u_shadow:new m.UniformColor(y),u_highlight:new m.UniformColor(y),u_accent:new m.UniformColor(y)}),hillshadePrepare:y=>({u_matrix:new m.UniformMatrix4f(y),u_image:new m.Uniform1i(y),u_dimension:new m.Uniform2f(y),u_zoom:new m.Uniform1f(y),u_unpack:new m.Uniform4f(y)}),line:y=>({u_matrix:new m.UniformMatrix4f(y),u_pixels_to_tile_units:new m.UniformMatrix2f(y),u_device_pixel_ratio:new m.Uniform1f(y),u_units_to_pixels:new m.Uniform2f(y),u_dash_image:new m.Uniform1i(y),u_gradient_image:new m.Uniform1i(y),u_image_height:new m.Uniform1f(y),u_texsize:new m.Uniform2f(y),u_tile_units_to_pixels:new m.Uniform1f(y),u_alpha_discard_threshold:new m.Uniform1f(y),u_trim_offset:new m.Uniform2f(y)}),linePattern:y=>({u_matrix:new m.UniformMatrix4f(y),u_texsize:new m.Uniform2f(y),u_pixels_to_tile_units:new m.UniformMatrix2f(y),u_device_pixel_ratio:new m.Uniform1f(y),u_image:new m.Uniform1i(y),u_units_to_pixels:new m.Uniform2f(y),u_tile_units_to_pixels:new m.Uniform1f(y),u_alpha_discard_threshold:new m.Uniform1f(y)}),raster:y=>({u_matrix:new m.UniformMatrix4f(y),u_tl_parent:new m.Uniform2f(y),u_scale_parent:new m.Uniform1f(y),u_fade_t:new m.Uniform1f(y),u_opacity:new m.Uniform1f(y),u_image0:new m.Uniform1i(y),u_image1:new m.Uniform1i(y),u_brightness_low:new m.Uniform1f(y),u_brightness_high:new m.Uniform1f(y),u_saturation_factor:new m.Uniform1f(y),u_contrast_factor:new m.Uniform1f(y),u_spin_weights:new m.Uniform3f(y),u_perspective_transform:new m.Uniform2f(y)}),symbolIcon:y=>({u_is_size_zoom_constant:new m.Uniform1i(y),u_is_size_feature_constant:new m.Uniform1i(y),u_size_t:new m.Uniform1f(y),u_size:new m.Uniform1f(y),u_camera_to_center_distance:new m.Uniform1f(y),u_rotate_symbol:new m.Uniform1i(y),u_aspect_ratio:new m.Uniform1f(y),u_fade_change:new m.Uniform1f(y),u_matrix:new m.UniformMatrix4f(y),u_label_plane_matrix:new m.UniformMatrix4f(y),u_coord_matrix:new m.UniformMatrix4f(y),u_is_text:new m.Uniform1i(y),u_pitch_with_map:new m.Uniform1i(y),u_texsize:new m.Uniform2f(y),u_tile_id:new m.Uniform3f(y),u_zoom_transition:new m.Uniform1f(y),u_inv_rot_matrix:new m.UniformMatrix4f(y),u_merc_center:new m.Uniform2f(y),u_camera_forward:new m.Uniform3f(y),u_tile_matrix:new m.UniformMatrix4f(y),u_up_vector:new m.Uniform3f(y),u_ecef_origin:new m.Uniform3f(y),u_texture:new m.Uniform1i(y)}),symbolSDF:y=>({u_is_size_zoom_constant:new m.Uniform1i(y),u_is_size_feature_constant:new m.Uniform1i(y),u_size_t:new m.Uniform1f(y),u_size:new m.Uniform1f(y),u_camera_to_center_distance:new m.Uniform1f(y),u_rotate_symbol:new m.Uniform1i(y),u_aspect_ratio:new m.Uniform1f(y),u_fade_change:new m.Uniform1f(y),u_matrix:new m.UniformMatrix4f(y),u_label_plane_matrix:new m.UniformMatrix4f(y),u_coord_matrix:new m.UniformMatrix4f(y),u_is_text:new m.Uniform1i(y),u_pitch_with_map:new m.Uniform1i(y),u_texsize:new m.Uniform2f(y),u_texture:new m.Uniform1i(y),u_gamma_scale:new m.Uniform1f(y),u_device_pixel_ratio:new m.Uniform1f(y),u_tile_id:new m.Uniform3f(y),u_zoom_transition:new m.Uniform1f(y),u_inv_rot_matrix:new m.UniformMatrix4f(y),u_merc_center:new m.Uniform2f(y),u_camera_forward:new m.Uniform3f(y),u_tile_matrix:new m.UniformMatrix4f(y),u_up_vector:new m.Uniform3f(y),u_ecef_origin:new m.Uniform3f(y),u_is_halo:new m.Uniform1i(y)}),symbolTextAndIcon:y=>({u_is_size_zoom_constant:new m.Uniform1i(y),u_is_size_feature_constant:new m.Uniform1i(y),u_size_t:new m.Uniform1f(y),u_size:new m.Uniform1f(y),u_camera_to_center_distance:new m.Uniform1f(y),u_rotate_symbol:new m.Uniform1i(y),u_aspect_ratio:new m.Uniform1f(y),u_fade_change:new m.Uniform1f(y),u_matrix:new m.UniformMatrix4f(y),u_label_plane_matrix:new m.UniformMatrix4f(y),u_coord_matrix:new m.UniformMatrix4f(y),u_is_text:new m.Uniform1i(y),u_pitch_with_map:new m.Uniform1i(y),u_texsize:new m.Uniform2f(y),u_texsize_icon:new m.Uniform2f(y),u_texture:new m.Uniform1i(y),u_texture_icon:new m.Uniform1i(y),u_gamma_scale:new m.Uniform1f(y),u_device_pixel_ratio:new m.Uniform1f(y),u_is_halo:new m.Uniform1i(y)}),background:y=>({u_matrix:new m.UniformMatrix4f(y),u_opacity:new m.Uniform1f(y),u_color:new m.UniformColor(y)}),backgroundPattern:y=>({u_matrix:new m.UniformMatrix4f(y),u_opacity:new m.Uniform1f(y),u_image:new m.Uniform1i(y),u_pattern_tl:new m.Uniform2f(y),u_pattern_br:new m.Uniform2f(y),u_texsize:new m.Uniform2f(y),u_pattern_size:new m.Uniform2f(y),u_pixel_coord_upper:new m.Uniform2f(y),u_pixel_coord_lower:new m.Uniform2f(y),u_tile_units_to_pixels:new m.Uniform1f(y)}),terrainRaster:Ud,terrainDepth:Ud,skybox:y=>({u_matrix:new m.UniformMatrix4f(y),u_sun_direction:new m.Uniform3f(y),u_cubemap:new m.Uniform1i(y),u_opacity:new m.Uniform1f(y),u_temporal_offset:new m.Uniform1f(y)}),skyboxGradient:y=>({u_matrix:new m.UniformMatrix4f(y),u_color_ramp:new m.Uniform1i(y),u_center_direction:new m.Uniform3f(y),u_radius:new m.Uniform1f(y),u_opacity:new m.Uniform1f(y),u_temporal_offset:new m.Uniform1f(y)}),skyboxCapture:y=>({u_matrix_3f:new m.UniformMatrix3f(y),u_sun_direction:new m.Uniform3f(y),u_sun_intensity:new m.Uniform1f(y),u_color_tint_r:new m.Uniform4f(y),u_color_tint_m:new m.Uniform4f(y),u_luminance:new m.Uniform1f(y)}),globeRaster:y=>({u_proj_matrix:new m.UniformMatrix4f(y),u_globe_matrix:new m.UniformMatrix4f(y),u_normalize_matrix:new m.UniformMatrix4f(y),u_merc_matrix:new m.UniformMatrix4f(y),u_zoom_transition:new m.Uniform1f(y),u_merc_center:new m.Uniform2f(y),u_image0:new m.Uniform1i(y),u_grid_matrix:new m.UniformMatrix3f(y),u_skirt_height:new m.Uniform1f(y),u_frustum_tl:new m.Uniform3f(y),u_frustum_tr:new m.Uniform3f(y),u_frustum_br:new m.Uniform3f(y),u_frustum_bl:new m.Uniform3f(y),u_globe_pos:new m.Uniform3f(y),u_globe_radius:new m.Uniform1f(y),u_viewport:new m.Uniform2f(y)}),globeAtmosphere:y=>({u_frustum_tl:new m.Uniform3f(y),u_frustum_tr:new m.Uniform3f(y),u_frustum_br:new m.Uniform3f(y),u_frustum_bl:new m.Uniform3f(y),u_horizon:new m.Uniform1f(y),u_transition:new m.Uniform1f(y),u_fadeout_range:new m.Uniform1f(y),u_color:new m.Uniform4f(y),u_high_color:new m.Uniform4f(y),u_space_color:new m.Uniform4f(y),u_star_intensity:new m.Uniform1f(y),u_star_density:new m.Uniform1f(y),u_star_size:new m.Uniform1f(y),u_temporal_offset:new m.Uniform1f(y),u_horizon_angle:new m.Uniform1f(y),u_rotation_matrix:new m.UniformMatrix4f(y)})};let Ls;function Lr(y,d,f,x,C,S,k){const P=y.context,L=P.gl,H=y.transform,$=y.useProgram("collisionBox"),Q=[];let oe=0,ue=0;for(let Ce=0;Ce<x.length;Ce++){const Pe=x[Ce],ke=d.getTile(Pe),Le=ke.getBucket(f);if(!Le)continue;const $e=ri(Pe,Le,H);let nt=$e;0===C[0]&&0===C[1]||(nt=y.translatePosMatrix($e,ke,C,S));const ot=k?Le.textCollisionBox:Le.iconCollisionBox,zt=Le.collisionCircleArray;if(zt.length>0){const Ze=m.create(),Ct=nt;m.mul(Ze,Le.placementInvProjMatrix,H.glCoordMatrix),m.mul(Ze,Ze,Le.placementViewportMatrix),Q.push({circleArray:zt,circleOffset:ue,transform:Ct,invTransform:Ze,projection:Le.getProjection()}),oe+=zt.length/4,ue=oe}ot&&(y.terrain&&y.terrain.setupElevationDraw(ke,$),$.draw(P,L.LINES,m.DepthMode.disabled,m.StencilMode.disabled,y.colorModeForRenderPass(),m.CullFaceMode.disabled,$d(nt,H,ke,Le.getProjection()),f.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,null,H.zoom,null,[ot.collisionVertexBuffer,ot.collisionVertexBufferExt]))}if(!k||!Q.length)return;const ae=y.useProgram("collisionCircle"),de=new m.StructArrayLayout2f1f2i16;de.resize(4*oe),de._trim();let he=0;for(const Ce of Q)for(let Pe=0;Pe<Ce.circleArray.length/4;Pe++){const ke=4*Pe,Le=Ce.circleArray[ke+0],$e=Ce.circleArray[ke+1],nt=Ce.circleArray[ke+2],ot=Ce.circleArray[ke+3];de.emplace(he++,Le,$e,nt,ot,0),de.emplace(he++,Le,$e,nt,ot,1),de.emplace(he++,Le,$e,nt,ot,2),de.emplace(he++,Le,$e,nt,ot,3)}(!Ls||Ls.length<2*oe)&&(Ls=function(Ce){const Pe=2*Ce,ke=new m.StructArrayLayout3ui6;ke.resize(Pe),ke._trim();for(let Le=0;Le<Pe;Le++){const $e=6*Le;ke.uint16[$e+0]=4*Le+0,ke.uint16[$e+1]=4*Le+1,ke.uint16[$e+2]=4*Le+2,ke.uint16[$e+3]=4*Le+2,ke.uint16[$e+4]=4*Le+3,ke.uint16[$e+5]=4*Le+0}return ke}(oe));const ie=P.createIndexBuffer(Ls,!0),ye=P.createVertexBuffer(de,m.collisionCircleLayout.members,!0);for(const Ce of Q){const Pe={u_matrix:Ce.transform,u_inv_matrix:Ce.invTransform,u_camera_to_center_distance:(ge=H).getCameraToCenterDistance(Ce.projection),u_viewport_size:[ge.width,ge.height]};ae.draw(P,L.TRIANGLES,m.DepthMode.disabled,m.StencilMode.disabled,y.colorModeForRenderPass(),m.CullFaceMode.disabled,Pe,f.id,ye,ie,m.SegmentVector.simpleSegment(0,2*Ce.circleOffset,Ce.circleArray.length,Ce.circleArray.length/2),null,H.zoom)}var ge;ye.destroy(),ie.destroy()}const jl=m.create();function Uo({width:y,height:d,anchor:f,textOffset:x,textScale:C},S){const{horizontalAlign:k,verticalAlign:P}=m.getAnchorAlignment(f),L=-(k-.5)*y,H=-(P-.5)*d,$=m.evaluateVariableOffset(f,x);return new m.pointGeometry((L/C+$[0])*S,(H/C+$[1])*S)}function fl(y,d,f,x,C,S,k,P,L,H,$){const Q=y.text.placedSymbolArray,oe=y.text.dynamicLayoutVertexArray,ue=y.icon.dynamicLayoutVertexArray,ae={},de=y.getProjection(),he=Zi(P,de,S),ie=S.elevation,ye=de.upVectorScale(P.canonical,S.center.lat,S.worldSize).metersToTile;oe.clear();for(let ge=0;ge<Q.length;ge++){const Ce=Q.get(ge),{tileAnchorX:Pe,tileAnchorY:ke,numGlyphs:Le}=Ce,nt=Ce.hidden||!Ce.crossTileID||y.allowVerticalPlacement&&!Ce.placedOrientation?null:x[Ce.crossTileID];if(nt){let ot=0,zt=0,Ze=0;if(ie){const hn=ie?ie.getAtTileOffset(P,Pe,ke):0,[ni,cn,Zt]=de.upVector(P.canonical,Pe,ke);ot=hn*ni*ye,zt=hn*cn*ye,Ze=hn*Zt*ye}let[Ct,ut,kt,it]=Gt(Ce.projectedAnchorX+ot,Ce.projectedAnchorY+zt,Ce.projectedAnchorZ+Ze,f?he:k);const je=_i(S.getCameraToCenterDistance(de),it);let lt=C.evaluateSizeForFeature(y.textSizeData,H,Ce)*je/m.ONE_EM;f&&(lt*=y.tilePixelRatio/L);const Mt=Uo(nt,lt);f?(({x:Ct,y:ut,z:kt}=de.projectTilePoint(Pe+Mt.x,ke+Mt.y,P.canonical)),[Ct,ut,kt]=Gt(Ct+ot,ut+zt,kt+Ze,k)):(d&&Mt._rotate(-S.angle),Ct+=Mt.x,ut+=Mt.y,kt=0);const Pt=y.allowVerticalPlacement&&Ce.placedOrientation===m.WritingMode.vertical?Math.PI/2:0;for(let hn=0;hn<Le;hn++)m.addDynamicAttributes(oe,Ct,ut,kt,Pt);$&&Ce.associatedIconIndex>=0&&(ae[Ce.associatedIconIndex]={x:Ct,y:ut,z:kt,angle:Pt})}else ro(Le,oe)}if($){ue.clear();const ge=y.icon.placedSymbolArray;for(let Ce=0;Ce<ge.length;Ce++){const Pe=ge.get(Ce),{numGlyphs:ke}=Pe,Le=ae[Ce];if(Pe.hidden||!Le)ro(ke,ue);else{const{x:$e,y:nt,z:ot,angle:zt}=Le;for(let Ze=0;Ze<ke;Ze++)m.addDynamicAttributes(ue,$e,nt,ot,zt)}}y.icon.dynamicLayoutVertexBuffer.updateData(ue)}y.text.dynamicLayoutVertexBuffer.updateData(oe)}function Jh(y,d,f){return f.iconsInText&&d?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function Ti(y,d,f,x,C,S,k,P,L,H,$,Q){const oe=y.context,ue=oe.gl,ae=y.transform,de="map"===P,he="map"===L,ie=de&&"point"!==f.layout.get("symbol-placement"),ye=de&&!he&&!ie,ge=void 0!==f.layout.get("symbol-sort-key").constantOr(1);let Ce=!1;const Pe=y.depthModeForSublayer(0,m.DepthMode.ReadOnly),ke=[m.mercatorXfromLng(ae.center.lng),m.mercatorYfromLat(ae.center.lat)],Le=f.layout.get("text-variable-anchor"),$e="globe"===ae.projection.name,nt=[],ot=[0,-1,0];let zt=ot;!$e&&!ae.mercatorFromTransition||de||(zt=function(Ze){const Ct=Ze._camera.getWorldToCamera(Ze.worldSize,1),ut=m.multiply([],Ct,Ze.globeMatrix);m.invert(ut,ut);const kt=[0,0,0],it=[0,1,0,0];return m.transformMat4$1(it,it,ut),kt[0]=it[0],kt[1]=it[1],kt[2]=it[2],m.normalize(kt,kt),kt}(ae));for(const Ze of x){const Ct=d.getTile(Ze),ut=Ct.getBucket(f);if(!ut||"mercator"===ut.projection.name&&$e)continue;const kt=C?ut.text:ut.icon;if(!kt||ut.fullyClipped||!kt.segments.get().length)continue;const it=kt.programConfigurations.get(f.id),je=C||ut.sdfIcons,lt=C?ut.textSizeData:ut.iconSizeData,Mt=he||0!==ae.pitch,Pt=m.evaluateSizeForZoom(lt,ae.zoom);let hn,ni,cn,Zt,bn=[0,0],yi=null;if(C)ni=Ct.glyphAtlasTexture,cn=ue.LINEAR,hn=Ct.glyphAtlasTexture.size,ut.iconsInText&&(bn=Ct.imageAtlasTexture.size,yi=Ct.imageAtlasTexture,Zt=Mt||y.options.rotating||y.options.zooming||"composite"===lt.kind||"camera"===lt.kind?ue.LINEAR:ue.NEAREST);else{const Es=1!==f.layout.get("icon-size").constantOr(0)||ut.iconsNeedLinear;ni=Ct.imageAtlasTexture,cn=je||y.options.rotating||y.options.zooming||Es||Mt?ue.LINEAR:ue.NEAREST,hn=Ct.imageAtlasTexture.size}const Tn="globe"===ut.projection.name,$i=Tn?zt:ot,Gi=Tn?m.globeToMercatorTransition(ae.zoom):0,so=Zi(Ze,ut.getProjection(),ae),Xi=ae.calculatePixelsToTileUnitsMatrix(Ct),tr=Su(so,Ct.tileID.canonical,he,de,ae,ut.getProjection(),Xi),us=y.terrain&&he&&ie?m.invert(m.create(),tr):jl,Js=xc(so,Ct.tileID.canonical,he,de,ae,ut.getProjection(),Xi),yl=Le&&ut.hasTextData(),Ni="none"!==f.layout.get("icon-text-fit")&&yl&&ut.hasIconData();if(ie){const Es=ae.elevation,Ns=Es?Es.getAtTileOffsetFunc(Ze,ae.center.lat,ae.worldSize,ut.getProjection()):null,bl=Wo(so,Ct.tileID.canonical,he,de,ae,ut.getProjection(),Xi);Ks(ut,so,y,C,bl,Js,he,H,Ns,Ze)}const co=ie||C&&Le||Ni,Di=y.translatePosMatrix(so,Ct,S,k),Io=co?jl:tr,Nr=y.translatePosMatrix(Js,Ct,S,k,!0),uo=ut.getProjection().createInversionMatrix(ae,Ze.canonical),wr=[];y.terrainRenderModeElevated()&&he&&wr.push("PITCH_WITH_MAP_TERRAIN"),Tn&&wr.push("PROJECTION_GLOBE_VIEW"),co&&wr.push("PROJECTED_POS_ON_VIEWPORT");const Yr=je&&0!==f.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1);let vl;vl=je?ut.iconsInText?vn(lt.kind,Pt,ye,he,y,Di,Io,Nr,hn,bn,Ze,Gi,ke,uo,$i,ut.getProjection()):$a(lt.kind,Pt,ye,he,y,Di,Io,Nr,C,hn,!0,Ze,Gi,ke,uo,$i,ut.getProjection()):Rr(lt.kind,Pt,ye,he,y,Di,Io,Nr,C,hn,Ze,Gi,ke,uo,$i,ut.getProjection());const Nc={program:y.useProgram(Jh(je,C,ut),it,wr),buffers:kt,uniformValues:vl,atlasTexture:ni,atlasTextureIcon:yi,atlasInterpolation:cn,atlasInterpolationIcon:Zt,isSDF:je,hasHalo:Yr,tile:Ct,labelPlaneMatrixInv:us};if(ge&&ut.canOverlap){Ce=!0;const Es=kt.segments.get();for(const Ns of Es)nt.push({segments:new m.SegmentVector([Ns]),sortKey:Ns.sortKey,state:Nc})}else nt.push({segments:kt.segments,sortKey:0,state:Nc})}Ce&&nt.sort((Ze,Ct)=>Ze.sortKey-Ct.sortKey);for(const Ze of nt){const Ct=Ze.state;if(y.terrain&&y.terrain.setupElevationDraw(Ct.tile,Ct.program,{useDepthForOcclusion:!$e,labelPlaneMatrixInv:Ct.labelPlaneMatrixInv}),oe.activeTexture.set(ue.TEXTURE0),Ct.atlasTexture.bind(Ct.atlasInterpolation,ue.CLAMP_TO_EDGE),Ct.atlasTextureIcon&&(oe.activeTexture.set(ue.TEXTURE1),Ct.atlasTextureIcon&&Ct.atlasTextureIcon.bind(Ct.atlasInterpolationIcon,ue.CLAMP_TO_EDGE)),Ct.isSDF){const ut=Ct.uniformValues;Ct.hasHalo&&(ut.u_is_halo=1,ep(Ct.buffers,Ze.segments,f,y,Ct.program,Pe,$,Q,ut)),ut.u_is_halo=0}ep(Ct.buffers,Ze.segments,f,y,Ct.program,Pe,$,Q,Ct.uniformValues)}}function ep(y,d,f,x,C,S,k,P,L){const H=x.context,$=[y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer,y.globeExtVertexBuffer];C.draw(H,H.gl.TRIANGLES,S,k,P,m.CullFaceMode.disabled,L,f.id,y.layoutVertexBuffer,y.indexBuffer,d,f.paint,x.transform.zoom,y.programConfigurations.get(f.id),$)}function zu(y,d,f,x,C,S,k){const P=y.context.gl,L=f.paint.get("fill-pattern"),H=L&&L.constantOr(1);let $,Q,oe,ue,ae;k?(Q=H&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=P.LINES):(Q=H?"fillPattern":"fill",$=P.TRIANGLES);for(const de of x){const he=d.getTile(de);if(H&&!he.patternsLoaded())continue;const ie=he.getBucket(f);if(!ie)continue;y.prepareDrawTile();const ye=ie.programConfigurations.get(f.id),ge=y.useProgram(Q,ye);H&&(y.context.activeTexture.set(P.TEXTURE0),he.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),ye.updatePaintBuffers());const Ce=L.constantOr(null);if(Ce&&he.imageAtlas){const ke=he.imageAtlas.patternPositions[Ce.toString()];ke&&ye.setConstantPatternPositions(ke)}const Pe=y.translatePosMatrix(de.projMatrix,he,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(k){ue=ie.indexBuffer2,ae=ie.segments2;const ke=y.terrain&&y.terrain.renderingToTexture?y.terrain.drapeBufferSize:[P.drawingBufferWidth,P.drawingBufferHeight];oe="fillOutlinePattern"===Q&&H?Ha(Pe,y,he,ke):Pf(Pe,ke)}else ue=ie.indexBuffer,ae=ie.segments,oe=H?Lu(Pe,y,he):Ru(Pe);y.prepareDrawProgram(y.context,ge,de.toUnwrapped()),ge.draw(y.context,$,C,y.stencilModeForClipping(de),S,m.CullFaceMode.disabled,oe,f.id,ie.layoutVertexBuffer,ue,ae,f.paint,y.transform.zoom,ye)}}function tp(y,d,f,x,C,S,k){const P=y.context,L=P.gl,H=y.transform,$=f.paint.get("fill-extrusion-pattern"),Q=$.constantOr(1),oe=f.paint.get("fill-extrusion-opacity"),ue=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),f.paint.get("fill-extrusion-ambient-occlusion-radius")],ae=f.layout.get("fill-extrusion-edge-radius"),de="globe"===H.projection.name?m.fillExtrusionHeightLift():0,he="globe"===H.projection.name,ie=he?m.globeToMercatorTransition(H.zoom):0,ye=[m.mercatorXfromLng(H.center.lng),m.mercatorYfromLat(H.center.lat)],ge=[];he&&ge.push("PROJECTION_GLOBE_VIEW"),ue[0]>0&&ge.push("FAUX_AO");for(const Ce of x){const Pe=d.getTile(Ce),ke=Pe.getBucket(f);if(!ke||ke.projection.name!==H.projection.name)continue;const Le=ke.programConfigurations.get(f.id),$e=y.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",Le,ge);if(y.terrain){const kt=y.terrain;if(y.style.terrainSetForDrapingOnly())kt.setupElevationDraw(Pe,$e,{useMeterToDem:!0});else{if(!ke.enableTerrain)continue;if(kt.setupElevationDraw(Pe,$e,{useMeterToDem:!0}),Nu(P,d,Ce,ke,f,kt),!ke.centroidVertexBuffer){const it=$e.attributes.a_centroid_pos;void 0!==it&&L.vertexAttrib2f(it,0,0)}}}Q&&(y.context.activeTexture.set(L.TEXTURE0),Pe.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),Le.updatePaintBuffers());const nt=$.constantOr(null);if(nt&&Pe.imageAtlas){const kt=Pe.imageAtlas.patternPositions[nt.toString()];kt&&Le.setConstantPatternPositions(kt)}const ot=y.translatePosMatrix(Ce.projMatrix,Pe,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),zt=H.projection.createInversionMatrix(H,Ce.canonical),Ze=f.paint.get("fill-extrusion-vertical-gradient"),Ct=Q?Ou(ot,y,Ze,oe,ue,ae,Ce,Pe,de,ie,ye,zt):Hi(ot,y,Ze,oe,ue,ae,Ce,de,ie,ye,zt);y.prepareDrawProgram(P,$e,Ce.toUnwrapped());const ut=[];y.terrain&&ut.push(ke.centroidVertexBuffer),he&&ut.push(ke.layoutVertexExtBuffer),$e.draw(P,P.gl.TRIANGLES,C,S,k,m.CullFaceMode.backCCW,Ct,f.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,f.paint,y.transform.zoom,Le,ut)}}function Nu(y,d,f,x,C,S){const k=[ie=>{let ye=ie.canonical.x-1,ge=ie.wrap;return ye<0&&(ye=(1<<ie.canonical.z)-1,ge--),new m.OverscaledTileID(ie.overscaledZ,ge,ie.canonical.z,ye,ie.canonical.y)},ie=>{let ye=ie.canonical.x+1,ge=ie.wrap;return ye===1<<ie.canonical.z&&(ye=0,ge++),new m.OverscaledTileID(ie.overscaledZ,ge,ie.canonical.z,ye,ie.canonical.y)},ie=>new m.OverscaledTileID(ie.overscaledZ,ie.wrap,ie.canonical.z,ie.canonical.x,(0===ie.canonical.y?1<<ie.canonical.z:ie.canonical.y)-1),ie=>new m.OverscaledTileID(ie.overscaledZ,ie.wrap,ie.canonical.z,ie.canonical.x,ie.canonical.y===(1<<ie.canonical.z)-1?0:ie.canonical.y+1)],P=ie=>{const ye=d.getSource().minzoom,ge=Pe=>{const ke=d.getTileByID(Pe);if(ke&&ke.hasData())return ke.getBucket(C)},Ce=[0,-1,1];for(const Pe of Ce){if(ie.overscaledZ+Pe<ye)continue;const ke=ge(ie.calculateScaledKey(ie.overscaledZ+Pe));if(ke)return ke}},L=[0,0,0],H=(ie,ye)=>(L[0]=Math.min(ie.min.y,ye.min.y),L[1]=Math.max(ie.max.y,ye.max.y),L[2]=m.EXTENT-ye.min.x>ie.max.x?ye.min.x-m.EXTENT:ie.max.x,L),$=(ie,ye)=>(L[0]=Math.min(ie.min.x,ye.min.x),L[1]=Math.max(ie.max.x,ye.max.x),L[2]=m.EXTENT-ye.min.y>ie.max.y?ye.min.y-m.EXTENT:ie.max.y,L),Q=[(ie,ye)=>H(ie,ye),(ie,ye)=>H(ye,ie),(ie,ye)=>$(ie,ye),(ie,ye)=>$(ye,ie)],oe=new m.pointGeometry(0,0);let ue,ae,de;const he=(ie,ye,ge,Ce,Pe)=>{const ke=[[Ce?ge:ie,Ce?ie:ge,0],[Ce?ge:ye,Ce?ye:ge,0]],Le=Pe<0?m.EXTENT+Pe:Pe,$e=[Ce?Le:(ie+ye)/2,Ce?(ie+ye)/2:Le,0];return 0===ge&&Pe<0||0!==ge&&Pe>0?S.getForTilePoints(de,[$e],!0,ae):ke.push($e),S.getForTilePoints(f,ke,!0,ue),Math.max(ke[0][2],ke[1][2],$e[2])/S.exaggeration()};for(let ie=0;ie<4;ie++){const ye=(ie<2?1:5)-ie,ge=x.borders[ie];if(0===ge.length)continue;const Ce=de=k[ie](f),Pe=P(Ce);if(!(Pe&&Pe instanceof m.FillExtrusionBucket&&Pe.enableTerrain)||x.borderDoneWithNeighborZ[ie]===Pe.canonical.z&&Pe.borderDoneWithNeighborZ[ye]===x.canonical.z||(ae=S.findDEMTileFor(Ce),!ae||!ae.dem))continue;if(!ue){const nt=S.findDEMTileFor(f);if(!nt||!nt.dem)return;ue=nt}const ke=Pe.borders[ye];let Le=0;const $e=Pe.borderDoneWithNeighborZ[ye]!==x.canonical.z;if(x.canonical.z===Pe.canonical.z){for(let nt=0;nt<ge.length;nt++){const ot=x.featuresOnBorder[ge[nt]],zt=ot.borders[ie];let Ze;for(;Le<ke.length&&(Ze=Pe.featuresOnBorder[ke[Le]],!(Ze.borders[ye][1]>zt[0]+3));)$e&&Pe.encodeCentroid(void 0,Ze,!1),Le++;if(Ze&&Le<ke.length){const Ct=Le;let ut=0;for(;!(Ze.borders[ye][0]>zt[1]-3)&&(ut++,++Le!==ke.length);)Ze=Pe.featuresOnBorder[ke[Le]];if(Ze=Pe.featuresOnBorder[ke[Ct]],ot.intersectsCount()>1||Ze.intersectsCount()>1||1!==ut){1!==ut&&(Le=Ct),x.encodeCentroid(void 0,ot,!1),$e&&Pe.encodeCentroid(void 0,Ze,!1);continue}const kt=Q[ie](ot,Ze),it=ie%2?m.EXTENT-1:0;oe.x=he(kt[0],Math.min(m.EXTENT-1,kt[1]),it,ie<2,kt[2]),oe.y=0,x.encodeCentroid(oe,ot,!1),$e&&Pe.encodeCentroid(oe,Ze,!1)}else x.encodeCentroid(void 0,ot,!1)}x.borderDoneWithNeighborZ[ie]=Pe.canonical.z,x.needsCentroidUpdate=!0,$e&&(Pe.borderDoneWithNeighborZ[ye]=x.canonical.z,Pe.needsCentroidUpdate=!0)}else{for(const nt of ge)x.encodeCentroid(void 0,x.featuresOnBorder[nt],!1);if($e){for(const nt of ke)Pe.encodeCentroid(void 0,Pe.featuresOnBorder[nt],!1);Pe.borderDoneWithNeighborZ[ye]=x.canonical.z,Pe.needsCentroidUpdate=!0}x.borderDoneWithNeighborZ[ie]=Pe.canonical.z,x.needsCentroidUpdate=!0}}(x.needsCentroidUpdate||!x.centroidVertexBuffer&&0!==x.centroidVertexArray.length)&&x.uploadCentroid(y)}const br=new m.Color(1,0,0,1),Mc=new m.Color(0,1,0,1),Ic=new m.Color(0,0,1,1),ya=new m.Color(1,0,1,1),Bu=new m.Color(0,1,1,1);function np(y,d,f){const x=y.context,C=y.transform,S=x.gl,k="globe"===C.projection.name,P=k?["PROJECTION_GLOBE_VIEW"]:null;let L=f.projMatrix;if(k&&m.globeToMercatorTransition(C.zoom)>0){const ot=m.transitionTileAABBinECEF(f.canonical,C),zt=m.globeDenormalizeECEF(ot);L=m.multiply(new Float32Array(16),C.globeMatrix,zt),m.multiply(L,C.projMatrix,L)}const H=y.useProgram("debug",null,P),$=d.getTileByID(f.key);y.terrain&&y.terrain.setupElevationDraw($,H);const Q=m.DepthMode.disabled,oe=m.StencilMode.disabled,ue=y.colorModeForRenderPass();x.activeTexture.set(S.TEXTURE0),y.emptyTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),k?$._makeGlobeTileDebugBuffers(y.context,C):$._makeDebugTileBoundsBuffers(y.context,C.projection);const de=$._tileDebugBuffer||y.debugBuffer,he=$._tileDebugIndexBuffer||y.debugIndexBuffer,ie=$._tileDebugSegments||y.debugSegments;H.draw(x,S.LINE_STRIP,Q,oe,ue,m.CullFaceMode.disabled,Fu(L,m.Color.red),"$debug",de,he,ie,null,null,null,[$._globeTileDebugBorderBuffer]);const ye=$.latestRawTileData,ge=Math.floor((ye&&ye.byteLength||0)/1024),Ce=d.getTile(f).tileSize,Pe=512/Math.min(Ce,512)*(f.overscaledZ/C.zoom)*.5;let ke=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(ke+=` => ${f.overscaledZ}`),ke+=` ${ge}kb`,function(ot,zt){ot.initDebugOverlayCanvas();const Ze=ot.debugOverlayCanvas,Ct=ot.context.gl,ut=ot.debugOverlayCanvas.getContext("2d");ut.clearRect(0,0,Ze.width,Ze.height),ut.shadowColor="white",ut.shadowBlur=2,ut.lineWidth=1.5,ut.strokeStyle="white",ut.textBaseline="top",ut.font="bold 36px Open Sans, sans-serif",ut.fillText(zt,5,5),ut.strokeText(zt,5,5),ot.debugOverlayTexture.update(Ze),ot.debugOverlayTexture.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE)}(y,ke);const Le=$._tileDebugTextBuffer||y.debugBuffer,$e=$._tileDebugTextIndexBuffer||y.quadTriangleIndexBuffer,nt=$._tileDebugTextSegments||y.debugSegments;H.draw(x,S.TRIANGLES,Q,oe,m.ColorMode.alphaBlended,m.CullFaceMode.disabled,Fu(L,m.Color.transparent,Pe),"$debug",Le,$e,nt,null,null,null,[$._globeTileDebugTextBuffer])}function to(y,d,f,x){kc(y,0,d+f/2,y.transform.width,f,x)}function Gd(y,d,f,x){kc(y,d-f/2,0,f,y.transform.height,x)}function kc(y,d,f,x,C,S){const k=y.context,P=k.gl;P.enable(P.SCISSOR_TEST),P.scissor(d*m.exported.devicePixelRatio,f*m.exported.devicePixelRatio,x*m.exported.devicePixelRatio,C*m.exported.devicePixelRatio),k.clear({color:S}),P.disable(P.SCISSOR_TEST)}const Ac=m.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ml}=Ac;function Qs(y,d,f,x){y.emplaceBack(d,f,x)}class gl{constructor(d){this.vertexArray=new m.StructArrayLayout3f12,this.indices=new m.StructArrayLayout3ui6,Qs(this.vertexArray,-1,-1,1),Qs(this.vertexArray,1,-1,1),Qs(this.vertexArray,-1,1,1),Qs(this.vertexArray,1,1,1),Qs(this.vertexArray,-1,-1,-1),Qs(this.vertexArray,1,-1,-1),Qs(this.vertexArray,-1,1,-1),Qs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=d.createVertexBuffer(this.vertexArray,ml),this.indexBuffer=d.createIndexBuffer(this.indices),this.segment=m.SegmentVector.simpleSegment(0,0,36,12)}}function qn(y,d,f,x,C,S){const k=y.gl,P=d.paint.get("sky-atmosphere-color"),L=d.paint.get("sky-atmosphere-halo-color"),H=d.paint.get("sky-atmosphere-sun-intensity"),$={u_matrix_3f:m.fromMat4(m.create$1(),x),u_sun_direction:C,u_sun_intensity:H,u_color_tint_r:[(ae=P).r,ae.g,ae.b,ae.a],u_color_tint_m:[(de=L).r,de.g,de.b,de.a],u_luminance:5e-5};var ae,de;k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_CUBE_MAP_POSITIVE_X+S,d.skyboxTexture,0),f.draw(y,k.TRIANGLES,m.DepthMode.disabled,m.StencilMode.disabled,m.ColorMode.unblended,m.CullFaceMode.frontCW,$,"skyboxCapture",d.skyboxGeometry.vertexBuffer,d.skyboxGeometry.indexBuffer,d.skyboxGeometry.segment)}const Lf=m.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Fs{constructor(d){const f=new m.StructArrayLayout5f20;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const x=new m.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,3,0),this.vertexBuffer=d.createVertexBuffer(f,Lf.members),this.indexBuffer=d.createIndexBuffer(x),this.segments=m.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const zs={symbol:function(y,d,f,x,C){if("translucent"!==y.renderPass)return;const S=m.StencilMode.disabled,k=y.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(P,L,H,$,Q,oe,ue){const ae=L.transform,de="map"===Q,he="map"===oe;for(const ie of P){const ye=$.getTile(ie),ge=ye.getBucket(H);if(!ge||!ge.text||!ge.text.segments.get().length)continue;const Ce=m.evaluateSizeForZoom(ge.textSizeData,ae.zoom),Pe=Zi(ie,ge.getProjection(),ae),ke=ae.calculatePixelsToTileUnitsMatrix(ye),Le=Su(Pe,ye.tileID.canonical,he,de,ae,ge.getProjection(),ke),$e="none"!==H.layout.get("icon-text-fit")&&ge.hasIconData();if(Ce){const nt=Math.pow(2,ae.zoom-ye.tileID.overscaledZ);fl(ge,de,he,ue,m.symbolSize,ae,Le,ie,nt,Ce,$e)}}}(x,y,f,d,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),C),0!==f.paint.get("icon-opacity").constantOr(1)&&Ti(y,d,f,x,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),S,k),0!==f.paint.get("text-opacity").constantOr(1)&&Ti(y,d,f,x,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),S,k),d.map.showCollisionBoxes&&(Lr(y,d,f,x,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),Lr(y,d,f,x,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(y,d,f,x){if("translucent"!==y.renderPass)return;const C=f.paint.get("circle-opacity"),S=f.paint.get("circle-stroke-width"),k=f.paint.get("circle-stroke-opacity"),P=void 0!==f.layout.get("circle-sort-key").constantOr(1);if(0===C.constantOr(1)&&(0===S.constantOr(1)||0===k.constantOr(1)))return;const L=y.context,H=L.gl,$=y.transform,Q=y.depthModeForSublayer(0,m.DepthMode.ReadOnly),oe=m.StencilMode.disabled,ue=y.colorModeForRenderPass(),ae="globe"===$.projection.name,de=[m.mercatorXfromLng($.center.lng),m.mercatorYfromLat($.center.lat)],he=[];for(let ye=0;ye<x.length;ye++){const ge=x[ye],Ce=d.getTile(ge),Pe=Ce.getBucket(f);if(!Pe||Pe.projection.name!==$.projection.name)continue;const ke=Pe.programConfigurations.get(f.id),Le=on(f);ae&&Le.push("PROJECTION_GLOBE_VIEW");const $e=y.useProgram("circle",ke,Le),nt=Pe.layoutVertexBuffer,ot=Pe.globeExtVertexBuffer,zt=Pe.indexBuffer,Ze=$.projection.createInversionMatrix($,ge.canonical),Ct={programConfiguration:ke,program:$e,layoutVertexBuffer:nt,globeExtVertexBuffer:ot,indexBuffer:zt,uniformValues:Hd(y,ge,Ce,Ze,de,f),tile:Ce};if(P){const ut=Pe.segments.get();for(const kt of ut)he.push({segments:new m.SegmentVector([kt]),sortKey:kt.sortKey,state:Ct})}else he.push({segments:Pe.segments,sortKey:0,state:Ct})}P&&he.sort((ye,ge)=>ye.sortKey-ge.sortKey);const ie={useDepthForOcclusion:!ae};for(const ye of he){const{programConfiguration:ge,program:Ce,layoutVertexBuffer:Pe,globeExtVertexBuffer:ke,indexBuffer:Le,uniformValues:$e,tile:nt}=ye.state,ot=ye.segments;y.terrain&&y.terrain.setupElevationDraw(nt,Ce,ie),y.prepareDrawProgram(L,Ce,nt.tileID.toUnwrapped()),Ce.draw(L,H.TRIANGLES,Q,oe,ue,m.CullFaceMode.disabled,$e,f.id,Pe,Le,ot,f.paint,$.zoom,ge,[ke])}},heatmap:function(y,d,f,x){if(0!==f.paint.get("heatmap-opacity"))if("offscreen"===y.renderPass){const C=y.context,S=C.gl,k=m.StencilMode.disabled,P=new m.ColorMode([S.ONE,S.ONE],m.Color.transparent,[!0,!0,!0,!0]);(function(ue,ae,de,he){const ie=ue.gl,ye=ae.width*he,ge=ae.height*he;ue.activeTexture.set(ie.TEXTURE1),ue.viewport.set([0,0,ye,ge]);let Ce=de.heatmapFbo;if(!Ce||Ce&&(Ce.width!==ye||Ce.height!==ge)){Ce&&Ce.destroy();const Pe=ie.createTexture();ie.bindTexture(ie.TEXTURE_2D,Pe),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_S,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_T,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MIN_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MAG_FILTER,ie.LINEAR),Ce=de.heatmapFbo=ue.createFramebuffer(ye,ge,!1),function(ke,Le,$e,nt,ot,zt){const Ze=ke.gl;Ze.texImage2D(Ze.TEXTURE_2D,0,ke.isWebGL2&&ke.extRenderToTextureHalfFloat?Ze.RGBA16F:Ze.RGBA,ot,zt,0,Ze.RGBA,ke.extRenderToTextureHalfFloat?ke.isWebGL2?Ze.HALF_FLOAT:ke.extTextureHalfFloat.HALF_FLOAT_OES:Ze.UNSIGNED_BYTE,null),nt.colorAttachment.set($e)}(ue,0,Pe,Ce,ye,ge)}else ie.bindTexture(ie.TEXTURE_2D,Ce.colorAttachment.get()),ue.bindFramebuffer.set(Ce.framebuffer)})(C,y,f,"globe"===y.transform.projection.name?.5:.25),C.clear({color:m.Color.transparent});const L=y.transform,H="globe"===L.projection.name,$=H?["PROJECTION_GLOBE_VIEW"]:null,Q=H?m.CullFaceMode.frontCCW:m.CullFaceMode.disabled,oe=[m.mercatorXfromLng(L.center.lng),m.mercatorYfromLat(L.center.lat)];for(let ue=0;ue<x.length;ue++){const ae=x[ue];if(d.hasRenderableParent(ae))continue;const de=d.getTile(ae),he=de.getBucket(f);if(!he||he.projection.name!==L.projection.name)continue;const ie=he.programConfigurations.get(f.id),ye=y.useProgram("heatmap",ie,$),{zoom:ge}=y.transform;y.terrain&&y.terrain.setupElevationDraw(de,ye),y.prepareDrawProgram(C,ye,ae.toUnwrapped());const Ce=L.projection.createInversionMatrix(L,ae.canonical);ye.draw(C,S.TRIANGLES,m.DepthMode.disabled,k,P,Q,fn(y,ae,de,Ce,oe,ge,f.paint.get("heatmap-intensity")),f.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,f.paint,y.transform.zoom,ie,H?[he.globeExtVertexBuffer]:null)}C.viewport.set([0,0,y.width,y.height])}else"translucent"===y.renderPass&&(y.context.setColorMode(y.colorModeForRenderPass()),function(C,S){const k=C.context,P=k.gl,L=S.heatmapFbo;if(!L)return;k.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,L.colorAttachment.get()),k.activeTexture.set(P.TEXTURE1);let H=S.colorRampTexture;H||(H=S.colorRampTexture=new m.Texture(k,S.colorRamp,P.RGBA)),H.bind(P.LINEAR,P.CLAMP_TO_EDGE),C.useProgram("heatmapTexture").draw(k,P.TRIANGLES,m.DepthMode.disabled,m.StencilMode.disabled,C.colorModeForRenderPass(),m.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:S.paint.get("heatmap-opacity")},S.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,S.paint,C.transform.zoom)}(y,f))},line:function(y,d,f,x){if("translucent"!==y.renderPass)return;const C=f.paint.get("line-opacity"),S=f.paint.get("line-width");if(0===C.constantOr(1)||0===S.constantOr(1))return;const k=y.depthModeForSublayer(0,m.DepthMode.ReadOnly),P=y.colorModeForRenderPass(),L=y.terrain&&y.terrain.renderingToTexture?1:m.exported.devicePixelRatio,H=f.paint.get("line-dasharray"),$=H.constantOr(1),Q=f.layout.get("line-cap"),oe=f.paint.get("line-pattern"),ue=oe.constantOr(1),ae=f.paint.get("line-gradient"),de=ue?"linePattern":"line",he=y.context,ie=he.gl,ye=(Ce=>{const Pe=[];Ki(Ce)&&Pe.push("RENDER_LINE_DASH"),Ce.paint.get("line-gradient")&&Pe.push("RENDER_LINE_GRADIENT");const ke=Ce.paint.get("line-trim-offset");0===ke[0]&&0===ke[1]||Pe.push("RENDER_LINE_TRIM_OFFSET");const Le=Ce.paint.get("line-pattern").constantOr(1),$e=1!==Ce.paint.get("line-opacity").constantOr(1);return!Le&&$e&&Pe.push("RENDER_LINE_ALPHA_DISCARD"),Pe})(f);let ge=ye.includes("RENDER_LINE_ALPHA_DISCARD");y.terrain&&y.terrain.clipOrMaskOverlapStencilType()&&(ge=!1);for(const Ce of x){const Pe=d.getTile(Ce);if(ue&&!Pe.patternsLoaded())continue;const ke=Pe.getBucket(f);if(!ke)continue;y.prepareDrawTile();const Le=ke.programConfigurations.get(f.id),$e=y.useProgram(de,Le,ye),nt=oe.constantOr(null);if(nt&&Pe.imageAtlas){const je=Pe.imageAtlas.patternPositions[nt.toString()];je&&Le.setConstantPatternPositions(je)}const ot=H.constantOr(null),zt=Q.constantOr(null);if(!ue&&ot&&zt&&Pe.lineAtlas){const je=Pe.lineAtlas.getDash(ot,zt);je&&Le.setConstantPatternPositions(je)}let[Ze,Ct]=f.paint.get("line-trim-offset");("round"===zt||"square"===zt)&&Ze!==Ct&&(0===Ze&&(Ze-=1),1===Ct&&(Ct+=1));const ut=y.terrain?Ce.projMatrix:null,kt=ue?Rf(y,Pe,f,ut,L):Of(y,Pe,f,ut,ke.lineClipsArray.length,L,[Ze,Ct]);if(ae){const je=ke.gradients[f.id];let lt=je.texture;if(f.gradientVersion!==je.version){let Mt=256;if(f.stepInterpolant){const Pt=d.getSource().maxzoom,hn=Ce.canonical.z===Pt?Math.ceil(1<<y.transform.maxZoom-Ce.canonical.z):1;Mt=m.clamp(m.nextPowerOfTwo(ke.maxLineLength/m.EXTENT*1024*hn),256,he.maxTextureSize)}je.gradient=m.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:Mt,image:je.gradient||void 0,clips:ke.lineClipsArray}),je.texture?je.texture.update(je.gradient):je.texture=new m.Texture(he,je.gradient,ie.RGBA),je.version=f.gradientVersion,lt=je.texture}he.activeTexture.set(ie.TEXTURE1),lt.bind(f.stepInterpolant?ie.NEAREST:ie.LINEAR,ie.CLAMP_TO_EDGE)}$&&(he.activeTexture.set(ie.TEXTURE0),Pe.lineAtlasTexture.bind(ie.LINEAR,ie.REPEAT),Le.updatePaintBuffers()),ue&&(he.activeTexture.set(ie.TEXTURE0),Pe.imageAtlasTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),Le.updatePaintBuffers()),y.prepareDrawProgram(he,$e,Ce.toUnwrapped());const it=je=>{$e.draw(he,ie.TRIANGLES,k,je,P,m.CullFaceMode.disabled,kt,f.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,f.paint,y.transform.zoom,Le,[ke.layoutVertexBuffer2])};if(ge){const je=y.stencilModeForClipping(Ce).ref;0===je&&y.terrain&&he.clear({stencil:0});const lt={func:ie.EQUAL,mask:255};kt.u_alpha_discard_threshold=.8,it(new m.StencilMode(lt,je,255,ie.KEEP,ie.KEEP,ie.INVERT)),kt.u_alpha_discard_threshold=0,it(new m.StencilMode(lt,je,255,ie.KEEP,ie.KEEP,ie.KEEP))}else it(y.stencilModeForClipping(Ce))}ge&&(y.resetStencilClippingMasks(),y.terrain&&he.clear({stencil:0}))},fill:function(y,d,f,x){const C=f.paint.get("fill-color"),S=f.paint.get("fill-opacity");if(0===S.constantOr(1))return;const k=y.colorModeForRenderPass(),P=f.paint.get("fill-pattern"),L=y.opaquePassEnabledForLayer()&&!P.constantOr(1)&&1===C.constantOr(m.Color.transparent).a&&1===S.constantOr(0)?"opaque":"translucent";if(y.renderPass===L){const H=y.depthModeForSublayer(1,"opaque"===y.renderPass?m.DepthMode.ReadWrite:m.DepthMode.ReadOnly);zu(y,d,f,x,H,k,!1)}if("translucent"===y.renderPass&&f.paint.get("fill-antialias")){const H=y.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,m.DepthMode.ReadOnly);zu(y,d,f,x,H,k,!0)}},"fill-extrusion":function(y,d,f,x){const C=f.paint.get("fill-extrusion-opacity");if(0!==C&&"translucent"===y.renderPass){const S=new m.DepthMode(y.context.gl.LEQUAL,m.DepthMode.ReadWrite,y.depthRangeFor3D);if(1!==C||f.paint.get("fill-extrusion-pattern").constantOr(1))tp(y,d,f,x,S,m.StencilMode.disabled,m.ColorMode.disabled),tp(y,d,f,x,S,y.stencilModeFor3D(),y.colorModeForRenderPass()),y.resetStencilClippingMasks();else{const k=y.colorModeForRenderPass();tp(y,d,f,x,S,m.StencilMode.disabled,k)}}},hillshade:function(y,d,f,x){if("offscreen"!==y.renderPass&&"translucent"!==y.renderPass)return;const C=y.context,S=y.depthModeForSublayer(0,m.DepthMode.ReadOnly),k=y.colorModeForRenderPass(),P=y.terrain&&y.terrain.renderingToTexture,[L,H]="translucent"!==y.renderPass||P?[{},x]:y.stencilConfigForOverlap(x);for(const $ of H){const Q=d.getTile($);if(Q.needsHillshadePrepare&&"offscreen"===y.renderPass)Yh(y,Q,f,S,m.StencilMode.disabled,k);else if("translucent"===y.renderPass){const oe=P&&y.terrain?y.terrain.stencilModeForRTTOverlap($):L[$.overscaledZ];Bd(y,$,Q,f,S,oe,k)}}C.viewport.set([0,0,y.width,y.height]),y.resetStencilClippingMasks()},raster:function(y,d,f,x,C,S){if("translucent"!==y.renderPass||0===f.paint.get("raster-opacity")||!x.length)return;const k=y.context,P=k.gl,L=d.getSource(),H=y.useProgram("raster"),$=y.colorModeForRenderPass(),Q=y.terrain&&y.terrain.renderingToTexture,[oe,ue]=L instanceof Re||Q?[{},x]:y.stencilConfigForOverlap(x),ae=ue[ue.length-1].overscaledZ,de=!y.options.moving;for(const he of ue){const ie=Q?m.DepthMode.disabled:y.depthModeForSublayer(he.overscaledZ-ae,1===f.paint.get("raster-opacity")?m.DepthMode.ReadWrite:m.DepthMode.ReadOnly,P.LESS),ye=he.toUnwrapped(),ge=d.getTile(he);if(Q&&(!ge||!ge.hasData()))continue;const Ce=Q?he.projMatrix:y.transform.calculateProjMatrix(ye,de),Pe=y.terrain&&Q?y.terrain.stencilModeForRTTOverlap(he):oe[he.overscaledZ],ke=S?0:f.paint.get("raster-fade-duration");ge.registerFadeDuration(ke);const Le=d.findLoadedParent(he,0),$e=hl(ge,Le,d,y.transform,ke);let nt,ot;y.terrain&&y.terrain.prepareDrawTile();const zt="nearest"===f.paint.get("raster-resampling")?P.NEAREST:P.LINEAR;k.activeTexture.set(P.TEXTURE0),ge.texture.bind(zt,P.CLAMP_TO_EDGE),k.activeTexture.set(P.TEXTURE1),Le?(Le.texture.bind(zt,P.CLAMP_TO_EDGE),nt=Math.pow(2,Le.tileID.overscaledZ-ge.tileID.overscaledZ),ot=[ge.tileID.canonical.x*nt%1,ge.tileID.canonical.y*nt%1]):ge.texture.bind(zt,P.CLAMP_TO_EDGE);const Ze=Xr(Ce,ot||[0,0],nt||1,$e,f,L instanceof Re?L.perspectiveTransform:[0,0]);if(y.prepareDrawProgram(k,H,ye),L instanceof Re)L.boundsBuffer&&L.boundsSegments&&H.draw(k,P.TRIANGLES,ie,m.StencilMode.disabled,$,m.CullFaceMode.disabled,Ze,f.id,L.boundsBuffer,y.quadTriangleIndexBuffer,L.boundsSegments);else{const{tileBoundsBuffer:Ct,tileBoundsIndexBuffer:ut,tileBoundsSegments:kt}=y.getTileBoundsBuffers(ge);H.draw(k,P.TRIANGLES,ie,Pe,$,m.CullFaceMode.disabled,Ze,f.id,Ct,ut,kt)}}y.resetStencilClippingMasks()},background:function(y,d,f,x){const C=f.paint.get("background-color"),S=f.paint.get("background-opacity");if(0===S)return;const k=y.context,P=k.gl,L=y.transform,H=L.tileSize,$=f.paint.get("background-pattern");if(y.isPatternMissing($))return;const Q=!$&&1===C.a&&1===S&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==Q)return;const oe=m.StencilMode.disabled,ue=y.depthModeForSublayer(0,"opaque"===Q?m.DepthMode.ReadWrite:m.DepthMode.ReadOnly),ae=y.colorModeForRenderPass(),de=y.useProgram($?"backgroundPattern":"background");let he,ie=x;ie||(he=y.getBackgroundTiles(),ie=Object.values(he).map(ye=>ye.tileID)),$&&(k.activeTexture.set(P.TEXTURE0),y.imageManager.bind(y.context));for(const ye of ie){const ge=ye.toUnwrapped(),Ce=x?ye.projMatrix:y.transform.calculateProjMatrix(ge);y.prepareDrawTile();const Pe=d?d.getTile(ye):he?he[ye.key]:new m.Tile(ye,H,L.zoom,y),ke=$?Fo(Ce,S,y,$,{tileID:ye,tileSize:H}):Ci(Ce,S,C);y.prepareDrawProgram(k,de,ge);const{tileBoundsBuffer:Le,tileBoundsIndexBuffer:$e,tileBoundsSegments:nt}=y.getTileBoundsBuffers(Pe);de.draw(k,P.TRIANGLES,ue,oe,ae,m.CullFaceMode.disabled,ke,f.id,Le,$e,nt)}},sky:function(y,d,f){const x=y.transform,C="mercator"===x.projection.name||"globe"===x.projection.name?1:m.smoothstep(7,8,x.zoom),S=f.paint.get("sky-opacity")*C;if(0===S)return;const k=y.context,P=f.paint.get("sky-type"),L=new m.DepthMode(k.gl.LEQUAL,m.DepthMode.ReadOnly,[0,1]),H=y.frameCounter/1e3%1;"atmosphere"===P?"offscreen"===y.renderPass?f.needsSkyboxCapture(y)&&(function($,Q,oe,ue){const ae=$.context,de=ae.gl;let he=Q.skyboxFbo;if(!he){he=Q.skyboxFbo=ae.createFramebuffer(32,32,!1),Q.skyboxGeometry=new gl(ae),Q.skyboxTexture=ae.gl.createTexture(),de.bindTexture(de.TEXTURE_CUBE_MAP,Q.skyboxTexture),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MAG_FILTER,de.LINEAR);for(let Ce=0;Ce<6;++Ce)de.texImage2D(de.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,de.RGBA,32,32,0,de.RGBA,de.UNSIGNED_BYTE,null)}ae.bindFramebuffer.set(he.framebuffer),ae.viewport.set([0,0,32,32]);const ie=Q.getCenter($,!0),ye=$.useProgram("skyboxCapture"),ge=new Float64Array(16);m.identity(ge),m.rotateY(ge,ge,.5*-Math.PI),qn(ae,Q,ye,ge,ie,0),m.identity(ge),m.rotateY(ge,ge,.5*Math.PI),qn(ae,Q,ye,ge,ie,1),m.identity(ge),m.rotateX(ge,ge,.5*-Math.PI),qn(ae,Q,ye,ge,ie,2),m.identity(ge),m.rotateX(ge,ge,.5*Math.PI),qn(ae,Q,ye,ge,ie,3),m.identity(ge),qn(ae,Q,ye,ge,ie,4),m.identity(ge),m.rotateY(ge,ge,Math.PI),qn(ae,Q,ye,ge,ie,5),ae.viewport.set([0,0,$.width,$.height])}(y,f),f.markSkyboxValid(y)):"sky"===y.renderPass&&function($,Q,oe,ue,ae){const de=$.context,he=de.gl,ie=$.transform,ye=$.useProgram("skybox");de.activeTexture.set(he.TEXTURE0),he.bindTexture(he.TEXTURE_CUBE_MAP,Q.skyboxTexture);const ge={u_matrix:ie.skyboxMatrix,u_sun_direction:Q.getCenter($,!1),u_cubemap:0,u_opacity:ue,u_temporal_offset:ae};$.prepareDrawProgram(de,ye),ye.draw(de,he.TRIANGLES,oe,m.StencilMode.disabled,$.colorModeForRenderPass(),m.CullFaceMode.backCW,ge,"skybox",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(y,f,L,S,H):"gradient"===P&&"sky"===y.renderPass&&function($,Q,oe,ue,ae){const de=$.context,he=de.gl,ie=$.transform,ye=$.useProgram("skyboxGradient");Q.skyboxGeometry||(Q.skyboxGeometry=new gl(de)),de.activeTexture.set(he.TEXTURE0);let ge=Q.colorRampTexture;ge||(ge=Q.colorRampTexture=new m.Texture(de,Q.colorRamp,he.RGBA)),ge.bind(he.LINEAR,he.CLAMP_TO_EDGE);const Ce=(Pe=ie.skyboxMatrix,ke=Q.getCenter($,!1),Le=Q.paint.get("sky-gradient-radius"),$e=ue,nt=ae,{u_matrix:Pe,u_color_ramp:0,u_center_direction:ke,u_radius:m.degToRad(Le),u_opacity:$e,u_temporal_offset:nt});var Pe,ke,Le,$e,nt;$.prepareDrawProgram(de,ye),ye.draw(de,he.TRIANGLES,oe,m.StencilMode.disabled,$.colorModeForRenderPass(),m.CullFaceMode.backCW,Ce,"skyboxGradient",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(y,f,L,S,H)},debug:function(y,d,f){for(let x=0;x<f.length;x++)np(y,d,f[x])},custom:function(y,d,f,x){const C=y.context,S=f.implementation;if(!y.transform.projection.unsupportedLayers||!y.transform.projection.unsupportedLayers.includes("custom")||y.terrain&&(y.terrain.renderingToTexture||"offscreen"===y.renderPass)&&f.isLayerDraped()){if("offscreen"===y.renderPass){const k=S.prerender;if(k){if(y.setCustomLayerDefaults(),C.setColorMode(y.colorModeForRenderPass()),"globe"===y.transform.projection.name){const P=y.transform.pointMerc;k.call(S,C.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),m.globeToMercatorTransition(y.transform.zoom),[P.x,P.y],y.transform.pixelsPerMeterRatio)}else k.call(S,C.gl,y.transform.customLayerMatrix());C.setDirty(),y.setBaseState()}}else if("translucent"===y.renderPass){if(y.terrain&&y.terrain.renderingToTexture){const P=S.renderToTile;if(P){const L=x[0].canonical,H=new m.MercatorCoordinate(L.x+x[0].wrap*(1<<L.z),L.y,L.z);C.setDepthMode(m.DepthMode.disabled),C.setStencilMode(m.StencilMode.disabled),C.setColorMode(y.colorModeForRenderPass()),y.setCustomLayerDefaults(),P.call(S,C.gl,H),C.setDirty(),y.setBaseState()}return}y.setCustomLayerDefaults(),C.setColorMode(y.colorModeForRenderPass()),C.setStencilMode(m.StencilMode.disabled);const k="3d"===S.renderingMode?new m.DepthMode(y.context.gl.LEQUAL,m.DepthMode.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,m.DepthMode.ReadOnly);if(C.setDepthMode(k),"globe"===y.transform.projection.name){const P=y.transform.pointMerc;S.render(C.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),m.globeToMercatorTransition(y.transform.zoom),[P.x,P.y],y.transform.pixelsPerMeterRatio)}else S.render(C.gl,y.transform.customLayerMatrix());C.setDirty(),y.setBaseState(),C.bindFramebuffer.set(null)}}else m.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Pc{constructor(d,f,x=!1){this.context=new me(d,x),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=m.SourceCache.maxUnderzooming+m.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new zd,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(d,f){const x=!!d&&!!d.terrain&&this.transform.projection.supportsTerrain;if(!(x||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ja(this,d));const C=this._terrain;this.transform.elevation=x?C:null,C.update(d,this.transform,f)}_updateFog(d){const f=d.fog;if(!f||"globe"===this.transform.projection.name||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[x,C]=f.getFovAdjustedRange(this.transform._fov);if(x>C)return void(this.transform.fogCullDistSq=null);const S=x+.78*(C-x);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(d,f){if(this.width=d*m.exported.devicePixelRatio,this.height=f*m.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style.order)this.style._layers[x].resize()}setup(){const d=this.context,f=new m.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(m.EXTENT,0),f.emplaceBack(0,m.EXTENT),f.emplaceBack(m.EXTENT,m.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(f,m.posAttributes.members),this.tileExtentSegments=m.SegmentVector.simpleSegment(0,0,4,2);const x=new m.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(m.EXTENT,0),x.emplaceBack(0,m.EXTENT),x.emplaceBack(m.EXTENT,m.EXTENT),this.debugBuffer=d.createVertexBuffer(x,m.posAttributes.members),this.debugSegments=m.SegmentVector.simpleSegment(0,0,4,5);const C=new m.StructArrayLayout2i4;C.emplaceBack(-1,-1),C.emplaceBack(1,-1),C.emplaceBack(-1,1),C.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(C,m.posAttributes.members),this.viewportSegments=m.SegmentVector.simpleSegment(0,0,4,2);const S=new m.StructArrayLayout4i8;S.emplaceBack(0,0,0,0),S.emplaceBack(m.EXTENT,0,m.EXTENT,0),S.emplaceBack(0,m.EXTENT,0,m.EXTENT),S.emplaceBack(m.EXTENT,m.EXTENT,m.EXTENT,m.EXTENT),this.mercatorBoundsBuffer=d.createVertexBuffer(S,m.boundsAttributes.members),this.mercatorBoundsSegments=m.SegmentVector.simpleSegment(0,0,4,2);const k=new m.StructArrayLayout3ui6;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(k);const P=new m.StructArrayLayout1ui2;for(const H of[0,1,3,2,0])P.emplaceBack(H);this.debugIndexBuffer=d.createIndexBuffer(P),this.emptyTexture=new m.Texture(d,new m.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),d.gl.RGBA),this.identityMat=m.create();const L=this.context.gl;this.stencilClearMode=new m.StencilMode({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.loadTimeStamps.push(m.window.performance.now()),this.atmosphereBuffer=new Fs(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(d){return d._makeTileBoundsBuffers(this.context,this.transform.projection),d._tileBoundsBuffer?{tileBoundsBuffer:d._tileBoundsBuffer,tileBoundsIndexBuffer:d._tileBoundsIndexBuffer,tileBoundsSegments:d._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const d=this.context,f=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(d,f.TRIANGLES,m.DepthMode.disabled,this.stencilClearMode,m.ColorMode.disabled,m.CullFaceMode.disabled,Si(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(d,f,x){if(!f||this.currentStencilSource===f.id||!d.isTileClipped()||!x||0===x.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let P=!1;for(const L of x)if(void 0===this._tileClippingMaskIDs[L.key]){P=!0;break}if(!P)return}this.currentStencilSource=f.id;const C=this.context,S=C.gl;this.nextStencilID+x.length>256&&this.clearStencil(),C.setColorMode(m.ColorMode.disabled),C.setDepthMode(m.DepthMode.disabled);const k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of x){const L=f.getTile(P),H=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:Q,tileBoundsSegments:oe}=this.getTileBoundsBuffers(L);k.draw(C,S.TRIANGLES,m.DepthMode.disabled,new m.StencilMode({func:S.ALWAYS,mask:0},H,255,S.KEEP,S.KEEP,S.REPLACE),m.ColorMode.disabled,m.CullFaceMode.disabled,Si(P.projMatrix),"$clipping",$,Q,oe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const d=this.nextStencilID++,f=this.context.gl;return new m.StencilMode({func:f.NOTEQUAL,mask:255},d,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(d){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(d);const f=this.context.gl;return new m.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(d){const f=this.context.gl,x=d.sort((k,P)=>P.overscaledZ-k.overscaledZ),C=x[x.length-1].overscaledZ,S=x[0].overscaledZ-C+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const k={};for(let P=0;P<S;P++)k[P+C]=new m.StencilMode({func:f.GEQUAL,mask:255},P+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=S,[k,x]}return[{[C]:m.StencilMode.disabled},x]}colorModeForRenderPass(){const d=this.context.gl;return this._showOverdrawInspector?new m.ColorMode([d.CONSTANT_COLOR,d.ONE],new m.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?m.ColorMode.unblended:m.ColorMode.alphaBlended}depthModeForSublayer(d,f,x){if(!this.opaquePassEnabledForLayer())return m.DepthMode.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new m.DepthMode(x||this.context.gl.LEQUAL,f,[C,C])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(d,f){this.style=d,this.options=f,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(m.exported.now()),this.imageManager.beginFrame();const x=this.style.order,C=this.style._sourceCaches;for(const L in C){const H=C[L];H.used&&H.prepare(this.context)}const S={},k={},P={};for(const L in C){const H=C[L];S[L]=H.getVisibleCoordinates(),k[L]=S[L].slice().reverse(),P[L]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<x.length;L++)if(this.style._layers[x[L]].is3D()){this.opaquePassCutoff=L;break}if(this.terrain&&(this.terrain.updateTileBinding(P),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new m.GlobeSharedBuffers(this.context)),m.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const L of x){const H=this.style._layers[L],$=d._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const Q=$?k[$.id]:void 0;("custom"===H.type||H.isSky()||Q&&Q.length)&&this.renderLayer(this,$,H,Q)}if(this.depthRangeFor3D=[0,1-(d.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:f.showOverdrawInspector?m.Color.black:m.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[x[this.currentLayer]],H=d._getLayerSourceCache(L);if(L.isSky())continue;const $=H?k[H.id]:void 0;this._renderTileClippingMasks(L,H,$),this.renderLayer(this,H,L,$)}if(this.style.fog&&this.transform.projection.supportsFog&&function(L,H){const $=L.context,Q=$.gl,oe=L.transform,ue=new m.DepthMode(Q.LEQUAL,m.DepthMode.ReadOnly,[0,1]),ae=L.useProgram("globeAtmosphere",null,"globe"===oe.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),de=m.globeToMercatorTransition(oe.zoom),he=H.properties.get("color").toArray01(),ie=H.properties.get("high-color").toArray01(),ye=H.properties.get("space-color").toArray01PremultipliedAlpha(),ge=m.identity$1([]);m.rotateY$1(ge,ge,-m.degToRad(oe._center.lng)),m.rotateX$1(ge,ge,m.degToRad(oe._center.lat)),m.rotateZ$1(ge,ge,oe.angle),m.rotateX$1(ge,ge,-oe._pitch);const Ce=m.fromQuat(new Float32Array(16),ge),Pe=m.mapValue(H.properties.get("star-intensity"),0,1,0,.25),Le=m.mapValue(H.properties.get("horizon-blend"),0,1,5e-4,.25),$e=m.globeUseCustomAntiAliasing(L,$,oe)&&5e-4===Le?oe.worldSize/(2*Math.PI*1.025)-1:oe.globeRadius,nt=L.frameCounter/1e3%1,ot=m.length(oe.globeCenterInViewSpace),zt=Math.sqrt(Math.pow(ot,2)-Math.pow($e,2)),Ze=Math.acos(zt/ot),Ct={u_frustum_tl:oe.frustumCorners.TL,u_frustum_tr:oe.frustumCorners.TR,u_frustum_br:oe.frustumCorners.BR,u_frustum_bl:oe.frustumCorners.BL,u_horizon:oe.frustumCorners.horizon,u_transition:de,u_fadeout_range:Le,u_color:he,u_high_color:ie,u_space_color:ye,u_star_intensity:Pe,u_star_size:5*m.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:nt,u_horizon_angle:Ze,u_rotation_matrix:Ce};L.prepareDrawProgram($,ae);const ut=L.atmosphereBuffer;ut&&ae.draw($,Q.TRIANGLES,ue,m.StencilMode.disabled,m.ColorMode.alphaBlended,m.CullFaceMode.backCW,Ct,"skybox",ut.vertexBuffer,ut.indexBuffer,ut.segments)}(this,this.style.fog),this.renderPass="sky",(m.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const L=this.style._layers[x[this.currentLayer]],H=d._getLayerSourceCache(L);L.isSky()&&this.renderLayer(this,H,L,H?k[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;){const L=this.style._layers[x[this.currentLayer]],H=d._getLayerSourceCache(L);if(L.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(L)){if(L.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const $=H?("symbol"===L.type?P:k)[H.id]:void 0;this._renderTileClippingMasks(L,H,H?S[H.id]:void 0),this.renderLayer(this,H,L,$),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let L=null;m.values(this.style._layers).forEach(H=>{const $=d._getLayerSourceCache(H);$&&!H.isHidden(this.transform.zoom)&&(!L||L.getSource().maxzoom<$.getSource().maxzoom)&&(L=$)}),L&&this.options.showTileBoundaries&&zs.debug(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const H=L.transform.padding;to(L,L.transform.height-(H.top||0),3,br),to(L,H.bottom||0,3,Mc),Gd(L,H.left||0,3,Ic),Gd(L,L.transform.width-(H.right||0),3,ya);const $=L.transform.centerPoint;var Q,oe,ue,ae;kc(Q=L,(oe=$.x)-1,(ue=L.transform.height-$.y)-10,2,20,ae=Bu),kc(Q,oe-10,ue-1,20,2,ae)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(m.window.performance.now()),this.saveCanvasCopy())}}renderLayer(d,f,x,C){x.isHidden(this.transform.zoom)||("background"===x.type||"sky"===x.type||"custom"===x.type||C&&C.length)&&(this.id=x.id,this.gpuTimingStart(x),(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes(x.type)||d.terrain&&"custom"===x.type)&&zs[x.type](d,f,x,C,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(d){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let x=this.gpuTimers[d.id];x||(x=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),x.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const d=this.context.extTimerQuery,f=d.createQueryEXT();this.deferredRenderGpuTimeQueries.push(f),d.beginQueryEXT(d.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}collectGpuTimers(){const d=this.gpuTimers;return this.gpuTimers={},d}collectDeferredRenderGpuQueries(){const d=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],d}queryGpuTimers(d){const f={};for(const x in d){const C=d[x],S=this.context.extTimerQuery,k=S.getQueryObjectEXT(C.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(C.query),f[x]=k}return f}queryGpuTimeDeferredRender(d){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery;let x=0;for(const C of d)x+=f.getQueryObjectEXT(C,f.QUERY_RESULT_EXT)/1e6,f.deleteQueryEXT(C);return x}translatePosMatrix(d,f,x,C,S){if(!x[0]&&!x[1])return d;const k=S?"map"===C?this.transform.angle:0:"viewport"===C?-this.transform.angle:0;if(k){const H=Math.sin(k),$=Math.cos(k);x=[x[0]*$-x[1]*H,x[0]*H+x[1]*$]}const P=[S?x[0]:ss(f,x[0],this.transform.zoom),S?x[1]:ss(f,x[1],this.transform.zoom),0],L=new Float32Array(16);return m.translate(L,d,P),L}saveTileTexture(d){const f=this._tileTextures[d.size[0]];f?f.push(d):this._tileTextures[d.size[0]]=[d]}getTileTexture(d){const f=this._tileTextures[d];return f&&f.length>0?f.pop():null}isPatternMissing(d){return null===d||void 0!==d&&!this.imageManager.getPattern(d.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const d=this.terrain&&this.terrain.renderingToTexture,f=this.terrain&&0===this.terrain.exaggeration(),x=this.style&&this.style.fog,C=[];return this.terrainRenderModeElevated()&&C.push("TERRAIN"),"globe"===this.transform.projection.name&&C.push("GLOBE"),f&&C.push("ZERO_EXAGGERATION"),x&&!d&&0!==x.getOpacity(this.transform.pitch)&&C.push("FOG"),d&&C.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&C.push("OVERDRAW_INSPECTOR"),C}useProgram(d,f,x){this.cache=this.cache||{};const C=x||[],S=this.currentGlobalDefines().concat(C),k=Xs.cacheKey(Tg[d],d,S,f);return this.cache[k]||(this.cache[k]=new Xs(this.context,d,Tg[d],f,_a[d],S)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=m.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new m.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(d,f,x){if(this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const S=C.getOpacity(this.transform.pitch),k=((P,L,H,$,Q,oe,ue,ae,de,he,ie)=>{const ye=P.transform,ge=L.properties.get("color").toArray01();ge[3]=$;const Ce=P.frameCounter/1e3%1;return{u_fog_matrix:H?ye.calculateFogTileMatrix(H):P.identityMat,u_fog_range:L.getFovAdjustedRange(ye._fov),u_fog_color:ge,u_fog_horizon_blend:L.properties.get("horizon-blend"),u_fog_temporal_offset:Ce,u_frustum_tl:Q,u_frustum_tr:oe,u_frustum_br:ue,u_frustum_bl:ae,u_globe_pos:de,u_globe_radius:he,u_viewport:ie,u_globe_transition:m.globeToMercatorTransition(ye.zoom),u_is_globe:+("globe"===ye.projection.name)}})(this,C,x,S,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*m.exported.devicePixelRatio,this.transform.height*m.exported.devicePixelRatio]);f.setFogUniformValues(d,k)}}setTileLoadedFlag(d){this.tileLoaded=d}saveCanvasCopy(){const d=this.canvasCopy();d&&(this.frameCopies.push(d),this.tileLoaded=!1)}canvasCopy(){const d=this.context.gl,f=d.createTexture();return d.bindTexture(d.TEXTURE_2D,f),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,0,0,d.drawingBufferWidth,d.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const d=this.style&&this.style.fog;return!!d&&0!==d.getOpacity(this.transform.pitch)}getBackgroundTiles(){const d=this._backgroundTiles,f=this._backgroundTiles={},x=this.transform.coveringTiles({tileSize:512});for(const C of x)f[C.key]=d[C.key]||new m.Tile(C,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class Oc{constructor(d=0,f=0,x=0,C=0){if(isNaN(d)||d<0||isNaN(f)||f<0||isNaN(x)||x<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=f,this.left=x,this.right=C}interpolate(d,f,x){return null!=f.top&&null!=d.top&&(this.top=m.number(d.top,f.top,x)),null!=f.bottom&&null!=d.bottom&&(this.bottom=m.number(d.bottom,f.bottom,x)),null!=f.left&&null!=d.left&&(this.left=m.number(d.left,f.left,x)),null!=f.right&&null!=d.right&&(this.right=m.number(d.right,f.right,x)),this}getCenter(d,f){const x=m.clamp((this.left+d-this.right)/2,0,d),C=m.clamp((this.top+f-this.bottom)/2,0,f);return new m.pointGeometry(x,C)}equals(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right}clone(){return new Oc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Wd(y,d){const f=m.getColumn(y,3);m.fromQuat(y,d),m.setColumn(y,3,f)}function ws(y,d){const f=m.identity$1([]);return m.rotateZ$1(f,f,-d),m.rotateX$1(f,f,-y),f}function Dg(y,d){const f=[y[0],y[1],0],x=[d[0],d[1],0];if(m.length(f)>=1e-15){const k=m.normalize([],f);m.scale$2(x,k,m.dot(x,k)),d[0]=x[0],d[1]=x[1]}const C=m.cross([],d,y);if(m.len(C)<1e-15)return null;const S=Math.atan2(-C[1],C[0]);return ws(Math.atan2(Math.sqrt(y[0]*y[0]+y[1]*y[1]),-y[2]),S)}class Ff{constructor(d,f){this.position=d,this.orientation=f}get position(){return this._position}set position(d){if(d){const f=d instanceof m.MercatorCoordinate?d:new m.MercatorCoordinate(d[0],d[1],d[2]);this._renderWorldCopies&&(f.x=m.wrap(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(d,f){if(this.orientation=null,!this.position)return;const x=this._elevation?this._elevation.getAtPointOrZero(m.MercatorCoordinate.fromLngLat(d)):0,C=this.position,S=m.MercatorCoordinate.fromLngLat(d,x),k=[S.x-C.x,S.y-C.y,S.z-C.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=Dg(k,f)}setPitchBearing(d,f){this.orientation=ws(m.degToRad(d),m.degToRad(-f))}}class Vu{constructor(d,f){this._transform=m.identity([]),this.orientation=f,this.position=d}get mercatorPosition(){const d=this.position;return new m.MercatorCoordinate(d[0],d[1],d[2])}get position(){const d=m.getColumn(this._transform,3);return[d[0],d[1],d[2]]}set position(d){var f;d&&m.setColumn(this._transform,3,[(f=d)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(d){this._orientation=d||m.identity$1([]),d&&Wd(this._transform,this._orientation)}getPitchBearing(){const d=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2])}}setPitchBearing(d,f){this._orientation=ws(d,f),Wd(this._transform,this._orientation)}forward(){const d=m.getColumn(this._transform,2);return[-d[0],-d[1],-d[2]]}up(){const d=m.getColumn(this._transform,1);return[-d[0],-d[1],-d[2]]}right(){const d=m.getColumn(this._transform,0);return[d[0],d[1],d[2]]}getCameraToWorld(d,f){const x=new Float64Array(16);return m.invert(x,this.getWorldToCamera(d,f)),x}getWorldToCameraPosition(d,f,x){const C=this.position;m.scale$2(C,C,-d);const S=new Float64Array(16);return m.fromScaling(S,[x,x,x]),m.translate(S,S,C),S[10]*=f,S}getWorldToCamera(d,f){const x=new Float64Array(16),C=new Float64Array(4),S=this.position;return m.conjugate(C,this._orientation),m.scale$2(S,S,-d),m.fromQuat(x,C),m.translate(x,x,S),x[1]*=-1,x[5]*=-1,x[9]*=-1,x[13]*=-1,x[8]*=f,x[9]*=f,x[10]*=f,x[11]*=f,x}getCameraToClipPerspective(d,f,x,C){const S=new Float64Array(16);return m.perspective(S,d,f,x,C),S}getDistanceToElevation(d,f=!1){const x=0===d?0:m.mercatorZfromAltitude(d,f?m.latFromMercatorY(this.position[1]):this.position[1]),C=this.forward();return(x-this.position[2])/C[2]}clone(){return new Vu([...this.position],[...this.orientation])}}function Uu(y,d){const f=ju(y.projection,y.zoom,y.width,y.height),x=function(S,k,P,L,H){const $=new m.LngLat(P.lng-180*Hu,P.lat),Q=new m.LngLat(P.lng+180*Hu,P.lat),oe=S.project($.lng,$.lat),ue=S.project(Q.lng,Q.lat),ae=-Math.atan2(ue.y-oe.y,ue.x-oe.x),de=m.MercatorCoordinate.fromLngLat(P);de.y=m.clamp(de.y,-.999975,.999975);const he=de.toLngLat(),ie=S.project(he.lng,he.lat),ye=m.MercatorCoordinate.fromLngLat(he);ye.x+=Hu;const ge=ye.toLngLat(),Ce=S.project(ge.lng,ge.lat),Pe=op(Ce.x-ie.x,Ce.y-ie.y,ae),ke=m.MercatorCoordinate.fromLngLat(he);ke.y+=Hu;const Le=ke.toLngLat(),$e=S.project(Le.lng,Le.lat),nt=op($e.x-ie.x,$e.y-ie.y,ae),ot=Math.abs(Pe.x)/Math.abs(nt.y),zt=m.identity([]);m.rotateZ(zt,zt,-ae*(1-(H?0:L)));const Ze=m.identity([]);return m.scale(Ze,Ze,[1,1-(1-ot)*L,1]),Ze[4]=-nt.x/nt.y*L,m.rotateZ(Ze,Ze,ae),m.multiply(Ze,zt,Ze),Ze}(y.projection,0,y.center,f,d),C=zf(y);return m.scale(x,x,[C,C,1]),x}function zf(y){const d=y.projection,f=ju(y.projection,y.zoom,y.width,y.height),x=ip(d,y.center),C=ip(d,m.LngLat.convert(d.center));return Math.pow(2,x*f+(1-f)*C)}function ju(y,d,f,x,C=1/0){const S=y.range;if(!S)return 0;const k=Math.min(C,Math.max(f,x)),P=Math.log(k/1024)/Math.LN2;return m.smoothstep(S[0]+P,S[1]+P,d)}const Hu=1/4e4;function ip(y,d){const f=m.clamp(d.lat,-m.MAX_MERCATOR_LATITUDE,m.MAX_MERCATOR_LATITUDE),x=new m.LngLat(d.lng-180*Hu,f),C=new m.LngLat(d.lng+180*Hu,f),S=y.project(x.lng,f),k=y.project(C.lng,f),P=m.MercatorCoordinate.fromLngLat(x),L=m.MercatorCoordinate.fromLngLat(C),H=k.x-S.x,$=k.y-S.y,Q=L.x-P.x,oe=L.y-P.y,ue=Math.sqrt((Q*Q+oe*oe)/(H*H+$*$));return Math.log(ue)/Math.LN2}function op(y,d,f){const x=Math.cos(f),C=Math.sin(f);return{x:y*x-d*C,y:y*C+d*x}}class Yt{constructor(d,f,x,C,S,k,P){this.tileSize=512,this._renderWorldCopies=void 0===S||S,this._minZoom=d||0,this._maxZoom=f||22,this._minPitch=x??0,this._maxPitch=C??60,this.setProjection(k),this.setMaxBounds(P),this.width=0,this.height=0,this._center=new m.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Oc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Vu,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const d=new Yt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return d._elevation=this._elevation,d._centerAltitude=this._centerAltitude,d._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,d.tileSize=this.tileSize,d.mercatorFromTransition=this.mercatorFromTransition,d.width=this.width,d.height=this.height,d.cameraElevationReference=this.cameraElevationReference,d._center=this._center,d._setZoom(this.zoom),d._seaLevelZoom=this._seaLevelZoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._nearZ=this._nearZ,d._farZ=this._farZ,d._averageElevation=this._averageElevation,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._camera=this._camera.clone(),d._calcMatrices(),d.freezeTileCoverage=this.freezeTileCoverage,d.frustumCorners=this.frustumCorners,d}get elevation(){return this._elevation}set elevation(d){this._elevation!==d&&(this._elevation=d,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(d,f=!1){const x=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||x)&&this._updateCameraOnTerrain(),(d||x)&&this._constrainCamera(f),this._calcMatrices()}getProjection(){return m.pick(this.projection,["name","center","parallels"])}setProjection(d){this.projectionOptions=d||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=m.getProjection(this.projectionOptions);const x=!re(f,this.getProjection());return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setMercatorFromTransition(){const d=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=m.getProjection({name:"mercator"});const f=d!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))}get maxZoom(){return this._maxZoom}set maxZoom(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))}get minPitch(){return this._minPitch}set minPitch(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))}get maxPitch(){return this._maxPitch}set maxPitch(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(d){void 0===d?d=!0:null===d&&(d=!1),this._renderWorldCopies=d}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get cameraWorldSize(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return m.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new m.pointGeometry(this.width,this.height)}get bearing(){return m.wrap(this.rotation,-180,180)}set bearing(d){this.rotation=d}get rotation(){return-this.angle/Math.PI*180}set rotation(d){const f=-d*Math.PI/180;var x,C,S,k,P,L,H,$,Q,oe;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(x=new m.ARRAY_TYPE(4),m.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x),C=this.rotationMatrix,k=this.angle,P=(S=this.rotationMatrix)[0],L=S[1],H=S[2],$=S[3],Q=Math.sin(k),oe=Math.cos(k),C[0]=P*oe+H*Q,C[1]=L*oe+$*Q,C[2]=P*-Q+H*oe,C[3]=L*-Q+$*oe)}get pitch(){return this._pitch/Math.PI*180}set pitch(d){const f=m.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const d=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/d)}set fov(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=m.degToRad(d),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(d){this._averageElevation=d,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(d){const f=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(d){this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const d=this._elevation;this._centerAltitude=d.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=d.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const d=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],x=this.horizonLineFromTop();let C=0,S=0;for(let k=0;k<f.length;k++){const P=new m.pointGeometry(f[k][0]*this.width,x+f[k][1]*(this.height-x)),L=d.pointCoordinate(P);if(!L)continue;const H=1/Math.hypot(L[0]-this._camera.position[0],L[1]-this._camera.position[1]);C+=L[3]*H,S+=H}return 0===S?NaN:C/S}get center(){return this._center}set center(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const d=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),x=this.pixelsPerMeter/this.worldSize*f,C=this._mercatorZfromZoom(d),S=this._mercatorZfromZoom(this._maxZoom),k=Math.max(C-x,S);this._setZoom(this._zoomFromMercatorZ(k))}get padding(){return this._edgeInsets.toJSON()}set padding(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())}computeZoomRelativeTo(d){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,d.toAltitude()));let x;x=d.z<this._camera.position[2]?[f.x,f.y,f.z]:[d.x,d.y,d.z];const C=m.length(m.sub([],this._camera.position,x));return m.clamp(this._zoomFromMercatorZ(C),this._minZoom,this._maxZoom)}setFreeCameraOptions(d){if(!this.height||!d.position&&!d.orientation)return;this._updateCameraState();let f=!1;if(d.orientation&&!m.exactEquals(d.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(d.orientation)),d.position){const x=[d.position.x,d.position.y,d.position.z];m.exactEquals$1(x,this._camera.position)||(this._setCameraPosition(x),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const d=this._camera.position,f=new Ff;return f.position=new m.MercatorCoordinate(d[0],d[1],d[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(d){if(!m.length$1(d))return!1;m.normalize$1(d,d);const f=m.transformQuat([],[0,0,-1],d),x=m.transformQuat([],[0,-1,0],d);if(x[2]<0)return!1;const C=Dg(f,x);return!!C&&(this._camera.orientation=C,!0)}_setCameraPosition(d){const f=this.zoomScale(this.minZoom)*this.tileSize,x=this.zoomScale(this.maxZoom)*this.tileSize,C=this.cameraToCenterDistance;d[2]=m.clamp(d[2],C/x,C/f),this._camera.position=d}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(d){return this._edgeInsets.equals(d)}interpolatePadding(d,f,x){this._unmodified=!1,this._edgeInsets.interpolate(d,f,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(d){const f=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(d){const f=[new m.UnwrappedTileID(0,d)];if(this.renderWorldCopies){const x=this.pointCoordinate(new m.pointGeometry(0,0)),C=this.pointCoordinate(new m.pointGeometry(this.width,0)),S=this.pointCoordinate(new m.pointGeometry(this.width,this.height)),k=this.pointCoordinate(new m.pointGeometry(0,this.height)),P=Math.floor(Math.min(x.x,C.x,S.x,k.x)),L=Math.floor(Math.max(x.x,C.x,S.x,k.x)),H=1;for(let $=P-H;$<=L+H;$++)0!==$&&f.push(new m.UnwrappedTileID($,d))}return f}coveringTiles(d){let f=this.coveringZoomLevel(d);const x=f,C=this.elevation&&!d.isTerrainDEM,S="mercator"===this.projection.name;if(void 0!==d.minzoom&&f<d.minzoom)return[];void 0!==d.maxzoom&&f>d.maxzoom&&(f=d.maxzoom);const k=this.locationCoordinate(this.center),P=this.center.lat,L=1<<f,H=[L*k.x,L*k.y,0],$="globe"===this.projection.name,Q=!$,oe=m.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,Q),ue=$?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ae=L*m.mercatorZfromAltitude(1,this.center.lat),de=this._camera.position[2]/m.mercatorZfromAltitude(1,this.center.lat),he=[L*ue.x,L*ue.y,de*(Q?1:ae)],ie=this.cameraToCenterDistance/d.tileSize*(d.roundZoom?1:.502),ye=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?f:0,ge=d.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ce=d.isTerrainDEM?-ge:this._elevation?this._elevation.getMinElevationBelowMSL():0,Pe=this.projection.isReprojectedInTileSpace?zf(this):1,ke=it=>{const lt=new m.MercatorCoordinate(it.x+25e-6,it.y,it.z),Mt=new m.MercatorCoordinate(it.x,it.y+25e-6,it.z),Pt=it.toLngLat(),hn=lt.toLngLat(),ni=Mt.toLngLat(),cn=this.locationCoordinate(Pt),Zt=this.locationCoordinate(hn),bn=this.locationCoordinate(ni),yi=Math.hypot(Zt.x-cn.x,Zt.y-cn.y),Tn=Math.hypot(bn.x-cn.x,bn.y-cn.y);return Math.sqrt(yi*Tn)*Pe/25e-6},Le=it=>{const je=ge,lt=Ce;return{aabb:m.tileAABB(this,L,0,0,0,it,lt,je,this.projection),zoom:0,x:0,y:0,minZ:lt,maxZ:je,wrap:it,fullyVisible:!1}},$e=[];let nt=[];const ot=f,zt=d.reparseOverscaled?x:f,Ze=it=>it*it,Ct=Ze((de-this._centerAltitude)*ae),ut=it=>{if(!this._elevation||!it.tileID||!S)return;const je=this._elevation.getMinMaxForTile(it.tileID),lt=it.aabb;je?(lt.min[2]=je.min,lt.max[2]=je.max,lt.center[2]=(lt.min[2]+lt.max[2])/2):(it.shouldSplit=kt(it),it.shouldSplit||(lt.min[2]=lt.max[2]=lt.center[2]=this._centerAltitude))},kt=it=>{if(it.zoom<ye)return!0;if(it.zoom===ot)return!1;if(null!=it.shouldSplit)return it.shouldSplit;const je=it.aabb.distanceX(he),lt=it.aabb.distanceY(he);let Mt=Ct,Pt=1;if($){Mt=Ze(it.aabb.distanceZ(he));const cn=Math.pow(2,it.zoom),Zt=m.latFromMercatorY((it.y+1)/cn),bn=m.latFromMercatorY(it.y/cn),yi=Math.min(Math.max(P,Zt),bn),Tn=m.circumferenceAtLatitude(yi)/m.circumferenceAtLatitude(P);if(Pt=yi===P?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Tn/this._mercatorScaleRatio),this.zoom<=m.GLOBE_ZOOM_THRESHOLD_MIN&&it.zoom===ot-1&&Tn>=.9)return!0}else if(C&&(Mt=Ze(it.aabb.distanceZ(he)*ae)),this.projection.isReprojectedInTileSpace&&x<=5){const cn=Math.pow(2,it.zoom),Zt=ke(new m.MercatorCoordinate((it.x+.5)/cn,(it.y+.5)/cn));Pt=Zt>.85?1:Zt}const hn=je*je+lt*lt+Mt;return hn<Ze((1<<ot-it.zoom)*ie*Pt*((cn,Zt)=>{if(Zt*Ze(.707)<cn)return 1;const bn=Math.sqrt(Zt/cn);return bn/(1.4144271570014144+(Math.pow(1.1,bn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Mt,Ct),hn))};if(this.renderWorldCopies)for(let it=1;it<=3;it++)$e.push(Le(-it)),$e.push(Le(it));for($e.push(Le(0));$e.length>0;){const it=$e.pop(),je=it.x,lt=it.y;let Mt=it.fullyVisible;if(!Mt){const Pt=it.aabb.intersects(oe);if(0===Pt)continue;Mt=2===Pt}if(it.zoom!==ot&&kt(it))for(let Pt=0;Pt<4;Pt++){const hn=(je<<1)+Pt%2,ni=(lt<<1)+(Pt>>1),cn={aabb:S?it.aabb.quadrant(Pt):m.tileAABB(this,L,it.zoom+1,hn,ni,it.wrap,it.minZ,it.maxZ,this.projection),zoom:it.zoom+1,x:hn,y:ni,wrap:it.wrap,fullyVisible:Mt,tileID:void 0,shouldSplit:void 0,minZ:it.minZ,maxZ:it.maxZ};C&&!$&&(cn.tileID=new m.OverscaledTileID(it.zoom+1===ot?zt:it.zoom+1,it.wrap,it.zoom+1,hn,ni),ut(cn)),$e.push(cn)}else{const Pt=it.zoom===ot?zt:it.zoom;if(d.minzoom&&d.minzoom>Pt)continue;const hn=H[0]-(.5+je+(it.wrap<<it.zoom))*(1<<f-it.zoom),ni=H[1]-.5-lt,cn=it.tileID?it.tileID:new m.OverscaledTileID(Pt,it.wrap,it.zoom,je,lt);nt.push({tileID:cn,distanceSq:hn*hn+ni*ni})}}if(this.fogCullDistSq){const it=this.fogCullDistSq,je=this.horizonLineFromTop();nt=nt.filter(lt=>{const Mt=[0,0,0,1],Pt=[m.EXTENT,m.EXTENT,0,1],hn=this.calculateFogTileMatrix(lt.tileID.toUnwrapped());m.transformMat4$1(Mt,Mt,hn),m.transformMat4$1(Pt,Pt,hn);const ni=m.getAABBPointSquareDist(Mt,Pt);if(0===ni)return!0;let cn=!1;const Zt=this._elevation;if(Zt&&ni>it&&0!==je){const bn=this.calculateProjMatrix(lt.tileID.toUnwrapped());let yi;d.isTerrainDEM||(yi=Zt.getMinMaxForTile(lt.tileID)),yi||(yi={min:Ce,max:ge});const Tn=m.furthestTileCorner(this.rotation),$i=[Tn[0]*m.EXTENT,Tn[1]*m.EXTENT,yi.max];m.transformMat4($i,$i,bn),cn=(1-$i[1])*this.height*.5<je}return ni<it||cn})}return nt.sort((it,je)=>it.distanceSq-je.distanceSq).map(it=>it.tileID)}resize(d,f){this.width=d,this.height=f,this.pixelsToGLUnits=[2/d,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(d){return Math.pow(2,d)}scaleZoom(d){return Math.log(d)/Math.LN2}project(d){const f=m.clamp(d.lat,-m.MAX_MERCATOR_LATITUDE,m.MAX_MERCATOR_LATITUDE),x=this.projection.project(d.lng,f);return new m.pointGeometry(x.x*this.worldSize,x.y*this.worldSize)}unproject(d){return this.projection.unproject(d.x/this.worldSize,d.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/m.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(d,f){let x,C;const S=this.centerPoint;if("globe"===this.projection.name){const P=this.worldSize;x=(f.x-S.x)/P,C=(f.y-S.y)/P}else{const P=this.pointCoordinate(f),L=this.pointCoordinate(S);x=P.x-L.x,C=P.y-L.y}const k=this.locationCoordinate(d);this.setLocation(new m.MercatorCoordinate(k.x-x,k.y-C))}setLocation(d){this.center=this.coordinateLocation(d),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(d){return this.projection.locationPoint(this,d)}locationPoint3D(d){return this.projection.locationPoint(this,d,!0)}pointLocation(d){return this.coordinateLocation(this.pointCoordinate(d))}pointLocation3D(d){return this.coordinateLocation(this.pointCoordinate3D(d))}locationCoordinate(d,f){const x=f?m.mercatorZfromAltitude(f,d.lat):void 0,C=this.projection.project(d.lng,d.lat);return new m.MercatorCoordinate(C.x,C.y,x)}coordinateLocation(d){return this.projection.unproject(d.x,d.y)}pointRayIntersection(d,f){const x=f??this._centerAltitude,C=[d.x,d.y,0,1],S=[d.x,d.y,1,1];m.transformMat4$1(C,C,this.pixelMatrixInverse),m.transformMat4$1(S,S,this.pixelMatrixInverse);const k=S[3];m.scale$1(C,C,1/C[3]),m.scale$1(S,S,1/k);const P=C[2],L=S[2];return{p0:C,p1:S,t:P===L?0:(x-P)/(L-P)}}screenPointToMercatorRay(d){const f=[d.x,d.y,0,1],x=[d.x,d.y,1,1];return m.transformMat4$1(f,f,this.pixelMatrixInverse),m.transformMat4$1(x,x,this.pixelMatrixInverse),m.scale$1(f,f,1/f[3]),m.scale$1(x,x,1/x[3]),f[2]=m.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,x[2]=m.mercatorZfromAltitude(x[2],this._center.lat)*this.worldSize,m.scale$1(f,f,1/this.worldSize),m.scale$1(x,x,1/this.worldSize),new m.Ray([f[0],f[1],f[2]],m.normalize([],m.sub([],x,f)))}rayIntersectionCoordinate(d){const{p0:f,p1:x,t:C}=d,S=m.mercatorZfromAltitude(f[2],this._center.lat),k=m.mercatorZfromAltitude(x[2],this._center.lat);return new m.MercatorCoordinate(m.number(f[0],x[0],C)/this.worldSize,m.number(f[1],x[1],C)/this.worldSize,m.number(S,k,C))}pointCoordinate(d,f=this._centerAltitude){return this.projection.pointCoordinate(this,d.x,d.y,f)}pointCoordinate3D(d){if(!this.elevation)return this.pointCoordinate(d);let f=this.projection.pointCoordinate3D(this,d.x,d.y);if(f)return new m.MercatorCoordinate(f[0],f[1],f[2]);let x=0,C=this.horizonLineFromTop();if(d.y>C)return this.pointCoordinate(d);const S=.02*C,k=d.clone();for(let P=0;P<10&&C-x>S;P++){k.y=m.number(x,C,.66);const L=this.projection.pointCoordinate3D(this,k.x,k.y);L?(C=k.y,f=L):x=k.y}return f?new m.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(d)}isPointAboveHorizon(d){return this.projection.isPointAboveHorizon(this,d)}_coordinatePoint(d,f){const x=f&&this.elevation?this.elevation.getAtPointOrZero(d,this._centerAltitude):this._centerAltitude,C=[d.x*this.worldSize,d.y*this.worldSize,x+d.toAltitude(),1];return m.transformMat4$1(C,C,this.pixelMatrix),C[3]>0?new m.pointGeometry(C[0]/C[3],C[1]/C[3]):new m.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:d,left:f}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,S=this.pointLocation3D(new m.pointGeometry(f,d)),k=this.pointLocation3D(new m.pointGeometry(C,d)),P=this.pointLocation3D(new m.pointGeometry(C,x)),L=this.pointLocation3D(new m.pointGeometry(f,x));let H=Math.min(S.lng,k.lng,P.lng,L.lng),$=Math.max(S.lng,k.lng,P.lng,L.lng),Q=Math.min(S.lat,k.lat,P.lat,L.lat),oe=Math.max(S.lat,k.lat,P.lat,L.lat);const ue=Math.pow(2,-this.zoom)/16*270,ae="globe"===this.projection.name?1:4,de=(he,ie,ye,ge,Ce)=>{const Pe=(he+ye)/2,ke=(ie+ge)/2,Le=new m.pointGeometry(Pe,ke),{lng:$e,lat:nt}=this.pointLocation3D(Le),ot=Math.max(0,H-$e,Q-nt,$e-$,nt-oe);H=Math.min(H,$e),$=Math.max($,$e),Q=Math.min(Q,nt),oe=Math.max(oe,nt),(Ce<ae||ot>ue)&&(de(he,ie,Pe,ke,Ce+1),de(Pe,ke,ye,ge,Ce+1))};if(de(f,d,C,d,1),de(C,d,C,x,1),de(C,x,f,x,1),de(f,x,f,d,1),"globe"===this.projection.name){const[he,ie]=m.polesInViewport(this);he?(oe=90,$=180,H=-180):ie&&(Q=-90,$=180,H=-180)}return new m.LngLatBounds(new m.LngLat(H,Q),new m.LngLat($,oe))}_getBoundsRectangular(d,f){const{top:x,left:C}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,k=this.width-this._edgeInsets.right,P=new m.pointGeometry(C,x),L=new m.pointGeometry(k,x),H=new m.pointGeometry(k,S),$=new m.pointGeometry(C,S);let Q=this.pointCoordinate(P,d),oe=this.pointCoordinate(L,d);const ue=this.pointCoordinate(H,f),ae=this.pointCoordinate($,f),de=(he,ie)=>(ie.y-he.y)/(ie.x-he.x);return Q.y>1&&oe.y>=0?Q=new m.MercatorCoordinate((1-ae.y)/de(ae,Q)+ae.x,1):Q.y<0&&oe.y<=1&&(Q=new m.MercatorCoordinate(-ae.y/de(ae,Q)+ae.x,0)),oe.y>1&&Q.y>=0?oe=new m.MercatorCoordinate((1-ue.y)/de(ue,oe)+ue.x,1):oe.y<0&&Q.y<=1&&(oe=new m.MercatorCoordinate(-ue.y/de(ue,oe)+ue.x,0)),(new m.LngLatBounds).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(oe)).extend(this.coordinateLocation(ae)).extend(this.coordinateLocation(ue))}_getBoundsRectangularTerrain(){const d=this.elevation;if(!d.visibleDemTiles.length||d.isUsingMockSource())return this._getBoundsRectangular(0,0);const f=d.visibleDemTiles.reduce((x,C)=>{if(C.dem){const S=C.dem.tree;x.min=Math.min(x.min,S.minimums[0]),x.max=Math.max(x.max,S.maximums[0])}return x},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(f.min*d.exaggeration(),f.max*d.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(d=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,x=this.height/2-f*(1-this._horizonShift);return d?Math.max(0,x):x}getMaxBounds(){return this.maxBounds}setMaxBounds(d){this.maxBounds=d,this.minLat=-m.MAX_MERCATOR_LATITUDE,this.maxLat=m.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,d&&(this.minLat=d.getSouth(),this.maxLat=d.getNorth(),this.minLng=d.getWest(),this.maxLng=d.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=m.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=m.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=m.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=m.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(d,f){return this.projection.createTileMatrix(this,f,d)}calculateDistanceTileData(d){const f=d.key,x=this._distanceTileDataCache;if(x[f])return x[f];const C=d.canonical,S=1/this.height,k=this.cameraWorldSize,P=k/this.zoomScale(C.z),L=(C.x+Math.pow(2,C.z)*d.wrap)*P,H=C.y*P,$=this.point;$.x*=k/this.worldSize,$.y*=k/this.worldSize;const Q=this.angle,oe=Math.sin(-Q),ue=-Math.cos(-Q);return x[f]={bearing:[oe,ue],center:[($.x-L)*S,($.y-H)*S],scale:P/m.EXTENT*S},x[f]}calculateFogTileMatrix(d){const f=d.key,x=this._fogTileMatrixCache;if(x[f])return x[f];const C=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,d);return m.multiply(C,this.worldToFogMatrix,C),x[f]=new Float32Array(C),x[f]}calculateProjMatrix(d,f=!1){const x=d.key,C=f?this._alignedProjMatrixCache:this._projMatrixCache;if(C[x])return C[x];const S=this.calculatePosMatrix(d,this.worldSize);return m.multiply(S,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.alignedProjMatrix:this.projMatrix,S),C[x]=new Float32Array(S),C[x]}calculatePixelsToTileUnitsMatrix(d){const f=d.tileID.key,x=this._pixelsToTileUnitsCache;if(x[f])return x[f];const C=function(S,k){const{scale:P}=S.tileTransform,L=P*m.EXTENT/(S.tileSize*Math.pow(2,k.zoom-S.tileID.overscaledZ+S.tileID.canonical.z));return H=new Float32Array(4),oe=($=k.inverseAdjustmentMatrix)[1],ue=$[2],ae=$[3],he=(Q=[L,L])[1],H[0]=$[0]*(de=Q[0]),H[1]=oe*de,H[2]=ue*he,H[3]=ae*he,H;var H,$,Q,oe,ue,ae,de,he}(d,this);return x[f]=C,x[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const d=1/this.worldSize,f=m.fromScaling([],[d,d,d]);return m.multiply(f,f,this.globeMatrix),f}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const d=this._elevation;this._updateCameraState();const f=m.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(f),C=this._camera.forward(),S=m.mercatorZfromAltitude(1,this._center.lat);x[2]/=S,C[2]/=S,m.normalize(C,C);const k=d.raycast(x,C,d.exaggeration());if(k){const P=m.scaleAndAdd([],x,C,k),L=new m.MercatorCoordinate(P[0],P[1],m.mercatorZfromAltitude(P[2],m.latFromMercatorY(P[1]))),H=(L.z+m.length([L.x-x[0],L.y-x[1],L.z-x[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=L.toAltitude(),this._center=this.coordinateLocation(L),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(d=!1){if(!this._elevation)return;const f=this._elevation,x=m.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,C=this._computeCameraPosition(x),S=f.getAtPointOrZero(new m.MercatorCoordinate(...C)),k=this.pixelsPerMeter/this.worldSize*S,P=this._minimumHeightOverTerrain(),L=C[2]-k;if(L<=P)if(L<0||d){const H=this.locationCoordinate(this._center,this._centerAltitude),$=[C[0],C[1],H.z-C[2]],Q=m.length($);$[2]-=(P-L)/this._pixelsPerMercatorPixel;const oe=m.length($);if(0===oe)return;m.scale$2($,$,Q/oe*this._pixelsPerMercatorPixel),this._camera.position=[C[0],C[1],H.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const d="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||d){const oe=this.center;return oe.lat=m.clamp(oe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!d)&&(oe.lng=m.clamp(oe.lng,this.minLng,this.maxLng)),this.center=oe,void(this._constraining=!1)}const f=this._unmodified,{x,y:C}=this.point;let S=0,k=x,P=C;const L=this.width/2,H=this.height/2,$=this.worldMinY*this.scale,Q=this.worldMaxY*this.scale;if(C-H<$&&(P=$+H),C+H>Q&&(P=Q-H),Q-$<this.height&&(S=Math.max(S,this.height/(Q-$)),P=(Q+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const oe=this.worldMinX*this.scale,ue=this.worldMaxX*this.scale,ae=this.worldSize/2-(oe+ue)/2;k=(x+ae+this.worldSize)%this.worldSize-ae,k-L<oe&&(k=oe+L),k+L>ue&&(k=ue-L),ue-oe<this.width&&(S=Math.max(S,this.width/(ue-oe)),k=(ue+oe)/2)}k===x&&P===C||(this.center=this.unproject(new m.pointGeometry(k,P))),S&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let d=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(d=Math.max(d,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),d}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const d=this.centerOffset,f=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=m.mercatorZfromAltitude(1,this.center.lat)/m.mercatorZfromAltitude(1,m.GLOBE_SCALE_MATCH_LATITUDE));const x=ju(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const C="meters"===this.projection.zAxisUnit?f:1,S=this._camera.getWorldToCamera(this.worldSize,C),k=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);k[8]=2*-d.x/this.width,k[9]=2*d.y/this.height;let P=m.mul([],k,S);if(this.projection.isReprojectedInTileSpace){const ke=this.locationCoordinate(this.center),Le=m.identity([]);m.translate(Le,Le,[ke.x*this.worldSize,ke.y*this.worldSize,0]),m.multiply(Le,Le,Uu(this)),m.translate(Le,Le,[-ke.x*this.worldSize,-ke.y*this.worldSize,0]),m.multiply(P,P,Le),this.inverseAdjustmentMatrix=function($e){const nt=Uu($e,!0);return bt([],[nt[0],nt[1],nt[4],nt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=m.scale([],P,[this.worldSize,this.worldSize,this.worldSize/C,1]),this.projMatrix=P,this.invProjMatrix=m.invert(new Float64Array(16),this.projMatrix);const L=m.invert([],k);this.frustumCorners=m.FrustumCorners.fromInvProjectionMatrix(L,this.horizonLineFromTop(),this.height);const H=new Float32Array(16);m.identity(H),m.scale(H,H,[1,-1,1]),m.rotateX(H,H,this._pitch),m.rotateZ(H,H,this.angle);const $=m.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;$[8]=2*-d.x/this.width,$[9]=2*(d.y+Q)/this.height,this.skyboxMatrix=m.multiply(H,$,H);const oe=this.point,ue=oe.x,ae=oe.y,de=this.width%2/2,he=this.height%2/2,ie=Math.cos(this.angle),ye=Math.sin(this.angle),ge=ue-Math.round(ue)+ie*de+ye*he,Ce=ae-Math.round(ae)+ie*he+ye*de,Pe=new Float64Array(P);if(m.translate(Pe,Pe,[ge>.5?ge-1:ge,Ce>.5?Ce-1:Ce,0]),this.alignedProjMatrix=Pe,P=m.create(),m.scale(P,P,[this.width/2,-this.height/2,1]),m.translate(P,P,[1,-1,0]),this.labelPlaneMatrix=P,P=m.create(),m.scale(P,P,[1,-1,1]),m.translate(P,P,[-1,-1,0]),m.scale(P,P,[2/this.width,2/this.height,1]),this.glCoordMatrix=P,this.pixelMatrix=m.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},P=m.invert(new Float64Array(16),this.pixelMatrix),!P)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=P,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=m.calculateGlobeMatrix(this);const ke=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=m.transformMat4(ke,ke,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=P;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const d=this.cameraWorldSizeForFog,f=this.cameraPixelsPerMeter,x=this._camera.position,C=1/this.height/this._pixelsPerMercatorPixel,S=[d,d,f];m.scale$2(S,S,C),m.scale$2(x,x,-1),m.multiply$2(x,x,S);const k=m.create();m.translate(k,k,x),m.scale(k,k,S),this.mercatorFogMatrix=k,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(d,f,C)}_computeCameraPosition(d){const f=(d=d||this.pixelsPerMeter)/this.pixelsPerMeter,x=this._camera.forward(),C=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-d/this.worldSize*this._centerAltitude;return[C.x/this.worldSize-x[0]*S,C.y/this.worldSize-x[1]*S,d/this.worldSize*this._centerAltitude-x[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(d){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),x=this._camera.position[2],C=d[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),C>0&&(S=Math.min((f-x)/C,1)),this._camera.position=m.scaleAndAdd([],this._camera.position,d,S),this._updateStateFromCamera()}_updateStateFromCamera(){const d=this._camera.position,f=this._camera.forward(),{pitch:x,bearing:C}=this._camera.getPitchBearing(),S=m.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,k=this._mercatorZfromZoom(this._maxZoom)*Math.cos(m.degToRad(this._maxPitch)),P=Math.max((d[2]-S)/Math.cos(x),k),L=this._zoomFromMercatorZ(P);m.scaleAndAdd(d,d,f,P),this._pitch=m.clamp(x,m.degToRad(this.minPitch),m.degToRad(this.maxPitch)),this.angle=m.wrap(C,-Math.PI,Math.PI),this._setZoom(m.clamp(L,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new m.MercatorCoordinate(d[0],d[1],d[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(d){return Math.pow(2,d)*this.tileSize}_mercatorZfromZoom(d){return this.cameraToCenterDistance/this._worldSizeFromZoom(d)}_minimumHeightOverTerrain(){const d=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(d)}_zoomFromMercatorZ(d){return this.scaleZoom(this.cameraToCenterDistance/(d*this.tileSize))}zoomFromMercatorZAdjusted(d){let f=0,x=m.GLOBE_ZOOM_THRESHOLD_MAX,C=0,S=1/0;for(;x-f>1e-6&&x>f;){const k=f+.5*(x-f),P=this.tileSize*Math.pow(2,k),L=this.getCameraToCenterDistance(this.projection,k,P),H=this.scaleZoom(L/(d*this.tileSize)),$=Math.abs(k-H);$<S&&(S=$,C=k),k<H?f=k:x=k}return C}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(m.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(d,f){const x=Math.min(d.x,f.x),C=Math.max(d.x,f.x),S=Math.min(d.y,f.y),k=Math.max(d.y,f.y);if(S<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const P=[new m.pointGeometry(x,S),new m.pointGeometry(C,k),new m.pointGeometry(x,k),new m.pointGeometry(C,S)],L=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const $ of P){const Q=this.pointRayIntersection($);if(Q.t<0)return!0;const oe=this.rayIntersectionCoordinate(Q);if(oe.x<L||oe.y<0||oe.x>H||oe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+m.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new m.pointGeometry(0,0),new m.pointGeometry(this.width,this.height))}zoomDeltaToMovement(d,f){const x=m.length(m.sub([],this._camera.position,d)),C=this._zoomFromMercatorZ(x)+f;return x-this._mercatorZfromZoom(C)}getCameraPoint(){if("globe"===this.projection.name){const d=function([f,x,C],S){const k=[f,x,C,1];m.transformMat4$1(k,k,S);const P=k[3]=Math.max(k[3],1e-6);return k[0]/=P,k[1]/=P,k[2]/=P,k}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new m.pointGeometry(d[0],d[1])}{const d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new m.pointGeometry(0,d))}}getCameraToCenterDistance(d,f=this.zoom,x=this.worldSize){const C=ju(d,f,this.width,this.height,1024),S=d.pixelSpaceConversion(this.center.lat,x,C);return.5/Math.tan(.5*this._fov)*this.height*S}getWorldToCameraMatrix(){const d=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&m.multiply(d,d,this.globeMatrix),d}}function va(y,d){let f=!1,x=null;const C=()=>{x=null,f&&(y(),x=setTimeout(C,d),f=!1)};return()=>(f=!0,x||C(),x)}class Cy{constructor(d){this._hashName=d&&encodeURIComponent(d),m.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=va(this._updateHashUnthrottled.bind(this),300)}addTo(d){return this._map=d,m.window.addEventListener("hashchange",this._onHashChange,!1),d.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),m.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const d=this._map;if(!d)return"";const f=Mg(d);if(this._hashName){const x=this._hashName;let C=!1;const S=m.window.location.hash.slice(1).split("&").map(k=>{const P=k.split("=")[0];return P===x?(C=!0,`${P}=${f}`):k}).filter(k=>k);return C||S.push(`${x}=${f}`),`#${S.join("&")}`}return`#${f}`}_getCurrentHash(){const d=m.window.location.hash.replace("#","");if(this._hashName){let f;return d.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(f=x)}),(f&&f[1]||"").split("/")}return d.split("/")}_onHashChange(){const d=this._map;if(!d)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(x=>isNaN(x))){const x=d.dragRotate.isEnabled()&&d.touchZoomRotate.isEnabled()?+(f[3]||0):d.getBearing();return d.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:x,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){const d=m.window.location.href.replace(/(#.+)?$/,this.getHashString());m.window.history.replaceState(m.window.history.state,null,d)}}function Mg(y,d){const f=y.getCenter(),x=Math.round(100*y.getZoom())/100,C=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,C),k=Math.round(f.lng*S)/S,P=Math.round(f.lat*S)/S,L=y.getBearing(),H=y.getPitch();let $=d?`/${k}/${P}/${x}`:`${x}/${P}/${k}`;return(L||H)&&($+="/"+Math.round(10*L)/10),H&&($+=`/${Math.round(H)}`),$}const rp={linearity:.3,easing:m.bezier(0,0,.3,1)},qd=m.extend({deceleration:2500,maxSpeed:1400},rp),Ty=m.extend({deceleration:20,maxSpeed:1400},rp),Zd=m.extend({deceleration:1e3,maxSpeed:360},rp),sp=m.extend({deceleration:1e3,maxSpeed:90},rp);class Nf{constructor(d){this._map=d,this.clear()}clear(){this._inertiaBuffer=[]}record(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:m.exported.now(),settings:d})}_drainInertiaBuffer(){const d=this._inertiaBuffer,f=m.exported.now();for(;d.length>0&&f-d[0].time>160;)d.shift()}_onMoveEnd(d){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const f={zoom:0,bearing:0,pitch:0,pan:new m.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)f.zoom+=S.zoomDelta||0,f.bearing+=S.bearingDelta||0,f.pitch+=S.pitchDelta||0,S.panDelta&&f.pan._add(S.panDelta),S.around&&(f.around=S.around),S.pinchAround&&(f.pinchAround=S.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(f.pan.mag()){const S=lp(f.pan.mag(),x,m.extend({},qd,d||{}));C.offset=f.pan.mult(S.amount/f.pan.mag()),C.center=this._map.transform.center,ap(C,S)}if(f.zoom){const S=lp(f.zoom,x,Ty);C.zoom=this._map.transform.zoom+S.amount,ap(C,S)}if(f.bearing){const S=lp(f.bearing,x,Zd);C.bearing=this._map.transform.bearing+m.clamp(S.amount,-179,179),ap(C,S)}if(f.pitch){const S=lp(f.pitch,x,sp);C.pitch=this._map.transform.pitch+S.amount,ap(C,S)}if(C.zoom||C.bearing){const S=void 0===f.pinchAround?f.around:f.pinchAround;C.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),C.noMoveStart=!0,C}}function ap(y,d){(!y.duration||y.duration<d.duration)&&(y.duration=d.duration,y.easing=d.easing)}function lp(y,d,f){const{maxSpeed:x,linearity:C,deceleration:S}=f,k=m.clamp(y*C/(d/1e3),-x,x),P=Math.abs(k)/(S*C);return{easing:f.easing,duration:1e3*P,amount:k*(P/2)}}class zo extends m.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,f,x,C={}){const S=Ue(f.getCanvasContainer(),x),k=f.unproject(S);super(d,m.extend({point:S,lngLat:k,originalEvent:x},C)),this._defaultPrevented=!1,this.target=f}}class cp extends m.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,f,x){const C="touchend"===d?x.changedTouches:x.touches,S=rt(f.getCanvasContainer(),C),k=S.map(L=>f.unproject(L)),P=S.reduce((L,H,$,Q)=>L.add(H.div(Q.length)),new m.pointGeometry(0,0));super(d,{points:S,point:P,lngLats:k,lngLat:f.unproject(P),originalEvent:x}),this._defaultPrevented=!1}}class ur extends m.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,f,x){super(d,{originalEvent:x}),this._defaultPrevented=!1}}class Bf{constructor(d,f){this._map=d,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(d){return this._firePreventable(new ur(d.type,this._map,d))}mousedown(d,f){return this._mousedownPos=f,this._firePreventable(new zo(d.type,this._map,d))}mouseup(d){this._map.fire(new zo(d.type,this._map,d))}preclick(d){const f=m.extend({},d);f.type="preclick",this._map.fire(new zo(f.type,this._map,f))}click(d,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(d),this._map.fire(new zo(d.type,this._map,d)))}dblclick(d){return this._firePreventable(new zo(d.type,this._map,d))}mouseover(d){this._map.fire(new zo(d.type,this._map,d))}mouseout(d){this._map.fire(new zo(d.type,this._map,d))}touchstart(d){return this._firePreventable(new cp(d.type,this._map,d))}touchmove(d){this._map.fire(new cp(d.type,this._map,d))}touchend(d){this._map.fire(new cp(d.type,this._map,d))}touchcancel(d){this._map.fire(new cp(d.type,this._map,d))}_firePreventable(d){if(this._map.fire(d),d.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class up{constructor(d){this._map=d}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(d){this._map.fire(new zo(d.type,this._map,d))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new zo(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Vf{constructor(d,f){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(d,f){this.isEnabled()&&d.shiftKey&&0===d.button&&($t(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(d,f){if(!this._active)return;const x=f,C=this._startPos,S=this._lastPos;if(!C||!S||S.equals(x)||!this._box&&x.dist(C)<this._clickTolerance)return;this._lastPos=x,this._box||(this._box=Ye("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));const k=Math.min(C.x,x.x),P=Math.max(C.x,x.x),L=Math.min(C.y,x.y),H=Math.max(C.y,x.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${k}px,${L}px)`,this._box.style.width=P-k+"px",this._box.style.height=H-L+"px")})}mouseupWindow(d,f){if(!this._active)return;const x=this._startPos,C=f;if(x&&0===d.button){if(this.reset(),ht(),x.x!==C.x||x.y!==C.y)return this._map.fire(new m.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:S=>S.fitScreenCoordinates(x,C,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",d)}}keydown(d){this._active&&27===d.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",d))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Bt(),delete this._startPos,delete this._lastPos}_fireEvent(d,f){return this._map.fire(new m.Event(d,{originalEvent:f}))}}function Kd(y,d){const f={};for(let x=0;x<y.length;x++)f[y[x].identifier]=d[x];return f}class Uf{constructor(d){this.reset(),this.numTouches=d.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(d,f,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=d.timeStamp),x.length===this.numTouches&&(this.centroid=function(C){const S=new m.pointGeometry(0,0);for(const k of C)S._add(k);return S.div(C.length)}(f),this.touches=Kd(x,f)))}touchmove(d,f,x){if(this.aborted||!this.centroid)return;const C=Kd(x,f);for(const S in this.touches){const P=C[S];(!P||P.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(d,f,x){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),0===x.length){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class $u{constructor(d){this.singleTap=new Uf(d),this.numTaps=d.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(d,f,x){this.singleTap.touchstart(d,f,x)}touchmove(d,f,x){this.singleTap.touchmove(d,f,x)}touchend(d,f,x){const C=this.singleTap.touchend(d,f,x);if(C){const S=d.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(C)<30;if(S&&k||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class Xd{constructor(){this._zoomIn=new $u({numTouches:1,numTaps:2}),this._zoomOut=new $u({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(d,f,x){this._zoomIn.touchstart(d,f,x),this._zoomOut.touchstart(d,f,x)}touchmove(d,f,x){this._zoomIn.touchmove(d,f,x),this._zoomOut.touchmove(d,f,x)}touchend(d,f,x){const C=this._zoomIn.touchend(d,f,x),S=this._zoomOut.touchend(d,f,x);return C?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(C)},{originalEvent:d})}):S?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(S)},{originalEvent:d})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ig={0:1,2:2};class cs{constructor(d){this.reset(),this._clickTolerance=d.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(d,f){return!1}_move(d,f){return{}}mousedown(d,f){if(this._lastPoint)return;const x=He(d);this._correctButton(d,x)&&(this._lastPoint=f,this._eventButton=x)}mousemoveWindow(d,f){const x=this._lastPoint;if(x)if(d.preventDefault(),null!=this._eventButton&&function(C,S){const k=Ig[S];return void 0===C.buttons||(C.buttons&k)!==k}(d,this._eventButton))this.reset();else if(this._moved||!(f.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(x,f)}mouseupWindow(d){this._lastPoint&&He(d)===this._eventButton&&(this._moved&&ht(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jf extends cs{mousedown(d,f){super.mousedown(d,f),this._lastPoint&&(this._active=!0)}_correctButton(d,f){return 0===f&&!d.ctrlKey}_move(d,f){return{around:f,panDelta:f.sub(d)}}}class dp extends cs{_correctButton(d,f){return 0===f&&d.ctrlKey||2===f}_move(d,f){const x=.8*(f.x-d.x);if(x)return this._active=!0,{bearingDelta:x}}contextmenu(d){d.preventDefault()}}class dr extends cs{_correctButton(d,f){return 0===f&&d.ctrlKey||2===f}_move(d,f){const x=-.5*(f.y-d.y);if(x)return this._active=!0,{pitchDelta:x}}contextmenu(d){d.preventDefault()}}class Gu{constructor(d,f){this._map=d,this._el=d.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),m.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new m.pointGeometry(0,0)}touchstart(d,f,x){return this._calculateTransform(d,f,x)}touchmove(d,f,x){if(this._active&&!(x.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===x.length&&!m.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return d.cancelable&&d.preventDefault(),this._calculateTransform(d,f,x)}}touchend(d,f,x){this._calculateTransform(d,f,x),this._active&&x.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(d,f,x){x.length>0&&(this._active=!0);const C=Kd(x,f),S=new m.pointGeometry(0,0),k=new m.pointGeometry(0,0);let P=0;for(const H in C){const $=C[H],Q=this._touches[H];Q&&(S._add($),k._add($.sub(Q)),P++,C[H]=$)}if(this._touches=C,P<this._minTouches||!k.mag())return;const L=k.div(P);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(P),panDelta:L}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ye("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Rc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(d){}_move(d,f,x){return{}}touchstart(d,f,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([f[0],f[1]]))}touchmove(d,f,x){const C=this._firstTwoTouches;if(!C)return;d.preventDefault();const[S,k]=C,P=Fr(x,f,S),L=Fr(x,f,k);if(!P||!L)return;const H=this._aroundCenter?null:P.add(L).div(2);return this._move([P,L],H,d)}touchend(d,f,x){if(!this._firstTwoTouches)return;const[C,S]=this._firstTwoTouches,k=Fr(x,f,C),P=Fr(x,f,S);k&&P||(this._active&&ht(),this.reset())}touchcancel(){this.reset()}enable(d){this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Fr(y,d,f){for(let x=0;x<y.length;x++)if(y[x].identifier===f)return d[x]}function kg(y,d){return Math.log(y/d)/Math.LN2}class Hf extends Rc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(d){this._startDistance=this._distance=d[0].dist(d[1])}_move(d,f){const x=this._distance;if(this._distance=d[0].dist(d[1]),this._active||!(Math.abs(kg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:kg(this._distance,x),pinchAround:f}}}function Hl(y,d){return 180*y.angleWith(d)/Math.PI}class Cs extends Rc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(d){this._startVector=this._vector=d[0].sub(d[1]),this._minDiameter=d[0].dist(d[1])}_move(d,f){const x=this._vector;if(this._vector=d[0].sub(d[1]),x&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Hl(this._vector,x),pinchAround:f}}_isBelowThreshold(d){this._minDiameter=Math.min(this._minDiameter,d.mag());const f=25/(Math.PI*this._minDiameter)*360,x=this._startVector;if(!x)return!1;const C=Hl(d,x);return Math.abs(C)<f}}function hp(y){return Math.abs(y.y)>Math.abs(y.x)}class hr extends Rc{constructor(d){super(),this._map=d}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(d){this._lastPoints=d,hp(d[0].sub(d[1]))&&(this._valid=!1)}_move(d,f,x){const C=this._lastPoints;if(!C)return;const S=d[0].sub(C[0]),k=d[1].sub(C[1]);return this._map._cooperativeGestures&&!m.isFullscreen()&&x.touches.length<3||(this._valid=this.gestureBeginsVertically(S,k,x.timeStamp),!this._valid)?void 0:(this._lastPoints=d,this._active=!0,{pitchDelta:(S.y+k.y)/2*-.5})}gestureBeginsVertically(d,f,x){if(void 0!==this._valid)return this._valid;const C=d.mag()>=2,S=f.mag()>=2;if(!C&&!S)return;if(!C||!S)return null==this._firstMove&&(this._firstMove=x),x-this._firstMove<100&&void 0;const k=d.y>0==f.y>0;return hp(d)&&hp(f)&&k}}const Ey={panStep:100,bearingStep:15,pitchStep:10};class _l{constructor(){const d=Ey;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(d){if(d.altKey||d.ctrlKey||d.metaKey)return;let f=0,x=0,C=0,S=0,k=0;switch(d.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:d.shiftKey?x=-1:(d.preventDefault(),S=-1);break;case 39:d.shiftKey?x=1:(d.preventDefault(),S=1);break;case 38:d.shiftKey?C=1:(d.preventDefault(),k=-1);break;case 40:d.shiftKey?C=-1:(d.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(x=0,C=0),{cameraAnimation:P=>{const L=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:Ag,zoom:f?Math.round(L)+f*(d.shiftKey?2:1):L,bearing:P.getBearing()+x*this._bearingStep,pitch:P.getPitch()+C*this._pitchStep,offset:[-S*this._panStep,-k*this._panStep],center:P.getCenter()},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ag(y){return y*(2-y)}const pp=4.000244140625;class Kn{constructor(d,f){this._map=d,this._el=d.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,m.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(d){this._defaultZoomRate=d}setWheelZoomRate(d){this._wheelZoomRate=d}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(d){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(d.ctrlKey||d.metaKey||this.isZooming()||m.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=d.deltaMode===m.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY;const x=m.exported.now(),C=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,0!==f&&f%pp==0?this._type="wheel":0!==f&&Math.abs(f)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(C*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),d.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=d,this._delta-=f,this._active||this._start(d)),d.preventDefault()}_onTimeout(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)}_start(d){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=Ue(this._el,d);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const d=this._map.transform;"wheel"===this._type&&d.projection.wrap&&(d._center.lng>=180||d._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>d._terrainEnabled()&&this._aroundCoord?d.computeZoomRelativeTo(this._aroundCoord):d.zoom;if(0!==this._delta){const L="wheel"===this._type&&Math.abs(this._delta)>pp?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&0!==H&&(H=1/H);const $=f(),Q=Math.pow(2,$),oe="number"==typeof this._targetZoom?d.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(d.maxZoom,Math.max(d.minZoom,d.scaleZoom(oe*H))),"wheel"===this._type&&(this._startZoom=$,this._easing=this._smoothOutEasing(200)),this._delta=0}const x="number"==typeof this._targetZoom?this._targetZoom:f(),C=this._startZoom,S=this._easing;let k,P=!1;if("wheel"===this._type&&C&&S){const L=Math.min((m.exported.now()-this._lastWheelEventTime)/200,1),H=S(L);k=m.number(C,x,H),L<1?this._frameId||(this._frameId=!0):P=!0}else k=x,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:k-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(d){let f=m.ease;if(this._prevEase){const x=this._prevEase,C=(m.exported.now()-x.start)/x.duration,S=x.easing(C+.01)-x.easing(C),k=.27/Math.sqrt(S*S+1e-4)*.01,P=Math.sqrt(.0729-k*k);f=m.bezier(k,P,.25,1)}return this._prevEase={start:m.exported.now(),duration:d,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ye("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(m.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class $f{constructor(d,f){this._clickZoom=d,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Yd{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(d,f){return d.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:x.getZoom()+(d.shiftKey?-1:1),around:x.unproject(f)},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ga{constructor(){this._tap=new $u({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(d,f,x){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=f[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(d,f,x))}touchmove(d,f,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const C=f[0],S=C.y-this._swipePoint.y;return this._swipePoint=C,d.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(d,f,x)}touchend(d,f,x){this._tapTime?this._swipePoint&&0===x.length&&this.reset():this._tap.touchend(d,f,x)&&(this._tapTime=d.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fp{constructor(d,f,x){this._el=d,this._mousePan=f,this._touchPan=x}enable(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ln{constructor(d,f,x){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=f,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Gf{constructor(d,f,x,C){this._el=d,this._touchZoom=f,this._touchRotate=x,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Qd=y=>y.zoom||y.drag||y.pitch||y.rotate;class Jd extends m.Event{}class Lt{constructor(){this.constants=[1,1,.01],this.radius=0}setup(d,f){const x=m.sub([],f,d);this.radius=m.length(x[2]<0?m.div([],x,this.constants):[x[0],x[1],0])}projectRay(d){m.div(d,d,this.constants),m.normalize(d,d),m.mul$1(d,d,this.constants);const f=m.scale$2([],d,this.radius);if(f[2]>0){const x=m.scale$2([],[0,0,1],m.dot(f,[0,0,1])),C=m.scale$2([],m.normalize([],[f[0],f[1],0]),this.radius),S=m.add([],f,m.scale$2([],m.sub([],m.add([],C,x),f),2));f[0]=S[0],f[1]=S[1]}return f}}function Pi(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class Ie{constructor(d,f){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Nf(d),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Lt,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),m.bindAll(["handleEvent","handleWindowEvent"],this);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[m.window.document,"mousemove",{capture:!0}],[m.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[m.window,"blur",void 0]];for(const[C,S,k]of this._listeners)C.addEventListener(S,C===m.window.document?this.handleWindowEvent:this.handleEvent,k)}destroy(){for(const[d,f,x]of this._listeners)d.removeEventListener(f,d===m.window.document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(d){const f=this._map,x=f.getCanvasContainer();this._add("mapEvent",new Bf(f,d));const C=f.boxZoom=new Vf(f,d);this._add("boxZoom",C);const S=new Xd,k=new Yd;f.doubleClickZoom=new $f(k,S),this._add("tapZoom",S),this._add("clickZoom",k);const P=new Ga;this._add("tapDragZoom",P);const L=f.touchPitch=new hr(f);this._add("touchPitch",L);const H=new dp(d),$=new dr(d);f.dragRotate=new ln(d,H,$),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const Q=new jf(d),oe=new Gu(f,d);f.dragPan=new fp(x,Q,oe),this._add("mousePan",Q),this._add("touchPan",oe,["touchZoom","touchRotate"]);const ue=new Cs,ae=new Hf;f.touchZoomRotate=new Gf(x,ae,ue,P),this._add("touchRotate",ue,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]),this._add("blockableMapEvent",new up(f));const de=f.scrollZoom=new Kn(f,this);this._add("scrollZoom",de,["mousePan"]);const he=f.keyboard=new _l;this._add("keyboard",he);for(const ie of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])d.interactive&&d[ie]&&f[ie].enable(d[ie])}_add(d,f,x){this._handlers.push({handlerName:d,handler:f,allowed:x}),this._handlersById[d]=f}stop(d){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}}isActive(){for(const{handler:d}of this._handlers)if(d.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Qd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(d,f,x){for(const C in d)if(C!==x&&(!f||f.indexOf(C)<0))return!0;return!1}handleWindowEvent(d){this.handleEvent(d,`${d.type}Window`)}_getMapTouches(d){const f=[];for(const x of d)this._el.contains(x.target)&&f.push(x);return f}handleEvent(d,f){this._updatingCamera=!0;const x="renderFrame"===d.type,C=x?void 0:d,S={needsRenderFrame:!1},k={},P={},L=d.touches?this._getMapTouches(d.touches):void 0,H=L?rt(this._el,L):x?void 0:Ue(this._el,d);for(const{handlerName:oe,handler:ue,allowed:ae}of this._handlers){if(!ue.isEnabled())continue;let de;this._blockedByActive(P,ae,oe)?ue.reset():ue[f||d.type]&&(de=ue[f||d.type](d,H,L),this.mergeHandlerResult(S,k,de,oe,C),de&&de.needsRenderFrame&&this._triggerRenderFrame()),(de||ue.isActive())&&(P[oe]=ue)}const $={};for(const oe in this._previousActiveHandlers)P[oe]||($[oe]=C);this._previousActiveHandlers=P,(Object.keys($).length||Pi(S))&&(this._changes.push([S,k,$]),this._triggerRenderFrame()),(Object.keys(P).length||Pi(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=S;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))}mergeHandlerResult(d,f,x,C,S){if(!x)return;m.extend(d,x);const k={handlerName:C,originalEvent:x.originalEvent||S};void 0!==x.zoomDelta&&(f.zoom=k),void 0!==x.panDelta&&(f.drag=k),void 0!==x.pitchDelta&&(f.pitch=k),void 0!==x.bearingDelta&&(f.rotate=k)}_applyChanges(){const d={},f={},x={};for(const[C,S,k]of this._changes)C.panDelta&&(d.panDelta=(d.panDelta||new m.pointGeometry(0,0))._add(C.panDelta)),C.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+C.pitchDelta),void 0!==C.around&&(d.around=C.around),void 0!==C.aroundCoord&&(d.aroundCoord=C.aroundCoord),void 0!==C.pinchAround&&(d.pinchAround=C.pinchAround),C.noInertia&&(d.noInertia=C.noInertia),m.extend(f,S),m.extend(x,k);this._updateMapTransform(d,f,x),this._changes=[]}_updateMapTransform(d,f,x){const C=this._map,S=C.transform,k=ye=>[ye.x,ye.y,ye.z];if((ye=>{const ge=this._eventsInProgress.drag;return ge&&!this._handlersById[ge.handlerName].isActive()})()&&!Pi(d)){const ye=S.zoom;S.cameraElevationReference="sea",S.recenterOnTerrain(),S.cameraElevationReference="ground",ye!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&C._stop(!0),!Pi(d))return void this._fireEvents(f,x,!0);let{panDelta:P,zoomDelta:L,bearingDelta:H,pitchDelta:$,around:Q,aroundCoord:oe,pinchAround:ue}=d;S._isCameraConstrained&&(L>0&&(L=0),S._isCameraConstrained=!1),void 0!==ue&&(Q=ue),(L||(ye=>f.drag&&!this._eventsInProgress.drag)())&&Q&&(this._dragOrigin=k(S.pointCoordinate3D(Q)),this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",C._stop(!0),Q=Q||C.transform.centerPoint,H&&(S.bearing+=H),$&&(S.pitch+=$),S._updateCameraState();const ae=[0,0,0];if(P)if("mercator"===S.projection.name){const ye=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(Q).dir),ge=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(Q.sub(P)).dir);ae[0]=ge[0]-ye[0],ae[1]=ge[1]-ye[1]}else{const ye=S.pointCoordinate(Q);if("globe"===S.projection.name){P=P.rotate(-S.angle);const ge=S._pixelsPerMercatorPixel/S.worldSize;ae[0]=-P.x*m.mercatorScale(m.latFromMercatorY(ye.y))*ge,ae[1]=-P.y*m.mercatorScale(S.center.lat)*ge}else{const ge=S.pointCoordinate(Q.sub(P));ye&&ge&&(ae[0]=ge.x-ye.x,ae[1]=ge.y-ye.y)}}const de=S.zoom,he=[0,0,0];if(L){const ye=k(oe||S.pointCoordinate3D(Q)),ge={dir:m.normalize([],m.sub([],ye,S._camera.position))};if(ge.dir[2]<0){const Ce=S.zoomDeltaToMovement(ye,L);m.scale$2(he,ge.dir,Ce)}}const ie=m.add(ae,ae,he);S._translateCameraConstrained(ie),L&&Math.abs(S.zoom-de)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(f,x,!0)}_fireEvents(d,f,x){const C=Qd(this._eventsInProgress),S=Qd(d),k={};for(const $ in d){const{originalEvent:Q}=d[$];this._eventsInProgress[$]||(k[`${$}start`]=Q),this._eventsInProgress[$]=d[$]}!C&&S&&this._fireEvent("movestart",S.originalEvent);for(const $ in k)this._fireEvent($,k[$]);S&&this._fireEvent("move",S.originalEvent);for(const $ in d){const{originalEvent:Q}=d[$];this._fireEvent($,Q)}const P={};let L;for(const $ in this._eventsInProgress){const{handlerName:Q,originalEvent:oe}=this._eventsInProgress[$];this._handlersById[Q].isActive()||(delete this._eventsInProgress[$],L=f[Q]||oe,P[`${$}end`]=L)}for(const $ in P)this._fireEvent($,P[$]);const H=Qd(this._eventsInProgress);if(x&&(C||S)&&!H){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=oe=>0!==oe&&-this._bearingSnap<oe&&oe<this._bearingSnap;$?(Q($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:L})):(this._map.fire(new m.Event("moveend",{originalEvent:L})),Q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(d,f){this._map.fire(new m.Event(d,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(d=>{this._frameId=void 0,this.handleEvent(new Jd("renderFrame",{timeStamp:d})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Me="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class xr extends m.Evented{constructor(d,f){super(),this._moving=!1,this._zooming=!1,this.transform=d,this._bearingSnap=f.bearingSnap,m.bindAll(["_renderFrameCallback"],this)}getCenter(){return new m.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(d,f){return this.jumpTo({center:d},f)}panBy(d,f,x){return d=m.pointGeometry.convert(d).mult(-1),this.panTo(this.transform.center,m.extend({offset:d},f),x)}panTo(d,f,x){return this.easeTo(m.extend({center:d},f),x)}getZoom(){return this.transform.zoom}setZoom(d,f){return this.jumpTo({zoom:d},f),this}zoomTo(d,f,x){return this.easeTo(m.extend({zoom:d},f),x)}zoomIn(d,f){return this.zoomTo(this.getZoom()+1,d,f),this}zoomOut(d,f){return this.zoomTo(this.getZoom()-1,d,f),this}getBearing(){return this.transform.bearing}setBearing(d,f){return this.jumpTo({bearing:d},f),this}getPadding(){return this.transform.padding}setPadding(d,f){return this.jumpTo({padding:d},f),this}rotateTo(d,f,x){return this.easeTo(m.extend({bearing:d},f),x)}resetNorth(d,f){return this.rotateTo(0,m.extend({duration:1e3},d),f),this}resetNorthPitch(d,f){return this.easeTo(m.extend({bearing:0,pitch:0,duration:1e3},d),f),this}snapToNorth(d,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(d,f):this}getPitch(){return this.transform.pitch}setPitch(d,f){return this.jumpTo({pitch:d},f),this}cameraForBounds(d,f){d=m.LngLatBounds.convert(d);const x=f&&f.bearing||0,C=f&&f.pitch||0,S=d.getNorthWest(),k=d.getSouthEast();return this._cameraForBounds(this.transform,S,k,x,C,f)}_extendCameraOptions(d){const f={top:0,bottom:0,right:0,left:0};if("number"==typeof(d=m.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding){const x=d.padding;d.padding={top:x,bottom:x,right:x,left:x}}return d.padding=m.extend(f,d.padding),d}_minimumAABBFrustumDistance(d,f){const x=f.max[0]-f.min[0],C=f.max[1]-f.min[1];return x/C>d.aspect?x/(2*Math.tan(.5*d.fovX)*d.aspect):C/(2*Math.tan(.5*d.fovY)*d.aspect)}_cameraForBoundsOnGlobe(d,f,x,C,S,k){const P=d.clone(),L=this._extendCameraOptions(k);P.bearing=C,P.pitch=S;const H=m.LngLat.convert(f),$=m.LngLat.convert(x),Q=.5*(H.lat+$.lat),oe=.5*(H.lng+$.lng),ue=m.latLngToECEF(Q,oe),ae=m.normalize([],ue),de=m.normalize([],m.cross([],ae,[0,1,0])),he=m.cross([],de,ae),ie=[de[0],de[1],de[2],0,he[0],he[1],he[2],0,ae[0],ae[1],ae[2],0,0,0,0,1],ye=[ue,m.latLngToECEF(H.lat,H.lng),m.latLngToECEF($.lat,H.lng),m.latLngToECEF($.lat,$.lng),m.latLngToECEF(H.lat,$.lng),m.latLngToECEF(Q,H.lng),m.latLngToECEF(Q,$.lng),m.latLngToECEF(H.lat,oe),m.latLngToECEF($.lat,oe)];let ge=m.Aabb.fromPoints(ye.map(Mt=>[m.dot(de,Mt),m.dot(he,Mt),m.dot(ae,Mt)]));const Ce=m.transformMat4([],ge.center,ie);0===m.squaredLength(Ce)&&m.set(Ce,0,0,1),m.normalize(Ce,Ce),m.scale$2(Ce,Ce,m.GLOBE_RADIUS),P.center=m.ecefToLatLng(Ce);const Pe=P.getWorldToCameraMatrix(),ke=m.invert(new Float64Array(16),Pe);ge=m.Aabb.applyTransform(ge,m.multiply([],Pe,ie)),m.transformMat4(Ce,Ce,Pe);const Le=.5*(ge.max[2]-ge.min[2]),$e=this._minimumAABBFrustumDistance(P,ge),nt=m.scale$2([],[0,0,1],Le),ot=m.add(nt,Ce,nt),zt=$e+(0===P.pitch?0:m.distance(Ce,ot)),Ze=P.globeCenterInViewSpace,Ct=m.sub([],Ce,[Ze[0],Ze[1],Ze[2]]);m.normalize(Ct,Ct),m.scale$2(Ct,Ct,zt);const ut=m.add([],Ce,Ct);m.transformMat4(ut,ut,ke);const kt=m.earthRadius/m.GLOBE_RADIUS,it=m.length(ut),je=m.mercatorZfromAltitude(Math.max(it*kt-m.earthRadius,Number.EPSILON),0),lt=Math.min(P.zoomFromMercatorZAdjusted(je),L.maxZoom);return lt>.5*(m.GLOBE_ZOOM_THRESHOLD_MIN+m.GLOBE_ZOOM_THRESHOLD_MAX)?(P.setProjection({name:"mercator"}),P.zoom=lt,this._cameraForBounds(P,f,x,C,S,k)):{center:P.center,zoom:lt,bearing:C,pitch:S}}queryTerrainElevation(d,f){const x=this.transform.elevation;return x?(f=m.extend({},{exaggerated:!0},f),x.getAtPoint(m.MercatorCoordinate.fromLngLat(d),null,f.exaggerated)):null}_cameraForBounds(d,f,x,C,S,k){if("globe"===d.projection.name)return this._cameraForBoundsOnGlobe(d,f,x,C,S,k);const P=d.clone(),L=this._extendCameraOptions(k),H=P.padding;P.bearing=C,P.pitch=S;const $=m.LngLat.convert(f),Q=m.LngLat.convert(x),oe=new m.LngLat($.lng,Q.lat),ue=new m.LngLat(Q.lng,$.lat),ae=P.project($),de=P.project(Q),he=this.queryTerrainElevation($),ie=this.queryTerrainElevation(Q),ye=this.queryTerrainElevation(oe),ge=this.queryTerrainElevation(ue),Ce=[[ae.x,ae.y,Math.min(he||0,ie||0,ye||0,ge||0)],[de.x,de.y,Math.max(he||0,ie||0,ye||0,ge||0)]];let Pe=m.Aabb.fromPoints(Ce);const ke=P.getWorldToCameraMatrix(),Le=m.invert(new Float64Array(16),ke);Pe=m.Aabb.applyTransform(Pe,ke);const $e=m.sub([],Pe.max,Pe.min),nt=H.left||0,ot=H.right||0,zt=H.bottom||0,Ze=H.top||0,{left:Ct,right:ut,top:kt,bottom:it}=L.padding,je=.5*(nt+ot),lt=.5*(Ze+zt),Mt=Math.min(P.scaleZoom(P.scale*Math.min((P.width-(nt+ot+Ct+ut))/$e[0],(P.height-(zt+Ze+it+kt))/$e[1])),L.maxZoom),Pt=P.scale/P.zoomScale(Mt);Pe=new m.Aabb([Pe.min[0]-(Ct+je)*Pt,Pe.min[1]-(it+lt)*Pt,Pe.min[2]],[Pe.max[0]+(ut+je)*Pt,Pe.max[1]+(kt+lt)*Pt,Pe.max[2]]);const hn=.5*$e[2],ni=this._minimumAABBFrustumDistance(P,Pe),cn=[0,0,1,0];m.transformMat4$1(cn,cn,ke),m.normalize$2(cn,cn);const Zt=m.scale$2([],cn,ni+hn),bn=m.add([],Pe.center,Zt),yi=("number"==typeof L.offset.x&&"number"==typeof L.offset.y?new m.pointGeometry(L.offset.x,L.offset.y):m.pointGeometry.convert(L.offset)).rotate(-m.degToRad(C));Pe.center[0]-=yi.x*Pt,Pe.center[1]+=yi.y*Pt,m.transformMat4(Pe.center,Pe.center,Le),m.transformMat4(bn,bn,Le);const Tn=[Pe.center[0],Pe.center[1],bn[2]*P.pixelsPerMeter];m.scale$2(Tn,Tn,1/P.worldSize);const $i=m.lngFromMercatorX(Tn[0]),Gi=m.latFromMercatorY(Tn[1]),so=Math.min(P._zoomFromMercatorZ(Tn[2]),L.maxZoom),Xi=new m.LngLat($i,Gi);return P.mercatorFromTransition&&so<.5*(m.GLOBE_ZOOM_THRESHOLD_MIN+m.GLOBE_ZOOM_THRESHOLD_MAX)?(P.setProjection({name:"globe"}),P.zoom=so,this._cameraForBounds(P,f,x,C,S,k)):{center:Xi,zoom:so,bearing:C,pitch:S}}fitBounds(d,f,x){const C=this.cameraForBounds(d,f);return this._fitInternal(C,f,x)}fitScreenCoordinates(d,f,x,C,S){const k=m.pointGeometry.convert(d),P=m.pointGeometry.convert(f),L=new m.pointGeometry(Math.min(k.x,P.x),Math.min(k.y,P.y)),H=new m.pointGeometry(Math.max(k.x,P.x),Math.max(k.y,P.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(k,P))return this;const $=this.transform.pointLocation3D(L),Q=this.transform.pointLocation3D(H),oe=this.transform.pointLocation3D(new m.pointGeometry(L.x,H.y)),ue=this.transform.pointLocation3D(new m.pointGeometry(H.x,L.y)),ae=[Math.min($.lng,Q.lng,oe.lng,ue.lng),Math.min($.lat,Q.lat,oe.lat,ue.lat)],de=[Math.max($.lng,Q.lng,oe.lng,ue.lng),Math.max($.lat,Q.lat,oe.lat,ue.lat)],he=C&&C.pitch?C.pitch:this.getPitch(),ie=this._cameraForBounds(this.transform,ae,de,x,he,C);return this._fitInternal(ie,C,S)}_fitInternal(d,f,x){return d?(delete(f=m.extend(d,f)).padding,f.linear?this.easeTo(f,x):this.flyTo(f,x)):this}jumpTo(d,f){this.stop();const x=d.preloadOnly?this.transform.clone():this.transform;let C=!1,S=!1,k=!1;return"zoom"in d&&x.zoom!==+d.zoom&&(C=!0,x.zoom=+d.zoom),void 0!==d.center&&(x.center=m.LngLat.convert(d.center)),"bearing"in d&&x.bearing!==+d.bearing&&(S=!0,x.bearing=+d.bearing),"pitch"in d&&x.pitch!==+d.pitch&&(k=!0,x.pitch=+d.pitch),null==d.padding||x.isPaddingEqual(d.padding)||(x.padding=d.padding),d.preloadOnly?(this._preloadTiles(x),this):(this.fire(new m.Event("movestart",f)).fire(new m.Event("move",f)),C&&this.fire(new m.Event("zoomstart",f)).fire(new m.Event("zoom",f)).fire(new m.Event("zoomend",f)),S&&this.fire(new m.Event("rotatestart",f)).fire(new m.Event("rotate",f)).fire(new m.Event("rotateend",f)),k&&this.fire(new m.Event("pitchstart",f)).fire(new m.Event("pitch",f)).fire(new m.Event("pitchend",f)),this.fire(new m.Event("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||m.warnOnce(Me),this.transform.getFreeCameraOptions()}setFreeCameraOptions(d,f){const x=this.transform;if(!x.projection.supportsFreeCamera)return m.warnOnce(Me),this;this.stop();const C=x.zoom,S=x.pitch,k=x.bearing;x.setFreeCameraOptions(d);const P=C!==x.zoom,L=S!==x.pitch,H=k!==x.bearing;return this.fire(new m.Event("movestart",f)).fire(new m.Event("move",f)),P&&this.fire(new m.Event("zoomstart",f)).fire(new m.Event("zoom",f)).fire(new m.Event("zoomend",f)),H&&this.fire(new m.Event("rotatestart",f)).fire(new m.Event("rotate",f)).fire(new m.Event("rotateend",f)),L&&this.fire(new m.Event("pitchstart",f)).fire(new m.Event("pitch",f)).fire(new m.Event("pitchend",f)),this.fire(new m.Event("moveend",f)),this}easeTo(d,f){this._stop(!1,d.easeId),(!1===(d=m.extend({offset:[0,0],duration:500,easing:m.ease},d)).animate||!d.essential&&m.exported.prefersReducedMotion)&&(d.duration=0);const x=this.transform,C=this.getZoom(),S=this.getBearing(),k=this.getPitch(),P=this.getPadding(),L="zoom"in d?+d.zoom:C,H="bearing"in d?this._normalizeBearing(d.bearing,S):S,$="pitch"in d?+d.pitch:k,Q="padding"in d?d.padding:x.padding,oe=m.pointGeometry.convert(d.offset);let ue,ae,de;if("globe"===x.projection.name){const nt=m.MercatorCoordinate.fromLngLat(x.center),ot=oe.rotate(-x.angle);nt.x+=ot.x/x.worldSize,nt.y+=ot.y/x.worldSize;const zt=nt.toLngLat(),Ze=m.LngLat.convert(d.center||zt);this._normalizeCenter(Ze),ue=x.centerPoint.add(ot),ae=new m.pointGeometry(nt.x,nt.y).mult(x.worldSize),de=new m.pointGeometry(m.mercatorXfromLng(Ze.lng),m.mercatorYfromLat(Ze.lat)).mult(x.worldSize).sub(ae)}else{ue=x.centerPoint.add(oe);const nt=x.pointLocation(ue),ot=m.LngLat.convert(d.center||nt);this._normalizeCenter(ot),ae=x.project(nt),de=x.project(ot).sub(ae)}const he=x.zoomScale(L-C);let ie,ye;d.around&&(ie=m.LngLat.convert(d.around),ye=x.locationPoint(ie));const ge=this._zooming||L!==C,Ce=this._rotating||S!==H,Pe=this._pitching||$!==k,ke=!x.isPaddingEqual(Q),Le=nt=>ot=>{if(ge&&(nt.zoom=m.number(C,L,ot)),Ce&&(nt.bearing=m.number(S,H,ot)),Pe&&(nt.pitch=m.number(k,$,ot)),ke&&(nt.interpolatePadding(P,Q,ot),ue=nt.centerPoint.add(oe)),ie)nt.setLocationAtPoint(ie,ye);else{const zt=nt.zoomScale(nt.zoom-C),Ze=L>C?Math.min(2,he):Math.max(.5,he),Ct=Math.pow(Ze,1-ot),ut=nt.unproject(ae.add(de.mult(ot*Ct)).mult(zt));nt.setLocationAtPoint(nt.renderWorldCopies?ut.wrap():ut,ue)}return d.preloadOnly||this._fireMoveEvents(f),nt};if(d.preloadOnly){const nt=this._emulate(Le,d.duration,x);return this._preloadTiles(nt),this}const $e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ge,this._rotating=Ce,this._pitching=Pe,this._padding=ke,this._easeId=d.easeId,this._prepareEase(f,d.noMoveStart,$e),this._ease(Le(x),nt=>{x.recenterOnTerrain(),this._afterEase(f,nt)},d),this}_prepareEase(d,f,x={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||x.moving||this.fire(new m.Event("movestart",d)),this._zooming&&!x.zooming&&this.fire(new m.Event("zoomstart",d)),this._rotating&&!x.rotating&&this.fire(new m.Event("rotatestart",d)),this._pitching&&!x.pitching&&this.fire(new m.Event("pitchstart",d))}_fireMoveEvents(d){this.fire(new m.Event("move",d)),this._zooming&&this.fire(new m.Event("zoom",d)),this._rotating&&this.fire(new m.Event("rotate",d)),this._pitching&&this.fire(new m.Event("pitch",d))}_afterEase(d,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const x=this._zooming,C=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new m.Event("zoomend",d)),C&&this.fire(new m.Event("rotateend",d)),S&&this.fire(new m.Event("pitchend",d)),this.fire(new m.Event("moveend",d))}flyTo(d,f){if(!d.essential&&m.exported.prefersReducedMotion){const Mt=m.pick(d,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Mt,f)}this.stop(),d=m.extend({offset:[0,0],speed:1.2,curve:1.42,easing:m.ease},d);const x=this.transform,C=this.getZoom(),S=this.getBearing(),k=this.getPitch(),P=this.getPadding(),L="zoom"in d?m.clamp(+d.zoom,x.minZoom,x.maxZoom):C,H="bearing"in d?this._normalizeBearing(d.bearing,S):S,$="pitch"in d?+d.pitch:k,Q="padding"in d?d.padding:x.padding,oe=x.zoomScale(L-C),ue=m.pointGeometry.convert(d.offset);let ae=x.centerPoint.add(ue);const de=x.pointLocation(ae),he=m.LngLat.convert(d.center||de);this._normalizeCenter(he);const ie=x.project(de),ye=x.project(he).sub(ie);let ge=d.curve;const Ce=Math.max(x.width,x.height),Pe=Ce/oe,ke=ye.mag();if("minZoom"in d){const Mt=m.clamp(Math.min(d.minZoom,C,L),x.minZoom,x.maxZoom),Pt=Ce/x.zoomScale(Mt-C);ge=Math.sqrt(Pt/ke*2)}const Le=ge*ge;function $e(Mt){const Pt=(Pe*Pe-Ce*Ce+(Mt?-1:1)*Le*Le*ke*ke)/(2*(Mt?Pe:Ce)*Le*ke);return Math.log(Math.sqrt(Pt*Pt+1)-Pt)}function nt(Mt){return(Math.exp(Mt)-Math.exp(-Mt))/2}function ot(Mt){return(Math.exp(Mt)+Math.exp(-Mt))/2}const zt=$e(0);let Ze=function(Mt){return ot(zt)/ot(zt+ge*Mt)},Ct=function(Mt){return Ce*((ot(zt)*(nt(Pt=zt+ge*Mt)/ot(Pt))-nt(zt))/Le)/ke;var Pt},ut=($e(1)-zt)/ge;if(Math.abs(ke)<1e-6||!isFinite(ut)){if(Math.abs(Ce-Pe)<1e-6)return this.easeTo(d,f);const Mt=Pe<Ce?-1:1;ut=Math.abs(Math.log(Pe/Ce))/ge,Ct=function(){return 0},Ze=function(Pt){return Math.exp(Mt*ge*Pt)}}d.duration="duration"in d?+d.duration:1e3*ut/("screenSpeed"in d?+d.screenSpeed/ge:+d.speed),d.maxDuration&&d.duration>d.maxDuration&&(d.duration=0);const kt=S!==H,it=$!==k,je=!x.isPaddingEqual(Q),lt=Mt=>Pt=>{const hn=Pt*ut,ni=1/Ze(hn);Mt.zoom=1===Pt?L:C+Mt.scaleZoom(ni),kt&&(Mt.bearing=m.number(S,H,Pt)),it&&(Mt.pitch=m.number(k,$,Pt)),je&&(Mt.interpolatePadding(P,Q,Pt),ae=Mt.centerPoint.add(ue));const cn=1===Pt?he:Mt.unproject(ie.add(ye.mult(Ct(hn))).mult(ni));return Mt.setLocationAtPoint(Mt.renderWorldCopies?cn.wrap():cn,ae),Mt._updateCameraOnTerrain(),d.preloadOnly||this._fireMoveEvents(f),Mt};if(d.preloadOnly){const Mt=this._emulate(lt,d.duration,x);return this._preloadTiles(Mt),this}return this._zooming=!0,this._rotating=kt,this._pitching=it,this._padding=je,this._prepareEase(f,!1),this._ease(lt(x),()=>this._afterEase(f),d),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(d,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const x=this._onEaseEnd;this._onEaseEnd=void 0,x.call(this,f)}if(!d){const x=this.handlers;x&&x.stop(!1)}return this}_ease(d,f,x){!1===x.animate||0===x.duration?(d(1),f()):(this._easeStart=m.exported.now(),this._easeOptions=x,this._onEaseFrame=d,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const d=Math.min((m.exported.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(d)),d<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(d,f){d=m.wrap(d,-180,180);const x=Math.abs(d-f);return Math.abs(d-360-f)<x&&(d-=360),Math.abs(d+360-f)<x&&(d+=360),d}_normalizeCenter(d){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const x=d.lng-f.center.lng;d.lng+=x>180?-360:x<-180?360:0}_emulate(d,f,x){const C=Math.ceil(15*f/1e3),S=[],k=d(x.clone());for(let P=0;P<=C;P++){const L=k(P/C);S.push(L.clone())}return S}}class mp{constructor(d={}){this.options=d,m.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(d){const f=this.options&&this.options.compact;return this._map=d,this._container=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ye("button","mapboxgl-ctrl-attrib-button",this._container),Ye("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ye("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===f&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(d,f){const x=this._map._getUIString(`AttributionControl.${f}`);d.setAttribute("aria-label",x),d.removeAttribute("title"),d.firstElementChild&&d.firstElementChild.setAttribute("title",x)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||m.config.ACCESS_TOKEN}];if(d){const x=f.reduce((C,S,k)=>(S.value&&(C+=`${S.key}=${S.value}${k<f.length-1?"&":""}`),C),"?");d.href=`${m.config.FEEDBACK_URL}/${x}#${Mg(this._map,!0)}`,d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}}_updateData(d){!d||"metadata"!==d.sourceDataType&&"visibility"!==d.sourceDataType&&"style"!==d.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let d=[];if(this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const f=this._map.style._sourceCaches;for(const C in f){const S=f[C];if(S.used){const k=S.getSource();k.attribution&&d.indexOf(k.attribution)<0&&d.push(k.attribution)}}d.sort((C,S)=>C.length-S.length),d=d.filter((C,S)=>{for(let k=S+1;k<d.length;k++)if(d[k].indexOf(C)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=[...this.options.customAttribution,...d]:d.unshift(this.options.customAttribution));const x=d.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,d.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Lc{constructor(){m.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(d){this._map=d,this._container=Ye("div","mapboxgl-ctrl");const f=Ye("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(d){d&&"metadata"!==d.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const d=this._map.style._sourceCaches;if(0===Object.entries(d).length)return!0;for(const f in d){const x=d[f].getSource();if(x.hasOwnProperty("mapbox_logo")&&!x.mapbox_logo)return!1}return!0}_updateCompact(){const d=this._container.children;if(d.length){const f=d[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class Ts{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(d){const f=++this._id;return this._queue.push({callback:d,id:f,cancelled:!1}),f}remove(d){const f=this._currentlyRunning,x=f?this._queue.concat(f):this._queue;for(const C of x)if(C.id===d)return void(C.cancelled=!0)}run(d=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const x of f)if(!x.cancelled&&(x.callback(d),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Wu(y,d,f){if(y=new m.LngLat(y.lng,y.lat),d){const x=new m.LngLat(y.lng-360,y.lat),C=new m.LngLat(y.lng+360,y.lat),S=360*Math.ceil(Math.abs(y.lng-f.center.lng)/360),k=f.locationPoint(y).distSqr(d),P=d.x<0||d.y<0||d.x>f.width||d.y>f.height;f.locationPoint(x).distSqr(d)<k&&(P||Math.abs(x.lng-f.center.lng)<S)?y=x:f.locationPoint(C).distSqr(d)<k&&(P||Math.abs(C.lng-f.center.lng)<S)&&(y=C)}for(;Math.abs(y.lng-f.center.lng)>180;){const x=f.locationPoint(y);if(x.x>=0&&x.y>=0&&x.x<=f.width&&x.y<=f.height)break;y.lng>f.center.lng?y.lng-=360:y.lng+=360}return y}const $l={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class gp extends m.Evented{constructor(d,f){if(super(),(d instanceof m.window.HTMLElement||f)&&(d=m.extend({element:d},f)),m.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._scale=d&&d.scale||1,this._draggable=d&&d.draggable||!1,this._clickTolerance=d&&d.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=d&&d.rotation||0,this._rotationAlignment=d&&d.rotationAlignment||"auto",this._pitchAlignment=d&&d.pitchAlignment&&d.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=d&&d.occludedOpacity||.2,d&&d.element)this._element=d.element,this._offset=m.pointGeometry.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ye("div");const C=41,S=27,k=Ft("svg",{display:"block",height:C*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${C}`},this._element),P=Ft("radialGradient",{id:"shadowGradient"},Ft("defs",{},k));Ft("stop",{offset:"10%","stop-opacity":.4},P),Ft("stop",{offset:"100%","stop-opacity":.05},P),Ft("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},k),Ft("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},k),Ft("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},k),Ft("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},k),this._offset=m.pointGeometry.convert(d&&d.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",C=>{C.preventDefault()}),this._element.addEventListener("mousedown",C=>{C.preventDefault()});const x=this._element.classList;for(const C in $l)x.remove(`mapboxgl-marker-anchor-${C}`);x.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(d){return d===this._map||(this.remove(),this._map=d,d.getCanvasContainer().appendChild(this._element),d.on("move",this._updateMoving),d.on("moveend",this._update),d.on("remove",this._clearFadeTimer),d._addMarker(this),this.setDraggable(this._draggable),this._update(),d.on("click",this._onMapClick)),this}remove(){const d=this._map;return d&&(d.off("click",this._onMapClick),d.off("move",this._updateMoving),d.off("moveend",this._update),d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler),d.off("mouseup",this._onUp),d.off("touchend",this._onUp),d.off("mousemove",this._onMove),d.off("touchmove",this._onMove),d.off("remove",this._clearFadeTimer),d._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=m.LngLat.convert(d),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(d){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),d){if(!("offset"in d.options)){const C=Math.sqrt(Math.pow(13.5,2)/2);d.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(24.6+C)],"bottom-right":[-C,-1*(24.6+C)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=d,d._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(d){const f=d.code,x=d.charCode||d.keyCode;"Space"!==f&&"Enter"!==f&&32!==x&&13!==x||this.togglePopup()}_onMapClick(d){const f=d.originalEvent.target,x=this._element;this._popup&&(f===x||x.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const d=this._popup;return d?(d.isOpen()?(d.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(d.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const d=this._map,f=this._pos;if(!d||!f)return!1;const x=d.unproject(f),C=d.getFreeCameraOptions();if(!C.position)return!1;const S=C.position.toLngLat();return S.distanceTo(x)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const d=this._map;if(!d)return;const f=this._pos;if(!f||f.x<0||f.x>d.transform.width||f.y<0||f.y>d.transform.height)return void this._clearFadeTimer();const x=d.unproject(f);let C;d._showingGlobe()&&m.isLngLatBehindGlobe(d.transform,this._lngLat)?C=0:(C=1-d._queryFogOpacity(x),d.transform._terrainEnabled()&&d.getTerrain()&&this._behindTerrain()&&(C*=this._occludedOpacity)),this._element.style.opacity=`${C}`,this._element.style.pointerEvents=C>0?"auto":"none",this._popup&&this._popup._setOpacity(C),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const d=this._pos;if(!d||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${d.x}px,${d.y}px)\n            ${$l[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${f.x}px,${f.y}px)\n        `}_calculateXYTransform(){const d=this._pos,f=this._map,x=this.getPitchAlignment();if(!f||!d||"map"!==x)return"";if(!f._showingGlobe()){const L=f.getPitch();return L?`rotateX(${L}deg)`:""}const C=m.radToDeg(m.globeTiltAtLngLat(f.transform,this._lngLat)),S=d.sub(m.globeCenterToScreenPoint(f.transform)),k=Math.abs(S.x)+Math.abs(S.y);if(0===k)return"";const P=C/k;return`rotateX(${-S.y*P}deg) rotateY(${S.x*P}deg)`}_calculateZTransform(){const d=this._pos,f=this._map;if(!f||!d)return"";let x=0;const C=this.getRotationAlignment();if("map"===C)if(f._showingGlobe()){const S=f.project(new m.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),k=f.project(new m.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(S);x=m.radToDeg(Math.atan2(k.y,k.x))-90}else x=-f.getBearing();else if("horizon"===C){const S=m.smoothstep(4,6,f.getZoom()),k=m.globeCenterToScreenPoint(f.transform);k.y+=S*f.transform.height;const P=d.sub(k),L=m.radToDeg(Math.atan2(P.y,P.x));x=(L>90?L-270:L+90)*(1-S)}return x+=this._rotation,x?`rotateZ(${x}deg)`:""}_update(d){m.window.cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=Wu(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),!0===d?this._updateFrameId=m.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(d){return this._offset=m.pointGeometry.convert(d),this._update(),this}_onMove(d){const f=this._map;if(!f)return;const x=this._pointerdownPos,C=this._positionDelta;if(x&&C){if(!this._isDragging){const S=this._clickTolerance||f._clickTolerance;if(d.point.dist(x)<S)return;this._isDragging=!0}this._pos=d.point.sub(C),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new m.Event("dragstart"))),this.fire(new m.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const d=this._map;d&&(d.off("mousemove",this._onMove),d.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new m.Event("dragend")),this._state="inactive"}_addDragHandler(d){const f=this._map,x=this._pos;f&&x&&this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(x),this._pointerdownPos=d.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(d){this._draggable=!!d;const f=this._map;return f&&(d?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(d){return this._rotation=d||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(d){return this._rotationAlignment=d||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(d){return this._pitchAlignment=d||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(d){return this._occludedOpacity=d||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Sy={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Wf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function zr(y=new m.pointGeometry(0,0),d="bottom"){if("number"==typeof y){const f=Math.round(Math.sqrt(.5*Math.pow(y,2)));switch(d){case"top":return new m.pointGeometry(0,y);case"top-left":return new m.pointGeometry(f,f);case"top-right":return new m.pointGeometry(-f,f);case"bottom":return new m.pointGeometry(0,-y);case"bottom-left":return new m.pointGeometry(f,-f);case"bottom-right":return new m.pointGeometry(-f,-f);case"left":return new m.pointGeometry(y,0);case"right":return new m.pointGeometry(-y,0)}return new m.pointGeometry(0,0)}return y instanceof m.pointGeometry||Array.isArray(y)?m.pointGeometry.convert(y):m.pointGeometry.convert(y[d]||[0,0])}class Wa{constructor(d){this.jumpTo(d)}getValue(d){if(d<=this._startTime)return this._start;if(d>=this._endTime)return this._end;const f=m.easeCubicInOut((d-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(d){return d>=this._startTime&&d<=this._endTime}jumpTo(d){this._startTime=-1/0,this._endTime=-1/0,this._start=d,this._end=d}easeTo(d,f,x){this._start=this.getValue(f),this._end=d,this._startTime=f,this._endTime=f+x}}const qf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Fc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ba={showCompass:!0,showZoom:!0,visualizePitch:!1};class Pg{constructor(d,f,x=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new dp({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,x&&(this.mousePitch=new dr({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),m.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(d,f){this.mouseRotate.mousedown(d,f),this.mousePitch&&this.mousePitch.mousedown(d,f),$t()}move(d,f){const x=this.map,C=this.mouseRotate.mousemoveWindow(d,f),S=C&&C.bearingDelta;if(S&&x.setBearing(x.getBearing()+S),this.mousePitch){const k=this.mousePitch.mousemoveWindow(d,f),P=k&&k.pitchDelta;P&&x.setPitch(x.getPitch()+P)}}off(){const d=this.element;d.removeEventListener("mousedown",this.mousedown),d.removeEventListener("touchstart",this.touchstart,{passive:!1}),d.removeEventListener("touchmove",this.touchmove),d.removeEventListener("touchend",this.touchend),d.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Bt(),m.window.removeEventListener("mousemove",this.mousemove),m.window.removeEventListener("mouseup",this.mouseup)}mousedown(d){this.down(m.extend({},d,{ctrlKey:!0,preventDefault:()=>d.preventDefault()}),Ue(this.element,d)),m.window.addEventListener("mousemove",this.mousemove),m.window.addEventListener("mouseup",this.mouseup)}mousemove(d){this.move(d,Ue(this.element,d))}mouseup(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()}touchstart(d){1!==d.targetTouches.length?this.reset():(this._startPos=this._lastPos=rt(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>d.preventDefault()},this._startPos))}touchmove(d){1!==d.targetTouches.length?this.reset():(this._lastPos=rt(this.element,d.targetTouches)[0],this.move({preventDefault:()=>d.preventDefault()},this._lastPos))}touchend(d){0===d.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Zf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Og={maxWidth:100,unit:"metric"};function Rg(y,d,f){const x=qu(d),C=x/d,S={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[f];this._map._requestDomTask(()=>{this._container.style.width=y*C+"px",this._container.innerHTML=`${x}&nbsp;${S}`})}function qu(y){const d=Math.pow(10,`${Math.floor(y)}`.length-1);let f=y/d;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:f>=1?1:function(x){const C=Math.pow(10,Math.ceil(-Math.log(x)/Math.LN10));return Math.round(x*C)/C}(f),d*f}const zc={version:m.version,supported:Je,setRTLTextPlugin:m.setRTLTextPlugin,getRTLTextPluginStatus:m.getRTLTextPluginStatus,Map:class extends xr{constructor(y){if(m.LivePerformanceUtils.mark(m.PerformanceMarkers.create),null!=(y=m.extend({},Fc,y)).minZoom&&null!=y.maxZoom&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=y.minPitch&&null!=y.maxPitch&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=y.minPitch&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=y.maxPitch&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(y.antialias&&m.isSafariWithAntialiasingBug(m.window)&&(y.antialias=!1,m.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Yt(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),y),this._interactive=y.interactive,this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._useWebGL2=y.useWebGL2,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=y.crossSourceCollisions,this._collectResourceTiming=y.collectResourceTiming,this._optimizeForTerrain=y.optimizeForTerrain,this._language=this._parseLanguage(y.language),this._worldview=y.worldview,this._renderTaskQueue=new Ts,this._domRenderTaskQueue=new Ts,this._controls=[],this._markers=[],this._popups=[],this._mapId=m.uniqueId(),this._locale=m.extend({},qf,y.locale),this._clickTolerance=y.clickTolerance,this._cooperativeGestures=y.cooperativeGestures,this._performanceMetricsCollection=y.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Wa(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new m.RequestManager(y.transformRequest,y.accessToken,y.testMode),this._silenceAuthErrors=!!y.testMode,"string"==typeof y.container){if(this._container=m.window.document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof m.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(this._container.childNodes.length>0&&m.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),y.maxBounds&&this.setMaxBounds(y.maxBounds),m.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==m.window&&(m.window.addEventListener("online",this._onWindowOnline,!1),m.window.addEventListener("resize",this._onWindowResize,!1),m.window.addEventListener("orientationchange",this._onWindowResize,!1),m.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),m.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Ie(this,y),this._localFontFamily=y.localFontFamily,this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),y.projection&&this.setProjection(y.projection),this._hash=y.hash&&new Cy("string"==typeof y.hash&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,m.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),y.attributionControl&&this.addControl(new mp({customAttribution:y.customAttribution})),this._logoControl=new Lc,this.addControl(this._logoControl,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update("style"===d.dataType),this.fire(new m.Event(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new m.Event(`${d.dataType}dataloading`,d))})}_getMapId(){return this._mapId}addControl(y,d){if(void 0===d&&(d=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new m.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=y.onAdd(this);this._controls.push(y);const x=this._controlPositions[d];return-1!==d.indexOf("bottom")?x.insertBefore(f,x.firstChild):x.appendChild(f),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new m.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const d=this._controls.indexOf(y);return d>-1&&this._controls.splice(d,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(y){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const d=!this._moving;return d&&this.fire(new m.Event("movestart",y)).fire(new m.Event("move",y)),this.fire(new m.Event("resize",y)),d&&this.fire(new m.Event("moveend",y)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(y){return this.transform.setMaxBounds(m.LngLatBounds.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y?this.setZoom(y):this.fire(new m.Event("zoomstart")).fire(new m.Event("zoom")).fire(new m.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y?this.setZoom(y):this.fire(new m.Event("zoomstart")).fire(new m.Event("zoom")).fire(new m.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y?this.setPitch(y):this.fire(new m.Event("pitchstart")).fire(new m.Event("pitch")).fire(new m.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y?this.setPitch(y):this.fire(new m.Event("pitchstart")).fire(new m.Event("pitch")).fire(new m.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(y){return"auto"===y?m.window.navigator.language:Array.isArray(y)?0===y.length?void 0:y.map(d=>"auto"===d?m.window.navigator.language:d):y}setLanguage(y){const d=this._parseLanguage(y);if(!this.style||d===this._language)return this;this._language=d,this.style._reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(y){return this.style&&y!==this._worldview?(this._worldview=y,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(y){return this._lazyInitEmptyStyle(),y?"string"==typeof y&&(y={name:y}):y=null,this._useExplicitProjection=!!y,this._prioritizeAndUpdateProjection(y,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const y=this.transform,d=y.projection.name;let f;"globe"===d&&y.zoom>=m.GLOBE_ZOOM_THRESHOLD_MAX?(y.setMercatorFromTransition(),f=!0):"mercator"===d&&y.zoom<m.GLOBE_ZOOM_THRESHOLD_MAX&&(y.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(y,d){return this._updateProjection(y||d||{name:"mercator"})}_updateProjection(y){let d;if(d="globe"===y.name&&this.transform.zoom>=m.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(y),this.style.applyProjectionUpdate(),d){this.painter.clearBackgroundTiles();for(const f in this.style._sourceCaches)this.style._sourceCaches[f].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(y){return this.transform.locationPoint3D(m.LngLat.convert(y))}unproject(y){return this.transform.pointLocation3D(m.pointGeometry.convert(y))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(y,d,f){if("mouseenter"===y||"mouseover"===y){let x=!1;const C=k=>{const P=d.filter(H=>this.getLayer(H)),L=P.length?this.queryRenderedFeatures(k.point,{layers:P}):[];L.length?x||(x=!0,f.call(this,new zo(y,this,k.originalEvent,{features:L}))):x=!1},S=()=>{x=!1};return{layers:new Set(d),listener:f,delegates:{mousemove:C,mouseout:S}}}if("mouseleave"===y||"mouseout"===y){let x=!1;const C=k=>{const P=d.filter(L=>this.getLayer(L));(P.length?this.queryRenderedFeatures(k.point,{layers:P}):[]).length?x=!0:x&&(x=!1,f.call(this,new zo(y,this,k.originalEvent)))},S=k=>{x&&(x=!1,f.call(this,new zo(y,this,k.originalEvent)))};return{layers:new Set(d),listener:f,delegates:{mousemove:C,mouseout:S}}}{const x=C=>{const S=d.filter(P=>this.getLayer(P)),k=S.length?this.queryRenderedFeatures(C.point,{layers:S}):[];k.length&&(C.features=k,f.call(this,C),delete C.features)};return{layers:new Set(d),listener:f,delegates:{[y]:x}}}}on(y,d,f){if(void 0===f)return super.on(y,d);Array.isArray(d)||(d=[d]);const x=this._createDelegatedListener(y,d,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(x);for(const C in x.delegates)this.on(C,x.delegates[C]);return this}once(y,d,f){if(void 0===f)return super.once(y,d);Array.isArray(d)||(d=[d]);const x=this._createDelegatedListener(y,d,f);for(const C in x.delegates)this.once(C,x.delegates[C]);return this}off(y,d,f){if(void 0===f)return super.off(y,d);d=new Set(Array.isArray(d)?d:[d]);const x=(S,k)=>{if(S.size!==k.size)return!1;for(const P of S)if(!k.has(P))return!1;return!0},C=this._delegatedListeners?this._delegatedListeners[y]:void 0;return C&&(S=>{for(let k=0;k<S.length;k++){const P=S[k];if(P.listener===f&&x(P.layers,d)){for(const L in P.delegates)this.off(L,P.delegates[L]);return S.splice(k,1),this}}})(C),this}queryRenderedFeatures(y,d){return this.style?(void 0!==d||void 0===y||y instanceof m.pointGeometry||Array.isArray(y)||(d=y,y=void 0),this.style.queryRenderedFeatures(y=y||[[0,0],[this.transform.width,this.transform.height]],d=d||{},this.transform)):[]}querySourceFeatures(y,d){return this.style.querySourceFeatures(y,d)}setStyle(y,d){return!1!==(d=m.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},d)).diff&&d.localIdeographFontFamily===this._localIdeographFontFamily&&d.localFontFamily===this._localFontFamily&&this.style&&y?(this._diffStyle(y,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._localFontFamily=d.localFontFamily,this._updateStyle(y,d))}_getUIString(y){const d=this._locale[y];if(null==d)throw new Error(`Missing UI string '${y}'`);return d}_updateStyle(y,d){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),y&&(this.style=new ls(this,d||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof y?this.style.loadURL(y):this.style.loadJSON(y)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ls(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,d){if("string"==typeof y){const f=this._requestManager.normalizeStyleURL(y),x=this._requestManager.transformRequest(f,m.ResourceType.Style);m.getJSON(x,(C,S)=>{C?this.fire(new m.ErrorEvent(C)):S&&this._updateDiff(S,d)})}else"object"==typeof y&&this._updateDiff(y,d)}_updateDiff(y,d){try{this.style.setState(y)&&this._update(!0)}catch(f){m.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(y,d)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(m.warnOnce("There is no style added to the map."),!1)}addSource(y,d){return this._lazyInitEmptyStyle(),this.style.addSource(y,d),this._update(!0)}isSourceLoaded(y){return!!this.style&&this.style._isSourceCacheLoaded(y)}areTilesLoaded(){const y=this.style&&this.style._sourceCaches;for(const d in y){const f=y[d]._tiles;for(const x in f){const C=f[x];if("loaded"!==C.state&&"errored"!==C.state)return!1}}return!0}addSourceType(y,d,f){this._lazyInitEmptyStyle(),this.style.addSourceType(y,d,f)}removeSource(y){return this.style.removeSource(y),this._updateTerrain(),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,d,{pixelRatio:f=1,sdf:x=!1,stretchX:C,stretchY:S,content:k}={}){if(this._lazyInitEmptyStyle(),d instanceof m.window.HTMLImageElement||m.window.ImageBitmap&&d instanceof m.window.ImageBitmap){const{width:P,height:L,data:H}=m.exported.getImageData(d);this.style.addImage(y,{data:new m.RGBAImage({width:P,height:L},H),pixelRatio:f,stretchX:C,stretchY:S,content:k,sdf:x,version:0})}else if(void 0===d.width||void 0===d.height)this.fire(new m.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:P,height:L}=d,H=d;this.style.addImage(y,{data:new m.RGBAImage({width:P,height:L},new Uint8Array(H.data)),pixelRatio:f,stretchX:C,stretchY:S,content:k,sdf:x,version:0,userImage:H}),H.onAdd&&H.onAdd(this,y)}}updateImage(y,d){const f=this.style.getImage(y);if(!f)return void this.fire(new m.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=d instanceof m.window.HTMLImageElement||m.window.ImageBitmap&&d instanceof m.window.ImageBitmap?m.exported.getImageData(d):d,{width:C,height:S}=x;void 0!==C&&void 0!==S?C===f.data.width&&S===f.data.height?(f.data.replace(x.data,!(d instanceof m.window.HTMLImageElement||m.window.ImageBitmap&&d instanceof m.window.ImageBitmap)),this.style.updateImage(y,f)):this.fire(new m.ErrorEvent(new Error(`The width and height of the updated image (${C}, ${S})\n                must be that same as the previous version of the image\n                (${f.data.width}, ${f.data.height})`))):this.fire(new m.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new m.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,d){m.getImage(this._requestManager.transformRequest(y,m.ResourceType.Image),(f,x)=>{d(f,x instanceof m.window.HTMLImageElement?m.exported.getImageData(x):x)})}listImages(){return this.style.listImages()}addLayer(y,d){return this._lazyInitEmptyStyle(),this.style.addLayer(y,d),this._update(!0)}moveLayer(y,d){return this.style.moveLayer(y,d),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}setLayerZoomRange(y,d,f){return this.style.setLayerZoomRange(y,d,f),this._update(!0)}setFilter(y,d,f={}){return this.style.setFilter(y,d,f),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,d,f,x={}){return this.style.setPaintProperty(y,d,f,x),this._update(!0)}getPaintProperty(y,d){return this.style.getPaintProperty(y,d)}setLayoutProperty(y,d,f,x={}){return this.style.setLayoutProperty(y,d,f,x),this._update(!0)}getLayoutProperty(y,d){return this.style.getLayoutProperty(y,d)}setLight(y,d={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,d),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(y){return this._lazyInitEmptyStyle(),!y&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(y),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(y){return this._lazyInitEmptyStyle(),this.style.setFog(y),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(y){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(m.LngLat.convert(y),this.transform):0}setFeatureState(y,d){return this.style.setFeatureState(y,d),this._update()}removeFeatureState(y,d){return this.style.removeFeatureState(y,d),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}_updateContainerDimensions(){if(!this._container)return;const y=this._container.getBoundingClientRect().width||400,d=this._container.getBoundingClientRect().height||300;let f,x,C,S=this._container;for(;S&&(!x||!C);){const k=m.window.getComputedStyle(S).transform;k&&"none"!==k&&(f=k.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&"0"!==f[0]&&"1"!==f[0]&&(x=f[0]),f[3]&&"0"!==f[3]&&"1"!==f[3]&&(C=f[3])),S=S.parentElement}this._containerWidth=x?Math.abs(y/x):y,this._containerHeight=C?Math.abs(d/C):d}_detectMissingCSS(){"rgb(250, 128, 114)"!==m.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&m.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const y=this._container;y.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ye("div","mapboxgl-canary",y)).style.visibility="hidden",this._detectMissingCSS();const d=this._canvasContainer=Ye("div","mapboxgl-canvas-container",y);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=Ye("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=Ye("div","mapboxgl-control-container",y),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(C=>{x[C]=Ye("div",`mapboxgl-ctrl-${C}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,d){const f=m.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(y),this._canvas.height=f*Math.ceil(d),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${d}px`}_addMarker(y){this._markers.push(y)}_removeMarker(y){const d=this._markers.indexOf(y);-1!==d&&this._markers.splice(d,1)}_addPopup(y){this._popups.push(y)}_removePopup(y){const d=this._popups.indexOf(y);-1!==d&&this._popups.splice(d,1)}_setupPainter(){const y=m.extend({},Je.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._useWebGL2&&this._canvas.getContext("webgl2",y),f=d||this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);f?(this._useWebGL2&&!d&&m.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),m.storeAuthState(f,!0),this.painter=new Pc(f,this.transform,!!d),this.on("data",x=>{"source"===x.dataType&&this.painter.setTileLoadedFlag(!0)}),m.exported$1.testSupport(f)):this.fire(new m.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new m.Event("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new m.Event("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_requestDomTask(y){!this.loaded()||this.loaded()&&!this.isMoving()?y():this._domRenderTaskQueue.add(y)}_render(y){let d;const f=this.painter.context.extTimerQuery,x=m.exported.now();if(this.listens("gpu-timing-frame")&&(d=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,d)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],m.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],m.window.performance.now())),this._renderTaskQueue.run(y),this._domRenderTaskQueue.run(y),this._removed)return;this._updateProjectionTransition();const C=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const P=this.transform.zoom,L=this.transform.pitch,H=m.exported.now(),$=new m.EvaluationParameters(P,{now:H,fadeDuration:C,pitch:L,transition:this.style.getTransition()});this.style.update($)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(x),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(x),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,C,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:C,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new m.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new m.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),d){const P=m.exported.now()-x;f.endQueryEXT(f.TIME_ELAPSED_EXT,d),setTimeout(()=>{const L=f.getQueryObjectEXT(d,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(d),this.fire(new m.Event("gpu-timing-frame",{cpuTime:P,gpuTime:L})),m.window.performance.mark("frame-gpu",{startTime:x,detail:{gpuTime:L}})},50)}if(this.listens("gpu-timing-layer")){const P=this.painter.collectGpuTimers();setTimeout(()=>{const L=this.painter.queryGpuTimers(P);this.fire(new m.Event("gpu-timing-layer",{layerTimes:L}))},50)}if(this.listens("gpu-timing-deferred-render")){const P=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const L=this.painter.queryGpuTimeDeferredRender(P);this.fire(new m.Event("gpu-timing-deferred-render",{gpuTime:L}))},50)}const k=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(k||this._repaint)this.triggerRepaint();else{const P=!this.isMoving()&&this.loaded();if(P&&(S=this._updateAverageElevation(x,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),P&&(this.fire(new m.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const L=this._calculateSpeedIndex();this.fire(new m.Event("speedindexcompleted",{speedIndex:L})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,m.LivePerformanceUtils.mark(m.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&m.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(y){for(const d of this._markers)y&&!this.getRenderWorldCopies()&&(d._lngLat=d._lngLat.wrap()),d._update();for(const d of this._popups)!y||this.getRenderWorldCopies()||d._trackPointer||(d._lngLat=d._lngLat.wrap()),d._update()}_updateAverageElevation(y,d=!1){const f=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&f(0);if((d||y-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(y)){const x=this.transform.averageElevation;let C=this.transform.sampleAverageElevation(),S=!1;this.transform.elevation&&(S=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(C)?C=0:this._averageElevationLastSampledAt=y;const k=Math.abs(x-C);if(k>1){if(this._isInitialLoad||S)return this._averageElevation.jumpTo(C),f(C);this._averageElevation.easeTo(C,y,300)}else if(k>1e-4)return this._averageElevation.jumpTo(C),f(C)}return!!this._averageElevation.isEasing(y)&&f(this._averageElevation.getValue(y))}_authenticate(){m.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,y=>{if(y&&(y.message===m.AUTH_ERR_MSG||401===y.status)){const d=this.painter.context.gl;m.storeAuthState(d,!1),this._logoControl instanceof Lc&&this._logoControl._updateLogo(),d&&d.clear(d.DEPTH_BUFFER_BIT|d.COLOR_BUFFER_BIT|d.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new m.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),m.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const y=this._isDragging();this.painter.updateTerrain(this.style,y)}_calculateSpeedIndex(){const y=this.painter.canvasCopy(),d=this.painter.getCanvasCopiesAndTimestamps();d.timeStamps.push(performance.now());const f=this.painter.context.gl,x=f.createFramebuffer();function C(S){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,S,0);const k=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,k),k}return f.bindFramebuffer(f.FRAMEBUFFER,x),this._canvasPixelComparison(C(y),d.canvasCopies.map(C),d.timeStamps)}_canvasPixelComparison(y,d,f){let x=f[1]-f[0];const C=y.length/4;for(let S=0;S<d.length;S++){const k=d[S];let P=0;for(let L=0;L<k.length;L+=4)k[L]===y[L]&&k[L+1]===y[L+1]&&k[L+2]===y[L+2]&&k[L+3]===y[L+3]&&(P+=1);x+=(f[S+2]-f[S+1])*(1-P/C)}return x}remove(){this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==m.window&&(m.window.removeEventListener("resize",this._onWindowResize,!1),m.window.removeEventListener("orientationchange",this._onWindowResize,!1),m.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),m.window.removeEventListener("online",this._onWindowOnline,!1),m.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),m.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new m.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(y){this._renderNextFrame=this._renderNextFrame||y,this.style&&!this._frame&&(this._frame=m.exported.frame(d=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(d)}))}_preloadTiles(y){const d=this.style?Object.values(this.style._sourceCaches):[];return m.asyncAll(d,(f,x)=>f._preloadTiles(y,x),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}_onVisibilityChange(){"hidden"===m.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(y){this._showTerrainWireframe!==y&&(this._showTerrainWireframe=y,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(y){this._speedIndexTiming!==y&&(this._speedIndexTiming=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(y){this._showTileAABBs!==y&&(this._showTileAABBs=y,y&&this._update())}_setCacheLimits(y,d){m.setCacheLimits(y,d)}get version(){return m.version}},NavigationControl:class{constructor(y){this.options=m.extend({},ba,y),this._container=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",d=>d.preventDefault()),this.options.showZoom&&(m.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",d=>{this._map&&this._map.zoomIn({},{originalEvent:d})}),Ye("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",d=>{this._map&&this._map.zoomOut({},{originalEvent:d})}),Ye("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(m.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",d=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:d}):f.resetNorth({},{originalEvent:d}))}),this._compassIcon=Ye("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map;if(!y)return;const d=y.getZoom(),f=d===y.getMaxZoom(),x=d===y.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())}_rotateCompassArrow(){const y=this._map;if(!y)return;const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(y.transform.pitch*(Math.PI/180)),.5)}) rotateX(${y.transform.pitch}deg) rotateZ(${y.transform.angle*(180/Math.PI)}deg)`:`rotate(${y.transform.angle*(180/Math.PI)}deg)`;y._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=d)})}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),y.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&y.on("pitch",this._rotateCompassArrow),y.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Pg(y,this._compass,this.options.visualizePitch)),this._container}onRemove(){const y=this._map;y&&(this._container.remove(),this.options.showZoom&&y.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&y.off("pitch",this._rotateCompassArrow),y.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(y,d){const f=Ye("button",y,this._container);return f.type="button",f.addEventListener("click",d),f}_setButtonTitle(y,d){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${d}`);y.setAttribute("aria-label",f),y.firstElementChild&&y.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends m.Evented{constructor(y){super(),this.options=m.extend({geolocation:m.window.navigator.geolocation},Zf,y),m.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=va(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(y){return this._map=y,this._container=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(y){const d=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,y(f)};void 0!==this._supportsGeolocation?y(this._supportsGeolocation):void 0!==m.window.navigator.permissions?m.window.navigator.permissions.query({name:"geolocation"}).then(f=>d("denied"!==f.state)).catch(()=>d()):d()}_isOutOfMapMaxBounds(y){const d=this._map.getMaxBounds(),f=y.coords;return!!d&&(f.longitude<d.getWest()||f.longitude>d.getEast()||f.latitude<d.getSouth()||f.latitude>d.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new m.Event("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(y),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(y),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new m.Event("geolocate",y)),this._finish()}}_updateCamera(y){const d=new m.LngLat(y.coords.longitude,y.coords.latitude),f=y.coords.accuracy,x=this._map.getBearing(),C=m.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(f),C,{geolocateSource:!0})}_updateMarker(y){if(y){const d=new m.LngLat(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map.transform,d=m.mercatorZfromAltitude(1,y._center.lat)*y.worldSize,f=Math.ceil(2*this._accuracy*d);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(y){if(this._map){if(this.options.trackUserLocation)if(1===y.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===y.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new m.Event("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=Ye("button","mapboxgl-ctrl-geolocate",this._container),Ye("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===y){m.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ye("div","mapboxgl-user-location"),this._dotElement.appendChild(Ye("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Ye("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new gp({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Ye("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new gp({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||"ACTIVE_LOCK"!==this._watchState||d.originalEvent&&"resize"===d.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new m.Event("trackuserlocationend")))})}}_onDeviceOrientation(y){this._userLocationDotMarker&&(y.webkitCompassHeading?this._heading=y.webkitCompassHeading:!0===y.absolute&&(this._heading=-1*y.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return m.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new m.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new m.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new m.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let y;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(y={maximumAge:6e5,timeout:0},this._noTimeout=!0):(y=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,y),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const y=()=>{m.window.addEventListener("ondeviceorientationabsolute"in m.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==m.window.DeviceMotionEvent&&"function"==typeof m.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(d=>{"granted"===d&&y()}).catch(console.error):y()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),m.window.removeEventListener("deviceorientation",this._onDeviceOrientation),m.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:mp,ScaleControl:class{constructor(y){this.options=m.extend({},Og,y),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Rg.bind(this)),m.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const y=this.options.maxWidth||100,d=this._map,f=d._containerHeight/2,x=d._containerWidth/2-y/2,C=d.unproject([x,f]),S=d.unproject([x+y,f]),k=C.distanceTo(S);if("imperial"===this.options.unit){const P=3.2808*k;P>5280?this._setScale(y,P/5280,"mile"):this._setScale(y,P,"foot")}else"nautical"===this.options.unit?this._setScale(y,k/1852,"nautical-mile"):k>=1e3?this._setScale(y,k/1e3,"kilometer"):this._setScale(y,k,"meter")}_setScale(y,d,f){const x=qu(d),C=x/d;this._map._requestDomTask(()=>{this._container.style.width=y*C+"px",this._container.innerHTML="nautical-mile"!==f?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:f}).format(x):`${x}&nbsp;nm`})}onAdd(y){return this._map=y,this._language=y.getLanguage(),this._container=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(y){this._language=y,this._update()}setUnit(y){this.options.unit=y,this._update()}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof m.window.HTMLElement?this._container=y.container:m.warnOnce("Full screen control 'container' must be a DOM element.")),m.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in m.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in m.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",m.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,m.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!m.window.document.fullscreenEnabled&&!m.window.document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=Ye("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Ye("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),m.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",y)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(m.window.document.fullscreenElement||m.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?m.window.document.exitFullscreen?m.window.document.exitFullscreen():m.window.document.webkitCancelFullScreen&&m.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends m.Evented{constructor(y){super(),this.options=m.extend(Object.create(Sy),y),m.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(y&&y.className?y.className.trim().split(/\s+/):[])}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&y.on("preclick",this._onClose),this.options.closeOnMove&&y.on("move",this._onClose),y.on("remove",this.remove),this._update(),y._addPopup(this),this._focusFirstElement(),this._trackPointer?(y.on("mousemove",this._onMouseEvent),y.on("mouseup",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")):y.on("move",this._update),this.fire(new m.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const y=this._map;return y&&(y.off("move",this._update),y.off("move",this._onClose),y.off("preclick",this._onClose),y.off("click",this._onClose),y.off("remove",this.remove),y.off("mousemove",this._onMouseEvent),y.off("mouseup",this._onMouseEvent),y.off("drag",this._onMouseEvent),y._canvasContainer&&y._canvasContainer.classList.remove("mapboxgl-track-pointer"),y._removePopup(this),this._map=void 0),this.fire(new m.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(y){this._lngLat=m.LngLat.convert(y),this._pos=null,this._trackPointer=!1,this._update();const d=this._map;return d&&(d.on("move",this._update),d.off("mousemove",this._onMouseEvent),d._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const y=this._map;return y&&(y.off("move",this._update),y.on("mousemove",this._onMouseEvent),y.on("drag",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(m.window.document.createTextNode(y))}setHTML(y){const d=m.window.document.createDocumentFragment(),f=m.window.document.createElement("body");let x;for(f.innerHTML=y;x=f.firstChild,x;)d.appendChild(x);return this.setDOMContent(d)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){let d=this._content;if(d)for(;d.hasChildNodes();)d.firstChild&&d.removeChild(d.firstChild);else d=this._content=Ye("div","mapboxgl-popup-content",this._container||void 0);if(d.appendChild(y),this.options.closeButton){const f=this._closeButton=Ye("button","mapboxgl-popup-close-button",d);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(y){return this._classList.add(y),this._updateClassList(),this}removeClassName(y){return this._classList.delete(y),this._updateClassList(),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){let d;return this._classList.delete(y)?d=!1:(this._classList.add(y),d=!0),this._updateClassList(),d}_onMouseEvent(y){this._update(y.point)}_getAnchor(y){if(this.options.anchor)return this.options.anchor;const d=this._map,f=this._container,x=this._pos;if(!d||!f||!x)return"bottom";const C=f.offsetWidth,S=f.offsetHeight,k=x.x<C/2,P=x.x>d.transform.width-C/2;if(x.y+y<S)return k?"top-left":P?"top-right":"top";if(x.y>d.transform.height-S){if(k)return"bottom-left";if(P)return"bottom-right"}return k?"left":P?"right":"bottom"}_updateClassList(){const y=this._container;if(!y)return;const d=[...this._classList];d.push("mapboxgl-popup"),this._anchor&&d.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&d.push("mapboxgl-popup-track-pointer"),y.className=d.join(" ")}_update(y){const d=this._map,f=this._content;if(!d||!this._lngLat&&!this._trackPointer||!f)return;let x=this._container;if(x||(x=this._container=Ye("div","mapboxgl-popup",d.getContainer()),this._tip=Ye("div","mapboxgl-popup-tip",x),x.appendChild(f)),this.options.maxWidth&&x.style.maxWidth!==this.options.maxWidth&&(x.style.maxWidth=this.options.maxWidth),d.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Wu(this._lngLat,this._pos,d.transform)),!this._trackPointer||y){const C=this._pos=this._trackPointer&&y?y:d.project(this._lngLat),S=zr(this.options.offset),k=this._anchor=this._getAnchor(S.y),P=zr(this.options.offset,k),L=C.add(P).round();d._requestDomTask(()=>{this._container&&k&&(this._container.style.transform=`${$l[k]} translate(${L.x}px,${L.y}px)`)})}if(!this._marker&&d._showingGlobe()){const C=m.isLngLatBehindGlobe(d.transform,this._lngLat)?0:1;this._setOpacity(C)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(Wf);y&&y.focus()}_onClose(){this.remove()}_setOpacity(y){this._container&&(this._container.style.opacity=`${y}`),this._content&&(this._content.style.pointerEvents=y?"auto":"none")}},Marker:gp,Style:ls,LngLat:m.LngLat,LngLatBounds:m.LngLatBounds,Point:m.pointGeometry,MercatorCoordinate:m.MercatorCoordinate,FreeCameraOptions:Ff,Evented:m.Evented,config:m.config,prewarm:function(){Vn().acquire(Sn)},clearPrewarmedResources:function(){const y=Mn;y&&(y.isPreloaded()&&1===y.numActive()?(y.release(Sn),Mn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return m.config.ACCESS_TOKEN},set accessToken(y){m.config.ACCESS_TOKEN=y},get baseApiUrl(){return m.config.API_URL},set baseApiUrl(y){m.config.API_URL=y},get workerCount(){return dn.workerCount},set workerCount(y){dn.workerCount=y},get maxParallelImageRequests(){return m.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){m.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){m.clearTileCache(y)},workerUrl:"",workerClass:null,setNow:m.exported.setNow,restoreNow:m.exported.restoreNow};return zc}),_t}()},775:function(tn){var _t;_t=function(){var Qt="",dt=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function _t(Je){return Je.match(dt)||[]}function Ge(Je){return{language:(Je=_t(Je))[1]||Qt,extlang:Je[2]||Qt,script:Je[3]||Qt,region:Je[4]||Qt}}function m(Je,Xe,Ve){Object.defineProperty(Je,Xe,{value:Ve,enumerable:!0})}function re(Je,Xe,Ve){function Ye(Ft){return _t(Ft)[Je]||Qt}m(Ye,"pattern",Xe),m(Ge,Ve,Ye)}return re(1,/^[a-zA-Z]{2,3}$/,"language"),re(2,/^[a-zA-Z]{3}$/,"extlang"),re(3,/^[a-zA-Z]{4}$/,"script"),re(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),m(Ge,"split",function mt(Je){return _t(Je).filter(function(Xe,Ve){return Xe&&Ve})}),Ge},tn.exports?tn.exports=_t():this.subtag=_t()},562:(tn,Qt,dt)=>{"use strict";var _t=dt(576);tn.exports=_t,typeof window<"u"&&(window.Suggestions=_t)},554:tn=>{"use strict";var Qt=function(dt){return this.component=dt,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,dt.el.parentNode.insertBefore(this.wrapper,dt.el.nextSibling),this};Qt.prototype.show=function(){this.element.style.display="block"},Qt.prototype.hide=function(){this.element.style.display="none"},Qt.prototype.add=function(dt){this.items.push(dt)},Qt.prototype.clear=function(){this.items=[],this.active=0},Qt.prototype.isEmpty=function(){return!this.items.length},Qt.prototype.isVisible=function(){return"block"===this.element.style.display},Qt.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var dt=0;dt<this.items.length;dt++)this.drawItem(this.items[dt],this.active===dt);this.show()}else this.hide()},Qt.prototype.drawItem=function(dt,_t){var mt=document.createElement("li"),Ge=document.createElement("a");_t&&(mt.className+=" active"),Ge.innerHTML=dt.string,mt.appendChild(Ge),this.element.appendChild(mt),mt.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),mt.addEventListener("mouseup",function(){this.handleMouseUp.call(this,dt)}.bind(this))},Qt.prototype.handleMouseUp=function(dt){this.selectingListItem=!1,this.component.value(dt.original),this.clear(),this.draw()},Qt.prototype.move=function(dt){this.active=dt,this.draw()},Qt.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},Qt.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},Qt.prototype.drawError=function(dt){var _t=document.createElement("li");_t.innerHTML=dt,this.element.appendChild(_t),this.show()},tn.exports=Qt},576:(tn,Qt,dt)=>{"use strict";var _t=dt(703),mt=dt(780),Ge=dt(554),m=function(re,Je,Xe){return this.options=_t({minLength:2,limit:5,filter:!0,hideOnBlur:!0},Xe=Xe||{}),this.el=re,this.data=Je||[],this.list=new Ge(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(Ve){this.handleKeyUp(Ve.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(Ve){this.handleKeyDown(Ve)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(Ve){this.handlePaste(Ve)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};m.prototype.handleKeyUp=function(re){40===re||38===re||27===re||13===re||9===re||this.handleInputChange(this.el.value)},m.prototype.handleKeyDown=function(re){switch(re.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&re.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},m.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},m.prototype.handlePaste=function(re){if(re.clipboardData)this.handleInputChange(re.clipboardData.getData("Text"));else{var Je=this;setTimeout(function(){Je.handleInputChange(re.target.value)},100)}},m.prototype.handleInputChange=function(re){this.query=this.normalize(re),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates(function(Je){for(var Xe=0;Xe<Je.length&&(this.list.add(Je[Xe]),Xe!==this.options.limit-1);Xe++);this.list.draw()}.bind(this))},m.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},m.prototype.update=function(re){this.data=re,this.handleKeyUp()},m.prototype.clear=function(){this.data=[],this.list.clear()},m.prototype.normalize=function(re){return re.toLowerCase()},m.prototype.match=function(re,Je){return re.indexOf(Je)>-1},m.prototype.value=function(re){if(this.selected=re,this.el.value=this.getItemValue(re),document.createEvent){var Je=document.createEvent("HTMLEvents");Je.initEvent("change",!0,!1),this.el.dispatchEvent(Je)}else this.el.fireEvent("onchange")},m.prototype.getCandidates=function(re){var Je={pre:"<strong>",post:"</strong>",extract:function(Ve){return this.getItemValue(Ve)}.bind(this)};re(this.options.filter?mt.filter(this.query,this.data,Je).map(function(Ve){return{original:Ve.original,string:this.render(Ve.original,Ve.string)}}.bind(this)):this.data.map(function(Ve){return{original:Ve,string:this.render(Ve)}}.bind(this)))},m.prototype.getItemValue=function(re){return re},m.prototype.render=function(re,Je){if(Je)return Je;for(var Xe=this.getItemValue(re.original?re.original:re),Ve=this.normalize(Xe),Ye=Ve.lastIndexOf(this.query);Ye>-1;){var Ft=Ye+this.query.length;Xe=Xe.slice(0,Ye)+"<strong>"+Xe.slice(Ye,Ft)+"</strong>"+Xe.slice(Ft),Ye=Ve.slice(0,Ye).lastIndexOf(this.query)}return Xe},m.prototype.renderError=function(re){this.list.drawError(re)},tn.exports=m},703:tn=>{tn.exports=function dt(){for(var _t={},mt=0;mt<arguments.length;mt++){var Ge=arguments[mt];for(var m in Ge)Qt.call(Ge,m)&&(_t[m]=Ge[m])}return _t};var Qt=Object.prototype.hasOwnProperty},652:(tn,Qt,dt)=>{"use strict";dt.d(Qt,{x0:()=>m});let m=(re=21)=>crypto.getRandomValues(new Uint8Array(re)).reduce((Je,Xe)=>Je+((Xe&=63)<36?Xe.toString(36):Xe<62?(Xe-26).toString(36).toUpperCase():Xe>62?"-":"_"),"")}},tn=>{tn(tn.s=420)}]);