(self.webpackChunkspotivibes=self.webpackChunkspotivibes||[]).push([[179],{89:(an,rn,pt)=>{"use strict";var vt=pt(95),_t=pt(703),Ge="value",g="\n  ",se={};function Je(jt){var Me=Array.isArray(jt);return function(st){var He=Ke(se.plainArray,st);if(He)return He;if(Me&&st.length!==jt.length)return"an array with "+jt.length+" items";for(var St=0;St<st.length;St++)if(He=Ke(Me?jt[St]:jt,st[St]))return[St].concat(He)}}function Ke(jt,Me){if(null!=Me||jt.hasOwnProperty("__required")){var ft=jt(Me);if(ft)return Array.isArray(ft)?ft:[ft]}}function Ve(jt,Me){var ft=jt.length,Ue=jt[ft-1],st=jt.slice(0,ft-1);return 0===st.length&&(st=[Ge]),Me=_t(Me,{path:st}),"function"==typeof Ue?Ue(Me):en(Me,function Bt(jt){return"must be "+function bn(jt){return/^an? /.test(jt)?jt:/^[aeiou]/i.test(jt)?"an "+jt:/^[a-z]/i.test(jt)?"a "+jt:jt}(jt)+"."}(Ue))}function en(jt,Me){return(un(jt.path)?"Item at position ":"")+jt.path.join(".")+" "+Me}function un(jt){return"number"==typeof jt[jt.length-1]||"number"==typeof jt[0]}se.assert=function(jt,Me){return Me=Me||{},function(ft){var Ue=Ke(jt,ft);if(Ue){var st=Ve(Ue,Me);throw Me.apiName&&(st=Me.apiName+": "+st),new Error(st)}}},se.shape=function(Me){var ft=function qt(jt){return Object.keys(jt||{}).map(function(Me){return{key:Me,value:jt[Me]}})}(Me);return function(st){var He=Ke(se.plainObject,st);if(He)return He;for(var St,Lt=[],ln=0;ln<ft.length;ln++)(He=Ke(ft[ln].value,st[St=ft[ln].key]))&&Lt.push([St].concat(He));return Lt.length<2?Lt[0]:function(Bn){Lt=Lt.map(function(Hn){return"- "+Hn[0]+": "+Ve(Hn,Bn).split("\n").join(g)});var Co=Bn.path.join(".");return"The following properties"+(Co===Ge?"":" of "+Co)+" have invalid values:"+g+Lt.join(g)}}},se.strictShape=function(Me){var ft=se.shape(Me);return function(st){var He=ft(st);if(He)return He;var St=Object.keys(st).reduce(function(wt,Lt){return void 0===Me[Lt]&&wt.push(Lt),wt},[]);return 0!==St.length?function(){return"The following keys are invalid: "+St.join(", ")}:void 0}},se.arrayOf=function(Me){return Je(Me)},se.tuple=function(){return Je(Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments))},se.required=function(Me){function ft(Ue){return null==Ue?function(st){return en(st,un(st.path)?"cannot be undefined/null.":"is required.")}:Me.apply(this,arguments)}return ft.__required=!0,ft},se.oneOfType=function(){var Me=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(Ue){var st=Me.map(function(He){return Ke(He,Ue)}).filter(Boolean);if(st.length===Me.length)return st.every(function(He){return 1===He.length&&"string"==typeof He[0]})?function Xe(jt){return jt.length<2?jt[0]:2===jt.length?jt.join(" or "):jt.slice(0,-1).join(", ")+", or "+jt.slice(-1)}(st.map(function(He){return He[0]})):st.reduce(function(He,St){return St.length>He.length?St:He})}},se.equal=function(Me){return function(Ue){if(Ue!==Me)return JSON.stringify(Me)}},se.oneOf=function(){var ft=(Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments)).map(function(Ue){return se.equal(Ue)});return se.oneOfType.apply(this,ft)},se.range=function(Me){var ft=Me[0],Ue=Me[1];return function(He){if(Ke(se.number,He)||He<ft||He>Ue)return"number between "+ft+" & "+Ue+" (inclusive)"}},se.any=function(){},se.boolean=function(Me){if("boolean"!=typeof Me)return"boolean"},se.number=function(Me){if("number"!=typeof Me)return"number"},se.plainArray=function(Me){if(!Array.isArray(Me))return"array"},se.plainObject=function(Me){if(!vt(Me))return"object"},se.string=function(Me){if("string"!=typeof Me)return"string"},se.func=function(Me){if("function"!=typeof Me)return"function"},se.validate=Ke,se.processMessage=Ve,an.exports=se},95:an=>{"use strict";var rn=Object.prototype.toString;an.exports=function(pt){var vt;return"[object Object]"===rn.call(pt)&&(null===(vt=Object.getPrototypeOf(pt))||vt===Object.getPrototypeOf({}))}},564:(an,rn,pt)=>{"use strict";var vt=pt(652).x0;function _t(Ge){this.origin=Ge.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=Ge.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=Ge,this.send=this.send.bind(this),this.countries=Ge.countries?Ge.countries.split(","):null,this.types=Ge.types?Ge.types.split(","):null,this.bbox=Ge.bbox?Ge.bbox:null,this.language=Ge.language?Ge.language.split(","):null,this.limit=Ge.limit?+Ge.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(Ge),this.eventQueue=new Array,this.flushInterval=Ge.flushInterval||1e3,this.maxQueueSize=Ge.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}_t.prototype={select:function(Ge,g){var se=this.getSelectedIndex(Ge,g),Je=this.getEventPayload("search.select",g);if(Je.resultIndex=se,Je.resultPlaceName=Ge.place_name,Je.resultId=Ge.id,(se!==this.lastSentIndex||Je.queryString!==this.lastSentInput)&&-1!=se&&(this.lastSentIndex=se,this.lastSentInput=Je.queryString,Je.queryString))return this.push(Je)},start:function(Ge){var g=this.getEventPayload("search.start",Ge);if(g.queryString)return this.push(g)},keyevent:function(Ge,g){if(Ge.key&&!Ge.metaKey&&-1===[9,27,37,39,13,38,40].indexOf(Ge.keyCode)){var se=this.getEventPayload("search.keystroke",g);if(se.lastAction=Ge.key,se.queryString)return this.push(se)}},send:function(Ge,g){if(!this.enableEventLogging)return g?g():void 0;var se=this.getRequestOptions(Ge);this.request(se,function(Je){return Je?this.handleError(Je,g):g?g():void 0}.bind(this))},getRequestOptions:function(Ge){return Array.isArray(Ge)||(Ge=[Ge]),{method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(Ge)}},getEventPayload:function(Ge,g){var se;se=g.options.proximity?"object"==typeof g.options.proximity?[g.options.proximity.longitude,g.options.proximity.latitude]:"ip"===g.options.proximity?[999,999]:g.options.proximity:null;var Je=g._map?g._map.getZoom():void 0,Ke={event:Ge,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:g.options.autocomplete,fuzzyMatch:g.options.fuzzyMatch,proximity:se,limit:g.options.limit,routing:g.options.routing,worldview:g.options.worldview,mapZoom:Je,keyboardLocale:this.locale};return Ke.queryString="search.select"===Ge?g.inputString:"search.select"!=Ge&&g._inputEl?g._inputEl.value:g.inputString,Ke},request:function(Ge,g){var se=new XMLHttpRequest;for(var Je in se.onreadystatechange=function(){if(4==this.readyState)return g(204==this.status?null:this.statusText)},se.open(Ge.method,Ge.host+"/"+Ge.path,!0),Ge.headers)se.setRequestHeader(Je,Ge.headers[Je]);se.send(Ge.body)},handleError:function(Ge,g){if(g)return g(Ge)},generateSessionID:function(){return vt()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(Ge,g){if(g._typeahead){var Je=Ge.id;return g._typeahead.data.map(function(Xe){return Xe.id}).indexOf(Je)}},shouldEnableLogging:function(Ge){return!(!1===Ge.enableEventLogging||Ge.origin&&"https://api.mapbox.com"!==Ge.origin||Ge.localGeocoder||Ge.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(Ge,g){this.eventQueue.push(Ge),(this.eventQueue.length>=this.maxQueueSize||g)&&this.flush()},remove:function(){this.flush()}},an.exports=_t},424:an=>{an.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}},569:an=>{function rn(){}rn.prototype={isSupport:function(){return Boolean(window.navigator.geolocation)},getCurrentPosition:function(){const pt={enableHighAccuracy:!0};return new Promise(function(vt,_t){window.navigator.geolocation.getCurrentPosition(vt,_t,pt)})}},an.exports=rn},545:(an,rn,pt)=>{"use strict";var vt=pt(562),_t=pt(82),Ge=pt(703),g=pt(69).EventEmitter,se=pt(424),Je=pt(471),Ke=pt(75),Ve=pt(564),Xe=pt(234),Bt=pt(775),bn=pt(569),en=pt(777);function jt(Me){this._eventEmitter=new g,this.options=Ge({},this.options,Me),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new bn}jt.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(Me){return Me.place_name},render:function(Me){var ft=Me.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+ft[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+ft.splice(1,ft.length).join(",")+"</div></div>"}},addTo:function(Me){function ft(Ue,st){if(!document.body.contains(st))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const He=Ue.onAdd();st.appendChild(He)}if(Me._controlContainer)Me.addControl(this);else if(Me instanceof HTMLElement)ft(this,Me);else{if("string"!=typeof Me)throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element");{const Ue=document.querySelectorAll(Me);if(0===Ue.length)throw new Error("Element ",Me,"not found.");if(Ue.length>1)throw new Error("Geocoder can only be added to a single html element");ft(this,Ue[0])}}},onAdd:function(Me){if(Me&&"string"!=typeof Me&&(this._map=Me),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=Ke(Je({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new Ve(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var ft=this.container=document.createElement("div");ft.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var Ue=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",_t(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",function(Bn){this.eventManager.keyevent(Bn,this)}.bind(this));var st=document.createElement("div");st.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var He=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(He),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),st.appendChild(this._clearEl),st.appendChild(this._loadingEl),ft.appendChild(Ue),ft.appendChild(this._inputEl),ft.appendChild(st),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var St=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(St),st.appendChild(this._geolocateEl),this._showGeolocateButton()}var wt=this._typeahead=new vt(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),wt.getItemValue=this.options.getItemValue;var Lt=wt.list.draw,ln=this._footerNode=function qt(){var Me=document.createElement("div");return Me.className="mapboxgl-ctrl-geocoder--powered-by",Me.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',Me}();return wt.list.draw=function(){Lt.call(this),ln.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),ln.addEventListener("mouseup",function(){this.selectingListItem=!1}.bind(this)),this.element.appendChild(ln)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),ft},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then(function(Me){this._hideLoadingIcon();const ft={geometry:{type:"Point",coordinates:[Me.coords.longitude,Me.coords.latitude]}};this._handleMarker(ft),this._fly(ft),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(ft),this._showClearButton(),this.fresh=!1;const Ue={limit:1,language:[this.options.language],query:ft.geometry.coordinates,types:["address"]};this.options.localGeocoderOnly?(this._setInputValue(ft.geometry.coordinates[0]+","+ft.geometry.coordinates[1]),this._eventEmitter.emit("result",{result:ft})):this.geocoderService.reverseGeocode(Ue).send().then(function(st){const He=st.body.features[0];if(He){const St=en.transformFeatureToGeolocationText(He,this.options.addressAccuracy);this._setInputValue(St),He.user_coordinates=ft.geometry.coordinates,this._eventEmitter.emit("result",{result:He})}else this._eventEmitter.emit("result",{result:{user_coordinates:ft.geometry.coordinates}})}.bind(this))}.bind(this)).catch(function(Me){1===Me.code?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}.bind(this))},createIcon:function(Me,ft){var Ue=document.createElementNS("http://www.w3.org/2000/svg","svg");return Ue.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+Me),Ue.setAttribute("viewBox","0 0 18 18"),Ue.setAttribute("xml:space","preserve"),Ue.setAttribute("width",18),Ue.setAttribute("height",18),Ue.innerHTML=ft,Ue},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(Me){this._inputEl.value=Me,setTimeout(function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}.bind(this),1)},_onPaste:function(Me){var ft=(Me.clipboardData||window.clipboardData).getData("text");ft.length>=this.options.minLength&&this._geocode(ft)},_onKeyDown:function(Me){var ft=27,Ue=9;if(Me.keyCode===ft&&this.options.clearAndBlurOnEsc)return this._clear(Me),this._inputEl.blur();var st=Me.target&&Me.target.shadowRoot?Me.target.shadowRoot.activeElement:Me.target;if(!st||!st.value)return this.fresh=!0,Me.keyCode!==Ue&&this.clear(Me),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!Me.metaKey&&-1===[Ue,ft,37,39,13,38,40].indexOf(Me.keyCode)&&st.value.length>=this.options.minLength&&this._geocode(st.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(Me){this.options.clearOnBlur&&this._clearOnBlur(Me),this.options.collapsed&&this._collapse()},_onChange:function(){var Me=this._typeahead.selected;Me&&JSON.stringify(Me)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(Me),this.options.marker&&this._mapboxgl&&this._handleMarker(Me),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(Me),this._eventEmitter.emit("result",{result:Me}),this.eventManager.select(Me,this))},_fly:function(Me){var ft;if(Me.properties&&se[Me.properties.short_code])ft=Ge({},this.options.flyTo),this._map&&this._map.fitBounds(se[Me.properties.short_code].bbox,ft);else if(Me.bbox){var Ue=Me.bbox;ft=Ge({},this.options.flyTo),this._map&&this._map.fitBounds([[Ue[0],Ue[1]],[Ue[2],Ue[3]]],ft)}else ft=Ge({},{zoom:this.options.zoom},this.options.flyTo),Me.center?ft.center=Me.center:Me.geometry&&Me.geometry.type&&"Point"===Me.geometry.type&&Me.geometry.coordinates&&(ft.center=Me.geometry.coordinates),this._map&&this._map.flyTo(ft)},_requestType:function(Me,ft){return Me.localGeocoderOnly?1:Me.reverseGeocode&&en.REVERSE_GEOCODE_COORD_RGX.test(ft)?2:0},_setupConfig:function(Me,ft){const st=/[\s,]+/;var He=this,St=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"].reduce(function(Lt,ln){return null==He.options[ln]||(Lt[ln]=["countries","types","language"].indexOf(ln)>-1?He.options[ln].split(st):He.options[ln],"proximity"===ln&&"number"==typeof He.options[ln].longitude&&"number"==typeof He.options[ln].latitude&&(Lt[ln]=[He.options[ln].longitude,He.options[ln].latitude])),Lt},{});switch(Me){case 2:var wt=ft.split(st).map(function(Lt){return parseFloat(Lt,10)});He.options.flipCoordinates||wt.reverse(),St=Ge(St,{query:wt,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(Lt){Lt in St&&delete St[Lt]});break;case 0:{const Lt=ft.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(Lt)&&(ft=ft.replace(/,/g," ")),St=Ge(St,{query:ft})}}return St},_geocode:function(Me){this.inputString=Me,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:Me});const ft=this._requestType(this.options,Me),Ue=this._setupConfig(ft,Me);var st;switch(ft){case 1:st=Promise.resolve();break;case 0:st=this.geocoderService.forwardGeocode(Ue).send();break;case 2:st=this.geocoderService.reverseGeocode(Ue).send()}var He=this.options.localGeocoder&&this.options.localGeocoder(Me)||[],St=[],wt=null;return st.catch(function(Lt){wt=Lt}.bind(this)).then(function(Lt){this._hideLoadingIcon();var ln={};return Lt?"200"==Lt.statusCode&&((ln=Lt.body).request=Lt.request,ln.headers=Lt.headers):ln={type:"FeatureCollection",features:[]},ln.config=Ue,this.fresh&&(this.eventManager.start(this),this.fresh=!1),ln.features=ln.features?He.concat(ln.features):He,this.options.externalGeocoder?(St=this.options.externalGeocoder(Me,ln.features)||Promise.resolve([])).then(function(Bn){return ln.features=ln.features?Bn.concat(ln.features):Bn,ln},function(){return ln}):ln}.bind(this)).then(function(Lt){if(wt)throw wt;this.options.filter&&Lt.features.length&&(Lt.features=Lt.features.filter(this.options.filter)),Lt.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",Lt),this._typeahead.update(Lt.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",Lt))}.bind(this)).catch(function(Lt){this._hideLoadingIcon(),this._hideAttribution(),He.length&&this.options.localGeocoder||St.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(He)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:He}),this._eventEmitter.emit("error",{error:Lt})}.bind(this)),st},_clear:function(Me){Me&&Me.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(Me){this._clear(Me),this._inputEl.focus()},_clearOnBlur:function(Me){Me.relatedTarget&&this._clear(Me)},_onQueryResult:function(Me){var ft=Me.body;if(ft.features.length){var Ue=ft.features[0];this._typeahead.selected=Ue,this._inputEl.value=Ue.place_name,this._onChange()}},_updateProximity:function(){if(this._map&&this.options.trackProximity)if(this._map.getZoom()>9){var Me=this._map.getCenter().wrap();this.setProximity({longitude:Me.lng,latitude:Me.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(Me){return this._geocode(Me).then(this._onQueryResult),this},_renderError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>")},_renderLocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>")},_renderNoResults:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>")},_renderUserDeniedGeolocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>")},_renderMessage:function(Me){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(Me)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var Me=this.options.language.split(",")[0],ft=Bt.language(Me),Ue=Xe.placeholder[ft];if(Ue)return Ue}return"Search"},setInput:function(Me){return this._inputEl.value=Me,this._typeahead.selected=null,this._typeahead.clear(),Me.length>=this.options.minLength&&this._geocode(Me),this},setProximity:function(Me,ft=!0){return this.options.proximity=Me,ft&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(Me){return Me&&"function"==typeof Me&&(this._typeahead.render=Me),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(Me){var ft=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=Me||this.options.language||ft,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(Me){return this.options.zoom=Me,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(Me){return this.options.flyTo=Me,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(Me){return this.placeholder=Me||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(Me){return this.options.bbox=Me,this},getCountries:function(){return this.options.countries},setCountries:function(Me){return this.options.countries=Me,this},getTypes:function(){return this.options.types},setTypes:function(Me){return this.options.types=Me,this},getMinLength:function(){return this.options.minLength},setMinLength:function(Me){return this.options.minLength=Me,this._typeahead&&(this._typeahead.options.minLength=Me),this},getLimit:function(){return this.options.limit},setLimit:function(Me){return this.options.limit=Me,this._typeahead&&(this._typeahead.options.limit=Me),this},getFilter:function(){return this.options.filter},setFilter:function(Me){return this.options.filter=Me,this},setOrigin:function(Me){return this.options.origin=Me,this.geocoderService=Ke(Je({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(Me){return this.options.accessToken=Me,this.geocoderService=Ke(Je({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(Me){return this.options.autocomplete=Me,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(Me){return this.options.fuzzyMatch=Me,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(Me){return this.options.routing=Me,this},getRouting:function(){return this.options.routing},setWorldview:function(Me){return this.options.worldview=Me,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(Me){if(this._map){this._removeMarker();var Ue=Ge({},{color:"#4668F2"},this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(Ue),Me.center?this.mapMarker.setLngLat(Me.center).addTo(this._map):Me.geometry&&Me.geometry.type&&"Point"===Me.geometry.type&&Me.geometry.coordinates&&this.mapMarker.setLngLat(Me.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(Me,ft){return this._eventEmitter.on(Me,ft),this},off:function(Me,ft){return this._eventEmitter.removeListener(Me,ft),this.eventManager.remove(),this}},an.exports=jt},234:an=>{"use strict";an.exports={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a"}}},777:an=>{function pt(_t){const Ge=_t.address||"",g=_t.text||"",se=_t.place_name||"",Ke={address:se.split(",")[0],houseNumber:Ge,street:g,placeName:se};return _t.context.forEach(function(Ve){const Xe=Ve.id.split(".")[0];Ke[Xe]=Ve.text}),Ke}an.exports={transformFeatureToGeolocationText:function rn(_t,Ge){const g=pt(_t),se=["address","street","place","country"];if("function"==typeof Ge)return Ge(g);const Ke=se.indexOf(Ge);return(-1===Ke?se:se.slice(Ke)).reduce(function(Ve,Xe){return g[Xe]?(""!==Ve&&(Ve+=", "),Ve+g[Xe]):Ve},"")},getAddressInfo:pt,REVERSE_GEOCODE_COORD_RGX:/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/}},471:(an,rn,pt)=>{"use strict";var vt=pt(454);an.exports=vt},454:(an,rn,pt)=>{"use strict";var vt=pt(753),_t=pt(176);function Ge(se){_t.call(this,se)}(Ge.prototype=Object.create(_t.prototype)).constructor=Ge,Ge.prototype.sendRequest=vt.browserSend,Ge.prototype.abortRequest=vt.browserAbort,an.exports=function g(se){return new Ge(se)}},753:(an,rn,pt)=>{"use strict";var vt=pt(332),_t=pt(158),Ge=pt(719),g=pt(829),se={};function Ve(en){var un=en.total,qt=en.loaded;return{total:un,transferred:qt,percent:100*qt/un}}function Xe(en,un){return new Promise(function(qt,jt){un.onprogress=function(Ue){en.emitter.emit(Ge.EVENT_PROGRESS_DOWNLOAD,Ve(Ue))};var Me=en.file;Me&&(un.upload.onprogress=function(Ue){en.emitter.emit(Ge.EVENT_PROGRESS_UPLOAD,Ve(Ue))}),un.onerror=function(Ue){jt(Ue)},un.onabort=function(){var Ue=new _t({request:en,type:Ge.ERROR_REQUEST_ABORTED});jt(Ue)},un.onload=function(){if(delete se[en.id],un.status<200||un.status>=400){var Ue=new _t({request:en,body:un.response,statusCode:un.status});jt(Ue)}else qt(un)};var ft=en.body;"string"==typeof ft?un.send(ft):ft?un.send(JSON.stringify(ft)):Me?un.send(Me):un.send(),se[en.id]=un}).then(function(qt){return function Ke(en,un){return new vt(en,{body:un.response,headers:g(un.getAllResponseHeaders()),statusCode:un.status})}(en,qt)})}function Bt(en,un){var qt=en.url(un),jt=new window.XMLHttpRequest;return jt.open(en.method,qt),Object.keys(en.headers).forEach(function(Me){jt.setRequestHeader(Me,en.headers[Me])}),jt}an.exports={browserAbort:function Je(en){var un=se[en.id];un&&(un.abort(),delete se[en.id])},sendRequestXhr:Xe,browserSend:function bn(en){return Promise.resolve().then(function(){var un=Bt(en,en.client.accessToken);return Xe(en,un)})},createRequestXhr:Bt}},176:(an,rn,pt)=>{"use strict";var vt=pt(129),_t=pt(538),Ge=pt(719);function g(se){if(!se||!se.accessToken)throw new Error("Cannot create a client without an access token");vt(se.accessToken),this.accessToken=se.accessToken,this.origin=se.origin||Ge.API_ORIGIN}g.prototype.createRequest=function(Je){return new _t(this,Je)},an.exports=g},158:(an,rn,pt)=>{"use strict";var vt=pt(719);an.exports=function _t(Ge){var se,g=Ge.type||vt.ERROR_HTTP;if(Ge.body)try{se=JSON.parse(Ge.body)}catch{se=Ge.body}else se=null;var Je=Ge.message||null;Je||("string"==typeof se?Je=se:se&&"string"==typeof se.message?Je=se.message:g===vt.ERROR_REQUEST_ABORTED&&(Je="Request aborted")),this.message=Je,this.type=g,this.statusCode=Ge.statusCode||null,this.request=Ge.request,this.body=se}},538:(an,rn,pt)=>{"use strict";var vt=pt(129),_t=pt(703),Ge=pt(661),g=pt(449),se=pt(719),Je=1;function Ke(Ve,Xe){if(!Ve)throw new Error("MapiRequest requires a client");if(!Xe||!Xe.path||!Xe.method)throw new Error("MapiRequest requires an options object with path and method properties");var Bt={};Xe.body&&(Bt["content-type"]="application/json");var bn=_t(Bt,Xe.headers),en=Object.keys(bn).reduce(function(un,qt){return un[qt.toLowerCase()]=bn[qt],un},{});this.id=Je++,this._options=Xe,this.emitter=new Ge,this.client=Ve,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=Xe.path,this.method=Xe.method,this.origin=Xe.origin||Ve.origin,this.query=Xe.query||{},this.params=Xe.params||{},this.body=Xe.body||null,this.file=Xe.file||null,this.encoding=Xe.encoding||"utf8",this.sendFileAs=Xe.sendFileAs||null,this.headers=en}Ke.prototype.url=function(Xe){var Bt=g.prependOrigin(this.path,this.origin);Bt=g.appendQueryObject(Bt,this.query);var bn=this.params,en=Xe??this.client.accessToken;if(en){Bt=g.appendQueryParam(Bt,"access_token",en);var un=vt(en).user;bn=_t({ownerId:un},bn)}return g.interpolateRouteParams(Bt,bn)},Ke.prototype.send=function(){var Xe=this;if(Xe.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return Xe.sent=!0,Xe.client.sendRequest(Xe).then(function(Bt){return Xe.response=Bt,Xe.emitter.emit(se.EVENT_RESPONSE,Bt),Bt},function(Bt){throw Xe.error=Bt,Xe.emitter.emit(se.EVENT_ERROR,Bt),Bt})},Ke.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))},Ke.prototype.eachPage=function(Xe){var Bt=this;function bn(qt){Xe(null,qt,function jt(){delete Bt._nextPageRequest;var Me=qt.nextPage();Me&&(Bt._nextPageRequest=Me,un(Me))})}function en(qt){Xe(qt,null,function(){})}function un(qt){qt.send().then(bn,en)}un(this)},Ke.prototype.clone=function(){return this._extend()},Ke.prototype._extend=function(Xe){var Bt=_t(this._options,Xe);return new Ke(this.client,Bt)},an.exports=Ke},332:(an,rn,pt)=>{"use strict";var vt=pt(699);function _t(Ge,g){this.request=Ge,this.headers=g.headers,this.rawBody=g.body,this.statusCode=g.statusCode;try{this.body=JSON.parse(g.body||"{}")}catch{this.body=g.body}this.links=vt(this.headers.link)}_t.prototype.hasNextPage=function(){return!!this.links.next},_t.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},an.exports=_t},719:an=>{"use strict";an.exports={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}},829:an=>{"use strict";an.exports=function pt(vt){var _t={};return vt&&vt.trim().split(/[\r|\n]+/).forEach(function(Ge){var g=function rn(vt){var _t=vt.indexOf(":");return{name:vt.substring(0,_t).trim().toLowerCase(),value:vt.substring(_t+1).trim()}}(Ge);_t[g.name]=g.value}),_t}},699:an=>{"use strict";an.exports=function vt(_t){return _t?_t.split(/,\s*</).reduce(function(Ge,g){var se=function pt(_t){var Ge=_t.match(/<?([^>]*)>(.*)/);if(!Ge)return null;var g=Ge[1],se=Ge[2].split(";"),Je=null,Ke=se.reduce(function(Ve,Xe){var Bt=function rn(_t){var Ge=_t.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return Ge?{key:Ge[1],value:Ge[2]}:null}(Xe);return Bt?"rel"===Bt.key?(Je||(Je=Bt.value),Ve):(Ve[Bt.key]=Bt.value,Ve):Ve},{});return Je?{url:g,rel:Je,params:Ke}:null}(g);return se?(se.rel.split(/\s+/).forEach(function(Ke){Ge[Ke]||(Ge[Ke]={url:se.url,params:se.params})}),Ge):Ge},{}):{}}},449:an=>{"use strict";function pt(se){return Array.isArray(se)?function rn(se){return se.map(encodeURIComponent).join(",")}(se):encodeURIComponent(String(se))}function vt(se,Je,Ke){if(!1===Ke||null===Ke)return se;var Ve=/\?/.test(se)?"&":"?",Xe=encodeURIComponent(Je);return void 0!==Ke&&""!==Ke&&!0!==Ke&&(Xe+="="+pt(Ke)),""+se+Ve+Xe}an.exports={appendQueryObject:function _t(se,Je){if(!Je)return se;var Ke=se;return Object.keys(Je).forEach(function(Ve){var Xe=Je[Ve];void 0!==Xe&&(Array.isArray(Xe)&&(Xe=Xe.filter(function(Bt){return null!=Bt}).join(",")),Ke=vt(Ke,Ve,Xe))}),Ke},appendQueryParam:vt,prependOrigin:function Ge(se,Je){if(!Je||"http"===se.slice(0,4))return se;var Ke="/"===se[0]?"":"/";return""+Je.replace(/\/$/,"")+Ke+se},interpolateRouteParams:function g(se,Je){return Je?se.replace(/\/:([a-zA-Z0-9]+)/g,function(Ke,Ve){var Xe=Je[Ve];if(void 0===Xe)throw new Error("Unspecified route parameter "+Ve);return"/"+pt(Xe)}):se}}},661:an=>{"use strict";var rn=Object.prototype.hasOwnProperty,pt="~";function vt(){}function _t(Je,Ke,Ve){this.fn=Je,this.context=Ke,this.once=Ve||!1}function Ge(Je,Ke,Ve,Xe,Bt){if("function"!=typeof Ve)throw new TypeError("The listener must be a function");var bn=new _t(Ve,Xe||Je,Bt),en=pt?pt+Ke:Ke;return Je._events[en]?Je._events[en].fn?Je._events[en]=[Je._events[en],bn]:Je._events[en].push(bn):(Je._events[en]=bn,Je._eventsCount++),Je}function g(Je,Ke){0==--Je._eventsCount?Je._events=new vt:delete Je._events[Ke]}function se(){this._events=new vt,this._eventsCount=0}Object.create&&(vt.prototype=Object.create(null),(new vt).__proto__||(pt=!1)),se.prototype.eventNames=function(){var Ve,Xe,Ke=[];if(0===this._eventsCount)return Ke;for(Xe in Ve=this._events)rn.call(Ve,Xe)&&Ke.push(pt?Xe.slice(1):Xe);return Object.getOwnPropertySymbols?Ke.concat(Object.getOwnPropertySymbols(Ve)):Ke},se.prototype.listeners=function(Ke){var Xe=this._events[pt?pt+Ke:Ke];if(!Xe)return[];if(Xe.fn)return[Xe.fn];for(var Bt=0,bn=Xe.length,en=new Array(bn);Bt<bn;Bt++)en[Bt]=Xe[Bt].fn;return en},se.prototype.listenerCount=function(Ke){var Xe=this._events[pt?pt+Ke:Ke];return Xe?Xe.fn?1:Xe.length:0},se.prototype.emit=function(Ke,Ve,Xe,Bt,bn,en){var un=pt?pt+Ke:Ke;if(!this._events[un])return!1;var Me,ft,qt=this._events[un],jt=arguments.length;if(qt.fn){switch(qt.once&&this.removeListener(Ke,qt.fn,void 0,!0),jt){case 1:return qt.fn.call(qt.context),!0;case 2:return qt.fn.call(qt.context,Ve),!0;case 3:return qt.fn.call(qt.context,Ve,Xe),!0;case 4:return qt.fn.call(qt.context,Ve,Xe,Bt),!0;case 5:return qt.fn.call(qt.context,Ve,Xe,Bt,bn),!0;case 6:return qt.fn.call(qt.context,Ve,Xe,Bt,bn,en),!0}for(ft=1,Me=new Array(jt-1);ft<jt;ft++)Me[ft-1]=arguments[ft];qt.fn.apply(qt.context,Me)}else{var st,Ue=qt.length;for(ft=0;ft<Ue;ft++)switch(qt[ft].once&&this.removeListener(Ke,qt[ft].fn,void 0,!0),jt){case 1:qt[ft].fn.call(qt[ft].context);break;case 2:qt[ft].fn.call(qt[ft].context,Ve);break;case 3:qt[ft].fn.call(qt[ft].context,Ve,Xe);break;case 4:qt[ft].fn.call(qt[ft].context,Ve,Xe,Bt);break;default:if(!Me)for(st=1,Me=new Array(jt-1);st<jt;st++)Me[st-1]=arguments[st];qt[ft].fn.apply(qt[ft].context,Me)}}return!0},se.prototype.on=function(Ke,Ve,Xe){return Ge(this,Ke,Ve,Xe,!1)},se.prototype.once=function(Ke,Ve,Xe){return Ge(this,Ke,Ve,Xe,!0)},se.prototype.removeListener=function(Ke,Ve,Xe,Bt){var bn=pt?pt+Ke:Ke;if(!this._events[bn])return this;if(!Ve)return g(this,bn),this;var en=this._events[bn];if(en.fn)en.fn===Ve&&(!Bt||en.once)&&(!Xe||en.context===Xe)&&g(this,bn);else{for(var un=0,qt=[],jt=en.length;un<jt;un++)(en[un].fn!==Ve||Bt&&!en[un].once||Xe&&en[un].context!==Xe)&&qt.push(en[un]);qt.length?this._events[bn]=1===qt.length?qt[0]:qt:g(this,bn)}return this},se.prototype.removeAllListeners=function(Ke){var Ve;return Ke?this._events[Ve=pt?pt+Ke:Ke]&&g(this,Ve):(this._events=new vt,this._eventsCount=0),this},se.prototype.off=se.prototype.removeListener,se.prototype.addListener=se.prototype.on,se.prefixed=pt,se.EventEmitter=se,an.exports=se},75:(an,rn,pt)=>{"use strict";var vt=pt(703),_t=pt(801),Ge=pt(313),g=pt(836),se=pt(497),Je={},Ke=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];Je.forwardGeocode=function(Ve){_t.assertShape({query:_t.required(_t.string),mode:_t.oneOf("mapbox.places","mapbox.places-permanent"),countries:_t.arrayOf(_t.string),proximity:_t.oneOf(_t.coordinates,"ip"),types:_t.arrayOf(_t.oneOf(Ke)),autocomplete:_t.boolean,bbox:_t.arrayOf(_t.number),limit:_t.number,language:_t.arrayOf(_t.string),routing:_t.boolean,fuzzyMatch:_t.boolean,worldview:_t.string})(Ve),Ve.mode=Ve.mode||"mapbox.places";var Xe=g(vt({country:Ve.countries},Ge(Ve,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Ge(Ve,["mode","query"]),query:Xe})},Je.reverseGeocode=function(Ve){_t.assertShape({query:_t.required(_t.coordinates),mode:_t.oneOf("mapbox.places","mapbox.places-permanent"),countries:_t.arrayOf(_t.string),types:_t.arrayOf(_t.oneOf(Ke)),bbox:_t.arrayOf(_t.number),limit:_t.number,language:_t.arrayOf(_t.string),reverseMode:_t.oneOf("distance","score"),routing:_t.boolean,worldview:_t.string})(Ve),Ve.mode=Ve.mode||"mapbox.places";var Xe=g(vt({country:Ve.countries},Ge(Ve,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Ge(Ve,["mode","query"]),query:Xe})},an.exports=se(Je)},497:(an,rn,pt)=>{"use strict";var vt=pt(176),_t=pt(454);an.exports=function Ge(g){return function(se){var Je;Je=vt.prototype.isPrototypeOf(se)?se:_t(se);var Ke=Object.create(g);return Ke.client=Je,Ke}}},621:an=>{"use strict";an.exports=function rn(pt,vt){return Object.keys(pt).reduce(function(_t,Ge){return _t[Ge]=vt(Ge,pt[Ge]),_t},{})}},313:an=>{"use strict";an.exports=function rn(pt,vt){var _t=function(Ge,g){return-1!==vt.indexOf(Ge)&&void 0!==g};return"function"==typeof vt&&(_t=vt),Object.keys(pt).filter(function(Ge){return _t(Ge,pt[Ge])}).reduce(function(Ge,g){return Ge[g]=pt[g],Ge},{})}},836:(an,rn,pt)=>{"use strict";var vt=pt(621);an.exports=function _t(Ge){return vt(Ge,function(g,se){return"boolean"==typeof se?JSON.stringify(se):se})}},801:(an,rn,pt)=>{"use strict";var vt=pt(703),_t=pt(89);an.exports=vt(_t,{file:function Ge(Ke){return typeof window<"u"?Ke instanceof global.Blob||Ke instanceof global.ArrayBuffer?void 0:"Blob or ArrayBuffer":"string"!=typeof Ke&&void 0===Ke.pipe?"Filename or Readable stream":void 0},date:function se(Ke){var Ve="date";if("boolean"==typeof Ke)return Ve;try{var Xe=new Date(Ke);if(Xe.getTime&&isNaN(Xe.getTime()))return Ve}catch{return Ve}},coordinates:function Je(Ke){return _t.tuple(_t.number,_t.number)(Ke)},assertShape:function g(Ke,Ve){return _t.assert(_t.strictShape(Ke),Ve)}})},129:(an,rn,pt)=>{"use strict";var vt=pt(49),_t={};function se(Je,Ke){return Object.prototype.hasOwnProperty.call(Je,Ke)}an.exports=function Ge(Je){if(_t[Je])return _t[Je];var Ke=Je.split("."),Ve=Ke[0],Xe=Ke[1];if(!Xe)throw new Error("Invalid token");var Bt=function g(Je){try{return JSON.parse(vt.decode(Je))}catch{throw new Error("Invalid token")}}(Xe),bn={usage:Ve,user:Bt.u};return se(Bt,"a")&&(bn.authorization=Bt.a),se(Bt,"exp")&&(bn.expires=1e3*Bt.exp),se(Bt,"iat")&&(bn.created=1e3*Bt.iat),se(Bt,"scopes")&&(bn.scopes=Bt.scopes),se(Bt,"client")&&(bn.client=Bt.client),se(Bt,"ll")&&(bn.lastLogin=Bt.ll),se(Bt,"iu")&&(bn.impersonator=Bt.iu),_t[Je]=bn,bn}},726:(an,rn,pt)=>{"use strict";function vt(t){return"function"==typeof t}function _t(t){const e=t(o=>{Error.call(o),o.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const Ge=_t(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((o,r)=>`${r+1}) ${o.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function g(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class se{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:o}=this;if(vt(o))try{o()}catch(s){n=s instanceof Ge?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{Ve(s)}catch(l){n=n??[],l instanceof Ge?n=[...n,...l.errors]:n.push(l)}}if(n)throw new Ge(n)}}add(n){var e;if(n&&n!==this)if(this.closed)Ve(n);else{if(n instanceof se){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&g(e,n)}remove(n){const{_finalizers:e}=this;e&&g(e,n),n instanceof se&&n._removeParent(this)}}se.EMPTY=(()=>{const t=new se;return t.closed=!0,t})();const Je=se.EMPTY;function Ke(t){return t instanceof se||t&&"closed"in t&&vt(t.remove)&&vt(t.add)&&vt(t.unsubscribe)}function Ve(t){vt(t)?t():t.unsubscribe()}const Xe={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Bt={setTimeout(t,n,...e){const{delegate:o}=Bt;return o?.setTimeout?o.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=Bt;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function bn(t){Bt.setTimeout(()=>{const{onUnhandledError:n}=Xe;if(!n)throw t;n(t)})}function en(){}const un=Me("C",void 0,void 0);function Me(t,n,e){return{kind:t,value:n,error:e}}let ft=null;function Ue(t){if(Xe.useDeprecatedSynchronousErrorHandling){const n=!ft;if(n&&(ft={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:o}=ft;if(ft=null,e)throw o}}else t()}class He extends se{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Ke(n)&&n.add(this)):this.destination=Hn}static create(n,e,o){return new ln(n,e,o)}next(n){this.isStopped?Ao(function jt(t){return Me("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Ao(function qt(t){return Me("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Ao(un,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const St=Function.prototype.bind;function wt(t,n){return St.call(t,n)}class Lt{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(o){Bn(o)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(o){Bn(o)}else Bn(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){Bn(e)}}}class ln extends He{constructor(n,e,o){let r;if(super(),vt(n)||!n)r={next:n??void 0,error:e??void 0,complete:o??void 0};else{let s;this&&Xe.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&wt(n.next,s),error:n.error&&wt(n.error,s),complete:n.complete&&wt(n.complete,s)}):r=n}this.destination=new Lt(r)}}function Bn(t){Xe.useDeprecatedSynchronousErrorHandling?function st(t){Xe.useDeprecatedSynchronousErrorHandling&&ft&&(ft.errorThrown=!0,ft.error=t)}(t):bn(t)}function Ao(t,n){const{onStoppedNotification:e}=Xe;e&&Bt.setTimeout(()=>e(t,n))}const Hn={closed:!0,next:en,error:function Co(t){throw t},complete:en},Mr="function"==typeof Symbol&&Symbol.observable||"@@observable";function mr(t){return t}function Vs(t){return 0===t.length?mr:1===t.length?t[0]:function(e){return t.reduce((o,r)=>r(o),e)}}let ri=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const o=new t;return o.source=this,o.operator=e,o}subscribe(e,o,r){const s=function Us(t){return t&&t instanceof He||function Gl(t){return t&&vt(t.next)&&vt(t.error)&&vt(t.complete)}(t)&&Ke(t)}(e)?e:new ln(e,o,r);return Ue(()=>{const{operator:l,source:h}=this;s.add(l?l.call(s,h):h?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(o){e.error(o)}}forEach(e,o){return new(o=Ca(o))((r,s)=>{const l=new ln({next:h=>{try{e(h)}catch(f){s(f),l.unsubscribe()}},error:s,complete:r});this.subscribe(l)})}_subscribe(e){var o;return null===(o=this.source)||void 0===o?void 0:o.subscribe(e)}[Mr](){return this}pipe(...e){return Vs(e)(this)}toPromise(e){return new(e=Ca(e))((o,r)=>{let s;this.subscribe(l=>s=l,l=>r(l),()=>o(s))})}}return t.create=n=>new t(n),t})();function Ca(t){var n;return null!==(n=t??Xe.Promise)&&void 0!==n?n:Promise}const fs=_t(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let si=(()=>{class t extends ri{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const o=new Ta(this,this);return o.operator=e,o}_throwIfClosed(){if(this.closed)throw new fs}next(e){Ue(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const o of this.currentObservers)o.next(e)}})}error(e){Ue(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:o}=this;for(;o.length;)o.shift().error(e)}})}complete(){Ue(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:o,isStopped:r,observers:s}=this;return o||r?Je:(this.currentObservers=null,s.push(e),new se(()=>{this.currentObservers=null,g(s,e)}))}_checkFinalizedStatuses(e){const{hasError:o,thrownError:r,isStopped:s}=this;o?e.error(r):s&&e.complete()}asObservable(){const e=new ri;return e.source=this,e}}return t.create=(n,e)=>new Ta(n,e),t})();class Ta extends si{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,o;null===(o=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===o||o.call(e,n)}error(n){var e,o;null===(o=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===o||o.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,o;return null!==(o=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==o?o:Je}}function js(t){return vt(t?.lift)}function Ki(t){return n=>{if(js(n))return n.lift(function(e){try{return t(e,this)}catch(o){this.error(o)}});throw new TypeError("Unable to lift unknown Observable type")}}function ii(t,n,e,o,r){return new Ko(t,n,e,o,r)}class Ko extends He{constructor(n,e,o,r,s,l){super(n),this.onFinalize=s,this.shouldUnsubscribe=l,this._next=e?function(h){try{e(h)}catch(f){n.error(f)}}:super._next,this._error=r?function(h){try{r(h)}catch(f){n.error(f)}finally{this.unsubscribe()}}:super._error,this._complete=o?function(){try{o()}catch(h){n.error(h)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function Vn(t,n){return Ki((e,o)=>{let r=0;e.subscribe(ii(o,s=>{o.next(t.call(n,s,r++))}))})}function Sa(t){return this instanceof Sa?(this.v=t,this):new Sa(t)}function qd(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function xl(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],o=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},o("next"),o("throw"),o("return"),e[Symbol.asyncIterator]=function(){return this},e);function o(s){e[s]=t[s]&&function(l){return new Promise(function(h,f){!function r(s,l,h,f){Promise.resolve(f).then(function(y){s({value:y,done:h})},l)}(h,f,(l=t[s](l)).done,l.value)})}}}const Vu=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Kd(t){return vt(t?.then)}function Oc(t){return vt(t[Mr])}function Zl(t){return Symbol.asyncIterator&&vt(t?.[Symbol.asyncIterator])}function Ds(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Xd=function Kl(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Xl(t){return vt(t?.[Xd])}function ye(t){return function ql(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=e.apply(t,n||[]),s=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(R){o[R]&&(r[R]=function(V){return new Promise(function($,X){s.push([R,V,$,X])>1||h(R,V)})})}function h(R,V){try{!function f(R){R.value instanceof Sa?Promise.resolve(R.value.v).then(y,C):D(s[0][2],R)}(o[R](V))}catch($){D(s[0][3],$)}}function y(R){h("next",R)}function C(R){h("throw",R)}function D(R,V){R(V),s.shift(),s.length&&h(s[0][0],s[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:o,done:r}=yield Sa(e.read());if(r)return yield Sa(void 0);yield yield Sa(o)}}finally{e.releaseLock()}})}function Q(t){return vt(t?.getReader)}function ne(t){if(t instanceof ri)return t;if(null!=t){if(Oc(t))return function ge(t){return new ri(n=>{const e=t[Mr]();if(vt(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Vu(t))return function Ie(t){return new ri(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(Kd(t))return function Re(t){return new ri(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,bn)})}(t);if(Zl(t))return We(t);if(Xl(t))return function qe(t){return new ri(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Q(t))return function ze(t){return We(ye(t))}(t)}throw Ds(t)}function We(t){return new ri(n=>{(function nt(t,n){var e,o,r,s;return function Ka(t,n,e,o){return new(e||(e=Promise))(function(s,l){function h(C){try{y(o.next(C))}catch(D){l(D)}}function f(C){try{y(o.throw(C))}catch(D){l(D)}}function y(C){C.done?s(C.value):function r(s){return s instanceof e?s:new e(function(l){l(s)})}(C.value).then(h,f)}y((o=o.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=qd(t);!(o=yield e.next()).done;)if(n.next(o.value),n.closed)return}catch(l){r={error:l}}finally{try{o&&!o.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function Ct(t,n,e,o=0,r=!1){const s=n.schedule(function(){e(),r?t.add(this.schedule(null,o)):this.unsubscribe()},o);if(t.add(s),!r)return s}function Et(t,n,e=1/0){return vt(n)?Et((o,r)=>Vn((s,l)=>n(o,s,r,l))(ne(t(o,r))),e):("number"==typeof n&&(e=n),Ki((o,r)=>function nn(t,n,e,o,r,s,l,h){const f=[];let y=0,C=0,D=!1;const R=()=>{D&&!f.length&&!y&&n.complete()},V=X=>y<o?$(X):f.push(X),$=X=>{s&&n.next(X),y++;let ee=!1;ne(e(X,C++)).subscribe(ii(n,ue=>{r?.(ue),s?V(ue):n.next(ue)},()=>{ee=!0},void 0,()=>{if(ee)try{for(y--;f.length&&y<o;){const ue=f.shift();l?Ct(n,l,()=>$(ue)):$(ue)}R()}catch(ue){n.error(ue)}}))};return t.subscribe(ii(n,V,()=>{D=!0,R()})),()=>{h?.()}}(o,r,t,e)))}function Mn(t=1/0){return Et(mr,t)}const mn=new ri(t=>t.complete());function di(t){return t&&vt(t.schedule)}function Vi(t){return t[t.length-1]}function Rn(t){return vt(Vi(t))?t.pop():void 0}function qi(t){return di(Vi(t))?t.pop():void 0}function wl(t,n=0){return Ki((e,o)=>{e.subscribe(ii(o,r=>Ct(o,t,()=>o.next(r),n),()=>Ct(o,t,()=>o.complete(),n),r=>Ct(o,t,()=>o.error(r),n)))})}function Ya(t,n=0){return Ki((e,o)=>{o.add(t.schedule(()=>e.subscribe(o),n))})}function qf(t,n){if(!t)throw new Error("Iterable cannot be null");return new ri(e=>{Ct(e,n,()=>{const o=t[Symbol.asyncIterator]();Ct(e,n,()=>{o.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function er(t,n){return n?function Uu(t,n){if(null!=t){if(Oc(t))return function yt(t,n){return ne(t).pipe(Ya(n),wl(n))}(t,n);if(Vu(t))return function Jo(t,n){return new ri(e=>{let o=0;return n.schedule(function(){o===t.length?e.complete():(e.next(t[o++]),e.closed||this.schedule())})})}(t,n);if(Kd(t))return function Cl(t,n){return ne(t).pipe(Ya(n),wl(n))}(t,n);if(Zl(t))return qf(t,n);if(Xl(t))return function Yl(t,n){return new ri(e=>{let o;return Ct(e,n,()=>{o=t[Xd](),Ct(e,n,()=>{let r,s;try{({value:r,done:s}=o.next())}catch(l){return void e.error(l)}s?e.complete():e.next(r)},0,!0)}),()=>vt(o?.return)&&o.return()})}(t,n);if(Q(t))return function Qa(t,n){return qf(ye(t),n)}(t,n)}throw Ds(t)}(t,n):ne(t)}function Lc(...t){const n=qi(t),e=function go(t,n){return"number"==typeof Vi(t)?t.pop():n}(t,1/0),o=t;return o.length?1===o.length?ne(o[0]):Mn(e)(er(o,n)):mn}function Zt(t={}){const{connector:n=(()=>new si),resetOnError:e=!0,resetOnComplete:o=!0,resetOnRefCountZero:r=!0}=t;return s=>{let l,h,f,y=0,C=!1,D=!1;const R=()=>{h?.unsubscribe(),h=void 0},V=()=>{R(),l=f=void 0,C=D=!1},$=()=>{const X=l;V(),X?.unsubscribe()};return Ki((X,ee)=>{y++,!D&&!C&&R();const ue=f=f??n();ee.add(()=>{y--,0===y&&!D&&!C&&(h=wi($,r))}),ue.subscribe(ee),!l&&y>0&&(l=new ln({next:fe=>ue.next(fe),error:fe=>{D=!0,R(),h=wi(V,e,fe),ue.error(fe)},complete:()=>{C=!0,R(),h=wi(V,o),ue.complete()}}),ne(X).subscribe(l))})(s)}}function wi(t,n,...e){if(!0===n)return void t();if(!1===n)return;const o=new ln({next:()=>{o.unsubscribe(),t()}});return ne(n(...e)).subscribe(o)}function En(t){for(let n in t)if(t[n]===En)return n;throw Error("Could not find renamed property on target object.")}function oa(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function lo(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(lo).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function mi(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const Yd=En({__forward_ref__:En});function Ei(t){return t.__forward_ref__=Ei,t.toString=function(){return lo(this())},t}function qn(t){return Ur(t)?t():t}function Ur(t){return"function"==typeof t&&t.hasOwnProperty(Yd)&&t.__forward_ref__===Ei}function _o(t){return t&&!!t.\u0275providers}const jr="https://g.co/ng/security#xss";class It extends Error{constructor(n,e){super(Ja(n,e)),this.code=n}}function Ja(t,n){return`NG0${Math.abs(t)}${n?": "+n.trim():""}`}function hi(t){return"string"==typeof t?t:null==t?"":String(t)}function $u(t,n){throw new It(-201,!1)}function ms(t,n){null==t&&function Zi(t,n,e,o){throw new Error(`ASSERTION ERROR: ${t}`+(null==o?"":` [Expected=> ${e} ${o} ${n} <=Actual]`))}(n,t,null,"!=")}function tn(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function yn(t){return{providers:t.providers||[],imports:t.imports||[]}}function th(t){return Rc(t,gs)||Rc(t,Xf)}function Rc(t,n){return t.hasOwnProperty(n)?t[n]:null}function Tl(t){return t&&(t.hasOwnProperty(Fc)||t.hasOwnProperty(Wg))?t[Fc]:null}const gs=En({\u0275prov:En}),Fc=En({\u0275inj:En}),Xf=En({ngInjectableDef:En}),Wg=En({ngInjectorDef:En});var Jn=(()=>((Jn=Jn||{})[Jn.Default=0]="Default",Jn[Jn.Host=1]="Host",Jn[Jn.Self=2]="Self",Jn[Jn.SkipSelf=4]="SkipSelf",Jn[Jn.Optional=8]="Optional",Jn))();let _p;function ks(t){const n=_p;return _p=t,n}function Nc(t,n,e){const o=th(t);return o&&"root"==o.providedIn?void 0===o.value?o.value=o.factory():o.value:e&Jn.Optional?null:void 0!==n?n:void $u(lo(t))}const ko=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Fi={},zc="__NG_DI_FLAG__",Wu="ngTempTokenPath",ih="ngTokenPath",oh=/\n/gm,yp="\u0275",rh="__source";let Bc;function Sl(t){const n=Bc;return Bc=t,n}function Jf(t,n=Jn.Default){if(void 0===Bc)throw new It(-203,!1);return null===Bc?Nc(t,void 0,n):Bc.get(t,n&Jn.Optional?null:void 0,n)}function Rt(t,n=Jn.Default){return(function Yf(){return _p}()||Jf)(qn(t),n)}function ai(t,n=Jn.Default){return Rt(t,qu(n))}function qu(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function ki(t){const n=[];for(let e=0;e<t.length;e++){const o=qn(t[e]);if(Array.isArray(o)){if(0===o.length)throw new It(900,!1);let r,s=Jn.Default;for(let l=0;l<o.length;l++){const h=o[l],f=Zg(h);"number"==typeof f?-1===f?r=h.token:s|=f:r=h}n.push(Rt(r,s))}else n.push(Rt(o))}return n}function El(t,n){return t[zc]=n,t.prototype[zc]=n,t}function Zg(t){return t[zc]}function el(t){return{toString:t}.toString()}var ra=(()=>((ra=ra||{})[ra.OnPush=0]="OnPush",ra[ra.Default=1]="Default",ra))(),sa=(()=>{return(t=sa||(sa={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",sa;var t})();const Il={},Xi=[],Zu=En({\u0275cmp:En}),Ku=En({\u0275dir:En}),Xu=En({\u0275pipe:En}),tm=En({\u0275mod:En}),tl=En({\u0275fac:En}),sh=En({__NG_ELEMENT_ID__:En});let ah=0;function Qt(t){return el(()=>{const e=!0===t.standalone,o={},r={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:o,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===ra.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&t.dependencies||null,getStandaloneInjector:null,selectors:t.selectors||Xi,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||sa.Emulated,id:"c"+ah++,styles:t.styles||Xi,_:null,setInput:null,schemas:t.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=t.dependencies,l=t.features;return r.inputs=im(t.inputs,o),r.outputs=im(t.outputs),l&&l.forEach(h=>h(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(Yu).filter(bp):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map($r).filter(bp):null,r})}function vp(t,n,e){const o=t.\u0275cmp;o.directiveDefs=()=>("function"==typeof n?n():n).map(Yu),o.pipeDefs=()=>("function"==typeof e?e():e).map($r)}function Yu(t){return no(t)||ss(t)}function bp(t){return null!==t}function pn(t){return el(()=>({type:t.type,bootstrap:t.bootstrap||Xi,declarations:t.declarations||Xi,imports:t.imports||Xi,exports:t.exports||Xi,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function im(t,n){if(null==t)return Il;const e={};for(const o in t)if(t.hasOwnProperty(o)){let r=t[o],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),e[r]=o,n&&(n[r]=s)}return e}const On=Qt;function Hr(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function no(t){return t[Zu]||null}function ss(t){return t[Ku]||null}function $r(t){return t[Xu]||null}function Gr(t,n){const e=t[tm]||null;if(!e&&!0===n)throw new Error(`Type ${lo(t)} does not have '\u0275mod' property.`);return e}const nl=0,Tn=1,Di=2,jo=3,Ea=4,Hs=5,Wr=6,tc=7,Xo=8,Dl=9,xp=10,Mi=11,wp=12,Qu=13,Cp=14,Ju=15,kr=16,Uc=17,jc=18,Ia=19,ed=20,Tp=21,co=22,Hc=1,$c=2,Ml=7,aa=8,kl=9,ei=10;function $s(t){return Array.isArray(t)&&"object"==typeof t[Hc]}function Gs(t){return Array.isArray(t)&&!0===t[Hc]}function Gc(t){return 0!=(4&t.flags)}function Wc(t){return t.componentOffset>-1}function ch(t){return 1==(1&t.flags)}function As(t){return null!==t.template}function Xg(t){return 0!=(256&t[Di])}function Ho(t,n){return t.hasOwnProperty(tl)?t[tl]:null}class Ap{constructor(n,e,o){this.previousValue=n,this.currentValue=e,this.firstChange=o}isFirstChange(){return this.firstChange}}function _r(){return lm}function lm(t){return t.type.prototype.ngOnChanges&&(t.setInput=cm),Pp}function Pp(){const t=um(this),n=t?.current;if(n){const e=t.previous;if(e===Il)t.previous=n;else for(let o in n)e[o]=n[o];t.current=null,this.ngOnChanges(n)}}function cm(t,n,e,o){const r=this.declaredInputs[e],s=um(t)||function rd(t,n){return t[hh]=n}(t,{previous:Il,current:null}),l=s.current||(s.current={}),h=s.previous,f=h[r];l[r]=new Ap(f&&f.currentValue,n,h===Il),t[o]=n}_r.ngInherit=!0;const hh="__ngSimpleChanges__";function um(t){return t[hh]||null}const _s=function(t,n,e){},dm="svg";function yr(t){for(;Array.isArray(t);)t=t[nl];return t}function qc(t,n){return yr(n[t])}function qr(t,n){return yr(n[t.index])}function hm(t,n){return t.data[n]}function nc(t,n){return t[n]}function Ps(t,n){const e=n[t];return $s(e)?e:e[nl]}function vr(t){return 64==(64&t[Di])}function Al(t,n){return null==n?null:t[n]}function e_(t){t[jc]=0}function Rp(t,n){t[Hs]+=n;let e=t,o=t[jo];for(;null!==o&&(1===n&&1===e[Hs]||-1===n&&0===e[Hs]);)o[Hs]+=n,e=o,o=o[jo]}const ni={lFrame:k(null),bindingsEnabled:!0};function fm(){return ni.bindingsEnabled}function zt(){return ni.lFrame.lView}function Ni(){return ni.lFrame.tView}function be(t){return ni.lFrame.contextLView=t,t[Xo]}function ve(t){return ni.lFrame.contextLView=null,t}function Ar(){let t=Np();for(;null!==t&&64===t.type;)t=t.parent;return t}function Np(){return ni.lFrame.currentTNode}function Os(t,n){const e=ni.lFrame;e.currentTNode=t,e.isParent=n}function ad(){return ni.lFrame.isParent}function ic(){ni.lFrame.isParent=!1}function Zr(){const t=ni.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function ol(){return ni.lFrame.bindingIndex}function Kc(){return ni.lFrame.bindingIndex++}function Ma(t){const n=ni.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function n_(t,n){const e=ni.lFrame;e.bindingIndex=e.bindingRootIndex=t,ld(n)}function ld(t){ni.lFrame.currentDirectiveIndex=t}function Xc(t){const n=ni.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}function v(){return ni.lFrame.currentQueryIndex}function d(t){ni.lFrame.currentQueryIndex=t}function m(t){const n=t[Tn];return 2===n.type?n.declTNode:1===n.type?t[Wr]:null}function x(t,n,e){if(e&Jn.SkipSelf){let r=n,s=t;for(;!(r=r.parent,null!==r||e&Jn.Host||(r=m(s),null===r||(s=s[Ju],10&r.type))););if(null===r)return!1;n=r,t=s}const o=ni.lFrame=E();return o.currentTNode=n,o.lView=t,!0}function T(t){const n=E(),e=t[Tn];ni.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function E(){const t=ni.lFrame,n=null===t?null:t.child;return null===n?k(t):n}function k(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function O(){const t=ni.lFrame;return ni.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const B=O;function G(){const t=O();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function re(){return ni.lFrame.selectedIndex}function de(t){ni.lFrame.selectedIndex=t}function le(){const t=ni.lFrame;return hm(t.tView,t.selectedIndex)}function Le(t,n){for(let e=n.directiveStart,o=n.directiveEnd;e<o;e++){const s=t.data[e].type.prototype,{ngAfterContentInit:l,ngAfterContentChecked:h,ngAfterViewInit:f,ngAfterViewChecked:y,ngOnDestroy:C}=s;l&&(t.contentHooks||(t.contentHooks=[])).push(-e,l),h&&((t.contentHooks||(t.contentHooks=[])).push(e,h),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,h)),f&&(t.viewHooks||(t.viewHooks=[])).push(-e,f),y&&((t.viewHooks||(t.viewHooks=[])).push(e,y),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,y)),null!=C&&(t.destroyHooks||(t.destroyHooks=[])).push(e,C)}}function Pe(t,n,e){it(t,n,3,e)}function Fe(t,n,e,o){(3&t[Di])===e&&it(t,n,e,o)}function $e(t,n){let e=t[Di];(3&e)===n&&(e&=2047,e+=1,t[Di]=e)}function it(t,n,e,o){const s=o??-1,l=n.length-1;let h=0;for(let f=void 0!==o?65535&t[jc]:0;f<l;f++)if("number"==typeof n[f+1]){if(h=n[f],null!=o&&h>=o)break}else n[f]<0&&(t[jc]+=65536),(h<s||-1==s)&&(rt(t,e,n,f),t[jc]=(4294901760&t[jc])+f+2),f++}function rt(t,n,e,o){const r=e[o]<0,s=e[o+1],h=t[r?-e[o]:e[o]];if(r){if(t[Di]>>11<t[jc]>>16&&(3&t[Di])===n){t[Di]+=2048,_s(4,h,s);try{s.call(h)}finally{_s(5,h,s)}}}else{_s(4,h,s);try{s.call(h)}finally{_s(5,h,s)}}}const Vt=-1;class Ze{constructor(n,e,o){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=o}}function vn(t,n,e){let o=0;for(;o<e.length;){const r=e[o];if("number"==typeof r){if(0!==r)break;o++;const s=e[o++],l=e[o++],h=e[o++];t.setAttribute(n,l,h,s)}else{const s=r,l=e[++o];hn(s)?t.setProperty(n,s,l):t.setAttribute(n,s,l),o++}}return o}function li(t){return 3===t||4===t||6===t}function hn(t){return 64===t.charCodeAt(0)}function Jt(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let o=0;o<n.length;o++){const r=n[o];"number"==typeof r?e=r:0===e||Sn(t,e,r,null,-1===e||2===e?n[++o]:null)}}return t}function Sn(t,n,e,o,r){let s=0,l=t.length;if(-1===n)l=-1;else for(;s<t.length;){const h=t[s++];if("number"==typeof h){if(h===n){l=-1;break}if(h>n){l=s-1;break}}}for(;s<t.length;){const h=t[s];if("number"==typeof h)break;if(h===e){if(null===o)return void(null!==r&&(t[s+1]=r));if(o===t[s+1])return void(t[s+2]=r)}s++,null!==o&&s++,null!==r&&s++}-1!==l&&(t.splice(l,0,n),s=l+1),t.splice(s++,0,e),null!==o&&t.splice(s++,0,o),null!==r&&t.splice(s++,0,r)}function Ci(t){return t!==Vt}function In(t){return 32767&t}function Qi(t,n){let e=function Yi(t){return t>>16}(t),o=n;for(;e>0;)o=o[Ju],e--;return o}let yo=!0;function io(t){const n=yo;return yo=t,n}const ys=255,la=5;let Pl=0;const Gi={};function Pi(t,n){const e=Kr(t,n);if(-1!==e)return e;const o=n[Tn];o.firstCreatePass&&(t.injectorIndex=n.length,No(o.data,t),No(n,null),No(o.blueprint,null));const r=xo(t,n),s=t.injectorIndex;if(Ci(r)){const l=In(r),h=Qi(r,n),f=h[Tn].data;for(let y=0;y<8;y++)n[s+y]=h[l+y]|f[l+y]}return n[s+8]=r,s}function No(t,n){t.push(0,0,0,0,0,0,0,0,n)}function Kr(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function xo(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,o=null,r=n;for(;null!==r;){if(o=ev(r),null===o)return Vt;if(e++,r=r[Ju],-1!==o.injectorIndex)return o.injectorIndex|e<<16}return Vt}function Pr(t,n,e){!function bo(t,n,e){let o;"string"==typeof e?o=e.charCodeAt(0)||0:e.hasOwnProperty(sh)&&(o=e[sh]),null==o&&(o=e[sh]=Pl++);const r=o&ys;n.data[t+(r>>la)]|=1<<r}(t,n,e)}function Ol(t,n,e){if(e&Jn.Optional||void 0!==t)return t;$u()}function Yc(t,n,e,o){if(e&Jn.Optional&&void 0===o&&(o=null),!(e&(Jn.Self|Jn.Host))){const r=t[Dl],s=ks(void 0);try{return r?r.get(n,o,e&Jn.Optional):Nc(n,o,e&Jn.Optional)}finally{ks(s)}}return Ol(o,0,e)}function Ls(t,n,e,o=Jn.Default,r){if(null!==t){if(1024&n[Di]){const l=function J0(t,n,e,o,r){let s=t,l=n;for(;null!==s&&null!==l&&1024&l[Di]&&!(256&l[Di]);){const h=Ws(s,l,e,o|Jn.Self,Gi);if(h!==Gi)return h;let f=s.parent;if(!f){const y=l[Tp];if(y){const C=y.get(e,Gi,o);if(C!==Gi)return C}f=ev(l),l=l[Ju]}s=f}return r}(t,n,e,o,Gi);if(l!==Gi)return l}const s=Ws(t,n,e,o,Gi);if(s!==Gi)return s}return Yc(n,e,o,r)}function Ws(t,n,e,o,r){const s=function cd(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(sh)?t[sh]:void 0;return"number"==typeof n?n>=0?n&ys:Q0:n}(e);if("function"==typeof s){if(!x(n,t,o))return o&Jn.Host?Ol(r,0,o):Yc(n,e,o,r);try{const l=s(o);if(null!=l||o&Jn.Optional)return l;$u()}finally{B()}}else if("number"==typeof s){let l=null,h=Kr(t,n),f=Vt,y=o&Jn.Host?n[kr][Wr]:null;for((-1===h||o&Jn.SkipSelf)&&(f=-1===h?xo(t,n):n[h+8],f!==Vt&&o_(o,!1)?(l=n[Tn],h=In(f),n=Qi(f,n)):h=-1);-1!==h;){const C=n[Tn];if(Jy(s,h,C.data)){const D=Ll(h,n,e,l,o,y);if(D!==Gi)return D}f=n[h+8],f!==Vt&&o_(o,n[Tn].data[h+8]===y)&&Jy(s,h,n)?(l=C,h=In(f),n=Qi(f,n)):h=-1}}return r}function Ll(t,n,e,o,r,s){const l=n[Tn],h=l.data[t+8],C=ka(h,l,e,null==o?Wc(h)&&yo:o!=l&&0!=(3&h.type),r&Jn.Host&&s===h);return null!==C?Rs(n,l,C,h):Gi}function ka(t,n,e,o,r){const s=t.providerIndexes,l=n.data,h=1048575&s,f=t.directiveStart,C=s>>20,R=r?h+C:t.directiveEnd;for(let V=o?h:h+C;V<R;V++){const $=l[V];if(V<f&&e===$||V>=f&&$.type===e)return V}if(r){const V=l[f];if(V&&As(V)&&V.type===e)return f}return null}function Rs(t,n,e,o){let r=t[e];const s=n.data;if(function Tt(t){return t instanceof Ze}(r)){const l=r;l.resolving&&function Qd(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new It(-200,`Circular dependency in DI detected for ${t}${e}`)}(function to(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():hi(t)}(s[e]));const h=io(l.canSeeViewProviders);l.resolving=!0;const f=l.injectImpl?ks(l.injectImpl):null;x(t,o,Jn.Default);try{r=t[e]=l.factory(void 0,s,t,o),n.firstCreatePass&&e>=o.directiveStart&&function Ee(t,n,e){const{ngOnChanges:o,ngOnInit:r,ngDoCheck:s}=n.type.prototype;if(o){const l=lm(n);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,l),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,l)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,r),s&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,s))}(e,s[e],n)}finally{null!==f&&ks(f),io(h),l.resolving=!1,B()}}return r}function Jy(t,n,e){return!!(e[n+(t>>la)]&1<<t)}function o_(t,n){return!(t&Jn.Self||t&Jn.Host&&n)}class _h{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,o){return Ls(this._tNode,this._lView,n,qu(o),e)}}function Q0(){return new _h(Ar(),zt())}function Or(t){return el(()=>{const n=t.prototype.constructor,e=n[tl]||r_(n),o=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==o;){const s=r[tl]||r_(r);if(s&&s!==e)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function r_(t){return Ur(t)?()=>{const n=r_(qn(t));return n&&n()}:Ho(t)}function ev(t){const n=t[Tn],e=n.type;return 2===e?n.declTNode:1===e?t[Wr]:null}function Bp(t){return function as(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const e=t.attrs;if(e){const o=e.length;let r=0;for(;r<o;){const s=e[r];if(li(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<o&&"string"==typeof e[r];)r++;else{if(s===n)return e[r+1];r+=2}}}return null}(Ar(),t)}const vh="__parameters__";function Up(t,n,e){return el(()=>{const o=function Qc(t){return function(...e){if(t){const o=t(...e);for(const r in o)this[r]=o[r]}}}(n);function r(...s){if(this instanceof r)return o.apply(this,s),this;const l=new r(...s);return h.annotation=l,h;function h(f,y,C){const D=f.hasOwnProperty(vh)?f[vh]:Object.defineProperty(f,vh,{value:[]})[vh];for(;D.length<=C;)D.push(null);return(D[C]=D[C]||[]).push(l),f}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class cn{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=tn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function qs(t,n){t.forEach(e=>Array.isArray(e)?qs(e,n):n(e))}function rl(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function Rl(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function sl(t,n){const e=[];for(let o=0;o<t;o++)e.push(n);return e}function Aa(t,n,e){let o=Jc(t,n);return o>=0?t[1|o]=e:(o=~o,function zT(t,n,e,o){let r=t.length;if(r==n)t.push(e,o);else if(1===r)t.push(o,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=o}}(t,o,n,e)),o}function s_(t,n){const e=Jc(t,n);if(e>=0)return t[1|e]}function Jc(t,n){return function ix(t,n,e){let o=0,r=t.length>>e;for(;r!==o;){const s=o+(r-o>>1),l=t[s<<e];if(n===l)return s<<e;l>n?r=s:o=s+1}return~(r<<e)}(t,n,1)}const rc=El(Up("Optional"),8),sc=El(Up("SkipSelf"),4);var Po=(()=>((Po=Po||{})[Po.Important=1]="Important",Po[Po.DashCase=2]="DashCase",Po))();const ua=new Map;let ZT=0;const hv="__ngContext__";function Qr(t,n){$s(n)?(t[hv]=n[ed],function sx(t){ua.set(t[ed],t)}(n)):t[hv]=n}let Em;function v_(t,n){return Em(t,n)}function Im(t){const n=t[jo];return Gs(n)?n[jo]:n}function Oi(t){return Fl(t[Qu])}function Mm(t){return Fl(t[Ea])}function Fl(t){for(;null!==t&&!Gs(t);)t=t[Ea];return t}function Zs(t,n,e,o,r){if(null!=o){let s,l=!1;Gs(o)?s=o:$s(o)&&(l=!0,o=o[nl]);const h=yr(o);0===t&&null!==e?null==r?vv(n,e,h):nu(n,e,h,r||null,!0):1===t&&null!==e?nu(n,e,h,r||null,!0):2===t?function T_(t,n,e){const o=Kp(t,n);o&&function mx(t,n,e,o){t.removeChild(n,e,o)}(t,o,n,e)}(n,h,l):3===t&&n.destroyNode(h),null!=s&&function yx(t,n,e,o,r){const s=e[Ml];s!==yr(e)&&Zs(n,t,o,s,r);for(let h=ei;h<e.length;h++){const f=e[h];Lm(f[Tn],f,t,n,o,s)}}(n,t,s,e,r)}}function b_(t,n,e){return t.createElement(n,e)}function px(t,n){const e=t[kl],o=e.indexOf(n),r=n[jo];512&n[Di]&&(n[Di]&=-513,Rp(r,-1)),e.splice(o,1)}function km(t,n){if(t.length<=ei)return;const e=ei+n,o=t[e];if(o){const r=o[Uc];null!==r&&r!==t&&px(r,o),n>0&&(t[e-1][Ea]=o[Ea]);const s=Rl(t,ei+n);!function cs(t,n){Lm(t,n,n[Mi],2,null,null),n[nl]=null,n[Wr]=null}(o[Tn],o);const l=s[Ia];null!==l&&l.detachView(s[Tn]),o[jo]=null,o[Ea]=null,o[Di]&=-65}return o}function _v(t,n){if(!(128&n[Di])){const e=n[Mi];e.destroyNode&&Lm(t,n,e,3,null,null),function mv(t){let n=t[Qu];if(!n)return yv(t[Tn],t);for(;n;){let e=null;if($s(n))e=n[Qu];else{const o=n[ei];o&&(e=o)}if(!e){for(;n&&!n[Ea]&&n!==t;)$s(n)&&yv(n[Tn],n),n=n[jo];null===n&&(n=t),$s(n)&&yv(n[Tn],n),e=n&&n[Ea]}n=e}}(n)}}function yv(t,n){if(!(128&n[Di])){n[Di]&=-65,n[Di]|=128,function Mh(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let o=0;o<e.length;o+=2){const r=n[e[o]];if(!(r instanceof Ze)){const s=e[o+1];if(Array.isArray(s))for(let l=0;l<s.length;l+=2){const h=r[s[l]],f=s[l+1];_s(4,h,f);try{f.call(h)}finally{_s(5,h,f)}}else{_s(4,r,s);try{s.call(r)}finally{_s(5,r,s)}}}}}(t,n),function tu(t,n){const e=t.cleanup,o=n[tc];let r=-1;if(null!==e)for(let s=0;s<e.length-1;s+=2)if("string"==typeof e[s]){const l=e[s+3];l>=0?o[r=l]():o[r=-l].unsubscribe(),s+=2}else{const l=o[r=e[s+1]];e[s].call(l)}if(null!==o){for(let s=r+1;s<o.length;s++)(0,o[s])();n[tc]=null}}(t,n),1===n[Tn].type&&n[Mi].destroy();const e=n[Uc];if(null!==e&&Gs(n[jo])){e!==n[jo]&&px(e,n);const o=n[Ia];null!==o&&o.detachView(t)}!function uv(t){ua.delete(t[ed])}(n)}}function Am(t,n,e){return function Pm(t,n,e){let o=n;for(;null!==o&&40&o.type;)o=(n=o).parent;if(null===o)return e[nl];{const{componentOffset:r}=o;if(r>-1){const{encapsulation:s}=t.data[o.directiveStart+r];if(s===sa.None||s===sa.Emulated)return null}return qr(o,e)}}(t,n.parent,e)}function nu(t,n,e,o,r){t.insertBefore(n,e,o,r)}function vv(t,n,e){t.appendChild(n,e)}function fx(t,n,e,o,r){null!==o?nu(t,n,e,o,r):vv(t,n,e)}function Kp(t,n){return t.parentNode(n)}function x_(t,n,e){return xv(t,n,e)}let iu,Rm,Ev,Ah,xv=function bv(t,n,e){return 40&t.type?qr(t,e):null};function w_(t,n,e,o){const r=Am(t,o,n),s=n[Mi],h=x_(o.parent||n[Wr],o,n);if(null!=r)if(Array.isArray(e))for(let f=0;f<e.length;f++)fx(s,r,e[f],h,!1);else fx(s,r,e,h,!1);void 0!==iu&&iu(s,o,n,e,r)}function ou(t,n){if(null!==n){const e=n.type;if(3&e)return qr(n,t);if(4&e)return C_(-1,t[n.index]);if(8&e){const o=n.child;if(null!==o)return ou(t,o);{const r=t[n.index];return Gs(r)?C_(-1,r):yr(r)}}if(32&e)return v_(n,t)()||yr(t[n.index]);{const o=Om(t,n);return null!==o?Array.isArray(o)?o[0]:ou(Im(t[kr]),o):ou(t,n.next)}}return null}function Om(t,n){return null!==n?t[kr][Wr].projection[n.projection]:null}function C_(t,n){const e=ei+t+1;if(e<n.length){const o=n[e],r=o[Tn].firstChild;if(null!==r)return ou(o,r)}return n[Ml]}function Cv(t,n,e,o,r,s,l){for(;null!=e;){const h=o[e.index],f=e.type;if(l&&0===n&&(h&&Qr(yr(h),o),e.flags|=2),32!=(32&e.flags))if(8&f)Cv(t,n,e.child,o,r,s,!1),Zs(n,t,r,h,s);else if(32&f){const y=v_(e,o);let C;for(;C=y();)Zs(n,t,r,C,s);Zs(n,t,r,h,s)}else 16&f?_x(t,n,o,e,r,s):Zs(n,t,r,h,s);e=l?e.projectionNext:e.next}}function Lm(t,n,e,o,r,s){Cv(e,o,t.firstChild,n,r,s,!1)}function _x(t,n,e,o,r,s){const l=e[kr],f=l[Wr].projection[o.projection];if(Array.isArray(f))for(let y=0;y<f.length;y++)Zs(n,t,r,f[y],s);else Cv(t,n,f,l[jo],r,s,!0)}function Tv(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function Sv(t,n,e){const{mergedAttrs:o,classes:r,styles:s}=e;null!==o&&vn(t,n,o),null!==r&&Tv(t,n,r),null!==s&&function QT(t,n,e){t.setAttribute(n,"style",e)}(t,n,s)}function ha(t){return function Fm(){if(void 0===Rm&&(Rm=null,ko.trustedTypes))try{Rm=ko.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Rm}()?.createHTML(t)||t}function S_(){if(void 0===Ah&&(Ah=null,ko.trustedTypes))try{Ah=ko.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Ah}function md(t){return S_()?.createHTML(t)||t}function bx(t){return S_()?.createScriptURL(t)||t}class Ph{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${jr})`}}class nS extends Ph{getTypeName(){return"HTML"}}class iS extends Ph{getTypeName(){return"Style"}}class oS extends Ph{getTypeName(){return"Script"}}class rS extends Ph{getTypeName(){return"URL"}}class sS extends Ph{getTypeName(){return"ResourceURL"}}function Ks(t){return t instanceof Ph?t.changingThisBreaksApplicationSecurity:t}function uc(t,n){const e=function Yp(t){return t instanceof Ph&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${jr})`)}return e===n}class zm{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(ha(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class wx{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=ha(n),e}}const Bm=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function Qp(t){return(t=String(t)).match(Bm)?t:"unsafe:"+t}function Nl(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Vm(...t){const n={};for(const e of t)for(const o in e)e.hasOwnProperty(o)&&(n[o]=!0);return n}const Iv=Nl("area,br,col,hr,img,wbr"),Jp=Nl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Tx=Nl("rp,rt"),Um=Vm(Iv,Vm(Jp,Nl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Vm(Tx,Nl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Vm(Tx,Jp)),ef=Nl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Ix=Vm(ef,Nl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Nl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),lS=Nl("script,style,template");class cS{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,o=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?o=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,o&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!Um.hasOwnProperty(e))return this.sanitizedSomething=!0,!lS.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const o=n.attributes;for(let r=0;r<o.length;r++){const s=o.item(r),l=s.name,h=l.toLowerCase();if(!Ix.hasOwnProperty(h)){this.sanitizedSomething=!0;continue}let f=s.value;ef[h]&&(f=Qp(f)),this.buf.push(" ",l,'="',Dx(f),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();Um.hasOwnProperty(e)&&!Iv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(Dx(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const uS=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,D_=/([^\#-~ |!])/g;function Dx(t){return t.replace(/&/g,"&amp;").replace(uS,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(D_,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let jm;function Oh(t,n){let e=null;try{jm=jm||function Nm(t){const n=new wx(t);return function Cx(){try{return!!(new window.DOMParser).parseFromString(ha(""),"text/html")}catch{return!1}}()?new zm(n):n}(t);let o=n?String(n):"";e=jm.getInertBodyElement(o);let r=5,s=o;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,o=s,s=e.innerHTML,e=jm.getInertBodyElement(o)}while(o!==s);return ha((new cS).sanitizeChildren(Dv(e)||e))}finally{if(e){const o=Dv(e)||e;for(;o.firstChild;)o.removeChild(o.firstChild)}}}function Dv(t){return"content"in t&&function dS(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var To=(()=>((To=To||{})[To.NONE=0]="NONE",To[To.HTML=1]="HTML",To[To.STYLE=2]="STYLE",To[To.SCRIPT=3]="SCRIPT",To[To.URL=4]="URL",To[To.RESOURCE_URL=5]="RESOURCE_URL",To))();function Lh(t){const n=ru();return n?md(n.sanitize(To.HTML,t)||""):uc(t,"HTML")?md(Ks(t)):Oh(function kh(){return void 0!==Ev?Ev:typeof document<"u"?document:void 0}(),hi(t))}function Ui(t){const n=ru();return n?n.sanitize(To.URL,t)||"":uc(t,"URL")?Ks(t):Qp(hi(t))}function kx(t){const n=ru();if(n)return bx(n.sanitize(To.RESOURCE_URL,t)||"");if(uc(t,"ResourceURL"))return bx(Ks(t));throw new It(904,!1)}function ru(){const t=zt();return t&&t[wp]}const Hm=new cn("ENVIRONMENT_INITIALIZER"),tf=new cn("INJECTOR",-1),kv=new cn("INJECTOR_DEF_TYPES");class Px{get(n,e=Fi){if(e===Fi){const o=new Error(`NullInjectorError: No provider for ${lo(n)}!`);throw o.name="NullInjectorError",o}return e}}function Lx(...t){return{\u0275providers:Av(0,t),\u0275fromNgModule:!0}}function Av(t,...n){const e=[],o=new Set;let r;return qs(n,s=>{const l=s;P_(l,e,[],o)&&(r||(r=[]),r.push(l))}),void 0!==r&&Pv(r,e),e}function Pv(t,n){for(let e=0;e<t.length;e++){const{providers:r}=t[e];Ov(r,s=>{n.push(s)})}}function P_(t,n,e,o){if(!(t=qn(t)))return!1;let r=null,s=Tl(t);const l=!s&&no(t);if(s||l){if(l&&!l.standalone)return!1;r=t}else{const f=t.ngModule;if(s=Tl(f),!s)return!1;r=f}const h=o.has(r);if(l){if(h)return!1;if(o.add(r),l.dependencies){const f="function"==typeof l.dependencies?l.dependencies():l.dependencies;for(const y of f)P_(y,n,e,o)}}else{if(!s)return!1;{if(null!=s.imports&&!h){let y;o.add(r);try{qs(s.imports,C=>{P_(C,n,e,o)&&(y||(y=[]),y.push(C))})}finally{}void 0!==y&&Pv(y,n)}if(!h){const y=Ho(r)||(()=>new r);n.push({provide:r,useFactory:y,deps:Xi},{provide:kv,useValue:r,multi:!0},{provide:Hm,useValue:()=>Rt(r),multi:!0})}const f=s.providers;null==f||h||Ov(f,C=>{n.push(C)})}}return r!==t&&void 0!==t.providers}function Ov(t,n){for(let e of t)_o(e)&&(e=e.\u0275providers),Array.isArray(e)?Ov(e,n):n(e)}const fS=En({provide:String,useValue:En});function O_(t){return null!==t&&"object"==typeof t&&fS in t}function ur(t){return"function"==typeof t}const gd=new cn("Set Injector scope."),_d={},Rx={};let L_;function R_(){return void 0===L_&&(L_=new Px),L_}class dc{}class Fx extends dc{get destroyed(){return this._destroyed}constructor(n,e,o,r){super(),this.parent=e,this.source=o,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Fv(n,l=>this.processProvider(l)),this.records.set(tf,nf(void 0,this)),r.has("environment")&&this.records.set(dc,nf(void 0,this));const s=this.records.get(gd);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(kv.multi,Xi,Jn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();for(const n of this._onDestroyHooks)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(n){this._onDestroyHooks.push(n)}runInContext(n){this.assertNotDestroyed();const e=Sl(this),o=ks(void 0);try{return n()}finally{Sl(e),ks(o)}}get(n,e=Fi,o=Jn.Default){this.assertNotDestroyed(),o=qu(o);const r=Sl(this),s=ks(void 0);try{if(!(o&Jn.SkipSelf)){let h=this.records.get(n);if(void 0===h){const f=function Bx(t){return"function"==typeof t||"object"==typeof t&&t instanceof cn}(n)&&th(n);h=f&&this.injectableDefInScope(f)?nf(Rv(n),_d):null,this.records.set(n,h)}if(null!=h)return this.hydrate(n,h)}return(o&Jn.Self?R_():this.parent).get(n,e=o&Jn.Optional&&e===Fi?null:e)}catch(l){if("NullInjectorError"===l.name){if((l[Wu]=l[Wu]||[]).unshift(lo(n)),r)throw l;return function Kg(t,n,e,o){const r=t[Wu];throw n[rh]&&r.unshift(n[rh]),t.message=function em(t,n,e,o=null){t=t&&"\n"===t.charAt(0)&&t.charAt(1)==yp?t.slice(2):t;let r=lo(n);if(Array.isArray(n))r=n.map(lo).join(" -> ");else if("object"==typeof n){let s=[];for(let l in n)if(n.hasOwnProperty(l)){let h=n[l];s.push(l+":"+("string"==typeof h?JSON.stringify(h):lo(h)))}r=`{${s.join(", ")}}`}return`${e}${o?"("+o+")":""}[${r}]: ${t.replace(oh,"\n  ")}`}("\n"+t.message,r,e,o),t[ih]=r,t[Wu]=null,t}(l,n,"R3InjectorError",this.source)}throw l}finally{ks(s),Sl(r)}}resolveInjectorInitializers(){const n=Sl(this),e=ks(void 0);try{const o=this.get(Hm.multi,Xi,Jn.Self);for(const r of o)r()}finally{Sl(n),ks(e)}}toString(){const n=[],e=this.records;for(const o of e.keys())n.push(lo(o));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new It(205,!1)}processProvider(n){let e=ur(n=qn(n))?n:qn(n&&n.provide);const o=function gS(t){return O_(t)?nf(void 0,t.useValue):nf(Wm(t),_d)}(n);if(ur(n)||!0!==n.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=nf(void 0,_d,!0),r.factory=()=>ki(r.multi),this.records.set(e,r)),e=n,r.multi.push(n)}this.records.set(e,o)}hydrate(n,e){return e.value===_d&&(e.value=Rx,e.value=e.factory()),"object"==typeof e.value&&e.value&&function zx(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=qn(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Rv(t){const n=th(t),e=null!==n?n.factory:Ho(t);if(null!==e)return e;if(t instanceof cn)throw new It(204,!1);if(t instanceof Function)return function mS(t){const n=t.length;if(n>0)throw sl(n,"?"),new It(204,!1);const e=function Jl(t){const n=t&&(t[gs]||t[Xf]);return n?(function gp(t){if(t.hasOwnProperty("name"))return t.name;(""+t).match(/^function\s*([^\s(]+)/)}(t),n):null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new It(204,!1)}function Wm(t,n,e){let o;if(ur(t)){const r=qn(t);return Ho(r)||Rv(r)}if(O_(t))o=()=>qn(t.useValue);else if(function Lv(t){return!(!t||!t.useFactory)}(t))o=()=>t.useFactory(...ki(t.deps||[]));else if(function $m(t){return!(!t||!t.useExisting)}(t))o=()=>Rt(qn(t.useExisting));else{const r=qn(t&&(t.useClass||t.provide));if(!function Nx(t){return!!t.deps}(t))return Ho(r)||Rv(r);o=()=>new r(...ki(t.deps))}return o}function nf(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function Fv(t,n){for(const e of t)Array.isArray(e)?Fv(e,n):e&&_o(e)?Fv(e.\u0275providers,n):n(e)}class _S{}class Vx{}class bS{resolveComponentFactory(n){throw function yS(t){const n=Error(`No component factory found for ${lo(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let dr=(()=>{class t{}return t.NULL=new bS,t})();function hc(){return yd(Ar(),zt())}function yd(t,n){return new gi(qr(t,n))}let gi=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=hc,t})();function rf(t){return t instanceof gi?t.nativeElement:t}class qm{}let Jr=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function Zm(){const t=zt(),e=Ps(Ar().index,t);return($s(e)?e:t)[Mi]}(),t})(),xS=(()=>{class t{}return t.\u0275prov=tn({token:t,providedIn:"root",factory:()=>null}),t})();class Rh{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const Km=new Rh("15.2.2"),F_={},N_="ngOriginalError";function Xm(t){return t[N_]}class pc{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&Xm(n);for(;e&&Xm(e);)e=Xm(e);return e||null}}function $x(t){return t.ownerDocument.defaultView}function au(t){return t instanceof Function?t():t}function Nv(t,n,e){let o=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const s=n.length;if(r+s===o||t.charCodeAt(r+s)<=32)return r}e=r+1}}const Gx="ng-template";function ES(t,n,e){let o=0;for(;o<t.length;){let r=t[o++];if(e&&"class"===r){if(r=t[o],-1!==Nv(r.toLowerCase(),n,0))return!0}else if(1===r){for(;o<t.length&&"string"==typeof(r=t[o++]);)if(r.toLowerCase()===n)return!0;return!1}}return!1}function Wx(t){return 4===t.type&&t.value!==Gx}function zv(t,n,e){return n===(4!==t.type||e?t.value:Gx)}function Bv(t,n,e){let o=4;const r=t.attrs||[],s=function Vv(t){for(let n=0;n<t.length;n++)if(li(t[n]))return n;return t.length}(r);let l=!1;for(let h=0;h<n.length;h++){const f=n[h];if("number"!=typeof f){if(!l)if(4&o){if(o=2|1&o,""!==f&&!zv(t,f,e)||""===f&&1===n.length){if(al(o))return!1;l=!0}}else{const y=8&o?f:n[++h];if(8&o&&null!==t.attrs){if(!ES(t.attrs,y,e)){if(al(o))return!1;l=!0}continue}const D=Na(8&o?"class":f,r,Wx(t),e);if(-1===D){if(al(o))return!1;l=!0;continue}if(""!==y){let R;R=D>s?"":r[D+1].toLowerCase();const V=8&o?R:null;if(V&&-1!==Nv(V,y,0)||2&o&&y!==R){if(al(o))return!1;l=!0}}}}else{if(!l&&!al(o)&&!al(f))return!1;if(l&&al(f))continue;l=!1,o=f|1&o}}return al(o)||l}function al(t){return 0==(1&t)}function Na(t,n,e,o){if(null===n)return-1;let r=0;if(o||!e){let s=!1;for(;r<n.length;){const l=n[r];if(l===t)return r;if(3===l||6===l)s=!0;else{if(1===l||2===l){let h=n[++r];for(;"string"==typeof h;)h=n[++r];continue}if(4===l)break;if(0===l){r+=4;continue}}r+=s?1:2}return-1}return function z_(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const o=t[e];if("number"==typeof o)return-1;if(o===n)return e;e++}return-1}(n,t)}function lf(t,n,e=!1){for(let o=0;o<n.length;o++)if(Bv(t,n[o],e))return!0;return!1}function IS(t,n){e:for(let e=0;e<n.length;e++){const o=n[e];if(t.length===o.length){for(let r=0;r<t.length;r++)if(t[r]!==o[r])continue e;return!0}}return!1}function Uv(t,n){return t?":not("+n.trim()+")":n}function qx(t){let n=t[0],e=1,o=2,r="",s=!1;for(;e<t.length;){let l=t[e];if("string"==typeof l)if(2&o){const h=t[++e];r+="["+l+(h.length>0?'="'+h+'"':"")+"]"}else 8&o?r+="."+l:4&o&&(r+=" "+l);else""!==r&&!al(l)&&(n+=Uv(s,r),r=""),o=l,s=s||!al(o);e++}return""!==r&&(n+=Uv(s,r)),n}const Ti={};function F(t){jv(Ni(),zt(),re()+t,!1)}function jv(t,n,e,o){if(!o)if(3==(3&n[Di])){const s=t.preOrderCheckHooks;null!==s&&Pe(n,s,e)}else{const s=t.preOrderHooks;null!==s&&Fe(n,s,0,e)}de(e)}function Gv(t,n=null,e=null,o){const r=Wv(t,n,e,o);return r.resolveInjectorInitializers(),r}function Wv(t,n=null,e=null,o,r=new Set){const s=[e||Xi,Lx(t)];return o=o||("object"==typeof t?void 0:lo(t)),new Fx(s,n||R_(),o||null,r)}let Fs=(()=>{class t{static create(e,o){if(Array.isArray(e))return Gv({name:""},o,e,"");{const r=e.name??"";return Gv({name:r},e.parent,e.providers,r)}}}return t.THROW_IF_NOT_FOUND=Fi,t.NULL=new Px,t.\u0275prov=tn({token:t,providedIn:"any",factory:()=>Rt(tf)}),t.__NG_ELEMENT_ID__=-1,t})();function ce(t,n=Jn.Default){const e=zt();return null===e?Rt(t,n):Ls(Ar(),e,qn(t),n)}function Nh(){throw new Error("invalid")}function hf(t,n){const e=t.contentQueries;if(null!==e)for(let o=0;o<e.length;o+=2){const s=e[o+1];if(-1!==s){const l=t.data[s];d(e[o]),l.contentQueries(2,n[s],s)}}}function H_(t,n,e,o,r,s,l,h,f,y,C){const D=n.blueprint.slice();return D[nl]=r,D[Di]=76|o,(null!==C||t&&1024&t[Di])&&(D[Di]|=1024),e_(D),D[jo]=D[Ju]=t,D[Xo]=e,D[xp]=l||t&&t[xp],D[Mi]=h||t&&t[Mi],D[wp]=f||t&&t[wp]||null,D[Dl]=y||t&&t[Dl]||null,D[Wr]=s,D[ed]=function __(){return ZT++}(),D[Tp]=C,D[kr]=2==n.type?t[kr]:D,D}function pf(t,n,e,o,r){let s=t.data[n];if(null===s)s=function bd(t,n,e,o,r){const s=Np(),l=ad(),f=t.data[n]=function G_(t,n,e,o,r,s){return{type:e,index:o,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,l?s:s&&s.parent,e,n,o,r);return null===t.firstChild&&(t.firstChild=f),null!==s&&(l?null==s.child&&null!==f.parent&&(s.child=f):null===s.next&&(s.next=f,f.prev=s)),f}(t,n,e,o,r),function t_(){return ni.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=e,s.value=o,s.attrs=r;const l=function Zc(){const t=ni.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();s.injectorIndex=null===l?-1:l.injectorIndex}return Os(s,!0),s}function xd(t,n,e,o){if(0===e)return-1;const r=n.length;for(let s=0;s<e;s++)n.push(o),t.blueprint.push(o),t.data.push(null);return r}function Qv(t,n,e){T(n);try{const o=t.viewQuery;null!==o&&X_(1,o,e);const r=t.template;null!==r&&Jv(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&hf(t,n),t.staticViewQueries&&X_(2,t.viewQuery,e);const s=t.components;null!==s&&function j_(t,n){for(let e=0;e<n.length;e++)sb(t,n[e])}(n,s)}catch(o){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),o}finally{n[Di]&=-5,G()}}function og(t,n,e,o){const r=n[Di];if(128!=(128&r)){T(n);try{e_(n),function gm(t){return ni.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&Jv(t,n,e,2,o);const l=3==(3&r);if(l){const y=t.preOrderCheckHooks;null!==y&&Pe(n,y,null)}else{const y=t.preOrderHooks;null!==y&&Fe(n,y,0,null),$e(n,0)}if(function d1(t){for(let n=Oi(t);null!==n;n=Mm(n)){if(!n[$c])continue;const e=n[kl];for(let o=0;o<e.length;o++){const r=e[o];512&r[Di]||Rp(r[jo],1),r[Di]|=512}}}(n),function q_(t){for(let n=Oi(t);null!==n;n=Mm(n))for(let e=ei;e<n.length;e++){const o=n[e],r=o[Tn];vr(o)&&og(r,o,r.template,o[Xo])}}(n),null!==t.contentQueries&&hf(t,n),l){const y=t.contentCheckHooks;null!==y&&Pe(n,y)}else{const y=t.contentHooks;null!==y&&Fe(n,y,1),$e(n,1)}!function ng(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let o=0;o<e.length;o++){const r=e[o];if(r<0)de(~r);else{const s=r,l=e[++o],h=e[++o];n_(l,s),h(2,n[s])}}}finally{de(-1)}}(t,n);const h=t.components;null!==h&&function ig(t,n){for(let e=0;e<n.length;e++)h1(t,n[e])}(n,h);const f=t.viewQuery;if(null!==f&&X_(2,f,o),l){const y=t.viewCheckHooks;null!==y&&Pe(n,y)}else{const y=t.viewHooks;null!==y&&Fe(n,y,2),$e(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[Di]&=-41,512&n[Di]&&(n[Di]&=-513,Rp(n[jo],-1))}finally{G()}}}function Jv(t,n,e,o,r){const s=re(),l=2&o;try{de(-1),l&&n.length>co&&jv(t,n,co,!1),_s(l?2:0,r),e(o,r)}finally{de(s),_s(l?3:1,r)}}function eb(t,n,e){if(Gc(n)){const r=n.directiveEnd;for(let s=n.directiveStart;s<r;s++){const l=t.data[s];l.contentQueries&&l.contentQueries(1,e[s],s)}}}function $_(t,n,e){fm()&&(function HS(t,n,e,o){const r=e.directiveStart,s=e.directiveEnd;Wc(e)&&function u1(t,n,e){const o=qr(n,t),r=nb(e),s=t[xp],l=lg(t,H_(t,r,null,e.onPush?32:16,o,n,s,s.createRenderer(o,e),null,null,null));t[n.index]=l}(n,e,t.data[r+e.componentOffset]),t.firstCreatePass||Pi(e,n),Qr(o,n);const l=e.initialInputs;for(let h=r;h<s;h++){const f=t.data[h],y=Rs(n,t,h,e);Qr(y,n),null!==l&&wd(0,h-r,y,f,0,l),As(f)&&(Ps(e.index,n)[Xo]=Rs(n,t,h,e))}}(t,n,e,qr(e,n)),64==(64&e.flags)&&l1(t,n,e))}function tb(t,n,e=qr){const o=n.localNames;if(null!==o){let r=n.index+1;for(let s=0;s<o.length;s+=2){const l=o[s+1],h=-1===l?e(n,t):t[l];t[r++]=h}}}function nb(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=ib(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function ib(t,n,e,o,r,s,l,h,f,y){const C=co+o,D=C+r,R=function r1(t,n){const e=[];for(let o=0;o<n;o++)e.push(o<t?null:Ti);return e}(C,D),V="function"==typeof y?y():y;return R[Tn]={type:t,blueprint:R,template:e,queries:null,viewQuery:h,declTNode:n,data:R.slice().fill(null,C),bindingStartIndex:C,expandoStartIndex:D,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof l?l():l,firstChild:null,schemas:f,consts:V,incompleteFirstPass:!1}}function s1(t,n,e,o){const r=ab(n);null===e?r.push(o):(r.push(e),t.firstCreatePass&&pu(t).push(o,r.length-1))}function rg(t,n,e,o){for(let r in t)if(t.hasOwnProperty(r)){e=null===e?{}:e;const s=t[r];null===o?sg(e,n,r,s):o.hasOwnProperty(r)&&sg(e,n,o[r],s)}return e}function sg(t,n,e,o){t.hasOwnProperty(e)?t[e].push(n,o):t[e]=[n,o]}function Xs(t,n,e,o,r,s,l,h){const f=qr(n,e);let C,y=n.inputs;!h&&null!=y&&(C=y[o])?(cb(t,e,C,o,r),Wc(n)&&du(e,n.index)):3&n.type&&(o=function ob(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(o),r=null!=l?l(r,n.value||"",o):r,s.setProperty(f,o,r))}function du(t,n){const e=Ps(n,t);16&e[Di]||(e[Di]|=32)}function W_(t,n,e,o){if(fm()){const r=null===o?null:{"":-1},s=function $S(t,n){const e=t.directiveRegistry;let o=null,r=null;if(e)for(let s=0;s<e.length;s++){const l=e[s];if(lf(n,l.selectors,!1))if(o||(o=[]),As(l))if(null!==l.findHostDirectiveDefs){const h=[];r=r||new Map,l.findHostDirectiveDefs(l,h,r),o.unshift(...h,l),zh(t,n,h.length)}else o.unshift(l),zh(t,n,0);else r=r||new Map,l.findHostDirectiveDefs?.(l,o,r),o.push(l)}return null===o?null:[o,r]}(t,e);let l,h;null===s?l=h=null:[l,h]=s,null!==l&&ag(t,n,e,l,r,h),r&&function GS(t,n,e){if(n){const o=t.localNames=[];for(let r=0;r<n.length;r+=2){const s=e[n[r+1]];if(null==s)throw new It(-301,!1);o.push(n[r],s)}}}(e,o,r)}e.mergedAttrs=Jt(e.mergedAttrs,e.attrs)}function ag(t,n,e,o,r,s){for(let y=0;y<o.length;y++)Pr(Pi(e,n),t,o[y].type);!function c1(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,o.length);for(let y=0;y<o.length;y++){const C=o[y];C.providersResolver&&C.providersResolver(C)}let l=!1,h=!1,f=xd(t,n,o.length,null);for(let y=0;y<o.length;y++){const C=o[y];e.mergedAttrs=Jt(e.mergedAttrs,C.hostAttrs),qS(t,e,n,f,C),WS(f,C,r),null!==C.contentQueries&&(e.flags|=4),(null!==C.hostBindings||null!==C.hostAttrs||0!==C.hostVars)&&(e.flags|=64);const D=C.type.prototype;!l&&(D.ngOnChanges||D.ngOnInit||D.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),l=!0),!h&&(D.ngOnChanges||D.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),h=!0),f++}!function BS(t,n,e){const r=n.directiveEnd,s=t.data,l=n.attrs,h=[];let f=null,y=null;for(let C=n.directiveStart;C<r;C++){const D=s[C],R=e?e.get(D):null,$=R?R.outputs:null;f=rg(D.inputs,C,f,R?R.inputs:null),y=rg(D.outputs,C,y,$);const X=null===f||null===l||Wx(n)?null:fc(f,C,l);h.push(X)}null!==f&&(f.hasOwnProperty("class")&&(n.flags|=8),f.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=h,n.inputs=f,n.outputs=y}(t,e,s)}function l1(t,n,e){const o=e.directiveStart,r=e.directiveEnd,s=e.index,l=function i_(){return ni.lFrame.currentDirectiveIndex}();try{de(s);for(let h=o;h<r;h++){const f=t.data[h],y=n[h];ld(h),(null!==f.hostBindings||0!==f.hostVars||null!==f.hostAttrs)&&rb(f,y)}}finally{de(-1),ld(l)}}function rb(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function zh(t,n,e){n.componentOffset=e,(t.components||(t.components=[])).push(n.index)}function WS(t,n,e){if(e){if(n.exportAs)for(let o=0;o<n.exportAs.length;o++)e[n.exportAs[o]]=t;As(n)&&(e[""]=t)}}function qS(t,n,e,o,r){t.data[o]=r;const s=r.factory||(r.factory=Ho(r.type)),l=new Ze(s,As(r),ce);t.blueprint[o]=l,e[o]=l,function US(t,n,e,o,r){const s=r.hostBindings;if(s){let l=t.hostBindingOpCodes;null===l&&(l=t.hostBindingOpCodes=[]);const h=~n.index;(function jS(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(l)!=h&&l.push(h),l.push(e,o,s)}}(t,n,o,xd(t,e,r.hostVars,Ti),r)}function br(t,n,e,o,r,s){const l=qr(t,n);!function ll(t,n,e,o,r,s,l){if(null==s)t.removeAttribute(n,r,e);else{const h=null==l?hi(s):l(s,o||"",r);t.setAttribute(n,r,h,e)}}(n[Mi],l,s,t.value,e,o,r)}function wd(t,n,e,o,r,s){const l=s[n];if(null!==l){const h=o.setInput;for(let f=0;f<l.length;){const y=l[f++],C=l[f++],D=l[f++];null!==h?o.setInput(e,D,y,C):e[C]=D}}}function fc(t,n,e){let o=null,r=0;for(;r<e.length;){const s=e[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===o&&(o=[]);const l=t[s];for(let h=0;h<l.length;h+=2)if(l[h]===n){o.push(s,l[h+1],e[r+1]);break}}r+=2}else r+=2;else r+=4}return o}function hu(t,n,e,o){return[t,!0,!1,n,null,0,o,e,null,null]}function h1(t,n){const e=Ps(n,t);if(vr(e)){const o=e[Tn];48&e[Di]?og(o,e,o.template,e[Xo]):e[Hs]>0&&Z_(e)}}function Z_(t){for(let o=Oi(t);null!==o;o=Mm(o))for(let r=ei;r<o.length;r++){const s=o[r];if(vr(s))if(512&s[Di]){const l=s[Tn];og(l,s,l.template,s[Xo])}else s[Hs]>0&&Z_(s)}const e=t[Tn].components;if(null!==e)for(let o=0;o<e.length;o++){const r=Ps(e[o],t);vr(r)&&r[Hs]>0&&Z_(r)}}function sb(t,n){const e=Ps(n,t),o=e[Tn];(function ZS(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(o,e),Qv(o,e,e[Xo])}function lg(t,n){return t[Qu]?t[Cp][Ea]=n:t[Qu]=n,t[Cp]=n,n}function K_(t){for(;t;){t[Di]|=32;const n=Im(t);if(Xg(t)&&!n)return t;t=n}return null}function cg(t,n,e,o=!0){const r=n[xp];r.begin&&r.begin();try{og(t,n,t.template,e)}catch(l){throw o&&ug(n,l),l}finally{r.end&&r.end()}}function X_(t,n,e){d(0),n(t,e)}function ab(t){return t[tc]||(t[tc]=[])}function pu(t){return t.cleanup||(t.cleanup=[])}function lb(t,n,e){return(null===t||As(t))&&(e=function sd(t){for(;Array.isArray(t);){if("object"==typeof t[Hc])return t;t=t[nl]}return null}(e[n.index])),e[Mi]}function ug(t,n){const e=t[Dl],o=e?e.get(pc,null):null;o&&o.handleError(n)}function cb(t,n,e,o,r){for(let s=0;s<e.length;){const l=e[s++],h=e[s++],f=n[l],y=t.data[l];null!==y.setInput?y.setInput(f,r,o,h):f[h]=r}}function fa(t,n,e){const o=qc(n,t);!function da(t,n,e){t.setValue(n,e)}(t[Mi],o,e)}function ff(t,n,e){let o=e?t.styles:null,r=e?t.classes:null,s=0;if(null!==n)for(let l=0;l<n.length;l++){const h=n[l];"number"==typeof h?s=h:1==s?r=mi(r,h):2==s&&(o=mi(o,h+": "+n[++l]+";"))}e?t.styles=o:t.stylesWithoutHost=o,e?t.classes=r:t.classesWithoutHost=r}function mf(t,n,e,o,r=!1){for(;null!==e;){const s=n[e.index];if(null!==s&&o.push(yr(s)),Gs(s))for(let h=ei;h<s.length;h++){const f=s[h],y=f[Tn].firstChild;null!==y&&mf(f[Tn],f,y,o)}const l=e.type;if(8&l)mf(t,n,e.child,o);else if(32&l){const h=v_(e,n);let f;for(;f=h();)o.push(f)}else if(16&l){const h=Om(n,e);if(Array.isArray(h))o.push(...h);else{const f=Im(n[kr]);mf(f[Tn],f,h,o,!0)}}e=r?e.projectionNext:e.next}return o}class ma{get rootNodes(){const n=this._lView,e=n[Tn];return mf(e,n,e.firstChild,[])}constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Xo]}set context(n){this._lView[Xo]=n}get destroyed(){return 128==(128&this._lView[Di])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[jo];if(Gs(n)){const e=n[aa],o=e?e.indexOf(this):-1;o>-1&&(km(n,o),Rl(e,o))}this._attachedToViewContainer=!1}_v(this._lView[Tn],this._lView)}onDestroy(n){s1(this._lView[Tn],this._lView,null,n)}markForCheck(){K_(this._cdRefInjectingView||this._lView)}detach(){this._lView[Di]&=-65}reattach(){this._lView[Di]|=64}detectChanges(){cg(this._lView[Tn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new It(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Zp(t,n){Lm(t,n,n[Mi],2,null,null)}(this._lView[Tn],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new It(902,!1);this._appRef=n}}class ub extends ma{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;cg(n[Tn],n,n[Xo],!1)}checkNoChanges(){}get context(){return null}}class Y_ extends dr{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=no(n);return new gf(e,this.ngModule)}}function cl(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class p1{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,o){o=qu(o);const r=this.injector.get(n,F_,o);return r!==F_||e===F_?r:this.parentInjector.get(n,e,o)}}class gf extends Vx{get inputs(){return cl(this.componentDef.inputs)}get outputs(){return cl(this.componentDef.outputs)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function DS(t){return t.map(qx).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,o,r){let s=(r=r||this.ngModule)instanceof dc?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const l=s?new p1(n,s):n,h=l.get(qm,null);if(null===h)throw new It(407,!1);const f=l.get(xS,null),y=h.createRenderer(null,this.componentDef),C=this.componentDef.selectors[0][0]||"div",D=o?function zS(t,n,e){return t.selectRootElement(n,e===sa.ShadowDom)}(y,o,this.componentDef.encapsulation):b_(y,C,function Bh(t){const n=t.toLowerCase();return"svg"===n?dm:"math"===n?"math":null}(C)),R=this.componentDef.onPush?288:272,V=ib(0,null,null,1,0,null,null,null,null,null),$=H_(null,V,null,R,null,null,h,y,f,l,null);let X,ee;T($);try{const ue=this.componentDef;let fe,_e=null;ue.findHostDirectiveDefs?(fe=[],_e=new Map,ue.findHostDirectiveDefs(ue,fe,_e),fe.push(ue)):fe=[ue];const Be=function f1(t,n){const e=t[Tn],o=co;return t[o]=n,pf(e,o,2,"#host",null)}($,D),et=function m1(t,n,e,o,r,s,l,h){const f=r[Tn];!function YS(t,n,e,o){for(const r of t)n.mergedAttrs=Jt(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(ff(n,n.mergedAttrs,!0),null!==e&&Sv(o,e,n))}(o,t,n,l);const y=s.createRenderer(n,e),C=H_(r,nb(e),null,e.onPush?32:16,r[t.index],t,s,y,h||null,null,null);return f.firstCreatePass&&zh(f,t,o.length-1),lg(r,C),r[t.index]=C}(Be,D,ue,fe,$,h,y);ee=hm(V,co),D&&function _1(t,n,e,o){if(o)vn(t,e,["ng-version",Km.full]);else{const{attrs:r,classes:s}=function Zx(t){const n=[],e=[];let o=1,r=2;for(;o<t.length;){let s=t[o];if("string"==typeof s)2===r?""!==s&&n.push(s,t[++o]):8===r&&e.push(s);else{if(!al(r))break;r=s}o++}return{attrs:n,classes:e}}(n.selectors[0]);r&&vn(t,e,r),s&&s.length>0&&Tv(t,e,s.join(" "))}}(y,ue,D,o),void 0!==e&&function QS(t,n,e){const o=t.projection=[];for(let r=0;r<n.length;r++){const s=e[r];o.push(null!=s?Array.from(s):null)}}(ee,this.ngContentSelectors,e),X=function g1(t,n,e,o,r,s){const l=Ar(),h=r[Tn],f=qr(l,r);ag(h,r,l,e,null,o);for(let C=0;C<e.length;C++)Qr(Rs(r,h,l.directiveStart+C,l),r);l1(h,r,l),f&&Qr(f,r);const y=Rs(r,h,l.directiveStart+l.componentOffset,l);if(t[Xo]=r[Xo]=y,null!==s)for(const C of s)C(y,n);return eb(h,l,t),y}(et,ue,fe,_e,$,[hb]),Qv(V,$,null)}finally{G()}return new dg(this.componentType,X,yd(ee,$),$,ee)}}class dg extends _S{constructor(n,e,o,r,s){super(),this.location=o,this._rootLView=r,this._tNode=s,this.instance=e,this.hostView=this.changeDetectorRef=new ub(r),this.componentType=n}setInput(n,e){const o=this._tNode.inputs;let r;if(null!==o&&(r=o[n])){const s=this._rootLView;cb(s[Tn],s,r,n,e),du(s,this._tNode.index)}}get injector(){return new _h(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function hb(){const t=Ar();Le(zt()[Tn],t)}function ji(t){let n=function pb(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const o=[t];for(;n;){let r;if(As(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new It(903,!1);r=n.\u0275dir}if(r){if(e){o.push(r);const l=t;l.inputs=a(t.inputs),l.declaredInputs=a(t.declaredInputs),l.outputs=a(t.outputs);const h=r.hostBindings;h&&_(t,h);const f=r.viewQuery,y=r.contentQueries;if(f&&u(t,f),y&&p(t,y),oa(t.inputs,r.inputs),oa(t.declaredInputs,r.declaredInputs),oa(t.outputs,r.outputs),As(r)&&r.data.animation){const C=t.data;C.animation=(C.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let l=0;l<s.length;l++){const h=s[l];h&&h.ngInherit&&h(t),h===ji&&(e=!1)}}n=Object.getPrototypeOf(n)}!function c(t){let n=0,e=null;for(let o=t.length-1;o>=0;o--){const r=t[o];r.hostVars=n+=r.hostVars,r.hostAttrs=Jt(r.hostAttrs,e=Jt(e,r.hostAttrs))}}(o)}function a(t){return t===Il?{}:t===Xi?[]:t}function u(t,n){const e=t.viewQuery;t.viewQuery=e?(o,r)=>{n(o,r),e(o,r)}:n}function p(t,n){const e=t.contentQueries;t.contentQueries=e?(o,r,s)=>{n(o,r,s),e(o,r,s)}:n}function _(t,n){const e=t.hostBindings;t.hostBindings=e?(o,r)=>{n(o,r),e(o,r)}:n}function te(t){return!!ke(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function ke(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Se(t,n,e){return t[n]=e}function Oe(t,n){return t[n]}function De(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function tt(t,n,e,o){const r=De(t,n,e);return De(t,n+1,o)||r}function Qe(t,n,e,o,r){const s=tt(t,n,e,o);return De(t,n+2,r)||s}function mt(t,n,e,o,r,s){const l=tt(t,n,e,o);return tt(t,n+2,r,s)||l}function at(t,n,e,o){const r=zt();return De(r,Kc(),n)&&(Ni(),br(le(),r,t,n,e,o)),at}function bt(t,n,e,o){return De(t,Kc(),e)?n+hi(e)+o:Ti}function W(t,n,e,o,r,s,l,h){const f=zt(),y=Ni(),C=t+co,D=y.firstCreatePass?function vo(t,n,e,o,r,s,l,h,f){const y=n.consts,C=pf(n,t,4,l||null,Al(y,h));W_(n,e,C,Al(y,f)),Le(n,C);const D=C.tView=ib(2,C,o,r,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,y);return null!==n.queries&&(n.queries.template(n,C),D.queries=n.queries.embeddedTView(C)),C}(C,y,f,n,e,o,r,s,l):y.data[C];Os(D,!1);const R=f[Mi].createComment("");w_(y,f,R,D),Qr(R,f),lg(f,f[C]=hu(R,f,R,D)),ch(D)&&$_(y,f,D),null!=l&&tb(f,D,h)}function Un(t){return nc(function zp(){return ni.lFrame.contextLView}(),co+t)}function L(t,n,e){const o=zt();return De(o,Kc(),n)&&Xs(Ni(),le(),o,t,n,o[Mi],e,!1),L}function zo(t,n,e,o,r){const l=r?"class":"style";cb(t,e,n.inputs[l],l,o)}function P(t,n,e,o){const r=zt(),s=Ni(),l=co+t,h=r[Mi],f=s.firstCreatePass?function es(t,n,e,o,r,s){const l=n.consts,f=pf(n,t,2,o,Al(l,r));return W_(n,e,f,Al(l,s)),null!==f.attrs&&ff(f,f.attrs,!1),null!==f.mergedAttrs&&ff(f,f.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,f),f}(l,s,r,n,e,o):s.data[l],y=r[l]=b_(h,n,function xe(){return ni.lFrame.currentNamespace}()),C=ch(f);return Os(f,!0),Sv(h,y,f),32!=(32&f.flags)&&w_(s,r,y,f),0===function il(){return ni.lFrame.elementDepthCount}()&&Qr(y,r),function Fp(){ni.lFrame.elementDepthCount++}(),C&&($_(s,r,f),eb(s,f,r)),null!==o&&tb(r,f),P}function N(){let t=Ar();ad()?ic():(t=t.parent,Os(t,!1));const n=t;!function dn(){ni.lFrame.elementDepthCount--}();const e=Ni();return e.firstCreatePass&&(Le(e,t),Gc(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function je(t){return 0!=(8&t.flags)}(n)&&zo(e,n,zt(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function ct(t){return 0!=(16&t.flags)}(n)&&zo(e,n,zt(),n.stylesWithoutHost,!1),N}function Ae(t,n,e,o){return P(t,n,e,o),N(),Ae}function wn(t,n,e){const o=zt(),r=Ni(),s=t+co,l=r.firstCreatePass?function Wi(t,n,e,o,r){const s=n.consts,l=Al(s,o),h=pf(n,t,8,"ng-container",l);return null!==l&&ff(h,l,!0),W_(n,e,h,Al(s,r)),null!==n.queries&&n.queries.elementStart(n,h),h}(s,r,o,n,e):r.data[s];Os(l,!0);const h=o[s]=o[Mi].createComment("");return w_(r,o,h,l),Qr(h,o),ch(l)&&($_(r,o,l),eb(r,l,o)),null!=e&&tb(o,l),wn}function Pn(){let t=Ar();const n=Ni();return ad()?ic():(t=t.parent,Os(t,!1)),n.firstCreatePass&&(Le(n,t),Gc(t)&&n.queries.elementEnd(t)),Pn}function $t(t,n,e){return wn(t,n,e),Pn(),$t}function Ye(){return zt()}function xr(t){return!!t&&"function"==typeof t.then}const wr=function Rr(t){return!!t&&"function"==typeof t.subscribe};function Te(t,n,e,o){const r=zt(),s=Ni(),l=Ar();return Vh(s,r,r[Mi],l,t,n,o),Te}function Cr(t,n){const e=Ar(),o=zt(),r=Ni();return Vh(r,o,lb(Xc(r.data),e,o),e,t,n),Cr}function Vh(t,n,e,o,r,s,l){const h=ch(o),y=t.firstCreatePass&&pu(t),C=n[Xo],D=ab(n);let R=!0;if(3&o.type||l){const X=qr(o,n),ee=l?l(X):X,ue=D.length,fe=l?Be=>l(yr(Be[o.index])):o.index;let _e=null;if(!l&&h&&(_e=function fu(t,n,e,o){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const l=r[s];if(l===e&&r[s+1]===o){const h=n[tc],f=r[s+2];return h.length>f?h[f]:null}"string"==typeof l&&(s+=2)}return null}(t,n,r,o.index)),null!==_e)(_e.__ngLastListenerFn__||_e).__ngNextListenerFn__=s,_e.__ngLastListenerFn__=s,R=!1;else{s=yf(o,n,C,s,!1);const Be=e.listen(ee,r,s);D.push(s,Be),y&&y.push(r,fe,ue,ue+1)}}else s=yf(o,n,C,s,!1);const V=o.outputs;let $;if(R&&null!==V&&($=V[r])){const X=$.length;if(X)for(let ee=0;ee<X;ee+=2){const et=n[$[ee]][$[ee+1]].subscribe(s),gt=D.length;D.push(s,et),y&&y.push(r,o.index,gt,-(gt+1))}}}function _f(t,n,e,o){try{return _s(6,n,e),!1!==e(o)}catch(r){return ug(t,r),!1}finally{_s(7,n,e)}}function yf(t,n,e,o,r){return function s(l){if(l===Function)return o;K_(t.componentOffset>-1?Ps(t.index,n):n);let f=_f(n,e,o,l),y=s.__ngNextListenerFn__;for(;y;)f=_f(n,e,y,l)&&f,y=y.__ngNextListenerFn__;return r&&!1===f&&(l.preventDefault(),l.returnValue=!1),f}}function U(t=1){return function q(t){return(ni.lFrame.contextLView=function J(t,n){for(;t>0;)n=n[Ju],t--;return n}(t,ni.lFrame.contextLView))[Xo]}(t)}function y1(t,n){let e=null;const o=function cf(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const s=n[r];if("*"!==s){if(null===o?lf(t,s,!0):IS(o,s))return r}else e=r}return e}function hr(t){const n=zt()[kr][Wr];if(!n.projection){const o=n.projection=sl(t?t.length:1,null),r=o.slice();let s=n.child;for(;null!==s;){const l=t?y1(s,t):0;null!==l&&(r[l]?r[l].projectionNext=s:o[l]=s,r[l]=s),s=s.next}}}function ro(t,n=0,e){const o=zt(),r=Ni(),s=pf(r,co+t,16,null,e||null);null===s.projection&&(s.projection=n),ic(),32!=(32&s.flags)&&function gx(t,n,e){_x(n[Mi],0,n,e,Am(t,e,n),x_(e.parent||n[Wr],e,n))}(r,o,s)}function Ai(t,n,e){return ul(t,"",n,"",e),Ai}function ul(t,n,e,o,r){const s=zt(),l=bt(s,n,e,o);return l!==Ti&&Xs(Ni(),le(),s,t,l,s[Mi],r,!1),ul}function bs(t,n){return t<<17|n<<2}function dl(t){return t>>17&32767}function gu(t){return 2|t}function hg(t){return(131068&t)>>2}function JS(t,n){return-131069&t|n<<2}function eE(t){return 1|t}function OM(t,n,e,o,r){const s=t[e+1],l=null===n;let h=o?dl(s):hg(s),f=!1;for(;0!==h&&(!1===f||l);){const C=t[h+1];w4(t[h],n)&&(f=!0,t[h+1]=o?eE(C):gu(C)),h=o?dl(C):hg(C)}f&&(t[e+1]=o?gu(s):eE(s))}function w4(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&Jc(t,n)>=0}const xs={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function LM(t){return t.substring(xs.key,xs.keyEnd)}function C4(t){return t.substring(xs.value,xs.valueEnd)}function RM(t,n){const e=xs.textEnd;return e===n?-1:(n=xs.keyEnd=function E4(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,xs.key=n,e),ty(t,n,e))}function FM(t,n){const e=xs.textEnd;let o=xs.key=ty(t,n,e);return e===o?-1:(o=xs.keyEnd=function I4(t,n,e){let o;for(;n<e&&(45===(o=t.charCodeAt(n))||95===o||(-33&o)>=65&&(-33&o)<=90||o>=48&&o<=57);)n++;return n}(t,o,e),o=zM(t,o,e),o=xs.value=ty(t,o,e),o=xs.valueEnd=function D4(t,n,e){let o=-1,r=-1,s=-1,l=n,h=l;for(;l<e;){const f=t.charCodeAt(l++);if(59===f)return h;34===f||39===f?h=l=BM(t,f,l,e):n===l-4&&85===s&&82===r&&76===o&&40===f?h=l=BM(t,41,l,e):f>32&&(h=l),s=r,r=o,o=-33&f}return h}(t,o,e),zM(t,o,e))}function NM(t){xs.key=0,xs.keyEnd=0,xs.value=0,xs.valueEnd=0,xs.textEnd=t.length}function ty(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function zM(t,n,e,o){return(n=ty(t,n,e))<e&&n++,n}function BM(t,n,e,o){let r=-1,s=e;for(;s<o;){const l=t.charCodeAt(s++);if(l==n&&92!==r)return s;r=92==l&&92===r?0:l}throw new Error}function za(t,n,e){return _u(t,n,e,!1),za}function Ro(t,n){return _u(t,n,null,!0),Ro}function Io(t){yu(jM,M4,t,!1)}function M4(t,n){for(let e=function S4(t){return NM(t),FM(t,ty(t,0,xs.textEnd))}(n);e>=0;e=FM(n,e))jM(t,LM(n),C4(n))}function Zn(t){yu(Aa,Td,t,!0)}function Td(t,n){for(let e=function T4(t){return NM(t),RM(t,ty(t,0,xs.textEnd))}(n);e>=0;e=RM(n,e))Aa(t,LM(n),!0)}function _u(t,n,e,o){const r=zt(),s=Ni(),l=Ma(2);s.firstUpdatePass&&UM(s,t,l,o),n!==Ti&&De(r,l,n)&&HM(s,s.data[re()],r,r[Mi],t,r[l+1]=function F4(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=lo(Ks(t)))),t}(n,e),o,l)}function yu(t,n,e,o){const r=Ni(),s=Ma(2);r.firstUpdatePass&&UM(r,null,s,o);const l=zt();if(e!==Ti&&De(l,s,e)){const h=r.data[re()];if(GM(h,o)&&!VM(r,s)){let f=o?h.classesWithoutHost:h.stylesWithoutHost;null!==f&&(e=mi(f,e||"")),zo(r,h,l,e,o)}else!function R4(t,n,e,o,r,s,l,h){r===Ti&&(r=Xi);let f=0,y=0,C=0<r.length?r[0]:null,D=0<s.length?s[0]:null;for(;null!==C||null!==D;){const R=f<r.length?r[f+1]:void 0,V=y<s.length?s[y+1]:void 0;let X,$=null;C===D?(f+=2,y+=2,R!==V&&($=D,X=V)):null===D||null!==C&&C<D?(f+=2,$=C):(y+=2,$=D,X=V),null!==$&&HM(t,n,e,o,$,X,l,h),C=f<r.length?r[f]:null,D=y<s.length?s[y]:null}}(r,h,l,l[Mi],l[s+1],l[s+1]=function L4(t,n,e){if(null==e||""===e)return Xi;const o=[],r=Ks(e);if(Array.isArray(r))for(let s=0;s<r.length;s++)t(o,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&t(o,s,r[s]);else"string"==typeof r&&n(o,r);return o}(t,n,e),o,s)}}function VM(t,n){return n>=t.expandoStartIndex}function UM(t,n,e,o){const r=t.data;if(null===r[e+1]){const s=r[re()],l=VM(t,e);GM(s,o)&&null===n&&!l&&(n=!1),n=function k4(t,n,e,o){const r=Xc(t);let s=o?n.residualClasses:n.residualStyles;if(null===r)0===(o?n.classBindings:n.styleBindings)&&(e=gb(e=tE(null,t,n,e,o),n.attrs,o),s=null);else{const l=n.directiveStylingLast;if(-1===l||t[l]!==r)if(e=tE(r,t,n,e,o),null===s){let f=function A4(t,n,e){const o=e?n.classBindings:n.styleBindings;if(0!==hg(o))return t[dl(o)]}(t,n,o);void 0!==f&&Array.isArray(f)&&(f=tE(null,t,n,f[1],o),f=gb(f,n.attrs,o),function P4(t,n,e,o){t[dl(e?n.classBindings:n.styleBindings)]=o}(t,n,o,f))}else s=function O4(t,n,e){let o;const r=n.directiveEnd;for(let s=1+n.directiveStylingLast;s<r;s++)o=gb(o,t[s].hostAttrs,e);return gb(o,n.attrs,e)}(t,n,o)}return void 0!==s&&(o?n.residualClasses=s:n.residualStyles=s),e}(r,s,n,o),function b4(t,n,e,o,r,s){let l=s?n.classBindings:n.styleBindings,h=dl(l),f=hg(l);t[o]=e;let C,y=!1;if(Array.isArray(e)?(C=e[1],(null===C||Jc(e,C)>0)&&(y=!0)):C=e,r)if(0!==f){const R=dl(t[h+1]);t[o+1]=bs(R,h),0!==R&&(t[R+1]=JS(t[R+1],o)),t[h+1]=function b1(t,n){return 131071&t|n<<17}(t[h+1],o)}else t[o+1]=bs(h,0),0!==h&&(t[h+1]=JS(t[h+1],o)),h=o;else t[o+1]=bs(f,0),0===h?h=o:t[f+1]=JS(t[f+1],o),f=o;y&&(t[o+1]=gu(t[o+1])),OM(t,C,o,!0),OM(t,C,o,!1),function x4(t,n,e,o,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof n&&Jc(s,n)>=0&&(e[o+1]=eE(e[o+1]))}(n,C,t,o,s),l=bs(h,f),s?n.classBindings=l:n.styleBindings=l}(r,s,n,e,l,o)}}function tE(t,n,e,o,r){let s=null;const l=e.directiveEnd;let h=e.directiveStylingLast;for(-1===h?h=e.directiveStart:h++;h<l&&(s=n[h],o=gb(o,s.hostAttrs,r),s!==t);)h++;return null!==t&&(e.directiveStylingLast=h),o}function gb(t,n,e){const o=e?1:2;let r=-1;if(null!==n)for(let s=0;s<n.length;s++){const l=n[s];"number"==typeof l?r=l:r===o&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Aa(t,l,!!e||n[++s]))}return void 0===t?null:t}function jM(t,n,e){Aa(t,n,Ks(e))}function HM(t,n,e,o,r,s,l,h){if(!(3&n.type))return;const f=t.data,y=f[h+1],C=function v4(t){return 1==(1&t)}(y)?$M(f,n,e,r,hg(y),l):void 0;x1(C)||(x1(s)||function mb(t){return 2==(2&t)}(y)&&(s=$M(f,null,e,r,h,l)),function YT(t,n,e,o,r){if(n)r?t.addClass(e,o):t.removeClass(e,o);else{let s=-1===o.indexOf("-")?void 0:Po.DashCase;null==r?t.removeStyle(e,o,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Po.Important),t.setStyle(e,o,r,s))}}(o,l,qc(re(),e),r,s))}function $M(t,n,e,o,r,s){const l=null===n;let h;for(;r>0;){const f=t[r],y=Array.isArray(f),C=y?f[1]:f,D=null===C;let R=e[r+1];R===Ti&&(R=D?Xi:void 0);let V=D?s_(R,o):C===o?R:void 0;if(y&&!x1(V)&&(V=s_(f,o)),x1(V)&&(h=V,l))return h;const $=t[r+1];r=l?dl($):hg($)}if(null!==n){let f=s?n.residualClasses:n.residualStyles;null!=f&&(h=s_(f,o))}return h}function x1(t){return void 0!==t}function GM(t,n){return 0!=(t.flags&(n?8:16))}function ie(t,n=""){const e=zt(),o=Ni(),r=t+co,s=o.firstCreatePass?pf(o,r,1,n,null):o.data[r],l=e[r]=function Fa(t,n){return t.createText(n)}(e[Mi],n);w_(o,e,l,s),Os(s,!1)}function Ut(t){return jn("",t,""),Ut}function jn(t,n,e){const o=zt(),r=bt(o,t,n,e);return r!==Ti&&fa(o,re(),r),jn}function vf(t,n,e,o,r){const s=zt(),l=function xt(t,n,e,o,r,s){const h=tt(t,ol(),e,r);return Ma(2),h?n+hi(e)+o+hi(r)+s:Ti}(s,t,n,e,o,r);return l!==Ti&&fa(s,re(),l),vf}function w1(t,n,e,o,r,s,l){const h=zt(),f=function Mt(t,n,e,o,r,s,l,h){const y=Qe(t,ol(),e,r,l);return Ma(3),y?n+hi(e)+o+hi(r)+s+hi(l)+h:Ti}(h,t,n,e,o,r,s,l);return f!==Ti&&fa(h,re(),f),w1}function nE(t,n,e){const o=zt();if(De(o,Kc(),n)){const s=Ni(),l=le();Xs(s,l,o,t,n,lb(Xc(s.data),l,o),e,!0)}return nE}const pg=void 0;var n5=["en",[["a","p"],["AM","PM"],pg],[["AM","PM"],pg,pg],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],pg,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],pg,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",pg,"{1} 'at' {0}",pg],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function t5(t){const e=Math.floor(Math.abs(t)),o=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===o?1:5}];let ny={};function Ba(t){const n=function o5(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=ck(n);if(e)return e;const o=n.split("-")[0];if(e=ck(o),e)return e;if("en"===o)return n5;throw new It(701,!1)}function ck(t){return t in ny||(ny[t]=ko.ng&&ko.ng.common&&ko.ng.common.locales&&ko.ng.common.locales[t]),ny[t]}var Dn=(()=>((Dn=Dn||{})[Dn.LocaleId=0]="LocaleId",Dn[Dn.DayPeriodsFormat=1]="DayPeriodsFormat",Dn[Dn.DayPeriodsStandalone=2]="DayPeriodsStandalone",Dn[Dn.DaysFormat=3]="DaysFormat",Dn[Dn.DaysStandalone=4]="DaysStandalone",Dn[Dn.MonthsFormat=5]="MonthsFormat",Dn[Dn.MonthsStandalone=6]="MonthsStandalone",Dn[Dn.Eras=7]="Eras",Dn[Dn.FirstDayOfWeek=8]="FirstDayOfWeek",Dn[Dn.WeekendRange=9]="WeekendRange",Dn[Dn.DateFormat=10]="DateFormat",Dn[Dn.TimeFormat=11]="TimeFormat",Dn[Dn.DateTimeFormat=12]="DateTimeFormat",Dn[Dn.NumberSymbols=13]="NumberSymbols",Dn[Dn.NumberFormats=14]="NumberFormats",Dn[Dn.CurrencyCode=15]="CurrencyCode",Dn[Dn.CurrencySymbol=16]="CurrencySymbol",Dn[Dn.CurrencyName=17]="CurrencyName",Dn[Dn.Currencies=18]="Currencies",Dn[Dn.Directionality=19]="Directionality",Dn[Dn.PluralCase=20]="PluralCase",Dn[Dn.ExtraData=21]="ExtraData",Dn))();const iy="en-US";let uk=iy;function rE(t,n,e,o,r){if(t=qn(t),Array.isArray(t))for(let s=0;s<t.length;s++)rE(t[s],n,e,o,r);else{const s=Ni(),l=zt();let h=ur(t)?t:qn(t.provide),f=Wm(t);const y=Ar(),C=1048575&y.providerIndexes,D=y.directiveStart,R=y.providerIndexes>>20;if(ur(t)||!t.multi){const V=new Ze(f,r,ce),$=aE(h,n,r?C:C+R,D);-1===$?(Pr(Pi(y,l),s,h),sE(s,t,n.length),n.push(h),y.directiveStart++,y.directiveEnd++,r&&(y.providerIndexes+=1048576),e.push(V),l.push(V)):(e[$]=V,l[$]=V)}else{const V=aE(h,n,C+R,D),$=aE(h,n,C,C+R),ee=$>=0&&e[$];if(r&&!ee||!r&&!(V>=0&&e[V])){Pr(Pi(y,l),s,h);const ue=function tV(t,n,e,o,r){const s=new Ze(t,e,ce);return s.multi=[],s.index=n,s.componentProviders=0,Rk(s,r,o&&!e),s}(r?eV:J5,e.length,r,o,f);!r&&ee&&(e[$].providerFactory=ue),sE(s,t,n.length,0),n.push(h),y.directiveStart++,y.directiveEnd++,r&&(y.providerIndexes+=1048576),e.push(ue),l.push(ue)}else sE(s,t,V>-1?V:$,Rk(e[r?$:V],f,!r&&o));!r&&o&&ee&&e[$].componentProviders++}}}function sE(t,n,e,o){const r=ur(n),s=function Gm(t){return!!t.useClass}(n);if(r||s){const f=(s?qn(n.useClass):n).prototype.ngOnDestroy;if(f){const y=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const C=y.indexOf(e);-1===C?y.push(e,[o,f]):y[C+1].push(o,f)}else y.push(e,f)}}}function Rk(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function aE(t,n,e,o){for(let r=e;r<o;r++)if(n[r]===t)return r;return-1}function J5(t,n,e,o){return lE(this.multi,[])}function eV(t,n,e,o){const r=this.multi;let s;if(this.providerFactory){const l=this.providerFactory.componentProviders,h=Rs(e,e[Tn],this.providerFactory.index,o);s=h.slice(0,l),lE(r,s);for(let f=l;f<h.length;f++)s.push(h[f])}else s=[],lE(r,s);return s}function lE(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function zi(t,n=[]){return e=>{e.providersResolver=(o,r)=>function Q5(t,n,e){const o=Ni();if(o.firstCreatePass){const r=As(t);rE(e,o.data,o.blueprint,r,!0),rE(n,o.data,o.blueprint,r,!1)}}(o,r?r(t):t,n)}}class oy{}class Fk{}class Nk extends oy{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Y_(this);const o=Gr(n);this._bootstrapComponents=au(o.bootstrap),this._r3Injector=Wv(n,e,[{provide:oy,useValue:this},{provide:dr,useValue:this.componentFactoryResolver}],lo(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class cE extends Fk{constructor(n){super(),this.moduleType=n}create(n){return new Nk(this.moduleType,n)}}class iV extends oy{constructor(n,e,o){super(),this.componentFactoryResolver=new Y_(this),this.instance=null;const r=new Fx([...n,{provide:oy,useValue:this},{provide:dr,useValue:this.componentFactoryResolver}],e||R_(),o,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function I1(t,n,e=null){return new iV(t,n,e).injector}let oV=(()=>{class t{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const o=Av(0,e.type),r=o.length>0?I1([o],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,r)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return t.\u0275prov=tn({token:t,providedIn:"environment",factory:()=>new t(Rt(dc))}),t})();function zk(t){t.getStandaloneInjector=n=>n.get(oV).getOrCreateStandaloneInjector(t)}function Kn(t,n,e){const o=Zr()+t,r=zt();return r[o]===Ti?Se(r,o,e?n.call(e):n()):Oe(r,o)}function Wt(t,n,e,o){return function Wk(t,n,e,o,r,s){const l=n+e;return De(t,l,r)?Se(t,l+1,s?o.call(s,r):o(r)):Cb(t,l+1)}(zt(),Zr(),t,n,e,o)}function Ji(t,n,e,o,r){return qk(zt(),Zr(),t,n,e,o,r)}function Va(t,n,e,o,r,s){return Zk(zt(),Zr(),t,n,e,o,r,s)}function vu(t,n,e,o,r,s,l){return function Kk(t,n,e,o,r,s,l,h,f){const y=n+e;return mt(t,y,r,s,l,h)?Se(t,y+4,f?o.call(f,r,s,l,h):o(r,s,l,h)):Cb(t,y+4)}(zt(),Zr(),t,n,e,o,r,s,l)}function wb(t,n,e,o,r,s,l,h){const f=Zr()+t,y=zt(),C=mt(y,f,e,o,r,s);return De(y,f+4,l)||C?Se(y,f+5,h?n.call(h,e,o,r,s,l):n(e,o,r,s,l)):Oe(y,f+5)}function ry(t,n,e,o,r,s,l,h,f){const y=Zr()+t,C=zt(),D=mt(C,y,e,o,r,s);return tt(C,y+4,l,h)||D?Se(C,y+6,f?n.call(f,e,o,r,s,l,h):n(e,o,r,s,l,h)):Oe(C,y+6)}function dE(t,n,e,o,r,s,l,h,f,y,C){const D=Zr()+t,R=zt(),V=mt(R,D,e,o,r,s);return mt(R,D+4,l,h,f,y)||V?Se(R,D+8,C?n.call(C,e,o,r,s,l,h,f,y):n(e,o,r,s,l,h,f,y)):Oe(R,D+8)}function hE(t,n,e,o){return function Xk(t,n,e,o,r,s){let l=n+e,h=!1;for(let f=0;f<r.length;f++)De(t,l++,r[f])&&(h=!0);return h?Se(t,l,o.apply(s,r)):Cb(t,l)}(zt(),Zr(),t,n,e,o)}function Cb(t,n){const e=t[n];return e===Ti?void 0:e}function qk(t,n,e,o,r,s,l){const h=n+e;return tt(t,h,r,s)?Se(t,h+2,l?o.call(l,r,s):o(r,s)):Cb(t,h+2)}function Zk(t,n,e,o,r,s,l,h){const f=n+e;return Qe(t,f,r,s,l)?Se(t,f+3,h?o.call(h,r,s,l):o(r,s,l)):Cb(t,f+3)}function wo(t,n){const e=Ni();let o;const r=t+co;e.firstCreatePass?(o=function pV(t,n){if(n)for(let e=n.length-1;e>=0;e--){const o=n[e];if(t===o.name)return o}}(n,e.pipeRegistry),e.data[r]=o,o.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,o.onDestroy)):o=e.data[r];const s=o.factory||(o.factory=Ho(o.type)),l=ks(ce);try{const h=io(!1),f=s();return io(h),function Eo(t,n,e,o){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=o}(e,zt(),r,f),f}finally{ks(l)}}function zl(t,n,e,o){const r=t+co,s=zt(),l=nc(s,r);return Tb(s,r)?qk(s,Zr(),n,l.transform,e,o,l):l.transform(e,o)}function Nr(t,n,e,o,r){const s=t+co,l=zt(),h=nc(l,s);return Tb(l,s)?Zk(l,Zr(),n,h.transform,e,o,r,h):h.transform(e,o,r)}function Tb(t,n){return t[Tn].data[n].pure}function pE(t){return n=>{setTimeout(t,void 0,n)}}const ht=class _V extends si{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,o){let r=n,s=e||(()=>null),l=o;if(n&&"object"==typeof n){const f=n;r=f.next?.bind(f),s=f.error?.bind(f),l=f.complete?.bind(f)}this.__isAsync&&(s=pE(s),r&&(r=pE(r)),l&&(l=pE(l)));const h=super.subscribe({next:r,error:s,complete:l});return n instanceof se&&n.add(h),h}};function yV(){return this._results[Symbol.iterator]()}class D1{get changes(){return this._changes||(this._changes=new ht)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=D1.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=yV)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const o=this;o.dirty=!1;const r=function vs(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function ym(t,n,e){if(t.length!==n.length)return!1;for(let o=0;o<t.length;o++){let r=t[o],s=n[o];if(e&&(r=e(r),s=e(s)),s!==r)return!1}return!0}(o._results,r,e))&&(o._results=r,o.length=r.length,o.last=r[this.length-1],o.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let bu=(()=>{class t{}return t.__NG_ELEMENT_ID__=xV,t})();const vV=bu,bV=class extends vV{constructor(n,e,o){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=o}createEmbeddedView(n,e){const o=this._declarationTContainer.tView,r=H_(this._declarationLView,o,n,16,null,o.declTNode,null,null,null,null,e||null);r[Uc]=this._declarationLView[this._declarationTContainer.index];const l=this._declarationLView[Ia];return null!==l&&(r[Ia]=l.createEmbeddedView(o)),Qv(o,r,n),new ma(r)}};function xV(){return M1(Ar(),zt())}function M1(t,n){return 4&t.type?new bV(n,t,yd(t,n)):null}let xu=(()=>{class t{}return t.__NG_ELEMENT_ID__=wV,t})();function wV(){return Jk(Ar(),zt())}const CV=xu,Yk=class extends CV{constructor(n,e,o){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=o}get element(){return yd(this._hostTNode,this._hostLView)}get injector(){return new _h(this._hostTNode,this._hostLView)}get parentInjector(){const n=xo(this._hostTNode,this._hostLView);if(Ci(n)){const e=Qi(n,this._hostLView),o=In(n);return new _h(e[Tn].data[o+8],e)}return new _h(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=Qk(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-ei}createEmbeddedView(n,e,o){let r,s;"number"==typeof o?r=o:null!=o&&(r=o.index,s=o.injector);const l=n.createEmbeddedView(e||{},s);return this.insert(l,r),l}createComponent(n,e,o,r,s){const l=n&&!function bh(t){return"function"==typeof t}(n);let h;if(l)h=e;else{const D=e||{};h=D.index,o=D.injector,r=D.projectableNodes,s=D.environmentInjector||D.ngModuleRef}const f=l?n:new gf(no(n)),y=o||this.parentInjector;if(!s&&null==f.ngModule){const R=(l?y:this.parentInjector).get(dc,null);R&&(s=R)}const C=f.create(y,r,void 0,s);return this.insert(C.hostView,h),C}insert(n,e){const o=n._lView,r=o[Tn];if(function Yy(t){return Gs(t[jo])}(o)){const C=this.indexOf(n);if(-1!==C)this.detach(C);else{const D=o[jo],R=new Yk(D,D[Wr],D[jo]);R.detach(R.indexOf(n))}}const s=this._adjustIndex(e),l=this._lContainer;!function hx(t,n,e,o){const r=ei+o,s=e.length;o>0&&(e[r-1][Ea]=n),o<s-ei?(n[Ea]=e[r],rl(e,ei+o,n)):(e.push(n),n[Ea]=null),n[jo]=e;const l=n[Uc];null!==l&&e!==l&&function gv(t,n){const e=t[kl];n[kr]!==n[jo][jo][kr]&&(t[$c]=!0),null===e?t[kl]=[n]:e.push(n)}(l,n);const h=n[Ia];null!==h&&h.insertView(t),n[Di]|=64}(r,o,l,s);const h=C_(s,l),f=o[Mi],y=Kp(f,l[Ml]);return null!==y&&function dx(t,n,e,o,r,s){o[nl]=r,o[Wr]=n,Lm(t,o,e,1,r,s)}(r,l[Wr],f,o,y,h),n.attachToViewContainerRef(),rl(fE(l),s,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=Qk(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),o=km(this._lContainer,e);o&&(Rl(fE(this._lContainer),e),_v(o[Tn],o))}detach(n){const e=this._adjustIndex(n,-1),o=km(this._lContainer,e);return o&&null!=Rl(fE(this._lContainer),e)?new ma(o):null}_adjustIndex(n,e=0){return n??this.length+e}};function Qk(t){return t[aa]}function fE(t){return t[aa]||(t[aa]=[])}function Jk(t,n){let e;const o=n[t.index];if(Gs(o))e=o;else{let r;if(8&t.type)r=yr(o);else{const s=n[Mi];r=s.createComment("");const l=qr(t,n);nu(s,Kp(s,l),r,function XT(t,n){return t.nextSibling(n)}(s,l),!1)}n[t.index]=e=hu(o,n,r,t),lg(n,e)}return new Yk(e,t,n)}class mE{constructor(n){this.queryList=n,this.matches=null}clone(){return new mE(this.queryList)}setDirty(){this.queryList.setDirty()}}class gE{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const o=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let s=0;s<o;s++){const l=e.getByIndex(s);r.push(this.queries[l.indexInDeclarationView].clone())}return new gE(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==oA(n,e).matches&&this.queries[e].setDirty()}}class eA{constructor(n,e,o=null){this.predicate=n,this.flags=e,this.read=o}}class _E{constructor(n=[]){this.queries=n}elementStart(n,e){for(let o=0;o<this.queries.length;o++)this.queries[o].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let o=0;o<this.length;o++){const r=null!==e?e.length:0,s=this.getByIndex(o).embeddedTView(n,r);s&&(s.indexInDeclarationView=o,null!==e?e.push(s):e=[s])}return null!==e?new _E(e):null}template(n,e){for(let o=0;o<this.queries.length;o++)this.queries[o].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class yE{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new yE(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let o=n.parent;for(;null!==o&&8&o.type&&o.index!==e;)o=o.parent;return e===(null!==o?o.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const o=this.metadata.predicate;if(Array.isArray(o))for(let r=0;r<o.length;r++){const s=o[r];this.matchTNodeWithReadOption(n,e,TV(e,s)),this.matchTNodeWithReadOption(n,e,ka(e,n,s,!1,!1))}else o===bu?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,ka(e,n,o,!1,!1))}matchTNodeWithReadOption(n,e,o){if(null!==o){const r=this.metadata.read;if(null!==r)if(r===gi||r===xu||r===bu&&4&e.type)this.addMatch(e.index,-2);else{const s=ka(e,n,r,!1,!1);null!==s&&this.addMatch(e.index,s)}else this.addMatch(e.index,o)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function TV(t,n){const e=t.localNames;if(null!==e)for(let o=0;o<e.length;o+=2)if(e[o]===n)return e[o+1];return null}function EV(t,n,e,o){return-1===e?function SV(t,n){return 11&t.type?yd(t,n):4&t.type?M1(t,n):null}(n,t):-2===e?function IV(t,n,e){return e===gi?yd(n,t):e===bu?M1(n,t):e===xu?Jk(n,t):void 0}(t,n,o):Rs(t,t[Tn],e,n)}function tA(t,n,e,o){const r=n[Ia].queries[o];if(null===r.matches){const s=t.data,l=e.matches,h=[];for(let f=0;f<l.length;f+=2){const y=l[f];h.push(y<0?null:EV(n,s[y],l[f+1],e.metadata.read))}r.matches=h}return r.matches}function vE(t,n,e,o){const r=t.queries.getByIndex(e),s=r.matches;if(null!==s){const l=tA(t,n,r,e);for(let h=0;h<s.length;h+=2){const f=s[h];if(f>0)o.push(l[h/2]);else{const y=s[h+1],C=n[-f];for(let D=ei;D<C.length;D++){const R=C[D];R[Uc]===R[jo]&&vE(R[Tn],R,y,o)}if(null!==C[kl]){const D=C[kl];for(let R=0;R<D.length;R++){const V=D[R];vE(V[Tn],V,y,o)}}}}}return o}function gn(t){const n=zt(),e=Ni(),o=v();d(o+1);const r=oA(e,o);if(t.dirty&&function Lp(t){return 4==(4&t[Di])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const s=r.crossesNgTemplate?vE(e,n,o,[]):tA(e,n,r,o);t.reset(s,rf),t.notifyOnChanges()}return!0}return!1}function pi(t,n,e){const o=Ni();o.firstCreatePass&&(iA(o,new eA(t,n,e),-1),2==(2&n)&&(o.staticViewQueries=!0)),nA(o,zt(),n)}function Bo(t,n,e,o){const r=Ni();if(r.firstCreatePass){const s=Ar();iA(r,new eA(n,e,o),s.index),function MV(t,n){const e=t.contentQueries||(t.contentQueries=[]);n!==(e.length?e[e.length-1]:-1)&&e.push(t.queries.length-1,n)}(r,t),2==(2&e)&&(r.staticContentQueries=!0)}nA(r,zt(),e)}function _n(){return function DV(t,n){return t[Ia].queries[n].queryList}(zt(),v())}function nA(t,n,e){const o=new D1(4==(4&e));s1(t,n,o,o.destroy),null===n[Ia]&&(n[Ia]=new gE),n[Ia].queries.push(new mE(o))}function iA(t,n,e){null===t.queries&&(t.queries=new _E),t.queries.track(new yE(n,e))}function oA(t,n){return t.queries.getByIndex(n)}function Ua(t,n){return M1(t,n)}function A1(...t){}const P1=new cn("Application Initializer");let O1=(()=>{class t{constructor(e){this.appInits=e,this.resolve=A1,this.reject=A1,this.initialized=!1,this.done=!1,this.donePromise=new Promise((o,r)=>{this.resolve=o,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],o=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(xr(s))e.push(s);else if(wr(s)){const l=new Promise((h,f)=>{s.subscribe({complete:h,error:f})});e.push(l)}}Promise.all(e).then(()=>{o()}).catch(r=>{this.reject(r)}),0===e.length&&o(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Rt(P1,8))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Eb=new cn("AppId",{providedIn:"root",factory:function wA(){return`${SE()}${SE()}${SE()}`}});function SE(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const CA=new cn("Platform Initializer"),L1=new cn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),ly=new cn("AnimationModuleType");let KV=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const Sd=new cn("LocaleId",{providedIn:"root",factory:()=>ai(Sd,Jn.Optional|Jn.SkipSelf)||function XV(){return typeof $localize<"u"&&$localize.locale||iy}()});class QV{constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}}let TA=(()=>{class t{compileModuleSync(e){return new cE(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const o=this.compileModuleSync(e),s=au(Gr(e).declarations).reduce((l,h)=>{const f=no(h);return f&&l.push(new gf(f)),l},[]);return new QV(o,s)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const tU=(()=>Promise.resolve(0))();function EE(t){typeof Zone>"u"?tU.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class yi{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:o=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ht(!1),this.onMicrotaskEmpty=new ht(!1),this.onStable=new ht(!1),this.onError=new ht(!1),typeof Zone>"u")throw new It(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!o&&e,r.shouldCoalesceRunChangeDetection=o,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function nU(){let t=ko.requestAnimationFrame,n=ko.cancelAnimationFrame;if(typeof Zone<"u"&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const o=n[Zone.__symbol__("OriginalDelegate")];o&&(n=o)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function rU(t){const n=()=>{!function oU(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(ko,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,DE(t),t.isCheckStableRunning=!0,IE(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),DE(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,o,r,s,l,h)=>{try{return IA(t),e.invokeTask(r,s,l,h)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&n(),DA(t)}},onInvoke:(e,o,r,s,l,h,f)=>{try{return IA(t),e.invoke(r,s,l,h,f)}finally{t.shouldCoalesceRunChangeDetection&&n(),DA(t)}},onHasTask:(e,o,r,s)=>{e.hasTask(r,s),o===r&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,DE(t),IE(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,o,r,s)=>(e.handleError(r,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!yi.isInAngularZone())throw new It(909,!1)}static assertNotInAngularZone(){if(yi.isInAngularZone())throw new It(909,!1)}run(n,e,o){return this._inner.run(n,e,o)}runTask(n,e,o,r){const s=this._inner,l=s.scheduleEventTask("NgZoneEvent: "+r,n,iU,A1,A1);try{return s.runTask(l,e,o)}finally{s.cancelTask(l)}}runGuarded(n,e,o){return this._inner.runGuarded(n,e,o)}runOutsideAngular(n){return this._outer.run(n)}}const iU={};function IE(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function DE(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function IA(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function DA(t){t._nesting--,IE(t)}class sU{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ht,this.onMicrotaskEmpty=new ht,this.onStable=new ht,this.onError=new ht}run(n,e,o){return n.apply(e,o)}runGuarded(n,e,o){return n.apply(e,o)}runOutsideAngular(n){return n()}runTask(n,e,o,r){return n.apply(e,o)}}const MA=new cn(""),R1=new cn("");let AE,ME=(()=>{class t{constructor(e,o,r){this._ngZone=e,this.registry=o,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,AE||(function aU(t){AE=t}(r),r.addToWindow(o)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{yi.assertNotInAngularZone(),EE(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())EE(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(o=>!o.updateCb||!o.updateCb(e)||(clearTimeout(o.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,o,r){let s=-1;o&&o>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(l=>l.timeoutId!==s),e(this._didWork,this.getPendingTasks())},o)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:r})}whenStable(e,o,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,o,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,o,r){return[]}}return t.\u0275fac=function(e){return new(e||t)(Rt(yi),Rt(kE),Rt(R1))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})(),kE=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,o){this._applications.set(e,o)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,o=!0){return AE?.findTestabilityInTree(this,e,o)??null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const Uh=!1;let bf=null;const kA=new cn("AllowMultipleToken"),PE=new cn("PlatformDestroyListeners"),AA=new cn("appBootstrapListener");class PA{constructor(n,e){this.name=n,this.token=e}}function LA(t,n,e=[]){const o=`Platform: ${n}`,r=new cn(o);return(s=[])=>{let l=OE();if(!l||l.injector.get(kA,!1)){const h=[...e,...s,{provide:r,useValue:!0}];t?t(h):function uU(t){if(bf&&!bf.get(kA,!1))throw new It(400,!1);bf=t;const n=t.get(FA);(function OA(t){const n=t.get(CA,null);n&&n.forEach(e=>e())})(t)}(function RA(t=[],n){return Fs.create({name:n,providers:[{provide:gd,useValue:"platform"},{provide:PE,useValue:new Set([()=>bf=null])},...t]})}(h,o))}return function hU(t){const n=OE();if(!n)throw new It(401,!1);return n}()}}function OE(){return bf?.get(FA)??null}let FA=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,o){const r=function zA(t,n){let e;return e="noop"===t?new sU:("zone.js"===t?void 0:t)||new yi(n),e}(o?.ngZone,function NA(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(o)),s=[{provide:yi,useValue:r}];return r.run(()=>{const l=Fs.create({providers:s,parent:this.injector,name:e.moduleType.name}),h=e.create(l),f=h.injector.get(pc,null);if(!f)throw new It(402,!1);return r.runOutsideAngular(()=>{const y=r.onError.subscribe({next:C=>{f.handleError(C)}});h.onDestroy(()=>{F1(this._modules,h),y.unsubscribe()})}),function BA(t,n,e){try{const o=e();return xr(o)?o.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):o}catch(o){throw n.runOutsideAngular(()=>t.handleError(o)),o}}(f,r,()=>{const y=h.injector.get(O1);return y.runInitializers(),y.donePromise.then(()=>(function dk(t){ms(t,"Expected localeId to be defined"),"string"==typeof t&&(uk=t.toLowerCase().replace(/_/g,"-"))}(h.injector.get(Sd,iy)||iy),this._moduleDoBootstrap(h),h))})})}bootstrapModule(e,o=[]){const r=VA({},o);return function lU(t,n,e){const o=new cE(e);return Promise.resolve(o)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(e){const o=e.injector.get(Ib);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>o.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new It(-403,!1);e.instance.ngDoBootstrap(o)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new It(404,!1);this._modules.slice().forEach(o=>o.destroy()),this._destroyListeners.forEach(o=>o());const e=this._injector.get(PE,null);e&&(e.forEach(o=>o()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Rt(Fs))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function VA(t,n){return Array.isArray(n)?n.reduce(VA,t):{...t,...n}}let Ib=(()=>{class t{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(e,o,r){this._zone=e,this._injector=o,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new ri(h=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{h.next(this._stable),h.complete()})}),l=new ri(h=>{let f;this._zone.runOutsideAngular(()=>{f=this._zone.onStable.subscribe(()=>{yi.assertNotInAngularZone(),EE(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,h.next(!0))})})});const y=this._zone.onUnstable.subscribe(()=>{yi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{h.next(!1)}))});return()=>{f.unsubscribe(),y.unsubscribe()}});this.isStable=Lc(s,l.pipe(Zt()))}bootstrap(e,o){const r=e instanceof Vx;if(!this._injector.get(O1).done){!r&&function Vc(t){const n=no(t)||ss(t)||$r(t);return null!==n&&n.standalone}(e);throw new It(405,Uh)}let l;l=r?e:this._injector.get(dr).resolveComponentFactory(e),this.componentTypes.push(l.componentType);const h=function cU(t){return t.isBoundToModule}(l)?void 0:this._injector.get(oy),y=l.create(Fs.NULL,[],o||l.selector,h),C=y.location.nativeElement,D=y.injector.get(MA,null);return D?.registerApplication(C),y.onDestroy(()=>{this.detachView(y.hostView),F1(this.components,y),D?.unregisterApplication(C)}),this._loadComponent(y),y}tick(){if(this._runningTick)throw new It(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const o=e;this._views.push(o),o.attachToAppRef(this)}detachView(e){const o=e;F1(this._views,o),o.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const o=this._injector.get(AA,[]);o.push(...this._bootstrapListeners),o.forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>F1(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new It(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(e){return new(e||t)(Rt(yi),Rt(dc),Rt(pc))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function F1(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let Fo=(()=>{class t{}return t.__NG_ELEMENT_ID__=fU,t})();function fU(t){return function mU(t,n,e){if(Wc(t)&&!e){const o=Ps(t.index,n);return new ma(o,o)}return 47&t.type?new ma(n[kr],n):null}(Ar(),zt(),16==(16&t))}class GA{constructor(){}supports(n){return te(n)}create(n){return new xU(n)}}const bU=(t,n)=>n;class xU{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||bU}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,o=this._removalsHead,r=0,s=null;for(;e||o;){const l=!o||e&&e.currentIndex<qA(o,r,s)?e:o,h=qA(l,r,s),f=l.currentIndex;if(l===o)r--,o=o._nextRemoved;else if(e=e._next,null==l.previousIndex)r++;else{s||(s=[]);const y=h-r,C=f-r;if(y!=C){for(let R=0;R<y;R++){const V=R<s.length?s[R]:s[R]=0,$=V+R;C<=$&&$<y&&(s[R]=V+1)}s[l.previousIndex]=C-y}}h!==f&&n(l,h,f)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!te(n))throw new It(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,s,l,e=this._itHead,o=!1;if(Array.isArray(n)){this.length=n.length;for(let h=0;h<this.length;h++)s=n[h],l=this._trackByFn(h,s),null!==e&&Object.is(e.trackById,l)?(o&&(e=this._verifyReinsertion(e,s,l,h)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,l,h),o=!0),e=e._next}else r=0,function we(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Symbol.iterator]();let o;for(;!(o=e.next()).done;)n(o.value)}}(n,h=>{l=this._trackByFn(r,h),null!==e&&Object.is(e.trackById,l)?(o&&(e=this._verifyReinsertion(e,h,l,r)),Object.is(e.item,h)||this._addIdentityChange(e,h)):(e=this._mismatch(e,h,l,r),o=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,o,r){let s;return null===n?s=this._itTail:(s=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(o,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,s,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(o,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,s,r)):n=this._addAfter(new wU(e,o),s,r),n}_verifyReinsertion(n,e,o,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(o,null);return null!==s?n=this._reinsertAfter(s,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,o){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,s=n._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(n,e,o),this._addToMoves(n,o),n}_moveAfter(n,e,o){return this._unlink(n),this._insertAfter(n,e,o),this._addToMoves(n,o),n}_addAfter(n,e,o){return this._insertAfter(n,e,o),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,o){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new WA),this._linkedRecords.put(n),n.currentIndex=o,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,o=n._next;return null===e?this._itHead=o:e._next=o,null===o?this._itTail=e:o._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new WA),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class wU{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class CU{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let o;for(o=this._head;null!==o;o=o._nextDup)if((null===e||e<=o.currentIndex)&&Object.is(o.trackById,n))return o;return null}remove(n){const e=n._prevDup,o=n._nextDup;return null===e?this._head=o:e._nextDup=o,null===o?this._tail=e:o._prevDup=e,null===this._head}}class WA{constructor(){this.map=new Map}put(n){const e=n.trackById;let o=this.map.get(e);o||(o=new CU,this.map.set(e,o)),o.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function qA(t,n,e){const o=t.previousIndex;if(null===o)return o;let r=0;return e&&o<e.length&&(r=e[o]),o+n+r}class ZA{constructor(){}supports(n){return n instanceof Map||ke(n)}create(){return new TU}}class TU{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||ke(n)))throw new It(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(o,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,o),this._appendAfter=e,e=e._next;else{const s=this._getOrCreateRecordForKey(r,o);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let o=e;null!==o;o=o._nextRemoved)o===this._mapHead&&(this._mapHead=null),this._records.delete(o.key),o._nextRemoved=o._next,o.previousValue=o.currentValue,o.currentValue=null,o._prev=null,o._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const o=n._prev;return e._next=n,e._prev=o,n._prev=e,o&&(o._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const s=r._prev,l=r._next;return s&&(s._next=l),l&&(l._prev=s),r._next=null,r._prev=null,r}const o=new SU(n);return this._records.set(n,o),o.currentValue=e,this._addToAdditions(o),o}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(o=>e(n[o],o))}}class SU{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function KA(){return new B1([new GA])}let B1=(()=>{class t{constructor(e){this.factories=e}static create(e,o){if(null!=o){const r=o.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:o=>t.create(e,o||KA()),deps:[[t,new sc,new rc]]}}find(e){const o=this.factories.find(r=>r.supports(e));if(null!=o)return o;throw new It(901,!1)}}return t.\u0275prov=tn({token:t,providedIn:"root",factory:KA}),t})();function XA(){return new Db([new ZA])}let Db=(()=>{class t{constructor(e){this.factories=e}static create(e,o){if(o){const r=o.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:o=>t.create(e,o||XA()),deps:[[t,new sc,new rc]]}}find(e){const o=this.factories.find(r=>r.supports(e));if(o)return o;throw new It(901,!1)}}return t.\u0275prov=tn({token:t,providedIn:"root",factory:XA}),t})();const DU=LA(null,"core",[]);let MU=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(Rt(Ib))},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({}),t})();function cy(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let zE=null;function jh(){return zE}class PU{}const uo=new cn("DocumentToken");let BE=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:function(){return function OU(){return Rt(YA)}()},providedIn:"platform"}),t})();const LU=new cn("Location Initialized");let YA=(()=>{class t extends BE{constructor(e){super(),this._doc=e,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return jh().getBaseHref(this._doc)}onPopState(e){const o=jh().getGlobalEventTarget(this._doc,"window");return o.addEventListener("popstate",e,!1),()=>o.removeEventListener("popstate",e)}onHashChange(e){const o=jh().getGlobalEventTarget(this._doc,"window");return o.addEventListener("hashchange",e,!1),()=>o.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,o,r){QA()?this._history.pushState(e,o,r):this._location.hash=r}replaceState(e,o,r){QA()?this._history.replaceState(e,o,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(Rt(uo))},t.\u0275prov=tn({token:t,factory:function(){return function RU(){return new YA(Rt(uo))}()},providedIn:"platform"}),t})();function QA(){return!!window.history.pushState}function VE(t,n){if(0==t.length)return n;if(0==n.length)return t;let e=0;return t.endsWith("/")&&e++,n.startsWith("/")&&e++,2==e?t+n.substring(1):1==e?t+n:t+"/"+n}function JA(t){const n=t.match(/#|\?|$/),e=n&&n.index||t.length;return t.slice(0,e-("/"===t[e-1]?1:0))+t.slice(e)}function Hh(t){return t&&"?"!==t[0]?"?"+t:t}let mg=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:function(){return ai(tP)},providedIn:"root"}),t})();const eP=new cn("appBaseHref");let tP=(()=>{class t extends mg{constructor(e,o){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=o??this._platformLocation.getBaseHrefFromDOM()??ai(uo).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return VE(this._baseHref,e)}path(e=!1){const o=this._platformLocation.pathname+Hh(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${o}${r}`:o}pushState(e,o,r,s){const l=this.prepareExternalUrl(r+Hh(s));this._platformLocation.pushState(e,o,l)}replaceState(e,o,r,s){const l=this.prepareExternalUrl(r+Hh(s));this._platformLocation.replaceState(e,o,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return t.\u0275fac=function(e){return new(e||t)(Rt(BE),Rt(eP,8))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),FU=(()=>{class t extends mg{constructor(e,o){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=o&&(this._baseHref=o)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let o=this._platformLocation.hash;return null==o&&(o="#"),o.length>0?o.substring(1):o}prepareExternalUrl(e){const o=VE(this._baseHref,e);return o.length>0?"#"+o:o}pushState(e,o,r,s){let l=this.prepareExternalUrl(r+Hh(s));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(e,o,l)}replaceState(e,o,r,s){let l=this.prepareExternalUrl(r+Hh(s));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(e,o,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return t.\u0275fac=function(e){return new(e||t)(Rt(BE),Rt(eP,8))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})(),V1=(()=>{class t{constructor(e){this._subject=new ht,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const o=this._locationStrategy.getBaseHref();this._basePath=function BU(t){if(new RegExp("^(https?:)?//").test(t)){const[,e]=t.split(/\/\/[^\/]+/);return e}return t}(JA(nP(o))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,o=""){return this.path()==this.normalize(e+Hh(o))}normalize(e){return t.stripTrailingSlash(function zU(t,n){if(!t||!n.startsWith(t))return n;const e=n.substring(t.length);return""===e||["/",";","?","#"].includes(e[0])?e:n}(this._basePath,nP(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,o="",r=null){this._locationStrategy.pushState(r,"",e,o),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Hh(o)),r)}replaceState(e,o="",r=null){this._locationStrategy.replaceState(r,"",e,o),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Hh(o)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(o=>{this._notifyUrlChangeListeners(o.url,o.state)})),()=>{const o=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(o,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",o){this._urlChangeListeners.forEach(r=>r(e,o))}subscribe(e,o,r){return this._subject.subscribe({next:e,error:o,complete:r})}}return t.normalizeQueryParams=Hh,t.joinWithSlash=VE,t.stripTrailingSlash=JA,t.\u0275fac=function(e){return new(e||t)(Rt(mg))},t.\u0275prov=tn({token:t,factory:function(){return function NU(){return new V1(Rt(mg))}()},providedIn:"root"}),t})();function nP(t){return t.replace(/\/index.html$/,"")}var ts=(()=>((ts=ts||{})[ts.Format=0]="Format",ts[ts.Standalone=1]="Standalone",ts))(),so=(()=>((so=so||{})[so.Narrow=0]="Narrow",so[so.Abbreviated=1]="Abbreviated",so[so.Wide=2]="Wide",so[so.Short=3]="Short",so))(),Tr=(()=>((Tr=Tr||{})[Tr.Short=0]="Short",Tr[Tr.Medium=1]="Medium",Tr[Tr.Long=2]="Long",Tr[Tr.Full=3]="Full",Tr))(),ci=(()=>((ci=ci||{})[ci.Decimal=0]="Decimal",ci[ci.Group=1]="Group",ci[ci.List=2]="List",ci[ci.PercentSign=3]="PercentSign",ci[ci.PlusSign=4]="PlusSign",ci[ci.MinusSign=5]="MinusSign",ci[ci.Exponential=6]="Exponential",ci[ci.SuperscriptingExponent=7]="SuperscriptingExponent",ci[ci.PerMille=8]="PerMille",ci[ci.Infinity=9]="Infinity",ci[ci.NaN=10]="NaN",ci[ci.TimeSeparator=11]="TimeSeparator",ci[ci.CurrencyDecimal=12]="CurrencyDecimal",ci[ci.CurrencyGroup=13]="CurrencyGroup",ci))();function U1(t,n){return gc(Ba(t)[Dn.DateFormat],n)}function j1(t,n){return gc(Ba(t)[Dn.TimeFormat],n)}function H1(t,n){return gc(Ba(t)[Dn.DateTimeFormat],n)}function mc(t,n){const e=Ba(t),o=e[Dn.NumberSymbols][n];if(typeof o>"u"){if(n===ci.CurrencyDecimal)return e[Dn.NumberSymbols][ci.Decimal];if(n===ci.CurrencyGroup)return e[Dn.NumberSymbols][ci.Group]}return o}function oP(t){if(!t[Dn.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[Dn.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function gc(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function jE(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const QU=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Mb={},JU=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var ws=(()=>((ws=ws||{})[ws.Short=0]="Short",ws[ws.ShortGMT=1]="ShortGMT",ws[ws.Long=2]="Long",ws[ws.Extended=3]="Extended",ws))(),vi=(()=>((vi=vi||{})[vi.FullYear=0]="FullYear",vi[vi.Month=1]="Month",vi[vi.Date=2]="Date",vi[vi.Hours=3]="Hours",vi[vi.Minutes=4]="Minutes",vi[vi.Seconds=5]="Seconds",vi[vi.FractionalSeconds=6]="FractionalSeconds",vi[vi.Day=7]="Day",vi))(),Hi=(()=>((Hi=Hi||{})[Hi.DayPeriods=0]="DayPeriods",Hi[Hi.Days=1]="Days",Hi[Hi.Months=2]="Months",Hi[Hi.Eras=3]="Eras",Hi))();function e6(t,n,e,o){let r=function u6(t){if(aP(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,s=1,l=1]=t.split("-").map(h=>+h);return $1(r,s-1,l)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let o;if(o=t.match(QU))return function d6(t){const n=new Date(0);let e=0,o=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,s=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),o=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const l=Number(t[4]||0)-e,h=Number(t[5]||0)-o,f=Number(t[6]||0),y=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return s.call(n,l,h,f,y),n}(o)}const n=new Date(t);if(!aP(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=$h(e,n)||n;let h,l=[];for(;n;){if(h=JU.exec(n),!h){l.push(n);break}{l=l.concat(h.slice(1));const C=l.pop();if(!C)break;n=C}}let f=r.getTimezoneOffset();o&&(f=sP(o,f),r=function c6(t,n,e){const o=e?-1:1,r=t.getTimezoneOffset();return function l6(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,o*(sP(n,r)-r))}(r,o,!0));let y="";return l.forEach(C=>{const D=function a6(t){if($E[t])return $E[t];let n;switch(t){case"G":case"GG":case"GGG":n=Yo(Hi.Eras,so.Abbreviated);break;case"GGGG":n=Yo(Hi.Eras,so.Wide);break;case"GGGGG":n=Yo(Hi.Eras,so.Narrow);break;case"y":n=ds(vi.FullYear,1,0,!1,!0);break;case"yy":n=ds(vi.FullYear,2,0,!0,!0);break;case"yyy":n=ds(vi.FullYear,3,0,!1,!0);break;case"yyyy":n=ds(vi.FullYear,4,0,!1,!0);break;case"Y":n=Z1(1);break;case"YY":n=Z1(2,!0);break;case"YYY":n=Z1(3);break;case"YYYY":n=Z1(4);break;case"M":case"L":n=ds(vi.Month,1,1);break;case"MM":case"LL":n=ds(vi.Month,2,1);break;case"MMM":n=Yo(Hi.Months,so.Abbreviated);break;case"MMMM":n=Yo(Hi.Months,so.Wide);break;case"MMMMM":n=Yo(Hi.Months,so.Narrow);break;case"LLL":n=Yo(Hi.Months,so.Abbreviated,ts.Standalone);break;case"LLLL":n=Yo(Hi.Months,so.Wide,ts.Standalone);break;case"LLLLL":n=Yo(Hi.Months,so.Narrow,ts.Standalone);break;case"w":n=HE(1);break;case"ww":n=HE(2);break;case"W":n=HE(1,!0);break;case"d":n=ds(vi.Date,1);break;case"dd":n=ds(vi.Date,2);break;case"c":case"cc":n=ds(vi.Day,1);break;case"ccc":n=Yo(Hi.Days,so.Abbreviated,ts.Standalone);break;case"cccc":n=Yo(Hi.Days,so.Wide,ts.Standalone);break;case"ccccc":n=Yo(Hi.Days,so.Narrow,ts.Standalone);break;case"cccccc":n=Yo(Hi.Days,so.Short,ts.Standalone);break;case"E":case"EE":case"EEE":n=Yo(Hi.Days,so.Abbreviated);break;case"EEEE":n=Yo(Hi.Days,so.Wide);break;case"EEEEE":n=Yo(Hi.Days,so.Narrow);break;case"EEEEEE":n=Yo(Hi.Days,so.Short);break;case"a":case"aa":case"aaa":n=Yo(Hi.DayPeriods,so.Abbreviated);break;case"aaaa":n=Yo(Hi.DayPeriods,so.Wide);break;case"aaaaa":n=Yo(Hi.DayPeriods,so.Narrow);break;case"b":case"bb":case"bbb":n=Yo(Hi.DayPeriods,so.Abbreviated,ts.Standalone,!0);break;case"bbbb":n=Yo(Hi.DayPeriods,so.Wide,ts.Standalone,!0);break;case"bbbbb":n=Yo(Hi.DayPeriods,so.Narrow,ts.Standalone,!0);break;case"B":case"BB":case"BBB":n=Yo(Hi.DayPeriods,so.Abbreviated,ts.Format,!0);break;case"BBBB":n=Yo(Hi.DayPeriods,so.Wide,ts.Format,!0);break;case"BBBBB":n=Yo(Hi.DayPeriods,so.Narrow,ts.Format,!0);break;case"h":n=ds(vi.Hours,1,-12);break;case"hh":n=ds(vi.Hours,2,-12);break;case"H":n=ds(vi.Hours,1);break;case"HH":n=ds(vi.Hours,2);break;case"m":n=ds(vi.Minutes,1);break;case"mm":n=ds(vi.Minutes,2);break;case"s":n=ds(vi.Seconds,1);break;case"ss":n=ds(vi.Seconds,2);break;case"S":n=ds(vi.FractionalSeconds,1);break;case"SS":n=ds(vi.FractionalSeconds,2);break;case"SSS":n=ds(vi.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=W1(ws.Short);break;case"ZZZZZ":n=W1(ws.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=W1(ws.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=W1(ws.Long);break;default:return null}return $E[t]=n,n}(C);y+=D?D(r,e,f):"''"===C?"'":C.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),y}function $1(t,n,e){const o=new Date(0);return o.setFullYear(t,n,e),o.setHours(0,0,0),o}function $h(t,n){const e=function VU(t){return Ba(t)[Dn.LocaleId]}(t);if(Mb[e]=Mb[e]||{},Mb[e][n])return Mb[e][n];let o="";switch(n){case"shortDate":o=U1(t,Tr.Short);break;case"mediumDate":o=U1(t,Tr.Medium);break;case"longDate":o=U1(t,Tr.Long);break;case"fullDate":o=U1(t,Tr.Full);break;case"shortTime":o=j1(t,Tr.Short);break;case"mediumTime":o=j1(t,Tr.Medium);break;case"longTime":o=j1(t,Tr.Long);break;case"fullTime":o=j1(t,Tr.Full);break;case"short":const r=$h(t,"shortTime"),s=$h(t,"shortDate");o=G1(H1(t,Tr.Short),[r,s]);break;case"medium":const l=$h(t,"mediumTime"),h=$h(t,"mediumDate");o=G1(H1(t,Tr.Medium),[l,h]);break;case"long":const f=$h(t,"longTime"),y=$h(t,"longDate");o=G1(H1(t,Tr.Long),[f,y]);break;case"full":const C=$h(t,"fullTime"),D=$h(t,"fullDate");o=G1(H1(t,Tr.Full),[C,D])}return o&&(Mb[e][n]=o),o}function G1(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,o){return null!=n&&o in n?n[o]:e})),t}function Cu(t,n,e="-",o,r){let s="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,s=e));let l=String(t);for(;l.length<n;)l="0"+l;return o&&(l=l.slice(l.length-n)),s+l}function ds(t,n,e=0,o=!1,r=!1){return function(s,l){let h=function n6(t,n){switch(t){case vi.FullYear:return n.getFullYear();case vi.Month:return n.getMonth();case vi.Date:return n.getDate();case vi.Hours:return n.getHours();case vi.Minutes:return n.getMinutes();case vi.Seconds:return n.getSeconds();case vi.FractionalSeconds:return n.getMilliseconds();case vi.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,s);if((e>0||h>-e)&&(h+=e),t===vi.Hours)0===h&&-12===e&&(h=12);else if(t===vi.FractionalSeconds)return function t6(t,n){return Cu(t,3).substring(0,n)}(h,n);const f=mc(l,ci.MinusSign);return Cu(h,n,f,o,r)}}function Yo(t,n,e=ts.Format,o=!1){return function(r,s){return function o6(t,n,e,o,r,s){switch(e){case Hi.Months:return function HU(t,n,e){const o=Ba(t),s=gc([o[Dn.MonthsFormat],o[Dn.MonthsStandalone]],n);return gc(s,e)}(n,r,o)[t.getMonth()];case Hi.Days:return function jU(t,n,e){const o=Ba(t),s=gc([o[Dn.DaysFormat],o[Dn.DaysStandalone]],n);return gc(s,e)}(n,r,o)[t.getDay()];case Hi.DayPeriods:const l=t.getHours(),h=t.getMinutes();if(s){const y=function qU(t){const n=Ba(t);return oP(n),(n[Dn.ExtraData][2]||[]).map(o=>"string"==typeof o?jE(o):[jE(o[0]),jE(o[1])])}(n),C=function ZU(t,n,e){const o=Ba(t);oP(o);const s=gc([o[Dn.ExtraData][0],o[Dn.ExtraData][1]],n)||[];return gc(s,e)||[]}(n,r,o),D=y.findIndex(R=>{if(Array.isArray(R)){const[V,$]=R,X=l>=V.hours&&h>=V.minutes,ee=l<$.hours||l===$.hours&&h<$.minutes;if(V.hours<$.hours){if(X&&ee)return!0}else if(X||ee)return!0}else if(R.hours===l&&R.minutes===h)return!0;return!1});if(-1!==D)return C[D]}return function UU(t,n,e){const o=Ba(t),s=gc([o[Dn.DayPeriodsFormat],o[Dn.DayPeriodsStandalone]],n);return gc(s,e)}(n,r,o)[l<12?0:1];case Hi.Eras:return function $U(t,n){return gc(Ba(t)[Dn.Eras],n)}(n,o)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,s,t,n,e,o)}}function W1(t){return function(n,e,o){const r=-1*o,s=mc(e,ci.MinusSign),l=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case ws.Short:return(r>=0?"+":"")+Cu(l,2,s)+Cu(Math.abs(r%60),2,s);case ws.ShortGMT:return"GMT"+(r>=0?"+":"")+Cu(l,1,s);case ws.Long:return"GMT"+(r>=0?"+":"")+Cu(l,2,s)+":"+Cu(Math.abs(r%60),2,s);case ws.Extended:return 0===o?"Z":(r>=0?"+":"")+Cu(l,2,s)+":"+Cu(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${t}"`)}}}const r6=0,q1=4;function rP(t){return $1(t.getFullYear(),t.getMonth(),t.getDate()+(q1-t.getDay()))}function HE(t,n=!1){return function(e,o){let r;if(n){const s=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,l=e.getDate();r=1+Math.floor((l+s)/7)}else{const s=rP(e),l=function s6(t){const n=$1(t,r6,1).getDay();return $1(t,0,1+(n<=q1?q1:q1+7)-n)}(s.getFullYear()),h=s.getTime()-l.getTime();r=1+Math.round(h/6048e5)}return Cu(r,t,mc(o,ci.MinusSign))}}function Z1(t,n=!1){return function(e,o){return Cu(rP(e).getFullYear(),t,mc(o,ci.MinusSign),n)}}const $E={};function sP(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function aP(t){return t instanceof Date&&!isNaN(t.valueOf())}function dP(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const o=e.indexOf("="),[r,s]=-1==o?[e,""]:[e.slice(0,o),e.slice(o+1)];if(r.trim()===n)return decodeURIComponent(s)}return null}const XE=/\s+/,hP=[];let ao=(()=>{class t{constructor(e,o,r,s){this._iterableDiffers=e,this._keyValueDiffers=o,this._ngEl=r,this._renderer=s,this.initialClasses=hP,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(XE):hP}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(XE):e}ngDoCheck(){for(const o of this.initialClasses)this._updateState(o,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const o of e)this._updateState(o,!0);else if(null!=e)for(const o of Object.keys(e))this._updateState(o,Boolean(e[o]));this._applyStateDiff()}_updateState(e,o){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==o&&(r.changed=!0,r.enabled=o),r.touched=!0):this.stateMap.set(e,{enabled:o,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const o=e[0],r=e[1];r.changed?(this._toggleClass(o,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(o,!1),this.stateMap.delete(o)),r.touched=!1}}_toggleClass(e,o){(e=e.trim()).length>0&&e.split(XE).forEach(r=>{o?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(ce(B1),ce(Db),ce(gi),ce(Jr))},t.\u0275dir=On({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),t})();class T6{constructor(n,e,o,r){this.$implicit=n,this.ngForOf=e,this.index=o,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ns=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,o,r){this._viewContainer=e,this._template=o,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const o=this._viewContainer;e.forEachOperation((r,s,l)=>{if(null==r.previousIndex)o.createEmbeddedView(this._template,new T6(r.item,this._ngForOf,-1,-1),null===l?void 0:l);else if(null==l)o.remove(null===s?void 0:s);else if(null!==s){const h=o.get(s);o.move(h,l),mP(h,r)}});for(let r=0,s=o.length;r<s;r++){const h=o.get(r).context;h.index=r,h.count=s,h.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{mP(o.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,o){return!0}}return t.\u0275fac=function(e){return new(e||t)(ce(xu),ce(bu),ce(B1))},t.\u0275dir=On({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function mP(t,n){t.context.$implicit=n.item}let Xn=(()=>{class t{constructor(e,o){this._viewContainer=e,this._context=new E6,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=o}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){gP("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){gP("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,o){return!0}}return t.\u0275fac=function(e){return new(e||t)(ce(xu),ce(bu))},t.\u0275dir=On({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class E6{constructor(){this.$implicit=null,this.ngIf=null}}function gP(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${lo(n)}'.`)}let ho=(()=>{class t{constructor(e,o,r){this._ngEl=e,this._differs=o,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,o){const[r,s]=e.split("."),l=-1===r.indexOf("-")?void 0:Po.DashCase;null!=o?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${o}${s}`:o,l):this._renderer.removeStyle(this._ngEl.nativeElement,r,l)}_applyChanges(e){e.forEachRemovedItem(o=>this._setStyle(o.key,null)),e.forEachAddedItem(o=>this._setStyle(o.key,o.currentValue)),e.forEachChangedItem(o=>this._setStyle(o.key,o.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Db),ce(Jr))},t.\u0275dir=On({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),t})(),Cs=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const o=this._viewContainerRef;if(this._viewRef&&o.remove(o.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:l}=this;this._viewRef=o.createEmbeddedView(r,s,l?{injector:l}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(ce(xu))},t.\u0275dir=On({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[_r]}),t})();function Tu(t,n){return new It(2100,!1)}const V6=new cn("DATE_PIPE_DEFAULT_TIMEZONE"),U6=new cn("DATE_PIPE_DEFAULT_OPTIONS");let Ab=(()=>{class t{constructor(e,o,r){this.locale=e,this.defaultTimezone=o,this.defaultOptions=r}transform(e,o,r,s){if(null==e||""===e||e!=e)return null;try{return e6(e,o??this.defaultOptions?.dateFormat??"mediumDate",s||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(l){throw Tu()}}}return t.\u0275fac=function(e){return new(e||t)(ce(Sd,16),ce(V6,24),ce(U6,24))},t.\u0275pipe=Hr({name:"date",type:t,pure:!0,standalone:!0}),t})(),Su=(()=>{class t{transform(e,o,r){if(null==e)return null;if(!this.supports(e))throw Tu();return e.slice(o,r)}supports(e){return"string"==typeof e||Array.isArray(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=Hr({name:"slice",type:t,pure:!1,standalone:!0}),t})(),bi=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({}),t})();const vP="browser";let tj=(()=>{class t{}return t.\u0275prov=tn({token:t,providedIn:"root",factory:()=>new nj(Rt(uo),window)}),t})();class nj{constructor(n,e){this.document=n,this.window=e,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const e=function ij(t,n){const e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const o=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let r=o.currentNode;for(;r;){const s=r.shadowRoot;if(s){const l=s.getElementById(n)||s.querySelector(`[name="${n}"]`);if(l)return l}r=o.nextNode()}}return null}(this.document,n);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(n){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=n)}}scrollToElement(n){const e=n.getBoundingClientRect(),o=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(o-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const n=bP(this.window.history)||bP(Object.getPrototypeOf(this.window.history));return!(!n||!n.writable&&!n.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function bP(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class xP{}class kj extends PU{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class iI extends kj{static makeCurrent(){!function AU(t){zE||(zE=t)}(new iI)}onAndCancel(n,e,o){return n.addEventListener(e,o,!1),()=>{n.removeEventListener(e,o,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function Aj(){return Ob=Ob||document.querySelector("base"),Ob?Ob.getAttribute("href"):null}();return null==e?null:function Pj(t){Q1=Q1||document.createElement("a"),Q1.setAttribute("href",t);const n=Q1.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){Ob=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return dP(document.cookie,n)}}let Q1,Ob=null;const EP=new cn("TRANSITION_ID"),Lj=[{provide:P1,useFactory:function Oj(t,n,e){return()=>{e.get(O1).donePromise.then(()=>{const o=jh(),r=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<r.length;s++)o.remove(r[s])})}},deps:[EP,uo,Fs],multi:!0}];let Fj=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();const J1=new cn("EventManagerPlugins");let ew=(()=>{class t{constructor(e,o){this._zone=o,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,o,r){return this._findPluginFor(o).addEventListener(e,o,r)}addGlobalEventListener(e,o,r){return this._findPluginFor(o).addGlobalEventListener(e,o,r)}getZone(){return this._zone}_findPluginFor(e){const o=this._eventNameToPlugin.get(e);if(o)return o;const r=this._plugins;for(let s=0;s<r.length;s++){const l=r[s];if(l.supports(e))return this._eventNameToPlugin.set(e,l),l}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(Rt(J1),Rt(yi))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();class IP{constructor(n){this._doc=n}addGlobalEventListener(n,e,o){const r=jh().getGlobalEventTarget(this._doc,n);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,o)}}let DP=(()=>{class t{constructor(){this.usageCount=new Map}addStyles(e){for(const o of e)1===this.changeUsageCount(o,1)&&this.onStyleAdded(o)}removeStyles(e){for(const o of e)0===this.changeUsageCount(o,-1)&&this.onStyleRemoved(o)}onStyleRemoved(e){}onStyleAdded(e){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(e,o){const r=this.usageCount;let s=r.get(e)??0;return s+=o,s>0?r.set(e,s):r.delete(e),s}ngOnDestroy(){for(const e of this.getAllStyles())this.onStyleRemoved(e);this.usageCount.clear()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})(),Lb=(()=>{class t extends DP{constructor(e){super(),this.doc=e,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(e){for(const o of this.hostNodes)this.addStyleToHost(o,e)}onStyleRemoved(e){const o=this.styleRef;o.get(e)?.forEach(s=>s.remove()),o.delete(e)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const o of this.getAllStyles())this.addStyleToHost(e,o)}removeHost(e){this.hostNodes.delete(e)}addStyleToHost(e,o){const r=this.doc.createElement("style");r.textContent=o,e.appendChild(r);const s=this.styleRef.get(o);s?s.push(r):this.styleRef.set(o,[r])}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}}return t.\u0275fac=function(e){return new(e||t)(Rt(uo))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();const oI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},rI=/%COMP%/g,AP=new cn("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function PP(t,n){return n.flat(100).map(e=>e.replace(rI,t))}function OP(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let tw=(()=>{class t{constructor(e,o,r,s){this.eventManager=e,this.sharedStylesHost=o,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new sI(e)}createRenderer(e,o){if(!e||!o)return this.defaultRenderer;const r=this.getOrCreateRenderer(e,o);return r instanceof FP?r.applyToHost(e):r instanceof aI&&r.applyStyles(),r}getOrCreateRenderer(e,o){const r=this.rendererByCompId;let s=r.get(o.id);if(!s){const l=this.eventManager,h=this.sharedStylesHost,f=this.removeStylesOnCompDestory;switch(o.encapsulation){case sa.Emulated:s=new FP(l,h,o,this.appId,f);break;case sa.ShadowDom:return new Hj(l,h,e,o);default:s=new aI(l,h,o,f)}s.onDestroy=()=>r.delete(o.id),r.set(o.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Rt(ew),Rt(Lb),Rt(Eb),Rt(AP))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();class sI{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(oI[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){(RP(n)?n.content:n).appendChild(e)}insertBefore(n,e,o){n&&(RP(n)?n.content:n).insertBefore(e,o)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let o="string"==typeof n?document.querySelector(n):n;if(!o)throw new Error(`The selector "${n}" did not match any elements`);return e||(o.textContent=""),o}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,o,r){if(r){e=r+":"+e;const s=oI[r];s?n.setAttributeNS(s,e,o):n.setAttribute(e,o)}else n.setAttribute(e,o)}removeAttribute(n,e,o){if(o){const r=oI[o];r?n.removeAttributeNS(r,e):n.removeAttribute(`${o}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,o,r){r&(Po.DashCase|Po.Important)?n.style.setProperty(e,o,r&Po.Important?"important":""):n.style[e]=o}removeStyle(n,e,o){o&Po.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,o){n[e]=o}setValue(n,e){n.nodeValue=e}listen(n,e,o){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,OP(o)):this.eventManager.addEventListener(n,e,OP(o))}}function RP(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class Hj extends sI{constructor(n,e,o,r){super(n),this.sharedStylesHost=e,this.hostEl=o,this.shadowRoot=o.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=PP(r.id,r.styles);for(const l of s){const h=document.createElement("style");h.textContent=l,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,o){return super.insertBefore(this.nodeOrShadowRoot(n),e,o)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class aI extends sI{constructor(n,e,o,r,s=o.id){super(n),this.sharedStylesHost=e,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=PP(s,o.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class FP extends aI{constructor(n,e,o,r,s){const l=r+"-"+o.id;super(n,e,o,s,l),this.contentAttr=function Vj(t){return"_ngcontent-%COMP%".replace(rI,t)}(l),this.hostAttr=function Uj(t){return"_nghost-%COMP%".replace(rI,t)}(l)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const o=super.createElement(n,e);return super.setAttribute(o,this.contentAttr,""),o}}let $j=(()=>{class t extends IP{constructor(e){super(e)}supports(e){return!0}addEventListener(e,o,r){return e.addEventListener(o,r,!1),()=>this.removeEventListener(e,o,r)}removeEventListener(e,o,r){return e.removeEventListener(o,r)}}return t.\u0275fac=function(e){return new(e||t)(Rt(uo))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();const NP=["alt","control","meta","shift"],Gj={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Wj={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let qj=(()=>{class t extends IP{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,o,r){const s=t.parseEventName(o),l=t.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>jh().onAndCancel(e,s.domEventName,l))}static parseEventName(e){const o=e.toLowerCase().split("."),r=o.shift();if(0===o.length||"keydown"!==r&&"keyup"!==r)return null;const s=t._normalizeKey(o.pop());let l="",h=o.indexOf("code");if(h>-1&&(o.splice(h,1),l="code."),NP.forEach(y=>{const C=o.indexOf(y);C>-1&&(o.splice(C,1),l+=y+".")}),l+=s,0!=o.length||0===s.length)return null;const f={};return f.domEventName=r,f.fullKey=l,f}static matchEventFullKeyCode(e,o){let r=Gj[e.key]||e.key,s="";return o.indexOf("code.")>-1&&(r=e.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),NP.forEach(l=>{l!==r&&(0,Wj[l])(e)&&(s+=l+".")}),s+=r,s===o)}static eventCallback(e,o,r){return s=>{t.matchEventFullKeyCode(s,e)&&r.runGuarded(()=>o(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(Rt(uo))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();const BP=[{provide:L1,useValue:vP},{provide:CA,useValue:function Zj(){iI.makeCurrent()},multi:!0},{provide:uo,useFactory:function Xj(){return function tS(t){Ev=t}(document),document},deps:[]}],Yj=LA(DU,"browser",BP),VP=new cn(""),UP=[{provide:R1,useClass:class Rj{addToWindow(n){ko.getAngularTestability=(o,r=!0)=>{const s=n.findTestabilityInTree(o,r);if(null==s)throw new Error("Could not find testability for element.");return s},ko.getAllAngularTestabilities=()=>n.getAllTestabilities(),ko.getAllAngularRootElements=()=>n.getAllRootElements(),ko.frameworkStabilizers||(ko.frameworkStabilizers=[]),ko.frameworkStabilizers.push(o=>{const r=ko.getAllAngularTestabilities();let s=r.length,l=!1;const h=function(f){l=l||f,s--,0==s&&o(l)};r.forEach(function(f){f.whenStable(h)})})}findTestabilityInTree(n,e,o){return null==e?null:n.getTestability(e)??(o?jh().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:MA,useClass:ME,deps:[yi,kE,R1]},{provide:ME,useClass:ME,deps:[yi,kE,R1]}],jP=[{provide:gd,useValue:"root"},{provide:pc,useFactory:function Kj(){return new pc},deps:[]},{provide:J1,useClass:$j,multi:!0,deps:[uo,yi,L1]},{provide:J1,useClass:qj,multi:!0,deps:[uo]},{provide:tw,useClass:tw,deps:[ew,Lb,Eb,AP]},{provide:qm,useExisting:tw},{provide:DP,useExisting:Lb},{provide:Lb,useClass:Lb,deps:[uo]},{provide:ew,useClass:ew,deps:[J1,yi]},{provide:xP,useClass:Fj,deps:[]},[]];let HP=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:Eb,useValue:e.appId},{provide:EP,useExisting:Eb},Lj]}}}return t.\u0275fac=function(e){return new(e||t)(Rt(VP,12))},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({providers:[...jP,...UP],imports:[bi,MU]}),t})(),_c=(()=>{class t{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return t.\u0275fac=function(e){return new(e||t)(Rt(uo))},t.\u0275prov=tn({token:t,factory:function(e){let o=null;return o=e?new e:function Jj(){return new _c(Rt(uo))}(),o},providedIn:"root"}),t})();typeof window<"u"&&window;let nw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:function(e){let o=null;return o=e?new(e||t):Rt(WP),o},providedIn:"root"}),t})(),WP=(()=>{class t extends nw{constructor(e){super(),this._doc=e}sanitize(e,o){if(null==o)return null;switch(e){case To.NONE:return o;case To.HTML:return uc(o,"HTML")?Ks(o):Oh(this._doc,String(o)).toString();case To.STYLE:return uc(o,"Style")?Ks(o):o;case To.SCRIPT:if(uc(o,"Script"))return Ks(o);throw new Error("unsafe value used in a script context");case To.URL:return uc(o,"URL")?Ks(o):Qp(String(o));case To.RESOURCE_URL:if(uc(o,"ResourceURL"))return Ks(o);throw new Error(`unsafe value used in a resource URL context (see ${jr})`);default:throw new Error(`Unexpected SecurityContext ${e} (see ${jr})`)}}bypassSecurityTrustHtml(e){return function aS(t){return new nS(t)}(e)}bypassSecurityTrustStyle(e){return function or(t){return new iS(t)}(e)}bypassSecurityTrustScript(e){return function E_(t){return new oS(t)}(e)}bypassSecurityTrustUrl(e){return function xx(t){return new rS(t)}(e)}bypassSecurityTrustResourceUrl(e){return function I_(t){return new sS(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)(Rt(uo))},t.\u0275prov=tn({token:t,factory:function(e){let o=null;return o=e?new e:function oH(t){return new WP(t.get(uo))}(Rt(Fs)),o},providedIn:"root"}),t})();const{isArray:rH}=Array,{getPrototypeOf:sH,prototype:aH,keys:lH}=Object;function qP(t){if(1===t.length){const n=t[0];if(rH(n))return{args:n,keys:null};if(function cH(t){return t&&"object"==typeof t&&sH(t)===aH}(n)){const e=lH(n);return{args:e.map(o=>n[o]),keys:e}}}return{args:t,keys:null}}const{isArray:uH}=Array;function uI(t){return Vn(n=>function dH(t,n){return uH(n)?t(...n):t(n)}(t,n))}function ZP(t,n){return t.reduce((e,o,r)=>(e[o]=n[r],e),{})}function KP(...t){const n=Rn(t),{args:e,keys:o}=qP(t),r=new ri(s=>{const{length:l}=e;if(!l)return void s.complete();const h=new Array(l);let f=l,y=l;for(let C=0;C<l;C++){let D=!1;ne(e[C]).subscribe(ii(s,R=>{D||(D=!0,y--),h[C]=R},()=>f--,void 0,()=>{(!f||!D)&&(y||s.next(o?ZP(o,h):h),s.complete())}))}});return n?r.pipe(uI(n)):r}let XP=(()=>{class t{constructor(e,o){this._renderer=e,this._elementRef=o,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,o){this._renderer.setProperty(this._elementRef.nativeElement,e,o)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(ce(Jr),ce(gi))},t.\u0275dir=On({type:t}),t})(),gg=(()=>{class t extends XP{}return t.\u0275fac=function(){let n;return function(o){return(n||(n=Or(t)))(o||t)}}(),t.\u0275dir=On({type:t,features:[ji]}),t})();const zs=new cn("NgValueAccessor"),pH={provide:zs,useExisting:Ei(()=>yc),multi:!0},mH=new cn("CompositionEventMode");let yc=(()=>{class t extends XP{constructor(e,o,r){super(e,o),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function fH(){const t=jh()?jh().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(ce(Jr),ce(gi),ce(mH,8))},t.\u0275dir=On({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,o){1&e&&Te("input",function(s){return o._handleInput(s.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(s){return o._compositionEnd(s.target.value)})},features:[zi([pH]),ji]}),t})();const gH=!1;function wf(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function QP(t){return null!=t&&"number"==typeof t.length}const ga=new cn("NgValidators"),Cf=new cn("NgAsyncValidators"),_H=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class pr{static min(n){return function JP(t){return n=>{if(wf(n.value)||wf(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(n)}static max(n){return function eO(t){return n=>{if(wf(n.value)||wf(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(n)}static required(n){return function tO(t){return wf(t.value)?{required:!0}:null}(n)}static requiredTrue(n){return function nO(t){return!0===t.value?null:{required:!0}}(n)}static email(n){return function iO(t){return wf(t.value)||_H.test(t.value)?null:{email:!0}}(n)}static minLength(n){return function oO(t){return n=>wf(n.value)||!QP(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(n)}static maxLength(n){return function rO(t){return n=>QP(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(n)}static pattern(n){return function sO(t){if(!t)return iw;let n,e;return"string"==typeof t?(e="","^"!==t.charAt(0)&&(e+="^"),e+=t,"$"!==t.charAt(t.length-1)&&(e+="$"),n=new RegExp(e)):(e=t.toString(),n=t),o=>{if(wf(o.value))return null;const r=o.value;return n.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}(n)}static nullValidator(n){return null}static compose(n){return hO(n)}static composeAsync(n){return pO(n)}}function iw(t){return null}function aO(t){return null!=t}function lO(t){const n=xr(t)?er(t):t;if(gH&&!wr(n)){let e="Expected async validator to return Promise or Observable.";throw"object"==typeof t&&(e+=" Are you using a synchronous validator where an async validator is expected?"),new It(-1101,e)}return n}function cO(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function uO(t,n){return n.map(e=>e(t))}function dO(t){return t.map(n=>function yH(t){return!t.validate}(n)?n:e=>n.validate(e))}function hO(t){if(!t)return null;const n=t.filter(aO);return 0==n.length?null:function(e){return cO(uO(e,n))}}function dI(t){return null!=t?hO(dO(t)):null}function pO(t){if(!t)return null;const n=t.filter(aO);return 0==n.length?null:function(e){return KP(uO(e,n).map(lO)).pipe(Vn(cO))}}function hI(t){return null!=t?pO(dO(t)):null}function fO(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function mO(t){return t._rawValidators}function gO(t){return t._rawAsyncValidators}function pI(t){return t?Array.isArray(t)?t:[t]:[]}function ow(t,n){return Array.isArray(t)?t.includes(n):t===n}function _O(t,n){const e=pI(n);return pI(t).forEach(r=>{ow(e,r)||e.push(r)}),e}function yO(t,n){return pI(n).filter(e=>!ow(t,e))}class vO{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=dI(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=hI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Ha extends vO{get formDirective(){return null}get path(){return null}}class Tf extends vO{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class bO{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let $a=(()=>{class t extends bO{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(ce(Tf,2))},t.\u0275dir=On({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,o){2&e&&Ro("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[ji]}),t})(),Ed=(()=>{class t extends bO{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(ce(Ha,10))},t.\u0275dir=On({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,o){2&e&&Ro("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[ji]}),t})();function xO(t,n){return t?`with name: '${n}'`:`at index: ${n}`}const gI=!1,Rb="VALID",sw="INVALID",uy="PENDING",Fb="DISABLED";function _I(t){return(aw(t)?t.validators:t)||null}function yI(t,n){return(aw(n)?n.asyncValidators:t)||null}function aw(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}function wO(t,n,e){const o=t.controls;if(!(n?Object.keys(o):o).length)throw new It(1e3,gI?function wH(t){return`\n    There are no form controls registered with this ${t?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(n):"");if(!o[e])throw new It(1001,gI?function CH(t,n){return`Cannot find form control ${xO(t,n)}`}(n,e):"")}function CO(t,n,e){t._forEachChild((o,r)=>{if(void 0===e[r])throw new It(1002,gI?function TH(t,n){return`Must supply a value for form control ${xO(t,n)}`}(n,r):"")})}class lw{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===Rb}get invalid(){return this.status===sw}get pending(){return this.status==uy}get disabled(){return this.status===Fb}get enabled(){return this.status!==Fb}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(_O(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(_O(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(yO(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(yO(n,this._rawAsyncValidators))}hasValidator(n){return ow(this._rawValidators,n)}hasAsyncValidator(n){return ow(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=uy,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Fb,this.errors=null,this._forEachChild(o=>{o.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(o=>o(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Rb,this._forEachChild(o=>{o.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(o=>o(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Rb||this.status===uy)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Fb:Rb}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=uy,this._hasOwnPendingAsyncValidator=!0;const e=lO(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(o=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(o,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((o,r)=>o&&o._find(r),this)}getError(n,e){const o=e?this.get(e):this;return o&&o.errors?o.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new ht,this.statusChanges=new ht}_calculateStatus(){return this._allControlsDisabled()?Fb:this.errors?sw:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(uy)?uy:this._anyControlsHaveStatus(sw)?sw:Rb}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){aw(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function SH(t){return Array.isArray(t)?dI(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function EH(t){return Array.isArray(t)?hI(t):t||null}(this._rawAsyncValidators)}}class Qs extends lw{constructor(n,e,o){super(_I(e),yI(o,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,o={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,o={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){CO(this,!0,n),Object.keys(n).forEach(o=>{wO(this,!0,o),this.controls[o].setValue(n[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(o=>{const r=this.controls[o];r&&r.patchValue(n[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((o,r)=>{o.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,o)=>(n[o]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,o)=>!!o._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const o=this.controls[e];o&&n(o,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,o]of Object.entries(this.controls))if(this.contains(e)&&n(o))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,o,r)=>((o.enabled||this.disabled)&&(e[r]=o.value),e))}_reduceChildren(n,e){let o=n;return this._forEachChild((r,s)=>{o=e(o,r,s)}),o}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}class TO extends Qs{}const _g=new cn("CallSetDisabledState",{providedIn:"root",factory:()=>Nb}),Nb="always";function cw(t,n){return[...n.path,t]}function zb(t,n,e=Nb){vI(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function DH(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&SO(t,n)})}(t,n),function kH(t,n){const e=(o,r)=>{n.valueAccessor.writeValue(o),r&&n.viewToModelUpdate(o)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function MH(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&SO(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function IH(t,n){if(n.valueAccessor.setDisabledState){const e=o=>{n.valueAccessor.setDisabledState(o)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function uw(t,n,e=!0){const o=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(o),n.valueAccessor.registerOnTouched(o)),hw(t,n),t&&(n._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function dw(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function vI(t,n){const e=mO(t);null!==n.validator?t.setValidators(fO(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const o=gO(t);null!==n.asyncValidator?t.setAsyncValidators(fO(o,n.asyncValidator)):"function"==typeof o&&t.setAsyncValidators([o]);const r=()=>t.updateValueAndValidity();dw(n._rawValidators,r),dw(n._rawAsyncValidators,r)}function hw(t,n){let e=!1;if(null!==t){if(null!==n.validator){const r=mO(t);if(Array.isArray(r)&&r.length>0){const s=r.filter(l=>l!==n.validator);s.length!==r.length&&(e=!0,t.setValidators(s))}}if(null!==n.asyncValidator){const r=gO(t);if(Array.isArray(r)&&r.length>0){const s=r.filter(l=>l!==n.asyncValidator);s.length!==r.length&&(e=!0,t.setAsyncValidators(s))}}}const o=()=>{};return dw(n._rawValidators,o),dw(n._rawAsyncValidators,o),e}function SO(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function xI(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}function wI(t,n){if(!n)return null;let e,o,r;return Array.isArray(n),n.forEach(s=>{s.constructor===yc?e=s:function OH(t){return Object.getPrototypeOf(t.constructor)===gg}(s)?o=s:r=s}),r||o||e||null}function DO(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function MO(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const Sr=class extends lw{constructor(n=null,e,o){super(_I(e),yI(o,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),aw(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=MO(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(o=>o(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){DO(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){DO(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){MO(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},zH={provide:Tf,useExisting:Ei(()=>Id)},PO=(()=>Promise.resolve())();let Id=(()=>{class t extends Tf{constructor(e,o,r,s,l,h){super(),this._changeDetectorRef=l,this.callSetDisabledState=h,this.control=new Sr,this._registered=!1,this.update=new ht,this._parent=e,this._setValidators(o),this._setAsyncValidators(r),this.valueAccessor=wI(0,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const o=e.name.previousValue;this.formDirective.removeControl({name:o,path:this._getPath(o)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),xI(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){zb(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){PO.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const o=e.isDisabled.currentValue,r=0!==o&&cy(o);PO.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?cw(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(ce(Ha,9),ce(ga,10),ce(Cf,10),ce(zs,10),ce(Fo,8),ce(_g,8))},t.\u0275dir=On({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[zi([zH]),ji,_r]}),t})(),Dd=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=On({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})(),LO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({}),t})();const TI=new cn("NgModelWithFormControlWarning"),$H={provide:Ha,useExisting:Ei(()=>vc)};let vc=(()=>{class t extends Ha{constructor(e,o,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ht,this._setValidators(e),this._setAsyncValidators(o)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(hw(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const o=this.form.get(e.path);return zb(o,e,this.callSetDisabledState),o.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),o}getControl(e){return this.form.get(e.path)}removeControl(e){uw(e.control||null,e,!1),function LH(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,o){this.form.get(e.path).setValue(o)}onSubmit(e){return this.submitted=!0,function IO(t,n){t._syncPendingControls(),n.forEach(e=>{const o=e.control;"submit"===o.updateOn&&o._pendingChange&&(e.viewToModelUpdate(o._pendingValue),o._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const o=e.control,r=this.form.get(e.path);o!==r&&(uw(o||null,e),(t=>t instanceof Sr)(r)&&(zb(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const o=this.form.get(e.path);(function EO(t,n){vI(t,n)})(o,e),o.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const o=this.form.get(e.path);o&&function AH(t,n){return hw(t,n)}(o,e)&&o.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){vI(this.form,this),this._oldForm&&hw(this._oldForm,this)}_checkFormPresent(){}}return t.\u0275fac=function(e){return new(e||t)(ce(ga,10),ce(Cf,10),ce(_g,8))},t.\u0275dir=On({type:t,selectors:[["","formGroup",""]],hostBindings:function(e,o){1&e&&Te("submit",function(s){return o.onSubmit(s)})("reset",function(){return o.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[zi([$H]),ji,_r]}),t})();const qH={provide:Tf,useExisting:Ei(()=>Md)};let Md=(()=>{class t extends Tf{set isDisabled(e){}constructor(e,o,r,s,l){super(),this._ngModelWarningConfig=l,this._added=!1,this.update=new ht,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(o),this._setAsyncValidators(r),this.valueAccessor=wI(0,s)}ngOnChanges(e){this._added||this._setUpControl(),xI(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return cw(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return t._ngModelWarningSentOnce=!1,t.\u0275fac=function(e){return new(e||t)(ce(Ha,13),ce(ga,10),ce(Cf,10),ce(zs,10),ce(TI,8))},t.\u0275dir=On({type:t,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[zi([qH]),ji,_r]}),t})(),XO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[LO]}),t})();class YO extends lw{constructor(n,e,o){super(_I(e),yI(o,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,e={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,o={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:o.emitEvent})}removeAt(n,e={}){let o=this._adjustIndex(n);o<0&&(o=0),this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),this.controls.splice(o,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,o={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),e&&(this.controls.splice(r,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){CO(this,!1,n),n.forEach((o,r)=>{wO(this,!1,r),this.at(r).setValue(o,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(n.forEach((o,r)=>{this.at(r)&&this.at(r).patchValue(o,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((o,r)=>{o.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((e,o)=>!!o._syncPendingControls()||e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,o)=>{n(e,o)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}}function QO(t){return!!t&&(void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn)}let kI,c8=(()=>{class t{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new t;return e.useNonNullable=!0,e}group(e,o=null){const r=this._reduceControls(e);let s={};return QO(o)?s=o:null!==o&&(s.validators=o.validator,s.asyncValidators=o.asyncValidator),new Qs(r,s)}record(e,o=null){const r=this._reduceControls(e);return new TO(r,o)}control(e,o,r){let s={};return this.useNonNullable?(QO(o)?s=o:(s.validators=o,s.asyncValidators=r),new Sr(e,{...s,nonNullable:!0})):new Sr(e,o,r)}array(e,o,r){const s=e.map(l=>this._createControl(l));return new YO(s,o,r)}_reduceControls(e){const o={};return Object.keys(e).forEach(r=>{o[r]=this._createControl(e[r])}),o}_createControl(e){return e instanceof Sr||e instanceof lw?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Gh=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:_g,useValue:e.callSetDisabledState??Nb}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[XO]}),t})(),pw=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:TI,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:_g,useValue:e.callSetDisabledState??Nb}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[XO]}),t})();try{kI=typeof Intl<"u"&&Intl.v8BreakIterator}catch{kI=!1}let Vb,mw,vg,AI,bc=(()=>{class t{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function ej(t){return t===vP}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!kI)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.\u0275fac=function(e){return new(e||t)(Rt(L1))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function fw(t){return function u8(){if(null==Vb&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Vb=!0}))}finally{Vb=Vb||!1}return Vb}()?t:!!t.capture}function Ub(){if("object"!=typeof document||!document)return 0;if(null==mw){const t=document.createElement("div"),n=t.style;t.dir="rtl",n.width="1px",n.overflow="auto",n.visibility="hidden",n.pointerEvents="none",n.position="absolute";const e=document.createElement("div"),o=e.style;o.width="2px",o.height="1px",t.appendChild(e),document.body.appendChild(t),mw=0,0===t.scrollLeft&&(t.scrollLeft=1,mw=0===t.scrollLeft?1:2),t.remove()}return mw}function hy(t){return t.composedPath?t.composedPath()[0]:t.target}class xc extends si{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:o}=this;if(n)throw e;return this._throwIfClosed(),o}next(n){super.next(this._value=n)}}function Yn(...t){return er(t,qi(t))}function kd(t){return t<=0?()=>mn:Ki((n,e)=>{let o=0;n.subscribe(ii(e,r=>{++o<=t&&(e.next(r),t<=o&&e.complete())}))})}function Js(t,n){return Ki((e,o)=>{let r=0;e.subscribe(ii(o,s=>t.call(n,s,r++)&&o.next(s)))})}function eL(t){return Js((n,e)=>t<=e)}function tL(t,n=mr){return t=t??w8,Ki((e,o)=>{let r,s=!0;e.subscribe(ii(o,l=>{const h=n(l);(s||!t(r,h))&&(s=!1,r=h,o.next(l))}))})}function w8(t,n){return t===n}function wc(t){return Ki((n,e)=>{ne(t).subscribe(ii(e,()=>e.complete(),en)),!e.closed&&n.subscribe(e)})}function Eu(t){return null!=t&&"false"!=`${t}`}function nL(t,n=0){return function C8(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):n}function iL(t){return Array.isArray(t)?t:[t]}function py(t){return t instanceof gi?t.nativeElement:t}function PI(...t){const n=qi(t),e=Rn(t),{args:o,keys:r}=qP(t);if(0===o.length)return er([],n);const s=new ri(function T8(t,n,e=mr){return o=>{oL(n,()=>{const{length:r}=t,s=new Array(r);let l=r,h=r;for(let f=0;f<r;f++)oL(n,()=>{const y=er(t[f],n);let C=!1;y.subscribe(ii(o,D=>{s[f]=D,C||(C=!0,h--),h||o.next(e(s.slice()))},()=>{--l||o.complete()}))},o)},o)}}(o,n,r?l=>ZP(r,l):mr));return e?s.pipe(uI(e)):s}function oL(t,n,e){t?Ct(e,t,n):n()}function gw(...t){return function S8(){return Mn(1)}()(er(t,qi(t)))}class E8 extends se{constructor(n,e){super()}schedule(n,e=0){return this}}const _w={setInterval(t,n,...e){const{delegate:o}=_w;return o?.setInterval?o.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=_w;return(n?.clearInterval||clearInterval)(t)},delegate:void 0};class OI extends E8{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var o;if(this.closed)return this;this.state=n;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,e)),this.pending=!0,this.delay=e,this.id=null!==(o=this.id)&&void 0!==o?o:this.requestAsyncId(s,this.id,e),this}requestAsyncId(n,e,o=0){return _w.setInterval(n.flush.bind(n,this),o)}recycleAsyncId(n,e,o=0){if(null!=o&&this.delay===o&&!1===this.pending)return e;null!=e&&_w.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const o=this._execute(n,e);if(o)return o;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r,o=!1;try{this.work(n)}catch(s){o=!0,r=s||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:o}=e;this.work=this.state=this.scheduler=null,this.pending=!1,g(o,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}const rL={now:()=>(rL.delegate||Date).now(),delegate:void 0};class jb{constructor(n,e=jb.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,o){return new this.schedulerActionCtor(this,n).schedule(o,e)}}jb.now=rL.now;class LI extends jb{constructor(n,e=jb.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let o;this._active=!0;do{if(o=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,o){for(;n=e.shift();)n.unsubscribe();throw o}}}const RI=new LI(OI),I8=RI;function sL(t,n=RI){return Ki((e,o)=>{let r=null,s=null,l=null;const h=()=>{if(r){r.unsubscribe(),r=null;const y=s;s=null,o.next(y)}};function f(){const y=l+t,C=n.now();if(C<y)return r=this.schedule(void 0,y-C),void o.add(r);h()}e.subscribe(ii(o,y=>{s=y,l=n.now(),r||(r=n.schedule(f,t),o.add(r))},()=>{h(),o.complete()},void 0,()=>{s=r=null}))})}function yw(...t){const n=qi(t);return Ki((e,o)=>{(n?gw(t,e,n):gw(t,e)).subscribe(o)})}const aL=new Set;let fy,D8=(()=>{class t{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):k8}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function M8(t){if(!aL.has(t))try{fy||(fy=document.createElement("style"),fy.setAttribute("type","text/css"),document.head.appendChild(fy)),fy.sheet&&(fy.sheet.insertRule(`@media ${t} {body{ }}`,0),aL.add(t))}catch(n){console.error(n)}}(e),this._matchMedia(e)}}return t.\u0275fac=function(e){return new(e||t)(Rt(bc))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function k8(t){return{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{}}}let A8=(()=>{class t{constructor(e,o){this._mediaMatcher=e,this._zone=o,this._queries=new Map,this._destroySubject=new si}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return lL(iL(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let s=PI(lL(iL(e)).map(l=>this._registerQuery(l).observable));return s=gw(s.pipe(kd(1)),s.pipe(eL(1),sL(0))),s.pipe(Vn(l=>{const h={matches:!1,breakpoints:{}};return l.forEach(({matches:f,query:y})=>{h.matches=h.matches||f,h.breakpoints[y]=f}),h}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const o=this._mediaMatcher.matchMedia(e),s={observable:new ri(l=>{const h=f=>this._zone.run(()=>l.next(f));return o.addListener(h),()=>{o.removeListener(h)}}).pipe(yw(o),Vn(({matches:l})=>({query:e,matches:l})),wc(this._destroySubject)),mql:o};return this._queries.set(e,s),s}}return t.\u0275fac=function(e){return new(e||t)(Rt(D8),Rt(yi))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function lL(t){return t.map(n=>n.split(",")).reduce((n,e)=>n.concat(e)).map(n=>n.trim())}let dL=(()=>{class t{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function R8(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const o=function L8(t){try{return t.frameElement}catch{return null}}(function H8(t){return t.ownerDocument&&t.ownerDocument.defaultView||window}(e));if(o&&(-1===pL(o)||!this.isVisible(o)))return!1;let r=e.nodeName.toLowerCase(),s=pL(e);return e.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function U8(t){let n=t.nodeName.toLowerCase(),e="input"===n&&t.type;return"text"===e||"password"===e||"select"===n||"textarea"===n}(e))&&("audio"===r?!!e.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,o){return function j8(t){return!function N8(t){return function B8(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function F8(t){let n=t.nodeName.toLowerCase();return"input"===n||"select"===n||"button"===n||"textarea"===n}(t)||function z8(t){return function V8(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||hL(t))}(e)&&!this.isDisabled(e)&&(o?.ignoreVisibility||this.isVisible(e))}}return t.\u0275fac=function(e){return new(e||t)(Rt(bc))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function hL(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let n=t.getAttribute("tabindex");return!(!n||isNaN(parseInt(n,10)))}function pL(t){if(!hL(t))return null;const n=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(n)?-1:n}class $8{get enabled(){return this._enabled}set enabled(n){this._enabled=n,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}constructor(n,e,o,r,s=!1){this._element=n,this._checker=e,this._ngZone=o,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const n=this._startAnchor,e=this._endAnchor;n&&(n.removeEventListener("focus",this.startAnchorListener),n.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(n)))})}focusFirstTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(n)))})}focusLastTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(n)))})}_getRegionBoundary(n){const e=this._element.querySelectorAll(`[cdk-focus-region-${n}], [cdkFocusRegion${n}], [cdk-focus-${n}]`);return"start"==n?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(n){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const o=this._getFirstTabbableElement(e);return o?.focus(n),!!o}return e.focus(n),!0}return this.focusFirstTabbableElement(n)}focusFirstTabbableElement(n){const e=this._getRegionBoundary("start");return e&&e.focus(n),!!e}focusLastTabbableElement(n){const e=this._getRegionBoundary("end");return e&&e.focus(n),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let o=0;o<e.length;o++){const r=e[o].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[o]):null;if(r)return r}return null}_getLastTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let o=e.length-1;o>=0;o--){const r=e[o].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[o]):null;if(r)return r}return null}_createAnchor(){const n=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,n),n.classList.add("cdk-visually-hidden"),n.classList.add("cdk-focus-trap-anchor"),n.setAttribute("aria-hidden","true"),n}_toggleAnchorTabIndex(n,e){n?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(n){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_executeOnStable(n){this._ngZone.isStable?n():this._ngZone.onStable.pipe(kd(1)).subscribe(n)}}let G8=(()=>{class t{constructor(e,o,r){this._checker=e,this._ngZone=o,this._document=r}create(e,o=!1){return new $8(e,this._checker,this._ngZone,this._document,o)}}return t.\u0275fac=function(e){return new(e||t)(Rt(dL),Rt(yi),Rt(uo))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function fL(t){return 0===t.buttons||0===t.offsetX&&0===t.offsetY}function mL(t){const n=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}const W8=new cn("cdk-input-modality-detector-options"),q8={ignoreKeys:[18,17,224,91,16]},my=fw({passive:!0,capture:!0});let Z8=(()=>{class t{get mostRecentModality(){return this._modality.value}constructor(e,o,r,s){this._platform=e,this._mostRecentTarget=null,this._modality=new xc(null),this._lastTouchMs=0,this._onKeydown=l=>{this._options?.ignoreKeys?.some(h=>h===l.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=hy(l))},this._onMousedown=l=>{Date.now()-this._lastTouchMs<650||(this._modality.next(fL(l)?"keyboard":"mouse"),this._mostRecentTarget=hy(l))},this._onTouchstart=l=>{mL(l)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=hy(l))},this._options={...q8,...s},this.modalityDetected=this._modality.pipe(eL(1)),this.modalityChanged=this.modalityDetected.pipe(tL()),e.isBrowser&&o.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,my),r.addEventListener("mousedown",this._onMousedown,my),r.addEventListener("touchstart",this._onTouchstart,my)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,my),document.removeEventListener("mousedown",this._onMousedown,my),document.removeEventListener("touchstart",this._onTouchstart,my))}}return t.\u0275fac=function(e){return new(e||t)(Rt(bc),Rt(yi),Rt(uo),Rt(W8,8))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const X8=new cn("cdk-focus-monitor-default-options"),vw=fw({passive:!0,capture:!0});let _L=(()=>{class t{constructor(e,o,r,s,l){this._ngZone=e,this._platform=o,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new si,this._rootNodeFocusAndBlurListener=h=>{for(let y=hy(h);y;y=y.parentElement)"focus"===h.type?this._onFocus(h,y):this._onBlur(h,y)},this._document=s,this._detectionMode=l?.detectionMode||0}monitor(e,o=!1){const r=py(e);if(!this._platform.isBrowser||1!==r.nodeType)return Yn(null);const s=function p8(t){if(function h8(){if(null==AI){const t=typeof document<"u"?document.head:null;AI=!(!t||!t.createShadowRoot&&!t.attachShadow)}return AI}()){const n=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}(r)||this._getDocument(),l=this._elementInfo.get(r);if(l)return o&&(l.checkChildren=!0),l.subject;const h={checkChildren:o,subject:new si,rootNode:s};return this._elementInfo.set(r,h),this._registerGlobalListeners(h),h.subject}stopMonitoring(e){const o=py(e),r=this._elementInfo.get(o);r&&(r.subject.complete(),this._setClasses(o),this._elementInfo.delete(o),this._removeGlobalListeners(r))}focusVia(e,o,r){const s=py(e);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([h,f])=>this._originChanged(h,o,f)):(this._setOrigin(o),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((e,o)=>this.stopMonitoring(o))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,o){e.classList.toggle("cdk-focused",!!o),e.classList.toggle("cdk-touch-focused","touch"===o),e.classList.toggle("cdk-keyboard-focused","keyboard"===o),e.classList.toggle("cdk-mouse-focused","mouse"===o),e.classList.toggle("cdk-program-focused","program"===o)}_setOrigin(e,o=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&o,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,o){const r=this._elementInfo.get(o),s=hy(e);!r||!r.checkChildren&&o!==s||this._originChanged(o,this._getFocusOrigin(s),r)}_onBlur(e,o){const r=this._elementInfo.get(o);!r||r.checkChildren&&e.relatedTarget instanceof Node&&o.contains(e.relatedTarget)||(this._setClasses(o),this._emitOrigin(r,null))}_emitOrigin(e,o){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(o))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const o=e.rootNode,r=this._rootNodeFocusListenerCount.get(o)||0;r||this._ngZone.runOutsideAngular(()=>{o.addEventListener("focus",this._rootNodeFocusAndBlurListener,vw),o.addEventListener("blur",this._rootNodeFocusAndBlurListener,vw)}),this._rootNodeFocusListenerCount.set(o,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(wc(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(e){const o=e.rootNode;if(this._rootNodeFocusListenerCount.has(o)){const r=this._rootNodeFocusListenerCount.get(o);r>1?this._rootNodeFocusListenerCount.set(o,r-1):(o.removeEventListener("focus",this._rootNodeFocusAndBlurListener,vw),o.removeEventListener("blur",this._rootNodeFocusAndBlurListener,vw),this._rootNodeFocusListenerCount.delete(o))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,o,r){this._setClasses(e,o),this._emitOrigin(r,o),this._lastFocusOrigin=o}_getClosestElementsInfo(e){const o=[];return this._elementInfo.forEach((r,s)=>{(s===e||r.checkChildren&&s.contains(e))&&o.push([s,r])}),o}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:o,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!o||o===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const s=e.labels;if(s)for(let l=0;l<s.length;l++)if(s[l].contains(o))return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)(Rt(yi),Rt(bc),Rt(Z8),Rt(uo,8),Rt(X8,8))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const yL="cdk-high-contrast-black-on-white",vL="cdk-high-contrast-white-on-black",FI="cdk-high-contrast-active";let Y8=(()=>{class t{constructor(e,o){this._platform=e,this._document=o,this._breakpointSubscription=ai(A8).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const o=this._document.defaultView||window,r=o&&o.getComputedStyle?o.getComputedStyle(e):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(FI,yL,vL),this._hasCheckedHighContrastMode=!0;const o=this.getHighContrastMode();1===o?e.add(FI,yL):2===o&&e.add(FI,vL)}}}return t.\u0275fac=function(e){return new(e||t)(Rt(bc),Rt(uo))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Q8=new cn("cdk-dir-doc",{providedIn:"root",factory:function J8(){return ai(uo)}}),e$=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let bL=(()=>{class t{constructor(e){this.value="ltr",this.change=new ht,e&&(this.value=function t$(t){const n=t?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?e$.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return t.\u0275fac=function(e){return new(e||t)(Rt(Q8,8))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),xL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({}),t})();const i$=new cn("mat-sanity-checks",{providedIn:"root",factory:function n$(){return!0}});let Cc=(()=>{class t{constructor(e,o,r){this._sanityChecks=o,this._document=r,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!function f8(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return t.\u0275fac=function(e){return new(e||t)(Rt(Y8),Rt(i$,8),Rt(uo))},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[xL,xL]}),t})();function o$(t){return class extends t{get disabled(){return this._disabled}set disabled(n){this._disabled=Eu(n)}constructor(...n){super(...n),this._disabled=!1}}}function NI(t,n){return class extends t{get color(){return this._color}set color(e){const o=e||this.defaultColor;o!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),o&&this._elementRef.nativeElement.classList.add(`mat-${o}`),this._color=o)}constructor(...e){super(...e),this.defaultColor=n,this.color=n}}}function r$(t){return class extends t{get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=Eu(n)}constructor(...n){super(...n),this._disableRipple=!1}}}class a${constructor(n,e,o,r=!1){this._renderer=n,this.element=e,this.config=o,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const TL=fw({passive:!0,capture:!0});class l${constructor(){this._events=new Map,this._delegateEventHandler=n=>{const e=hy(n);e&&this._events.get(n.type)?.forEach((o,r)=>{(r===e||r.contains(e))&&o.forEach(s=>s.handleEvent(n))})}}addHandler(n,e,o,r){const s=this._events.get(e);if(s){const l=s.get(o);l?l.add(r):s.set(o,new Set([r]))}else this._events.set(e,new Map([[o,new Set([r])]])),n.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,TL)})}removeHandler(n,e,o){const r=this._events.get(n);if(!r)return;const s=r.get(e);s&&(s.delete(o),0===s.size&&r.delete(e),0===r.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,TL)))}}const SL={enterDuration:225,exitDuration:150},EL=fw({passive:!0,capture:!0}),IL=["mousedown","touchstart"],DL=["mouseup","mouseleave","touchend","touchcancel"];class $b{constructor(n,e,o,r){this._target=n,this._ngZone=e,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=py(o))}fadeInRipple(n,e,o={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...SL,...o.animation};o.centered&&(n=r.left+r.width/2,e=r.top+r.height/2);const l=o.radius||function u$(t,n,e){const o=Math.max(Math.abs(t-e.left),Math.abs(t-e.right)),r=Math.max(Math.abs(n-e.top),Math.abs(n-e.bottom));return Math.sqrt(o*o+r*r)}(n,e,r),h=n-r.left,f=e-r.top,y=s.enterDuration,C=document.createElement("div");C.classList.add("mat-ripple-element"),C.style.left=h-l+"px",C.style.top=f-l+"px",C.style.height=2*l+"px",C.style.width=2*l+"px",null!=o.color&&(C.style.backgroundColor=o.color),C.style.transitionDuration=`${y}ms`,this._containerElement.appendChild(C);const D=window.getComputedStyle(C),V=D.transitionDuration,$="none"===D.transitionProperty||"0s"===V||"0s, 0s"===V||0===r.width&&0===r.height,X=new a$(this,C,o,$);C.style.transform="scale3d(1, 1, 1)",X.state=0,o.persistent||(this._mostRecentTransientRipple=X);let ee=null;return!$&&(y||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const ue=()=>this._finishRippleTransition(X),fe=()=>this._destroyRipple(X);C.addEventListener("transitionend",ue),C.addEventListener("transitioncancel",fe),ee={onTransitionEnd:ue,onTransitionCancel:fe}}),this._activeRipples.set(X,ee),($||!y)&&this._finishRippleTransition(X),X}fadeOutRipple(n){if(2===n.state||3===n.state)return;const e=n.element,o={...SL,...n.config.animation};e.style.transitionDuration=`${o.exitDuration}ms`,e.style.opacity="0",n.state=2,(n._animationForciblyDisabledThroughCss||!o.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const e=py(n);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,IL.forEach(o=>{$b._eventManager.addHandler(this._ngZone,o,e,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{DL.forEach(e=>{this._triggerElement.addEventListener(e,this,EL)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){0===n.state?this._startFadeOutTransition(n):2===n.state&&this._destroyRipple(n)}_startFadeOutTransition(n){const e=n===this._mostRecentTransientRipple,{persistent:o}=n.config;n.state=1,!o&&(!e||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const e=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=3,null!==e&&(n.element.removeEventListener("transitionend",e.onTransitionEnd),n.element.removeEventListener("transitioncancel",e.onTransitionCancel)),n.element.remove()}_onMousedown(n){const e=fL(n),o=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!o&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!mL(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=n.changedTouches;for(let o=0;o<e.length;o++)this.fadeInRipple(e[o].clientX,e[o].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(1===n.state||n.config.terminateOnPointerUp&&0===n.state)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(IL.forEach(e=>$b._eventManager.removeHandler(e,n,this)),this._pointerUpEventsRegistered&&DL.forEach(e=>n.removeEventListener(e,this,EL)))}}$b._eventManager=new l$;const d$=new cn("mat-ripple-global-options");let zI=(()=>{class t{get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}constructor(e,o,r,s,l){this._elementRef=e,this._animationMode=l,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new $b(this,o,e,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,o=0,r){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,o,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(yi),ce(bc),ce(d$,8),ce(ly,8))},t.\u0275dir=On({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,o){2&e&&Ro("mat-ripple-unbounded",o.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),t})(),h$=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[Cc,Cc]}),t})();function gy(t,n){const e=vt(t)?t:()=>t,o=r=>r.error(e());return new ri(n?r=>n.schedule(o,0,r):o)}function Ts(t,n,e){const o=vt(t)||n||e?{next:t,error:n,complete:e}:t;return o?Ki((r,s)=>{var l;null===(l=o.subscribe)||void 0===l||l.call(o);let h=!0;r.subscribe(ii(s,f=>{var y;null===(y=o.next)||void 0===y||y.call(o,f),s.next(f)},()=>{var f;h=!1,null===(f=o.complete)||void 0===f||f.call(o),s.complete()},f=>{var y;h=!1,null===(y=o.error)||void 0===y||y.call(o,f),s.error(f)},()=>{var f,y;h&&(null===(f=o.unsubscribe)||void 0===f||f.call(o)),null===(y=o.finalize)||void 0===y||y.call(o)}))}):mr}function Wh(t){return Ki((n,e)=>{let s,o=null,r=!1;o=n.subscribe(ii(e,void 0,void 0,l=>{s=ne(t(l,Wh(t)(n))),o?(o.unsubscribe(),o=null,s.subscribe(e)):r=!0})),r&&(o.unsubscribe(),o=null,s.subscribe(e))})}function bw(t){return Ki((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}function Sf(t,n){return vt(n)?Et(t,n,1):Et(t,1)}class xw{}class BI{}class qh{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?this.lazyInit="string"==typeof n?()=>{this.headers=new Map,n.split("\n").forEach(e=>{const o=e.indexOf(":");if(o>0){const r=e.slice(0,o),s=r.toLowerCase(),l=e.slice(o+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(l):this.headers.set(s,[l])}})}:()=>{this.headers=new Map,Object.keys(n).forEach(e=>{let o=n[e];const r=e.toLowerCase();"string"==typeof o&&(o=[o]),o.length>0&&(this.headers.set(r,o),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof qh?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){const e=new qh;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof qh?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){const e=n.name.toLowerCase();switch(n.op){case"a":case"s":let o=n.value;if("string"==typeof o&&(o=[o]),0===o.length)return;this.maybeSetNormalizedName(n.name,e);const r=("a"===n.op?this.headers.get(e):void 0)||[];r.push(...o),this.headers.set(e,r);break;case"d":const s=n.value;if(s){let l=this.headers.get(e);if(!l)return;l=l.filter(h=>-1===s.indexOf(h)),0===l.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,l)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}}class p${encodeKey(n){return ML(n)}encodeValue(n){return ML(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const m$=/%(\d[a-f0-9])/gi,g$={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function ML(t){return encodeURIComponent(t).replace(m$,(n,e)=>g$[e]??n)}function ww(t){return`${t}`}class Ef{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new p$,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function f$(t,n){const e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[l,h]=-1==s?[n.decodeKey(r),""]:[n.decodeKey(r.slice(0,s)),n.decodeValue(r.slice(s+1))],f=e.get(l)||[];f.push(h),e.set(l,f)}),e}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{const o=n.fromObject[e],r=Array.isArray(o)?o.map(ww):[ww(o)];this.map.set(e,r)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){const e=[];return Object.keys(n).forEach(o=>{const r=n[o];Array.isArray(r)?r.forEach(s=>{e.push({param:o,value:s,op:"a"})}):e.push({param:o,value:r,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const e=this.encoder.encodeKey(n);return this.map.get(n).map(o=>e+"="+this.encoder.encodeValue(o)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const e=new Ef({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const e=("a"===n.op?this.map.get(n.param):void 0)||[];e.push(ww(n.value)),this.map.set(n.param,e);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let o=this.map.get(n.param)||[];const r=o.indexOf(ww(n.value));-1!==r&&o.splice(r,1),o.length>0?this.map.set(n.param,o):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class _${constructor(){this.map=new Map}set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function kL(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function AL(t){return typeof Blob<"u"&&t instanceof Blob}function PL(t){return typeof FormData<"u"&&t instanceof FormData}class Gb{constructor(n,e,o,r){let s;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function y$(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==o?o:null,s=r):s=o,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new qh),this.context||(this.context=new _$),this.params){const l=this.params.toString();if(0===l.length)this.urlWithParams=e;else{const h=e.indexOf("?");this.urlWithParams=e+(-1===h?"?":h<e.length-1?"&":"")+l}}else this.params=new Ef,this.urlWithParams=e}serializeBody(){return null===this.body?null:kL(this.body)||AL(this.body)||PL(this.body)||function v$(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ef?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||PL(this.body)?null:AL(this.body)?this.body.type||null:kL(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ef?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const e=n.method||this.method,o=n.url||this.url,r=n.responseType||this.responseType,s=void 0!==n.body?n.body:this.body,l=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,h=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let f=n.headers||this.headers,y=n.params||this.params;const C=n.context??this.context;return void 0!==n.setHeaders&&(f=Object.keys(n.setHeaders).reduce((D,R)=>D.set(R,n.setHeaders[R]),f)),n.setParams&&(y=Object.keys(n.setParams).reduce((D,R)=>D.set(R,n.setParams[R]),y)),new Gb(e,o,s,{params:y,headers:f,context:C,reportProgress:h,responseType:r,withCredentials:l})}}var Er=(()=>((Er=Er||{})[Er.Sent=0]="Sent",Er[Er.UploadProgress=1]="UploadProgress",Er[Er.ResponseHeader=2]="ResponseHeader",Er[Er.DownloadProgress=3]="DownloadProgress",Er[Er.Response=4]="Response",Er[Er.User=5]="User",Er))();class VI{constructor(n,e=200,o="OK"){this.headers=n.headers||new qh,this.status=void 0!==n.status?n.status:e,this.statusText=n.statusText||o,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class UI extends VI{constructor(n={}){super(n),this.type=Er.ResponseHeader}clone(n={}){return new UI({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Cw extends VI{constructor(n={}){super(n),this.type=Er.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new Cw({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class OL extends VI{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function jI(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let Tw=(()=>{class t{constructor(e){this.handler=e}request(e,o,r={}){let s;if(e instanceof Gb)s=e;else{let f,y;f=r.headers instanceof qh?r.headers:new qh(r.headers),r.params&&(y=r.params instanceof Ef?r.params:new Ef({fromObject:r.params})),s=new Gb(e,o,void 0!==r.body?r.body:null,{headers:f,context:r.context,params:y,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const l=Yn(s).pipe(Sf(f=>this.handler.handle(f)));if(e instanceof Gb||"events"===r.observe)return l;const h=l.pipe(Js(f=>f instanceof Cw));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return h.pipe(Vn(f=>{if(null!==f.body&&!(f.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return f.body}));case"blob":return h.pipe(Vn(f=>{if(null!==f.body&&!(f.body instanceof Blob))throw new Error("Response is not a Blob.");return f.body}));case"text":return h.pipe(Vn(f=>{if(null!==f.body&&"string"!=typeof f.body)throw new Error("Response is not a string.");return f.body}));default:return h.pipe(Vn(f=>f.body))}case"response":return h;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,o={}){return this.request("DELETE",e,o)}get(e,o={}){return this.request("GET",e,o)}head(e,o={}){return this.request("HEAD",e,o)}jsonp(e,o){return this.request("JSONP",e,{params:(new Ef).append(o,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,o={}){return this.request("OPTIONS",e,o)}patch(e,o,r={}){return this.request("PATCH",e,jI(r,o))}post(e,o,r={}){return this.request("POST",e,jI(r,o))}put(e,o,r={}){return this.request("PUT",e,jI(r,o))}}return t.\u0275fac=function(e){return new(e||t)(Rt(xw))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();function LL(t,n){return n(t)}function b$(t,n){return(e,o)=>n.intercept(e,{handle:r=>t(r,o)})}const w$=new cn("HTTP_INTERCEPTORS"),Wb=new cn("HTTP_INTERCEPTOR_FNS");function C$(){let t=null;return(n,e)=>(null===t&&(t=(ai(w$,{optional:!0})??[]).reduceRight(b$,LL)),t(n,e))}let RL=(()=>{class t extends xw{constructor(e,o){super(),this.backend=e,this.injector=o,this.chain=null}handle(e){if(null===this.chain){const o=Array.from(new Set(this.injector.get(Wb)));this.chain=o.reduceRight((r,s)=>function x$(t,n,e){return(o,r)=>e.runInContext(()=>n(o,s=>t(s,r)))}(r,s,this.injector),LL)}return this.chain(e,o=>this.backend.handle(o))}}return t.\u0275fac=function(e){return new(e||t)(Rt(BI),Rt(dc))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();const I$=/^\)\]\}',?\n/;let NL=(()=>{class t{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new ri(o=>{const r=this.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach((V,$)=>r.setRequestHeader(V,$.join(","))),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const V=e.detectContentTypeHeader();null!==V&&r.setRequestHeader("Content-Type",V)}if(e.responseType){const V=e.responseType.toLowerCase();r.responseType="json"!==V?V:"text"}const s=e.serializeBody();let l=null;const h=()=>{if(null!==l)return l;const V=r.statusText||"OK",$=new qh(r.getAllResponseHeaders()),X=function D$(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(r)||e.url;return l=new UI({headers:$,status:r.status,statusText:V,url:X}),l},f=()=>{let{headers:V,status:$,statusText:X,url:ee}=h(),ue=null;204!==$&&(ue=typeof r.response>"u"?r.responseText:r.response),0===$&&($=ue?200:0);let fe=$>=200&&$<300;if("json"===e.responseType&&"string"==typeof ue){const _e=ue;ue=ue.replace(I$,"");try{ue=""!==ue?JSON.parse(ue):null}catch(Be){ue=_e,fe&&(fe=!1,ue={error:Be,text:ue})}}fe?(o.next(new Cw({body:ue,headers:V,status:$,statusText:X,url:ee||void 0})),o.complete()):o.error(new OL({error:ue,headers:V,status:$,statusText:X,url:ee||void 0}))},y=V=>{const{url:$}=h(),X=new OL({error:V,status:r.status||0,statusText:r.statusText||"Unknown Error",url:$||void 0});o.error(X)};let C=!1;const D=V=>{C||(o.next(h()),C=!0);let $={type:Er.DownloadProgress,loaded:V.loaded};V.lengthComputable&&($.total=V.total),"text"===e.responseType&&r.responseText&&($.partialText=r.responseText),o.next($)},R=V=>{let $={type:Er.UploadProgress,loaded:V.loaded};V.lengthComputable&&($.total=V.total),o.next($)};return r.addEventListener("load",f),r.addEventListener("error",y),r.addEventListener("timeout",y),r.addEventListener("abort",y),e.reportProgress&&(r.addEventListener("progress",D),null!==s&&r.upload&&r.upload.addEventListener("progress",R)),r.send(s),o.next({type:Er.Sent}),()=>{r.removeEventListener("error",y),r.removeEventListener("abort",y),r.removeEventListener("load",f),r.removeEventListener("timeout",y),e.reportProgress&&(r.removeEventListener("progress",D),null!==s&&r.upload&&r.upload.removeEventListener("progress",R)),r.readyState!==r.DONE&&r.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(Rt(xP))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();const HI=new cn("XSRF_ENABLED"),zL=new cn("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),BL=new cn("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class VL{}let A$=(()=>{class t{constructor(e,o,r){this.doc=e,this.platform=o,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=dP(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(Rt(uo),Rt(L1),Rt(zL))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();function P$(t,n){const e=t.url.toLowerCase();if(!ai(HI)||"GET"===t.method||"HEAD"===t.method||e.startsWith("http://")||e.startsWith("https://"))return n(t);const o=ai(VL).getToken(),r=ai(BL);return null!=o&&!t.headers.has(r)&&(t=t.clone({headers:t.headers.set(r,o)})),n(t)}var is=(()=>((is=is||{})[is.Interceptors=0]="Interceptors",is[is.LegacyInterceptors=1]="LegacyInterceptors",is[is.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",is[is.NoXsrfProtection=3]="NoXsrfProtection",is[is.JsonpSupport=4]="JsonpSupport",is[is.RequestsMadeViaParent=5]="RequestsMadeViaParent",is))();function _y(t,n){return{\u0275kind:t,\u0275providers:n}}function O$(...t){const n=[Tw,NL,RL,{provide:xw,useExisting:RL},{provide:BI,useExisting:NL},{provide:Wb,useValue:P$,multi:!0},{provide:HI,useValue:!0},{provide:VL,useClass:A$}];for(const e of t)n.push(...e.\u0275providers);return function Ox(t){return{\u0275providers:t}}(n)}const UL=new cn("LEGACY_INTERCEPTOR_FN");let R$=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({providers:[O$(_y(is.LegacyInterceptors,[{provide:UL,useFactory:C$},{provide:Wb,useExisting:UL,multi:!0}]))]}),t})();const F$=["*"];let Sw;function qb(t){return function N$(){if(void 0===Sw&&(Sw=null,typeof window<"u")){const t=window;void 0!==t.trustedTypes&&(Sw=t.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return Sw}()?.createHTML(t)||t}function jL(t){return Error(`Unable to find icon with the name "${t}"`)}function HL(t){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${t}".`)}function $L(t){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${t}".`)}class bg{constructor(n,e,o){this.url=n,this.svgText=e,this.options=o}}let Ew=(()=>{class t{constructor(e,o,r,s){this._httpClient=e,this._sanitizer=o,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(e,o,r){return this.addSvgIconInNamespace("",e,o,r)}addSvgIconLiteral(e,o,r){return this.addSvgIconLiteralInNamespace("",e,o,r)}addSvgIconInNamespace(e,o,r,s){return this._addSvgIconConfig(e,o,new bg(r,null,s))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,o,r,s){const l=this._sanitizer.sanitize(To.HTML,r);if(!l)throw $L(r);const h=qb(l);return this._addSvgIconConfig(e,o,new bg("",h,s))}addSvgIconSet(e,o){return this.addSvgIconSetInNamespace("",e,o)}addSvgIconSetLiteral(e,o){return this.addSvgIconSetLiteralInNamespace("",e,o)}addSvgIconSetInNamespace(e,o,r){return this._addSvgIconSetConfig(e,new bg(o,null,r))}addSvgIconSetLiteralInNamespace(e,o,r){const s=this._sanitizer.sanitize(To.HTML,o);if(!s)throw $L(o);const l=qb(s);return this._addSvgIconSetConfig(e,new bg("",l,r))}registerFontClassAlias(e,o=e){return this._fontCssClassesByAlias.set(e,o),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const o=this._sanitizer.sanitize(To.RESOURCE_URL,e);if(!o)throw HL(e);const r=this._cachedIconsByUrl.get(o);return r?Yn(Iw(r)):this._loadSvgIconFromConfig(new bg(e,null)).pipe(Ts(s=>this._cachedIconsByUrl.set(o,s)),Vn(s=>Iw(s)))}getNamedSvgIcon(e,o=""){const r=GL(o,e);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(o,e),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const l=this._iconSetConfigs.get(o);return l?this._getSvgFromIconSetConfigs(e,l):gy(jL(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Yn(Iw(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(Vn(o=>Iw(o)))}_getSvgFromIconSetConfigs(e,o){const r=this._extractIconWithNameFromAnySet(e,o);return r?Yn(r):KP(o.filter(l=>!l.svgText).map(l=>this._loadSvgIconSetFromConfig(l).pipe(Wh(h=>{const y=`Loading icon set URL: ${this._sanitizer.sanitize(To.RESOURCE_URL,l.url)} failed: ${h.message}`;return this._errorHandler.handleError(new Error(y)),Yn(null)})))).pipe(Vn(()=>{const l=this._extractIconWithNameFromAnySet(e,o);if(!l)throw jL(e);return l}))}_extractIconWithNameFromAnySet(e,o){for(let r=o.length-1;r>=0;r--){const s=o[r];if(s.svgText&&s.svgText.toString().indexOf(e)>-1){const l=this._svgElementFromConfig(s),h=this._extractSvgIconFromSet(l,e,s.options);if(h)return h}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Ts(o=>e.svgText=o),Vn(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Yn(null):this._fetchIcon(e).pipe(Ts(o=>e.svgText=o))}_extractSvgIconFromSet(e,o,r){const s=e.querySelector(`[id="${o}"]`);if(!s)return null;const l=s.cloneNode(!0);if(l.removeAttribute("id"),"svg"===l.nodeName.toLowerCase())return this._setSvgAttributes(l,r);if("symbol"===l.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(l),r);const h=this._svgElementFromString(qb("<svg></svg>"));return h.appendChild(l),this._setSvgAttributes(h,r)}_svgElementFromString(e){const o=this._document.createElement("DIV");o.innerHTML=e;const r=o.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(e){const o=this._svgElementFromString(qb("<svg></svg>")),r=e.attributes;for(let s=0;s<r.length;s++){const{name:l,value:h}=r[s];"id"!==l&&o.setAttribute(l,h)}for(let s=0;s<e.childNodes.length;s++)e.childNodes[s].nodeType===this._document.ELEMENT_NODE&&o.appendChild(e.childNodes[s].cloneNode(!0));return o}_setSvgAttributes(e,o){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),o&&o.viewBox&&e.setAttribute("viewBox",o.viewBox),e}_fetchIcon(e){const{url:o,options:r}=e,s=r?.withCredentials??!1;if(!this._httpClient)throw function z$(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==o)throw Error(`Cannot fetch icon from URL "${o}".`);const l=this._sanitizer.sanitize(To.RESOURCE_URL,o);if(!l)throw HL(o);const h=this._inProgressUrlFetches.get(l);if(h)return h;const f=this._httpClient.get(l,{responseType:"text",withCredentials:s}).pipe(Vn(y=>qb(y)),bw(()=>this._inProgressUrlFetches.delete(l)),Zt());return this._inProgressUrlFetches.set(l,f),f}_addSvgIconConfig(e,o,r){return this._svgIconConfigs.set(GL(e,o),r),this}_addSvgIconSetConfig(e,o){const r=this._iconSetConfigs.get(e);return r?r.push(o):this._iconSetConfigs.set(e,[o]),this}_svgElementFromConfig(e){if(!e.svgElement){const o=this._svgElementFromString(e.svgText);this._setSvgAttributes(o,e.options),e.svgElement=o}return e.svgElement}_getIconConfigFromResolvers(e,o){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](o,e);if(s)return V$(s)?new bg(s.url,null,s.options):new bg(s,null)}}}return t.\u0275fac=function(e){return new(e||t)(Rt(Tw,8),Rt(nw),Rt(uo,8),Rt(pc))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Iw(t){return t.cloneNode(!0)}function GL(t,n){return t+":"+n}function V$(t){return!(!t.url||!t.options)}const U$=NI(class{constructor(t){this._elementRef=t}}),j$=new cn("MAT_ICON_DEFAULT_OPTIONS"),H$=new cn("mat-icon-location",{providedIn:"root",factory:function $$(){const t=ai(uo),n=t?t.location:null;return{getPathname:()=>n?n.pathname+n.search:""}}}),WL=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],G$=WL.map(t=>`[${t}]`).join(", "),W$=/^url\(['"]?#(.*?)['"]?\)$/;let _a=(()=>{class t extends U${get inline(){return this._inline}set inline(e){this._inline=Eu(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const o=this._cleanupFontValue(e);o!==this._fontSet&&(this._fontSet=o,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const o=this._cleanupFontValue(e);o!==this._fontIcon&&(this._fontIcon=o,this._updateFontIconClasses())}constructor(e,o,r,s,l,h){super(e),this._iconRegistry=o,this._location=s,this._errorHandler=l,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=se.EMPTY,h&&(h.color&&(this.color=this.defaultColor=h.color),h.fontSet&&(this.fontSet=h.fontSet)),r||e.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];const o=e.split(":");switch(o.length){case 1:return["",o[0]];case 2:return o;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const o=this._location.getPathname();o!==this._previousPath&&(this._previousPath=o,this._prependPathToReferences(o))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const o=this._location.getPathname();this._previousPath=o,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(o),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let o=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();o--;){const r=e.childNodes[o];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,o=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>e.classList.remove(r)),o.forEach(r=>e.classList.add(r)),this._previousFontSetClass=o,this.fontIcon!==this._previousFontIconClass&&!o.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const o=this._elementsWithExternalReferences;o&&o.forEach((r,s)=>{r.forEach(l=>{s.setAttribute(l.name,`url('${e}#${l.value}')`)})})}_cacheChildrenWithExternalReferences(e){const o=e.querySelectorAll(G$),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<o.length;s++)WL.forEach(l=>{const h=o[s],f=h.getAttribute(l),y=f?f.match(W$):null;if(y){let C=r.get(h);C||(C=[],r.set(h,C)),C.push({name:l,value:y[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[o,r]=this._splitIconName(e);o&&(this._svgNamespace=o),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,o).pipe(kd(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${o}:${r}! ${s.message}`))})}}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Ew),Bp("aria-hidden"),ce(H$),ce(pc),ce(j$,8))},t.\u0275cmp=Qt({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(e,o){2&e&&(at("data-mat-icon-type",o._usingFontIcon()?"font":"svg")("data-mat-icon-name",o._svgName||o.fontIcon)("data-mat-icon-namespace",o._svgNamespace||o.fontSet)("fontIcon",o._usingFontIcon()?o.fontIcon:null),Ro("mat-icon-inline",o.inline)("mat-icon-no-color","primary"!==o.color&&"accent"!==o.color&&"warn"!==o.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[ji],ngContentSelectors:F$,decls:1,vars:0,template:function(e,o){1&e&&(hr(),ro(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),t})(),Dw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[Cc,Cc]}),t})();class qL{}class q${}const Zh="*";function pl(t,n){return{type:7,name:t,definitions:n,options:{}}}function $o(t,n=null){return{type:4,styles:n,timings:t}}function ZL(t,n=null){return{type:2,steps:t,options:n}}function po(t){return{type:6,styles:t,offset:null}}function Mw(t,n,e){return{type:0,name:t,styles:n,options:e}}function qo(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function If(t,n=null){return{type:8,animation:t,options:n}}function Z$(t=null){return{type:9,options:t}}function yy(t,n=null){return{type:10,animation:t,options:n}}function K$(t,n,e=null){return{type:11,selector:t,animation:n,options:e}}function KL(t){Promise.resolve().then(t)}class Zb{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){KL(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(o=>o()),e.length=0}}class XL{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,o=0,r=0;const s=this.players.length;0==s?KL(()=>this._onFinish()):this.players.forEach(l=>{l.onDone(()=>{++e==s&&this._onFinish()}),l.onDestroy(()=>{++o==s&&this._onDestroy()}),l.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((l,h)=>Math.max(l,h.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(o=>{const r=o.totalTime?Math.min(1,e/o.totalTime):1;o.setPosition(r)})}getPosition(){const n=this.players.reduce((e,o)=>null===e||o.totalTime>e.totalTime?o:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(o=>o()),e.length=0}}const $I="!";function YL(t){return new It(3e3,!1)}function A7(){return typeof window<"u"&&typeof window.document<"u"}function GI(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Df(t){switch(t.length){case 0:return new Zb;case 1:return t[0];default:return new XL(t)}}function QL(t,n,e,o,r=new Map,s=new Map){const l=[],h=[];let f=-1,y=null;if(o.forEach(C=>{const D=C.get("offset"),R=D==f,V=R&&y||new Map;C.forEach(($,X)=>{let ee=X,ue=$;if("offset"!==X)switch(ee=n.normalizePropertyName(ee,l),ue){case $I:ue=r.get(X);break;case Zh:ue=s.get(X);break;default:ue=n.normalizeStyleValue(X,ee,ue,l)}V.set(ee,ue)}),R||h.push(V),y=V,f=D}),l.length)throw function v7(t){return new It(3502,!1)}();return h}function WI(t,n,e,o){switch(n){case"start":t.onStart(()=>o(e&&qI(e,"start",t)));break;case"done":t.onDone(()=>o(e&&qI(e,"done",t)));break;case"destroy":t.onDestroy(()=>o(e&&qI(e,"destroy",t)))}}function qI(t,n,e){const s=ZI(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),l=t._data;return null!=l&&(s._data=l),s}function ZI(t,n,e,o,r="",s=0,l){return{element:t,triggerName:n,fromState:e,toState:o,phaseName:r,totalTime:s,disabled:!!l}}function Bl(t,n,e){let o=t.get(n);return o||t.set(n,o=e),o}function JL(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}let KI=(t,n)=>!1,eR=(t,n,e)=>[],tR=null;function XI(t){const n=t.parentNode||t.host;return n===tR?null:n}(GI()||typeof Element<"u")&&(A7()?(tR=(()=>document.documentElement)(),KI=(t,n)=>{for(;n;){if(n===t)return!0;n=XI(n)}return!1}):KI=(t,n)=>t.contains(n),eR=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const o=t.querySelector(n);return o?[o]:[]});let xg=null,nR=!1;const iR=KI,oR=eR;let rR=(()=>{class t{validateStyleProperty(e){return function O7(t){xg||(xg=function L7(){return typeof document<"u"?document.body:null}()||{},nR=!!xg.style&&"WebkitAppearance"in xg.style);let n=!0;return xg.style&&!function P7(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in xg.style,!n&&nR&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in xg.style)),n}(e)}matchesElement(e,o){return!1}containsElement(e,o){return iR(e,o)}getParentElement(e){return XI(e)}query(e,o,r){return oR(e,o,r)}computeStyle(e,o,r){return r||""}animate(e,o,r,s,l,h=[],f){return new Zb(r,s)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})(),YI=(()=>{class t{}return t.NOOP=new rR,t})();const R7=1e3,QI="ng-enter",kw="ng-leave",Aw="ng-trigger",Pw=".ng-trigger",aR="ng-animating",JI=".ng-animating";function Kh(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:e2(parseFloat(n[1]),n[2])}function e2(t,n){return"s"===n?t*R7:t}function Ow(t,n,e){return t.hasOwnProperty("duration")?t:function N7(t,n,e){let r,s=0,l="";if("string"==typeof t){const h=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===h)return n.push(YL()),{duration:0,delay:0,easing:""};r=e2(parseFloat(h[1]),h[2]);const f=h[3];null!=f&&(s=e2(parseFloat(f),h[4]));const y=h[5];y&&(l=y)}else r=t;if(!e){let h=!1,f=n.length;r<0&&(n.push(function X$(){return new It(3100,!1)}()),h=!0),s<0&&(n.push(function Y$(){return new It(3101,!1)}()),h=!0),h&&n.splice(f,0,YL())}return{duration:r,delay:s,easing:l}}(t,n,e)}function Kb(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function lR(t){const n=new Map;return Object.keys(t).forEach(e=>{n.set(e,t[e])}),n}function Mf(t,n=new Map,e){if(e)for(let[o,r]of e)n.set(o,r);for(let[o,r]of t)n.set(o,r);return n}function uR(t,n,e){return e?n+":"+e+";":""}function dR(t){let n="";for(let e=0;e<t.style.length;e++){const o=t.style.item(e);n+=uR(0,o,t.style.getPropertyValue(o))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=uR(0,U7(e),t.style[e]));t.setAttribute("style",n)}function Ad(t,n,e){t.style&&(n.forEach((o,r)=>{const s=n2(r);e&&!e.has(r)&&e.set(r,t.style[s]),t.style[s]=o}),GI()&&dR(t))}function wg(t,n){t.style&&(n.forEach((e,o)=>{const r=n2(o);t.style[r]=""}),GI()&&dR(t))}function Xb(t){return Array.isArray(t)?1==t.length?t[0]:ZL(t):t}const t2=new RegExp("{{\\s*(.+?)\\s*}}","g");function hR(t){let n=[];if("string"==typeof t){let e;for(;e=t2.exec(t);)n.push(e[1]);t2.lastIndex=0}return n}function Yb(t,n,e){const o=t.toString(),r=o.replace(t2,(s,l)=>{let h=n[l];return null==h&&(e.push(function J$(t){return new It(3003,!1)}()),h=""),h.toString()});return r==o?t:r}function Lw(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const V7=/-+([a-z0-9])/g;function n2(t){return t.replace(V7,(...n)=>n[1].toUpperCase())}function U7(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Vl(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function e7(t){return new It(3004,!1)}()}}function pR(t,n){return window.getComputedStyle(t)[n]}const Nw="*";function q7(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(o=>function Z7(t,n,e){if(":"==t[0]){const f=function K7(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,o)=>parseFloat(o)>parseFloat(e);case":decrement":return(e,o)=>parseFloat(o)<parseFloat(e);default:return n.push(function m7(t){return new It(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof f)return void n.push(f);t=f}const o=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==o||o.length<4)return e.push(function f7(t){return new It(3015,!1)}()),n;const r=o[1],s=o[2],l=o[3];n.push(fR(r,l));"<"==s[0]&&!(r==Nw&&l==Nw)&&n.push(fR(l,r))}(o,e,n)):e.push(t),e}const zw=new Set(["true","1"]),Bw=new Set(["false","0"]);function fR(t,n){const e=zw.has(t)||Bw.has(t),o=zw.has(n)||Bw.has(n);return(r,s)=>{let l=t==Nw||t==r,h=n==Nw||n==s;return!l&&e&&"boolean"==typeof r&&(l=r?zw.has(t):Bw.has(t)),!h&&o&&"boolean"==typeof s&&(h=s?zw.has(n):Bw.has(n)),l&&h}}const X7=new RegExp("s*:selfs*,?","g");function o2(t,n,e,o){return new Y7(t).build(n,e,o)}class Y7{constructor(n){this._driver=n}build(n,e,o){const r=new eG(e);return this._resetContextStyleTimingState(r),Vl(this,Xb(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let o=e.queryCount=0,r=e.depCount=0;const s=[],l=[];return"@"==n.name.charAt(0)&&e.errors.push(function n7(){return new It(3006,!1)}()),n.definitions.forEach(h=>{if(this._resetContextStyleTimingState(e),0==h.type){const f=h,y=f.name;y.toString().split(/\s*,\s*/).forEach(C=>{f.name=C,s.push(this.visitState(f,e))}),f.name=y}else if(1==h.type){const f=this.visitTransition(h,e);o+=f.queryCount,r+=f.depCount,l.push(f)}else e.errors.push(function o7(){return new It(3007,!1)}())}),{type:7,name:n.name,states:s,transitions:l,queryCount:o,depCount:r,options:null}}visitState(n,e){const o=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(o.containsDynamicStyles){const s=new Set,l=r||{};o.styles.forEach(h=>{h instanceof Map&&h.forEach(f=>{hR(f).forEach(y=>{l.hasOwnProperty(y)||s.add(y)})})}),s.size&&(Lw(s.values()),e.errors.push(function r7(t,n){return new It(3008,!1)}()))}return{type:0,name:n.name,style:o,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const o=Vl(this,Xb(n.animation),e);return{type:1,matchers:q7(n.expr,e.errors),animation:o,queryCount:e.queryCount,depCount:e.depCount,options:Cg(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(o=>Vl(this,o,e)),options:Cg(n.options)}}visitGroup(n,e){const o=e.currentTime;let r=0;const s=n.steps.map(l=>{e.currentTime=o;const h=Vl(this,l,e);return r=Math.max(r,e.currentTime),h});return e.currentTime=r,{type:3,steps:s,options:Cg(n.options)}}visitAnimate(n,e){const o=function nG(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return r2(Ow(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=r2(0,0,"");return s.dynamic=!0,s.strValue=e,s}const r=Ow(e,n);return r2(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=o;let r,s=n.styles?n.styles:po({});if(5==s.type)r=this.visitKeyframes(s,e);else{let l=n.styles,h=!1;if(!l){h=!0;const y={};o.easing&&(y.easing=o.easing),l=po(y)}e.currentTime+=o.duration+o.delay;const f=this.visitStyle(l,e);f.isEmptyStep=h,r=f}return e.currentAnimateTimings=null,{type:4,timings:o,style:r,options:null}}visitStyle(n,e){const o=this._makeStyleAst(n,e);return this._validateStyleAst(o,e),o}_makeStyleAst(n,e){const o=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let h of r)"string"==typeof h?h===Zh?o.push(h):e.errors.push(new It(3002,!1)):o.push(lR(h));let s=!1,l=null;return o.forEach(h=>{if(h instanceof Map&&(h.has("easing")&&(l=h.get("easing"),h.delete("easing")),!s))for(let f of h.values())if(f.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:o,easing:l,offset:n.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(n,e){const o=e.currentAnimateTimings;let r=e.currentTime,s=e.currentTime;o&&s>0&&(s-=o.duration+o.delay),n.styles.forEach(l=>{"string"!=typeof l&&l.forEach((h,f)=>{const y=e.collectedStyles.get(e.currentQuerySelector),C=y.get(f);let D=!0;C&&(s!=r&&s>=C.startTime&&r<=C.endTime&&(e.errors.push(function a7(t,n,e,o,r){return new It(3010,!1)}()),D=!1),s=C.startTime),D&&y.set(f,{startTime:s,endTime:r}),e.options&&function B7(t,n,e){const o=n.params||{},r=hR(t);r.length&&r.forEach(s=>{o.hasOwnProperty(s)||e.push(function Q$(t){return new It(3001,!1)}())})}(h,e.options,e.errors)})})}visitKeyframes(n,e){const o={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function l7(){return new It(3011,!1)}()),o;let s=0;const l=[];let h=!1,f=!1,y=0;const C=n.steps.map(ue=>{const fe=this._makeStyleAst(ue,e);let _e=null!=fe.offset?fe.offset:function tG(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const o=e;n=parseFloat(o.get("offset")),o.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(fe.styles),Be=0;return null!=_e&&(s++,Be=fe.offset=_e),f=f||Be<0||Be>1,h=h||Be<y,y=Be,l.push(Be),fe});f&&e.errors.push(function c7(){return new It(3012,!1)}()),h&&e.errors.push(function u7(){return new It(3200,!1)}());const D=n.steps.length;let R=0;s>0&&s<D?e.errors.push(function d7(){return new It(3202,!1)}()):0==s&&(R=1/(D-1));const V=D-1,$=e.currentTime,X=e.currentAnimateTimings,ee=X.duration;return C.forEach((ue,fe)=>{const _e=R>0?fe==V?1:R*fe:l[fe],Be=_e*ee;e.currentTime=$+X.delay+Be,X.duration=Be,this._validateStyleAst(ue,e),ue.offset=_e,o.styles.push(ue)}),o}visitReference(n,e){return{type:8,animation:Vl(this,Xb(n.animation),e),options:Cg(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:Cg(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:Cg(n.options)}}visitQuery(n,e){const o=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[s,l]=function Q7(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(X7,"")),t=t.replace(/@\*/g,Pw).replace(/@\w+/g,e=>Pw+"-"+e.slice(1)).replace(/:animating/g,JI),[t,n]}(n.selector);e.currentQuerySelector=o.length?o+" "+s:s,Bl(e.collectedStyles,e.currentQuerySelector,new Map);const h=Vl(this,Xb(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=o,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:l,animation:h,originalSelector:n.selector,options:Cg(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function h7(){return new It(3013,!1)}());const o="full"===n.timings?{duration:0,delay:0,easing:"full"}:Ow(n.timings,e.errors,!0);return{type:12,animation:Vl(this,Xb(n.animation),e),timings:o,options:null}}}class eG{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Cg(t){return t?(t=Kb(t)).params&&(t.params=function J7(t){return t?Kb(t):null}(t.params)):t={},t}function r2(t,n,e){return{duration:t,delay:n,easing:e}}function s2(t,n,e,o,r,s,l=null,h=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:o,duration:r,delay:s,totalTime:r+s,easing:l,subTimeline:h}}class Vw{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let o=this._map.get(n);o||this._map.set(n,o=[]),o.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const rG=new RegExp(":enter","g"),aG=new RegExp(":leave","g");function a2(t,n,e,o,r,s=new Map,l=new Map,h,f,y=[]){return(new lG).buildKeyframes(t,n,e,o,r,s,l,h,f,y)}class lG{buildKeyframes(n,e,o,r,s,l,h,f,y,C=[]){y=y||new Vw;const D=new l2(n,e,y,r,s,C,[]);D.options=f;const R=f.delay?Kh(f.delay):0;D.currentTimeline.delayNextStep(R),D.currentTimeline.setStyles([l],null,D.errors,f),Vl(this,o,D);const V=D.timelines.filter($=>$.containsAnimation());if(V.length&&h.size){let $;for(let X=V.length-1;X>=0;X--){const ee=V[X];if(ee.element===e){$=ee;break}}$&&!$.allowOnlyTimelineStyles()&&$.setStyles([h],null,D.errors,f)}return V.length?V.map($=>$.buildKeyframes()):[s2(e,[],[],[],0,R,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const o=e.subInstructions.get(e.element);if(o){const r=e.createSubContext(n.options),s=e.currentTimeline.currentTime,l=this._visitSubInstructions(o,r,r.options);s!=l&&e.transformIntoNewTimeline(l)}e.previousNode=n}visitAnimateRef(n,e){const o=e.createSubContext(n.options);o.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,o),this.visitReference(n.animation,o),e.transformIntoNewTimeline(o.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,o){for(const r of n){const s=r?.delay;if(s){const l="number"==typeof s?s:Kh(Yb(s,r?.params??{},e.errors));o.delayNextStep(l)}}}_visitSubInstructions(n,e,o){let s=e.currentTimeline.currentTime;const l=null!=o.duration?Kh(o.duration):null,h=null!=o.delay?Kh(o.delay):null;return 0!==l&&n.forEach(f=>{const y=e.appendInstructionToTimeline(f,l,h);s=Math.max(s,y.duration+y.delay)}),s}visitReference(n,e){e.updateOptions(n.options,!0),Vl(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const o=e.subContextCount;let r=e;const s=n.options;if(s&&(s.params||s.delay)&&(r=e.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Uw);const l=Kh(s.delay);r.delayNextStep(l)}n.steps.length&&(n.steps.forEach(l=>Vl(this,l,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>o&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const o=[];let r=e.currentTimeline.currentTime;const s=n.options&&n.options.delay?Kh(n.options.delay):0;n.steps.forEach(l=>{const h=e.createSubContext(n.options);s&&h.delayNextStep(s),Vl(this,l,h),r=Math.max(r,h.currentTimeline.currentTime),o.push(h.currentTimeline)}),o.forEach(l=>e.currentTimeline.mergeTimelineCollectedStyles(l)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const o=n.strValue;return Ow(e.params?Yb(o,e.params,e.errors):o,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const o=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;o.delay&&(e.incrementTime(o.delay),r.snapshotCurrentStyles());const s=n.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(o.duration),this.visitStyle(s,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const o=e.currentTimeline,r=e.currentAnimateTimings;!r&&o.hasCurrentStyleProperties()&&o.forwardFrame();const s=r&&r.easing||n.easing;n.isEmptyStep?o.applyEmptyStep(s):o.setStyles(n.styles,s,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const o=e.currentAnimateTimings,r=e.currentTimeline.duration,s=o.duration,h=e.createSubContext().currentTimeline;h.easing=o.easing,n.styles.forEach(f=>{h.forwardTime((f.offset||0)*s),h.setStyles(f.styles,f.easing,e.errors,e.options),h.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(h),e.transformIntoNewTimeline(r+s),e.previousNode=n}visitQuery(n,e){const o=e.currentTimeline.currentTime,r=n.options||{},s=r.delay?Kh(r.delay):0;s&&(6===e.previousNode.type||0==o&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Uw);let l=o;const h=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=h.length;let f=null;h.forEach((y,C)=>{e.currentQueryIndex=C;const D=e.createSubContext(n.options,y);s&&D.delayNextStep(s),y===e.element&&(f=D.currentTimeline),Vl(this,n.animation,D),D.currentTimeline.applyStylesToKeyframe(),l=Math.max(l,D.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(l),f&&(e.currentTimeline.mergeTimelineCollectedStyles(f),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const o=e.parentContext,r=e.currentTimeline,s=n.timings,l=Math.abs(s.duration),h=l*(e.currentQueryTotal-1);let f=l*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":f=h-f;break;case"full":f=o.currentStaggerTime}const C=e.currentTimeline;f&&C.delayNextStep(f);const D=C.currentTime;Vl(this,n.animation,e),e.previousNode=n,o.currentStaggerTime=r.currentTime-D+(r.startTime-o.currentTimeline.startTime)}}const Uw={};class l2{constructor(n,e,o,r,s,l,h,f){this._driver=n,this.element=e,this.subInstructions=o,this._enterClassName=r,this._leaveClassName=s,this.errors=l,this.timelines=h,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Uw,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=f||new jw(this._driver,e,0),h.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const o=n;let r=this.options;null!=o.duration&&(r.duration=Kh(o.duration)),null!=o.delay&&(r.delay=Kh(o.delay));const s=o.params;if(s){let l=r.params;l||(l=this.options.params={}),Object.keys(s).forEach(h=>{(!e||!l.hasOwnProperty(h))&&(l[h]=Yb(s[h],l,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const o=n.params={};Object.keys(e).forEach(r=>{o[r]=e[r]})}}return n}createSubContext(n=null,e,o){const r=e||this.element,s=new l2(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,o||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(n),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(n){return this.previousNode=Uw,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,o){const r={duration:e??n.duration,delay:this.currentTimeline.currentTime+(o??0)+n.delay,easing:""},s=new cG(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,o,r,s,l){let h=[];if(r&&h.push(this.element),n.length>0){n=(n=n.replace(rG,"."+this._enterClassName)).replace(aG,"."+this._leaveClassName);let y=this._driver.query(this.element,n,1!=o);0!==o&&(y=o<0?y.slice(y.length+o,y.length):y.slice(0,o)),h.push(...y)}return!s&&0==h.length&&l.push(function p7(t){return new It(3014,!1)}()),h}}class jw{constructor(n,e,o,r){this._driver=n,this.element=e,this.startTime=o,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new jw(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,o]of this._globalTimelineStyles)this._backFill.set(e,o||Zh),this._currentKeyframe.set(e,Zh);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,o,r){e&&this._previousKeyframe.set("easing",e);const s=r&&r.params||{},l=function uG(t,n){const e=new Map;let o;return t.forEach(r=>{if("*"===r){o=o||n.keys();for(let s of o)e.set(s,Zh)}else Mf(r,e)}),e}(n,this._globalTimelineStyles);for(let[h,f]of l){const y=Yb(f,s,o);this._pendingStyles.set(h,y),this._localTimelineStyles.has(h)||this._backFill.set(h,this._globalTimelineStyles.get(h)??Zh),this._updateStyle(h,y)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,o)=>{const r=this._styleSummary.get(o);(!r||e.time>r.time)&&this._updateStyle(o,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,o=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((h,f)=>{const y=Mf(h,new Map,this._backFill);y.forEach((C,D)=>{C===$I?n.add(D):C===Zh&&e.add(D)}),o||y.set("offset",f/this.duration),r.push(y)});const s=n.size?Lw(n.values()):[],l=e.size?Lw(e.values()):[];if(o){const h=r[0],f=new Map(h);h.set("offset",0),f.set("offset",1),r=[h,f]}return s2(this.element,r,s,l,this.duration,this.startTime,this.easing,!1)}}class cG extends jw{constructor(n,e,o,r,s,l,h=!1){super(n,e,l.delay),this.keyframes=o,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=h,this.timings={duration:l.duration,delay:l.delay,easing:l.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:o,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],l=o+e,h=e/l,f=Mf(n[0]);f.set("offset",0),s.push(f);const y=Mf(n[0]);y.set("offset",_R(h)),s.push(y);const C=n.length-1;for(let D=1;D<=C;D++){let R=Mf(n[D]);const V=R.get("offset");R.set("offset",_R((e+V*o)/l)),s.push(R)}o=l,e=0,r="",n=s}return s2(this.element,n,this.preStyleProps,this.postStyleProps,o,e,r,!0)}}function _R(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class c2{}const dG=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class hG extends c2{normalizePropertyName(n,e){return n2(n)}normalizeStyleValue(n,e,o,r){let s="";const l=o.toString().trim();if(dG.has(e)&&0!==o&&"0"!==o)if("number"==typeof o)s="px";else{const h=o.match(/^[+-]?[\d\.]+([a-z]*)$/);h&&0==h[1].length&&r.push(function t7(t,n){return new It(3005,!1)}())}return l+s}}function yR(t,n,e,o,r,s,l,h,f,y,C,D,R){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:s,toState:o,toStyles:l,timelines:h,queriedElements:f,preStyleProps:y,postStyleProps:C,totalTime:D,errors:R}}const u2={};class vR{constructor(n,e,o){this._triggerName=n,this.ast=e,this._stateStyles=o}match(n,e,o,r){return function pG(t,n,e,o,r){return t.some(s=>s(n,e,o,r))}(this.ast.matchers,n,e,o,r)}buildStyles(n,e,o){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(e,o):new Map}build(n,e,o,r,s,l,h,f,y,C){const D=[],R=this.ast.options&&this.ast.options.params||u2,$=this.buildStyles(o,h&&h.params||u2,D),X=f&&f.params||u2,ee=this.buildStyles(r,X,D),ue=new Set,fe=new Map,_e=new Map,Be="void"===r,et={params:fG(X,R),delay:this.ast.options?.delay},gt=C?[]:a2(n,e,this.ast.animation,s,l,$,ee,et,y,D);let Ht=0;if(gt.forEach(Kt=>{Ht=Math.max(Kt.duration+Kt.delay,Ht)}),D.length)return yR(e,this._triggerName,o,r,Be,$,ee,[],[],fe,_e,Ht,D);gt.forEach(Kt=>{const Ln=Kt.element,oi=Bl(fe,Ln,new Set);Kt.preStyleProps.forEach(ar=>oi.add(ar));const Ri=Bl(_e,Ln,new Set);Kt.postStyleProps.forEach(ar=>Ri.add(ar)),Ln!==e&&ue.add(Ln)});const kt=Lw(ue.values());return yR(e,this._triggerName,o,r,Be,$,ee,gt,kt,fe,_e,Ht)}}function fG(t,n){const e=Kb(n);for(const o in t)t.hasOwnProperty(o)&&null!=t[o]&&(e[o]=t[o]);return e}class mG{constructor(n,e,o){this.styles=n,this.defaultParams=e,this.normalizer=o}buildStyles(n,e){const o=new Map,r=Kb(this.defaultParams);return Object.keys(n).forEach(s=>{const l=n[s];null!==l&&(r[s]=l)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((l,h)=>{l&&(l=Yb(l,r,e));const f=this.normalizer.normalizePropertyName(h,e);l=this.normalizer.normalizeStyleValue(h,f,l,e),o.set(h,l)})}),o}}class _G{constructor(n,e,o){this.name=n,this.ast=e,this._normalizer=o,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new mG(r.style,r.options&&r.options.params||{},o))}),bR(this.states,"true","1"),bR(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new vR(n,r,this.states))}),this.fallbackTransition=function yG(t,n,e){return new vR(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(l,h)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,o,r){return this.transitionFactories.find(l=>l.match(n,e,o,r))||null}matchStyles(n,e,o){return this.fallbackTransition.buildStyles(n,e,o)}}function bR(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const vG=new Vw;class bG{constructor(n,e,o){this.bodyNode=n,this._driver=e,this._normalizer=o,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const o=[],r=[],s=o2(this._driver,e,o,r);if(o.length)throw function b7(t){return new It(3503,!1)}();this._animations.set(n,s)}_buildPlayer(n,e,o){const r=n.element,s=QL(0,this._normalizer,0,n.keyframes,e,o);return this._driver.animate(r,s,n.duration,n.delay,n.easing,[],!0)}create(n,e,o={}){const r=[],s=this._animations.get(n);let l;const h=new Map;if(s?(l=a2(this._driver,e,s,QI,kw,new Map,new Map,o,vG,r),l.forEach(C=>{const D=Bl(h,C.element,new Map);C.postStyleProps.forEach(R=>D.set(R,null))})):(r.push(function x7(){return new It(3300,!1)}()),l=[]),r.length)throw function w7(t){return new It(3504,!1)}();h.forEach((C,D)=>{C.forEach((R,V)=>{C.set(V,this._driver.computeStyle(D,V,Zh))})});const y=Df(l.map(C=>{const D=h.get(C.element);return this._buildPlayer(C,new Map,D)}));return this._playersById.set(n,y),y.onDestroy(()=>this.destroy(n)),this.players.push(y),y}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const o=this.players.indexOf(e);o>=0&&this.players.splice(o,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function C7(t){return new It(3301,!1)}();return e}listen(n,e,o,r){const s=ZI(e,"","","");return WI(this._getPlayer(n),o,s,r),()=>{}}command(n,e,o,r){if("register"==o)return void this.register(n,r[0]);if("create"==o)return void this.create(n,e,r[0]||{});const s=this._getPlayer(n);switch(o){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const xR="ng-animate-queued",d2="ng-animate-disabled",SG=[],wR={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},EG={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Tc="__ng_removed";class h2{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const o=n&&n.hasOwnProperty("value");if(this.value=function kG(t){return t??null}(o?n.value:n),o){const s=Kb(n);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const o=this.options.params;Object.keys(e).forEach(r=>{null==o[r]&&(o[r]=e[r])})}}}const Qb="void",p2=new h2(Qb);class IG{constructor(n,e,o){this.id=n,this.hostElement=e,this._engine=o,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Sc(e,this._hostClassName)}listen(n,e,o,r){if(!this._triggers.has(e))throw function T7(t,n){return new It(3302,!1)}();if(null==o||0==o.length)throw function S7(t){return new It(3303,!1)}();if(!function AG(t){return"start"==t||"done"==t}(o))throw function E7(t,n){return new It(3400,!1)}();const s=Bl(this._elementListeners,n,[]),l={name:e,phase:o,callback:r};s.push(l);const h=Bl(this._engine.statesByElement,n,new Map);return h.has(e)||(Sc(n,Aw),Sc(n,Aw+"-"+e),h.set(e,p2)),()=>{this._engine.afterFlush(()=>{const f=s.indexOf(l);f>=0&&s.splice(f,1),this._triggers.has(e)||h.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function I7(t){return new It(3401,!1)}();return e}trigger(n,e,o,r=!0){const s=this._getTrigger(e),l=new f2(this.id,e,n);let h=this._engine.statesByElement.get(n);h||(Sc(n,Aw),Sc(n,Aw+"-"+e),this._engine.statesByElement.set(n,h=new Map));let f=h.get(e);const y=new h2(o,this.id);if(!(o&&o.hasOwnProperty("value"))&&f&&y.absorbOptions(f.options),h.set(e,y),f||(f=p2),y.value!==Qb&&f.value===y.value){if(!function LG(t,n){const e=Object.keys(t),o=Object.keys(n);if(e.length!=o.length)return!1;for(let r=0;r<e.length;r++){const s=e[r];if(!n.hasOwnProperty(s)||t[s]!==n[s])return!1}return!0}(f.params,y.params)){const X=[],ee=s.matchStyles(f.value,f.params,X),ue=s.matchStyles(y.value,y.params,X);X.length?this._engine.reportError(X):this._engine.afterFlush(()=>{wg(n,ee),Ad(n,ue)})}return}const R=Bl(this._engine.playersByElement,n,[]);R.forEach(X=>{X.namespaceId==this.id&&X.triggerName==e&&X.queued&&X.destroy()});let V=s.matchTransition(f.value,y.value,n,y.params),$=!1;if(!V){if(!r)return;V=s.fallbackTransition,$=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:V,fromState:f,toState:y,player:l,isFallbackTransition:$}),$||(Sc(n,xR),l.onStart(()=>{vy(n,xR)})),l.onDone(()=>{let X=this.players.indexOf(l);X>=0&&this.players.splice(X,1);const ee=this._engine.playersByElement.get(n);if(ee){let ue=ee.indexOf(l);ue>=0&&ee.splice(ue,1)}}),this.players.push(l),R.push(l),l}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,o)=>{this._elementListeners.set(o,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(o=>o.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const o=this._engine.driver.query(n,Pw,!0);o.forEach(r=>{if(r[Tc])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(l=>l.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>o.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,o,r){const s=this._engine.statesByElement.get(n),l=new Map;if(s){const h=[];if(s.forEach((f,y)=>{if(l.set(y,f.value),this._triggers.has(y)){const C=this.trigger(n,y,Qb,r);C&&h.push(C)}}),h.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,l),o&&Df(h).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),o=this._engine.statesByElement.get(n);if(e&&o){const r=new Set;e.forEach(s=>{const l=s.name;if(r.has(l))return;r.add(l);const f=this._triggers.get(l).fallbackTransition,y=o.get(l)||p2,C=new h2(Qb),D=new f2(this.id,l,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:l,transition:f,fromState:y,toState:C,player:D,isFallbackTransition:!0})})}}removeNode(n,e){const o=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(o.totalAnimations){const s=o.players.length?o.playersByQueriedElement.get(n):[];if(s&&s.length)r=!0;else{let l=n;for(;l=l.parentNode;)if(o.statesByElement.get(l)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)o.markElementAsRemoved(this.id,n,!1,e);else{const s=n[Tc];(!s||s===wR)&&(o.afterFlush(()=>this.clearElementCache(n)),o.destroyInnerAnimations(n),o._onRemovalComplete(n,e))}}insertNode(n,e){Sc(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(o=>{const r=o.player;if(r.destroyed)return;const s=o.element,l=this._elementListeners.get(s);l&&l.forEach(h=>{if(h.name==o.triggerName){const f=ZI(s,o.triggerName,o.fromState.value,o.toState.value);f._data=n,WI(o.player,h.phase,f,h.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(o)}),this._queue=[],e.sort((o,r)=>{const s=o.transition.ast.depCount,l=r.transition.ast.depCount;return 0==s||0==l?s-l:this._engine.driver.containsElement(o.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(o=>o.element===n)||e,e}}class DG{_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,o){this.bodyNode=n,this.driver=e,this._normalizer=o,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(o=>{o.queued&&n.push(o)})}),n}createNamespace(n,e){const o=new IG(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(o,e):(this.newHostElements.set(e,o),this.collectEnterElement(e)),this._namespaceLookup[n]=o}_balanceNamespaceList(n,e){const o=this._namespaceList,r=this.namespacesByHostElement;if(o.length-1>=0){let l=!1,h=this.driver.getParentElement(e);for(;h;){const f=r.get(h);if(f){const y=o.indexOf(f);o.splice(y+1,0,n),l=!0;break}h=this.driver.getParentElement(h)}l||o.unshift(n)}else o.push(n);return r.set(e,n),n}register(n,e){let o=this._namespaceLookup[n];return o||(o=this.createNamespace(n,e)),o}registerTrigger(n,e,o){let r=this._namespaceLookup[n];r&&r.register(e,o)&&this.totalAnimations++}destroy(n,e){if(!n)return;const o=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(o.hostElement),delete this._namespaceLookup[n];const r=this._namespaceList.indexOf(o);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>o.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,o=this.statesByElement.get(n);if(o)for(let r of o.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&e.add(s)}return e}trigger(n,e,o,r){if(Hw(e)){const s=this._fetchNamespace(n);if(s)return s.trigger(e,o,r),!0}return!1}insertNode(n,e,o,r){if(!Hw(e))return;const s=e[Tc];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const l=this.collectedLeaveElements.indexOf(e);l>=0&&this.collectedLeaveElements.splice(l,1)}if(n){const l=this._fetchNamespace(n);l&&l.insertNode(e,o)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Sc(n,d2)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),vy(n,d2))}removeNode(n,e,o,r){if(Hw(e)){const s=n?this._fetchNamespace(n):null;if(s?s.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r),o){const l=this.namespacesByHostElement.get(e);l&&l.id!==n&&l.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,o,r,s){this.collectedLeaveElements.push(e),e[Tc]={namespaceId:n,setForRemoval:r,hasAnimation:o,removedBeforeQueried:!1,previousTriggersValues:s}}listen(n,e,o,r,s){return Hw(e)?this._fetchNamespace(n).listen(e,o,r,s):()=>{}}_buildInstruction(n,e,o,r,s){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,o,r,n.fromState.options,n.toState.options,e,s)}destroyInnerAnimations(n){let e=this.driver.query(n,Pw,!0);e.forEach(o=>this.destroyActiveAnimationsForElement(o)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,JI,!0),e.forEach(o=>this.finishActiveQueriedAnimationOnElement(o)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(o=>{o.queued?o.markedForDestroy=!0:o.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(o=>o.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Df(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[Tc];if(e&&e.setForRemoval){if(n[Tc]=wR,e.namespaceId){this.destroyInnerAnimations(n);const o=this._fetchNamespace(e.namespaceId);o&&o.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(d2)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(o=>{this.markElementAsDisabled(o,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((o,r)=>this._balanceNamespaceList(o,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let o=0;o<this.collectedEnterElements.length;o++)Sc(this.collectedEnterElements[o],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const o=[];try{e=this._flushAnimations(o,n)}finally{for(let r=0;r<o.length;r++)o[r]()}}else for(let o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(o=>o()),this._flushFns=[],this._whenQuietFns.length){const o=this._whenQuietFns;this._whenQuietFns=[],e.length?Df(e).onDone(()=>{o.forEach(r=>r())}):o.forEach(r=>r())}}reportError(n){throw function D7(t){return new It(3402,!1)}()}_flushAnimations(n,e){const o=new Vw,r=[],s=new Map,l=[],h=new Map,f=new Map,y=new Map,C=new Set;this.disabledNodes.forEach(sn=>{C.add(sn);const Cn=this.driver.query(sn,".ng-animate-queued",!0);for(let Wn=0;Wn<Cn.length;Wn++)C.add(Cn[Wn])});const D=this.bodyNode,R=Array.from(this.statesByElement.keys()),V=SR(R,this.collectedEnterElements),$=new Map;let X=0;V.forEach((sn,Cn)=>{const Wn=QI+X++;$.set(Cn,Wn),sn.forEach(fi=>Sc(fi,Wn))});const ee=[],ue=new Set,fe=new Set;for(let sn=0;sn<this.collectedLeaveElements.length;sn++){const Cn=this.collectedLeaveElements[sn],Wn=Cn[Tc];Wn&&Wn.setForRemoval&&(ee.push(Cn),ue.add(Cn),Wn.hasAnimation?this.driver.query(Cn,".ng-star-inserted",!0).forEach(fi=>ue.add(fi)):fe.add(Cn))}const _e=new Map,Be=SR(R,Array.from(ue));Be.forEach((sn,Cn)=>{const Wn=kw+X++;_e.set(Cn,Wn),sn.forEach(fi=>Sc(fi,Wn))}),n.push(()=>{V.forEach((sn,Cn)=>{const Wn=$.get(Cn);sn.forEach(fi=>vy(fi,Wn))}),Be.forEach((sn,Cn)=>{const Wn=_e.get(Cn);sn.forEach(fi=>vy(fi,Wn))}),ee.forEach(sn=>{this.processLeaveNode(sn)})});const et=[],gt=[];for(let sn=this._namespaceList.length-1;sn>=0;sn--)this._namespaceList[sn].drainQueuedTransitions(e).forEach(Wn=>{const fi=Wn.player,lr=Wn.element;if(et.push(fi),this.collectedEnterElements.length){const wa=lr[Tc];if(wa&&wa.setForMove){if(wa.previousTriggersValues&&wa.previousTriggersValues.has(Wn.triggerName)){const Hg=wa.previousTriggersValues.get(Wn.triggerName),kc=this.statesByElement.get(Wn.element);if(kc&&kc.has(Wn.triggerName)){const RT=kc.get(Wn.triggerName);RT.value=Hg,kc.set(Wn.triggerName,RT)}}return void fi.destroy()}}const Ga=!D||!this.driver.containsElement(D,lr),ps=_e.get(lr),bl=$.get(lr),Uo=this._buildInstruction(Wn,o,bl,ps,Ga);if(Uo.errors&&Uo.errors.length)return void gt.push(Uo);if(Ga)return fi.onStart(()=>wg(lr,Uo.fromStyles)),fi.onDestroy(()=>Ad(lr,Uo.toStyles)),void r.push(fi);if(Wn.isFallbackTransition)return fi.onStart(()=>wg(lr,Uo.fromStyles)),fi.onDestroy(()=>Ad(lr,Uo.toStyles)),void r.push(fi);const Wf=[];Uo.timelines.forEach(wa=>{wa.stretchStartingKeyframe=!0,this.disabledNodes.has(wa.element)||Wf.push(wa)}),Uo.timelines=Wf,o.append(lr,Uo.timelines),l.push({instruction:Uo,player:fi,element:lr}),Uo.queriedElements.forEach(wa=>Bl(h,wa,[]).push(fi)),Uo.preStyleProps.forEach((wa,Hg)=>{if(wa.size){let kc=f.get(Hg);kc||f.set(Hg,kc=new Set),wa.forEach((RT,_M)=>kc.add(_M))}}),Uo.postStyleProps.forEach((wa,Hg)=>{let kc=y.get(Hg);kc||y.set(Hg,kc=new Set),wa.forEach((RT,_M)=>kc.add(_M))})});if(gt.length){const sn=[];gt.forEach(Cn=>{sn.push(function M7(t,n){return new It(3505,!1)}())}),et.forEach(Cn=>Cn.destroy()),this.reportError(sn)}const Ht=new Map,kt=new Map;l.forEach(sn=>{const Cn=sn.element;o.has(Cn)&&(kt.set(Cn,Cn),this._beforeAnimationBuild(sn.player.namespaceId,sn.instruction,Ht))}),r.forEach(sn=>{const Cn=sn.element;this._getPreviousPlayers(Cn,!1,sn.namespaceId,sn.triggerName,null).forEach(fi=>{Bl(Ht,Cn,[]).push(fi),fi.destroy()})});const Kt=ee.filter(sn=>IR(sn,f,y)),Ln=new Map;TR(Ln,this.driver,fe,y,Zh).forEach(sn=>{IR(sn,f,y)&&Kt.push(sn)});const Ri=new Map;V.forEach((sn,Cn)=>{TR(Ri,this.driver,new Set(sn),f,$I)}),Kt.forEach(sn=>{const Cn=Ln.get(sn),Wn=Ri.get(sn);Ln.set(sn,new Map([...Array.from(Cn?.entries()??[]),...Array.from(Wn?.entries()??[])]))});const ar=[],xa=[],Oo={};l.forEach(sn=>{const{element:Cn,player:Wn,instruction:fi}=sn;if(o.has(Cn)){if(C.has(Cn))return Wn.onDestroy(()=>Ad(Cn,fi.toStyles)),Wn.disabled=!0,Wn.overrideTotalTime(fi.totalTime),void r.push(Wn);let lr=Oo;if(kt.size>1){let ps=Cn;const bl=[];for(;ps=ps.parentNode;){const Uo=kt.get(ps);if(Uo){lr=Uo;break}bl.push(ps)}bl.forEach(Uo=>kt.set(Uo,lr))}const Ga=this._buildAnimation(Wn.namespaceId,fi,Ht,s,Ri,Ln);if(Wn.setRealPlayer(Ga),lr===Oo)ar.push(Wn);else{const ps=this.playersByElement.get(lr);ps&&ps.length&&(Wn.parentPlayer=Df(ps)),r.push(Wn)}}else wg(Cn,fi.fromStyles),Wn.onDestroy(()=>Ad(Cn,fi.toStyles)),xa.push(Wn),C.has(Cn)&&r.push(Wn)}),xa.forEach(sn=>{const Cn=s.get(sn.element);if(Cn&&Cn.length){const Wn=Df(Cn);sn.setRealPlayer(Wn)}}),r.forEach(sn=>{sn.parentPlayer?sn.syncPlayerEvents(sn.parentPlayer):sn.destroy()});for(let sn=0;sn<ee.length;sn++){const Cn=ee[sn],Wn=Cn[Tc];if(vy(Cn,kw),Wn&&Wn.hasAnimation)continue;let fi=[];if(h.size){let Ga=h.get(Cn);Ga&&Ga.length&&fi.push(...Ga);let ps=this.driver.query(Cn,JI,!0);for(let bl=0;bl<ps.length;bl++){let Uo=h.get(ps[bl]);Uo&&Uo.length&&fi.push(...Uo)}}const lr=fi.filter(Ga=>!Ga.destroyed);lr.length?PG(this,Cn,lr):this.processLeaveNode(Cn)}return ee.length=0,ar.forEach(sn=>{this.players.push(sn),sn.onDone(()=>{sn.destroy();const Cn=this.players.indexOf(sn);this.players.splice(Cn,1)}),sn.play()}),ar}elementContainsData(n,e){let o=!1;const r=e[Tc];return r&&r.setForRemoval&&(o=!0),this.playersByElement.has(e)&&(o=!0),this.playersByQueriedElement.has(e)&&(o=!0),this.statesByElement.has(e)&&(o=!0),this._fetchNamespace(n).elementContainsData(e)||o}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,o,r,s){let l=[];if(e){const h=this.playersByQueriedElement.get(n);h&&(l=h)}else{const h=this.playersByElement.get(n);if(h){const f=!s||s==Qb;h.forEach(y=>{y.queued||!f&&y.triggerName!=r||l.push(y)})}}return(o||r)&&(l=l.filter(h=>!(o&&o!=h.namespaceId||r&&r!=h.triggerName))),l}_beforeAnimationBuild(n,e,o){const s=e.element,l=e.isRemovalTransition?void 0:n,h=e.isRemovalTransition?void 0:e.triggerName;for(const f of e.timelines){const y=f.element,C=y!==s,D=Bl(o,y,[]);this._getPreviousPlayers(y,C,l,h,e.toState).forEach(V=>{const $=V.getRealPlayer();$.beforeDestroy&&$.beforeDestroy(),V.destroy(),D.push(V)})}wg(s,e.fromStyles)}_buildAnimation(n,e,o,r,s,l){const h=e.triggerName,f=e.element,y=[],C=new Set,D=new Set,R=e.timelines.map($=>{const X=$.element;C.add(X);const ee=X[Tc];if(ee&&ee.removedBeforeQueried)return new Zb($.duration,$.delay);const ue=X!==f,fe=function OG(t){const n=[];return ER(t,n),n}((o.get(X)||SG).map(Ht=>Ht.getRealPlayer())).filter(Ht=>!!Ht.element&&Ht.element===X),_e=s.get(X),Be=l.get(X),et=QL(0,this._normalizer,0,$.keyframes,_e,Be),gt=this._buildPlayer($,et,fe);if($.subTimeline&&r&&D.add(X),ue){const Ht=new f2(n,h,X);Ht.setRealPlayer(gt),y.push(Ht)}return gt});y.forEach($=>{Bl(this.playersByQueriedElement,$.element,[]).push($),$.onDone(()=>function MG(t,n,e){let o=t.get(n);if(o){if(o.length){const r=o.indexOf(e);o.splice(r,1)}0==o.length&&t.delete(n)}return o}(this.playersByQueriedElement,$.element,$))}),C.forEach($=>Sc($,aR));const V=Df(R);return V.onDestroy(()=>{C.forEach($=>vy($,aR)),Ad(f,e.toStyles)}),D.forEach($=>{Bl(r,$,[]).push(V)}),V}_buildPlayer(n,e,o){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,o):new Zb(n.duration,n.delay)}}class f2{constructor(n,e,o){this.namespaceId=n,this.triggerName=e,this.element=o,this._player=new Zb,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,o)=>{e.forEach(r=>WI(n,o,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Bl(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function Hw(t){return t&&1===t.nodeType}function CR(t,n){const e=t.style.display;return t.style.display=n??"none",e}function TR(t,n,e,o,r){const s=[];e.forEach(f=>s.push(CR(f)));const l=[];o.forEach((f,y)=>{const C=new Map;f.forEach(D=>{const R=n.computeStyle(y,D,r);C.set(D,R),(!R||0==R.length)&&(y[Tc]=EG,l.push(y))}),t.set(y,C)});let h=0;return e.forEach(f=>CR(f,s[h++])),l}function SR(t,n){const e=new Map;if(t.forEach(h=>e.set(h,[])),0==n.length)return e;const o=1,r=new Set(n),s=new Map;function l(h){if(!h)return o;let f=s.get(h);if(f)return f;const y=h.parentNode;return f=e.has(y)?y:r.has(y)?o:l(y),s.set(h,f),f}return n.forEach(h=>{const f=l(h);f!==o&&e.get(f).push(h)}),e}function Sc(t,n){t.classList?.add(n)}function vy(t,n){t.classList?.remove(n)}function PG(t,n,e){Df(e).onDone(()=>t.processLeaveNode(n))}function ER(t,n){for(let e=0;e<t.length;e++){const o=t[e];o instanceof XL?ER(o.players,n):n.push(o)}}function IR(t,n,e){const o=e.get(t);if(!o)return!1;let r=n.get(t);return r?o.forEach(s=>r.add(s)):n.set(t,o),e.delete(t),!0}class $w{constructor(n,e,o){this.bodyNode=n,this._driver=e,this._normalizer=o,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new DG(n,e,o),this._timelineEngine=new bG(n,e,o),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(n,e,o,r,s){const l=n+"-"+r;let h=this._triggerCache[l];if(!h){const f=[],y=[],C=o2(this._driver,s,f,y);if(f.length)throw function y7(t,n){return new It(3404,!1)}();h=function gG(t,n,e){return new _G(t,n,e)}(r,C,this._normalizer),this._triggerCache[l]=h}this._transitionEngine.registerTrigger(e,r,h)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,o,r){this._transitionEngine.insertNode(n,e,o,r)}onRemove(n,e,o,r){this._transitionEngine.removeNode(n,e,r||!1,o)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,o,r){if("@"==o.charAt(0)){const[s,l]=JL(o);this._timelineEngine.command(s,e,l,r)}else this._transitionEngine.trigger(n,e,o,r)}listen(n,e,o,r,s){if("@"==o.charAt(0)){const[l,h]=JL(o);return this._timelineEngine.listen(l,e,h,s)}return this._transitionEngine.listen(n,e,o,r,s)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let FG=(()=>{class t{constructor(e,o,r){this._element=e,this._startStyles=o,this._endStyles=r,this._state=0;let s=t.initialStylesByElement.get(e);s||t.initialStylesByElement.set(e,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Ad(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ad(this._element,this._initialStyles),this._endStyles&&(Ad(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(wg(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(wg(this._element,this._endStyles),this._endStyles=null),Ad(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function m2(t){let n=null;return t.forEach((e,o)=>{(function NG(t){return"display"===t||"position"===t})(o)&&(n=n||new Map,n.set(o,e))}),n}class DR{constructor(n,e,o,r){this.element=n,this.keyframes=e,this.options=o,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=o.duration,this._delay=o.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(o=>{e.push(Object.fromEntries(o))}),e}_triggerWebAnimation(n,e,o){return n.animate(this._convertKeyframesToObject(e),o)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((o,r)=>{"offset"!==r&&n.set(r,this._finished?o:pR(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(o=>o()),e.length=0}}class zG{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return iR(n,e)}getParentElement(n){return XI(n)}query(n,e,o){return oR(n,e,o)}computeStyle(n,e,o){return window.getComputedStyle(n)[e]}animate(n,e,o,r,s,l=[]){const f={duration:o,delay:r,fill:0==r?"both":"forwards"};s&&(f.easing=s);const y=new Map,C=l.filter(V=>V instanceof DR);(function j7(t,n){return 0===t||0===n})(o,r)&&C.forEach(V=>{V.currentSnapshot.forEach(($,X)=>y.set(X,$))});let D=function z7(t){return t.length?t[0]instanceof Map?t:t.map(n=>lR(n)):[]}(e).map(V=>Mf(V));D=function H7(t,n,e){if(e.size&&n.length){let o=n[0],r=[];if(e.forEach((s,l)=>{o.has(l)||r.push(l),o.set(l,s)}),r.length)for(let s=1;s<n.length;s++){let l=n[s];r.forEach(h=>l.set(h,pR(t,h)))}}return n}(n,D,y);const R=function RG(t,n){let e=null,o=null;return Array.isArray(n)&&n.length?(e=m2(n[0]),n.length>1&&(o=m2(n[n.length-1]))):n instanceof Map&&(e=m2(n)),e||o?new FG(t,e,o):null}(n,D);return new DR(n,D,f,R)}}let BG=(()=>{class t extends qL{constructor(e,o){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(o.body,{id:"0",encapsulation:sa.None,styles:[],data:{animation:[]}})}build(e){const o=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?ZL(e):e;return MR(this._renderer,null,o,"register",[r]),new VG(o,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(Rt(qm),Rt(uo))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();class VG extends q${constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new UG(this._id,n,e||{},this._renderer)}}class UG{constructor(n,e,o,r){this.id=n,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",o)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return MR(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function MR(t,n,e,o,r){return t.setProperty(n,`@@${e}:${o}`,r)}const kR="@.disabled";let jG=(()=>{class t{constructor(e,o,r){this.delegate=e,this.engine=o,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),o.onRemovalComplete=(s,l)=>{const h=l?.parentNode(s);h&&l.removeChild(h,s)}}createRenderer(e,o){const s=this.delegate.createRenderer(e,o);if(!(e&&o&&o.data&&o.data.animation)){let C=this._rendererCache.get(s);return C||(C=new AR("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,C)),C}const l=o.id,h=o.id+"-"+this._currentId;this._currentId++,this.engine.register(h,e);const f=C=>{Array.isArray(C)?C.forEach(f):this.engine.registerTrigger(l,h,e,C.name,C)};return o.data.animation.forEach(f),new HG(this,h,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,o,r){e>=0&&e<this._microtaskId?this._zone.run(()=>o(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[l,h]=s;l(h)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([o,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(Rt(qm),Rt($w),Rt(yi))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();class AR{constructor(n,e,o,r){this.namespaceId=n,this.delegate=e,this.engine=o,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>e.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,o,r=!0){this.delegate.insertBefore(n,e,o),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,o){this.engine.onRemove(this.namespaceId,e,this.delegate,o)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,o,r){this.delegate.setAttribute(n,e,o,r)}removeAttribute(n,e,o){this.delegate.removeAttribute(n,e,o)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,o,r){this.delegate.setStyle(n,e,o,r)}removeStyle(n,e,o){this.delegate.removeStyle(n,e,o)}setProperty(n,e,o){"@"==e.charAt(0)&&e==kR?this.disableAnimations(n,!!o):this.delegate.setProperty(n,e,o)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,o){return this.delegate.listen(n,e,o)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class HG extends AR{constructor(n,e,o,r,s){super(e,o,r,s),this.factory=n,this.namespaceId=e}setProperty(n,e,o){"@"==e.charAt(0)?"."==e.charAt(1)&&e==kR?this.disableAnimations(n,o=void 0===o||!!o):this.engine.process(this.namespaceId,n,e.slice(1),o):this.delegate.setProperty(n,e,o)}listen(n,e,o){if("@"==e.charAt(0)){const r=function $G(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let s=e.slice(1),l="";return"@"!=s.charAt(0)&&([s,l]=function GG(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(s)),this.engine.listen(this.namespaceId,r,s,l,h=>{this.factory.scheduleListenerCallback(h._data||-1,o,h)})}return this.delegate.listen(n,e,o)}}let WG=(()=>{class t extends $w{constructor(e,o,r,s){super(e.body,o,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(Rt(uo),Rt(YI),Rt(c2),Rt(Ib))},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();const PR=[{provide:qL,useClass:BG},{provide:c2,useFactory:function qG(){return new hG}},{provide:$w,useClass:WG},{provide:qm,useFactory:function ZG(t,n,e){return new jG(t,n,e)},deps:[tw,$w,yi]}],g2=[{provide:YI,useFactory:()=>new zG},{provide:ly,useValue:"BrowserAnimations"},...PR],OR=[{provide:YI,useClass:rR},{provide:ly,useValue:"NoopAnimations"},...PR];let LR=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?OR:g2}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({providers:g2,imports:[HP]}),t})();const Ww=_t(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function RR(t){return new ri(n=>{ne(t()).subscribe(n)})}function _2(){return Ki((t,n)=>{let e=null;t._refCount++;const o=ii(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const r=t._connection,s=e;e=null,r&&(!s||r===s)&&r.unsubscribe(),n.unsubscribe()});t.subscribe(o),o.closed||(e=t.connect())})}class FR extends ri{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,js(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new se;const e=this.getSubject();n.add(this.source.subscribe(ii(e,void 0,()=>{this._teardown(),e.complete()},o=>{this._teardown(),e.error(o)},()=>this._teardown()))),n.closed&&(this._connection=null,n=se.EMPTY)}return n}refCount(){return _2()(this)}}function Pd(t,n){return Ki((e,o)=>{let r=null,s=0,l=!1;const h=()=>l&&!r&&o.complete();e.subscribe(ii(o,f=>{r?.unsubscribe();let y=0;const C=s++;ne(t(f,C)).subscribe(r=ii(o,D=>o.next(n?n(f,D,C,y++):D),()=>{r=null,h()}))},()=>{l=!0,h()}))})}function qw(t){return Ki((n,e)=>{let o=!1;n.subscribe(ii(e,r=>{o=!0,e.next(r)},()=>{o||e.next(t),e.complete()}))})}function NR(t=KG){return Ki((n,e)=>{let o=!1;n.subscribe(ii(e,r=>{o=!0,e.next(r)},()=>o?e.complete():e.error(t())))})}function KG(){return new Ww}function kf(t,n){const e=arguments.length>=2;return o=>o.pipe(t?Js((r,s)=>t(r,s,o)):mr,kd(1),e?qw(n):NR(()=>new Ww))}function zR(t,n){return Ki(function XG(t,n,e,o,r){return(s,l)=>{let h=e,f=n,y=0;s.subscribe(ii(l,C=>{const D=y++;f=h?t(f,C,D):(h=!0,C),o&&l.next(f)},r&&(()=>{h&&l.next(f),l.complete()})))}}(t,n,arguments.length>=2,!0))}function y2(t){return t<=0?()=>mn:Ki((n,e)=>{let o=[];n.subscribe(ii(e,r=>{o.push(r),t<o.length&&o.shift()},()=>{for(const r of o)e.next(r);e.complete()},void 0,()=>{o=null}))})}function BR(t,n){const e=arguments.length>=2;return o=>o.pipe(t?Js((r,s)=>t(r,s,o)):mr,y2(1),e?qw(n):NR(()=>new Ww))}function v2(t){return Vn(()=>t)}const Li="primary",Jb=Symbol("RouteTitle");class QG{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function by(t){return new QG(t)}function JG(t,n,e){const o=e.path.split("/");if(o.length>t.length||"full"===e.pathMatch&&(n.hasChildren()||o.length<t.length))return null;const r={};for(let s=0;s<o.length;s++){const l=o[s],h=t[s];if(l.startsWith(":"))r[l.substring(1)]=h;else if(l!==h.path)return null}return{consumed:t.slice(0,o.length),posParams:r}}function Od(t,n){const e=t?Object.keys(t):void 0,o=n?Object.keys(n):void 0;if(!e||!o||e.length!=o.length)return!1;let r;for(let s=0;s<e.length;s++)if(r=e[s],!VR(t[r],n[r]))return!1;return!0}function VR(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;const e=[...t].sort(),o=[...n].sort();return e.every((r,s)=>o[s]===r)}return t===n}function UR(t){return Array.prototype.concat.apply([],t)}function jR(t){return t.length>0?t[t.length-1]:null}function ea(t,n){for(const e in t)t.hasOwnProperty(e)&&n(t[e],e)}function Af(t){return wr(t)?t:xr(t)?er(Promise.resolve(t)):Yn(t)}const Zw=!1,t9={exact:function GR(t,n,e){if(!Tg(t.segments,n.segments)||!Kw(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const o in n.children)if(!t.children[o]||!GR(t.children[o],n.children[o],e))return!1;return!0},subset:WR},HR={exact:function n9(t,n){return Od(t,n)},subset:function o9(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>VR(t[e],n[e]))},ignored:()=>!0};function $R(t,n,e){return t9[e.paths](t.root,n.root,e.matrixParams)&&HR[e.queryParams](t.queryParams,n.queryParams)&&!("exact"===e.fragment&&t.fragment!==n.fragment)}function WR(t,n,e){return qR(t,n,n.segments,e)}function qR(t,n,e,o){if(t.segments.length>e.length){const r=t.segments.slice(0,e.length);return!(!Tg(r,e)||n.hasChildren()||!Kw(r,e,o))}if(t.segments.length===e.length){if(!Tg(t.segments,e)||!Kw(t.segments,e,o))return!1;for(const r in n.children)if(!t.children[r]||!WR(t.children[r],n.children[r],o))return!1;return!0}{const r=e.slice(0,t.segments.length),s=e.slice(t.segments.length);return!!(Tg(t.segments,r)&&Kw(t.segments,r,o)&&t.children[Li])&&qR(t.children[Li],n,s,o)}}function Kw(t,n,e){return n.every((o,r)=>HR[e](t[r].parameters,o.parameters))}class Pf{constructor(n=new eo([],{}),e={},o=null){this.root=n,this.queryParams=e,this.fragment=o}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=by(this.queryParams)),this._queryParamMap}toString(){return a9.serialize(this)}}class eo{constructor(n,e){this.segments=n,this.children=e,this.parent=null,ea(e,(o,r)=>o.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Xw(this)}}class e0{constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=by(this.parameters)),this._parameterMap}toString(){return XR(this)}}function Tg(t,n){return t.length===n.length&&t.every((e,o)=>e.path===n[o].path)}let t0=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:function(){return new b2},providedIn:"root"}),t})();class b2{parse(n){const e=new g9(n);return new Pf(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){const e=`/${n0(n.root,!0)}`,o=function u9(t){const n=Object.keys(t).map(e=>{const o=t[e];return Array.isArray(o)?o.map(r=>`${Yw(e)}=${Yw(r)}`).join("&"):`${Yw(e)}=${Yw(o)}`}).filter(e=>!!e);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${e}${o}${"string"==typeof n.fragment?`#${function l9(t){return encodeURI(t)}(n.fragment)}`:""}`}}const a9=new b2;function Xw(t){return t.segments.map(n=>XR(n)).join("/")}function n0(t,n){if(!t.hasChildren())return Xw(t);if(n){const e=t.children[Li]?n0(t.children[Li],!1):"",o=[];return ea(t.children,(r,s)=>{s!==Li&&o.push(`${s}:${n0(r,!1)}`)}),o.length>0?`${e}(${o.join("//")})`:e}{const e=function s9(t,n){let e=[];return ea(t.children,(o,r)=>{r===Li&&(e=e.concat(n(o,r)))}),ea(t.children,(o,r)=>{r!==Li&&(e=e.concat(n(o,r)))}),e}(t,(o,r)=>r===Li?[n0(t.children[Li],!1)]:[`${r}:${n0(o,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Li]?`${Xw(t)}/${e[0]}`:`${Xw(t)}/(${e.join("//")})`}}function ZR(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Yw(t){return ZR(t).replace(/%3B/gi,";")}function x2(t){return ZR(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Qw(t){return decodeURIComponent(t)}function KR(t){return Qw(t.replace(/\+/g,"%20"))}function XR(t){return`${x2(t.path)}${function c9(t){return Object.keys(t).map(n=>`;${x2(n)}=${x2(t[n])}`).join("")}(t.parameters)}`}const d9=/^[^\/()?;=#]+/;function Jw(t){const n=t.match(d9);return n?n[0]:""}const h9=/^[^=?&#]+/,f9=/^[^&#]+/;class g9{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new eo([],{}):new eo([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let o={};return this.peekStartsWith("(")&&(o=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(o[Li]=new eo(n,e)),o}parseSegment(){const n=Jw(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new It(4009,Zw);return this.capture(n),new e0(Qw(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const e=Jw(this.remaining);if(!e)return;this.capture(e);let o="";if(this.consumeOptional("=")){const r=Jw(this.remaining);r&&(o=r,this.capture(o))}n[Qw(e)]=Qw(o)}parseQueryParam(n){const e=function p9(t){const n=t.match(h9);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let o="";if(this.consumeOptional("=")){const l=function m9(t){const n=t.match(f9);return n?n[0]:""}(this.remaining);l&&(o=l,this.capture(o))}const r=KR(e),s=KR(o);if(n.hasOwnProperty(r)){let l=n[r];Array.isArray(l)||(l=[l],n[r]=l),l.push(s)}else n[r]=s}parseParens(n){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const o=Jw(this.remaining),r=this.remaining[o.length];if("/"!==r&&")"!==r&&";"!==r)throw new It(4010,Zw);let s;o.indexOf(":")>-1?(s=o.slice(0,o.indexOf(":")),this.capture(s),this.capture(":")):n&&(s=Li);const l=this.parseChildren();e[s]=1===Object.keys(l).length?l[Li]:new eo([],l),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new It(4011,Zw)}}function w2(t){return t.segments.length>0?new eo([],{[Li]:t}):t}function eC(t){const n={};for(const o of Object.keys(t.children)){const s=eC(t.children[o]);(s.segments.length>0||s.hasChildren())&&(n[o]=s)}return function _9(t){if(1===t.numberOfChildren&&t.children[Li]){const n=t.children[Li];return new eo(t.segments.concat(n.segments),n.children)}return t}(new eo(t.segments,n))}function Sg(t){return t instanceof Pf}const C2=!1;function y9(t,n,e,o,r){if(0===e.length)return xy(n.root,n.root,n.root,o,r);const s=function tF(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new eF(!0,0,t);let n=0,e=!1;const o=t.reduce((r,s,l)=>{if("object"==typeof s&&null!=s){if(s.outlets){const h={};return ea(s.outlets,(f,y)=>{h[y]="string"==typeof f?f.split("/"):f}),[...r,{outlets:h}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===l?(s.split("/").forEach((h,f)=>{0==f&&"."===h||(0==f&&""===h?e=!0:".."===h?n++:""!=h&&r.push(h))}),r):[...r,s]},[]);return new eF(e,n,o)}(e);return s.toRoot()?xy(n.root,n.root,new eo([],{}),o,r):function l(f){const y=function b9(t,n,e,o){if(t.isAbsolute)return new wy(n.root,!0,0);if(-1===o)return new wy(e,e===n.root,0);return function nF(t,n,e){let o=t,r=n,s=e;for(;s>r;){if(s-=r,o=o.parent,!o)throw new It(4005,C2&&"Invalid number of '../'");r=o.segments.length}return new wy(o,!1,r-s)}(e,o+(o0(t.commands[0])?0:1),t.numberOfDoubleDots)}(s,n,t.snapshot?._urlSegment,f),C=y.processChildren?Cy(y.segmentGroup,y.index,s.commands):T2(y.segmentGroup,y.index,s.commands);return xy(n.root,y.segmentGroup,C,o,r)}(t.snapshot?._lastPathIndex)}function o0(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function r0(t){return"object"==typeof t&&null!=t&&t.outlets}function xy(t,n,e,o,r){let l,s={};o&&ea(o,(f,y)=>{s[y]=Array.isArray(f)?f.map(C=>`${C}`):`${f}`}),l=t===n?e:JR(t,n,e);const h=w2(eC(l));return new Pf(h,s,r)}function JR(t,n,e){const o={};return ea(t.children,(r,s)=>{o[s]=r===n?e:JR(r,n,e)}),new eo(t.segments,o)}class eF{constructor(n,e,o){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=o,n&&o.length>0&&o0(o[0]))throw new It(4003,C2&&"Root segment cannot have matrix parameters");const r=o.find(r0);if(r&&r!==jR(o))throw new It(4004,C2&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class wy{constructor(n,e,o){this.segmentGroup=n,this.processChildren=e,this.index=o}}function T2(t,n,e){if(t||(t=new eo([],{})),0===t.segments.length&&t.hasChildren())return Cy(t,n,e);const o=function w9(t,n,e){let o=0,r=n;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(o>=e.length)return s;const l=t.segments[r],h=e[o];if(r0(h))break;const f=`${h}`,y=o<e.length-1?e[o+1]:null;if(r>0&&void 0===f)break;if(f&&y&&"object"==typeof y&&void 0===y.outlets){if(!oF(f,y,l))return s;o+=2}else{if(!oF(f,{},l))return s;o++}r++}return{match:!0,pathIndex:r,commandIndex:o}}(t,n,e),r=e.slice(o.commandIndex);if(o.match&&o.pathIndex<t.segments.length){const s=new eo(t.segments.slice(0,o.pathIndex),{});return s.children[Li]=new eo(t.segments.slice(o.pathIndex),t.children),Cy(s,0,r)}return o.match&&0===r.length?new eo(t.segments,{}):o.match&&!t.hasChildren()?S2(t,n,e):o.match?Cy(t,0,r):S2(t,n,e)}function Cy(t,n,e){if(0===e.length)return new eo(t.segments,{});{const o=function x9(t){return r0(t[0])?t[0].outlets:{[Li]:t}}(e),r={};return!o[Li]&&t.children[Li]&&1===t.numberOfChildren&&0===t.children[Li].segments.length?Cy(t.children[Li],n,e):(ea(o,(s,l)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[l]=T2(t.children[l],n,s))}),ea(t.children,(s,l)=>{void 0===o[l]&&(r[l]=s)}),new eo(t.segments,r))}}function S2(t,n,e){const o=t.segments.slice(0,n);let r=0;for(;r<e.length;){const s=e[r];if(r0(s)){const f=C9(s.outlets);return new eo(o,f)}if(0===r&&o0(e[0])){o.push(new e0(t.segments[n].path,iF(e[0]))),r++;continue}const l=r0(s)?s.outlets[Li]:`${s}`,h=r<e.length-1?e[r+1]:null;l&&h&&o0(h)?(o.push(new e0(l,iF(h))),r+=2):(o.push(new e0(l,{})),r++)}return new eo(o,{})}function C9(t){const n={};return ea(t,(e,o)=>{"string"==typeof e&&(e=[e]),null!==e&&(n[o]=S2(new eo([],{}),0,e))}),n}function iF(t){const n={};return ea(t,(e,o)=>n[o]=`${e}`),n}function oF(t,n,e){return t==e.path&&Od(n,e.parameters)}const s0="imperative";class Ld{constructor(n,e){this.id=n,this.url=e}}class E2 extends Ld{constructor(n,e,o="imperative",r=null){super(n,e),this.type=0,this.navigationTrigger=o,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Eg extends Ld{constructor(n,e,o){super(n,e),this.urlAfterRedirects=o,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class tC extends Ld{constructor(n,e,o,r){super(n,e),this.reason=o,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class nC extends Ld{constructor(n,e,o,r){super(n,e),this.reason=o,this.code=r,this.type=16}}class I2 extends Ld{constructor(n,e,o,r){super(n,e),this.error=o,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class T9 extends Ld{constructor(n,e,o,r){super(n,e),this.urlAfterRedirects=o,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class S9 extends Ld{constructor(n,e,o,r){super(n,e),this.urlAfterRedirects=o,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class E9 extends Ld{constructor(n,e,o,r,s){super(n,e),this.urlAfterRedirects=o,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class I9 extends Ld{constructor(n,e,o,r){super(n,e),this.urlAfterRedirects=o,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class D9 extends Ld{constructor(n,e,o,r){super(n,e),this.urlAfterRedirects=o,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class M9{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class k9{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class A9{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class P9{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class O9{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class L9{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rF{constructor(n,e,o){this.routerEvent=n,this.position=e,this.anchor=o,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let N9=(()=>{class t{createUrlTree(e,o,r,s,l,h){return y9(e||o.root,r,s,l,h)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})(),B9=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:function(n){return N9.\u0275fac(n)},providedIn:"root"}),t})();class sF{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){const e=D2(n,this._root);return e?e.children.map(o=>o.value):[]}firstChild(n){const e=D2(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){const e=M2(n,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==n)}pathFromRoot(n){return M2(n,this._root).map(e=>e.value)}}function D2(t,n){if(t===n.value)return n;for(const e of n.children){const o=D2(t,e);if(o)return o}return null}function M2(t,n){if(t===n.value)return[n];for(const e of n.children){const o=M2(t,e);if(o.length)return o.unshift(n),o}return[]}class Xh{constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}}function Ty(t){const n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}class aF extends sF{constructor(n,e){super(n),this.snapshot=e,k2(this,n)}toString(){return this.snapshot.toString()}}function lF(t,n){const e=function V9(t,n){const l=new iC([],{},{},"",{},Li,n,null,t.root,-1,{});return new uF("",new Xh(l,[]))}(t,n),o=new xc([new e0("",{})]),r=new xc({}),s=new xc({}),l=new xc({}),h=new xc(""),f=new Yh(o,r,l,h,s,Li,n,e.root);return f.snapshot=e.root,new aF(new Xh(f,[]),e)}class Yh{constructor(n,e,o,r,s,l,h,f){this.url=n,this.params=e,this.queryParams=o,this.fragment=r,this.data=s,this.outlet=l,this.component=h,this.title=this.data?.pipe(Vn(y=>y[Jb]))??Yn(void 0),this._futureSnapshot=f}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Vn(n=>by(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Vn(n=>by(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function cF(t,n="emptyOnly"){const e=t.pathFromRoot;let o=0;if("always"!==n)for(o=e.length-1;o>=1;){const r=e[o],s=e[o-1];if(r.routeConfig&&""===r.routeConfig.path)o--;else{if(s.component)break;o--}}return function U9(t){return t.reduce((n,e)=>({params:{...n.params,...e.params},data:{...n.data,...e.data},resolve:{...e.data,...n.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(o))}class iC{get title(){return this.data?.[Jb]}constructor(n,e,o,r,s,l,h,f,y,C,D){this.url=n,this.params=e,this.queryParams=o,this.fragment=r,this.data=s,this.outlet=l,this.component=h,this.routeConfig=f,this._urlSegment=y,this._lastPathIndex=C,this._resolve=D}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=by(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=by(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(o=>o.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class uF extends sF{constructor(n,e){super(e),this.url=n,k2(this,e)}toString(){return dF(this._root)}}function k2(t,n){n.value._routerState=t,n.children.forEach(e=>k2(t,e))}function dF(t){const n=t.children.length>0?` { ${t.children.map(dF).join(", ")} } `:"";return`${t.value}${n}`}function A2(t){if(t.snapshot){const n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,Od(n.queryParams,e.queryParams)||t.queryParams.next(e.queryParams),n.fragment!==e.fragment&&t.fragment.next(e.fragment),Od(n.params,e.params)||t.params.next(e.params),function e9(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!Od(t[e],n[e]))return!1;return!0}(n.url,e.url)||t.url.next(e.url),Od(n.data,e.data)||t.data.next(e.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function P2(t,n){const e=Od(t.params,n.params)&&function r9(t,n){return Tg(t,n)&&t.every((e,o)=>Od(e.parameters,n[o].parameters))}(t.url,n.url);return e&&!(!t.parent!=!n.parent)&&(!t.parent||P2(t.parent,n.parent))}function a0(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){const o=e.value;o._futureSnapshot=n.value;const r=function H9(t,n,e){return n.children.map(o=>{for(const r of e.children)if(t.shouldReuseRoute(o.value,r.value.snapshot))return a0(t,o,r);return a0(t,o)})}(t,n,e);return new Xh(o,r)}{if(t.shouldAttach(n.value)){const s=t.retrieve(n.value);if(null!==s){const l=s.route;return l.value._futureSnapshot=n.value,l.children=n.children.map(h=>a0(t,h)),l}}const o=function $9(t){return new Yh(new xc(t.url),new xc(t.params),new xc(t.queryParams),new xc(t.fragment),new xc(t.data),t.outlet,t.component,t)}(n.value),r=n.children.map(s=>a0(t,s));return new Xh(o,r)}}const O2="ngNavigationCancelingError";function hF(t,n){const{redirectTo:e,navigationBehaviorOptions:o}=Sg(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,r=pF(!1,0,n);return r.url=e,r.navigationBehaviorOptions=o,r}function pF(t,n,e){const o=new Error("NavigationCancelingError: "+(t||""));return o[O2]=!0,o.cancellationCode=n,e&&(o.url=e),o}function fF(t){return mF(t)&&Sg(t.url)}function mF(t){return t&&t[O2]}class G9{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new l0,this.attachRef=null}}let l0=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(e,o){const r=this.getOrCreateContext(e);r.outlet=o,this.contexts.set(e,r)}onChildOutletDestroyed(e){const o=this.getContext(e);o&&(o.outlet=null,o.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let o=this.getContext(e);return o||(o=new G9,this.contexts.set(e,o)),o}getContext(e){return this.contexts.get(e)||null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const oC=!1;let rC=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=Li,this.activateEvents=new ht,this.deactivateEvents=new ht,this.attachEvents=new ht,this.detachEvents=new ht,this.parentContexts=ai(l0),this.location=ai(xu),this.changeDetector=ai(Fo),this.environmentInjector=ai(dc)}ngOnChanges(e){if(e.name){const{firstChange:o,previousValue:r}=e.name;if(o)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new It(4012,oC);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new It(4012,oC);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new It(4012,oC);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,o){this.activated=e,this._activatedRoute=o,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,o){if(this.isActivated)throw new It(4013,oC);this._activatedRoute=e;const r=this.location,l=e.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,f=new W9(e,h,r.injector);if(o&&function q9(t){return!!t.resolveComponentFactory}(o)){const y=o.resolveComponentFactory(l);this.activated=r.createComponent(y,r.length,f)}else this.activated=r.createComponent(l,{index:r.length,injector:f,environmentInjector:o??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=On({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[_r]}),t})();class W9{constructor(n,e,o){this.route=n,this.childContexts=e,this.parent=o}get(n,e){return n===Yh?this.route:n===l0?this.childContexts:this.parent.get(n,e)}}let L2=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["ng-component"]],standalone:!0,features:[zk],decls:1,vars:0,template:function(e,o){1&e&&Ae(0,"router-outlet")},dependencies:[rC],encapsulation:2}),t})();function gF(t,n){return t.providers&&!t._injector&&(t._injector=I1(t.providers,n,`Route: ${t.path}`)),t._injector??n}function F2(t){const n=t.children&&t.children.map(F2),e=n?{...t,children:n}:{...t};return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==Li&&(e.component=L2),e}function Ec(t){return t.outlet||Li}function _F(t,n){const e=t.filter(o=>Ec(o)===n);return e.push(...t.filter(o=>Ec(o)!==n)),e}function c0(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let n=t.parent;n;n=n.parent){const e=n.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class Q9{constructor(n,e,o,r){this.routeReuseStrategy=n,this.futureState=e,this.currState=o,this.forwardEvent=r}activate(n){const e=this.futureState._root,o=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,o,n),A2(this.futureState.root),this.activateChildRoutes(e,o,n)}deactivateChildRoutes(n,e,o){const r=Ty(e);n.children.forEach(s=>{const l=s.value.outlet;this.deactivateRoutes(s,r[l],o),delete r[l]}),ea(r,(s,l)=>{this.deactivateRouteAndItsChildren(s,o)})}deactivateRoutes(n,e,o){const r=n.value,s=e?e.value:null;if(r===s)if(r.component){const l=o.getContext(r.outlet);l&&this.deactivateChildRoutes(n,e,l.children)}else this.deactivateChildRoutes(n,e,o);else s&&this.deactivateRouteAndItsChildren(e,o)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){const o=e.getContext(n.value.outlet),r=o&&n.value.component?o.children:e,s=Ty(n);for(const l of Object.keys(s))this.deactivateRouteAndItsChildren(s[l],r);if(o&&o.outlet){const l=o.outlet.detach(),h=o.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:l,route:n,contexts:h})}}deactivateRouteAndOutlet(n,e){const o=e.getContext(n.value.outlet),r=o&&n.value.component?o.children:e,s=Ty(n);for(const l of Object.keys(s))this.deactivateRouteAndItsChildren(s[l],r);o&&o.outlet&&(o.outlet.deactivate(),o.children.onOutletDeactivated(),o.attachRef=null,o.resolver=null,o.route=null)}activateChildRoutes(n,e,o){const r=Ty(e);n.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],o),this.forwardEvent(new L9(s.value.snapshot))}),n.children.length&&this.forwardEvent(new P9(n.value.snapshot))}activateRoutes(n,e,o){const r=n.value,s=e?e.value:null;if(A2(r),r===s)if(r.component){const l=o.getOrCreateContext(r.outlet);this.activateChildRoutes(n,e,l.children)}else this.activateChildRoutes(n,e,o);else if(r.component){const l=o.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const h=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),A2(h.route.value),this.activateChildRoutes(n,null,l.children)}else{const h=c0(r.snapshot),f=h?.get(dr)??null;l.attachRef=null,l.route=r,l.resolver=f,l.injector=h,l.outlet&&l.outlet.activateWith(r,l.injector),this.activateChildRoutes(n,null,l.children)}}else this.activateChildRoutes(n,null,o)}}class yF{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class sC{constructor(n,e){this.component=n,this.route=e}}function J9(t,n,e){const o=t._root;return u0(o,n?n._root:null,e,[o.value])}function Sy(t,n){const e=Symbol(),o=n.get(t,e);return o===e?"function"!=typeof t||function nh(t){return null!==th(t)}(t)?n.get(t):t:o}function u0(t,n,e,o,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Ty(n);return t.children.forEach(l=>{(function tW(t,n,e,o,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,l=n?n.value:null,h=e?e.getContext(t.value.outlet):null;if(l&&s.routeConfig===l.routeConfig){const f=function nW(t,n,e){if("function"==typeof e)return e(t,n);switch(e){case"pathParamsChange":return!Tg(t.url,n.url);case"pathParamsOrQueryParamsChange":return!Tg(t.url,n.url)||!Od(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!P2(t,n)||!Od(t.queryParams,n.queryParams);default:return!P2(t,n)}}(l,s,s.routeConfig.runGuardsAndResolvers);f?r.canActivateChecks.push(new yF(o)):(s.data=l.data,s._resolvedData=l._resolvedData),u0(t,n,s.component?h?h.children:null:e,o,r),f&&h&&h.outlet&&h.outlet.isActivated&&r.canDeactivateChecks.push(new sC(h.outlet.component,l))}else l&&d0(n,h,r),r.canActivateChecks.push(new yF(o)),u0(t,null,s.component?h?h.children:null:e,o,r)})(l,s[l.value.outlet],e,o.concat([l.value]),r),delete s[l.value.outlet]}),ea(s,(l,h)=>d0(l,e.getContext(h),r)),r}function d0(t,n,e){const o=Ty(t),r=t.value;ea(o,(s,l)=>{d0(s,r.component?n?n.children.getContext(l):null:n,e)}),e.canDeactivateChecks.push(new sC(r.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,r))}function h0(t){return"function"==typeof t}function N2(t){return t instanceof Ww||"EmptyError"===t?.name}const aC=Symbol("INITIAL_VALUE");function Ey(){return Pd(t=>PI(t.map(n=>n.pipe(kd(1),yw(aC)))).pipe(Vn(n=>{for(const e of n)if(!0!==e){if(e===aC)return aC;if(!1===e||e instanceof Pf)return e}return!0}),Js(n=>n!==aC),kd(1)))}function vF(t){return function na(...t){return Vs(t)}(Ts(n=>{if(Sg(n))throw hF(0,n)}),Vn(n=>!0===n))}const z2={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function bF(t,n,e,o,r){const s=B2(t,n,e);return s.matched?function vW(t,n,e,o){const r=n.canMatch;return r&&0!==r.length?Yn(r.map(l=>{const h=Sy(l,t);return Af(function lW(t){return t&&h0(t.canMatch)}(h)?h.canMatch(n,e):t.runInContext(()=>h(n,e)))})).pipe(Ey(),vF()):Yn(!0)}(o=gF(n,o),n,e).pipe(Vn(l=>!0===l?s:{...z2})):Yn(s)}function B2(t,n,e){if(""===n.path)return"full"===n.pathMatch&&(t.hasChildren()||e.length>0)?{...z2}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const r=(n.matcher||JG)(e,t,n);if(!r)return{...z2};const s={};ea(r.posParams,(h,f)=>{s[f]=h.path});const l=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:l,positionalParamSegments:r.posParams??{}}}function lC(t,n,e,o){if(e.length>0&&function wW(t,n,e){return e.some(o=>cC(t,n,o)&&Ec(o)!==Li)}(t,e,o)){const s=new eo(n,function xW(t,n,e,o){const r={};r[Li]=o,o._sourceSegment=t,o._segmentIndexShift=n.length;for(const s of e)if(""===s.path&&Ec(s)!==Li){const l=new eo([],{});l._sourceSegment=t,l._segmentIndexShift=n.length,r[Ec(s)]=l}return r}(t,n,o,new eo(e,t.children)));return s._sourceSegment=t,s._segmentIndexShift=n.length,{segmentGroup:s,slicedSegments:[]}}if(0===e.length&&function CW(t,n,e){return e.some(o=>cC(t,n,o))}(t,e,o)){const s=new eo(t.segments,function bW(t,n,e,o,r){const s={};for(const l of o)if(cC(t,e,l)&&!r[Ec(l)]){const h=new eo([],{});h._sourceSegment=t,h._segmentIndexShift=n.length,s[Ec(l)]=h}return{...r,...s}}(t,n,e,o,t.children));return s._sourceSegment=t,s._segmentIndexShift=n.length,{segmentGroup:s,slicedSegments:e}}const r=new eo(t.segments,t.children);return r._sourceSegment=t,r._segmentIndexShift=n.length,{segmentGroup:r,slicedSegments:e}}function cC(t,n,e){return(!(t.hasChildren()||n.length>0)||"full"!==e.pathMatch)&&""===e.path}function xF(t,n,e,o){return!!(Ec(t)===o||o!==Li&&cC(n,e,t))&&("**"===t.path||B2(n,t,e).matched)}function wF(t,n,e){return 0===n.length&&!t.children[e]}const uC=!1;class dC{constructor(n){this.segmentGroup=n||null}}class CF{constructor(n){this.urlTree=n}}function p0(t){return gy(new dC(t))}function TF(t){return gy(new CF(t))}class IW{constructor(n,e,o,r,s){this.injector=n,this.configLoader=e,this.urlSerializer=o,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const n=lC(this.urlTree.root,[],[],this.config).segmentGroup,e=new eo(n.segments,n.children);return this.expandSegmentGroup(this.injector,this.config,e,Li).pipe(Vn(s=>this.createUrlTree(eC(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Wh(s=>{if(s instanceof CF)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof dC?this.noMatchError(s):s}))}match(n){return this.expandSegmentGroup(this.injector,this.config,n.root,Li).pipe(Vn(r=>this.createUrlTree(eC(r),n.queryParams,n.fragment))).pipe(Wh(r=>{throw r instanceof dC?this.noMatchError(r):r}))}noMatchError(n){return new It(4002,uC)}createUrlTree(n,e,o){const r=w2(n);return new Pf(r,e,o)}expandSegmentGroup(n,e,o,r){return 0===o.segments.length&&o.hasChildren()?this.expandChildren(n,e,o).pipe(Vn(s=>new eo([],s))):this.expandSegment(n,o,e,o.segments,r,!0)}expandChildren(n,e,o){const r=[];for(const s of Object.keys(o.children))"primary"===s?r.unshift(s):r.push(s);return er(r).pipe(Sf(s=>{const l=o.children[s],h=_F(e,s);return this.expandSegmentGroup(n,h,l,s).pipe(Vn(f=>({segment:f,outlet:s})))}),zR((s,l)=>(s[l.outlet]=l.segment,s),{}),BR())}expandSegment(n,e,o,r,s,l){return er(o).pipe(Sf(h=>this.expandSegmentAgainstRoute(n,e,o,h,r,s,l).pipe(Wh(y=>{if(y instanceof dC)return Yn(null);throw y}))),kf(h=>!!h),Wh((h,f)=>{if(N2(h))return wF(e,r,s)?Yn(new eo([],{})):p0(e);throw h}))}expandSegmentAgainstRoute(n,e,o,r,s,l,h){return xF(r,e,s,l)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(n,e,r,s,l):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,e,o,r,s,l):p0(e):p0(e)}expandSegmentAgainstRouteUsingRedirect(n,e,o,r,s,l){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,o,r,l):this.expandRegularSegmentAgainstRouteUsingRedirect(n,e,o,r,s,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,e,o,r){const s=this.applyRedirectCommands([],o.redirectTo,{});return o.redirectTo.startsWith("/")?TF(s):this.lineralizeSegments(o,s).pipe(Et(l=>{const h=new eo(l,{});return this.expandSegment(n,h,e,l,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,e,o,r,s,l){const{matched:h,consumedSegments:f,remainingSegments:y,positionalParamSegments:C}=B2(e,r,s);if(!h)return p0(e);const D=this.applyRedirectCommands(f,r.redirectTo,C);return r.redirectTo.startsWith("/")?TF(D):this.lineralizeSegments(r,D).pipe(Et(R=>this.expandSegment(n,e,o,R.concat(y),l,!1)))}matchSegmentAgainstRoute(n,e,o,r,s){return"**"===o.path?(n=gF(o,n),o.loadChildren?(o._loadedRoutes?Yn({routes:o._loadedRoutes,injector:o._loadedInjector}):this.configLoader.loadChildren(n,o)).pipe(Vn(h=>(o._loadedRoutes=h.routes,o._loadedInjector=h.injector,new eo(r,{})))):Yn(new eo(r,{}))):bF(e,o,r,n).pipe(Pd(({matched:l,consumedSegments:h,remainingSegments:f})=>l?this.getChildConfig(n=o._injector??n,o,r).pipe(Et(C=>{const D=C.injector??n,R=C.routes,{segmentGroup:V,slicedSegments:$}=lC(e,h,f,R),X=new eo(V.segments,V.children);if(0===$.length&&X.hasChildren())return this.expandChildren(D,R,X).pipe(Vn(_e=>new eo(h,_e)));if(0===R.length&&0===$.length)return Yn(new eo(h,{}));const ee=Ec(o)===s;return this.expandSegment(D,X,R,$,ee?Li:s,!0).pipe(Vn(fe=>new eo(h.concat(fe.segments),fe.children)))})):p0(e)))}getChildConfig(n,e,o){return e.children?Yn({routes:e.children,injector:n}):e.loadChildren?void 0!==e._loadedRoutes?Yn({routes:e._loadedRoutes,injector:e._loadedInjector}):function yW(t,n,e,o){const r=n.canLoad;return void 0===r||0===r.length?Yn(!0):Yn(r.map(l=>{const h=Sy(l,t);return Af(function oW(t){return t&&h0(t.canLoad)}(h)?h.canLoad(n,e):t.runInContext(()=>h(n,e)))})).pipe(Ey(),vF())}(n,e,o).pipe(Et(r=>r?this.configLoader.loadChildren(n,e).pipe(Ts(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):function SW(t){return gy(pF(uC,3))}())):Yn({routes:[],injector:n})}lineralizeSegments(n,e){let o=[],r=e.root;for(;;){if(o=o.concat(r.segments),0===r.numberOfChildren)return Yn(o);if(r.numberOfChildren>1||!r.children[Li])return n.redirectTo,gy(new It(4e3,uC));r=r.children[Li]}}applyRedirectCommands(n,e,o){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),n,o)}applyRedirectCreateUrlTree(n,e,o,r){const s=this.createSegmentGroup(n,e.root,o,r);return new Pf(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){const o={};return ea(n,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const h=r.substring(1);o[s]=e[h]}else o[s]=r}),o}createSegmentGroup(n,e,o,r){const s=this.createSegments(n,e.segments,o,r);let l={};return ea(e.children,(h,f)=>{l[f]=this.createSegmentGroup(n,h,o,r)}),new eo(s,l)}createSegments(n,e,o,r){return e.map(s=>s.path.startsWith(":")?this.findPosParam(n,s,r):this.findOrReturn(s,o))}findPosParam(n,e,o){const r=o[e.path.substring(1)];if(!r)throw new It(4001,uC);return r}findOrReturn(n,e){let o=0;for(const r of e){if(r.path===n.path)return e.splice(o),r;o++}return n}}class MW{}class PW{constructor(n,e,o,r,s,l,h){this.injector=n,this.rootComponentType=e,this.config=o,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=l,this.urlSerializer=h}recognize(){const n=lC(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,Li).pipe(Vn(e=>{if(null===e)return null;const o=new iC([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Li,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Xh(o,e),s=new uF(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(n){const e=n.value,o=cF(e,this.paramsInheritanceStrategy);e.params=Object.freeze(o.params),e.data=Object.freeze(o.data),n.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(n,e,o,r){return 0===o.segments.length&&o.hasChildren()?this.processChildren(n,e,o):this.processSegment(n,e,o,o.segments,r)}processChildren(n,e,o){return er(Object.keys(o.children)).pipe(Sf(r=>{const s=o.children[r],l=_F(e,r);return this.processSegmentGroup(n,l,s,r)}),zR((r,s)=>r&&s?(r.push(...s),r):null),function YG(t,n=!1){return Ki((e,o)=>{let r=0;e.subscribe(ii(o,s=>{const l=t(s,r++);(l||n)&&o.next(s),!l&&o.complete()}))})}(r=>null!==r),qw(null),BR(),Vn(r=>{if(null===r)return null;const s=EF(r);return function OW(t){t.sort((n,e)=>n.value.outlet===Li?-1:e.value.outlet===Li?1:n.value.outlet.localeCompare(e.value.outlet))}(s),s}))}processSegment(n,e,o,r,s){return er(e).pipe(Sf(l=>this.processSegmentAgainstRoute(l._injector??n,l,o,r,s)),kf(l=>!!l),Wh(l=>{if(N2(l))return wF(o,r,s)?Yn([]):Yn(null);throw l}))}processSegmentAgainstRoute(n,e,o,r,s){if(e.redirectTo||!xF(e,o,r,s))return Yn(null);let l;if("**"===e.path){const h=r.length>0?jR(r).parameters:{},f=DF(o)+r.length;l=Yn({snapshot:new iC(r,h,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,MF(e),Ec(e),e.component??e._loadedComponent??null,e,IF(o),f,kF(e)),consumedSegments:[],remainingSegments:[]})}else l=bF(o,e,r,n).pipe(Vn(({matched:h,consumedSegments:f,remainingSegments:y,parameters:C})=>{if(!h)return null;const D=DF(o)+f.length;return{snapshot:new iC(f,C,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,MF(e),Ec(e),e.component??e._loadedComponent??null,e,IF(o),D,kF(e)),consumedSegments:f,remainingSegments:y}}));return l.pipe(Pd(h=>{if(null===h)return Yn(null);const{snapshot:f,consumedSegments:y,remainingSegments:C}=h;n=e._injector??n;const D=e._loadedInjector??n,R=function LW(t){return t.children?t.children:t.loadChildren?t._loadedRoutes:[]}(e),{segmentGroup:V,slicedSegments:$}=lC(o,y,C,R.filter(ee=>void 0===ee.redirectTo));if(0===$.length&&V.hasChildren())return this.processChildren(D,R,V).pipe(Vn(ee=>null===ee?null:[new Xh(f,ee)]));if(0===R.length&&0===$.length)return Yn([new Xh(f,[])]);const X=Ec(e)===s;return this.processSegment(D,R,V,$,X?Li:s).pipe(Vn(ee=>null===ee?null:[new Xh(f,ee)]))}))}}function RW(t){const n=t.value.routeConfig;return n&&""===n.path&&void 0===n.redirectTo}function EF(t){const n=[],e=new Set;for(const o of t){if(!RW(o)){n.push(o);continue}const r=n.find(s=>o.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...o.children),e.add(r)):n.push(o)}for(const o of e){const r=EF(o.children);n.push(new Xh(o.value,r))}return n.filter(o=>!e.has(o))}function IF(t){let n=t;for(;n._sourceSegment;)n=n._sourceSegment;return n}function DF(t){let n=t,e=n._segmentIndexShift??0;for(;n._sourceSegment;)n=n._sourceSegment,e+=n._segmentIndexShift??0;return e-1}function MF(t){return t.data||{}}function kF(t){return t.resolve||{}}function AF(t){return"string"==typeof t.title||null===t.title}function V2(t){return Pd(n=>{const e=t(n);return e?er(e).pipe(Vn(()=>n)):Yn(n)})}const Iy=new cn("ROUTES");let U2=(()=>{class t{constructor(e,o){this.injector=e,this.compiler=o,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Yn(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const o=Af(e.loadComponent()).pipe(Vn(OF),Ts(s=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=s}),bw(()=>{this.componentLoaders.delete(e)})),r=new FR(o,()=>new si).pipe(_2());return this.componentLoaders.set(e,r),r}loadChildren(e,o){if(this.childrenLoaders.get(o))return this.childrenLoaders.get(o);if(o._loadedRoutes)return Yn({routes:o._loadedRoutes,injector:o._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(o);const s=this.loadModuleFactoryOrRoutes(o.loadChildren).pipe(Vn(h=>{this.onLoadEndListener&&this.onLoadEndListener(o);let f,y,C=!1;Array.isArray(h)?y=h:(f=h.create(e).injector,y=UR(f.get(Iy,[],Jn.Self|Jn.Optional)));return{routes:y.map(F2),injector:f}}),bw(()=>{this.childrenLoaders.delete(o)})),l=new FR(s,()=>new si).pipe(_2());return this.childrenLoaders.set(o,l),l}loadModuleFactoryOrRoutes(e){return Af(e()).pipe(Vn(OF),Et(r=>r instanceof Fk||Array.isArray(r)?Yn(r):er(this.compiler.compileModuleAsync(r))))}}return t.\u0275fac=function(e){return new(e||t)(Rt(Fs),Rt(TA))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function OF(t){return function $W(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let pC=(()=>{class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new si,this.configLoader=ai(U2),this.environmentInjector=ai(dc),this.urlSerializer=ai(t0),this.rootContexts=ai(l0),this.navigationId=0,this.afterPreactivation=()=>Yn(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new k9(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new M9(r))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const o=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:o})}setupNavigations(e){return this.transitions=new xc({id:0,targetPageId:0,currentUrlTree:e.currentUrlTree,currentRawUrl:e.currentUrlTree,extractedUrl:e.urlHandlingStrategy.extract(e.currentUrlTree),urlAfterRedirects:e.urlHandlingStrategy.extract(e.currentUrlTree),rawUrl:e.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:s0,restoredState:null,currentSnapshot:e.routerState.snapshot,targetSnapshot:null,currentRouterState:e.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Js(o=>0!==o.id),Vn(o=>({...o,extractedUrl:e.urlHandlingStrategy.extract(o.rawUrl)})),Pd(o=>{let r=!1,s=!1;return Yn(o).pipe(Ts(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Pd(l=>{const h=e.browserUrlTree.toString(),f=!e.navigated||l.extractedUrl.toString()!==h||h!==e.currentUrlTree.toString();if(!f&&"reload"!==(l.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const C="";return this.events.next(new nC(l.id,e.serializeUrl(o.rawUrl),C,0)),e.rawUrlTree=l.rawUrl,l.resolve(null),mn}if(e.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return LF(l.source)&&(e.browserUrlTree=l.extractedUrl),Yn(l).pipe(Pd(C=>{const D=this.transitions?.getValue();return this.events.next(new E2(C.id,this.urlSerializer.serialize(C.extractedUrl),C.source,C.restoredState)),D!==this.transitions?.getValue()?mn:Promise.resolve(C)}),function DW(t,n,e,o){return Pd(r=>function EW(t,n,e,o,r){return new IW(t,n,e,o,r).apply()}(t,n,e,r.extractedUrl,o).pipe(Vn(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,e.config),Ts(C=>{this.currentNavigation={...this.currentNavigation,finalUrl:C.urlAfterRedirects},o.urlAfterRedirects=C.urlAfterRedirects}),function NW(t,n,e,o,r){return Et(s=>function AW(t,n,e,o,r,s,l="emptyOnly"){return new PW(t,n,e,o,r,l,s).recognize().pipe(Pd(h=>null===h?function kW(t){return new ri(n=>n.error(t))}(new MW):Yn(h)))}(t,n,e,s.urlAfterRedirects,o.serialize(s.urlAfterRedirects),o,r).pipe(Vn(l=>({...s,targetSnapshot:l}))))}(this.environmentInjector,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),Ts(C=>{if(o.targetSnapshot=C.targetSnapshot,"eager"===e.urlUpdateStrategy){if(!C.extras.skipLocationChange){const R=e.urlHandlingStrategy.merge(C.urlAfterRedirects,C.rawUrl);e.setBrowserUrl(R,C)}e.browserUrlTree=C.urlAfterRedirects}const D=new T9(C.id,this.urlSerializer.serialize(C.extractedUrl),this.urlSerializer.serialize(C.urlAfterRedirects),C.targetSnapshot);this.events.next(D)}));if(f&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){const{id:C,extractedUrl:D,source:R,restoredState:V,extras:$}=l,X=new E2(C,this.urlSerializer.serialize(D),R,V);this.events.next(X);const ee=lF(D,this.rootComponentType).snapshot;return Yn(o={...l,targetSnapshot:ee,urlAfterRedirects:D,extras:{...$,skipLocationChange:!1,replaceUrl:!1}})}{const C="";return this.events.next(new nC(l.id,e.serializeUrl(o.extractedUrl),C,1)),e.rawUrlTree=l.rawUrl,l.resolve(null),mn}}),Ts(l=>{const h=new S9(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),Vn(l=>o={...l,guards:J9(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),function uW(t,n){return Et(e=>{const{targetSnapshot:o,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:l}}=e;return 0===l.length&&0===s.length?Yn({...e,guardsResult:!0}):function dW(t,n,e,o){return er(t).pipe(Et(r=>function _W(t,n,e,o,r){const s=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return s&&0!==s.length?Yn(s.map(h=>{const f=c0(n)??r,y=Sy(h,f);return Af(function aW(t){return t&&h0(t.canDeactivate)}(y)?y.canDeactivate(t,n,e,o):f.runInContext(()=>y(t,n,e,o))).pipe(kf())})).pipe(Ey()):Yn(!0)}(r.component,r.route,e,n,o)),kf(r=>!0!==r,!0))}(l,o,r,t).pipe(Et(h=>h&&function iW(t){return"boolean"==typeof t}(h)?function hW(t,n,e,o){return er(n).pipe(Sf(r=>gw(function fW(t,n){return null!==t&&n&&n(new A9(t)),Yn(!0)}(r.route.parent,o),function pW(t,n){return null!==t&&n&&n(new O9(t)),Yn(!0)}(r.route,o),function gW(t,n,e){const o=n[n.length-1],s=n.slice(0,n.length-1).reverse().map(l=>function eW(t){const n=t.routeConfig?t.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:t,guards:n}:null}(l)).filter(l=>null!==l).map(l=>RR(()=>Yn(l.guards.map(f=>{const y=c0(l.node)??e,C=Sy(f,y);return Af(function sW(t){return t&&h0(t.canActivateChild)}(C)?C.canActivateChild(o,t):y.runInContext(()=>C(o,t))).pipe(kf())})).pipe(Ey())));return Yn(s).pipe(Ey())}(t,r.path,e),function mW(t,n,e){const o=n.routeConfig?n.routeConfig.canActivate:null;if(!o||0===o.length)return Yn(!0);const r=o.map(s=>RR(()=>{const l=c0(n)??e,h=Sy(s,l);return Af(function rW(t){return t&&h0(t.canActivate)}(h)?h.canActivate(n,t):l.runInContext(()=>h(n,t))).pipe(kf())}));return Yn(r).pipe(Ey())}(t,r.route,e))),kf(r=>!0!==r,!0))}(o,s,t,n):Yn(h)),Vn(h=>({...e,guardsResult:h})))})}(this.environmentInjector,l=>this.events.next(l)),Ts(l=>{if(o.guardsResult=l.guardsResult,Sg(l.guardsResult))throw hF(0,l.guardsResult);const h=new E9(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),Js(l=>!!l.guardsResult||(e.restoreHistory(l),this.cancelNavigationTransition(l,"",3),!1)),V2(l=>{if(l.guards.canActivateChecks.length)return Yn(l).pipe(Ts(h=>{const f=new I9(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}),Pd(h=>{let f=!1;return Yn(h).pipe(function zW(t,n){return Et(e=>{const{targetSnapshot:o,guards:{canActivateChecks:r}}=e;if(!r.length)return Yn(e);let s=0;return er(r).pipe(Sf(l=>function BW(t,n,e,o){const r=t.routeConfig,s=t._resolve;return void 0!==r?.title&&!AF(r)&&(s[Jb]=r.title),function VW(t,n,e,o){const r=function UW(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}(t);if(0===r.length)return Yn({});const s={};return er(r).pipe(Et(l=>function jW(t,n,e,o){const r=c0(n)??o,s=Sy(t,r);return Af(s.resolve?s.resolve(n,e):r.runInContext(()=>s(n,e)))}(t[l],n,e,o).pipe(kf(),Ts(h=>{s[l]=h}))),y2(1),v2(s),Wh(l=>N2(l)?mn:gy(l)))}(s,t,n,o).pipe(Vn(l=>(t._resolvedData=l,t.data=cF(t,e).resolve,r&&AF(r)&&(t.data[Jb]=r.title),null)))}(l.route,o,t,n)),Ts(()=>s++),y2(1),Et(l=>s===r.length?Yn(e):mn))})}(e.paramsInheritanceStrategy,this.environmentInjector),Ts({next:()=>f=!0,complete:()=>{f||(e.restoreHistory(h),this.cancelNavigationTransition(h,"",2))}}))}),Ts(h=>{const f=new D9(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}))}),V2(l=>{const h=f=>{const y=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&y.push(this.configLoader.loadComponent(f.routeConfig).pipe(Ts(C=>{f.component=C}),Vn(()=>{})));for(const C of f.children)y.push(...h(C));return y};return PI(h(l.targetSnapshot.root)).pipe(qw(),kd(1))}),V2(()=>this.afterPreactivation()),Vn(l=>{const h=function j9(t,n,e){const o=a0(t,n._root,e?e._root:void 0);return new aF(o,n)}(e.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return o={...l,targetRouterState:h}}),Ts(l=>{e.currentUrlTree=l.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(l.urlAfterRedirects,l.rawUrl),e.routerState=l.targetRouterState,"deferred"===e.urlUpdateStrategy&&(l.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,l),e.browserUrlTree=l.urlAfterRedirects)}),((t,n,e)=>Vn(o=>(new Q9(n,o.targetRouterState,o.currentRouterState,e).activate(t),o)))(this.rootContexts,e.routeReuseStrategy,l=>this.events.next(l)),Ts({next:l=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,e.navigated=!0,this.events.next(new Eg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(e.currentUrlTree))),e.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{r=!0}}),bw(()=>{r||s||this.cancelNavigationTransition(o,"",1),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Wh(l=>{if(s=!0,mF(l)){fF(l)||(e.navigated=!0,e.restoreHistory(o,!0));const h=new tC(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode);if(this.events.next(h),fF(l)){const f=e.urlHandlingStrategy.merge(l.url,e.rawUrlTree),y={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy||LF(o.source)};e.scheduleNavigation(f,s0,null,y,{resolve:o.resolve,reject:o.reject,promise:o.promise})}else o.resolve(!1)}else{e.restoreHistory(o,!0);const h=new I2(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0);this.events.next(h);try{o.resolve(e.errorHandler(l))}catch(f){o.reject(f)}}return mn}))}))}cancelNavigationTransition(e,o,r){const s=new tC(e.id,this.urlSerializer.serialize(e.extractedUrl),o,r);this.events.next(s),e.resolve(!1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function LF(t){return t!==s0}let RF=(()=>{class t{buildTitle(e){let o,r=e.root;for(;void 0!==r;)o=this.getResolvedTitleForRoute(r)??o,r=r.children.find(s=>s.outlet===Li);return o}getResolvedTitleForRoute(e){return e.data[Jb]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:function(){return ai(GW)},providedIn:"root"}),t})(),GW=(()=>{class t extends RF{constructor(e){super(),this.title=e}updateTitle(e){const o=this.buildTitle(e);void 0!==o&&this.title.setTitle(o)}}return t.\u0275fac=function(e){return new(e||t)(Rt(_c))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),WW=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:function(){return ai(ZW)},providedIn:"root"}),t})();class qW{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}}let ZW=(()=>{class t extends qW{}return t.\u0275fac=function(){let n;return function(o){return(n||(n=Or(t)))(o||t)}}(),t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const fC=new cn("",{providedIn:"root",factory:()=>({})});let XW=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:function(){return ai(YW)},providedIn:"root"}),t})(),YW=(()=>{class t{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,o){return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function QW(t){throw t}function JW(t,n,e){return n.parse("/")}const eq={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},tq={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ss=(()=>{class t{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=ai(KV),this.isNgZoneEnabled=!1,this.options=ai(fC,{optional:!0})||{},this.errorHandler=this.options.errorHandler||QW,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||JW,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=ai(XW),this.routeReuseStrategy=ai(WW),this.urlCreationStrategy=ai(B9),this.titleStrategy=ai(RF),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=UR(ai(Iy,{optional:!0})??[]),this.navigationTransitions=ai(pC),this.urlSerializer=ai(t0),this.location=ai(V1),this.isNgZoneEnabled=ai(yi)instanceof yi&&yi.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Pf,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=lF(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),s0,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const o="popstate"===e.type?"popstate":"hashchange";"popstate"===o&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,o,e.state)},0)}))}navigateToSyncWithBrowser(e,o,r){const s={replaceUrl:!0},l=r?.navigationId?r:null;if(r){const f={...r};delete f.navigationId,delete f.\u0275routerPageId,0!==Object.keys(f).length&&(s.state=f)}const h=this.parseUrl(e);this.scheduleNavigation(h,o,l,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(e){this.config=e.map(F2),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,o={}){const{relativeTo:r,queryParams:s,fragment:l,queryParamsHandling:h,preserveFragment:f}=o,y=f?this.currentUrlTree.fragment:l;let C=null;switch(h){case"merge":C={...this.currentUrlTree.queryParams,...s};break;case"preserve":C=this.currentUrlTree.queryParams;break;default:C=s||null}return null!==C&&(C=this.removeEmptyProps(C)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,e,C,y??null)}navigateByUrl(e,o={skipLocationChange:!1}){const r=Sg(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,s0,null,o)}navigate(e,o={skipLocationChange:!1}){return function nq(t){for(let n=0;n<t.length;n++){const e=t[n];if(null==e)throw new It(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,o),o)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let o;try{o=this.urlSerializer.parse(e)}catch(r){o=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return o}isActive(e,o){let r;if(r=!0===o?{...eq}:!1===o?{...tq}:o,Sg(e))return $R(this.currentUrlTree,e,r);const s=this.parseUrl(e);return $R(this.currentUrlTree,s,r)}removeEmptyProps(e){return Object.keys(e).reduce((o,r)=>{const s=e[r];return null!=s&&(o[r]=s),o},{})}scheduleNavigation(e,o,r,s,l){if(this.disposed)return Promise.resolve(!1);let h,f,y,C;return l?(h=l.resolve,f=l.reject,y=l.promise):y=new Promise((D,R)=>{h=D,f=R}),C="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:C,source:o,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:s,resolve:h,reject:f,promise:y,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),y.catch(D=>Promise.reject(D))}setBrowserUrl(e,o){const r=this.urlSerializer.serialize(e),s={...o.extras.state,...this.generateNgRouterState(o.id,o.targetPageId)};this.location.isCurrentPathEqualTo(r)||o.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(e,o=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(o&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,o){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:o}:{navigationId:e}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Qh=(()=>{class t{constructor(e,o,r,s,l,h){this.router=e,this.route=o,this.tabIndexAttribute=r,this.renderer=s,this.el=l,this.locationStrategy=h,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new si;const f=l.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===f||"area"===f,this.isAnchorElement?this.subscription=e.events.subscribe(y=>{y instanceof Eg&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=cy(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=cy(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=cy(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,o,r,s,l){return!!(null===this.urlTree||this.isAnchorElement&&(0!==e||o||r||s||l||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const e=null===this.href?null:function Ax(t,n,e){return function k_(t,n){return"src"===n&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===n&&("base"===t||"link"===t)?kx:Ui}(n,e)(t)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",e)}applyAttributeValue(e,o){const r=this.renderer,s=this.el.nativeElement;null!==o?r.setAttribute(s,e,o):r.removeAttribute(s,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return t.\u0275fac=function(e){return new(e||t)(ce(Ss),ce(Yh),Bp("tabindex"),ce(Jr),ce(gi),ce(mg))},t.\u0275dir=On({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(e,o){1&e&&Te("click",function(s){return o.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&e&&at("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[_r]}),t})(),FF=(()=>{class t{get isActive(){return this._isActive}constructor(e,o,r,s,l){this.router=e,this.element=o,this.renderer=r,this.cdr=s,this.link=l,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new ht,this.routerEventsSubscription=e.events.subscribe(h=>{h instanceof Eg&&this.update()})}ngAfterContentInit(){Yn(this.links.changes,Yn(null)).pipe(Mn()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const e=[...this.links.toArray(),this.link].filter(o=>!!o).map(o=>o.onChanges);this.linkInputChangesSubscription=er(e).pipe(Mn()).subscribe(o=>{this._isActive!==this.isLinkActive(this.router)(o)&&this.update()})}set routerLinkActive(e){const o=Array.isArray(e)?e:e.split(" ");this.classes=o.filter(r=>!!r)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||Promise.resolve().then(()=>{const e=this.hasActiveLinks();this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.classes.forEach(o=>{e?this.renderer.addClass(this.element.nativeElement,o):this.renderer.removeClass(this.element.nativeElement,o)}),e&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(e))})}isLinkActive(e){const o=function iq(t){return!!t.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>!!r.urlTree&&e.isActive(r.urlTree,o)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}}return t.\u0275fac=function(e){return new(e||t)(ce(Ss),ce(gi),ce(Jr),ce(Fo),ce(Qh,8))},t.\u0275dir=On({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(e,o,r){if(1&e&&Bo(r,Qh,5),2&e){let s;gn(s=_n())&&(o.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[_r]}),t})();class NF{}let oq=(()=>{class t{constructor(e,o,r,s,l){this.router=e,this.injector=r,this.preloadingStrategy=s,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(Js(e=>e instanceof Eg),Sf(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,o){const r=[];for(const s of o){s.providers&&!s._injector&&(s._injector=I1(s.providers,e,`Route: ${s.path}`));const l=s._injector??e,h=s._loadedInjector??l;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(l,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(h,s.children??s._loadedRoutes))}return er(r).pipe(Mn())}preloadConfig(e,o){return this.preloadingStrategy.preload(o,()=>{let r;r=o.loadChildren&&void 0===o.canLoad?this.loader.loadChildren(e,o):Yn(null);const s=r.pipe(Et(l=>null===l?Yn(void 0):(o._loadedRoutes=l.routes,o._loadedInjector=l.injector,this.processRoutes(l.injector??e,l.routes))));return o.loadComponent&&!o._loadedComponent?er([s,this.loader.loadComponent(o)]).pipe(Mn()):s})}}return t.\u0275fac=function(e){return new(e||t)(Rt(Ss),Rt(TA),Rt(dc),Rt(NF),Rt(U2))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const H2=new cn("");let zF=(()=>{class t{constructor(e,o,r,s,l={}){this.urlSerializer=e,this.transitions=o,this.viewportScroller=r,this.zone=s,this.options=l,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},l.scrollPositionRestoration=l.scrollPositionRestoration||"disabled",l.anchorScrolling=l.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof E2?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Eg&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof rF&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,o){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new rF(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,o))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return t.\u0275fac=function(e){Nh()},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})();var Ul=(()=>((Ul=Ul||{})[Ul.COMPLETE=0]="COMPLETE",Ul[Ul.FAILED=1]="FAILED",Ul[Ul.REDIRECTING=2]="REDIRECTING",Ul))();const Dy=!1;function Of(t,n){return{\u0275kind:t,\u0275providers:n}}const $2=new cn("",{providedIn:"root",factory:()=>!1});function VF(){const t=ai(Fs);return n=>{const e=t.get(Ib);if(n!==e.components[0])return;const o=t.get(Ss),r=t.get(UF);1===t.get(G2)&&o.initialNavigation(),t.get(jF,null,Jn.Optional)?.setUpPreloading(),t.get(H2,null,Jn.Optional)?.init(),o.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.unsubscribe())}}const UF=new cn(Dy?"bootstrap done indicator":"",{factory:()=>new si}),G2=new cn(Dy?"initial navigation":"",{providedIn:"root",factory:()=>1});function cq(){let t=[];return t=Dy?[{provide:Hm,multi:!0,useFactory:()=>{const n=ai(Ss);return()=>n.events.subscribe(e=>{console.group?.(`Router Event: ${e.constructor.name}`),console.log(function R9(t){if(!("type"in t))return`Unknown Router Event: ${t.constructor.name}`;switch(t.type){case 14:return`ActivationEnd(path: '${t.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${t.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${t.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${t.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state}, shouldActivate: ${t.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 2:return`NavigationCancel(id: ${t.id}, url: '${t.url}')`;case 16:return`NavigationSkipped(id: ${t.id}, url: '${t.url}')`;case 1:return`NavigationEnd(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${t.id}, url: '${t.url}', error: ${t.error})`;case 0:return`NavigationStart(id: ${t.id}, url: '${t.url}')`;case 6:return`ResolveEnd(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 5:return`ResolveStart(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 10:return`RouteConfigLoadEnd(path: ${t.route.path})`;case 9:return`RouteConfigLoadStart(path: ${t.route.path})`;case 4:return`RoutesRecognized(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 15:return`Scroll(anchor: '${t.anchor}', position: '${t.position?`${t.position[0]}, ${t.position[1]}`:null}')`}}(e)),console.log(e),console.groupEnd?.()})}}]:[],Of(1,t)}const jF=new cn(Dy?"router preloader":"");function uq(t){return Of(0,[{provide:jF,useExisting:oq},{provide:NF,useExisting:t}])}const f0=!1,HF=new cn(f0?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),dq=[V1,{provide:t0,useClass:b2},Ss,l0,{provide:Yh,useFactory:function BF(t){return t.routerState.root},deps:[Ss]},U2,f0?{provide:$2,useValue:!0}:[]];function hq(){return new PA("Router",Ss)}let Ic=(()=>{class t{constructor(e){}static forRoot(e,o){return{ngModule:t,providers:[dq,f0&&o?.enableTracing?cq().\u0275providers:[],{provide:Iy,multi:!0,useValue:e},{provide:HF,useFactory:gq,deps:[[Ss,new rc,new sc]]},{provide:fC,useValue:o||{}},o?.useHash?{provide:mg,useClass:FU}:{provide:mg,useClass:tP},{provide:H2,useFactory:()=>{const t=ai(tj),n=ai(yi),e=ai(fC),o=ai(pC),r=ai(t0);return e.scrollOffset&&t.setOffset(e.scrollOffset),new zF(r,o,t,n,e)}},o?.preloadingStrategy?uq(o.preloadingStrategy).\u0275providers:[],{provide:PA,multi:!0,useFactory:hq},o?.initialNavigation?_q(o):[],[{provide:$F,useFactory:VF},{provide:AA,multi:!0,useExisting:$F}]]}}static forChild(e){return{ngModule:t,providers:[{provide:Iy,multi:!0,useValue:e}]}}}return t.\u0275fac=function(e){return new(e||t)(Rt(HF,8))},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[L2]}),t})();function gq(t){if(f0&&t)throw new It(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function _q(t){return["disabled"===t.initialNavigation?Of(3,[{provide:P1,multi:!0,useFactory:()=>{const n=ai(Ss);return()=>{n.setUpLocationChangeListener()}}},{provide:G2,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?Of(2,[{provide:G2,useValue:0},{provide:P1,multi:!0,deps:[Fs],useFactory:n=>{const e=n.get(LU,Promise.resolve());return()=>e.then(()=>new Promise(o=>{const r=n.get(Ss),s=n.get(UF);(function rq(t,n){t.events.pipe(Js(e=>e instanceof Eg||e instanceof tC||e instanceof I2||e instanceof nC),Vn(e=>e instanceof Eg||e instanceof nC?Ul.COMPLETE:e instanceof tC&&(0===e.code||1===e.code)?Ul.REDIRECTING:Ul.FAILED),Js(e=>e!==Ul.REDIRECTING),kd(1)).subscribe(()=>{n()})})(r,()=>{o(!0)}),n.get(pC).afterPreactivation=()=>(o(!0),s.closed?Yn(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const $F=new cn(f0?"Router Initializer":"");function GF(t,n,e,o,r,s,l){try{var h=t[s](l),f=h.value}catch(y){return void e(y)}h.done?n(f):Promise.resolve(f).then(o,r)}function Ft(t){return function(){var n=this,e=arguments;return new Promise(function(o,r){var s=t.apply(n,e);function l(f){GF(s,o,r,l,h,"next",f)}function h(f){GF(s,o,r,l,h,"throw",f)}l(void 0)})}}const vq=["addListener","removeListener"],bq=["addEventListener","removeEventListener"],xq=["on","off"];function m0(t,n,e,o){if(vt(e)&&(o=e,e=void 0),o)return m0(t,n,e).pipe(uI(o));const[r,s]=function Tq(t){return vt(t.addEventListener)&&vt(t.removeEventListener)}(t)?bq.map(l=>h=>t[l](n,h,e)):function wq(t){return vt(t.addListener)&&vt(t.removeListener)}(t)?vq.map(WF(t,n)):function Cq(t){return vt(t.on)&&vt(t.off)}(t)?xq.map(WF(t,n)):[];if(!r&&Vu(t))return Et(l=>m0(l,n,e))(ne(t));if(!r)throw new TypeError("Invalid event target");return new ri(l=>{const h=(...f)=>l.next(1<f.length?f:f[0]);return r(h),()=>s(h)})}function WF(t,n){return e=>o=>t[e](n,o)}const g0={schedule(t){let n=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:o}=g0;o&&(n=o.requestAnimationFrame,e=o.cancelAnimationFrame);const r=n(s=>{e=void 0,t(s)});return new se(()=>e?.(r))},requestAnimationFrame(...t){const{delegate:n}=g0;return(n?.requestAnimationFrame||requestAnimationFrame)(...t)},cancelAnimationFrame(...t){const{delegate:n}=g0;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...t)},delegate:void 0};new class Eq extends LI{flush(n){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:o}=this;let r;n=n||o.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=o[0])&&n.id===e&&o.shift());if(this._active=!1,r){for(;(n=o[0])&&n.id===e&&o.shift();)n.unsubscribe();throw r}}}(class Sq extends OI{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,o=0){return null!==o&&o>0?super.requestAsyncId(n,e,o):(n.actions.push(this),n._scheduled||(n._scheduled=g0.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,e,o=0){var r;if(null!=o?o>0:this.delay>0)return super.recycleAsyncId(n,e,o);const{actions:s}=n;null!=e&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==e&&(g0.cancelAnimationFrame(e),n._scheduled=void 0)}});let W2,Dq=1;const mC={};function qF(t){return t in mC&&(delete mC[t],!0)}const Mq={setImmediate(t){const n=Dq++;return mC[n]=!0,W2||(W2=Promise.resolve()),W2.then(()=>qF(n)&&t()),n},clearImmediate(t){qF(t)}},{setImmediate:kq,clearImmediate:Aq}=Mq,gC={setImmediate(...t){const{delegate:n}=gC;return(n?.setImmediate||kq)(...t)},clearImmediate(t){const{delegate:n}=gC;return(n?.clearImmediate||Aq)(t)},delegate:void 0};new class Oq extends LI{flush(n){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:o}=this;let r;n=n||o.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=o[0])&&n.id===e&&o.shift());if(this._active=!1,r){for(;(n=o[0])&&n.id===e&&o.shift();)n.unsubscribe();throw r}}}(class Pq extends OI{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,o=0){return null!==o&&o>0?super.requestAsyncId(n,e,o):(n.actions.push(this),n._scheduled||(n._scheduled=gC.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,e,o=0){var r;if(null!=o?o>0:this.delay>0)return super.recycleAsyncId(n,e,o);const{actions:s}=n;null!=e&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==e&&(gC.clearImmediate(e),n._scheduled=void 0)}});function ZF(t=0,n,e=I8){let o=-1;return null!=n&&(di(n)?e=n:o=n),new ri(r=>{let s=function Fq(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;s<0&&(s=0);let l=0;return e.schedule(function(){r.closed||(r.next(l++),0<=o?this.schedule(void 0,o):r.complete())},s)})}function KF(t,n=RI){return function Rq(t){return Ki((n,e)=>{let o=!1,r=null,s=null,l=!1;const h=()=>{if(s?.unsubscribe(),s=null,o){o=!1;const y=r;r=null,e.next(y)}l&&e.complete()},f=()=>{s=null,l&&e.complete()};n.subscribe(ii(e,y=>{o=!0,r=y,s||ne(t(y)).subscribe(s=ii(e,h,f))},()=>{l=!0,(!o||!s||s.closed)&&e.complete()}))})}(()=>ZF(t,n))}let q2=(()=>{class t{constructor(e,o,r){this._ngZone=e,this._platform=o,this._scrolled=new si,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const o=this.scrollContainers.get(e);o&&(o.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new ri(o=>{this._globalSubscription||this._addGlobalListener();const r=e>0?this._scrolled.pipe(KF(e)).subscribe(o):this._scrolled.subscribe(o);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Yn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,o)=>this.deregister(o)),this._scrolled.complete()}ancestorScrolled(e,o){const r=this.getAncestorScrollContainers(e);return this.scrolled(o).pipe(Js(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(e){const o=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,e)&&o.push(s)}),o}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,o){let r=py(o),s=e.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>m0(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.\u0275fac=function(e){return new(e||t)(Rt(yi),Rt(bc),Rt(uo,8))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),_0=(()=>{class t{constructor(e,o,r,s){this.elementRef=e,this.scrollDispatcher=o,this.ngZone=r,this.dir=s,this._destroyed=new si,this._elementScrolled=new ri(l=>this.ngZone.runOutsideAngular(()=>m0(this.elementRef.nativeElement,"scroll").pipe(wc(this._destroyed)).subscribe(l)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const o=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=r?e.end:e.start),null==e.right&&(e.right=r?e.start:e.end),null!=e.bottom&&(e.top=o.scrollHeight-o.clientHeight-e.bottom),r&&0!=Ub()?(null!=e.left&&(e.right=o.scrollWidth-o.clientWidth-e.left),2==Ub()?e.left=e.right:1==Ub()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=o.scrollWidth-o.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const o=this.elementRef.nativeElement;!function d8(){if(null==vg){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return vg=!1,vg;if("scrollBehavior"in document.documentElement.style)vg=!0;else{const t=Element.prototype.scrollTo;vg=!!t&&!/\{\s*\[native code\]\s*\}/.test(t.toString())}}return vg}()?(null!=e.top&&(o.scrollTop=e.top),null!=e.left&&(o.scrollLeft=e.left)):o.scrollTo(e)}measureScrollOffset(e){const o="left",r="right",s=this.elementRef.nativeElement;if("top"==e)return s.scrollTop;if("bottom"==e)return s.scrollHeight-s.clientHeight-s.scrollTop;const l=this.dir&&"rtl"==this.dir.value;return"start"==e?e=l?r:o:"end"==e&&(e=l?o:r),l&&2==Ub()?e==o?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:l&&1==Ub()?e==o?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:e==o?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(q2),ce(yi),ce(bL,8))},t.\u0275dir=On({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),t})(),Bq=(()=>{class t{constructor(e,o,r){this._platform=e,this._change=new si,this._changeListener=s=>{this._change.next(s)},this._document=r,o.runOutsideAngular(()=>{if(e.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:o,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+o,height:r,width:o}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,o=this._getWindow(),r=e.documentElement,s=r.getBoundingClientRect();return{top:-s.top||e.body.scrollTop||o.scrollY||r.scrollTop||0,left:-s.left||e.body.scrollLeft||o.scrollX||r.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(KF(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return t.\u0275fac=function(e){return new(e||t)(Rt(bc),Rt(yi),Rt(uo,8))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),XF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({}),t})();const _C=["*"],Vq=["content"];function Uq(t,n){if(1&t){const e=Ye();P(0,"div",2),Te("click",function(){return be(e),ve(U()._onBackdropClicked())}),N()}2&t&&Ro("mat-drawer-shown",U()._isShowingBackdrop())}function jq(t,n){1&t&&(P(0,"mat-drawer-content"),ro(1,2),N())}const Hq=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],$q=["mat-drawer","mat-drawer-content","*"];function Gq(t,n){if(1&t){const e=Ye();P(0,"div",2),Te("click",function(){return be(e),ve(U()._onBackdropClicked())}),N()}2&t&&Ro("mat-drawer-shown",U()._isShowingBackdrop())}function Wq(t,n){1&t&&(P(0,"mat-sidenav-content"),ro(1,2),N())}const qq=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],Zq=["mat-sidenav","mat-sidenav-content","*"],YF={transformDrawer:pl("transform",[Mw("open, open-instant",po({transform:"none",visibility:"visible"})),Mw("void",po({"box-shadow":"none",visibility:"hidden"})),qo("void => open-instant",$o("0ms")),qo("void <=> open, open-instant => void",$o("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},Xq=new cn("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Yq(){return!1}}),Z2=new cn("MAT_DRAWER_CONTAINER");let yC=(()=>{class t extends _0{constructor(e,o,r,s,l){super(r,s,l),this._changeDetectorRef=e,this._container=o}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return t.\u0275fac=function(e){return new(e||t)(ce(Fo),ce(Ei(()=>JF)),ce(gi),ce(q2),ce(yi))},t.\u0275cmp=Qt({type:t,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(e,o){2&e&&za("margin-left",o._container._contentMargins.left,"px")("margin-right",o._container._contentMargins.right,"px")},features:[zi([{provide:_0,useExisting:t}]),ji],ngContentSelectors:_C,decls:1,vars:0,template:function(e,o){1&e&&(hr(),ro(0))},encapsulation:2,changeDetection:0}),t})(),QF=(()=>{class t{get position(){return this._position}set position(e){(e="end"===e?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(e),this._position=e,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(e){this._disableClose=Eu(e)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(e){("true"===e||"false"===e||null==e)&&(e=Eu(e)),this._autoFocus=e}get opened(){return this._opened}set opened(e){this.toggle(Eu(e))}constructor(e,o,r,s,l,h,f,y){this._elementRef=e,this._focusTrapFactory=o,this._focusMonitor=r,this._platform=s,this._ngZone=l,this._interactivityChecker=h,this._doc=f,this._container=y,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new si,this._animationEnd=new si,this._animationState="void",this.openedChange=new ht(!0),this._openedStream=this.openedChange.pipe(Js(C=>C),Vn(()=>{})),this.openedStart=this._animationStarted.pipe(Js(C=>C.fromState!==C.toState&&0===C.toState.indexOf("open")),v2(void 0)),this._closedStream=this.openedChange.pipe(Js(C=>!C),Vn(()=>{})),this.closedStart=this._animationStarted.pipe(Js(C=>C.fromState!==C.toState&&"void"===C.toState),v2(void 0)),this._destroyed=new si,this.onPositionChanged=new ht,this._modeChanged=new si,this.openedChange.subscribe(C=>{C?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{m0(this._elementRef.nativeElement,"keydown").pipe(Js(C=>27===C.keyCode&&!this.disableClose&&!function x8(t,...n){return n.length?n.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}(C)),wc(this._destroyed)).subscribe(C=>this._ngZone.run(()=>{this.close(),C.stopPropagation(),C.preventDefault()}))}),this._animationEnd.pipe(tL((C,D)=>C.fromState===D.fromState&&C.toState===D.toState)).subscribe(C=>{const{fromState:D,toState:R}=C;(0===R.indexOf("open")&&"void"===D||"void"===R&&0===D.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(e,o){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{e.removeEventListener("blur",r),e.removeEventListener("mousedown",r),e.removeAttribute("tabindex")};e.addEventListener("blur",r),e.addEventListener("mousedown",r)})),e.focus(o)}_focusByCssSelector(e,o){let r=this._elementRef.nativeElement.querySelector(e);r&&this._forceFocus(r,o)}_takeFocus(){if(!this._focusTrap)return;const e=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(o=>{!o&&"function"==typeof this._elementRef.nativeElement.focus&&e.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(e){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,e):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const e=this._doc.activeElement;return!!e&&this._elementRef.nativeElement.contains(e)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(e){return this.toggle(!0,e)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(e=!this.opened,o){e&&o&&(this._openedVia=o);const r=this._setOpen(e,!e&&this._isFocusWithinDrawer(),this._openedVia||"program");return e||(this._openedVia=null),r}_setOpen(e,o,r){return this._opened=e,e?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",o&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(kd(1)).subscribe(l=>s(l?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(e){const o=this._elementRef.nativeElement,r=o.parentNode;"end"===e?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,o)),r.appendChild(o)):this._anchor&&this._anchor.parentNode.insertBefore(o,this._anchor)}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(G8),ce(_L),ce(bc),ce(yi),ce(dL),ce(uo,8),ce(Z2,8))},t.\u0275cmp=Qt({type:t,selectors:[["mat-drawer"]],viewQuery:function(e,o){if(1&e&&pi(Vq,5),2&e){let r;gn(r=_n())&&(o._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(e,o){1&e&&Cr("@transform.start",function(s){return o._animationStarted.next(s)})("@transform.done",function(s){return o._animationEnd.next(s)}),2&e&&(at("align",null),nE("@transform",o._animationState),Ro("mat-drawer-end","end"===o.position)("mat-drawer-over","over"===o.mode)("mat-drawer-push","push"===o.mode)("mat-drawer-side","side"===o.mode)("mat-drawer-opened",o.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:_C,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(e,o){1&e&&(hr(),P(0,"div",0,1),ro(2),N())},dependencies:[_0],encapsulation:2,data:{animation:[YF.transformDrawer]},changeDetection:0}),t})(),JF=(()=>{class t{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(e){this._autosize=Eu(e)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(e){this._backdropOverride=null==e?null:Eu(e)}get scrollable(){return this._userContent||this._content}constructor(e,o,r,s,l,h=!1,f){this._dir=e,this._element=o,this._ngZone=r,this._changeDetectorRef=s,this._animationMode=f,this._drawers=new D1,this.backdropClick=new ht,this._destroyed=new si,this._doCheckSubject=new si,this._contentMargins={left:null,right:null},this._contentMarginChanges=new si,e&&e.change.pipe(wc(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),l.change().pipe(wc(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=h}ngAfterContentInit(){this._allDrawers.changes.pipe(yw(this._allDrawers),wc(this._destroyed)).subscribe(e=>{this._drawers.reset(e.filter(o=>!o._container||o._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(yw(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(e=>{this._watchDrawerToggle(e),this._watchDrawerPosition(e),this._watchDrawerMode(e)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(sL(10),wc(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(e=>e.open())}close(){this._drawers.forEach(e=>e.close())}updateContentMargins(){let e=0,o=0;if(this._left&&this._left.opened)if("side"==this._left.mode)e+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();e+=r,o-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)o+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();o+=r,e-=r}e=e||null,o=o||null,(e!==this._contentMargins.left||o!==this._contentMargins.right)&&(this._contentMargins={left:e,right:o},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(e){e._animationStarted.pipe(Js(o=>o.fromState!==o.toState),wc(this._drawers.changes)).subscribe(o=>{"open-instant"!==o.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==e.mode&&e.openedChange.pipe(wc(this._drawers.changes)).subscribe(()=>this._setContainerClass(e.opened))}_watchDrawerPosition(e){e&&e.onPositionChanged.pipe(wc(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(kd(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(e){e&&e._modeChanged.pipe(wc(Lc(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(e){const o=this._element.nativeElement.classList,r="mat-drawer-container-has-open";e?o.add(r):o.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(e=>{"end"==e.position?this._end=e:this._start=e}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(e=>e&&!e.disableClose&&this._canHaveBackdrop(e)).forEach(e=>e._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(e){return"side"!==e.mode||!!this._backdropOverride}_isDrawerOpen(e){return null!=e&&e.opened}}return t.\u0275fac=function(e){return new(e||t)(ce(bL,8),ce(gi),ce(yi),ce(Fo),ce(Bq),ce(Xq),ce(ly,8))},t.\u0275cmp=Qt({type:t,selectors:[["mat-drawer-container"]],contentQueries:function(e,o,r){if(1&e&&(Bo(r,yC,5),Bo(r,QF,5)),2&e){let s;gn(s=_n())&&(o._content=s.first),gn(s=_n())&&(o._allDrawers=s)}},viewQuery:function(e,o){if(1&e&&pi(yC,5),2&e){let r;gn(r=_n())&&(o._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(e,o){2&e&&Ro("mat-drawer-container-explicit-backdrop",o._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[zi([{provide:Z2,useExisting:t}])],ngContentSelectors:$q,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,o){1&e&&(hr(Hq),W(0,Uq,1,2,"div",0),ro(1),ro(2,1),W(3,jq,2,0,"mat-drawer-content",1)),2&e&&(L("ngIf",o.hasBackdrop),F(3),L("ngIf",!o._content))},dependencies:[Xn,yC],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),t})(),K2=(()=>{class t extends yC{constructor(e,o,r,s,l){super(e,o,r,s,l)}}return t.\u0275fac=function(e){return new(e||t)(ce(Fo),ce(Ei(()=>e3)),ce(gi),ce(q2),ce(yi))},t.\u0275cmp=Qt({type:t,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(e,o){2&e&&za("margin-left",o._container._contentMargins.left,"px")("margin-right",o._container._contentMargins.right,"px")},features:[zi([{provide:_0,useExisting:t}]),ji],ngContentSelectors:_C,decls:1,vars:0,template:function(e,o){1&e&&(hr(),ro(0))},encapsulation:2,changeDetection:0}),t})(),X2=(()=>{class t extends QF{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(e){this._fixedInViewport=Eu(e)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(e){this._fixedTopGap=nL(e)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(e){this._fixedBottomGap=nL(e)}}return t.\u0275fac=function(){let n;return function(o){return(n||(n=Or(t)))(o||t)}}(),t.\u0275cmp=Qt({type:t,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(e,o){2&e&&(at("align",null),za("top",o.fixedInViewport?o.fixedTopGap:null,"px")("bottom",o.fixedInViewport?o.fixedBottomGap:null,"px"),Ro("mat-drawer-end","end"===o.position)("mat-drawer-over","over"===o.mode)("mat-drawer-push","push"===o.mode)("mat-drawer-side","side"===o.mode)("mat-drawer-opened",o.opened)("mat-sidenav-fixed",o.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[ji],ngContentSelectors:_C,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(e,o){1&e&&(hr(),P(0,"div",0,1),ro(2),N())},dependencies:[_0],encapsulation:2,data:{animation:[YF.transformDrawer]},changeDetection:0}),t})(),e3=(()=>{class t extends JF{}return t.\u0275fac=function(){let n;return function(o){return(n||(n=Or(t)))(o||t)}}(),t.\u0275cmp=Qt({type:t,selectors:[["mat-sidenav-container"]],contentQueries:function(e,o,r){if(1&e&&(Bo(r,K2,5),Bo(r,X2,5)),2&e){let s;gn(s=_n())&&(o._content=s.first),gn(s=_n())&&(o._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(e,o){2&e&&Ro("mat-drawer-container-explicit-backdrop",o._backdropOverride)},exportAs:["matSidenavContainer"],features:[zi([{provide:Z2,useExisting:t}]),ji],ngContentSelectors:Zq,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,o){1&e&&(hr(qq),W(0,Gq,1,2,"div",0),ro(1),ro(2,1),W(3,Wq,2,0,"mat-sidenav-content",1)),2&e&&(L("ngIf",o.hasBackdrop),F(3),L("ngIf",!o._content))},dependencies:[Xn,K2],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),t})(),Qq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Cc,XF,XF,Cc]}),t})();class xn{static equals(n,e,o){return o?this.resolveFieldData(n,o)===this.resolveFieldData(e,o):this.equalsByValue(n,e)}static equalsByValue(n,e){if(n===e)return!0;if(n&&e&&"object"==typeof n&&"object"==typeof e){var s,l,h,o=Array.isArray(n),r=Array.isArray(e);if(o&&r){if((l=n.length)!=e.length)return!1;for(s=l;0!=s--;)if(!this.equalsByValue(n[s],e[s]))return!1;return!0}if(o!=r)return!1;var f=this.isDate(n),y=this.isDate(e);if(f!=y)return!1;if(f&&y)return n.getTime()==e.getTime();var C=n instanceof RegExp,D=e instanceof RegExp;if(C!=D)return!1;if(C&&D)return n.toString()==e.toString();var R=Object.keys(n);if((l=R.length)!==Object.keys(e).length)return!1;for(s=l;0!=s--;)if(!Object.prototype.hasOwnProperty.call(e,R[s]))return!1;for(s=l;0!=s--;)if(!this.equalsByValue(n[h=R[s]],e[h]))return!1;return!0}return n!=n&&e!=e}static resolveFieldData(n,e){if(n&&e){if(this.isFunction(e))return e(n);if(-1==e.indexOf("."))return n[e];{let o=e.split("."),r=n;for(let s=0,l=o.length;s<l;++s){if(null==r)return null;r=r[o[s]]}return r}}return null}static isFunction(n){return!!(n&&n.constructor&&n.call&&n.apply)}static reorderArray(n,e,o){n&&e!==o&&(o>=n.length&&(o%=n.length,e%=n.length),n.splice(o,0,n.splice(e,1)[0]))}static insertIntoOrderedArray(n,e,o,r){if(o.length>0){let s=!1;for(let l=0;l<o.length;l++)if(this.findIndexInList(o[l],r)>e){o.splice(l,0,n),s=!0;break}s||o.push(n)}else o.push(n)}static findIndexInList(n,e){let o=-1;if(e)for(let r=0;r<e.length;r++)if(e[r]==n){o=r;break}return o}static contains(n,e){if(null!=n&&e&&e.length)for(let o of e)if(this.equals(n,o))return!0;return!1}static removeAccents(n){return n&&n.search(/[\xC0-\xFF]/g)>-1&&(n=n.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),n}static isDate(n){return"[object Date]"===Object.prototype.toString.call(n)}static isEmpty(n){return null==n||""===n||Array.isArray(n)&&0===n.length||!this.isDate(n)&&"object"==typeof n&&0===Object.keys(n).length}static isNotEmpty(n){return!this.isEmpty(n)}static compare(n,e,o,r=1){let s=-1;const l=this.isEmpty(n),h=this.isEmpty(e);return s=l&&h?0:l?r:h?-r:"string"==typeof n&&"string"==typeof e?n.localeCompare(e,o,{numeric:!0}):n<e?-1:n>e?1:0,s}static sort(n,e,o=1,r,s=1){return(1===s?o:s)*xn.compare(n,e,r,o)}static merge(n,e){if(null!=n||null!=e)return null!=n&&"object"!=typeof n||null!=e&&"object"!=typeof e?null!=n&&"string"!=typeof n||null!=e&&"string"!=typeof e?e||n:[n||"",e||""].join(" "):{...n||{},...e||{}}}}var t3=0;function Ig(){return"pr_id_"+ ++t3}var Ir=function Jq(){let t=[];const r=s=>s&&parseInt(s.style.zIndex,10)||0;return{get:r,set:(s,l,h)=>{l&&(l.style.zIndex=String(((s,l)=>{let h=t.length>0?t[t.length-1]:{key:s,value:l},f=h.value+(h.key===s?0:l)+1;return t.push({key:s,value:f}),f})(s,h)))},clear:s=>{s&&((s=>{t=t.filter(l=>l.value!==s)})(r(s)),s.style.zIndex="")},getCurrent:()=>t.length>0?t[t.length-1].value:0}}();const n3=["*"];var Lf=(()=>{return(t=Lf||(Lf={}))[t.ACCEPT=0]="ACCEPT",t[t.REJECT=1]="REJECT",t[t.CANCEL=2]="CANCEL",Lf;var t})();let Dg=(()=>{class t{constructor(){this.requireConfirmationSource=new si,this.acceptConfirmationSource=new si,this.requireConfirmation$=this.requireConfirmationSource.asObservable(),this.accept=this.acceptConfirmationSource.asObservable()}confirm(e){return this.requireConfirmationSource.next(e),this}close(){return this.requireConfirmationSource.next(null),this}onAccept(){this.acceptConfirmationSource.next(null)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})(),ta=(()=>{class t{}return t.STARTS_WITH="startsWith",t.CONTAINS="contains",t.NOT_CONTAINS="notContains",t.ENDS_WITH="endsWith",t.EQUALS="equals",t.NOT_EQUALS="notEquals",t.IN="in",t.LESS_THAN="lt",t.LESS_THAN_OR_EQUAL_TO="lte",t.GREATER_THAN="gt",t.GREATER_THAN_OR_EQUAL_TO="gte",t.BETWEEN="between",t.IS="is",t.IS_NOT="isNot",t.BEFORE="before",t.AFTER="after",t.DATE_IS="dateIs",t.DATE_IS_NOT="dateIsNot",t.DATE_BEFORE="dateBefore",t.DATE_AFTER="dateAfter",t})(),o3=(()=>{class t{}return t.AND="and",t.OR="or",t})(),Y2=(()=>{class t{constructor(){this.filters={startsWith:(e,o,r)=>{if(null==o||""===o.trim())return!0;if(null==e)return!1;let s=xn.removeAccents(o.toString()).toLocaleLowerCase(r);return xn.removeAccents(e.toString()).toLocaleLowerCase(r).slice(0,s.length)===s},contains:(e,o,r)=>{if(null==o||"string"==typeof o&&""===o.trim())return!0;if(null==e)return!1;let s=xn.removeAccents(o.toString()).toLocaleLowerCase(r);return-1!==xn.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(s)},notContains:(e,o,r)=>{if(null==o||"string"==typeof o&&""===o.trim())return!0;if(null==e)return!1;let s=xn.removeAccents(o.toString()).toLocaleLowerCase(r);return-1===xn.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(s)},endsWith:(e,o,r)=>{if(null==o||""===o.trim())return!0;if(null==e)return!1;let s=xn.removeAccents(o.toString()).toLocaleLowerCase(r),l=xn.removeAccents(e.toString()).toLocaleLowerCase(r);return-1!==l.indexOf(s,l.length-s.length)},equals:(e,o,r)=>null==o||"string"==typeof o&&""===o.trim()||null!=e&&(e.getTime&&o.getTime?e.getTime()===o.getTime():xn.removeAccents(e.toString()).toLocaleLowerCase(r)==xn.removeAccents(o.toString()).toLocaleLowerCase(r)),notEquals:(e,o,r)=>!(null==o||"string"==typeof o&&""===o.trim()||null!=e&&(e.getTime&&o.getTime?e.getTime()===o.getTime():xn.removeAccents(e.toString()).toLocaleLowerCase(r)==xn.removeAccents(o.toString()).toLocaleLowerCase(r))),in:(e,o)=>{if(null==o||0===o.length)return!0;for(let r=0;r<o.length;r++)if(xn.equals(e,o[r]))return!0;return!1},between:(e,o)=>null==o||null==o[0]||null==o[1]||null!=e&&(e.getTime?o[0].getTime()<=e.getTime()&&e.getTime()<=o[1].getTime():o[0]<=e&&e<=o[1]),lt:(e,o,r)=>null==o||null!=e&&(e.getTime&&o.getTime?e.getTime()<o.getTime():e<o),lte:(e,o,r)=>null==o||null!=e&&(e.getTime&&o.getTime?e.getTime()<=o.getTime():e<=o),gt:(e,o,r)=>null==o||null!=e&&(e.getTime&&o.getTime?e.getTime()>o.getTime():e>o),gte:(e,o,r)=>null==o||null!=e&&(e.getTime&&o.getTime?e.getTime()>=o.getTime():e>=o),is:(e,o,r)=>this.filters.equals(e,o,r),isNot:(e,o,r)=>this.filters.notEquals(e,o,r),before:(e,o,r)=>this.filters.lt(e,o,r),after:(e,o,r)=>this.filters.gt(e,o,r),dateIs:(e,o)=>null==o||null!=e&&e.toDateString()===o.toDateString(),dateIsNot:(e,o)=>null==o||null!=e&&e.toDateString()!==o.toDateString(),dateBefore:(e,o)=>null==o||null!=e&&e.getTime()<o.getTime(),dateAfter:(e,o)=>null==o||null!=e&&e.getTime()>o.getTime()}}filter(e,o,r,s,l){let h=[];if(e)for(let f of e)for(let y of o){let C=xn.resolveFieldData(f,y);if(this.filters[s](C,r,l)){h.push(f);break}}return h}register(e,o){this.filters[e]=o}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Rd=(()=>{class t{constructor(){this.messageSource=new si,this.clearSource=new si,this.messageObserver=this.messageSource.asObservable(),this.clearObserver=this.clearSource.asObservable()}add(e){e&&this.messageSource.next(e)}addAll(e){e&&e.length&&this.messageSource.next(e)}clear(e){this.clearSource.next(e||null)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})(),y0=(()=>{class t{constructor(){this.clickSource=new si,this.clickObservable=this.clickSource.asObservable()}add(e){e&&this.clickSource.next(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),fl=(()=>{class t{constructor(){this.ripple=!1,this.overlayOptions={},this.filterMatchModeOptions={text:[ta.STARTS_WITH,ta.CONTAINS,ta.NOT_CONTAINS,ta.ENDS_WITH,ta.EQUALS,ta.NOT_EQUALS],numeric:[ta.EQUALS,ta.NOT_EQUALS,ta.LESS_THAN,ta.LESS_THAN_OR_EQUAL_TO,ta.GREATER_THAN,ta.GREATER_THAN_OR_EQUAL_TO],date:[ta.DATE_IS,ta.DATE_IS_NOT,ta.DATE_BEFORE,ta.DATE_AFTER]},this.translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",emptyFilterMessage:"No results found"},this.zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100},this.translationSource=new si,this.translationObserver=this.translationSource.asObservable()}getTranslation(e){return this.translation[e]}setTranslation(e){this.translation={...this.translation,...e},this.translationSource.next(this.translation)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Q2=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["p-header"]],ngContentSelectors:n3,decls:1,vars:0,template:function(e,o){1&e&&(hr(),ro(0))},encapsulation:2}),t})(),vC=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["p-footer"]],ngContentSelectors:n3,decls:1,vars:0,template:function(e,o){1&e&&(hr(),ro(0))},encapsulation:2}),t})(),fo=(()=>{class t{constructor(e){this.template=e}getType(){return this.name}}return t.\u0275fac=function(e){return new(e||t)(ce(bu))},t.\u0275dir=On({type:t,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}}),t})(),hs=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})(),zr=(()=>{class t{}return t.STARTS_WITH="startsWith",t.CONTAINS="contains",t.NOT_CONTAINS="notContains",t.ENDS_WITH="endsWith",t.EQUALS="equals",t.NOT_EQUALS="notEquals",t.NO_FILTER="noFilter",t.LT="lt",t.LTE="lte",t.GT="gt",t.GTE="gte",t.IS="is",t.IS_NOT="isNot",t.BEFORE="before",t.AFTER="after",t.CLEAR="clear",t.APPLY="apply",t.MATCH_ALL="matchAll",t.MATCH_ANY="matchAny",t.ADD_RULE="addRule",t.REMOVE_RULE="removeRule",t.ACCEPT="accept",t.REJECT="reject",t.CHOOSE="choose",t.UPLOAD="upload",t.CANCEL="cancel",t.DAY_NAMES="dayNames",t.DAY_NAMES_SHORT="dayNamesShort",t.DAY_NAMES_MIN="dayNamesMin",t.MONTH_NAMES="monthNames",t.MONTH_NAMES_SHORT="monthNamesShort",t.FIRST_DAY_OF_WEEK="firstDayOfWeek",t.TODAY="today",t.WEEK_HEADER="weekHeader",t.WEAK="weak",t.MEDIUM="medium",t.STRONG="strong",t.PASSWORD_PROMPT="passwordPrompt",t.EMPTY_MESSAGE="emptyMessage",t.EMPTY_FILTER_MESSAGE="emptyFilterMessage",t})();const bC=class eZ{},Qn_mapboxKey="pk.eyJ1IjoicGlrYW5hY2hpIiwiYSI6ImNsZ2lhNXBxYTA0cjAzZ3B6ODRnbDh1bzgifQ.SiRwHYK3rG2bsNYGD1yQaQ",Qn_server="https://spotivibes-backend.up.railway.app/api";function r3(t,n){return function(){return t.apply(n,arguments)}}const{toString:s3}=Object.prototype,{getPrototypeOf:J2}=Object,eD=(t=Object.create(null),n=>{const e=s3.call(n);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())}),Jh=t=>(t=t.toLowerCase(),n=>eD(n)===t),xC=t=>n=>typeof n===t,{isArray:My}=Array,v0=xC("undefined");var t;const a3=Jh("ArrayBuffer"),iZ=xC("string"),Rf=xC("function"),l3=xC("number"),tD=t=>null!==t&&"object"==typeof t,wC=t=>{if("object"!==eD(t))return!1;const n=J2(t);return!(null!==n&&n!==Object.prototype&&null!==Object.getPrototypeOf(n)||Symbol.toStringTag in t||Symbol.iterator in t)},rZ=Jh("Date"),sZ=Jh("File"),aZ=Jh("Blob"),lZ=Jh("FileList"),dZ=Jh("URLSearchParams");function b0(t,n,{allOwnKeys:e=!1}={}){if(null===t||typeof t>"u")return;let o,r;if("object"!=typeof t&&(t=[t]),My(t))for(o=0,r=t.length;o<r;o++)n.call(null,t[o],o,t);else{const s=e?Object.getOwnPropertyNames(t):Object.keys(t),l=s.length;let h;for(o=0;o<l;o++)h=s[o],n.call(null,t[h],h,t)}}function c3(t,n){n=n.toLowerCase();const e=Object.keys(t);let r,o=e.length;for(;o-- >0;)if(r=e[o],n===r.toLowerCase())return r;return null}const u3=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,d3=t=>!v0(t)&&t!==u3,vZ=(t=>n=>t&&n instanceof t)(typeof Uint8Array<"u"&&J2(Uint8Array)),wZ=Jh("HTMLFormElement"),h3=(({hasOwnProperty:t})=>(n,e)=>t.call(n,e))(Object.prototype),TZ=Jh("RegExp"),p3=(t,n)=>{const e=Object.getOwnPropertyDescriptors(t),o={};b0(e,(r,s)=>{!1!==n(r,s,t)&&(o[s]=r)}),Object.defineProperties(t,o)},iD="abcdefghijklmnopqrstuvwxyz",f3="0123456789",m3={DIGIT:f3,ALPHA:iD,ALPHA_DIGIT:iD+iD.toUpperCase()+f3},Nt={isArray:My,isArrayBuffer:a3,isBuffer:function tZ(t){return null!==t&&!v0(t)&&null!==t.constructor&&!v0(t.constructor)&&Rf(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{const n="[object FormData]";return t&&("function"==typeof FormData&&t instanceof FormData||s3.call(t)===n||Rf(t.toString)&&t.toString()===n)},isArrayBufferView:function nZ(t){let n;return n=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&a3(t.buffer),n},isString:iZ,isNumber:l3,isBoolean:t=>!0===t||!1===t,isObject:tD,isPlainObject:wC,isUndefined:v0,isDate:rZ,isFile:sZ,isBlob:aZ,isRegExp:TZ,isFunction:Rf,isStream:t=>tD(t)&&Rf(t.pipe),isURLSearchParams:dZ,isTypedArray:vZ,isFileList:lZ,forEach:b0,merge:function nD(){const{caseless:t}=d3(this)&&this||{},n={},e=(o,r)=>{const s=t&&c3(n,r)||r;n[s]=wC(n[s])&&wC(o)?nD(n[s],o):wC(o)?nD({},o):My(o)?o.slice():o};for(let o=0,r=arguments.length;o<r;o++)arguments[o]&&b0(arguments[o],e);return n},extend:(t,n,e,{allOwnKeys:o}={})=>(b0(n,(r,s)=>{t[s]=e&&Rf(r)?r3(r,e):r},{allOwnKeys:o}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,n,e,o)=>{t.prototype=Object.create(n.prototype,o),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:n.prototype}),e&&Object.assign(t.prototype,e)},toFlatObject:(t,n,e,o)=>{let r,s,l;const h={};if(n=n||{},null==t)return n;do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)l=r[s],(!o||o(l,t,n))&&!h[l]&&(n[l]=t[l],h[l]=!0);t=!1!==e&&J2(t)}while(t&&(!e||e(t,n))&&t!==Object.prototype);return n},kindOf:eD,kindOfTest:Jh,endsWith:(t,n,e)=>{t=String(t),(void 0===e||e>t.length)&&(e=t.length);const o=t.indexOf(n,e-=n.length);return-1!==o&&o===e},toArray:t=>{if(!t)return null;if(My(t))return t;let n=t.length;if(!l3(n))return null;const e=new Array(n);for(;n-- >0;)e[n]=t[n];return e},forEachEntry:(t,n)=>{const o=(t&&t[Symbol.iterator]).call(t);let r;for(;(r=o.next())&&!r.done;){const s=r.value;n.call(t,s[0],s[1])}},matchAll:(t,n)=>{let e;const o=[];for(;null!==(e=t.exec(n));)o.push(e);return o},isHTMLForm:wZ,hasOwnProperty:h3,hasOwnProp:h3,reduceDescriptors:p3,freezeMethods:t=>{p3(t,(n,e)=>{if(Rf(t)&&-1!==["arguments","caller","callee"].indexOf(e))return!1;if(Rf(t[e])){if(n.enumerable=!1,"writable"in n)return void(n.writable=!1);n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},toObjectSet:(t,n)=>{const e={},o=r=>{r.forEach(s=>{e[s]=!0})};return My(t)?o(t):o(String(t).split(n)),e},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,o,r){return o.toUpperCase()+r}),noop:()=>{},toFiniteNumber:(t,n)=>(t=+t,Number.isFinite(t)?t:n),findKey:c3,global:u3,isContextDefined:d3,ALPHABET:m3,generateString:(t=16,n=m3.ALPHA_DIGIT)=>{let e="";const{length:o}=n;for(;t--;)e+=n[Math.random()*o|0];return e},isSpecCompliantForm:function kZ(t){return!!(t&&Rf(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])},toJSONObject:t=>{const n=new Array(10),e=(o,r)=>{if(tD(o)){if(n.indexOf(o)>=0)return;if(!("toJSON"in o)){n[r]=o;const s=My(o)?[]:{};return b0(o,(l,h)=>{const f=e(l,r+1);!v0(f)&&(s[h]=f)}),n[r]=void 0,s}}return o};return e(t,0)}};function ky(t,n,e,o,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",n&&(this.code=n),e&&(this.config=e),o&&(this.request=o),r&&(this.response=r)}Nt.inherits(ky,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Nt.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const g3=ky.prototype,_3={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{_3[t]={value:t}}),Object.defineProperties(ky,_3),Object.defineProperty(g3,"isAxiosError",{value:!0}),ky.from=(t,n,e,o,r,s)=>{const l=Object.create(g3);return Nt.toFlatObject(t,l,function(f){return f!==Error.prototype},h=>"isAxiosError"!==h),ky.call(l,t.message,n,e,o,r),l.cause=t,l.name=t.name,s&&Object.assign(l,s),l};const Go=ky;function oD(t){return Nt.isPlainObject(t)||Nt.isArray(t)}function v3(t){return Nt.endsWith(t,"[]")?t.slice(0,-2):t}function b3(t,n,e){return t?t.concat(n).map(function(r,s){return r=v3(r),!e&&s?"["+r+"]":r}).join(e?".":""):n}const PZ=Nt.toFlatObject(Nt,{},null,function(n){return/^is[A-Z]/.test(n)}),CC=function OZ(t,n,e){if(!Nt.isObject(t))throw new TypeError("target must be an object");n=n||new FormData;const o=(e=Nt.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(X,ee){return!Nt.isUndefined(ee[X])})).metaTokens,r=e.visitor||C,s=e.dots,l=e.indexes,f=(e.Blob||typeof Blob<"u"&&Blob)&&Nt.isSpecCompliantForm(n);if(!Nt.isFunction(r))throw new TypeError("visitor must be a function");function y($){if(null===$)return"";if(Nt.isDate($))return $.toISOString();if(!f&&Nt.isBlob($))throw new Go("Blob is not supported. Use a Buffer instead.");return Nt.isArrayBuffer($)||Nt.isTypedArray($)?f&&"function"==typeof Blob?new Blob([$]):Buffer.from($):$}function C($,X,ee){let ue=$;if($&&!ee&&"object"==typeof $)if(Nt.endsWith(X,"{}"))X=o?X:X.slice(0,-2),$=JSON.stringify($);else if(Nt.isArray($)&&function AZ(t){return Nt.isArray(t)&&!t.some(oD)}($)||(Nt.isFileList($)||Nt.endsWith(X,"[]"))&&(ue=Nt.toArray($)))return X=v3(X),ue.forEach(function(_e,Be){!Nt.isUndefined(_e)&&null!==_e&&n.append(!0===l?b3([X],Be,s):null===l?X:X+"[]",y(_e))}),!1;return!!oD($)||(n.append(b3(ee,X,s),y($)),!1)}const D=[],R=Object.assign(PZ,{defaultVisitor:C,convertValue:y,isVisitable:oD});if(!Nt.isObject(t))throw new TypeError("data must be an object");return function V($,X){if(!Nt.isUndefined($)){if(-1!==D.indexOf($))throw Error("Circular reference detected in "+X.join("."));D.push($),Nt.forEach($,function(ue,fe){!0===(!(Nt.isUndefined(ue)||null===ue)&&r.call(n,ue,Nt.isString(fe)?fe.trim():fe,X,R))&&V(ue,X?X.concat(fe):[fe])}),D.pop()}}(t),n};function x3(t){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(o){return n[o]})}function w3(t,n){this._pairs=[],t&&CC(t,this,n)}const C3=w3.prototype;C3.append=function(n,e){this._pairs.push([n,e])},C3.toString=function(n){const e=n?function(o){return n.call(this,o,x3)}:x3;return this._pairs.map(function(r){return e(r[0])+"="+e(r[1])},"").join("&")};const T3=w3;function LZ(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function S3(t,n,e){if(!n)return t;const o=e&&e.encode||LZ,r=e&&e.serialize;let s;if(s=r?r(n,e):Nt.isURLSearchParams(n)?n.toString():new T3(n,e).toString(o),s){const l=t.indexOf("#");-1!==l&&(t=t.slice(0,l)),t+=(-1===t.indexOf("?")?"?":"&")+s}return t}const E3=class RZ{constructor(){this.handlers=[]}use(n,e,o){return this.handlers.push({fulfilled:n,rejected:e,synchronous:!!o&&o.synchronous,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Nt.forEach(this.handlers,function(o){null!==o&&n(o)})}},I3={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},FZ=typeof URLSearchParams<"u"?URLSearchParams:T3,NZ=typeof FormData<"u"?FormData:null,zZ=typeof Blob<"u"?Blob:null,BZ=(()=>{let t;return(!(typeof navigator<"u")||"ReactNative"!==(t=navigator.product)&&"NativeScript"!==t&&"NS"!==t)&&typeof window<"u"&&typeof document<"u"})(),Fd={isBrowser:!0,classes:{URLSearchParams:FZ,FormData:NZ,Blob:zZ},isStandardBrowserEnv:BZ,isStandardBrowserWebWorkerEnv:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]},D3=function $Z(t){function n(e,o,r,s){let l=e[s++];const h=Number.isFinite(+l),f=s>=e.length;return l=!l&&Nt.isArray(r)?r.length:l,f?(r[l]=Nt.hasOwnProp(r,l)?[r[l],o]:o,!h):((!r[l]||!Nt.isObject(r[l]))&&(r[l]=[]),n(e,o,r[l],s)&&Nt.isArray(r[l])&&(r[l]=function HZ(t){const n={},e=Object.keys(t);let o;const r=e.length;let s;for(o=0;o<r;o++)s=e[o],n[s]=t[s];return n}(r[l])),!h)}if(Nt.isFormData(t)&&Nt.isFunction(t.entries)){const e={};return Nt.forEachEntry(t,(o,r)=>{n(function jZ(t){return Nt.matchAll(/\w+|\[(\w*)]/g,t).map(n=>"[]"===n[0]?"":n[1]||n[0])}(o),r,e,0)}),e}return null},GZ={"Content-Type":void 0},TC={transitional:I3,adapter:["xhr","http"],transformRequest:[function(n,e){const o=e.getContentType()||"",r=o.indexOf("application/json")>-1,s=Nt.isObject(n);if(s&&Nt.isHTMLForm(n)&&(n=new FormData(n)),Nt.isFormData(n))return r&&r?JSON.stringify(D3(n)):n;if(Nt.isArrayBuffer(n)||Nt.isBuffer(n)||Nt.isStream(n)||Nt.isFile(n)||Nt.isBlob(n))return n;if(Nt.isArrayBufferView(n))return n.buffer;if(Nt.isURLSearchParams(n))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let h;if(s){if(o.indexOf("application/x-www-form-urlencoded")>-1)return function UZ(t,n){return CC(t,new Fd.classes.URLSearchParams,Object.assign({visitor:function(e,o,r,s){return Fd.isNode&&Nt.isBuffer(e)?(this.append(o,e.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},n))}(n,this.formSerializer).toString();if((h=Nt.isFileList(n))||o.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return CC(h?{"files[]":n}:n,f&&new f,this.formSerializer)}}return s||r?(e.setContentType("application/json",!1),function WZ(t,n,e){if(Nt.isString(t))try{return(n||JSON.parse)(t),Nt.trim(t)}catch(o){if("SyntaxError"!==o.name)throw o}return(e||JSON.stringify)(t)}(n)):n}],transformResponse:[function(n){const e=this.transitional||TC.transitional,o=e&&e.forcedJSONParsing,r="json"===this.responseType;if(n&&Nt.isString(n)&&(o&&!this.responseType||r)){const l=!(e&&e.silentJSONParsing)&&r;try{return JSON.parse(n)}catch(h){if(l)throw"SyntaxError"===h.name?Go.from(h,Go.ERR_BAD_RESPONSE,this,null,this.response):h}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Fd.classes.FormData,Blob:Fd.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Nt.forEach(["delete","get","head"],function(n){TC.headers[n]={}}),Nt.forEach(["post","put","patch"],function(n){TC.headers[n]=Nt.merge(GZ)});const rD=TC,qZ=Nt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),M3=Symbol("internals");function x0(t){return t&&String(t).trim().toLowerCase()}function SC(t){return!1===t||null==t?t:Nt.isArray(t)?t.map(SC):String(t)}function sD(t,n,e,o,r){if(Nt.isFunction(o))return o.call(this,n,e);if(r&&(n=e),Nt.isString(n)){if(Nt.isString(o))return-1!==n.indexOf(o);if(Nt.isRegExp(o))return o.test(n)}}class EC{constructor(n){n&&this.set(n)}set(n,e,o){const r=this;function s(h,f,y){const C=x0(f);if(!C)throw new Error("header name must be a non-empty string");const D=Nt.findKey(r,C);(!D||void 0===r[D]||!0===y||void 0===y&&!1!==r[D])&&(r[D||f]=SC(h))}const l=(h,f)=>Nt.forEach(h,(y,C)=>s(y,C,f));return Nt.isPlainObject(n)||n instanceof this.constructor?l(n,e):Nt.isString(n)&&(n=n.trim())&&!(t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))(n)?l((t=>{const n={};let e,o,r;return t&&t.split("\n").forEach(function(l){r=l.indexOf(":"),e=l.substring(0,r).trim().toLowerCase(),o=l.substring(r+1).trim(),!(!e||n[e]&&qZ[e])&&("set-cookie"===e?n[e]?n[e].push(o):n[e]=[o]:n[e]=n[e]?n[e]+", "+o:o)}),n})(n),e):null!=n&&s(e,n,o),this}get(n,e){if(n=x0(n)){const o=Nt.findKey(this,n);if(o){const r=this[o];if(!e)return r;if(!0===e)return function KZ(t){const n=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=e.exec(t);)n[o[1]]=o[2];return n}(r);if(Nt.isFunction(e))return e.call(this,r,o);if(Nt.isRegExp(e))return e.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,e){if(n=x0(n)){const o=Nt.findKey(this,n);return!(!o||void 0===this[o]||e&&!sD(0,this[o],o,e))}return!1}delete(n,e){const o=this;let r=!1;function s(l){if(l=x0(l)){const h=Nt.findKey(o,l);h&&(!e||sD(0,o[h],h,e))&&(delete o[h],r=!0)}}return Nt.isArray(n)?n.forEach(s):s(n),r}clear(n){const e=Object.keys(this);let o=e.length,r=!1;for(;o--;){const s=e[o];(!n||sD(0,this[s],s,n,!0))&&(delete this[s],r=!0)}return r}normalize(n){const e=this,o={};return Nt.forEach(this,(r,s)=>{const l=Nt.findKey(o,s);if(l)return e[l]=SC(r),void delete e[s];const h=n?function YZ(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,e,o)=>e.toUpperCase()+o)}(s):String(s).trim();h!==s&&delete e[s],e[h]=SC(r),o[h]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const e=Object.create(null);return Nt.forEach(this,(o,r)=>{null!=o&&!1!==o&&(e[r]=n&&Nt.isArray(o)?o.join(", "):o)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,e])=>n+": "+e).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...e){const o=new this(n);return e.forEach(r=>o.set(r)),o}static accessor(n){const o=(this[M3]=this[M3]={accessors:{}}).accessors,r=this.prototype;function s(l){const h=x0(l);o[h]||(function QZ(t,n){const e=Nt.toCamelCase(" "+n);["get","set","has"].forEach(o=>{Object.defineProperty(t,o+e,{value:function(r,s,l){return this[o].call(this,n,r,s,l)},configurable:!0})})}(r,l),o[h]=!0)}return Nt.isArray(n)?n.forEach(s):s(n),this}}EC.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Nt.freezeMethods(EC.prototype),Nt.freezeMethods(EC);const ep=EC;function aD(t,n){const e=this||rD,o=n||e,r=ep.from(o.headers);let s=o.data;return Nt.forEach(t,function(h){s=h.call(e,s,r.normalize(),n?n.status:void 0)}),r.normalize(),s}function k3(t){return!(!t||!t.__CANCEL__)}function A3(t,n,e){Go.call(this,t??"canceled",Go.ERR_CANCELED,n,e),this.name="CanceledError"}Nt.inherits(A3,Go,{__CANCEL__:!0});const IC=A3,eK=Fd.isStandardBrowserEnv?{write:function(e,o,r,s,l,h){const f=[];f.push(e+"="+encodeURIComponent(o)),Nt.isNumber(r)&&f.push("expires="+new Date(r).toGMTString()),Nt.isString(s)&&f.push("path="+s),Nt.isString(l)&&f.push("domain="+l),!0===h&&f.push("secure"),document.cookie=f.join("; ")},read:function(e){const o=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return o?decodeURIComponent(o[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function P3(t,n){return t&&!function tK(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}(n)?function nK(t,n){return n?t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):t}(t,n):n}const iK=Fd.isStandardBrowserEnv?function(){const n=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let o;function r(s){let l=s;return n&&(e.setAttribute("href",l),l=e.href),e.setAttribute("href",l),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return o=r(window.location.href),function(l){const h=Nt.isString(l)?r(l):l;return h.protocol===o.protocol&&h.host===o.host}}():function(){return!0},sK=function rK(t,n){t=t||10;const e=new Array(t),o=new Array(t);let l,r=0,s=0;return n=void 0!==n?n:1e3,function(f){const y=Date.now(),C=o[s];l||(l=y),e[r]=f,o[r]=y;let D=s,R=0;for(;D!==r;)R+=e[D++],D%=t;if(r=(r+1)%t,r===s&&(s=(s+1)%t),y-l<n)return;const V=C&&y-C;return V?Math.round(1e3*R/V):void 0}};function O3(t,n){let e=0;const o=sK(50,250);return r=>{const s=r.loaded,l=r.lengthComputable?r.total:void 0,h=s-e,f=o(h);e=s;const C={loaded:s,total:l,progress:l?s/l:void 0,bytes:h,rate:f||void 0,estimated:f&&l&&s<=l?(l-s)/f:void 0,event:r};C[n?"download":"upload"]=!0,t(C)}}const DC={http:null,xhr:typeof XMLHttpRequest<"u"&&function(t){return new Promise(function(e,o){let r=t.data;const s=ep.from(t.headers).normalize(),l=t.responseType;let h;function f(){t.cancelToken&&t.cancelToken.unsubscribe(h),t.signal&&t.signal.removeEventListener("abort",h)}Nt.isFormData(r)&&(Fd.isStandardBrowserEnv||Fd.isStandardBrowserWebWorkerEnv)&&s.setContentType(!1);let y=new XMLHttpRequest;if(t.auth){const V=t.auth.username||"",$=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.set("Authorization","Basic "+btoa(V+":"+$))}const C=P3(t.baseURL,t.url);function D(){if(!y)return;const V=ep.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders());(function JZ(t,n,e){const o=e.config.validateStatus;e.status&&o&&!o(e.status)?n(new Go("Request failed with status code "+e.status,[Go.ERR_BAD_REQUEST,Go.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e)):t(e)})(function(ue){e(ue),f()},function(ue){o(ue),f()},{data:l&&"text"!==l&&"json"!==l?y.response:y.responseText,status:y.status,statusText:y.statusText,headers:V,config:t,request:y}),y=null}if(y.open(t.method.toUpperCase(),S3(C,t.params,t.paramsSerializer),!0),y.timeout=t.timeout,"onloadend"in y?y.onloadend=D:y.onreadystatechange=function(){!y||4!==y.readyState||0===y.status&&(!y.responseURL||0!==y.responseURL.indexOf("file:"))||setTimeout(D)},y.onabort=function(){y&&(o(new Go("Request aborted",Go.ECONNABORTED,t,y)),y=null)},y.onerror=function(){o(new Go("Network Error",Go.ERR_NETWORK,t,y)),y=null},y.ontimeout=function(){let $=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";t.timeoutErrorMessage&&($=t.timeoutErrorMessage),o(new Go($,(t.transitional||I3).clarifyTimeoutError?Go.ETIMEDOUT:Go.ECONNABORTED,t,y)),y=null},Fd.isStandardBrowserEnv){const V=(t.withCredentials||iK(C))&&t.xsrfCookieName&&eK.read(t.xsrfCookieName);V&&s.set(t.xsrfHeaderName,V)}void 0===r&&s.setContentType(null),"setRequestHeader"in y&&Nt.forEach(s.toJSON(),function($,X){y.setRequestHeader(X,$)}),Nt.isUndefined(t.withCredentials)||(y.withCredentials=!!t.withCredentials),l&&"json"!==l&&(y.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&y.addEventListener("progress",O3(t.onDownloadProgress,!0)),"function"==typeof t.onUploadProgress&&y.upload&&y.upload.addEventListener("progress",O3(t.onUploadProgress)),(t.cancelToken||t.signal)&&(h=V=>{y&&(o(!V||V.type?new IC(null,t,y):V),y.abort(),y=null)},t.cancelToken&&t.cancelToken.subscribe(h),t.signal&&(t.signal.aborted?h():t.signal.addEventListener("abort",h)));const R=function oK(t){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}(C);R&&-1===Fd.protocols.indexOf(R)?o(new Go("Unsupported protocol "+R+":",Go.ERR_BAD_REQUEST,t)):y.send(r||null)})}};Nt.forEach(DC,(t,n)=>{if(t){try{Object.defineProperty(t,"name",{value:n})}catch{}Object.defineProperty(t,"adapterName",{value:n})}});const aK={getAdapter:t=>{t=Nt.isArray(t)?t:[t];const{length:n}=t;let e,o;for(let r=0;r<n&&(e=t[r],!(o=Nt.isString(e)?DC[e.toLowerCase()]:e));r++);if(!o)throw!1===o?new Go(`Adapter ${e} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(Nt.hasOwnProp(DC,e)?`Adapter '${e}' is not available in the build`:`Unknown adapter '${e}'`);if(!Nt.isFunction(o))throw new TypeError("adapter is not a function");return o},adapters:DC};function lD(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new IC(null,t)}function L3(t){return lD(t),t.headers=ep.from(t.headers),t.data=aD.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1),aK.getAdapter(t.adapter||rD.adapter)(t).then(function(o){return lD(t),o.data=aD.call(t,t.transformResponse,o),o.headers=ep.from(o.headers),o},function(o){return k3(o)||(lD(t),o&&o.response&&(o.response.data=aD.call(t,t.transformResponse,o.response),o.response.headers=ep.from(o.response.headers))),Promise.reject(o)})}const R3=t=>t instanceof ep?t.toJSON():t;function Ay(t,n){n=n||{};const e={};function o(y,C,D){return Nt.isPlainObject(y)&&Nt.isPlainObject(C)?Nt.merge.call({caseless:D},y,C):Nt.isPlainObject(C)?Nt.merge({},C):Nt.isArray(C)?C.slice():C}function r(y,C,D){return Nt.isUndefined(C)?Nt.isUndefined(y)?void 0:o(void 0,y,D):o(y,C,D)}function s(y,C){if(!Nt.isUndefined(C))return o(void 0,C)}function l(y,C){return Nt.isUndefined(C)?Nt.isUndefined(y)?void 0:o(void 0,y):o(void 0,C)}function h(y,C,D){return D in n?o(y,C):D in t?o(void 0,y):void 0}const f={url:s,method:s,data:s,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:h,headers:(y,C)=>r(R3(y),R3(C),!0)};return Nt.forEach(Object.keys(t).concat(Object.keys(n)),function(C){const D=f[C]||r,R=D(t[C],n[C],C);Nt.isUndefined(R)&&D!==h||(e[C]=R)}),e}const F3="1.3.5",cD={};["object","boolean","number","function","string","symbol"].forEach((t,n)=>{cD[t]=function(o){return typeof o===t||"a"+(n<1?"n ":" ")+t}});const N3={};cD.transitional=function(n,e,o){function r(s,l){return"[Axios v"+F3+"] Transitional option '"+s+"'"+l+(o?". "+o:"")}return(s,l,h)=>{if(!1===n)throw new Go(r(l," has been removed"+(e?" in "+e:"")),Go.ERR_DEPRECATED);return e&&!N3[l]&&(N3[l]=!0,console.warn(r(l," has been deprecated since v"+e+" and will be removed in the near future"))),!n||n(s,l,h)}};const uD={assertOptions:function lK(t,n,e){if("object"!=typeof t)throw new Go("options must be an object",Go.ERR_BAD_OPTION_VALUE);const o=Object.keys(t);let r=o.length;for(;r-- >0;){const s=o[r],l=n[s];if(l){const h=t[s],f=void 0===h||l(h,s,t);if(!0!==f)throw new Go("option "+s+" must be "+f,Go.ERR_BAD_OPTION_VALUE)}else if(!0!==e)throw new Go("Unknown option "+s,Go.ERR_BAD_OPTION)}},validators:cD},Ff=uD.validators;class MC{constructor(n){this.defaults=n,this.interceptors={request:new E3,response:new E3}}request(n,e){"string"==typeof n?(e=e||{}).url=n:e=n||{},e=Ay(this.defaults,e);const{transitional:o,paramsSerializer:r,headers:s}=e;let l;void 0!==o&&uD.assertOptions(o,{silentJSONParsing:Ff.transitional(Ff.boolean),forcedJSONParsing:Ff.transitional(Ff.boolean),clarifyTimeoutError:Ff.transitional(Ff.boolean)},!1),null!=r&&(Nt.isFunction(r)?e.paramsSerializer={serialize:r}:uD.assertOptions(r,{encode:Ff.function,serialize:Ff.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase(),l=s&&Nt.merge(s.common,s[e.method]),l&&Nt.forEach(["delete","get","head","post","put","patch","common"],$=>{delete s[$]}),e.headers=ep.concat(l,s);const h=[];let f=!0;this.interceptors.request.forEach(function(X){"function"==typeof X.runWhen&&!1===X.runWhen(e)||(f=f&&X.synchronous,h.unshift(X.fulfilled,X.rejected))});const y=[];this.interceptors.response.forEach(function(X){y.push(X.fulfilled,X.rejected)});let C,R,D=0;if(!f){const $=[L3.bind(this),void 0];for($.unshift.apply($,h),$.push.apply($,y),R=$.length,C=Promise.resolve(e);D<R;)C=C.then($[D++],$[D++]);return C}R=h.length;let V=e;for(D=0;D<R;){const $=h[D++],X=h[D++];try{V=$(V)}catch(ee){X.call(this,ee);break}}try{C=L3.call(this,V)}catch($){return Promise.reject($)}for(D=0,R=y.length;D<R;)C=C.then(y[D++],y[D++]);return C}getUri(n){return S3(P3((n=Ay(this.defaults,n)).baseURL,n.url),n.params,n.paramsSerializer)}}Nt.forEach(["delete","get","head","options"],function(n){MC.prototype[n]=function(e,o){return this.request(Ay(o||{},{method:n,url:e,data:(o||{}).data}))}}),Nt.forEach(["post","put","patch"],function(n){function e(o){return function(s,l,h){return this.request(Ay(h||{},{method:n,headers:o?{"Content-Type":"multipart/form-data"}:{},url:s,data:l}))}}MC.prototype[n]=e(),MC.prototype[n+"Form"]=e(!0)});const kC=MC;class dD{constructor(n){if("function"!=typeof n)throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(s){e=s});const o=this;this.promise.then(r=>{if(!o._listeners)return;let s=o._listeners.length;for(;s-- >0;)o._listeners[s](r);o._listeners=null}),this.promise.then=r=>{let s;const l=new Promise(h=>{o.subscribe(h),s=h}).then(r);return l.cancel=function(){o.unsubscribe(s)},l},n(function(s,l,h){o.reason||(o.reason=new IC(s,l,h),e(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){this.reason?n(this.reason):this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const e=this._listeners.indexOf(n);-1!==e&&this._listeners.splice(e,1)}static source(){let n;return{token:new dD(function(r){n=r}),cancel:n}}}const cK=dD,hD={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hD).forEach(([t,n])=>{hD[n]=t});const hK=hD,Es=function z3(t){const n=new kC(t),e=r3(kC.prototype.request,n);return Nt.extend(e,kC.prototype,n,{allOwnKeys:!0}),Nt.extend(e,n,null,{allOwnKeys:!0}),e.create=function(r){return z3(Ay(t,r))},e}(rD);Es.Axios=kC,Es.CanceledError=IC,Es.CancelToken=cK,Es.isCancel=k3,Es.VERSION=F3,Es.toFormData=CC,Es.AxiosError=Go,Es.Cancel=Es.CanceledError,Es.all=function(n){return Promise.all(n)},Es.spread=function uK(t){return function(e){return t.apply(null,e)}},Es.isAxiosError=function dK(t){return Nt.isObject(t)&&!0===t.isAxiosError},Es.mergeConfig=Ay,Es.AxiosHeaders=ep,Es.formToJSON=t=>D3(Nt.isHTMLForm(t)?new FormData(t):t),Es.HttpStatusCode=hK,Es.default=Es;const ui=Es;let Mg=(()=>{class t{constructor(){}doCreateUser(e,o,r){return Ft(function*(){const l=Qn_server+"/users",h={name:e,email:o,nickname:r,spotifyAccessToken:sessionStorage.getItem("spotifyAccessToken"),spotifyRefreshToken:sessionStorage.getItem("spotifyRefreshToken")};sessionStorage.removeItem("spotifyAccessToken"),sessionStorage.removeItem("spotifyRefreshToken");try{return(yield ui.post(l,h)).data}catch(f){throw f.response}})()}getMe(){return Ft(function*(){const o=Qn_server+"/users/me",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}getOtherUser(e){return Ft(function*(){const r=Qn_server+"/users/"+e,s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}updateUser(e,o,r){return Ft(function*(){const l=Qn_server+"/users",h={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}},f={name:e,email:o,nickname:r};try{return(yield ui.put(l,f,h)).data}catch(y){throw y.response}})()}updateProfileImage(e){return Ft(function*(){const r=Qn_server+"/users/profileImage",s=new FormData;s.append("profileImage",e);const l={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken"),"Content-Type":"multipart/form-data"}};try{return yield ui.put(r,s,l)}catch(h){throw h.response}})()}deleteUser(){return Ft(function*(){const o=Qn_server+"/users",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken"),"Content-Type":"multipart/form-data"}};try{return yield ui.delete(o,r)}catch(s){throw s.response}})()}searchUsers(e){return Ft(function*(){var r=Qn_server+"/users/search";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};r=r+"?username="+e;try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}recommendUsers(){return Ft(function*(){const o=Qn_server+"/users/recommend",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}getActivityPerHour(){return Ft(function*(){var o=Qn_server+"/users/me/activityPerHour";const r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Py=(()=>{class t{constructor(){}sendFriendRequest(e){return Ft(function*(){var r=Qn_server+"/users/friends/connect";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};r+="/"+e;try{return(yield ui.put(r,"",s)).data}catch(h){throw h.response}})()}acceptFriendRequest(e,o){return Ft(function*(){var s=Qn_server+"/users/friends/answerConnection";const l={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};s+="/"+e;const h={accept:o};try{return(yield ui.post(s,h,l)).data}catch(f){throw f.response}})()}getFriends(){return Ft(function*(){var o=Qn_server+"/users/friends";const r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){return s.response}})()}disconnectFriend(e){return Ft(function*(){var r=Qn_server+"/users/friends/disconnect/"+e;const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.delete(r,s)).data}catch(l){throw l.response}})()}getFriendRequests(){return Ft(function*(){var o=Qn_server+"/users/friendsRequest";const r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),AC=(()=>{class t{constructor(e){this.router=e,this.generateRandomString=function(o){for(var r="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l=0;l<o;l++)r+=s.charAt(Math.floor(Math.random()*s.length));return r}}redirect(){var e=this;return Ft(function*(){var o=e.generateRandomString(16);localStorage.setItem("stateKey",o);var s="https://accounts.spotify.com/authorize";s+="?response_type=code",s+="&client_id="+encodeURIComponent("d00453363dee4c039a00f533dd2bcb1d"),s+="&scope="+encodeURIComponent("user-read-private user-read-email user-top-read user-read-playback-state user-library-read user-read-recently-played playlist-modify-public playlist-modify-private ugc-image-upload"),s+="&redirect_uri="+encodeURIComponent("https://spotivibes.github.io/callback"),s+="&state="+encodeURIComponent(o),window.location.href=s})()}doLogin(e,o){return Ft(function*(){var r=localStorage.getItem("stateKey");if(localStorage.removeItem("stateKey"),null===o||o!==r)return console.error("state error",r,o),!1;{const l=Qn_server+"/auth/login",h={code:e,redirect_uri:"https://spotivibes.github.io/callback"};try{const f=yield ui.post(l,h);return sessionStorage.setItem("accessToken",f.data.accessToken),f.data}catch(f){return f.response.data}}})()}logout(){sessionStorage.clear(),this.router.navigate(["/"])}}return t.\u0275fac=function(e){return new(e||t)(Rt(Ss))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),pD=(()=>{class t{constructor(e,o){this.primengConfig=e,this.document=o,this.title="spotivibes",this.themeTag="Tema oscuro",this.theme="theme-dark",this.themeIcon="dark_mode",this.mapStyle="mapbox://styles/pikanachi/clgjc5uab006m01qu4avp1dyw",this.changeThemeEvent=new ht,this.changeColorSchemeEvent=new ht}ngOnInit(){this.primengConfig.ripple=!0,window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{this.changeTheme(!1)}),this.changeTheme(!1)}changeTheme(e){const o=document.body;e?o.classList.contains(this.theme)?this.setLightMode(o):this.setDarkMode(o):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?this.setDarkMode(o):this.setLightMode(o)}setDarkMode(e){this.themeTag="Tema claro",this.themeIcon="light_mode",e.classList.add(this.theme),this.mapStyle="mapbox://styles/pikanachi/clgia79lz005o01r74lkhfpns",this.document.getElementById("theme").setAttribute("href","assets/themes/vela-blue/theme.css"),this.changeThemeEvent.emit(this.mapStyle),this.changeColorSchemeEvent.emit(!0)}setLightMode(e){this.themeTag="Tema oscuro",this.themeIcon="dark_mode",this.mapStyle="mapbox://styles/pikanachi/clgjc5uab006m01qu4avp1dyw",e.classList.remove(this.theme),this.document.getElementById("theme").setAttribute("href","assets/themes/saga-blue/theme.css"),this.changeThemeEvent.emit(this.mapStyle),this.changeColorSchemeEvent.emit(!1)}}return t.\u0275fac=function(e){return new(e||t)(ce(fl),ce(uo))},t.\u0275cmp=Qt({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(e,o){1&e&&Ae(0,"router-outlet")},dependencies:[rC]}),t})();function pK(t,n){1&t&&Ae(0,"p-badge",26),2&t&&L("value",U(2).numNotificaciones)}function fK(t,n){if(1&t){const e=Ye();P(0,"button",21),Te("click",function(){const s=be(e).$implicit;return ve(U().goToRoute(s.id,s.name,s.route))}),P(1,"div",22)(2,"mat-icon",23),ie(3),N(),P(4,"span",24),ie(5),N(),W(6,pK,1,1,"p-badge",25),N()()}if(2&t){const e=n.$implicit,o=U();Ro("sidenav-button-selected",o.currentRouteId==e.id),F(2),Ro("material-icons-outlined",o.currentRouteId!=e.id),F(1),Ut(e.icon),F(2),Ut(e.name),F(1),L("ngIf",4==e.id&&o.hayNotificaciones)}}function mK(t,n){if(1&t&&Ae(0,"img",38),2&t){const e=U(2);Ai("src",e.user.profileImage,Ui),L("alt",e.user.name)}}function gK(t,n){1&t&&Ae(0,"img",39),2&t&&L("alt",U(2).user.name)}function _K(t,n){if(1&t&&(P(0,"div",40),ie(1),wo(2,"slice"),N()),2&t){const e=U(2);F(1),jn(" ",e.user.name.length>13?Nr(2,1,e.user.name,0,13)+"...":e.user.name," ")}}function yK(t,n){if(1&t&&(P(0,"div",41),ie(1),wo(2,"slice"),N()),2&t){const e=U(2);F(1),Ut(e.user.email.length>17?Nr(2,1,e.user.email,0,15)+"...":e.user.email)}}function vK(t,n){if(1&t){const e=Ye();P(0,"p-slideMenu",42),Te("click",function(r){return be(e),ve(U(2).activeMenu(r))}),N()}2&t&&L("model",U(2).menuItems)("viewportHeight",135)}function bK(t,n){if(1&t){const e=Ye();P(0,"div",27)(1,"div",28),W(2,mK,1,2,"img",29),W(3,gK,1,1,"img",30),N(),P(4,"div",31),W(5,_K,3,5,"div",32),W(6,yK,3,5,"div",33),N(),P(7,"div",31)(8,"button",34),Te("click",function(){return be(e),ve(U().toogleMenu())}),P(9,"mat-icon"),ie(10,"more_horiz"),N()()(),P(11,"div",35,36),W(13,vK,1,2,"p-slideMenu",37),N()()}if(2&t){const e=U();F(2),L("ngIf",""!=e.user.profileImage),F(1),L("ngIf",""==e.user.profileImage),F(2),L("ngIf",null!=e.user.name),F(1),L("ngIf",null!=e.user.email),F(7),L("ngIf",e.menuToogled)}}function xK(t,n){if(1&t){const e=Ye();P(0,"mat-toolbar",43)(1,"button",44),Te("click",function(){return be(e),ve(U().sidenav.toggle())}),P(2,"mat-icon",45),ie(3,"menu"),N()(),P(4,"h2",46),ie(5),N()()}if(2&t){const e=U();F(5),Ut(e.currentRoute)}}const wK=function(){return{"margin-top":"4rem"}},CK=function(){return{"margin-top":"0"}};function TK(t,n){1&t&&(P(0,"div",47),Ae(1,"router-outlet"),N()),2&t&&L("ngStyle",U().showBar?Kn(1,wK):Kn(2,CK))}let Zo=(()=>{class t{constructor(e,o,r,s,l,h,f,y,C,D){this.router=e,this.primengConfig=o,this.confirmationService=r,this.messageService=s,this.cdRef=l,this.renderer=h,this.usersService=f,this.friendsService=y,this.authService=C,this.appComponent=D,this.title="spotivibes",this.showBar=!1,this.showTitle=!0,this.menuToogled=!1,this.currentRouteId=1,this.currentRoute="",this.hayNotificaciones=!1,this.displayNewVibeDialog=!1,this.displaySuccess=!1,this.expired=!1,this.displayExpiredDialog=!1,this.spotyExpired=!1,this.displayPushNotificationsDialog=!0,this.previewIcon="play_arrow",this.playingSong="",this.songSounding=new Audio,this.sidenavItems=[],this.newVibeAdded=new ht,this.deletedVibeFromPlaylist=new ht,this.centerOnMap=new ht,this.menuItems=[{icon:"pi pi-fw pi-user",label:"Ver perfil"},{icon:"pi pi-fw pi-times",label:"Cerrar sesi\xf3n"}],this.user=new bC,this.renderer.listen("window","click",R=>{(null==R.target.attributes.class||"mat-mdc-button-touch-target"!=R.target.attributes.class.nodeValue&&!R.target.attributes.class.nodeValue.includes("p-menuitem")&&!R.target.attributes.class.nodeValue.includes("p-submenu")&&!R.target.attributes.class.nodeValue.includes("p-menuitem-text")&&"ng-tns-c146-3"!=R.target.attributes.class.nodeValue&&!R.target.attributes.class.nodeValue.includes("p-slidemenu-backward"))&&(this.menuToogled=!1)})}ngOnInit(){null==sessionStorage.getItem("accessToken")&&this.router.navigate(["/unauthorized"]),this.getUser(),this.numNotif(),this.sidenavItems=[{id:0,name:"Inicio",icon:"home",route:"home"},{id:1,name:"Playlists",icon:"subscriptions",route:"playlists"},{id:2,name:"Mapa",icon:"map",route:"map"},{id:3,name:"Amigos",icon:"group",route:"friends"},{id:4,name:"Notificaciones",icon:"notifications",route:"notifications"}],window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>{this.appComponent.changeTheme(!1)}),this.appComponent.changeTheme(!1),this.primengConfig.ripple=!0;let e=localStorage.getItem("pushNotifications");(null!=e&&"active"==e||!("serviceWorker"in navigator))&&(this.displayPushNotificationsDialog=!1),this.currentRouteId=this.getCurrentRoute(this.router.url)}ngAfterViewChecked(){window.innerWidth<700?this.showBar=!0:(this.showBar=!1,this.sidenav.open(),this.sidenav.mode="side"),this.cdRef.detectChanges()}onResize(e){e.target.innerWidth<700?(this.sidenav.close(),this.sidenav.mode="over",this.showBar=!0):(this.sidenav.open(),this.sidenav.mode="side",this.showBar=!1)}goToRoute(e,o,r){this.getCurrentRoute(this.router.url),this.currentRouteId=e,this.currentRoute=o,this.showBar&&this.sidenav.close(),this.router.navigateByUrl(r)}showVibeDialog(){this.displayNewVibeDialog=!0}getCurrentRoute(e){return e.includes("/home")?0:e.includes("/playlists")?1:e.includes("/map")?2:e.includes("/friends")?3:e.includes("/notifications")?4:e.includes("/admin/dashboard")?5:e.includes("/admin/users")?6:e.includes("/profile")||e.includes("/friendProfile")?7:(console.log("Error: Ruta no encontrada"),0)}toogleMenu(){this.menuToogled=!this.menuToogled}activeMenu(e){this.whatchMenuElements("A"===e.target.tagName?e.target.text:e.target.parentNode.text)}whatchMenuElements(e){switch(e){case"Ver perfil":this.goToRoute(7,"profile","/profile/"+this.user.userId),this.menuToogled=!1,this.showBar&&this.sidenav.close();break;case"Cerrar sesi\xf3n":this.logout()}}logout(){this.confirmationService.confirm({header:"Cerrar sesi\xf3n",message:"\xbfSeguro que deseas cerrar sesi\xf3n? Una vez cerrada deber\xe1 volver a loguearse",acceptLabel:"Cerrar sesi\xf3n",rejectLabel:"Cancelar",accept:()=>{this.authService.logout(),this.menuToogled=!1}})}onBasicUploadAuto(e){console.log(e)}hideExpiedDialog(e){this.displayExpiredDialog=e,window.location.reload()}handle403Error(){this.displayExpiredDialog=!0,this.expired=!0}handle401Error(){this.displayExpiredDialog=!0,this.spotyExpired=!0}hidePushNotificationsDialog(){this.displayPushNotificationsDialog=!1}getUser(){var e=this;return Ft(function*(){try{const o=yield e.usersService.getMe();e.user=o.user,sessionStorage.setItem("userId",e.user.userId),e.user.isAdmin&&(e.sidenavItems.push({id:5,name:"Dashboard",icon:"dashboard",route:"admin/dashboard"},{id:6,name:"Usuarios",icon:"person",route:"admin/users"}),7!=e.currentRouteId&&(e.currentRoute=e.sidenavItems[e.currentRouteId].name))}catch(o){e.messageService.add({severity:"error",summary:"Error",detail:o.data.status}),e.handle403Error()}})()}onAddedNewVibe(e){this.newVibeAdded.emit(e)}numNotif(){var e=this;return Ft(function*(){try{const r=(yield e.friendsService.getFriendRequests()).friendsRequests.length;e.hayNotificaciones=r>0,e.numNotificaciones=r.toString()}catch(o){403==o.status?e.handle403Error():e.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}playPreview(e,o){this.playingSong==e?(this.playingSong="",this.previewIcon="play_arrow",this.songSounding.pause()):(this.playingSong=e,this.previewIcon="pause",this.songSounding.src=o,this.songSounding.load(),this.songSounding.play(),this.songSounding.onended=()=>{this.playingSong="",this.previewIcon="play_arrow"})}}return t.\u0275fac=function(e){return new(e||t)(ce(Ss),ce(fl),ce(Dg),ce(Rd),ce(Fo),ce(Jr),ce(Mg),ce(Py),ce(AC),ce(pD))},t.\u0275cmp=Qt({type:t,selectors:[["app-root"]],viewQuery:function(e,o){if(1&e&&pi(X2,5),2&e){let r;gn(r=_n())&&(o.sidenav=r.first)}},hostBindings:function(e,o){1&e&&Te("resize",function(s){return o.onResize(s)},0,$x)},features:[zi([Dg,Rd])],decls:29,vars:11,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"autoFocus"],["drawer",""],[1,"flex","flex-column",2,"height","100vh"],[1,"flex-none","flex","p-4"],[1,"mat-sidenav-elements"],["src","assets/images/spotivibes-logo-white.svg","alt","logo"],["mat-button","","class","mat-sidenav-button border-round-xl ",3,"sidenav-button-selected","click",4,"ngFor","ngForOf"],["type","button",1,"text-base","p-button-text","w-full","mt-3","border-round-xl","h-3rem","vibe-btn",2,"box-shadow","0px 1px 5px 0px rgba(0,0,0,0.2) !important",3,"click"],[1,"vibe-btn-text"],[1,"flex-grow-1","flex"],["mat-button","",1,"border-round-xl","mat-sidenav-button","mb-2",3,"click"],[1,"material-icons-outlined"],["class","flex align-content-center relative mt-2",4,"ngIf"],["color","primary","style","position: fixed; top: 0;",4,"ngIf"],[3,"ngStyle",4,"ngIf"],["acceptLabel","S\xed","icon","pi pi-exclamation-triangle","acceptButtonStyleClass","mt-4 vibe-btn text-green-500 text-base","rejectButtonStyleClass","mt-4 vibe-btn text-pink-500 text-base"],[3,"newVibeAdded"],["title","Sesi\xf3n expirada","message","Su sesi\xf3n ha terminado renueve su sesi\xf3n si desea seguir navegando",3,"display","expired","spotyExpired","showDialog"],[3,"display","showDialog"],["life","5000"],["mat-button","",1,"mat-sidenav-button","border-round-xl",3,"click"],[1,"flex","align-content-center","justify-content-center"],[1,"flex","align-items-center","align-content-center","justify-content-center"],[1,"flex","align-content-center","justify-content-center","align-items-center","mr-2"],["class","flex align-items-center align-content-center justify-content-center","severity","danger",3,"value",4,"ngIf"],["severity","danger",1,"flex","align-items-center","align-content-center","justify-content-center",3,"value"],[1,"flex","align-content-center","relative","mt-2"],[1,"mx-auto","overflow-hidden",2,"height","40px","width","40px","border-radius","100%","box-shadow","0px 1px 5px 0px rgba(0,0,0,0.2)"],["style","height: 40px; width: 40px; object-fit: cover;",3,"src","alt",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","style","height: 40px; width: 40px; object-fit: cover; background: white;",3,"alt",4,"ngIf"],[1,"ml-2"],["class","mat-sidenav-user mt-1",4,"ngIf"],["class","mat-sidenav-email",4,"ngIf"],["mat-icon-button","",3,"click"],[1,"z-1","m-0","absolute",2,"right","0px","bottom","55px"],["menuDiv",""],[3,"model","viewportHeight","click",4,"ngIf"],[2,"height","40px","width","40px","object-fit","cover",3,"src","alt"],["src","assets/images/profilePlaceholder.svg",2,"height","40px","width","40px","object-fit","cover","background","white",3,"alt"],[1,"mat-sidenav-user","mt-1"],[1,"mat-sidenav-email"],[3,"model","viewportHeight","click"],["color","primary",2,"position","fixed","top","0"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],[2,"margin-left","1rem","font-weight","900"],[3,"ngStyle"]],template:function(e,o){1&e&&(P(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2)(3,"div",3)(4,"div",4)(5,"div",5),Ae(6,"img",6),W(7,fK,7,7,"button",7),P(8,"button",8),Te("click",function(){return o.showVibeDialog()}),P(9,"span",9),ie(10,"Crear vibe"),N()()()(),Ae(11,"div",10),P(12,"div",4)(13,"div",5)(14,"button",11),Te("click",function(){return o.appComponent.changeTheme(!0)}),P(15,"mat-icon",12),ie(16),N(),P(17,"span"),ie(18),N()(),Ae(19,"mat-divider"),W(20,bK,14,5,"div",13),N()()()(),P(21,"mat-sidenav-content"),W(22,xK,6,1,"mat-toolbar",14),W(23,TK,2,3,"div",15),N()(),Ae(24,"p-confirmDialog",16),P(25,"app-new-vibe-dialog",17),Te("newVibeAdded",function(s){return o.onAddedNewVibe(s)}),N(),P(26,"app-success-dialog",18),Te("showDialog",function(s){return o.hideExpiedDialog(s)}),N(),P(27,"app-push-notifications-dialog",19),Te("showDialog",function(){return o.hidePushNotificationsDialog()}),N(),Ae(28,"p-toast",20)),2&e&&(F(1),L("autoFocus",!1),F(6),L("ngForOf",o.sidenavItems),F(9),Ut(o.appComponent.themeIcon),F(2),jn(" ",o.appComponent.themeTag," "),F(2),L("ngIf",!o.expired),F(2),L("ngIf",o.showBar),F(1),L("ngIf",!o.expired),F(3),L("display",o.displayExpiredDialog)("expired",!0)("spotyExpired",o.spotyExpired),F(1),L("display",o.displayPushNotificationsDialog))},styles:['@font-face{font-family:Material Icons;font-style:normal;font-weight:400;font-display:block;src:url(material-icons.59322316b3fd6063.woff2) format("woff2"),url(material-icons.4ad034d2c499d9b6.woff) format("woff")}.material-icons[_ngcontent-%COMP%]{font-family:Material Icons;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}@font-face{font-family:Material Icons Outlined;font-style:normal;font-weight:400;font-display:block;src:url(material-icons-outlined.f86cb7b0aa53f0fe.woff2) format("woff2"),url(material-icons-outlined.78a93b2079680a08.woff) format("woff")}.material-icons-outlined[_ngcontent-%COMP%]{font-family:Material Icons Outlined;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}@font-face{font-family:Material Icons Round;font-style:normal;font-weight:400;font-display:block;src:url(material-icons-round.b10ec9db5b7fbc74.woff2) format("woff2"),url(material-icons-round.92dc7ca2f4c591e7.woff) format("woff")}.material-icons-round[_ngcontent-%COMP%]{font-family:Material Icons Round;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}@font-face{font-family:Material Icons Sharp;font-style:normal;font-weight:400;font-display:block;src:url(material-icons-sharp.3885863ee4746422.woff2) format("woff2"),url(material-icons-sharp.a71cb2bf66c604de.woff) format("woff")}.material-icons-sharp[_ngcontent-%COMP%]{font-family:Material Icons Sharp;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}@font-face{font-family:Material Icons Two Tone;font-style:normal;font-weight:400;font-display:block;src:url(material-icons-two-tone.675bd578bd14533e.woff2) format("woff2"),url(material-icons-two-tone.588d63134de807a7.woff) format("woff")}.material-icons-two-tone[_ngcontent-%COMP%]{font-family:Material Icons Two Tone;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"liga"}.mat-toolbar[_ngcontent-%COMP%]{background-color:var(--containerBackground);color:var(--fontColor);box-shadow:var(--shadows);height:4rem;position:relative;z-index:10}.mat-sidenav[_ngcontent-%COMP%]{width:265px;border-right:none;background:var(--gradientVertical);color:#fff;text-align:center}.mat-sidenav-container[_ngcontent-%COMP%]{transition:var(--transition);background-color:var(--background)}.mat-sidenav-button[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:start;font-size:1rem;color:#fff!important;letter-spacing:normal;margin-top:.3rem;font-family:Lato;height:3rem}.mat-sidenav-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5rem;margin-left:.5rem;font-size:1rem}.mat-sidenav-elements[_ngcontent-%COMP%]{width:228px}.sidenav-button-selected[_ngcontent-%COMP%]{font-weight:bolder;color:#fff;background:rgba(255,255,255,.1568627451)}.mat-sidenav-user[_ngcontent-%COMP%]{text-align:left}.mat-sidenav-email[_ngcontent-%COMP%]{font-size:.8rem;font-weight:400;text-align:left}.top-tar-full[_ngcontent-%COMP%]{background:var(--topBarGradient)}@media (max-width: 767px){.landing-image[_ngcontent-%COMP%]{position:absolute;inset:-9999px;margin:auto}}[_nghost-%COMP%]     .p-dialog{border-radius:1rem}[_nghost-%COMP%]     .p-dialog-header{border-top-left-radius:1rem;border-top-right-radius:1rem}[_nghost-%COMP%]     .p-dialog-footer{border-bottom-left-radius:1rem;border-bottom-right-radius:1rem}']}),t})(),Ne=(()=>{class t{static addClass(e,o){e&&o&&(e.classList?e.classList.add(o):e.className+=" "+o)}static addMultipleClasses(e,o){if(e&&o)if(e.classList){let r=o.trim().split(" ");for(let s=0;s<r.length;s++)e.classList.add(r[s])}else{let r=o.split(" ");for(let s=0;s<r.length;s++)e.className+=" "+r[s]}}static removeClass(e,o){e&&o&&(e.classList?e.classList.remove(o):e.className=e.className.replace(new RegExp("(^|\\b)"+o.split(" ").join("|")+"(\\b|$)","gi")," "))}static hasClass(e,o){return!(!e||!o)&&(e.classList?e.classList.contains(o):new RegExp("(^| )"+o+"( |$)","gi").test(e.className))}static siblings(e){return Array.prototype.filter.call(e.parentNode.children,function(o){return o!==e})}static find(e,o){return Array.from(e.querySelectorAll(o))}static findSingle(e,o){return e?e.querySelector(o):null}static index(e){let o=e.parentNode.childNodes,r=0;for(var s=0;s<o.length;s++){if(o[s]==e)return r;1==o[s].nodeType&&r++}return-1}static indexWithinGroup(e,o){let r=e.parentNode?e.parentNode.childNodes:[],s=0;for(var l=0;l<r.length;l++){if(r[l]==e)return s;r[l].attributes&&r[l].attributes[o]&&1==r[l].nodeType&&s++}return-1}static appendOverlay(e,o,r="self"){"self"!==r&&e&&o&&this.appendChild(e,o)}static alignOverlay(e,o,r="self",s=!0){e&&o&&(s&&(e.style.minWidth||(e.style.minWidth=t.getOuterWidth(o)+"px")),"self"===r?this.relativePosition(e,o):this.absolutePosition(e,o))}static relativePosition(e,o){const r=X=>{if(X)return"relative"===getComputedStyle(X).getPropertyValue("position")?X:r(X.parentElement)},s=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),l=o.offsetHeight,h=o.getBoundingClientRect(),f=this.getWindowScrollTop(),y=this.getWindowScrollLeft(),C=this.getViewport(),R=r(e)?.getBoundingClientRect()||{top:-1*f,left:-1*y};let V,$;h.top+l+s.height>C.height?(V=h.top-R.top-s.height,e.style.transformOrigin="bottom",h.top+V<0&&(V=-1*h.top)):(V=l+h.top-R.top,e.style.transformOrigin="top"),$=s.width>C.width?-1*(h.left-R.left):h.left-R.left+s.width>C.width?-1*(h.left-R.left+s.width-C.width):h.left-R.left,e.style.top=V+"px",e.style.left=$+"px"}static absolutePosition(e,o){const r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),s=r.height,l=r.width,h=o.offsetHeight,f=o.offsetWidth,y=o.getBoundingClientRect(),C=this.getWindowScrollTop(),D=this.getWindowScrollLeft(),R=this.getViewport();let V,$;y.top+h+s>R.height?(V=y.top+C-s,e.style.transformOrigin="bottom",V<0&&(V=C)):(V=h+y.top+C,e.style.transformOrigin="top"),$=y.left+l>R.width?Math.max(0,y.left+D+f-l):y.left+D,e.style.top=V+"px",e.style.left=$+"px"}static getParents(e,o=[]){return null===e.parentNode?o:this.getParents(e.parentNode,o.concat([e.parentNode]))}static getScrollableParents(e){let o=[];if(e){let r=this.getParents(e);const s=/(auto|scroll)/,l=h=>{let f=window.getComputedStyle(h,null);return s.test(f.getPropertyValue("overflow"))||s.test(f.getPropertyValue("overflowX"))||s.test(f.getPropertyValue("overflowY"))};for(let h of r){let f=1===h.nodeType&&h.dataset.scrollselectors;if(f){let y=f.split(",");for(let C of y){let D=this.findSingle(h,C);D&&l(D)&&o.push(D)}}9!==h.nodeType&&l(h)&&o.push(h)}}return o}static getHiddenElementOuterHeight(e){e.style.visibility="hidden",e.style.display="block";let o=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",o}static getHiddenElementOuterWidth(e){e.style.visibility="hidden",e.style.display="block";let o=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",o}static getHiddenElementDimensions(e){let o={};return e.style.visibility="hidden",e.style.display="block",o.width=e.offsetWidth,o.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",o}static scrollInView(e,o){let r=getComputedStyle(e).getPropertyValue("borderTopWidth"),s=r?parseFloat(r):0,l=getComputedStyle(e).getPropertyValue("paddingTop"),h=l?parseFloat(l):0,f=e.getBoundingClientRect(),C=o.getBoundingClientRect().top+document.body.scrollTop-(f.top+document.body.scrollTop)-s-h,D=e.scrollTop,R=e.clientHeight,V=this.getOuterHeight(o);C<0?e.scrollTop=D+C:C+V>R&&(e.scrollTop=D+C-R+V)}static fadeIn(e,o){e.style.opacity=0;let r=+new Date,s=0,l=function(){s=+e.style.opacity.replace(",",".")+((new Date).getTime()-r)/o,e.style.opacity=s,r=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(l)||setTimeout(l,16))};l()}static fadeOut(e,o){var r=1,h=50/o;let f=setInterval(()=>{(r-=h)<=0&&(r=0,clearInterval(f)),e.style.opacity=r},50)}static getWindowScrollTop(){let e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}static getWindowScrollLeft(){let e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}static matches(e,o){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(l){return-1!==[].indexOf.call(document.querySelectorAll(l),this)}).call(e,o)}static getOuterWidth(e,o){let r=e.offsetWidth;if(o){let s=getComputedStyle(e);r+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return r}static getHorizontalPadding(e){let o=getComputedStyle(e);return parseFloat(o.paddingLeft)+parseFloat(o.paddingRight)}static getHorizontalMargin(e){let o=getComputedStyle(e);return parseFloat(o.marginLeft)+parseFloat(o.marginRight)}static innerWidth(e){let o=e.offsetWidth,r=getComputedStyle(e);return o+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),o}static width(e){let o=e.offsetWidth,r=getComputedStyle(e);return o-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),o}static getInnerHeight(e){let o=e.offsetHeight,r=getComputedStyle(e);return o+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),o}static getOuterHeight(e,o){let r=e.offsetHeight;if(o){let s=getComputedStyle(e);r+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return r}static getHeight(e){let o=e.offsetHeight,r=getComputedStyle(e);return o-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),o}static getWidth(e){let o=e.offsetWidth,r=getComputedStyle(e);return o-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),o}static getViewport(){let e=window,o=document,r=o.documentElement,s=o.getElementsByTagName("body")[0];return{width:e.innerWidth||r.clientWidth||s.clientWidth,height:e.innerHeight||r.clientHeight||s.clientHeight}}static getOffset(e){var o=e.getBoundingClientRect();return{top:o.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:o.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(e,o){let r=e.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(o,e)}static getUserAgent(){return navigator.userAgent}static isIE(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||(e.indexOf("Trident/")>0?(e.indexOf("rv:"),!0):e.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(e,o){if(this.isElement(o))o.appendChild(e);else{if(!o.el||!o.el.nativeElement)throw"Cannot append "+o+" to "+e;o.el.nativeElement.appendChild(e)}}static removeChild(e,o){if(this.isElement(o))o.removeChild(e);else{if(!o.el||!o.el.nativeElement)throw"Cannot remove "+e+" from "+o;o.el.nativeElement.removeChild(e)}}static removeElement(e){"remove"in Element.prototype?e.remove():e.parentNode.removeChild(e)}static isElement(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}static calculateScrollbarWidth(e){if(e){let o=getComputedStyle(e);return e.offsetWidth-e.clientWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let o=document.createElement("div");o.className="p-scrollbar-measure",document.body.appendChild(o);let r=o.offsetWidth-o.clientWidth;return document.body.removeChild(o),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let e=document.createElement("div");e.className="p-scrollbar-measure",document.body.appendChild(e);let o=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),this.calculatedScrollbarWidth=o,o}static invokeElementMethod(e,o,r){e[o].apply(e,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let e=navigator.userAgent.toLowerCase(),o=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:o[1]||"",version:o[2]||"0"}}static isInteger(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}static isHidden(e){return!e||null===e.offsetParent}static isVisible(e){return e&&null!=e.offsetParent}static isExist(e){return null!==e&&typeof e<"u"&&e.nodeName&&e.parentNode}static focus(e,o){e&&document.activeElement!==e&&e.focus(o)}static getFocusableElements(e){let o=t.find(e,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let s of o)(s.offsetWidth||s.offsetHeight||s.getClientRects().length)&&r.push(s);return r}static getNextFocusableElement(e,o=!1){const r=t.getFocusableElements(e);let s=0;if(r&&r.length>0){const l=r.indexOf(r[0].ownerDocument.activeElement);o?s=-1==l||0===l?r.length-1:l-1:-1!=l&&l!==r.length-1&&(s=l+1)}return r[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(e,o){if(!e)return null;switch(e){case"document":return document;case"window":return window;case"@next":return o?.nextElementSibling;case"@prev":return o?.previousElementSibling;case"@parent":return o?.parentElement;case"@grandparent":return o?.parentElement.parentElement;default:const r=typeof e;if("string"===r)return document.querySelector(e);if("object"===r&&e.hasOwnProperty("nativeElement"))return this.isExist(e.nativeElement)?e.nativeElement:void 0;const l=(h=e)&&h.constructor&&h.call&&h.apply?e():e;return l&&9===l.nodeType||this.isExist(l)?l:null}var h}}return t.zindex=1e3,t.calculatedScrollbarWidth=null,t.calculatedScrollbarHeight=null,t})();class w0{constructor(n,e=(()=>{})){this.element=n,this.listener=e}bindScrollListener(){this.scrollableParents=Ne.getScrollableParents(this.element);for(let n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}let Iu=(()=>{class t{constructor(e,o,r){this.el=e,this.zone=o,this.config=r}ngAfterViewInit(){this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.onMouseDown.bind(this),this.el.nativeElement.addEventListener("mousedown",this.mouseDownListener)})}onMouseDown(e){let o=this.getInk();if(!o||"none"===getComputedStyle(o,null).display)return;if(Ne.removeClass(o,"p-ink-active"),!Ne.getHeight(o)&&!Ne.getWidth(o)){let h=Math.max(Ne.getOuterWidth(this.el.nativeElement),Ne.getOuterHeight(this.el.nativeElement));o.style.height=h+"px",o.style.width=h+"px"}let r=Ne.getOffset(this.el.nativeElement),s=e.pageX-r.left+document.body.scrollTop-Ne.getWidth(o)/2,l=e.pageY-r.top+document.body.scrollLeft-Ne.getHeight(o)/2;o.style.top=l+"px",o.style.left=s+"px",Ne.addClass(o,"p-ink-active"),this.timeout=setTimeout(()=>{let h=this.getInk();h&&Ne.removeClass(h,"p-ink-active")},401)}getInk(){const e=this.el.nativeElement.children;for(let o=0;o<e.length;o++)if("string"==typeof e[o].className&&-1!==e[o].className.indexOf("p-ink"))return e[o];return null}resetInk(){let e=this.getInk();e&&Ne.removeClass(e,"p-ink-active")}onAnimationEnd(e){this.timeout&&clearTimeout(this.timeout),Ne.removeClass(e.currentTarget,"p-ink-active")}create(){let e=document.createElement("span");e.className="p-ink",this.el.nativeElement.appendChild(e),this.animationListener=this.onAnimationEnd.bind(this),e.addEventListener("animationend",this.animationListener)}remove(){let e=this.getInk();e&&(this.el.nativeElement.removeEventListener("mousedown",this.mouseDownListener),e.removeEventListener("animationend",this.animationListener),Ne.removeElement(e))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(yi),ce(fl,8))},t.\u0275dir=On({type:t,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]}),t})(),ml=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();function SK(t,n){1&t&&$t(0)}const EK=function(t,n,e,o){return{"p-button-icon":!0,"p-button-icon-left":t,"p-button-icon-right":n,"p-button-icon-top":e,"p-button-icon-bottom":o}};function IK(t,n){if(1&t&&Ae(0,"span",4),2&t){const e=U();Zn(e.loading?"p-button-loading-icon "+e.loadingIcon:e.icon),L("ngClass",vu(4,EK,"left"===e.iconPos&&e.label,"right"===e.iconPos&&e.label,"top"===e.iconPos&&e.label,"bottom"===e.iconPos&&e.label)),at("aria-hidden",!0)}}function DK(t,n){if(1&t&&(P(0,"span",5),ie(1),N()),2&t){const e=U();at("aria-hidden",e.icon&&!e.label),F(1),Ut(e.label)}}function MK(t,n){if(1&t&&(P(0,"span",4),ie(1),N()),2&t){const e=U();Zn(e.badgeClass),L("ngClass",e.badgeStyleClass()),F(1),Ut(e.badge)}}const kK=function(t,n,e,o,r){return{"p-button p-component":!0,"p-button-icon-only":t,"p-button-vertical":n,"p-disabled":e,"p-button-loading":o,"p-button-loading-label-only":r}},AK=["*"],kg={button:"p-button",component:"p-component",iconOnly:"p-button-icon-only",disabled:"p-disabled",loading:"p-button-loading",labelOnly:"p-button-loading-label-only"};let Dr=(()=>{class t{constructor(e){this.el=e,this.iconPos="left",this.loadingIcon="pi pi-spinner pi-spin",this._loading=!1,this._internalClasses=Object.values(kg)}get label(){return this._label}set label(e){this._label=e,this.initialized&&(this.updateLabel(),this.updateIcon(),this.setStyleClass())}get icon(){return this._icon}set icon(e){this._icon=e,this.initialized&&(this.updateIcon(),this.setStyleClass())}get loading(){return this._loading}set loading(e){this._loading=e,this.initialized&&(this.updateIcon(),this.setStyleClass())}get htmlElement(){return this.el.nativeElement}ngAfterViewInit(){Ne.addMultipleClasses(this.htmlElement,this.getStyleClass().join(" ")),this.createIcon(),this.createLabel(),this.initialized=!0}getStyleClass(){const e=[kg.button,kg.component];return this.icon&&!this.label&&xn.isEmpty(this.htmlElement.textContent)&&e.push(kg.iconOnly),this.loading&&(e.push(kg.disabled,kg.loading),!this.icon&&this.label&&e.push(kg.labelOnly)),e}setStyleClass(){const e=this.getStyleClass();this.htmlElement.classList.remove(...this._internalClasses),this.htmlElement.classList.add(...e)}createLabel(){if(this.label){let e=document.createElement("span");this.icon&&!this.label&&e.setAttribute("aria-hidden","true"),e.className="p-button-label",e.appendChild(document.createTextNode(this.label)),this.htmlElement.appendChild(e)}}createIcon(){if(this.icon||this.loading){let e=document.createElement("span");e.className="p-button-icon",e.setAttribute("aria-hidden","true");let o=this.label?"p-button-icon-"+this.iconPos:null;o&&Ne.addClass(e,o);let r=this.getIconClass();r&&Ne.addMultipleClasses(e,r),this.htmlElement.insertBefore(e,this.htmlElement.firstChild)}}updateLabel(){let e=Ne.findSingle(this.htmlElement,".p-button-label");this.label?e?e.textContent=this.label:this.createLabel():e&&this.htmlElement.removeChild(e)}updateIcon(){let e=Ne.findSingle(this.htmlElement,".p-button-icon");this.icon||this.loading?e?e.className=this.iconPos?"p-button-icon p-button-icon-"+this.iconPos+" "+this.getIconClass():"p-button-icon "+this.getIconClass():this.createIcon():e&&this.htmlElement.removeChild(e)}getIconClass(){return this.loading?"p-button-loading-icon "+this.loadingIcon:this._icon}ngOnDestroy(){this.initialized=!1}}return t.\u0275fac=function(e){return new(e||t)(ce(gi))},t.\u0275dir=On({type:t,selectors:[["","pButton",""]],hostAttrs:[1,"p-element"],inputs:{iconPos:"iconPos",loadingIcon:"loadingIcon",label:"label",icon:"icon",loading:"loading"}}),t})(),PK=(()=>{class t{constructor(){this.type="button",this.iconPos="left",this.loading=!1,this.loadingIcon="pi pi-spinner pi-spin",this.onClick=new ht,this.onFocus=new ht,this.onBlur=new ht}ngAfterContentInit(){this.templates.forEach(e=>{e.getType(),this.contentTemplate=e.template})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&1===String(this.badge).length}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["p-button"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},hostAttrs:[1,"p-element"],inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:"disabled",loading:"loading",loadingIcon:"loadingIcon",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},ngContentSelectors:AK,decls:6,vars:17,consts:[["pRipple","",3,"ngStyle","disabled","ngClass","click","focus","blur"],[4,"ngTemplateOutlet"],[3,"ngClass","class",4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass"],[1,"p-button-label"]],template:function(e,o){1&e&&(hr(),P(0,"button",0),Te("click",function(s){return o.onClick.emit(s)})("focus",function(s){return o.onFocus.emit(s)})("blur",function(s){return o.onBlur.emit(s)}),ro(1),W(2,SK,1,0,"ng-container",1),W(3,IK,1,9,"span",2),W(4,DK,2,2,"span",3),W(5,MK,2,4,"span",2),N()),2&e&&(Zn(o.styleClass),L("ngStyle",o.style)("disabled",o.disabled||o.loading)("ngClass",wb(11,kK,o.icon&&!o.label,("top"===o.iconPos||"bottom"===o.iconPos)&&o.label,o.disabled||o.loading,o.loading,o.loading&&!o.icon&&o.label)),at("type",o.type)("aria-label",o.ariaLabel),F(2),L("ngTemplateOutlet",o.contentTemplate),F(1),L("ngIf",!o.contentTemplate&&(o.icon||o.loading)),F(1),L("ngIf",!o.contentTemplate&&o.label),F(1),L("ngIf",!o.contentTemplate&&o.badge))},dependencies:[ao,Xn,Cs,ho,Iu],encapsulation:2,changeDetection:0}),t})(),gl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,ml]}),t})(),_l=(()=>{class t{constructor(e,o,r){this.el=e,this.ngModel=o,this.cd=r}ngAfterViewInit(){this.updateFilledState(),this.cd.detectChanges()}ngDoCheck(){this.updateFilledState()}onInput(e){this.updateFilledState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length||this.ngModel&&this.ngModel.model}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Id,8),ce(Fo))},t.\u0275dir=On({type:t,selectors:[["","pInputText",""]],hostAttrs:[1,"p-inputtext","p-component","p-element"],hostVars:2,hostBindings:function(e,o){1&e&&Te("input",function(s){return o.onInput(s)}),2&e&&Ro("p-filled",o.filled)}}),t})(),Nf=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();const OK=["container"],LK=["inputfield"],RK=["contentWrapper"];function FK(t,n){if(1&t){const e=Ye();P(0,"i",8),Te("click",function(){return be(e),ve(U(2).clear())}),N()}}function NK(t,n){if(1&t){const e=Ye();P(0,"button",9),Te("click",function(r){be(e),U();const s=Un(1);return ve(U().onButtonClick(r,s))}),N()}if(2&t){const e=U(2);L("icon",e.icon)("disabled",e.disabled),at("aria-label",e.iconAriaLabel)}}function zK(t,n){if(1&t){const e=Ye();P(0,"input",4,5),Te("focus",function(r){return be(e),ve(U().onInputFocus(r))})("keydown",function(r){return be(e),ve(U().onInputKeydown(r))})("click",function(){return be(e),ve(U().onInputClick())})("blur",function(r){return be(e),ve(U().onInputBlur(r))})("input",function(r){return be(e),ve(U().onUserInput(r))}),N(),W(2,FK,1,0,"i",6),W(3,NK,1,3,"button",7)}if(2&t){const e=U();Zn(e.inputStyleClass),L("value",e.inputFieldValue)("readonly",e.readonlyInput)("ngStyle",e.inputStyle)("placeholder",e.placeholder||"")("disabled",e.disabled)("ngClass","p-inputtext p-component"),at("id",e.inputId)("name",e.name)("required",e.required)("aria-required",e.required)("tabindex",e.tabindex)("inputmode",e.touchUI?"off":null)("aria-labelledby",e.ariaLabelledBy),F(2),L("ngIf",e.showClear&&!e.disabled&&null!=e.value),F(1),L("ngIf",e.showIcon)}}function BK(t,n){1&t&&$t(0)}function VK(t,n){if(1&t){const e=Ye();P(0,"button",30),Te("keydown",function(r){return be(e),ve(U(4).onContainerButtonKeydown(r))})("click",function(r){return be(e),ve(U(4).onPrevButtonClick(r))}),Ae(1,"span",31),N()}}function UK(t,n){if(1&t){const e=Ye();P(0,"button",32),Te("click",function(r){return be(e),ve(U(4).switchToMonthView(r))})("keydown",function(r){return be(e),ve(U(4).onContainerButtonKeydown(r))}),ie(1),N()}if(2&t){const e=U().$implicit,o=U(3);L("disabled",o.switchViewButtonDisabled()),F(1),jn(" ",o.getMonthName(e.month)," ")}}function jK(t,n){if(1&t){const e=Ye();P(0,"button",33),Te("click",function(r){return be(e),ve(U(4).switchToYearView(r))})("keydown",function(r){return be(e),ve(U(4).onContainerButtonKeydown(r))}),ie(1),N()}if(2&t){const e=U().$implicit,o=U(3);L("disabled",o.switchViewButtonDisabled()),F(1),jn(" ",o.getYear(e)," ")}}function HK(t,n){if(1&t&&(wn(0),ie(1),Pn()),2&t){const e=U(5);F(1),vf("",e.yearPickerValues()[0]," - ",e.yearPickerValues()[e.yearPickerValues().length-1],"")}}function $K(t,n){1&t&&$t(0)}const B3=function(t){return{$implicit:t}};function GK(t,n){if(1&t&&(P(0,"span",34),W(1,HK,2,2,"ng-container",13),W(2,$K,1,0,"ng-container",35),N()),2&t){const e=U(4);F(1),L("ngIf",!e.decadeTemplate),F(1),L("ngTemplateOutlet",e.decadeTemplate)("ngTemplateOutletContext",Wt(3,B3,e.yearPickerValues))}}function WK(t,n){if(1&t&&(P(0,"th",41)(1,"span"),ie(2),N()()),2&t){const e=U(5);F(2),Ut(e.getTranslation("weekHeader"))}}function qK(t,n){if(1&t&&(P(0,"th",42)(1,"span"),ie(2),N()()),2&t){const e=n.$implicit;F(2),Ut(e)}}function ZK(t,n){if(1&t&&(P(0,"td",45)(1,"span",46),ie(2),N()()),2&t){const e=U().index,o=U(2).$implicit;F(2),jn(" ",o.weekNumbers[e]," ")}}function KK(t,n){if(1&t&&(wn(0),ie(1),Pn()),2&t){const e=U(2).$implicit;F(1),Ut(e.day)}}function XK(t,n){1&t&&$t(0)}const V3=function(t,n){return{"p-highlight":t,"p-disabled":n}};function YK(t,n){if(1&t){const e=Ye();wn(0),P(1,"span",48),Te("click",function(r){be(e);const s=U().$implicit;return ve(U(6).onDateSelect(r,s))})("keydown",function(r){be(e);const s=U().$implicit,l=U(3).index;return ve(U(3).onDateCellKeydown(r,s,l))}),W(2,KK,2,1,"ng-container",13),W(3,XK,1,0,"ng-container",35),N(),Pn()}if(2&t){const e=U().$implicit,o=U(6);F(1),L("ngClass",Ji(4,V3,o.isSelected(e),!e.selectable)),F(1),L("ngIf",!o.dateTemplate),F(1),L("ngTemplateOutlet",o.dateTemplate)("ngTemplateOutletContext",Wt(7,B3,e))}}const QK=function(t,n){return{"p-datepicker-other-month":t,"p-datepicker-today":n}};function JK(t,n){if(1&t&&(P(0,"td",47),W(1,YK,4,9,"ng-container",13),N()),2&t){const e=n.$implicit,o=U(6);L("ngClass",Ji(2,QK,e.otherMonth,e.today)),F(1),L("ngIf",!e.otherMonth||o.showOtherMonths)}}function eX(t,n){if(1&t&&(P(0,"tr"),W(1,ZK,3,1,"td",43),W(2,JK,2,5,"td",44),N()),2&t){const e=n.$implicit,o=U(5);F(1),L("ngIf",o.showWeek),F(1),L("ngForOf",e)}}function tX(t,n){if(1&t&&(P(0,"div",36)(1,"table",37)(2,"thead")(3,"tr"),W(4,WK,3,1,"th",38),W(5,qK,3,1,"th",39),N()(),P(6,"tbody"),W(7,eX,3,2,"tr",40),N()()()),2&t){const e=U().$implicit,o=U(3);F(4),L("ngIf",o.showWeek),F(1),L("ngForOf",o.weekDays),F(2),L("ngForOf",e.dates)}}function nX(t,n){if(1&t){const e=Ye();P(0,"div",20)(1,"div",21),W(2,VK,2,0,"button",22),P(3,"div",23),W(4,UK,2,2,"button",24),W(5,jK,2,2,"button",25),W(6,GK,3,5,"span",26),N(),P(7,"button",27),Te("keydown",function(r){return be(e),ve(U(3).onContainerButtonKeydown(r))})("click",function(r){return be(e),ve(U(3).onNextButtonClick(r))}),Ae(8,"span",28),N()(),W(9,tX,8,3,"div",29),N()}if(2&t){const e=n.index,o=U(3);F(2),L("ngIf",0===e),F(2),L("ngIf","date"===o.currentView),F(1),L("ngIf","year"!==o.currentView),F(1),L("ngIf","year"===o.currentView),F(1),za("display",1===o.numberOfMonths||e===o.numberOfMonths-1?"inline-flex":"none"),F(2),L("ngIf","date"===o.currentView)}}function iX(t,n){if(1&t){const e=Ye();P(0,"span",51),Te("click",function(r){const l=be(e).index;return ve(U(4).onMonthSelect(r,l))})("keydown",function(r){const l=be(e).index;return ve(U(4).onMonthCellKeydown(r,l))}),ie(1),N()}if(2&t){const e=n.$implicit,o=n.index,r=U(4);L("ngClass",Ji(2,V3,r.isMonthSelected(o),r.isMonthDisabled(o))),F(1),jn(" ",e," ")}}function oX(t,n){if(1&t&&(P(0,"div",49),W(1,iX,2,5,"span",50),N()),2&t){const e=U(3);F(1),L("ngForOf",e.monthPickerValues())}}const rX=function(t){return{"p-highlight":t}};function sX(t,n){if(1&t){const e=Ye();P(0,"span",54),Te("click",function(r){const l=be(e).$implicit;return ve(U(4).onYearSelect(r,l))})("keydown",function(r){const l=be(e).$implicit;return ve(U(4).onYearCellKeydown(r,l))}),ie(1),N()}if(2&t){const e=n.$implicit,o=U(4);L("ngClass",Wt(2,rX,o.isYearSelected(e))),F(1),jn(" ",e," ")}}function aX(t,n){if(1&t&&(P(0,"div",52),W(1,sX,2,4,"span",53),N()),2&t){const e=U(3);F(1),L("ngForOf",e.yearPickerValues())}}function lX(t,n){if(1&t&&(wn(0),P(1,"div",16),W(2,nX,10,7,"div",17),N(),W(3,oX,2,1,"div",18),W(4,aX,2,1,"div",19),Pn()),2&t){const e=U(2);F(2),L("ngForOf",e.months),F(1),L("ngIf","month"===e.currentView),F(1),L("ngIf","year"===e.currentView)}}function cX(t,n){1&t&&(wn(0),ie(1,"0"),Pn())}function uX(t,n){1&t&&(wn(0),ie(1,"0"),Pn())}function dX(t,n){if(1&t&&(P(0,"div",60)(1,"span"),ie(2),N()()),2&t){const e=U(3);F(2),Ut(e.timeSeparator)}}function hX(t,n){1&t&&(wn(0),ie(1,"0"),Pn())}function pX(t,n){if(1&t){const e=Ye();P(0,"div",65)(1,"button",57),Te("keydown",function(r){return be(e),ve(U(3).onContainerButtonKeydown(r))})("keydown.enter",function(r){return be(e),ve(U(3).incrementSecond(r))})("keydown.space",function(r){return be(e),ve(U(3).incrementSecond(r))})("mousedown",function(r){return be(e),ve(U(3).onTimePickerElementMouseDown(r,2,1))})("mouseup",function(r){return be(e),ve(U(3).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return be(e),ve(U(3).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return be(e),ve(U(3).onTimePickerElementMouseUp(r))})("mouseleave",function(){return be(e),ve(U(3).onTimePickerElementMouseLeave())}),Ae(2,"span",58),N(),P(3,"span"),W(4,hX,2,0,"ng-container",13),ie(5),N(),P(6,"button",57),Te("keydown",function(r){return be(e),ve(U(3).onContainerButtonKeydown(r))})("keydown.enter",function(r){return be(e),ve(U(3).decrementSecond(r))})("keydown.space",function(r){return be(e),ve(U(3).decrementSecond(r))})("mousedown",function(r){return be(e),ve(U(3).onTimePickerElementMouseDown(r,2,-1))})("mouseup",function(r){return be(e),ve(U(3).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return be(e),ve(U(3).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return be(e),ve(U(3).onTimePickerElementMouseUp(r))})("mouseleave",function(){return be(e),ve(U(3).onTimePickerElementMouseLeave())}),Ae(7,"span",59),N()()}if(2&t){const e=U(3);F(4),L("ngIf",e.currentSecond<10),F(1),Ut(e.currentSecond)}}function fX(t,n){if(1&t){const e=Ye();P(0,"div",66)(1,"button",67),Te("keydown",function(r){return be(e),ve(U(3).onContainerButtonKeydown(r))})("click",function(r){return be(e),ve(U(3).toggleAMPM(r))})("keydown.enter",function(r){return be(e),ve(U(3).toggleAMPM(r))}),Ae(2,"span",58),N(),P(3,"span"),ie(4),N(),P(5,"button",67),Te("keydown",function(r){return be(e),ve(U(3).onContainerButtonKeydown(r))})("click",function(r){return be(e),ve(U(3).toggleAMPM(r))})("keydown.enter",function(r){return be(e),ve(U(3).toggleAMPM(r))}),Ae(6,"span",59),N()()}if(2&t){const e=U(3);F(4),Ut(e.pm?"PM":"AM")}}function mX(t,n){if(1&t){const e=Ye();P(0,"div",55)(1,"div",56)(2,"button",57),Te("keydown",function(r){return be(e),ve(U(2).onContainerButtonKeydown(r))})("keydown.enter",function(r){return be(e),ve(U(2).incrementHour(r))})("keydown.space",function(r){return be(e),ve(U(2).incrementHour(r))})("mousedown",function(r){return be(e),ve(U(2).onTimePickerElementMouseDown(r,0,1))})("mouseup",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("mouseleave",function(){return be(e),ve(U(2).onTimePickerElementMouseLeave())}),Ae(3,"span",58),N(),P(4,"span"),W(5,cX,2,0,"ng-container",13),ie(6),N(),P(7,"button",57),Te("keydown",function(r){return be(e),ve(U(2).onContainerButtonKeydown(r))})("keydown.enter",function(r){return be(e),ve(U(2).decrementHour(r))})("keydown.space",function(r){return be(e),ve(U(2).decrementHour(r))})("mousedown",function(r){return be(e),ve(U(2).onTimePickerElementMouseDown(r,0,-1))})("mouseup",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("mouseleave",function(){return be(e),ve(U(2).onTimePickerElementMouseLeave())}),Ae(8,"span",59),N()(),P(9,"div",60)(10,"span"),ie(11),N()(),P(12,"div",61)(13,"button",57),Te("keydown",function(r){return be(e),ve(U(2).onContainerButtonKeydown(r))})("keydown.enter",function(r){return be(e),ve(U(2).incrementMinute(r))})("keydown.space",function(r){return be(e),ve(U(2).incrementMinute(r))})("mousedown",function(r){return be(e),ve(U(2).onTimePickerElementMouseDown(r,1,1))})("mouseup",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("mouseleave",function(){return be(e),ve(U(2).onTimePickerElementMouseLeave())}),Ae(14,"span",58),N(),P(15,"span"),W(16,uX,2,0,"ng-container",13),ie(17),N(),P(18,"button",57),Te("keydown",function(r){return be(e),ve(U(2).onContainerButtonKeydown(r))})("keydown.enter",function(r){return be(e),ve(U(2).decrementMinute(r))})("keydown.space",function(r){return be(e),ve(U(2).decrementMinute(r))})("mousedown",function(r){return be(e),ve(U(2).onTimePickerElementMouseDown(r,1,-1))})("mouseup",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("keyup.enter",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("keyup.space",function(r){return be(e),ve(U(2).onTimePickerElementMouseUp(r))})("mouseleave",function(){return be(e),ve(U(2).onTimePickerElementMouseLeave())}),Ae(19,"span",59),N()(),W(20,dX,3,1,"div",62),W(21,pX,8,2,"div",63),W(22,fX,7,1,"div",64),N()}if(2&t){const e=U(2);F(5),L("ngIf",e.currentHour<10),F(1),Ut(e.currentHour),F(5),Ut(e.timeSeparator),F(5),L("ngIf",e.currentMinute<10),F(1),Ut(e.currentMinute),F(3),L("ngIf",e.showSeconds),F(1),L("ngIf",e.showSeconds),F(1),L("ngIf","12"==e.hourFormat)}}const U3=function(t){return[t]};function gX(t,n){if(1&t){const e=Ye();P(0,"div",68)(1,"button",69),Te("keydown",function(r){return be(e),ve(U(2).onContainerButtonKeydown(r))})("click",function(r){return be(e),ve(U(2).onTodayButtonClick(r))}),N(),P(2,"button",69),Te("keydown",function(r){return be(e),ve(U(2).onContainerButtonKeydown(r))})("click",function(r){return be(e),ve(U(2).onClearButtonClick(r))}),N()()}if(2&t){const e=U(2);F(1),L("label",e.getTranslation("today"))("ngClass",Wt(4,U3,e.todayButtonStyleClass)),F(1),L("label",e.getTranslation("clear"))("ngClass",Wt(6,U3,e.clearButtonStyleClass))}}function _X(t,n){1&t&&$t(0)}const yX=function(t,n,e,o,r,s){return{"p-datepicker p-component":!0,"p-datepicker-inline":t,"p-disabled":n,"p-datepicker-timeonly":e,"p-datepicker-multiple-month":o,"p-datepicker-monthpicker":r,"p-datepicker-touch-ui":s}},j3=function(t,n){return{showTransitionParams:t,hideTransitionParams:n}},vX=function(t){return{value:"visibleTouchUI",params:t}},bX=function(t){return{value:"visible",params:t}};function xX(t,n){if(1&t){const e=Ye();P(0,"div",10,11),Te("@overlayAnimation.start",function(r){return be(e),ve(U().onOverlayAnimationStart(r))})("@overlayAnimation.done",function(r){return be(e),ve(U().onOverlayAnimationDone(r))})("click",function(r){return be(e),ve(U().onOverlayClick(r))}),ro(2),W(3,BK,1,0,"ng-container",12),W(4,lX,5,3,"ng-container",13),W(5,mX,23,8,"div",14),W(6,gX,3,8,"div",15),ro(7,1),W(8,_X,1,0,"ng-container",12),N()}if(2&t){const e=U();Zn(e.panelStyleClass),L("ngStyle",e.panelStyle)("ngClass",ry(11,yX,e.inline,e.disabled,e.timeOnly,e.numberOfMonths>1,"month"===e.view,e.touchUI))("@overlayAnimation",e.touchUI?Wt(21,vX,Ji(18,j3,e.showTransitionOptions,e.hideTransitionOptions)):Wt(26,bX,Ji(23,j3,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",!0===e.inline),F(3),L("ngTemplateOutlet",e.headerTemplate),F(1),L("ngIf",!e.timeOnly),F(1),L("ngIf",(e.showTime||e.timeOnly)&&"date"===e.currentView),F(1),L("ngIf",e.showButtonBar),F(2),L("ngTemplateOutlet",e.footerTemplate)}}const wX=[[["p-header"]],[["p-footer"]]],CX=function(t,n,e,o){return{"p-calendar":!0,"p-calendar-w-btn":t,"p-calendar-timeonly":n,"p-calendar-disabled":e,"p-focus":o}},TX=["p-header","p-footer"],SX={provide:zs,useExisting:Ei(()=>EX),multi:!0};let EX=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.renderer=o,this.cd=r,this.zone=s,this.config=l,this.overlayService=h,this.multipleSeparator=",",this.rangeSeparator="-",this.inline=!1,this.showOtherMonths=!0,this.icon="pi pi-calendar",this.shortYearCutoff="+10",this.hourFormat="24",this.stepHour=1,this.stepMinute=1,this.stepSecond=1,this.showSeconds=!1,this.showOnFocus=!0,this.showWeek=!1,this.showClear=!1,this.dataType="date",this.selectionMode="single",this.todayButtonStyleClass="p-button-text",this.clearButtonStyleClass="p-button-text",this.autoZIndex=!0,this.baseZIndex=0,this.keepInvalid=!1,this.hideOnDateTimeSelect=!0,this.timeSeparator=":",this.focusTrap=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.onFocus=new ht,this.onBlur=new ht,this.onClose=new ht,this.onSelect=new ht,this.onClear=new ht,this.onInput=new ht,this.onTodayClick=new ht,this.onClearClick=new ht,this.onMonthChange=new ht,this.onYearChange=new ht,this.onClickOutside=new ht,this.onShow=new ht,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.inputFieldValue=null,this.navigationState=null,this._numberOfMonths=1,this._view="date",this.convertTo24Hour=function(f,y){return"12"==this.hourFormat?12===f?y?12:0:y?f+12:f:f}}set content(e){this.contentViewChild=e,this.contentViewChild&&(this.isMonthNavigate?(Promise.resolve(null).then(()=>this.updateFocus()),this.isMonthNavigate=!1):this.focus||this.initFocusableCell())}get view(){return this._view}set view(e){this._view=e,this.currentView=this._view}get defaultDate(){return this._defaultDate}set defaultDate(e){if(this._defaultDate=e,this.initialized){const o=e||new Date;this.currentMonth=o.getMonth(),this.currentYear=o.getFullYear(),this.initTime(o),this.createMonths(this.currentMonth,this.currentYear)}}get minDate(){return this._minDate}set minDate(e){this._minDate=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDates(){return this._disabledDates}set disabledDates(e){this._disabledDates=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDays(){return this._disabledDays}set disabledDays(e){this._disabledDays=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get yearRange(){return this._yearRange}set yearRange(e){if(this._yearRange=e,e){const o=e.split(":"),r=parseInt(o[0]),s=parseInt(o[1]);this.populateYearOptions(r,s)}}get showTime(){return this._showTime}set showTime(e){this._showTime=e,void 0===this.currentHour&&this.initTime(this.value||new Date),this.updateInputfield()}get locale(){return this._locale}get responsiveOptions(){return this._responsiveOptions}set responsiveOptions(e){this._responsiveOptions=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get numberOfMonths(){return this._numberOfMonths}set numberOfMonths(e){this._numberOfMonths=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get firstDayOfWeek(){return this._firstDayOfWeek}set firstDayOfWeek(e){this._firstDayOfWeek=e,this.createWeekDays()}set locale(e){console.warn("Locale property has no effect, use new i18n API instead.")}ngOnInit(){this.attributeSelector=Ig();const e=this.defaultDate||new Date;this.createResponsiveStyle(),this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear(),this.currentView=this.view,"date"===this.view&&(this.createWeekDays(),this.initTime(e),this.createMonths(this.currentMonth,this.currentYear),this.ticksTo1970=24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.createWeekDays(),this.cd.markForCheck()}),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"date":default:this.dateTemplate=e.template;break;case"decade":this.decadeTemplate=e.template;break;case"disabledDate":this.disabledDateTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngAfterViewInit(){this.inline&&(this.contentViewChild&&this.contentViewChild.nativeElement.setAttribute(this.attributeSelector,""),this.disabled||(this.initFocusableCell(),1===this.numberOfMonths&&(this.contentViewChild.nativeElement.style.width=Ne.getOuterWidth(this.containerViewChild.nativeElement)+"px")))}getTranslation(e){return this.config.getTranslation(e)}populateYearOptions(e,o){this.yearOptions=[];for(let r=e;r<=o;r++)this.yearOptions.push(r)}createWeekDays(){this.weekDays=[];let e=this.getFirstDateOfWeek(),o=this.getTranslation(zr.DAY_NAMES_MIN);for(let r=0;r<7;r++)this.weekDays.push(o[e]),e=6==e?0:++e}monthPickerValues(){let e=[];for(let o=0;o<=11;o++)e.push(this.config.getTranslation("monthNamesShort")[o]);return e}yearPickerValues(){let e=[],o=this.currentYear-this.currentYear%10;for(let r=0;r<10;r++)e.push(o+r);return e}createMonths(e,o){this.months=this.months=[];for(let r=0;r<this.numberOfMonths;r++){let s=e+r,l=o;s>11&&(s=s%11-1,l=o+1),this.months.push(this.createMonth(s,l))}}getWeekNumber(e){let o=new Date(e.getTime());o.setDate(o.getDate()+4-(o.getDay()||7));let r=o.getTime();return o.setMonth(0),o.setDate(1),Math.floor(Math.round((r-o.getTime())/864e5)/7)+1}createMonth(e,o){let r=[],s=this.getFirstDayOfMonthIndex(e,o),l=this.getDaysCountInMonth(e,o),h=this.getDaysCountInPrevMonth(e,o),f=1,y=new Date,C=[],D=Math.ceil((l+s)/7);for(let R=0;R<D;R++){let V=[];if(0==R){for(let X=h-s+1;X<=h;X++){let ee=this.getPreviousMonthAndYear(e,o);V.push({day:X,month:ee.month,year:ee.year,otherMonth:!0,today:this.isToday(y,X,ee.month,ee.year),selectable:this.isSelectable(X,ee.month,ee.year,!0)})}let $=7-V.length;for(let X=0;X<$;X++)V.push({day:f,month:e,year:o,today:this.isToday(y,f,e,o),selectable:this.isSelectable(f,e,o,!1)}),f++}else for(let $=0;$<7;$++){if(f>l){let X=this.getNextMonthAndYear(e,o);V.push({day:f-l,month:X.month,year:X.year,otherMonth:!0,today:this.isToday(y,f-l,X.month,X.year),selectable:this.isSelectable(f-l,X.month,X.year,!0)})}else V.push({day:f,month:e,year:o,today:this.isToday(y,f,e,o),selectable:this.isSelectable(f,e,o,!1)});f++}this.showWeek&&C.push(this.getWeekNumber(new Date(V[0].year,V[0].month,V[0].day))),r.push(V)}return{month:e,year:o,dates:r,weekNumbers:C}}initTime(e){this.pm=e.getHours()>11,this.showTime?(this.currentMinute=e.getMinutes(),this.currentSecond=e.getSeconds(),this.setCurrentHourPM(e.getHours())):this.timeOnly&&(this.currentMinute=0,this.currentHour=0,this.currentSecond=0)}navBackward(e){this.disabled?e.preventDefault():(this.isMonthNavigate=!0,"month"===this.currentView?(this.decrementYear(),setTimeout(()=>{this.updateFocus()},1)):"year"===this.currentView?(this.decrementDecade(),setTimeout(()=>{this.updateFocus()},1)):(0===this.currentMonth?(this.currentMonth=11,this.decrementYear()):this.currentMonth--,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)))}navForward(e){this.disabled?e.preventDefault():(this.isMonthNavigate=!0,"month"===this.currentView?(this.incrementYear(),setTimeout(()=>{this.updateFocus()},1)):"year"===this.currentView?(this.incrementDecade(),setTimeout(()=>{this.updateFocus()},1)):(11===this.currentMonth?(this.currentMonth=0,this.incrementYear()):this.currentMonth++,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)))}decrementYear(){if(this.currentYear--,this.yearNavigator&&this.currentYear<this.yearOptions[0]){let e=this.yearOptions[this.yearOptions.length-1]-this.yearOptions[0];this.populateYearOptions(this.yearOptions[0]-e,this.yearOptions[this.yearOptions.length-1]-e)}}decrementDecade(){this.currentYear=this.currentYear-10}incrementDecade(){this.currentYear=this.currentYear+10}incrementYear(){if(this.currentYear++,this.yearNavigator&&this.currentYear>this.yearOptions[this.yearOptions.length-1]){let e=this.yearOptions[this.yearOptions.length-1]-this.yearOptions[0];this.populateYearOptions(this.yearOptions[0]+e,this.yearOptions[this.yearOptions.length-1]+e)}}switchToMonthView(e){this.setCurrentView("month"),e.preventDefault()}switchToYearView(e){this.setCurrentView("year"),e.preventDefault()}onDateSelect(e,o){!this.disabled&&o.selectable?(this.isMultipleSelection()&&this.isSelected(o)?(this.value=this.value.filter((r,s)=>!this.isDateEquals(r,o)),0===this.value.length&&(this.value=null),this.updateModel(this.value)):this.shouldSelectDate(o)&&this.selectDate(o),this.isSingleSelection()&&this.hideOnDateTimeSelect&&setTimeout(()=>{e.preventDefault(),this.hideOverlay(),this.mask&&this.disableModality(),this.cd.markForCheck()},150),this.updateInputfield(),e.preventDefault()):e.preventDefault()}shouldSelectDate(e){return!this.isMultipleSelection()||null==this.maxDateCount||this.maxDateCount>(this.value?this.value.length:0)}onMonthSelect(e,o){"month"===this.view?this.onDateSelect(e,{year:this.currentYear,month:o,day:1,selectable:!0}):(this.currentMonth=o,this.createMonths(this.currentMonth,this.currentYear),this.setCurrentView("date"),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}))}onYearSelect(e,o){"year"===this.view?this.onDateSelect(e,{year:o,month:0,day:1,selectable:!0}):(this.currentYear=o,this.setCurrentView("month"),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}))}updateInputfield(){let e="";if(this.value)if(this.isSingleSelection())e=this.formatDateTime(this.value);else if(this.isMultipleSelection())for(let o=0;o<this.value.length;o++)e+=this.formatDateTime(this.value[o]),o!==this.value.length-1&&(e+=this.multipleSeparator+" ");else if(this.isRangeSelection()&&this.value&&this.value.length){let r=this.value[1];e=this.formatDateTime(this.value[0]),r&&(e+=" "+this.rangeSeparator+" "+this.formatDateTime(r))}this.inputFieldValue=e,this.updateFilledState(),this.inputfieldViewChild&&this.inputfieldViewChild.nativeElement&&(this.inputfieldViewChild.nativeElement.value=this.inputFieldValue)}formatDateTime(e){let o=this.keepInvalid?e:null;return this.isValidDate(e)&&(this.timeOnly?o=this.formatTime(e):(o=this.formatDate(e,this.getDateFormat()),this.showTime&&(o+=" "+this.formatTime(e)))),o}setCurrentHourPM(e){"12"==this.hourFormat?(this.pm=e>11,this.currentHour=e>=12?12==e?12:e-12:0==e?12:e):this.currentHour=e}setCurrentView(e){this.currentView=e,this.cd.detectChanges(),this.alignOverlay()}selectDate(e){let o=new Date(e.year,e.month,e.day);if(this.showTime&&(o.setHours("12"==this.hourFormat?12===this.currentHour?this.pm?12:0:this.pm?this.currentHour+12:this.currentHour:this.currentHour),o.setMinutes(this.currentMinute),o.setSeconds(this.currentSecond)),this.minDate&&this.minDate>o&&(o=this.minDate,this.setCurrentHourPM(o.getHours()),this.currentMinute=o.getMinutes(),this.currentSecond=o.getSeconds()),this.maxDate&&this.maxDate<o&&(o=this.maxDate,this.setCurrentHourPM(o.getHours()),this.currentMinute=o.getMinutes(),this.currentSecond=o.getSeconds()),this.isSingleSelection())this.updateModel(o);else if(this.isMultipleSelection())this.updateModel(this.value?[...this.value,o]:[o]);else if(this.isRangeSelection())if(this.value&&this.value.length){let r=this.value[0],s=this.value[1];!s&&o.getTime()>=r.getTime()?s=o:(r=o,s=null),this.updateModel([r,s])}else this.updateModel([o,null]);this.onSelect.emit(o)}updateModel(e){if(this.value=e,"date"==this.dataType)this.onModelChange(this.value);else if("string"==this.dataType)if(this.isSingleSelection())this.onModelChange(this.formatDateTime(this.value));else{let o=null;this.value&&(o=this.value.map(r=>this.formatDateTime(r))),this.onModelChange(o)}}getFirstDayOfMonthIndex(e,o){let r=new Date;r.setDate(1),r.setMonth(e),r.setFullYear(o);let s=r.getDay()+this.getSundayIndex();return s>=7?s-7:s}getDaysCountInMonth(e,o){return 32-this.daylightSavingAdjust(new Date(o,e,32)).getDate()}getDaysCountInPrevMonth(e,o){let r=this.getPreviousMonthAndYear(e,o);return this.getDaysCountInMonth(r.month,r.year)}getPreviousMonthAndYear(e,o){let r,s;return 0===e?(r=11,s=o-1):(r=e-1,s=o),{month:r,year:s}}getNextMonthAndYear(e,o){let r,s;return 11===e?(r=0,s=o+1):(r=e+1,s=o),{month:r,year:s}}getSundayIndex(){let e=this.getFirstDateOfWeek();return e>0?7-e:0}isSelected(e){if(!this.value)return!1;if(this.isSingleSelection())return this.isDateEquals(this.value,e);if(this.isMultipleSelection()){let o=!1;for(let r of this.value)if(o=this.isDateEquals(r,e),o)break;return o}return this.isRangeSelection()?this.value[1]?this.isDateEquals(this.value[0],e)||this.isDateEquals(this.value[1],e)||this.isDateBetween(this.value[0],this.value[1],e):this.isDateEquals(this.value[0],e):void 0}isComparable(){return null!=this.value&&"string"!=typeof this.value}isMonthSelected(e){if(this.isComparable()&&!this.isMultipleSelection()){const[o,r]=this.isRangeSelection()?this.value:[this.value,this.value],s=new Date(this.currentYear,e,1);return s>=o&&s<=(r??o)}return!1}isMonthDisabled(e){for(let o=1;o<this.getDaysCountInMonth(e,this.currentYear)+1;o++)if(this.isSelectable(o,e,this.currentYear,!1))return!1;return!0}isYearSelected(e){if(this.isComparable()){let o=this.isRangeSelection()?this.value[0]:this.value;return!this.isMultipleSelection()&&o.getFullYear()===e}return!1}isDateEquals(e,o){return!(!e||!xn.isDate(e))&&e.getDate()===o.day&&e.getMonth()===o.month&&e.getFullYear()===o.year}isDateBetween(e,o,r){if(e&&o){let l=new Date(r.year,r.month,r.day);return e.getTime()<=l.getTime()&&o.getTime()>=l.getTime()}return!1}isSingleSelection(){return"single"===this.selectionMode}isRangeSelection(){return"range"===this.selectionMode}isMultipleSelection(){return"multiple"===this.selectionMode}isToday(e,o,r,s){return e.getDate()===o&&e.getMonth()===r&&e.getFullYear()===s}isSelectable(e,o,r,s){let l=!0,h=!0,f=!0,y=!0;return!(s&&!this.selectOtherMonths)&&(this.minDate&&(this.minDate.getFullYear()>r||this.minDate.getFullYear()===r&&(this.minDate.getMonth()>o||this.minDate.getMonth()===o&&this.minDate.getDate()>e))&&(l=!1),this.maxDate&&(this.maxDate.getFullYear()<r||this.maxDate.getFullYear()===r&&(this.maxDate.getMonth()<o||this.maxDate.getMonth()===o&&this.maxDate.getDate()<e))&&(h=!1),this.disabledDates&&(f=!this.isDateDisabled(e,o,r)),this.disabledDays&&(y=!this.isDayDisabled(e,o,r)),l&&h&&f&&y)}isDateDisabled(e,o,r){if(this.disabledDates)for(let s of this.disabledDates)if(s.getFullYear()===r&&s.getMonth()===o&&s.getDate()===e)return!0;return!1}isDayDisabled(e,o,r){if(this.disabledDays){let l=new Date(r,o,e).getDay();return-1!==this.disabledDays.indexOf(l)}return!1}onInputFocus(e){this.focus=!0,this.showOnFocus&&this.showOverlay(),this.onFocus.emit(e)}onInputClick(){this.showOnFocus&&!this.overlayVisible&&this.showOverlay()}onInputBlur(e){this.focus=!1,this.onBlur.emit(e),this.keepInvalid||this.updateInputfield(),this.onModelTouched()}onButtonClick(e,o){this.overlayVisible?this.hideOverlay():(o.focus(),this.showOverlay())}clear(){this.inputFieldValue=null,this.value=null,this.onModelChange(this.value),this.onClear.emit()}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}getMonthName(e){return this.config.getTranslation("monthNames")[e]}getYear(e){return"month"===this.currentView?this.currentYear:e.year}switchViewButtonDisabled(){return this.numberOfMonths>1||this.disabled}onPrevButtonClick(e){this.navigationState={backward:!0,button:!0},this.navBackward(e)}onNextButtonClick(e){this.navigationState={backward:!1,button:!0},this.navForward(e)}onContainerButtonKeydown(e){switch(e.which){case 9:this.inline||this.trapFocus(e);break;case 27:this.overlayVisible=!1,e.preventDefault()}}onInputKeydown(e){this.isKeydown=!0,40===e.keyCode&&this.contentViewChild?this.trapFocus(e):27===e.keyCode||13===e.keyCode?this.overlayVisible&&(this.overlayVisible=!1,e.preventDefault()):9===e.keyCode&&this.contentViewChild&&(Ne.getFocusableElements(this.contentViewChild.nativeElement).forEach(o=>o.tabIndex="-1"),this.overlayVisible&&(this.overlayVisible=!1))}onDateCellKeydown(e,o,r){const s=e.currentTarget,l=s.parentElement;switch(e.which){case 40:{s.tabIndex="-1";let h=Ne.index(l),f=l.parentElement.nextElementSibling;f?Ne.hasClass(f.children[h].children[0],"p-disabled")?(this.navigationState={backward:!1},this.navForward(e)):(f.children[h].children[0].tabIndex="0",f.children[h].children[0].focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 38:{s.tabIndex="-1";let h=Ne.index(l),f=l.parentElement.previousElementSibling;if(f){let y=f.children[h].children[0];Ne.hasClass(y,"p-disabled")?(this.navigationState={backward:!0},this.navBackward(e)):(y.tabIndex="0",y.focus())}else this.navigationState={backward:!0},this.navBackward(e);e.preventDefault();break}case 37:{s.tabIndex="-1";let h=l.previousElementSibling;if(h){let f=h.children[0];Ne.hasClass(f,"p-disabled")||Ne.hasClass(f.parentElement,"p-datepicker-weeknumber")?this.navigateToMonth(!0,r):(f.tabIndex="0",f.focus())}else this.navigateToMonth(!0,r);e.preventDefault();break}case 39:{s.tabIndex="-1";let h=l.nextElementSibling;if(h){let f=h.children[0];Ne.hasClass(f,"p-disabled")?this.navigateToMonth(!1,r):(f.tabIndex="0",f.focus())}else this.navigateToMonth(!1,r);e.preventDefault();break}case 13:case 32:this.onDateSelect(e,o),e.preventDefault();break;case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.inline||this.trapFocus(e)}}onMonthCellKeydown(e,o){const r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var s=r.parentElement.children,l=Ne.index(r);let h=s[40===e.which?l+3:l-3];h&&(h.tabIndex="0",h.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let h=r.previousElementSibling;h?(h.tabIndex="0",h.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let h=r.nextElementSibling;h?(h.tabIndex="0",h.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:this.onMonthSelect(e,o),e.preventDefault();break;case 13:case 32:case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.inline||this.trapFocus(e)}}onYearCellKeydown(e,o){const r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var s=r.parentElement.children,l=Ne.index(r);let h=s[40===e.which?l+2:l-2];h&&(h.tabIndex="0",h.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let h=r.previousElementSibling;h?(h.tabIndex="0",h.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let h=r.nextElementSibling;h?(h.tabIndex="0",h.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:case 32:this.onYearSelect(e,o),e.preventDefault();break;case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.trapFocus(e)}}navigateToMonth(e,o){if(e)if(1===this.numberOfMonths||0===o)this.navigationState={backward:!0},this.navBackward(event);else{let s=Ne.find(this.contentViewChild.nativeElement.children[o-1],".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),l=s[s.length-1];l.tabIndex="0",l.focus()}else if(1===this.numberOfMonths||o===this.numberOfMonths-1)this.navigationState={backward:!1},this.navForward(event);else{let s=Ne.findSingle(this.contentViewChild.nativeElement.children[o+1],".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");s.tabIndex="0",s.focus()}}updateFocus(){let e;if(this.navigationState){if(this.navigationState.button)this.initFocusableCell(),this.navigationState.backward?Ne.findSingle(this.contentViewChild.nativeElement,".p-datepicker-prev").focus():Ne.findSingle(this.contentViewChild.nativeElement,".p-datepicker-next").focus();else{if(this.navigationState.backward){let o;o=Ne.find(this.contentViewChild.nativeElement,"month"===this.currentView?".p-monthpicker .p-monthpicker-month:not(.p-disabled)":"year"===this.currentView?".p-yearpicker .p-yearpicker-year:not(.p-disabled)":".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),o&&o.length>0&&(e=o[o.length-1])}else e=Ne.findSingle(this.contentViewChild.nativeElement,"month"===this.currentView?".p-monthpicker .p-monthpicker-month:not(.p-disabled)":"year"===this.currentView?".p-yearpicker .p-yearpicker-year:not(.p-disabled)":".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");e&&(e.tabIndex="0",e.focus())}this.navigationState=null}else this.initFocusableCell()}initFocusableCell(){const e=this.contentViewChild?.nativeElement;let o;if("month"===this.currentView){let r=Ne.find(e,".p-monthpicker .p-monthpicker-month:not(.p-disabled)"),s=Ne.findSingle(e,".p-monthpicker .p-monthpicker-month.p-highlight");r.forEach(l=>l.tabIndex=-1),o=s||r[0],0===r.length&&Ne.find(e,'.p-monthpicker .p-monthpicker-month.p-disabled[tabindex = "0"]').forEach(h=>h.tabIndex=-1)}else if("year"===this.currentView){let r=Ne.find(e,".p-yearpicker .p-yearpicker-year:not(.p-disabled)"),s=Ne.findSingle(e,".p-yearpicker .p-yearpicker-year.p-highlight");r.forEach(l=>l.tabIndex=-1),o=s||r[0],0===r.length&&Ne.find(e,'.p-yearpicker .p-yearpicker-year.p-disabled[tabindex = "0"]').forEach(h=>h.tabIndex=-1)}else if(o=Ne.findSingle(e,"span.p-highlight"),!o){let r=Ne.findSingle(e,"td.p-datepicker-today span:not(.p-disabled):not(.p-ink)");o=r||Ne.findSingle(e,".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)")}o&&(o.tabIndex="0",!this.preventFocus&&(!this.navigationState||!this.navigationState.button)&&setTimeout(()=>{this.disabled||o.focus()},1),this.preventFocus=!1)}trapFocus(e){let o=Ne.getFocusableElements(this.contentViewChild.nativeElement);if(o&&o.length>0)if(o[0].ownerDocument.activeElement){let r=o.indexOf(o[0].ownerDocument.activeElement);if(e.shiftKey)if(-1==r||0===r)if(this.focusTrap)o[o.length-1].focus();else{if(-1===r)return this.hideOverlay();if(0===r)return}else o[r-1].focus();else if(-1==r||r===o.length-1){if(!this.focusTrap&&-1!=r)return this.hideOverlay();o[0].focus()}else o[r+1].focus()}else o[0].focus();e.preventDefault()}onMonthDropdownChange(e){this.currentMonth=parseInt(e),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}onYearDropdownChange(e){this.currentYear=parseInt(e),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}validateTime(e,o,r,s){let l=this.value;const h=this.convertTo24Hour(e,s);this.isRangeSelection()&&(l=this.value[1]||this.value[0]),this.isMultipleSelection()&&(l=this.value[this.value.length-1]);const f=l?l.toDateString():null;return!(this.minDate&&f&&this.minDate.toDateString()===f&&(this.minDate.getHours()>h||this.minDate.getHours()===h&&(this.minDate.getMinutes()>o||this.minDate.getMinutes()===o&&this.minDate.getSeconds()>r))||this.maxDate&&f&&this.maxDate.toDateString()===f&&(this.maxDate.getHours()<h||this.maxDate.getHours()===h&&(this.maxDate.getMinutes()<o||this.maxDate.getMinutes()===o&&this.maxDate.getSeconds()<r)))}incrementHour(e){let r=this.currentHour+this.stepHour,s=this.pm;"24"==this.hourFormat?r=r>=24?r-24:r:"12"==this.hourFormat&&(this.currentHour<12&&r>11&&(s=!this.pm),r=r>=13?r-12:r),this.validateTime(r,this.currentMinute,this.currentSecond,s)&&(this.currentHour=r,this.pm=s),e.preventDefault()}onTimePickerElementMouseDown(e,o,r){this.disabled||(this.repeat(e,null,o,r),e.preventDefault())}onTimePickerElementMouseUp(e){this.disabled||(this.clearTimePickerTimer(),this.updateTime())}onTimePickerElementMouseLeave(){!this.disabled&&this.timePickerTimer&&(this.clearTimePickerTimer(),this.updateTime())}repeat(e,o,r,s){let l=o||500;switch(this.clearTimePickerTimer(),this.timePickerTimer=setTimeout(()=>{this.repeat(e,100,r,s),this.cd.markForCheck()},l),r){case 0:1===s?this.incrementHour(e):this.decrementHour(e);break;case 1:1===s?this.incrementMinute(e):this.decrementMinute(e);break;case 2:1===s?this.incrementSecond(e):this.decrementSecond(e)}this.updateInputfield()}clearTimePickerTimer(){this.timePickerTimer&&(clearTimeout(this.timePickerTimer),this.timePickerTimer=null)}decrementHour(e){let o=this.currentHour-this.stepHour,r=this.pm;"24"==this.hourFormat?o=o<0?24+o:o:"12"==this.hourFormat&&(12===this.currentHour&&(r=!this.pm),o=o<=0?12+o:o),this.validateTime(o,this.currentMinute,this.currentSecond,r)&&(this.currentHour=o,this.pm=r),e.preventDefault()}incrementMinute(e){let o=this.currentMinute+this.stepMinute;o=o>59?o-60:o,this.validateTime(this.currentHour,o,this.currentSecond,this.pm)&&(this.currentMinute=o),e.preventDefault()}decrementMinute(e){let o=this.currentMinute-this.stepMinute;o=o<0?60+o:o,this.validateTime(this.currentHour,o,this.currentSecond,this.pm)&&(this.currentMinute=o),e.preventDefault()}incrementSecond(e){let o=this.currentSecond+this.stepSecond;o=o>59?o-60:o,this.validateTime(this.currentHour,this.currentMinute,o,this.pm)&&(this.currentSecond=o),e.preventDefault()}decrementSecond(e){let o=this.currentSecond-this.stepSecond;o=o<0?60+o:o,this.validateTime(this.currentHour,this.currentMinute,o,this.pm)&&(this.currentSecond=o),e.preventDefault()}updateTime(){let e=this.value;this.isRangeSelection()&&(e=this.value[1]||this.value[0]),this.isMultipleSelection()&&(e=this.value[this.value.length-1]),e=e?new Date(e.getTime()):new Date,e.setHours("12"==this.hourFormat?12===this.currentHour?this.pm?12:0:this.pm?this.currentHour+12:this.currentHour:this.currentHour),e.setMinutes(this.currentMinute),e.setSeconds(this.currentSecond),this.isRangeSelection()&&(e=this.value[1]?[this.value[0],e]:[e,null]),this.isMultipleSelection()&&(e=[...this.value.slice(0,-1),e]),this.updateModel(e),this.onSelect.emit(e),this.updateInputfield()}toggleAMPM(e){const o=!this.pm;this.validateTime(this.currentHour,this.currentMinute,this.currentSecond,o)&&(this.pm=o,this.updateTime()),e.preventDefault()}onUserInput(e){if(!this.isKeydown)return;this.isKeydown=!1;let o=e.target.value;try{let r=this.parseValueFromString(o);this.isValidSelection(r)&&(this.updateModel(r),this.updateUI())}catch{this.updateModel(this.keepInvalid?o:null)}this.filled=null!=o&&o.length,this.onInput.emit(e)}isValidSelection(e){let o=!0;return this.isSingleSelection()?this.isSelectable(e.getDate(),e.getMonth(),e.getFullYear(),!1)||(o=!1):e.every(r=>this.isSelectable(r.getDate(),r.getMonth(),r.getFullYear(),!1))&&this.isRangeSelection()&&(o=e.length>1&&e[1]>e[0]),o}parseValueFromString(e){if(!e||0===e.trim().length)return null;let o;if(this.isSingleSelection())o=this.parseDateTime(e);else if(this.isMultipleSelection()){let r=e.split(this.multipleSeparator);o=[];for(let s of r)o.push(this.parseDateTime(s.trim()))}else if(this.isRangeSelection()){let r=e.split(" "+this.rangeSeparator+" ");o=[];for(let s=0;s<r.length;s++)o[s]=this.parseDateTime(r[s].trim())}return o}parseDateTime(e){let o,r=e.split(" ");if(this.timeOnly)o=new Date,this.populateTime(o,r[0],r[1]);else{const s=this.getDateFormat();if(this.showTime){let l="12"==this.hourFormat?r.pop():null,h=r.pop();o=this.parseDate(r.join(" "),s),this.populateTime(o,h,l)}else o=this.parseDate(e,s)}return o}populateTime(e,o,r){if("12"==this.hourFormat&&!r)throw"Invalid Time";this.pm="PM"===r||"pm"===r;let s=this.parseTime(o);e.setHours(s.hour),e.setMinutes(s.minute),e.setSeconds(s.second)}isValidDate(e){return xn.isDate(e)&&xn.isNotEmpty(e)}updateUI(){let e=this.value;Array.isArray(e)&&(e=e[0]);let o=this.defaultDate&&this.isValidDate(this.defaultDate)&&!this.value?this.defaultDate:e&&this.isValidDate(e)?e:new Date;this.currentMonth=o.getMonth(),this.currentYear=o.getFullYear(),this.createMonths(this.currentMonth,this.currentYear),(this.showTime||this.timeOnly)&&(this.setCurrentHourPM(o.getHours()),this.currentMinute=o.getMinutes(),this.currentSecond=o.getSeconds())}showOverlay(){this.overlayVisible||(this.updateUI(),this.touchUI||(this.preventFocus=!0),this.overlayVisible=!0)}hideOverlay(){this.overlayVisible=!1,this.clearTimePickerTimer(),this.touchUI&&this.disableModality(),this.cd.markForCheck()}toggle(){this.inline||(this.overlayVisible?this.hideOverlay():(this.showOverlay(),this.inputfieldViewChild.nativeElement.focus()))}onOverlayAnimationStart(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.overlay=e.element,this.overlay.setAttribute(this.attributeSelector,""),this.appendOverlay(),this.updateFocus(),this.autoZIndex&&(this.touchUI?Ir.set("modal",this.overlay,this.baseZIndex||this.config.zIndex.modal):Ir.set("overlay",this.overlay,this.baseZIndex||this.config.zIndex.overlay)),this.alignOverlay(),this.onShow.emit(e));break;case"void":this.onOverlayHide(),this.onClose.emit(e)}}onOverlayAnimationDone(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener());break;case"void":this.autoZIndex&&Ir.clear(e.element)}}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):Ne.appendChild(this.overlay,this.appendTo))}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.el.nativeElement.appendChild(this.overlay)}alignOverlay(){this.touchUI?this.enableModality(this.overlay):this.overlay&&(this.appendTo?("date"===this.view?(this.overlay.style.width=Ne.getOuterWidth(this.overlay)+"px",this.overlay.style.minWidth=Ne.getOuterWidth(this.inputfieldViewChild.nativeElement)+"px"):this.overlay.style.width=Ne.getOuterWidth(this.inputfieldViewChild.nativeElement)+"px",Ne.absolutePosition(this.overlay,this.inputfieldViewChild.nativeElement)):Ne.relativePosition(this.overlay,this.inputfieldViewChild.nativeElement))}enableModality(e){this.mask||this.touchUI||(this.mask=document.createElement("div"),this.mask.style.zIndex=String(parseInt(e.style.zIndex)-1),Ne.addMultipleClasses(this.mask,"p-component-overlay p-datepicker-mask p-datepicker-mask-scrollblocker p-component-overlay p-component-overlay-enter"),this.maskClickListener=this.renderer.listen(this.mask,"click",r=>{this.disableModality()}),document.body.appendChild(this.mask),Ne.addClass(document.body,"p-overflow-hidden"))}disableModality(){this.mask&&(Ne.addClass(this.mask,"p-component-overlay-leave"),this.animationEndListener=this.destroyMask.bind(this),this.mask.addEventListener("animationend",this.animationEndListener))}destroyMask(){if(!this.mask)return;document.body.removeChild(this.mask);let o,e=document.body.children;for(let r=0;r<e.length;r++)if(Ne.hasClass(e[r],"p-datepicker-mask-scrollblocker")){o=!0;break}o||Ne.removeClass(document.body,"p-overflow-hidden"),this.unbindAnimationEndListener(),this.unbindMaskClickListener(),this.mask=null}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.mask.removeEventListener("animationend",this.animationEndListener),this.animationEndListener=null)}writeValue(e){if(this.value=e,this.value&&"string"==typeof this.value)try{this.value=this.parseValueFromString(this.value)}catch{this.keepInvalid&&(this.value=e)}this.updateInputfield(),this.updateUI(),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}getDateFormat(){return this.dateFormat||this.getTranslation("dateFormat")}getFirstDateOfWeek(){return this._firstDayOfWeek||this.getTranslation(zr.FIRST_DAY_OF_WEEK)}formatDate(e,o){if(!e)return"";let r;const s=C=>{const D=r+1<o.length&&o.charAt(r+1)===C;return D&&r++,D},l=(C,D,R)=>{let V=""+D;if(s(C))for(;V.length<R;)V="0"+V;return V},h=(C,D,R,V)=>s(C)?V[D]:R[D];let f="",y=!1;if(e)for(r=0;r<o.length;r++)if(y)"'"!==o.charAt(r)||s("'")?f+=o.charAt(r):y=!1;else switch(o.charAt(r)){case"d":f+=l("d",e.getDate(),2);break;case"D":f+=h("D",e.getDay(),this.getTranslation(zr.DAY_NAMES_SHORT),this.getTranslation(zr.DAY_NAMES));break;case"o":f+=l("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":f+=l("m",e.getMonth()+1,2);break;case"M":f+=h("M",e.getMonth(),this.getTranslation(zr.MONTH_NAMES_SHORT),this.getTranslation(zr.MONTH_NAMES));break;case"y":f+=s("y")?e.getFullYear():(e.getFullYear()%100<10?"0":"")+e.getFullYear()%100;break;case"@":f+=e.getTime();break;case"!":f+=1e4*e.getTime()+this.ticksTo1970;break;case"'":s("'")?f+="'":y=!0;break;default:f+=o.charAt(r)}return f}formatTime(e){if(!e)return"";let o="",r=e.getHours(),s=e.getMinutes(),l=e.getSeconds();return"12"==this.hourFormat&&r>11&&12!=r&&(r-=12),o+="12"==this.hourFormat&&0===r?12:r<10?"0"+r:r,o+=":",o+=s<10?"0"+s:s,this.showSeconds&&(o+=":",o+=l<10?"0"+l:l),"12"==this.hourFormat&&(o+=e.getHours()>11?" PM":" AM"),o}parseTime(e){let o=e.split(":");if(o.length!==(this.showSeconds?3:2))throw"Invalid time";let s=parseInt(o[0]),l=parseInt(o[1]),h=this.showSeconds?parseInt(o[2]):null;if(isNaN(s)||isNaN(l)||s>23||l>59||"12"==this.hourFormat&&s>12||this.showSeconds&&(isNaN(h)||h>59))throw"Invalid time";return"12"==this.hourFormat&&(12!==s&&this.pm?s+=12:!this.pm&&12===s&&(s-=12)),{hour:s,minute:l,second:h}}parseDate(e,o){if(null==o||null==e)throw"Invalid arguments";if(""===(e="object"==typeof e?e.toString():e+""))return null;let r,s,l,$,h=0,f="string"!=typeof this.shortYearCutoff?this.shortYearCutoff:(new Date).getFullYear()%100+parseInt(this.shortYearCutoff,10),y=-1,C=-1,D=-1,R=-1,V=!1,X=_e=>{let Be=r+1<o.length&&o.charAt(r+1)===_e;return Be&&r++,Be},ee=_e=>{let Be=X(_e),et="@"===_e?14:"!"===_e?20:"y"===_e&&Be?4:"o"===_e?3:2,Ht=new RegExp("^\\d{"+("y"===_e?et:1)+","+et+"}"),kt=e.substring(h).match(Ht);if(!kt)throw"Missing number at position "+h;return h+=kt[0].length,parseInt(kt[0],10)},ue=(_e,Be,et)=>{let gt=-1,Ht=X(_e)?et:Be,kt=[];for(let Kt=0;Kt<Ht.length;Kt++)kt.push([Kt,Ht[Kt]]);kt.sort((Kt,Ln)=>-(Kt[1].length-Ln[1].length));for(let Kt=0;Kt<kt.length;Kt++){let Ln=kt[Kt][1];if(e.substr(h,Ln.length).toLowerCase()===Ln.toLowerCase()){gt=kt[Kt][0],h+=Ln.length;break}}if(-1!==gt)return gt+1;throw"Unknown name at position "+h},fe=()=>{if(e.charAt(h)!==o.charAt(r))throw"Unexpected literal at position "+h;h++};for("month"===this.view&&(D=1),r=0;r<o.length;r++)if(V)"'"!==o.charAt(r)||X("'")?fe():V=!1;else switch(o.charAt(r)){case"d":D=ee("d");break;case"D":ue("D",this.getTranslation(zr.DAY_NAMES_SHORT),this.getTranslation(zr.DAY_NAMES));break;case"o":R=ee("o");break;case"m":C=ee("m");break;case"M":C=ue("M",this.getTranslation(zr.MONTH_NAMES_SHORT),this.getTranslation(zr.MONTH_NAMES));break;case"y":y=ee("y");break;case"@":$=new Date(ee("@")),y=$.getFullYear(),C=$.getMonth()+1,D=$.getDate();break;case"!":$=new Date((ee("!")-this.ticksTo1970)/1e4),y=$.getFullYear(),C=$.getMonth()+1,D=$.getDate();break;case"'":X("'")?fe():V=!0;break;default:fe()}if(h<e.length&&(l=e.substr(h),!/^\s+/.test(l)))throw"Extra/unparsed characters found in date: "+l;if(-1===y?y=(new Date).getFullYear():y<100&&(y+=(new Date).getFullYear()-(new Date).getFullYear()%100+(y<=f?0:-100)),R>-1)for(C=1,D=R;s=this.getDaysCountInMonth(y,C-1),!(D<=s);)C++,D-=s;if("year"===this.view&&(C=-1===C?1:C,D=-1===D?1:D),$=this.daylightSavingAdjust(new Date(y,C-1,D)),$.getFullYear()!==y||$.getMonth()+1!==C||$.getDate()!==D)throw"Invalid date";return $}daylightSavingAdjust(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null}updateFilledState(){this.filled=this.inputFieldValue&&""!=this.inputFieldValue}onTodayButtonClick(e){let o=new Date,r={day:o.getDate(),month:o.getMonth(),year:o.getFullYear(),otherMonth:o.getMonth()!==this.currentMonth||o.getFullYear()!==this.currentYear,today:!0,selectable:!0};this.onDateSelect(e,r),this.onTodayClick.emit(e)}onClearButtonClick(e){this.updateModel(null),this.updateInputfield(),this.hideOverlay(),this.onClearClick.emit(e)}createResponsiveStyle(){if(this.numberOfMonths>1&&this.responsiveOptions){this.responsiveStyleElement||(this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.body.appendChild(this.responsiveStyleElement));let e="";if(this.responsiveOptions){let o=[...this.responsiveOptions].filter(r=>!(!r.breakpoint||!r.numMonths)).sort((r,s)=>-1*r.breakpoint.localeCompare(s.breakpoint,void 0,{numeric:!0}));for(let r=0;r<o.length;r++){let{breakpoint:s,numMonths:l}=o[r],h=`\n                        .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${l}) .p-datepicker-next {\n                            display: inline-flex !important;\n                        }\n                    `;for(let f=l;f<this.numberOfMonths;f++)h+=`\n                            .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${f+1}) {\n                                display: none !important;\n                            }\n                        `;e+=`\n                        @media screen and (max-width: ${s}) {\n                            ${h}\n                        }\n                    `}}this.responsiveStyleElement.innerHTML=e}}destroyResponsiveStyleElement(){this.responsiveStyleElement&&(this.responsiveStyleElement.remove(),this.responsiveStyleElement=null)}bindDocumentClickListener(){this.documentClickListener||this.zone.runOutsideAngular(()=>{this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","mousedown",o=>{this.isOutsideClicked(o)&&this.overlayVisible&&this.zone.run(()=>{this.hideOverlay(),this.onClickOutside.emit(o),this.cd.markForCheck()})})})}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){!this.documentResizeListener&&!this.touchUI&&(this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener))}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new w0(this.containerViewChild.nativeElement,()=>{this.overlayVisible&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}isOutsideClicked(e){return!(this.el.nativeElement.isSameNode(e.target)||this.isNavIconClicked(e)||this.el.nativeElement.contains(e.target)||this.overlay&&this.overlay.contains(e.target))}isNavIconClicked(e){return Ne.hasClass(e.target,"p-datepicker-prev")||Ne.hasClass(e.target,"p-datepicker-prev-icon")||Ne.hasClass(e.target,"p-datepicker-next")||Ne.hasClass(e.target,"p-datepicker-next-icon")}onWindowResize(){this.overlayVisible&&!Ne.isTouchDevice()&&this.hideOverlay()}onOverlayHide(){this.currentView=this.view,this.mask&&this.destroyMask(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.overlay=null}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.overlay&&this.autoZIndex&&Ir.clear(this.overlay),this.destroyResponsiveStyleElement(),this.clearTimePickerTimer(),this.restoreOverlayAppend(),this.onOverlayHide()}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Jr),ce(Fo),ce(yi),ce(fl),ce(y0))},t.\u0275cmp=Qt({type:t,selectors:[["p-calendar"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(OK,5),pi(LK,5),pi(RK,5)),2&e){let r;gn(r=_n())&&(o.containerViewChild=r.first),gn(r=_n())&&(o.inputfieldViewChild=r.first),gn(r=_n())&&(o.content=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,o){2&e&&Ro("p-inputwrapper-filled",o.filled)("p-inputwrapper-focus",o.focus)("p-calendar-clearable",o.showClear&&!o.disabled)},inputs:{style:"style",styleClass:"styleClass",inputStyle:"inputStyle",inputId:"inputId",name:"name",inputStyleClass:"inputStyleClass",placeholder:"placeholder",ariaLabelledBy:"ariaLabelledBy",iconAriaLabel:"iconAriaLabel",disabled:"disabled",dateFormat:"dateFormat",multipleSeparator:"multipleSeparator",rangeSeparator:"rangeSeparator",inline:"inline",showOtherMonths:"showOtherMonths",selectOtherMonths:"selectOtherMonths",showIcon:"showIcon",icon:"icon",appendTo:"appendTo",readonlyInput:"readonlyInput",shortYearCutoff:"shortYearCutoff",monthNavigator:"monthNavigator",yearNavigator:"yearNavigator",hourFormat:"hourFormat",timeOnly:"timeOnly",stepHour:"stepHour",stepMinute:"stepMinute",stepSecond:"stepSecond",showSeconds:"showSeconds",required:"required",showOnFocus:"showOnFocus",showWeek:"showWeek",showClear:"showClear",dataType:"dataType",selectionMode:"selectionMode",maxDateCount:"maxDateCount",showButtonBar:"showButtonBar",todayButtonStyleClass:"todayButtonStyleClass",clearButtonStyleClass:"clearButtonStyleClass",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",panelStyleClass:"panelStyleClass",panelStyle:"panelStyle",keepInvalid:"keepInvalid",hideOnDateTimeSelect:"hideOnDateTimeSelect",touchUI:"touchUI",timeSeparator:"timeSeparator",focusTrap:"focusTrap",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",tabindex:"tabindex",view:"view",defaultDate:"defaultDate",minDate:"minDate",maxDate:"maxDate",disabledDates:"disabledDates",disabledDays:"disabledDays",yearRange:"yearRange",showTime:"showTime",responsiveOptions:"responsiveOptions",numberOfMonths:"numberOfMonths",firstDayOfWeek:"firstDayOfWeek",locale:"locale"},outputs:{onFocus:"onFocus",onBlur:"onBlur",onClose:"onClose",onSelect:"onSelect",onClear:"onClear",onInput:"onInput",onTodayClick:"onTodayClick",onClearClick:"onClearClick",onMonthChange:"onMonthChange",onYearChange:"onYearChange",onClickOutside:"onClickOutside",onShow:"onShow"},features:[zi([SX])],ngContentSelectors:TX,decls:4,vars:11,consts:[[3,"ngClass","ngStyle"],["container",""],[3,"ngIf"],[3,"class","ngStyle","ngClass","click",4,"ngIf"],["type","text","autocomplete","off",3,"value","readonly","ngStyle","placeholder","disabled","ngClass","focus","keydown","click","blur","input"],["inputfield",""],["class","p-calendar-clear-icon pi pi-times",3,"click",4,"ngIf"],["type","button","pButton","","pRipple","","class","p-datepicker-trigger","tabindex","0",3,"icon","disabled","click",4,"ngIf"],[1,"p-calendar-clear-icon","pi","pi-times",3,"click"],["type","button","pButton","","pRipple","","tabindex","0",1,"p-datepicker-trigger",3,"icon","disabled","click"],[3,"ngStyle","ngClass","click"],["contentWrapper",""],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-timepicker",4,"ngIf"],["class","p-datepicker-buttonbar",4,"ngIf"],[1,"p-datepicker-group-container"],["class","p-datepicker-group",4,"ngFor","ngForOf"],["class","p-monthpicker",4,"ngIf"],["class","p-yearpicker",4,"ngIf"],[1,"p-datepicker-group"],[1,"p-datepicker-header"],["class","p-datepicker-prev p-link","type","button","pRipple","",3,"keydown","click",4,"ngIf"],[1,"p-datepicker-title"],["type","button","class","p-datepicker-month p-link",3,"disabled","click","keydown",4,"ngIf"],["type","button","class","p-datepicker-year p-link",3,"disabled","click","keydown",4,"ngIf"],["class","p-datepicker-decade",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-next","p-link",3,"keydown","click"],[1,"p-datepicker-next-icon","pi","pi-chevron-right"],["class","p-datepicker-calendar-container",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-prev","p-link",3,"keydown","click"],[1,"p-datepicker-prev-icon","pi","pi-chevron-left"],["type","button",1,"p-datepicker-month","p-link",3,"disabled","click","keydown"],["type","button",1,"p-datepicker-year","p-link",3,"disabled","click","keydown"],[1,"p-datepicker-decade"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-datepicker-calendar-container"],[1,"p-datepicker-calendar"],["class","p-datepicker-weekheader p-disabled",4,"ngIf"],["scope","col",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p-datepicker-weekheader","p-disabled"],["scope","col"],["class","p-datepicker-weeknumber",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"p-datepicker-weeknumber"],[1,"p-disabled"],[3,"ngClass"],["draggable","false","pRipple","",3,"ngClass","click","keydown"],[1,"p-monthpicker"],["class","p-monthpicker-month","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-monthpicker-month",3,"ngClass","click","keydown"],[1,"p-yearpicker"],["class","p-yearpicker-year","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-yearpicker-year",3,"ngClass","click","keydown"],[1,"p-timepicker"],[1,"p-hour-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","keydown.enter","keydown.space","mousedown","mouseup","keyup.enter","keyup.space","mouseleave"],[1,"pi","pi-chevron-up"],[1,"pi","pi-chevron-down"],[1,"p-separator"],[1,"p-minute-picker"],["class","p-separator",4,"ngIf"],["class","p-second-picker",4,"ngIf"],["class","p-ampm-picker",4,"ngIf"],[1,"p-second-picker"],[1,"p-ampm-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","click","keydown.enter"],[1,"p-datepicker-buttonbar"],["type","button","pButton","","pRipple","",3,"label","ngClass","keydown","click"]],template:function(e,o){1&e&&(hr(wX),P(0,"span",0,1),W(2,zK,4,17,"ng-template",2),W(3,xX,9,28,"div",3),N()),2&e&&(Zn(o.styleClass),L("ngClass",vu(6,CX,o.showIcon,o.timeOnly,o.disabled,o.focus))("ngStyle",o.style),F(2),L("ngIf",!o.inline),F(1),L("ngIf",o.inline||o.overlayVisible))},dependencies:[ao,Ns,Xn,Cs,ho,Dr,Iu],styles:[".p-calendar{position:relative;display:inline-flex;max-width:100%}.p-calendar .p-inputtext{flex:1 1 auto;width:1%}.p-calendar-w-btn .p-inputtext{border-top-right-radius:0;border-bottom-right-radius:0}.p-calendar-w-btn .p-datepicker-trigger{border-top-left-radius:0;border-bottom-left-radius:0}.p-fluid .p-calendar{display:flex}.p-fluid .p-calendar .p-inputtext{width:1%}.p-calendar .p-datepicker{min-width:100%}.p-datepicker{width:auto;position:absolute;top:0;left:0}.p-datepicker-inline{display:inline-block;position:static;overflow-x:auto}.p-datepicker-header{display:flex;align-items:center;justify-content:space-between}.p-datepicker-header .p-datepicker-title{margin:0 auto}.p-datepicker-prev,.p-datepicker-next{cursor:pointer;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;position:relative}.p-datepicker-multiple-month .p-datepicker-group-container .p-datepicker-group{flex:1 1 auto}.p-datepicker-multiple-month .p-datepicker-group-container{display:flex}.p-datepicker table{width:100%;border-collapse:collapse}.p-datepicker td>span{display:flex;justify-content:center;align-items:center;cursor:pointer;margin:0 auto;overflow:hidden;position:relative}.p-monthpicker-month{width:33.3%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-datepicker-buttonbar{display:flex;justify-content:space-between;align-items:center}.p-timepicker{display:flex;justify-content:center;align-items:center}.p-timepicker button{display:flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-timepicker>div{display:flex;align-items:center;flex-direction:column}.p-datepicker-touch-ui,.p-calendar .p-datepicker-touch-ui{position:fixed;top:50%;left:50%;min-width:80vw;transform:translate(-50%,-50%)}.p-yearpicker-year{width:50%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-calendar-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-calendar-clearable{position:relative}\n"],encapsulation:2,data:{animation:[pl("overlayAnimation",[Mw("visibleTouchUI",po({transform:"translate(-50%,-50%)",opacity:1})),qo("void => visible",[po({opacity:0,transform:"scaleY(0.8)"}),$o("{{showTransitionParams}}",po({opacity:1,transform:"*"}))]),qo("visible => void",[$o("{{hideTransitionParams}}",po({opacity:0}))]),qo("void => visibleTouchUI",[po({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}),$o("{{showTransitionParams}}")]),qo("visibleTouchUI => void",[$o("{{hideTransitionParams}}",po({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}))])])]},changeDetection:0}),t})(),IX=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,gl,hs,ml,gl,hs]}),t})(),DX=(()=>{class t{constructor(e){this.host=e,this.focused=!1}ngAfterViewChecked(){if(!this.focused&&this.autofocus){const e=Ne.getFocusableElements(this.host.nativeElement);0===e.length&&this.host.nativeElement.focus(),e.length>0&&e[0].focus(),this.focused=!0}}}return t.\u0275fac=function(e){return new(e||t)(ce(gi))},t.\u0275dir=On({type:t,selectors:[["","pAutoFocus",""]],hostAttrs:[1,"p-element"],inputs:{autofocus:"autofocus"}}),t})(),MX=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();const kX=["overlay"],AX=["content"];function PX(t,n){1&t&&$t(0)}const OX=function(t,n,e){return{showTransitionParams:t,hideTransitionParams:n,transform:e}},LX=function(t){return{value:"visible",params:t}},RX=function(t){return{mode:t}},FX=function(t){return{$implicit:t}};function NX(t,n){if(1&t){const e=Ye();P(0,"div",1,3),Te("click",function(r){return be(e),ve(U(2).onOverlayContentClick(r))})("@overlayContentAnimation.start",function(r){return be(e),ve(U(2).onOverlayContentAnimationStart(r))})("@overlayContentAnimation.done",function(r){return be(e),ve(U(2).onOverlayContentAnimationDone(r))}),ro(2),W(3,PX,1,0,"ng-container",4),N()}if(2&t){const e=U(2);Zn(e.contentStyleClass),L("ngStyle",e.contentStyle)("ngClass","p-overlay-content")("@overlayContentAnimation",Wt(11,LX,Va(7,OX,e.showTransitionOptions,e.hideTransitionOptions,e.transformOptions[e.modal?e.overlayResponsiveDirection:"default"]))),F(3),L("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",Wt(15,FX,Wt(13,RX,e.overlayMode)))}}const zX=function(t,n,e,o,r,s,l,h,f,y,C,D,R,V){return{"p-overlay p-component":!0,"p-overlay-modal p-component-overlay p-component-overlay-enter":t,"p-overlay-center":n,"p-overlay-top":e,"p-overlay-top-start":o,"p-overlay-top-end":r,"p-overlay-bottom":s,"p-overlay-bottom-start":l,"p-overlay-bottom-end":h,"p-overlay-left":f,"p-overlay-left-start":y,"p-overlay-left-end":C,"p-overlay-right":D,"p-overlay-right-start":R,"p-overlay-right-end":V}};function BX(t,n){if(1&t){const e=Ye();P(0,"div",1,2),Te("click",function(r){return be(e),ve(U().onOverlayClick(r))}),W(2,NX,4,17,"div",0),N()}if(2&t){const e=U();Zn(e.styleClass),L("ngStyle",e.style)("ngClass",hE(5,zX,[e.modal,e.modal&&"center"===e.overlayResponsiveDirection,e.modal&&"top"===e.overlayResponsiveDirection,e.modal&&"top-start"===e.overlayResponsiveDirection,e.modal&&"top-end"===e.overlayResponsiveDirection,e.modal&&"bottom"===e.overlayResponsiveDirection,e.modal&&"bottom-start"===e.overlayResponsiveDirection,e.modal&&"bottom-end"===e.overlayResponsiveDirection,e.modal&&"left"===e.overlayResponsiveDirection,e.modal&&"left-start"===e.overlayResponsiveDirection,e.modal&&"left-end"===e.overlayResponsiveDirection,e.modal&&"right"===e.overlayResponsiveDirection,e.modal&&"right-start"===e.overlayResponsiveDirection,e.modal&&"right-end"===e.overlayResponsiveDirection])),F(2),L("ngIf",e.visible)}}const VX=["*"],UX={provide:zs,useExisting:Ei(()=>H3),multi:!0},jX=If([po({transform:"{{transform}}",opacity:0}),$o("{{showTransitionParams}}")]),HX=If([$o("{{hideTransitionParams}}",po({transform:"{{transform}}",opacity:0}))]);let H3=(()=>{class t{constructor(e,o,r,s,l,h){this.document=e,this.el=o,this.renderer=r,this.config=s,this.overlayService=l,this.zone=h,this.visibleChange=new ht,this.onBeforeShow=new ht,this.onShow=new ht,this.onBeforeHide=new ht,this.onHide=new ht,this.onAnimationStart=new ht,this.onAnimationDone=new ht,this._visible=!1,this.modalVisible=!1,this.isOverlayClicked=!1,this.isOverlayContentClicked=!1,this.transformOptions={default:"scaleY(0.8)",center:"scale(0.7)",top:"translate3d(0px, -100%, 0px)","top-start":"translate3d(0px, -100%, 0px)","top-end":"translate3d(0px, -100%, 0px)",bottom:"translate3d(0px, 100%, 0px)","bottom-start":"translate3d(0px, 100%, 0px)","bottom-end":"translate3d(0px, 100%, 0px)",left:"translate3d(-100%, 0px, 0px)","left-start":"translate3d(-100%, 0px, 0px)","left-end":"translate3d(-100%, 0px, 0px)",right:"translate3d(100%, 0px, 0px)","right-start":"translate3d(100%, 0px, 0px)","right-end":"translate3d(100%, 0px, 0px)"},this.window=this.document.defaultView}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.modalVisible&&(this.modalVisible=!0)}get mode(){return this._mode||this.overlayOptions?.mode}set mode(e){this._mode=e}get style(){return xn.merge(this._style,this.modal?this.overlayResponsiveOptions?.style:this.overlayOptions?.style)}set style(e){this._style=e}get styleClass(){return xn.merge(this._styleClass,this.modal?this.overlayResponsiveOptions?.styleClass:this.overlayOptions?.styleClass)}set styleClass(e){this._styleClass=e}get contentStyle(){return xn.merge(this._contentStyle,this.modal?this.overlayResponsiveOptions?.contentStyle:this.overlayOptions?.contentStyle)}set contentStyle(e){this._contentStyle=e}get contentStyleClass(){return xn.merge(this._contentStyleClass,this.modal?this.overlayResponsiveOptions?.contentStyleClass:this.overlayOptions?.contentStyleClass)}set contentStyleClass(e){this._contentStyleClass=e}get target(){const e=this._target||this.overlayOptions?.target;return void 0===e?"@prev":e}set target(e){this._target=e}get appendTo(){return this._appendTo||this.overlayOptions?.appendTo}set appendTo(e){this._appendTo=e}get autoZIndex(){const e=this._autoZIndex||this.overlayOptions?.autoZIndex;return void 0===e||e}set autoZIndex(e){this._autoZIndex=e}get baseZIndex(){const e=this._baseZIndex||this.overlayOptions?.baseZIndex;return void 0===e?0:e}set baseZIndex(e){this._baseZIndex=e}get showTransitionOptions(){const e=this._showTransitionOptions||this.overlayOptions?.showTransitionOptions;return void 0===e?".12s cubic-bezier(0, 0, 0.2, 1)":e}set showTransitionOptions(e){this._showTransitionOptions=e}get hideTransitionOptions(){const e=this._hideTransitionOptions||this.overlayOptions?.hideTransitionOptions;return void 0===e?".1s linear":e}set hideTransitionOptions(e){this._hideTransitionOptions=e}get listener(){return this._listener||this.overlayOptions?.listener}set listener(e){this._listener=e}get responsive(){return this._responsive||this.overlayOptions?.responsive}set responsive(e){this._responsive=e}get options(){return this._options}set options(e){this._options=e}get modal(){return"modal"===this.mode||this.overlayResponsiveOptions&&this.window?.matchMedia(this.overlayResponsiveOptions.media?.replace("@media","")||`(max-width: ${this.overlayResponsiveOptions.breakpoint})`).matches}get overlayMode(){return this.mode||(this.modal?"modal":"overlay")}get overlayOptions(){return{...this.config?.overlayOptions,...this.options}}get overlayResponsiveOptions(){return{...this.overlayOptions?.responsive,...this.responsive}}get overlayResponsiveDirection(){return this.overlayResponsiveOptions?.direction||"center"}get overlayEl(){return this.overlayViewChild?.nativeElement}get contentEl(){return this.contentViewChild?.nativeElement}get targetEl(){return Ne.getTargetElement(this.target,this.el?.nativeElement)}ngAfterContentInit(){this.templates?.forEach(e=>{e.getType(),this.contentTemplate=e.template})}show(e,o=!1){this.onVisibleChange(!0),this.handleEvents("onShow",{overlay:e||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),o&&Ne.focus(this.targetEl),this.modal&&Ne.addClass(this.document?.body,"p-overflow-hidden")}hide(e,o=!1){this.visible&&(this.onVisibleChange(!1),this.handleEvents("onHide",{overlay:e||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),o&&Ne.focus(this.targetEl),this.modal&&Ne.removeClass(this.document?.body,"p-overflow-hidden"))}alignOverlay(){!this.modal&&Ne.alignOverlay(this.overlayEl,this.targetEl,this.appendTo)}onVisibleChange(e){this._visible=e,this.visibleChange.emit(e)}onOverlayClick(e){this.isOverlayClicked=!0}onOverlayContentClick(e){this.overlayService.add({originalEvent:e,target:this.targetEl}),this.isOverlayContentClicked=!0}onOverlayContentAnimationStart(e){switch(e.toState){case"visible":this.handleEvents("onBeforeShow",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.autoZIndex&&Ir.set(this.overlayMode,this.overlayEl,this.baseZIndex+this.config?.zIndex[this.overlayMode]),Ne.appendOverlay(this.overlayEl,"body"===this.appendTo?this.document.body:this.appendTo,this.appendTo),this.alignOverlay();break;case"void":this.handleEvents("onBeforeHide",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.modal&&Ne.addClass(this.overlayEl,"p-component-overlay-leave")}this.handleEvents("onAnimationStart",e)}onOverlayContentAnimationDone(e){const o=this.overlayEl||e.element.parentElement;switch(e.toState){case"visible":this.show(o,!0),this.bindListeners();break;case"void":this.hide(o,!0),this.unbindListeners(),Ne.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),Ir.clear(o),this.modalVisible=!1}this.handleEvents("onAnimationDone",e)}handleEvents(e,o){this[e].emit(o),this.options&&this.options[e]&&this.options[e](o),this.config?.overlayOptions&&this.config?.overlayOptions[e]&&this.config?.overlayOptions[e](o)}bindListeners(){this.bindScrollListener(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindDocumentKeyboardListener()}unbindListeners(){this.unbindScrollListener(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindDocumentKeyboardListener()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new w0(this.targetEl,e=>{(!this.listener||this.listener(e,{type:"scroll",mode:this.overlayMode,valid:!0}))&&this.hide(e,!0)})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.document,"click",e=>{const r=!(this.targetEl&&(this.targetEl.isSameNode(e.target)||!this.isOverlayClicked&&this.targetEl.contains(e.target))||this.isOverlayContentClicked);(this.listener?this.listener(e,{type:"outside",mode:this.overlayMode,valid:3!==e.which&&r}):r)&&this.hide(e),this.isOverlayClicked=this.isOverlayContentClicked=!1}))}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener||(this.documentResizeListener=this.renderer.listen(this.window,"resize",e=>{(this.listener?this.listener(e,{type:"resize",mode:this.overlayMode,valid:!Ne.isTouchDevice()}):!Ne.isTouchDevice())&&this.hide(e,!0)}))}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}bindDocumentKeyboardListener(){this.documentKeyboardListener||this.zone.runOutsideAngular(()=>{this.documentKeyboardListener=this.renderer.listen(this.window,"keydown",e=>{this.overlayOptions.hideOnEscape&&27===e.keyCode&&(this.listener?this.listener(e,{type:"keydown",mode:this.overlayMode,valid:!Ne.isTouchDevice()}):!Ne.isTouchDevice())&&this.zone.run(()=>{this.hide(e,!0)})})})}unbindDocumentKeyboardListener(){this.documentKeyboardListener&&(this.documentKeyboardListener(),this.documentKeyboardListener=null)}ngOnDestroy(){this.hide(this.overlayEl,!0),this.overlayEl&&(Ne.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),Ir.clear(this.overlayEl)),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindListeners()}}return t.\u0275fac=function(e){return new(e||t)(ce(uo),ce(gi),ce(Jr),ce(fl),ce(y0),ce(yi))},t.\u0275cmp=Qt({type:t,selectors:[["p-overlay"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(kX,5),pi(AX,5)),2&e){let r;gn(r=_n())&&(o.overlayViewChild=r.first),gn(r=_n())&&(o.contentViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{visible:"visible",mode:"mode",style:"style",styleClass:"styleClass",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",target:"target",appendTo:"appendTo",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",listener:"listener",responsive:"responsive",options:"options"},outputs:{visibleChange:"visibleChange",onBeforeShow:"onBeforeShow",onShow:"onShow",onBeforeHide:"onBeforeHide",onHide:"onHide",onAnimationStart:"onAnimationStart",onAnimationDone:"onAnimationDone"},features:[zi([UX])],ngContentSelectors:VX,decls:1,vars:1,consts:[[3,"ngStyle","class","ngClass","click",4,"ngIf"],[3,"ngStyle","ngClass","click"],["overlay",""],["content",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){1&e&&(hr(),W(0,BX,3,20,"div",0)),2&e&&L("ngIf",o.modalVisible)},dependencies:[ao,Xn,Cs,ho],styles:[".p-overlay{position:absolute;top:0;left:0}.p-overlay-modal{display:flex;align-items:center;justify-content:center;position:fixed;top:0;left:0;width:100%;height:100%}.p-overlay-content{transform-origin:inherit}.p-overlay-modal>.p-overlay-content{z-index:1;width:90%}.p-overlay-top{align-items:flex-start}.p-overlay-top-start{align-items:flex-start;justify-content:flex-start}.p-overlay-top-end{align-items:flex-start;justify-content:flex-end}.p-overlay-bottom{align-items:flex-end}.p-overlay-bottom-start{align-items:flex-end;justify-content:flex-start}.p-overlay-bottom-end{align-items:flex-end;justify-content:flex-end}.p-overlay-left{justify-content:flex-start}.p-overlay-left-start{justify-content:flex-start;align-items:flex-start}.p-overlay-left-end{justify-content:flex-start;align-items:flex-end}.p-overlay-right{justify-content:flex-end}.p-overlay-right-start{justify-content:flex-end;align-items:flex-start}.p-overlay-right-end{justify-content:flex-end;align-items:flex-end}\n"],encapsulation:2,data:{animation:[pl("overlayContentAnimation",[qo(":enter",[yy(jX)]),qo(":leave",[yy(HX)])])]},changeDetection:0}),t})(),$3=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,hs,hs]}),t})();const $X=["element"],GX=["content"];function WX(t,n){1&t&&$t(0)}const fD=function(t,n){return{$implicit:t,options:n}};function qX(t,n){if(1&t&&(wn(0),W(1,WX,1,0,"ng-container",7),Pn()),2&t){const e=U(2);F(1),L("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",Ji(2,fD,e.loadedItems,e.getContentOptions()))}}function ZX(t,n){1&t&&$t(0)}function KX(t,n){if(1&t&&(wn(0),W(1,ZX,1,0,"ng-container",7),Pn()),2&t){const e=n.$implicit,o=n.index,r=U(3);F(1),L("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",Ji(2,fD,e,r.getOptions(o)))}}const XX=function(t){return{"p-scroller-loading":t}};function YX(t,n){if(1&t&&(P(0,"div",8,9),W(2,KX,2,5,"ng-container",10),N()),2&t){const e=U(2);L("ngClass",Wt(4,XX,e.d_loading))("ngStyle",e.contentStyle),F(2),L("ngForOf",e.loadedItems)("ngForTrackBy",e._trackBy||e.index)}}function QX(t,n){1&t&&Ae(0,"div",11),2&t&&L("ngStyle",U(2).spacerStyle)}function JX(t,n){1&t&&$t(0)}const eY=function(t){return{numCols:t}},G3=function(t){return{options:t}};function tY(t,n){if(1&t&&(wn(0),W(1,JX,1,0,"ng-container",7),Pn()),2&t){const e=n.index,o=U(4);F(1),L("ngTemplateOutlet",o.loaderTemplate)("ngTemplateOutletContext",Wt(4,G3,o.getLoaderOptions(e,o.both&&Wt(2,eY,o._numItemsInViewport.cols))))}}function nY(t,n){if(1&t&&(wn(0),W(1,tY,2,6,"ng-container",14),Pn()),2&t){const e=U(3);F(1),L("ngForOf",e.loaderArr)}}function iY(t,n){1&t&&$t(0)}const oY=function(){return{styleClass:"p-scroller-loading-icon"}};function rY(t,n){if(1&t&&(wn(0),W(1,iY,1,0,"ng-container",7),Pn()),2&t){const e=U(4);F(1),L("ngTemplateOutlet",e.loaderIconTemplate)("ngTemplateOutletContext",Wt(3,G3,Kn(2,oY)))}}function sY(t,n){1&t&&Ae(0,"i",16)}function aY(t,n){if(1&t&&(W(0,rY,2,5,"ng-container",0),W(1,sY,1,0,"ng-template",null,15,Ua)),2&t){const e=Un(2);L("ngIf",U(3).loaderIconTemplate)("ngIfElse",e)}}const lY=function(t){return{"p-component-overlay":t}};function cY(t,n){if(1&t&&(P(0,"div",12),W(1,nY,2,1,"ng-container",0),W(2,aY,3,2,"ng-template",null,13,Ua),N()),2&t){const e=Un(3),o=U(2);L("ngClass",Wt(3,lY,!o.loaderTemplate)),F(1),L("ngIf",o.loaderTemplate)("ngIfElse",e)}}const uY=function(t,n,e){return{"p-scroller":!0,"p-scroller-inline":t,"p-both-scroll":n,"p-horizontal-scroll":e}};function dY(t,n){if(1&t){const e=Ye();wn(0),P(1,"div",2,3),Te("scroll",function(r){return be(e),ve(U().onContainerScroll(r))}),W(3,qX,2,5,"ng-container",0),W(4,YX,3,6,"ng-template",null,4,Ua),W(6,QX,1,1,"div",5),W(7,cY,4,5,"div",6),N(),Pn()}if(2&t){const e=Un(5),o=U();F(1),Zn(o._styleClass),L("ngStyle",o._style)("ngClass",Va(10,uY,o.inline,o.both,o.horizontal)),at("id",o._id)("tabindex",o.tabindex),F(2),L("ngIf",o.contentTemplate)("ngIfElse",e),F(3),L("ngIf",o._showSpacer),F(1),L("ngIf",!o.loaderDisabled&&o._showLoader&&o.d_loading)}}function hY(t,n){1&t&&$t(0)}const pY=function(t,n){return{rows:t,columns:n}};function fY(t,n){if(1&t&&(wn(0),W(1,hY,1,0,"ng-container",7),Pn()),2&t){const e=U(2);F(1),L("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",Ji(5,fD,e.items,Ji(2,pY,e._items,e.loadedColumns)))}}function mY(t,n){if(1&t&&(ro(0),W(1,fY,2,8,"ng-container",17)),2&t){const e=U();F(1),L("ngIf",e.contentTemplate)}}const gY=["*"];let W3=(()=>{class t{constructor(e,o){this.cd=e,this.zone=o,this.onLazyLoad=new ht,this.onScroll=new ht,this.onScrollIndexChange=new ht,this._tabindex=0,this._itemSize=0,this._orientation="vertical",this._step=0,this._delay=0,this._resizeDelay=10,this._appendOnly=!1,this._inline=!1,this._lazy=!1,this._disabled=!1,this._loaderDisabled=!1,this._showSpacer=!0,this._showLoader=!1,this._autoSize=!1,this.d_loading=!1,this.first=0,this.last=0,this.page=0,this.isRangeChanged=!1,this.numItemsInViewport=0,this.lastScrollPos=0,this.lazyLoadState={},this.loaderArr=[],this.spacerStyle={},this.contentStyle={},this.initialized=!1}get id(){return this._id}set id(e){this._id=e}get style(){return this._style}set style(e){this._style=e}get styleClass(){return this._styleClass}set styleClass(e){this._styleClass=e}get tabindex(){return this._tabindex}set tabindex(e){this._tabindex=e}get items(){return this._items}set items(e){this._items=e}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e}get scrollHeight(){return this._scrollHeight}set scrollHeight(e){this._scrollHeight=e}get scrollWidth(){return this._scrollWidth}set scrollWidth(e){this._scrollWidth=e}get orientation(){return this._orientation}set orientation(e){this._orientation=e}get step(){return this._step}set step(e){this._step=e}get delay(){return this._delay}set delay(e){this._delay=e}get resizeDelay(){return this._resizeDelay}set resizeDelay(e){this._resizeDelay=e}get appendOnly(){return this._appendOnly}set appendOnly(e){this._appendOnly=e}get inline(){return this._inline}set inline(e){this._inline=e}get lazy(){return this._lazy}set lazy(e){this._lazy=e}get disabled(){return this._disabled}set disabled(e){this._disabled=e}get loaderDisabled(){return this._loaderDisabled}set loaderDisabled(e){this._loaderDisabled=e}get columns(){return this._columns}set columns(e){this._columns=e}get showSpacer(){return this._showSpacer}set showSpacer(e){this._showSpacer=e}get showLoader(){return this._showLoader}set showLoader(e){this._showLoader=e}get numToleratedItems(){return this._numToleratedItems}set numToleratedItems(e){this._numToleratedItems=e}get loading(){return this._loading}set loading(e){this._loading=e}get autoSize(){return this._autoSize}set autoSize(e){this._autoSize=e}get trackBy(){return this._trackBy}set trackBy(e){this._trackBy=e}get options(){return this._options}set options(e){this._options=e,e&&"object"==typeof e&&Object.entries(e).forEach(([o,r])=>this[`_${o}`]!==r&&(this[`_${o}`]=r))}get vertical(){return"vertical"===this._orientation}get horizontal(){return"horizontal"===this._orientation}get both(){return"both"===this._orientation}get loadedItems(){return this._items&&!this.d_loading?this.both?this._items.slice(this._appendOnly?0:this.first.rows,this.last.rows).map(e=>this._columns?e:e.slice(this._appendOnly?0:this.first.cols,this.last.cols)):this.horizontal&&this._columns?this._items:this._items.slice(this._appendOnly?0:this.first,this.last):[]}get loadedRows(){return this.d_loading?this._loaderDisabled?this.loaderArr:[]:this.loadedItems}get loadedColumns(){return this._columns&&(this.both||this.horizontal)?this.d_loading&&this._loaderDisabled?this.both?this.loaderArr[0]:this.loaderArr:this._columns.slice(this.both?this.first.cols:this.first,this.both?this.last.cols:this.last):this._columns}get isPageChanged(){return!this._step||this.page!==this.getPageByFirst()}ngOnInit(){this.setInitialState()}ngOnChanges(e){let o=!1;if(e.loading){const{previousValue:r,currentValue:s}=e.loading;this.lazy&&r!==s&&s!==this.d_loading&&(this.d_loading=s,o=!0)}if(e.orientation&&(this.lastScrollPos=this.both?{top:0,left:0}:0),e.numToleratedItems){const{previousValue:r,currentValue:s}=e.numToleratedItems;r!==s&&s!==this.d_numToleratedItems&&(this.d_numToleratedItems=s)}if(e.options){const{previousValue:r,currentValue:s}=e.options;this.lazy&&r?.loading!==s?.loading&&s?.loading!==this.d_loading&&(this.d_loading=s.loading,o=!0),r?.numToleratedItems!==s?.numToleratedItems&&s?.numToleratedItems!==this.d_numToleratedItems&&(this.d_numToleratedItems=s.numToleratedItems)}this.initialized&&!o&&(e.items?.previousValue?.length!==e.items?.currentValue?.length||e.itemSize||e.scrollHeight||e.scrollWidth)&&(this.init(),this.calculateAutoSize())}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;case"item":default:this.itemTemplate=e.template;break;case"loader":this.loaderTemplate=e.template;break;case"loadericon":this.loaderIconTemplate=e.template}})}ngAfterViewInit(){Promise.resolve().then(()=>{this.viewInit()})}ngAfterViewChecked(){this.initialized||this.viewInit()}ngOnDestroy(){this.unbindResizeListener(),this.contentEl=null,this.initialized=!1}viewInit(){Ne.isVisible(this.elementViewChild?.nativeElement)&&(this.setInitialState(),this.setContentEl(this.contentEl),this.init(),this.defaultWidth=Ne.getWidth(this.elementViewChild.nativeElement),this.defaultHeight=Ne.getHeight(this.elementViewChild.nativeElement),this.defaultContentWidth=Ne.getWidth(this.contentEl),this.defaultContentHeight=Ne.getHeight(this.contentEl),this.initialized=!0)}init(){this._disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize(),this.bindResizeListener(),this.cd.detectChanges())}setContentEl(e){this.contentEl=e||this.contentViewChild?.nativeElement||Ne.findSingle(this.elementViewChild?.nativeElement,".p-scroller-content")}setInitialState(){this.first=this.both?{rows:0,cols:0}:0,this.last=this.both?{rows:0,cols:0}:0,this.numItemsInViewport=this.both?{rows:0,cols:0}:0,this.lastScrollPos=this.both?{top:0,left:0}:0,this.d_loading=this._loading||!1,this.d_numToleratedItems=this._numToleratedItems,this.loaderArr=[],this.spacerStyle={},this.contentStyle={}}getElementRef(){return this.elementViewChild}getPageByFirst(){return Math.floor((this.first+4*this.d_numToleratedItems)/(this._step||1))}scrollTo(e){this.lastScrollPos=this.both?{top:0,left:0}:0,this.elementViewChild?.nativeElement?.scrollTo(e)}scrollToIndex(e,o="auto"){const{numToleratedItems:r}=this.calculateNumItems(),s=this.getContentPosition(),l=(C=0,D)=>C<=D?0:C,h=(C,D,R)=>C*D+R,f=(C=0,D=0)=>this.scrollTo({left:C,top:D,behavior:o});let y=0;this.both?(y={rows:l(e[0],r[0]),cols:l(e[1],r[1])},f(h(y.cols,this._itemSize[1],s.left),h(y.rows,this._itemSize[0],s.top))):(y=l(e,r),this.horizontal?f(h(y,this._itemSize,s.left),0):f(0,h(y,this._itemSize,s.top))),this.isRangeChanged=this.first!==y,this.first=y}scrollInView(e,o,r="auto"){if(o){const{first:s,viewport:l}=this.getRenderedRange(),h=(C=0,D=0)=>this.scrollTo({left:C,top:D,behavior:r}),y="to-end"===o;if("to-start"===o){if(this.both)l.first.rows-s.rows>e[0]?h(l.first.cols*this._itemSize[1],(l.first.rows-1)*this._itemSize[0]):l.first.cols-s.cols>e[1]&&h((l.first.cols-1)*this._itemSize[1],l.first.rows*this._itemSize[0]);else if(l.first-s>e){const C=(l.first-1)*this._itemSize;this.horizontal?h(C,0):h(0,C)}}else if(y)if(this.both)l.last.rows-s.rows<=e[0]+1?h(l.first.cols*this._itemSize[1],(l.first.rows+1)*this._itemSize[0]):l.last.cols-s.cols<=e[1]+1&&h((l.first.cols+1)*this._itemSize[1],l.first.rows*this._itemSize[0]);else if(l.last-s<=e+1){const C=(l.first+1)*this._itemSize;this.horizontal?h(C,0):h(0,C)}}else this.scrollToIndex(e,r)}getRenderedRange(){const e=(s,l)=>Math.floor(s/(l||s));let o=this.first,r=0;if(this.elementViewChild?.nativeElement){const{scrollTop:s,scrollLeft:l}=this.elementViewChild.nativeElement;this.both?(o={rows:e(s,this._itemSize[0]),cols:e(l,this._itemSize[1])},r={rows:o.rows+this.numItemsInViewport.rows,cols:o.cols+this.numItemsInViewport.cols}):(o=e(this.horizontal?l:s,this._itemSize),r=o+this.numItemsInViewport)}return{first:this.first,last:this.last,viewport:{first:o,last:r}}}calculateNumItems(){const e=this.getContentPosition(),o=this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetWidth-e.left:0,r=this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetHeight-e.top:0,s=(y,C)=>Math.ceil(y/(C||y)),l=y=>Math.ceil(y/2),h=this.both?{rows:s(r,this._itemSize[0]),cols:s(o,this._itemSize[1])}:s(this.horizontal?o:r,this._itemSize);return{numItemsInViewport:h,numToleratedItems:this.d_numToleratedItems||(this.both?[l(h.rows),l(h.cols)]:l(h))}}calculateOptions(){const{numItemsInViewport:e,numToleratedItems:o}=this.calculateNumItems(),r=(h,f,y,C=!1)=>this.getLast(h+f+(h<y?2:3)*y,C),s=this.first,l=this.both?{rows:r(this.first.rows,e.rows,o[0]),cols:r(this.first.cols,e.cols,o[1],!0)}:r(this.first,e,o);this.last=l,this.numItemsInViewport=e,this.d_numToleratedItems=o,this.showLoader&&(this.loaderArr=this.both?Array.from({length:e.rows}).map(()=>Array.from({length:e.cols})):Array.from({length:e})),this._lazy&&Promise.resolve().then(()=>{this.lazyLoadState={first:this._step?this.both?{rows:0,cols:s.cols}:0:s,last:Math.min(this._step?this._step:this.last,this.items.length)},this.handleEvents("onLazyLoad",this.lazyLoadState)})}calculateAutoSize(){this._autoSize&&!this.d_loading&&Promise.resolve().then(()=>{if(this.contentEl){this.contentEl.style.minHeight=this.contentEl.style.minWidth="auto",this.contentEl.style.position="relative",this.elementViewChild.nativeElement.style.contain="none";const[e,o]=[Ne.getWidth(this.contentEl),Ne.getHeight(this.contentEl)];e!==this.defaultContentWidth&&(this.elementViewChild.nativeElement.style.width=""),o!==this.defaultContentHeight&&(this.elementViewChild.nativeElement.style.height="");const[r,s]=[Ne.getWidth(this.elementViewChild.nativeElement),Ne.getHeight(this.elementViewChild.nativeElement)];(this.both||this.horizontal)&&(this.elementViewChild.nativeElement.style.width=r<this.defaultWidth?r+"px":this._scrollWidth||this.defaultWidth+"px"),(this.both||this.vertical)&&(this.elementViewChild.nativeElement.style.height=s<this.defaultHeight?s+"px":this._scrollHeight||this.defaultHeight+"px"),this.contentEl.style.minHeight=this.contentEl.style.minWidth="",this.contentEl.style.position="",this.elementViewChild.nativeElement.style.contain=""}})}getLast(e=0,o=!1){return this._items?Math.min(o?(this._columns||this._items[0]).length:this._items.length,e):0}getContentPosition(){if(this.contentEl){const e=getComputedStyle(this.contentEl),o=parseFloat(e.paddingLeft)+Math.max(parseFloat(e.left)||0,0),r=parseFloat(e.paddingRight)+Math.max(parseFloat(e.right)||0,0),s=parseFloat(e.paddingTop)+Math.max(parseFloat(e.top)||0,0),l=parseFloat(e.paddingBottom)+Math.max(parseFloat(e.bottom)||0,0);return{left:o,right:r,top:s,bottom:l,x:o+r,y:s+l}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}}setSize(){if(this.elementViewChild?.nativeElement){const e=this.elementViewChild.nativeElement.parentElement.parentElement,o=this._scrollWidth||`${this.elementViewChild.nativeElement.offsetWidth||e.offsetWidth}px`,r=this._scrollHeight||`${this.elementViewChild.nativeElement.offsetHeight||e.offsetHeight}px`,s=(l,h)=>this.elementViewChild.nativeElement.style[l]=h;this.both||this.horizontal?(s("height",r),s("width",o)):s("height",r)}}setSpacerSize(){if(this._items){const e=this.getContentPosition(),o=(r,s,l,h=0)=>this.spacerStyle={...this.spacerStyle,[`${r}`]:(s||[]).length*l+h+"px"};this.both?(o("height",this._items,this._itemSize[0],e.y),o("width",this._columns||this._items[1],this._itemSize[1],e.x)):this.horizontal?o("width",this._columns||this._items,this._itemSize,e.x):o("height",this._items,this._itemSize,e.y)}}setContentPosition(e){if(this.contentEl&&!this._appendOnly){const o=e?e.first:this.first,r=(l,h)=>l*h,s=(l=0,h=0)=>this.contentStyle={...this.contentStyle,transform:`translate3d(${l}px, ${h}px, 0)`};if(this.both)s(r(o.cols,this._itemSize[1]),r(o.rows,this._itemSize[0]));else{const l=r(o,this._itemSize);this.horizontal?s(l,0):s(0,l)}}}onScrollPositionChange(e){const o=e.target,r=this.getContentPosition(),s=(ee,ue)=>ee?ee>ue?ee-ue:ee:0,l=(ee,ue)=>Math.floor(ee/(ue||ee)),h=(ee,ue,fe,_e,Be,et)=>ee<=Be?Be:et?fe-_e-Be:ue+Be-1,f=(ee,ue,fe,_e,Be,et,gt)=>ee<=et?0:Math.max(0,gt?ee<ue?fe:ee-et:ee>ue?fe:ee-2*et),y=(ee,ue,fe,_e,Be,et=!1)=>{let gt=ue+_e+2*Be;return ee>=Be&&(gt+=Be+1),this.getLast(gt,et)},C=s(o.scrollTop,r.top),D=s(o.scrollLeft,r.left);let R=this.both?{rows:0,cols:0}:0,V=this.last,$=!1,X=this.lastScrollPos;if(this.both){const ee=this.lastScrollPos.top<=C,ue=this.lastScrollPos.left<=D;if(!this._appendOnly||this._appendOnly&&(ee||ue)){const fe={rows:l(C,this._itemSize[0]),cols:l(D,this._itemSize[1])},_e={rows:h(fe.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],ee),cols:h(fe.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],ue)};R={rows:f(fe.rows,_e.rows,this.first.rows,0,0,this.d_numToleratedItems[0],ee),cols:f(fe.cols,_e.cols,this.first.cols,0,0,this.d_numToleratedItems[1],ue)},V={rows:y(fe.rows,R.rows,0,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:y(fe.cols,R.cols,0,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},$=R.rows!==this.first.rows||V.rows!==this.last.rows||R.cols!==this.first.cols||V.cols!==this.last.cols||this.isRangeChanged,X={top:C,left:D}}}else{const ee=this.horizontal?D:C,ue=this.lastScrollPos<=ee;if(!this._appendOnly||this._appendOnly&&ue){const fe=l(ee,this._itemSize);R=f(fe,h(fe,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,ue),this.first,0,0,this.d_numToleratedItems,ue),V=y(fe,R,0,this.numItemsInViewport,this.d_numToleratedItems),$=R!==this.first||V!==this.last||this.isRangeChanged,X=ee}}return{first:R,last:V,isRangeChanged:$,scrollPos:X}}onScrollChange(e){const{first:o,last:r,isRangeChanged:s,scrollPos:l}=this.onScrollPositionChange(e);if(s){const h={first:o,last:r};if(this.setContentPosition(h),this.first=o,this.last=r,this.lastScrollPos=l,this.handleEvents("onScrollIndexChange",h),this._lazy&&this.isPageChanged){const f={first:this._step?Math.min(this.getPageByFirst()*this._step,this.items.length-this._step):o,last:Math.min(this._step?(this.getPageByFirst()+1)*this._step:r,this.items.length)};(this.lazyLoadState.first!==f.first||this.lazyLoadState.last!==f.last)&&this.handleEvents("onLazyLoad",f),this.lazyLoadState=f}}}onContainerScroll(e){if(this.handleEvents("onScroll",{originalEvent:e}),this._delay&&this.isPageChanged){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){const{isRangeChanged:o}=this.onScrollPositionChange(e);(o||this._step&&this.isPageChanged)&&(this.d_loading=!0,this.cd.detectChanges())}this.scrollTimeout=setTimeout(()=>{this.onScrollChange(e),this.d_loading&&this.showLoader&&(!this._lazy||void 0===this._loading)&&(this.d_loading=!1,this.page=this.getPageByFirst(),this.cd.detectChanges())},this._delay)}else!this.d_loading&&this.onScrollChange(e)}bindResizeListener(){this.windowResizeListener||this.zone.runOutsideAngular(()=>{this.windowResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.windowResizeListener),window.addEventListener("orientationchange",this.windowResizeListener)})}unbindResizeListener(){this.windowResizeListener&&(window.removeEventListener("resize",this.windowResizeListener),window.removeEventListener("orientationchange",this.windowResizeListener),this.windowResizeListener=null)}onWindowResize(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{if(Ne.isVisible(this.elementViewChild?.nativeElement)){const[e,o]=[Ne.getWidth(this.elementViewChild.nativeElement),Ne.getHeight(this.elementViewChild.nativeElement)],[r,s]=[e!==this.defaultWidth,o!==this.defaultHeight];(this.both?r||s:this.horizontal?r:this.vertical&&s)&&this.zone.run(()=>{this.d_numToleratedItems=this._numToleratedItems,this.defaultWidth=e,this.defaultHeight=o,this.defaultContentWidth=Ne.getWidth(this.contentEl),this.defaultContentHeight=Ne.getHeight(this.contentEl),this.init()})}},this._resizeDelay)}handleEvents(e,o){return this.options&&this.options[e]?this.options[e](o):this[e].emit(o)}getContentOptions(){return{contentStyleClass:"p-scroller-content "+(this.d_loading?"p-scroller-loading":""),items:this.loadedItems,getItemOptions:e=>this.getOptions(e),loading:this.d_loading,getLoaderOptions:(e,o)=>this.getLoaderOptions(e,o),itemSize:this._itemSize,rows:this.loadedRows,columns:this.loadedColumns,spacerStyle:this.spacerStyle,contentStyle:this.contentStyle,vertical:this.vertical,horizontal:this.horizontal,both:this.both}}getOptions(e){const o=(this._items||[]).length,r=this.both?this.first.rows+e:this.first+e;return{index:r,count:o,first:0===r,last:r===o-1,even:r%2==0,odd:r%2!=0}}getLoaderOptions(e,o){const r=this.loaderArr.length;return{index:e,count:r,first:0===e,last:e===r-1,even:e%2==0,odd:e%2!=0,...o}}}return t.\u0275fac=function(e){return new(e||t)(ce(Fo),ce(yi))},t.\u0275cmp=Qt({type:t,selectors:[["p-scroller"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi($X,5),pi(GX,5)),2&e){let r;gn(r=_n())&&(o.elementViewChild=r.first),gn(r=_n())&&(o.contentViewChild=r.first)}},hostAttrs:[1,"p-scroller-viewport","p-element"],inputs:{id:"id",style:"style",styleClass:"styleClass",tabindex:"tabindex",items:"items",itemSize:"itemSize",scrollHeight:"scrollHeight",scrollWidth:"scrollWidth",orientation:"orientation",step:"step",delay:"delay",resizeDelay:"resizeDelay",appendOnly:"appendOnly",inline:"inline",lazy:"lazy",disabled:"disabled",loaderDisabled:"loaderDisabled",columns:"columns",showSpacer:"showSpacer",showLoader:"showLoader",numToleratedItems:"numToleratedItems",loading:"loading",autoSize:"autoSize",trackBy:"trackBy",options:"options"},outputs:{onLazyLoad:"onLazyLoad",onScroll:"onScroll",onScrollIndexChange:"onScrollIndexChange"},features:[_r],ngContentSelectors:gY,decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["disabledContainer",""],[3,"ngStyle","ngClass","scroll"],["element",""],["buildInContent",""],["class","p-scroller-spacer",3,"ngStyle",4,"ngIf"],["class","p-scroller-loader",3,"ngClass",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-scroller-content",3,"ngClass","ngStyle"],["content",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-scroller-spacer",3,"ngStyle"],[1,"p-scroller-loader",3,"ngClass"],["buildInLoader",""],[4,"ngFor","ngForOf"],["buildInLoaderIcon",""],[1,"p-scroller-loading-icon","pi","pi-spinner","pi-spin"],[4,"ngIf"]],template:function(e,o){if(1&e&&(hr(),W(0,dY,8,14,"ng-container",0),W(1,mY,2,1,"ng-template",null,1,Ua)),2&e){const r=Un(2);L("ngIf",!o._disabled)("ngIfElse",r)}},dependencies:[ao,Ns,Xn,Cs,ho],styles:["p-scroller{flex:1;outline:0 none}.p-scroller{position:relative;overflow:auto;contain:strict;transform:translateZ(0);will-change:scroll-position;outline:0 none}.p-scroller-content{position:absolute;top:0;left:0;min-height:100%;min-width:100%;will-change:transform}.p-scroller-spacer{position:absolute;top:0;left:0;height:1px;width:1px;transform-origin:0 0;pointer-events:none}.p-scroller-loader{position:sticky;top:0;left:0;width:100%;height:100%}.p-scroller-loader.p-component-overlay{display:flex;align-items:center;justify-content:center}.p-scroller-loading-icon{font-size:2rem}.p-scroller-inline .p-scroller-content{position:static}\n"],encapsulation:2}),t})(),PC=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})(),q3=(()=>{class t{constructor(e,o,r,s,l){this.el=e,this.zone=o,this.config=r,this.renderer=s,this.changeDetector=l,this.escape=!0,this.autoHide=!0,this.fitContent=!0,this._tooltipOptions={tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",tooltipZIndex:"auto",escape:!0,positionTop:0,positionLeft:0,autoHide:!0}}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this.deactivate()}ngAfterViewInit(){this.zone.runOutsideAngular(()=>{if("hover"===this.getOption("tooltipEvent"))this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onInputClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("click",this.clickListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener);else if("focus"===this.getOption("tooltipEvent")){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let e=this.getTarget(this.el.nativeElement);e.addEventListener("focus",this.focusListener),e.addEventListener("blur",this.blurListener)}})}ngOnChanges(e){e.tooltipPosition&&this.setOption({tooltipPosition:e.tooltipPosition.currentValue}),e.tooltipEvent&&this.setOption({tooltipEvent:e.tooltipEvent.currentValue}),e.appendTo&&this.setOption({appendTo:e.appendTo.currentValue}),e.positionStyle&&this.setOption({positionStyle:e.positionStyle.currentValue}),e.tooltipStyleClass&&this.setOption({tooltipStyleClass:e.tooltipStyleClass.currentValue}),e.tooltipZIndex&&this.setOption({tooltipZIndex:e.tooltipZIndex.currentValue}),e.escape&&this.setOption({escape:e.escape.currentValue}),e.showDelay&&this.setOption({showDelay:e.showDelay.currentValue}),e.hideDelay&&this.setOption({hideDelay:e.hideDelay.currentValue}),e.life&&this.setOption({life:e.life.currentValue}),e.positionTop&&this.setOption({positionTop:e.positionTop.currentValue}),e.positionLeft&&this.setOption({positionLeft:e.positionLeft.currentValue}),e.disabled&&this.setOption({disabled:e.disabled.currentValue}),e.text&&(this.setOption({tooltipLabel:e.text.currentValue}),this.active&&(e.text.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),e.autoHide&&this.setOption({autoHide:e.autoHide.currentValue}),e.tooltipOptions&&(this._tooltipOptions={...this._tooltipOptions,...e.tooltipOptions.currentValue},this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}isAutoHide(){return this.getOption("autoHide")}onMouseEnter(e){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(e){(this.isAutoHide()||!(Ne.hasClass(e.toElement,"p-tooltip")||Ne.hasClass(e.toElement,"p-tooltip-arrow")||Ne.hasClass(e.toElement,"p-tooltip-text")||Ne.hasClass(e.relatedTarget,"p-tooltip")))&&this.deactivate()}onFocus(e){this.activate()}onBlur(e){this.deactivate()}onInputClick(e){this.deactivate()}activate(){if(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life")){let e=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},e)}}deactivate(){this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div");let e=document.createElement("div");e.className="p-tooltip-arrow",this.container.appendChild(e),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),"body"===this.getOption("appendTo")?document.body.appendChild(this.container):"target"===this.getOption("appendTo")?Ne.appendChild(this.container,this.el.nativeElement):Ne.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block",this.fitContent&&(this.container.style.width="fit-content"),this.isAutoHide()||this.bindContainerMouseleaveListener()}bindContainerMouseleaveListener(){this.containerMouseleaveListener||(this.containerMouseleaveListener=this.renderer.listen(this.container??this.container.nativeElement,"mouseleave",o=>{this.deactivate()}))}unbindContainerMouseleaveListener(){this.containerMouseleaveListener&&(this.bindContainerMouseleaveListener(),this.containerMouseleaveListener=null)}show(){!this.getOption("tooltipLabel")||this.getOption("disabled")||(this.create(),this.align(),Ne.fadeIn(this.container,250),"auto"===this.getOption("tooltipZIndex")?Ir.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener())}hide(){"auto"===this.getOption("tooltipZIndex")&&Ir.clear(this.container),this.remove()}updateText(){this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(this.getOption("tooltipLabel")))):this.tooltipText.innerHTML=this.getOption("tooltipLabel")}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()))}}getHostOffset(){if("body"===this.getOption("appendTo")||"target"===this.getOption("appendTo")){let e=this.el.nativeElement.getBoundingClientRect();return{left:e.left+Ne.getWindowScrollLeft(),top:e.top+Ne.getWindowScrollTop()}}return{left:0,top:0}}alignRight(){this.preAlign("right");let e=this.getHostOffset(),o=e.left+Ne.getOuterWidth(this.el.nativeElement),r=e.top+(Ne.getOuterHeight(this.el.nativeElement)-Ne.getOuterHeight(this.container))/2;this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignLeft(){this.preAlign("left");let e=this.getHostOffset(),o=e.left-Ne.getOuterWidth(this.container),r=e.top+(Ne.getOuterHeight(this.el.nativeElement)-Ne.getOuterHeight(this.container))/2;this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let e=this.getHostOffset(),o=e.left+(Ne.getOuterWidth(this.el.nativeElement)-Ne.getOuterWidth(this.container))/2,r=e.top-Ne.getOuterHeight(this.container);this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let e=this.getHostOffset(),o=e.left+(Ne.getOuterWidth(this.el.nativeElement)-Ne.getOuterWidth(this.container))/2,r=e.top+Ne.getOuterHeight(this.el.nativeElement);this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}setOption(e){this._tooltipOptions={...this._tooltipOptions,...e}}getOption(e){return this._tooltipOptions[e]}getTarget(e){return Ne.hasClass(e,"p-inputwrapper")?Ne.findSingle(e,"input"):e}preAlign(e){this.container.style.left="-999px",this.container.style.top="-999px";let o="p-tooltip p-component p-tooltip-"+e;this.container.className=this.getOption("tooltipStyleClass")?o+" "+this.getOption("tooltipStyleClass"):o}isOutOfBounds(){let e=this.container.getBoundingClientRect(),o=e.top,r=e.left,s=Ne.getOuterWidth(this.container),l=Ne.getOuterHeight(this.container),h=Ne.getViewport();return r+s>h.width||r<0||o<0||o+l>h.height}onWindowResize(e){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new w0(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){if("hover"===this.getOption("tooltipEvent"))this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener);else if("focus"===this.getOption("tooltipEvent")){let e=this.getTarget(this.el.nativeElement);e.removeEventListener("focus",this.focusListener),e.removeEventListener("blur",this.blurListener)}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&("body"===this.getOption("appendTo")?document.body.removeChild(this.container):"target"===this.getOption("appendTo")?this.el.nativeElement.removeChild(this.container):Ne.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.unbindContainerMouseleaveListener(),this.clearTimeouts(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&Ir.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(yi),ce(fl),ce(Jr),ce(Fo))},t.\u0275dir=On({type:t,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:"escape",showDelay:"showDelay",hideDelay:"hideDelay",life:"life",positionTop:"positionTop",positionLeft:"positionLeft",autoHide:"autoHide",fitContent:"fitContent",text:["pTooltip","text"],disabled:["tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[_r]}),t})(),Du=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();function _Y(t,n){if(1&t&&(P(0,"span"),ie(1),N()),2&t){const e=U();let o;F(1),Ut(null!==(o=e.label)&&void 0!==o?o:"empty")}}function yY(t,n){1&t&&$t(0)}const C0=function(t){return{height:t}},vY=function(t,n){return{"p-dropdown-item":!0,"p-highlight":t,"p-disabled":n}},mD=function(t){return{$implicit:t}},bY=["container"],xY=["filter"],wY=["in"],CY=["editableInput"],TY=["items"],SY=["scroller"],EY=["overlay"];function IY(t,n){if(1&t&&(wn(0),ie(1),Pn()),2&t){const e=U(2);F(1),Ut(e.label||"empty")}}function DY(t,n){1&t&&$t(0)}const MY=function(t){return{"p-dropdown-label p-inputtext":!0,"p-dropdown-label-empty":t}};function kY(t,n){if(1&t&&(P(0,"span",14),W(1,IY,2,1,"ng-container",15),W(2,DY,1,0,"ng-container",16),N()),2&t){const e=U();L("ngClass",Wt(9,MY,null==e.label||0===e.label.length))("pTooltip",e.tooltip)("tooltipPosition",e.tooltipPosition)("positionStyle",e.tooltipPositionStyle)("tooltipStyleClass",e.tooltipStyleClass),at("id",e.labelId),F(1),L("ngIf",!e.selectedItemTemplate),F(1),L("ngTemplateOutlet",e.selectedItemTemplate)("ngTemplateOutletContext",Wt(11,mD,e.selectedOption))}}const AY=function(t){return{"p-dropdown-label p-inputtext p-placeholder":!0,"p-dropdown-label-empty":t}};function PY(t,n){if(1&t&&(P(0,"span",17),ie(1),N()),2&t){const e=U();L("ngClass",Wt(2,AY,null==e.placeholder||0===e.placeholder.length)),F(1),Ut(e.placeholder||"empty")}}function OY(t,n){if(1&t){const e=Ye();P(0,"input",18,19),Te("input",function(r){return be(e),ve(U().onEditableInputChange(r))})("focus",function(r){return be(e),ve(U().onEditableInputFocus(r))})("blur",function(r){return be(e),ve(U().onInputBlur(r))}),N()}if(2&t){const e=U();L("disabled",e.disabled),at("maxlength",e.maxlength)("placeholder",e.placeholder)("aria-expanded",e.overlayVisible)}}function LY(t,n){if(1&t){const e=Ye();P(0,"i",20),Te("click",function(r){return be(e),ve(U().clear(r))}),N()}}function RY(t,n){1&t&&$t(0)}function FY(t,n){1&t&&$t(0)}const Z3=function(t){return{options:t}};function NY(t,n){if(1&t&&(wn(0),W(1,FY,1,0,"ng-container",16),Pn()),2&t){const e=U(3);F(1),L("ngTemplateOutlet",e.filterTemplate)("ngTemplateOutletContext",Wt(2,Z3,e.filterOptions))}}function zY(t,n){if(1&t){const e=Ye();P(0,"div",30)(1,"input",31,32),Te("keydown.enter",function(r){return r.preventDefault()})("keydown",function(r){return be(e),ve(U(3).onKeydown(r,!1))})("input",function(r){return be(e),ve(U(3).onFilterInputChange(r))}),N(),Ae(3,"span",33),N()}if(2&t){const e=U(3);F(1),L("value",e.filterValue||""),at("placeholder",e.filterPlaceholder)("aria-label",e.ariaFilterLabel)("aria-activedescendant",e.overlayVisible?"p-highlighted-option":e.labelId)}}function BY(t,n){if(1&t&&(P(0,"div",27),Te("click",function(o){return o.stopPropagation()}),W(1,NY,2,4,"ng-container",28),W(2,zY,4,4,"ng-template",null,29,Ua),N()),2&t){const e=Un(3),o=U(2);F(1),L("ngIf",o.filterTemplate)("ngIfElse",e)}}function VY(t,n){1&t&&$t(0)}const K3=function(t,n){return{$implicit:t,options:n}};function UY(t,n){if(1&t&&W(0,VY,1,0,"ng-container",16),2&t){const e=n.$implicit,o=n.options;U(2),L("ngTemplateOutlet",Un(7))("ngTemplateOutletContext",Ji(2,K3,e,o))}}function jY(t,n){1&t&&$t(0)}function HY(t,n){if(1&t&&W(0,jY,1,0,"ng-container",16),2&t){const e=n.options;L("ngTemplateOutlet",U(4).loaderTemplate)("ngTemplateOutletContext",Wt(2,Z3,e))}}function $Y(t,n){1&t&&(wn(0),W(1,HY,1,4,"ng-template",36),Pn())}function GY(t,n){if(1&t){const e=Ye();P(0,"p-scroller",34,35),Te("onLazyLoad",function(r){return be(e),ve(U(2).onLazyLoad.emit(r))}),W(2,UY,1,5,"ng-template",13),W(3,$Y,2,0,"ng-container",15),N()}if(2&t){const e=U(2);Io(Wt(8,C0,e.scrollHeight)),L("items",e.optionsToDisplay)("itemSize",e.virtualScrollItemSize||e._itemSize)("autoSize",!0)("lazy",e.lazy)("options",e.virtualScrollOptions),F(3),L("ngIf",e.loaderTemplate)}}function WY(t,n){1&t&&$t(0)}const qY=function(){return{}};function ZY(t,n){if(1&t&&(wn(0),W(1,WY,1,0,"ng-container",16),Pn()),2&t){U();const e=Un(7),o=U();F(1),L("ngTemplateOutlet",e)("ngTemplateOutletContext",Ji(3,K3,o.optionsToDisplay,Kn(2,qY)))}}function KY(t,n){if(1&t&&(P(0,"span"),ie(1),N()),2&t){const e=U().$implicit,o=U(4);F(1),Ut(o.getOptionGroupLabel(e)||"empty")}}function XY(t,n){1&t&&$t(0)}function YY(t,n){1&t&&$t(0)}const X3=function(t,n){return{$implicit:t,selectedOption:n}};function QY(t,n){if(1&t&&(P(0,"li",42),W(1,KY,2,1,"span",15),W(2,XY,1,0,"ng-container",16),N(),W(3,YY,1,0,"ng-container",16)),2&t){const e=n.$implicit,o=U(2).options,r=Un(5),s=U(2);L("ngStyle",Wt(6,C0,o.itemSize+"px")),F(1),L("ngIf",!s.groupTemplate),F(1),L("ngTemplateOutlet",s.groupTemplate)("ngTemplateOutletContext",Wt(8,mD,e)),F(1),L("ngTemplateOutlet",r)("ngTemplateOutletContext",Ji(10,X3,s.getOptionGroupChildren(e),s.selectedOption))}}function JY(t,n){if(1&t&&(wn(0),W(1,QY,4,13,"ng-template",41),Pn()),2&t){const e=U().$implicit;F(1),L("ngForOf",e)}}function eQ(t,n){1&t&&$t(0)}function tQ(t,n){if(1&t&&(wn(0),W(1,eQ,1,0,"ng-container",16),Pn()),2&t){const e=U().$implicit,o=Un(5),r=U(2);F(1),L("ngTemplateOutlet",o)("ngTemplateOutletContext",Ji(2,X3,e,r.selectedOption))}}function nQ(t,n){if(1&t){const e=Ye();P(0,"p-dropdownItem",43),Te("onClick",function(r){return be(e),ve(U(4).onItemClick(r))}),N()}if(2&t){const e=n.$implicit,o=U().selectedOption,r=U(3);L("option",e)("selected",o==e)("label",r.getOptionLabel(e))("disabled",r.isOptionDisabled(e))("template",r.itemTemplate)}}function iQ(t,n){1&t&&W(0,nQ,1,5,"ng-template",41),2&t&&L("ngForOf",n.$implicit)}function oQ(t,n){if(1&t&&(wn(0),ie(1),Pn()),2&t){const e=U(4);F(1),jn(" ",e.emptyFilterMessageLabel," ")}}function rQ(t,n){1&t&&$t(0,null,45)}function sQ(t,n){if(1&t&&(P(0,"li",44),W(1,oQ,2,1,"ng-container",28),W(2,rQ,2,0,"ng-container",22),N()),2&t){const e=U().options,o=U(2);L("ngStyle",Wt(4,C0,e.itemSize+"px")),F(1),L("ngIf",!o.emptyFilterTemplate&&!o.emptyTemplate)("ngIfElse",o.emptyFilter),F(1),L("ngTemplateOutlet",o.emptyFilterTemplate||o.emptyTemplate)}}function aQ(t,n){if(1&t&&(wn(0),ie(1),Pn()),2&t){const e=U(4);F(1),jn(" ",e.emptyMessageLabel," ")}}function lQ(t,n){1&t&&$t(0,null,46)}function cQ(t,n){if(1&t&&(P(0,"li",44),W(1,aQ,2,1,"ng-container",28),W(2,lQ,2,0,"ng-container",22),N()),2&t){const e=U().options,o=U(2);L("ngStyle",Wt(4,C0,e.itemSize+"px")),F(1),L("ngIf",!o.emptyTemplate)("ngIfElse",o.empty),F(1),L("ngTemplateOutlet",o.emptyTemplate)}}function uQ(t,n){if(1&t&&(P(0,"ul",37,38),W(2,JY,2,1,"ng-container",15),W(3,tQ,2,5,"ng-container",15),W(4,iQ,1,1,"ng-template",null,39,Ua),W(6,sQ,3,6,"li",40),W(7,cQ,3,6,"li",40),N()),2&t){const e=n.options,o=U(2);Io(e.contentStyle),L("ngClass",e.contentStyleClass),at("id",o.listId),F(2),L("ngIf",o.group),F(1),L("ngIf",!o.group),F(3),L("ngIf",o.filterValue&&o.isEmpty()),F(1),L("ngIf",!o.filterValue&&o.isEmpty())}}function dQ(t,n){1&t&&$t(0)}function hQ(t,n){if(1&t&&(P(0,"div",21),W(1,RY,1,0,"ng-container",22),W(2,BY,4,2,"div",23),P(3,"div",24),W(4,GY,4,10,"p-scroller",25),W(5,ZY,2,6,"ng-container",15),W(6,uQ,8,8,"ng-template",null,26,Ua),N(),W(8,dQ,1,0,"ng-container",22),N()),2&t){const e=U();Zn(e.panelStyleClass),L("ngClass","p-dropdown-panel p-component")("ngStyle",e.panelStyle),F(1),L("ngTemplateOutlet",e.headerTemplate),F(1),L("ngIf",e.filter),F(1),za("max-height",e.virtualScroll?"auto":e.scrollHeight||"auto"),F(1),L("ngIf",e.virtualScroll),F(1),L("ngIf",!e.virtualScroll),F(3),L("ngTemplateOutlet",e.footerTemplate)}}const pQ=function(t,n,e,o){return{"p-dropdown p-component":!0,"p-disabled":t,"p-dropdown-open":n,"p-focus":e,"p-dropdown-clearable":o}},fQ={provide:zs,useExisting:Ei(()=>gD),multi:!0};let mQ=(()=>{class t{constructor(){this.onClick=new ht}onOptionClick(e){this.onClick.emit({originalEvent:e,option:this.option})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["p-dropdownItem"]],hostAttrs:[1,"p-element"],inputs:{option:"option",selected:"selected",label:"label",disabled:"disabled",visible:"visible",itemSize:"itemSize",template:"template"},outputs:{onClick:"onClick"},decls:3,vars:15,consts:[["role","option","pRipple","",3,"ngStyle","id","ngClass","click"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){1&e&&(P(0,"li",0),Te("click",function(s){return o.onOptionClick(s)}),W(1,_Y,2,1,"span",1),W(2,yY,1,0,"ng-container",2),N()),2&e&&(L("ngStyle",Wt(8,C0,o.itemSize+"px"))("id",o.selected?"p-highlighted-option":"")("ngClass",Ji(10,vY,o.selected,o.disabled)),at("aria-label",o.label)("aria-selected",o.selected),F(1),L("ngIf",!o.template),F(1),L("ngTemplateOutlet",o.template)("ngTemplateOutletContext",Wt(13,mD,o.option)))},dependencies:[ao,Xn,Cs,ho,Iu],encapsulation:2}),t})(),gD=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.renderer=o,this.cd=r,this.zone=s,this.filterService=l,this.config=h,this.scrollHeight="200px",this.resetFilterOnHide=!1,this.dropdownIcon="pi pi-chevron-down",this.optionGroupChildren="items",this.autoDisplayFirst=!0,this.emptyFilterMessage="",this.emptyMessage="",this.lazy=!1,this.filterMatchMode="contains",this.tooltip="",this.tooltipPosition="right",this.tooltipPositionStyle="absolute",this.autofocusFilter=!0,this.overlayDirection="end",this.onChange=new ht,this.onFilter=new ht,this.onFocus=new ht,this.onBlur=new ht,this.onClick=new ht,this.onShow=new ht,this.onHide=new ht,this.onClear=new ht,this.onLazyLoad=new ht,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.id=Ig()}get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1,this.overlayVisible&&this.hide()),this._disabled=e,this.cd.destroyed||this.cd.detectChanges()}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e,console.warn("The itemSize property is deprecated, use virtualScrollItemSize property instead.")}get autoZIndex(){return this._autoZIndex}set autoZIndex(e){this._autoZIndex=e,console.warn("The autoZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}get baseZIndex(){return this._baseZIndex}set baseZIndex(e){this._baseZIndex=e,console.warn("The baseZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}get showTransitionOptions(){return this._showTransitionOptions}set showTransitionOptions(e){this._showTransitionOptions=e,console.warn("The showTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}get hideTransitionOptions(){return this._hideTransitionOptions}set hideTransitionOptions(e){this._hideTransitionOptions=e,console.warn("The hideTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":default:this.itemTemplate=e.template;break;case"selectedItem":this.selectedItemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"filter":this.filterTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"emptyfilter":this.emptyFilterTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"group":this.groupTemplate=e.template;break;case"loader":this.loaderTemplate=e.template}})}ngOnInit(){this.optionsToDisplay=this.options,this.updateSelectedOption(null),this.labelId=this.id+"_label",this.listId=this.id+"_list",this.filterBy&&(this.filterOptions={filter:e=>this.onFilterInputChange(e),reset:()=>this.resetFilter()})}get options(){return this._options}set options(e){this._options=e,this.optionsToDisplay=this._options,this.updateSelectedOption(this.value),this.selectedOption=this.findOption(this.value,this.optionsToDisplay),!this.selectedOption&&xn.isNotEmpty(this.value)&&!this.editable&&(this.value=null,this.onModelChange(this.value)),this.optionsChanged=!0,this._filterValue&&this._filterValue.length&&this.activateFilter()}get filterValue(){return this._filterValue}set filterValue(e){this._filterValue=e,this.activateFilter()}ngAfterViewInit(){this.editable&&this.updateEditableLabel()}get label(){return"number"==typeof this.selectedOption&&(this.selectedOption=this.selectedOption.toString()),this.selectedOption?this.getOptionLabel(this.selectedOption):null}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(zr.EMPTY_MESSAGE)}get emptyFilterMessageLabel(){return this.emptyFilterMessage||this.config.getTranslation(zr.EMPTY_FILTER_MESSAGE)}get filled(){return"string"==typeof this.value?!!this.value:this.value||null!=this.value||null!=this.value}get isVisibleClearIcon(){return null!=this.value&&""!==this.value&&this.showClear&&!this.disabled}updateEditableLabel(){this.editableInputViewChild&&this.editableInputViewChild.nativeElement&&(this.editableInputViewChild.nativeElement.value=this.selectedOption?this.getOptionLabel(this.selectedOption):this.value||"")}getOptionLabel(e){return this.optionLabel?xn.resolveFieldData(e,this.optionLabel):e&&void 0!==e.label?e.label:e}getOptionValue(e){return this.optionValue?xn.resolveFieldData(e,this.optionValue):!this.optionLabel&&e&&void 0!==e.value?e.value:e}isOptionDisabled(e){return this.optionDisabled?xn.resolveFieldData(e,this.optionDisabled):!(!e||void 0===e.disabled)&&e.disabled}getOptionGroupLabel(e){return this.optionGroupLabel?xn.resolveFieldData(e,this.optionGroupLabel):e&&void 0!==e.label?e.label:e}getOptionGroupChildren(e){return this.optionGroupChildren?xn.resolveFieldData(e,this.optionGroupChildren):e.items}onItemClick(e){const o=e.option;this.isOptionDisabled(o)||(this.selectItem(e.originalEvent,o),this.accessibleViewChild.nativeElement.focus({preventScroll:!0})),setTimeout(()=>{this.hide()},1)}selectItem(e,o){this.selectedOption!=o&&(this.selectedOption=o,this.value=this.getOptionValue(o),this.onModelChange(this.value),this.updateEditableLabel(),this.onChange.emit({originalEvent:e,value:this.value}))}ngAfterViewChecked(){if(this.optionsChanged&&this.overlayVisible&&(this.optionsChanged=!1,this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild&&this.overlayViewChild.alignOverlay()},1)})),this.selectedOptionUpdated&&this.itemsWrapper){let e=Ne.findSingle(this.overlayViewChild.overlayViewChild.nativeElement,"li.p-highlight");e&&Ne.scrollInView(this.itemsWrapper,e),this.selectedOptionUpdated=!1}}writeValue(e){this.filter&&this.resetFilter(),this.value=e,this.updateSelectedOption(e),this.updateEditableLabel(),this.cd.markForCheck()}resetFilter(){this._filterValue=null,this.filterViewChild&&this.filterViewChild.nativeElement&&(this.filterViewChild.nativeElement.value=""),this.optionsToDisplay=this.options}updateSelectedOption(e){this.selectedOption=this.findOption(e,this.optionsToDisplay),this.autoDisplayFirst&&!this.placeholder&&!this.selectedOption&&this.optionsToDisplay&&this.optionsToDisplay.length&&!this.editable&&(this.selectedOption=this.group?this.optionsToDisplay[0].items[0]:this.optionsToDisplay[0],this.value=this.getOptionValue(this.selectedOption),this.onModelChange(this.value)),this.selectedOptionUpdated=!0}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onMouseclick(e){this.disabled||this.readonly||this.isInputClick(e)||(this.onClick.emit(e),this.accessibleViewChild.nativeElement.focus({preventScroll:!0}),this.overlayVisible?this.hide():this.show(),this.cd.detectChanges())}isInputClick(e){return Ne.hasClass(e.target,"p-dropdown-clear-icon")||e.target.isSameNode(this.accessibleViewChild.nativeElement)||this.editableInputViewChild&&e.target.isSameNode(this.editableInputViewChild.nativeElement)}isEmpty(){return!this.optionsToDisplay||this.optionsToDisplay&&0===this.optionsToDisplay.length}onEditableInputFocus(e){this.focused=!0,this.hide(),this.onFocus.emit(e)}onEditableInputChange(e){this.value=e.target.value,this.updateSelectedOption(this.value),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value})}show(){this.overlayVisible=!0,this.cd.markForCheck()}onOverlayAnimationStart(e){if("visible"===e.toState){if(this.itemsWrapper=Ne.findSingle(this.overlayViewChild.overlayViewChild.nativeElement,this.virtualScroll?".p-scroller":".p-dropdown-items-wrapper"),this.virtualScroll&&this.scroller.setContentEl(this.itemsViewChild.nativeElement),this.options&&this.options.length)if(this.virtualScroll){const o=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;-1!==o&&this.scroller.scrollToIndex(o)}else{let o=Ne.findSingle(this.itemsWrapper,".p-dropdown-item.p-highlight");o&&o.scrollIntoView({block:"nearest",inline:"center"})}this.filterViewChild&&this.filterViewChild.nativeElement&&(this.preventModelTouched=!0,this.autofocusFilter&&this.filterViewChild.nativeElement.focus()),this.onShow.emit(e)}"void"===e.toState&&(this.itemsWrapper=null,this.onModelTouched(),this.onHide.emit(e))}hide(){this.overlayVisible=!1,this.filter&&this.resetFilterOnHide&&this.resetFilter(),this.cd.markForCheck()}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.onBlur.emit(e),this.preventModelTouched||this.onModelTouched(),this.preventModelTouched=!1}findPrevEnabledOption(e){let o;if(this.optionsToDisplay&&this.optionsToDisplay.length){for(let r=e-1;0<=r;r--){let s=this.optionsToDisplay[r];if(!this.isOptionDisabled(s)){o=s;break}}if(!o)for(let r=this.optionsToDisplay.length-1;r>=e;r--){let s=this.optionsToDisplay[r];if(!this.isOptionDisabled(s)){o=s;break}}}return o}findNextEnabledOption(e){let o;if(this.optionsToDisplay&&this.optionsToDisplay.length){for(let r=e+1;r<this.optionsToDisplay.length;r++){let s=this.optionsToDisplay[r];if(!this.isOptionDisabled(s)){o=s;break}}if(!o)for(let r=0;r<e;r++){let s=this.optionsToDisplay[r];if(!this.isOptionDisabled(s)){o=s;break}}}return o}onKeydown(e,o){if(!this.readonly&&this.optionsToDisplay&&null!==this.optionsToDisplay.length)switch(e.which){case 40:if(!this.overlayVisible&&e.altKey)this.show();else if(this.group){let r=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;if(-1!==r){let s=r.itemIndex+1;s<this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex]).length?(this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex])[s]),this.selectedOptionUpdated=!0):this.optionsToDisplay[r.groupIndex+1]&&(this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex+1])[0]),this.selectedOptionUpdated=!0)}else this.optionsToDisplay&&this.optionsToDisplay.length>0&&this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[0])[0])}else{let r=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1,s=this.findNextEnabledOption(r);s&&(this.selectItem(e,s),this.selectedOptionUpdated=!0)}e.preventDefault();break;case 38:if(this.group){let r=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;if(-1!==r){let s=r.itemIndex-1;if(s>=0)this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex])[s]),this.selectedOptionUpdated=!0;else if(s<0){let l=this.optionsToDisplay[r.groupIndex-1];l&&(this.selectItem(e,this.getOptionGroupChildren(l)[this.getOptionGroupChildren(l).length-1]),this.selectedOptionUpdated=!0)}}}else{let r=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1,s=this.findPrevEnabledOption(r);s&&(this.selectItem(e,s),this.selectedOptionUpdated=!0)}e.preventDefault();break;case 32:o&&(this.overlayVisible?this.hide():this.show(),e.preventDefault());break;case 13:this.overlayVisible&&(!this.filter||this.optionsToDisplay&&this.optionsToDisplay.length>0)?this.hide():this.overlayVisible||this.show(),e.preventDefault();break;case 27:case 9:this.hide();break;default:o&&!e.metaKey&&17!==e.which&&this.search(e)}}search(e){this.searchTimeout&&clearTimeout(this.searchTimeout);const o=e.key;let r;if(this.previousSearchChar=this.currentSearchChar,this.currentSearchChar=o,this.searchValue=this.previousSearchChar===this.currentSearchChar?this.currentSearchChar:this.searchValue?this.searchValue+o:o,this.group){let s=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):{groupIndex:0,itemIndex:0};r=this.searchOptionWithinGroup(s)}else{let s=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;r=this.searchOption(++s)}r&&!this.isOptionDisabled(r)&&(this.selectItem(e,r),this.selectedOptionUpdated=!0),this.searchTimeout=setTimeout(()=>{this.searchValue=null},250)}searchOption(e){let o;return this.searchValue&&(o=this.searchOptionInRange(e,this.optionsToDisplay.length),o||(o=this.searchOptionInRange(0,e))),o}searchOptionInRange(e,o){for(let r=e;r<o;r++){let s=this.optionsToDisplay[r];if(this.getOptionLabel(s).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(s))return s}return null}searchOptionWithinGroup(e){if(this.searchValue){for(let r=e.groupIndex;r<this.optionsToDisplay.length;r++)for(let s=e.groupIndex===r?e.itemIndex+1:0;s<this.getOptionGroupChildren(this.optionsToDisplay[r]).length;s++){let l=this.getOptionGroupChildren(this.optionsToDisplay[r])[s];if(this.getOptionLabel(l).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(l))return l}for(let r=0;r<=e.groupIndex;r++)for(let s=0;s<(e.groupIndex===r?e.itemIndex:this.getOptionGroupChildren(this.optionsToDisplay[r]).length);s++){let l=this.getOptionGroupChildren(this.optionsToDisplay[r])[s];if(this.getOptionLabel(l).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(l))return l}}return null}findOptionIndex(e,o){let r=-1;if(o)for(let s=0;s<o.length;s++)if(null==e&&null==this.getOptionValue(o[s])||xn.equals(e,this.getOptionValue(o[s]),this.dataKey)){r=s;break}return r}findOptionGroupIndex(e,o){let r,s;if(o)for(let l=0;l<o.length&&(r=l,s=this.findOptionIndex(e,this.getOptionGroupChildren(o[l])),-1===s);l++);return-1!==s?{groupIndex:r,itemIndex:s}:-1}findOption(e,o,r){if(this.group&&!r){let s;if(o&&o.length)for(let l of o)if(s=this.findOption(e,this.getOptionGroupChildren(l),!0),s)break;return s}{let s=this.findOptionIndex(e,o);return-1!=s?o[s]:null}}onFilterInputChange(e){let o=e.target.value;o&&o.length?(this._filterValue=o,this.activateFilter()):(this._filterValue=null,this.optionsToDisplay=this.options),this.virtualScroll&&this.scroller.scrollToIndex(0),this.optionsChanged=!0,this.onFilter.emit({originalEvent:e,filter:this._filterValue})}activateFilter(){let e=(this.filterBy||this.optionLabel||"label").split(",");if(this.options&&this.options.length){if(this.group){let o=[];for(let r of this.options){let s=this.filterService.filter(this.getOptionGroupChildren(r),e,this.filterValue,this.filterMatchMode,this.filterLocale);s&&s.length&&o.push({...r,[this.optionGroupChildren]:s})}this.optionsToDisplay=o}else this.optionsToDisplay=this.filterService.filter(this.options,e,this.filterValue,this.filterMatchMode,this.filterLocale);this.optionsChanged=!0}}applyFocus(){this.editable?Ne.findSingle(this.el.nativeElement,".p-dropdown-label.p-inputtext").focus():Ne.findSingle(this.el.nativeElement,"input[readonly]").focus()}focus(){this.applyFocus()}clear(e){this.value=null,this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}),this.updateSelectedOption(this.value),this.updateEditableLabel(),this.onClear.emit(e)}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Jr),ce(Fo),ce(yi),ce(Y2),ce(fl))},t.\u0275cmp=Qt({type:t,selectors:[["p-dropdown"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(bY,5),pi(xY,5),pi(wY,5),pi(CY,5),pi(TY,5),pi(SY,5),pi(EY,5)),2&e){let r;gn(r=_n())&&(o.containerViewChild=r.first),gn(r=_n())&&(o.filterViewChild=r.first),gn(r=_n())&&(o.accessibleViewChild=r.first),gn(r=_n())&&(o.editableInputViewChild=r.first),gn(r=_n())&&(o.itemsViewChild=r.first),gn(r=_n())&&(o.scroller=r.first),gn(r=_n())&&(o.overlayViewChild=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:4,hostBindings:function(e,o){2&e&&Ro("p-inputwrapper-filled",o.filled)("p-inputwrapper-focus",o.focused||o.overlayVisible)},inputs:{scrollHeight:"scrollHeight",filter:"filter",name:"name",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",readonly:"readonly",required:"required",editable:"editable",appendTo:"appendTo",tabindex:"tabindex",placeholder:"placeholder",filterPlaceholder:"filterPlaceholder",filterLocale:"filterLocale",inputId:"inputId",selectId:"selectId",dataKey:"dataKey",filterBy:"filterBy",autofocus:"autofocus",resetFilterOnHide:"resetFilterOnHide",dropdownIcon:"dropdownIcon",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",optionGroupLabel:"optionGroupLabel",optionGroupChildren:"optionGroupChildren",autoDisplayFirst:"autoDisplayFirst",group:"group",showClear:"showClear",emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",lazy:"lazy",virtualScroll:"virtualScroll",virtualScrollItemSize:"virtualScrollItemSize",virtualScrollOptions:"virtualScrollOptions",overlayOptions:"overlayOptions",ariaFilterLabel:"ariaFilterLabel",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",filterMatchMode:"filterMatchMode",maxlength:"maxlength",tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",autofocusFilter:"autofocusFilter",overlayDirection:"overlayDirection",disabled:"disabled",itemSize:"itemSize",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",options:"options",filterValue:"filterValue"},outputs:{onChange:"onChange",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onClick:"onClick",onShow:"onShow",onHide:"onHide",onClear:"onClear",onLazyLoad:"onLazyLoad"},features:[zi([fQ])],decls:14,vars:32,consts:[[3,"ngClass","ngStyle","click"],["container",""],[1,"p-hidden-accessible"],["type","text","readonly","","aria-haspopup","listbox","aria-haspopup","listbox","pAutoFocus","","role","combobox",3,"disabled","autofocus","focus","blur","keydown"],["in",""],[3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass",4,"ngIf"],[3,"ngClass",4,"ngIf"],["type","text","class","p-dropdown-label p-inputtext","aria-haspopup","listbox",3,"disabled","input","focus","blur",4,"ngIf"],["class","p-dropdown-clear-icon pi pi-times",3,"click",4,"ngIf"],["role","button","aria-label","dropdown trigger","aria-haspopup","listbox",1,"p-dropdown-trigger"],[1,"p-dropdown-trigger-icon",3,"ngClass"],[3,"visible","options","target","appendTo","autoZIndex","baseZIndex","showTransitionOptions","hideTransitionOptions","visibleChange","onAnimationStart","onHide"],["overlay",""],["pTemplate","content"],[3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],["type","text","aria-haspopup","listbox",1,"p-dropdown-label","p-inputtext",3,"disabled","input","focus","blur"],["editableInput",""],[1,"p-dropdown-clear-icon","pi","pi-times",3,"click"],[3,"ngClass","ngStyle"],[4,"ngTemplateOutlet"],["class","p-dropdown-header",3,"click",4,"ngIf"],[1,"p-dropdown-items-wrapper"],[3,"items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],["buildInItems",""],[1,"p-dropdown-header",3,"click"],[4,"ngIf","ngIfElse"],["builtInFilterElement",""],[1,"p-dropdown-filter-container"],["type","text","autocomplete","off",1,"p-dropdown-filter","p-inputtext","p-component",3,"value","keydown.enter","keydown","input"],["filter",""],[1,"p-dropdown-filter-icon","pi","pi-search"],[3,"items","itemSize","autoSize","lazy","options","onLazyLoad"],["scroller",""],["pTemplate","loader"],["role","listbox",1,"p-dropdown-items",3,"ngClass"],["items",""],["itemslist",""],["class","p-dropdown-empty-message",3,"ngStyle",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"p-dropdown-item-group",3,"ngStyle"],[3,"option","selected","label","disabled","template","onClick"],[1,"p-dropdown-empty-message",3,"ngStyle"],["emptyFilter",""],["empty",""]],template:function(e,o){1&e&&(P(0,"div",0,1),Te("click",function(s){return o.onMouseclick(s)}),P(2,"div",2)(3,"input",3,4),Te("focus",function(s){return o.onInputFocus(s)})("blur",function(s){return o.onInputBlur(s)})("keydown",function(s){return o.onKeydown(s,!0)}),N()(),W(5,kY,3,13,"span",5),W(6,PY,2,4,"span",6),W(7,OY,2,4,"input",7),W(8,LY,1,0,"i",8),P(9,"div",9),Ae(10,"span",10),N(),P(11,"p-overlay",11,12),Te("visibleChange",function(s){return o.overlayVisible=s})("onAnimationStart",function(s){return o.onOverlayAnimationStart(s)})("onHide",function(){return o.hide()}),W(13,hQ,9,11,"ng-template",13),N()()),2&e&&(Zn(o.styleClass),L("ngClass",vu(27,pQ,o.disabled,o.overlayVisible,o.focused,o.showClear&&!o.disabled))("ngStyle",o.style),F(3),L("disabled",o.disabled)("autofocus",o.autofocus),at("id",o.inputId)("placeholder",o.placeholder)("aria-label",o.ariaLabel)("aria-expanded",!1)("aria-labelledby",o.ariaLabelledBy)("tabindex",o.tabindex)("aria-activedescendant",o.overlayVisible?o.labelId:null),F(2),L("ngIf",!o.editable&&null!=o.label),F(1),L("ngIf",!o.editable&&null==o.label),F(1),L("ngIf",o.editable),F(1),L("ngIf",o.isVisibleClearIcon),F(1),at("aria-expanded",o.overlayVisible),F(1),L("ngClass",o.dropdownIcon),F(1),L("visible",o.overlayVisible)("options",o.overlayOptions)("target","@parent")("appendTo",o.appendTo)("autoZIndex",o.autoZIndex)("baseZIndex",o.baseZIndex)("showTransitionOptions",o.showTransitionOptions)("hideTransitionOptions",o.hideTransitionOptions))},dependencies:[ao,Ns,Xn,Cs,ho,H3,fo,q3,W3,DX,mQ],styles:[".p-dropdown{display:inline-flex;cursor:pointer;position:relative;-webkit-user-select:none;user-select:none}.p-dropdown-clear-icon{position:absolute;top:50%;margin-top:-.5rem}.p-dropdown-trigger{display:flex;align-items:center;justify-content:center;flex-shrink:0}.p-dropdown-label{display:block;white-space:nowrap;overflow:hidden;flex:1 1 auto;width:1%;text-overflow:ellipsis;cursor:pointer}.p-dropdown-label-empty{overflow:hidden;visibility:hidden}input.p-dropdown-label{cursor:default}.p-dropdown-items-wrapper{overflow:auto}.p-dropdown-item{cursor:pointer;font-weight:400;white-space:nowrap;position:relative;overflow:hidden}.p-dropdown-items{margin:0;padding:0;list-style-type:none}.p-dropdown-filter{width:100%}.p-dropdown-filter-container{position:relative}.p-dropdown-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-fluid .p-dropdown{display:flex}.p-fluid .p-dropdown .p-dropdown-label{width:1%}\n"],encapsulation:2,changeDetection:0}),t})(),zf=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,$3,hs,Du,ml,PC,MX,$3,hs,PC]}),t})();const gQ=["input"];function _Q(t,n){if(1&t){const e=Ye();P(0,"i",6),Te("click",function(){return be(e),ve(U().clear())}),N()}}const Y3=function(){return{"p-inputnumber-button p-inputnumber-button-up":!0}},Q3=function(){return{"p-inputnumber-button p-inputnumber-button-down":!0}};function yQ(t,n){if(1&t){const e=Ye();P(0,"span",7)(1,"button",8),Te("mousedown",function(r){return be(e),ve(U().onUpButtonMouseDown(r))})("mouseup",function(){return be(e),ve(U().onUpButtonMouseUp())})("mouseleave",function(){return be(e),ve(U().onUpButtonMouseLeave())})("keydown",function(r){return be(e),ve(U().onUpButtonKeyDown(r))})("keyup",function(){return be(e),ve(U().onUpButtonKeyUp())}),N(),P(2,"button",8),Te("mousedown",function(r){return be(e),ve(U().onDownButtonMouseDown(r))})("mouseup",function(){return be(e),ve(U().onDownButtonMouseUp())})("mouseleave",function(){return be(e),ve(U().onDownButtonMouseLeave())})("keydown",function(r){return be(e),ve(U().onDownButtonKeyDown(r))})("keyup",function(){return be(e),ve(U().onDownButtonKeyUp())}),N()()}if(2&t){const e=U();F(1),Zn(e.incrementButtonClass),L("ngClass",Kn(10,Y3))("icon",e.incrementButtonIcon)("disabled",e.disabled),F(1),Zn(e.decrementButtonClass),L("ngClass",Kn(11,Q3))("icon",e.decrementButtonIcon)("disabled",e.disabled)}}function vQ(t,n){if(1&t){const e=Ye();P(0,"button",8),Te("mousedown",function(r){return be(e),ve(U().onUpButtonMouseDown(r))})("mouseup",function(){return be(e),ve(U().onUpButtonMouseUp())})("mouseleave",function(){return be(e),ve(U().onUpButtonMouseLeave())})("keydown",function(r){return be(e),ve(U().onUpButtonKeyDown(r))})("keyup",function(){return be(e),ve(U().onUpButtonKeyUp())}),N()}if(2&t){const e=U();Zn(e.incrementButtonClass),L("ngClass",Kn(5,Y3))("icon",e.incrementButtonIcon)("disabled",e.disabled)}}function bQ(t,n){if(1&t){const e=Ye();P(0,"button",8),Te("mousedown",function(r){return be(e),ve(U().onDownButtonMouseDown(r))})("mouseup",function(){return be(e),ve(U().onDownButtonMouseUp())})("mouseleave",function(){return be(e),ve(U().onDownButtonMouseLeave())})("keydown",function(r){return be(e),ve(U().onDownButtonKeyDown(r))})("keyup",function(){return be(e),ve(U().onDownButtonKeyUp())}),N()}if(2&t){const e=U();Zn(e.decrementButtonClass),L("ngClass",Kn(5,Q3))("icon",e.decrementButtonIcon)("disabled",e.disabled)}}const xQ=function(t,n,e){return{"p-inputnumber p-component":!0,"p-inputnumber-buttons-stacked":t,"p-inputnumber-buttons-horizontal":n,"p-inputnumber-buttons-vertical":e}},wQ={provide:zs,useExisting:Ei(()=>J3),multi:!0};let J3=(()=>{class t{constructor(e,o){this.el=e,this.cd=o,this.showButtons=!1,this.format=!0,this.buttonLayout="stacked",this.incrementButtonIcon="pi pi-angle-up",this.decrementButtonIcon="pi pi-angle-down",this.readonly=!1,this.step=1,this.allowEmpty=!0,this.mode="decimal",this.useGrouping=!0,this.showClear=!1,this.onInput=new ht,this.onFocus=new ht,this.onBlur=new ht,this.onKeyDown=new ht,this.onClear=new ht,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.groupChar="",this.prefixChar="",this.suffixChar=""}get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1),this._disabled=e,this.timer&&this.clearTimer()}ngOnChanges(e){["locale","localeMatcher","mode","currency","currencyDisplay","useGrouping","minFractionDigits","maxFractionDigits","prefix","suffix"].some(r=>!!e[r])&&this.updateConstructParser()}ngOnInit(){this.constructParser(),this.initialized=!0}getOptions(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits}}constructParser(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());const e=[...new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)].reverse(),o=new Map(e.map((r,s)=>[r,s]));this._numeral=new RegExp(`[${e.join("")}]`,"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=r=>o.get(r)}updateConstructParser(){this.initialized&&this.constructParser()}escapeRegExp(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}getDecimalExpression(){const e=new Intl.NumberFormat(this.locale,{...this.getOptions(),useGrouping:!1});return new RegExp(`[${e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,"")}]`,"g")}getGroupingExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp(`[${this.groupChar}]`,"g")}getMinusSignExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp(`[${e.format(-1).trim().replace(this._numeral,"")}]`,"g")}getCurrencyExpression(){if(this.currency){const e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});return new RegExp(`[${e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,"")}]`,"g")}return new RegExp("[]","g")}getPrefixExpression(){if(this.prefix)this.prefixChar=this.prefix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp(`${this.escapeRegExp(this.prefixChar||"")}`,"g")}getSuffixExpression(){if(this.suffix)this.suffixChar=this.suffix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});this.suffixChar=e.format(1).split("1")[1]}return new RegExp(`${this.escapeRegExp(this.suffixChar||"")}`,"g")}formatValue(e){if(null!=e){if("-"===e)return e;if(this.format){let r=new Intl.NumberFormat(this.locale,this.getOptions()).format(e);return this.prefix&&(r=this.prefix+r),this.suffix&&(r+=this.suffix),r}return e.toString()}return""}parseValue(e){let o=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(o){if("-"===o)return o;let r=+o;return isNaN(r)?null:r}return null}repeat(e,o,r){if(this.readonly)return;let s=o||500;this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(e,40,r)},s),this.spin(e,r)}spin(e,o){let r=this.step*o,s=this.parseValue(this.input.nativeElement.value)||0,l=this.validateValue(s+r);this.maxlength&&this.maxlength<this.formatValue(l).length||(this.updateInput(l,null,"spin",null),this.updateModel(e,l),this.handleOnInput(e,s,l))}clear(){this.value=null,this.onModelChange(this.value),this.onClear.emit()}onUpButtonMouseDown(e){this.input.nativeElement.focus(),this.repeat(e,null,1),e.preventDefault()}onUpButtonMouseUp(){this.clearTimer()}onUpButtonMouseLeave(){this.clearTimer()}onUpButtonKeyDown(e){(32===e.keyCode||13===e.keyCode)&&this.repeat(e,null,1)}onUpButtonKeyUp(){this.clearTimer()}onDownButtonMouseDown(e){this.input.nativeElement.focus(),this.repeat(e,null,-1),e.preventDefault()}onDownButtonMouseUp(){this.clearTimer()}onDownButtonMouseLeave(){this.clearTimer()}onDownButtonKeyUp(){this.clearTimer()}onDownButtonKeyDown(e){(32===e.keyCode||13===e.keyCode)&&this.repeat(e,null,-1)}onUserInput(e){this.readonly||(this.isSpecialChar&&(e.target.value=this.lastValue),this.isSpecialChar=!1)}onInputKeyDown(e){if(this.readonly)return;if(this.lastValue=e.target.value,e.shiftKey||e.altKey)return void(this.isSpecialChar=!0);let o=e.target.selectionStart,r=e.target.selectionEnd,s=e.target.value,l=null;switch(e.altKey&&e.preventDefault(),e.which){case 38:this.spin(e,1),e.preventDefault();break;case 40:this.spin(e,-1),e.preventDefault();break;case 37:this.isNumeralChar(s.charAt(o-1))||e.preventDefault();break;case 39:this.isNumeralChar(s.charAt(o))||e.preventDefault();break;case 13:l=this.validateValue(this.parseValue(this.input.nativeElement.value)),this.input.nativeElement.value=this.formatValue(l),this.input.nativeElement.setAttribute("aria-valuenow",l),this.updateModel(e,l);break;case 8:if(e.preventDefault(),o===r){const h=s.charAt(o-1),{decimalCharIndex:f,decimalCharIndexWithoutPrefix:y}=this.getDecimalCharIndexes(s);if(this.isNumeralChar(h)){const C=this.getDecimalLength(s);if(this._group.test(h))this._group.lastIndex=0,l=s.slice(0,o-2)+s.slice(o-1);else if(this._decimal.test(h))this._decimal.lastIndex=0,C?this.input.nativeElement.setSelectionRange(o-1,o-1):l=s.slice(0,o-1)+s.slice(o);else if(f>0&&o>f){const D=this.isDecimalMode()&&(this.minFractionDigits||0)<C?"":"0";l=s.slice(0,o-1)+D+s.slice(o)}else 1===y?(l=s.slice(0,o-1)+"0"+s.slice(o),l=this.parseValue(l)>0?l:""):l=s.slice(0,o-1)+s.slice(o)}this.updateValue(e,l,null,"delete-single")}else l=this.deleteRange(s,o,r),this.updateValue(e,l,null,"delete-range");break;case 46:if(e.preventDefault(),o===r){const h=s.charAt(o),{decimalCharIndex:f,decimalCharIndexWithoutPrefix:y}=this.getDecimalCharIndexes(s);if(this.isNumeralChar(h)){const C=this.getDecimalLength(s);if(this._group.test(h))this._group.lastIndex=0,l=s.slice(0,o)+s.slice(o+2);else if(this._decimal.test(h))this._decimal.lastIndex=0,C?this.input.nativeElement.setSelectionRange(o+1,o+1):l=s.slice(0,o)+s.slice(o+1);else if(f>0&&o>f){const D=this.isDecimalMode()&&(this.minFractionDigits||0)<C?"":"0";l=s.slice(0,o)+D+s.slice(o+1)}else 1===y?(l=s.slice(0,o)+"0"+s.slice(o+1),l=this.parseValue(l)>0?l:""):l=s.slice(0,o)+s.slice(o+1)}this.updateValue(e,l,null,"delete-back-single")}else l=this.deleteRange(s,o,r),this.updateValue(e,l,null,"delete-range")}this.onKeyDown.emit(e)}onInputKeyPress(e){if(this.readonly)return;let o=e.which||e.keyCode,r=String.fromCharCode(o);const s=this.isDecimalSign(r),l=this.isMinusSign(r);13!=o&&e.preventDefault(),(48<=o&&o<=57||l||s)&&this.insert(e,r,{isDecimalSign:s,isMinusSign:l})}onPaste(e){if(!this.disabled&&!this.readonly){e.preventDefault();let o=(e.clipboardData||window.clipboardData).getData("Text");if(o){let r=this.parseValue(o);null!=r&&this.insert(e,r.toString())}}}allowMinusSign(){return null==this.min||this.min<0}isMinusSign(e){return!(!this._minusSign.test(e)&&"-"!==e||(this._minusSign.lastIndex=0,0))}isDecimalSign(e){return!!this._decimal.test(e)&&(this._decimal.lastIndex=0,!0)}isDecimalMode(){return"decimal"===this.mode}getDecimalCharIndexes(e){let o=e.search(this._decimal);this._decimal.lastIndex=0;const s=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:o,decimalCharIndexWithoutPrefix:s}}getCharIndexes(e){const o=e.search(this._decimal);this._decimal.lastIndex=0;const r=e.search(this._minusSign);this._minusSign.lastIndex=0;const s=e.search(this._suffix);this._suffix.lastIndex=0;const l=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:o,minusCharIndex:r,suffixCharIndex:s,currencyCharIndex:l}}insert(e,o,r={isDecimalSign:!1,isMinusSign:!1}){const s=o.search(this._minusSign);if(this._minusSign.lastIndex=0,!this.allowMinusSign()&&-1!==s)return;let l=this.input.nativeElement.selectionStart,h=this.input.nativeElement.selectionEnd,f=this.input.nativeElement.value.trim();const{decimalCharIndex:y,minusCharIndex:C,suffixCharIndex:D,currencyCharIndex:R}=this.getCharIndexes(f);let V;if(r.isMinusSign)0===l&&(V=f,(-1===C||0!==h)&&(V=this.insertText(f,o,0,h)),this.updateValue(e,V,o,"insert"));else if(r.isDecimalSign)y>0&&l===y?this.updateValue(e,f,o,"insert"):(y>l&&y<h||-1===y&&this.maxFractionDigits)&&(V=this.insertText(f,o,l,h),this.updateValue(e,V,o,"insert"));else{const $=this.numberFormat.resolvedOptions().maximumFractionDigits,X=l!==h?"range-insert":"insert";if(y>0&&l>y){if(l+o.length-(y+1)<=$){const ee=R>=l?R-1:D>=l?D:f.length;V=f.slice(0,l)+o+f.slice(l+o.length,ee)+f.slice(ee),this.updateValue(e,V,o,X)}}else V=this.insertText(f,o,l,h),this.updateValue(e,V,o,X)}}insertText(e,o,r,s){if(2===("."===o?o:o.split(".")).length){const h=e.slice(r,s).search(this._decimal);return this._decimal.lastIndex=0,h>0?e.slice(0,r)+this.formatValue(o)+e.slice(s):e||this.formatValue(o)}return s-r===e.length?this.formatValue(o):0===r?o+e.slice(s):s===e.length?e.slice(0,r)+o:e.slice(0,r)+o+e.slice(s)}deleteRange(e,o,r){let s;return s=r-o===e.length?"":0===o?e.slice(r):r===e.length?e.slice(0,o):e.slice(0,o)+e.slice(r),s}initCursor(){let e=this.input.nativeElement.selectionStart,o=this.input.nativeElement.value,r=o.length,s=null,l=(this.prefixChar||"").length;o=o.replace(this._prefix,""),e-=l;let h=o.charAt(e);if(this.isNumeralChar(h))return e+l;let f=e-1;for(;f>=0;){if(h=o.charAt(f),this.isNumeralChar(h)){s=f+l;break}f--}if(null!==s)this.input.nativeElement.setSelectionRange(s+1,s+1);else{for(f=e;f<r;){if(h=o.charAt(f),this.isNumeralChar(h)){s=f+l;break}f++}null!==s&&this.input.nativeElement.setSelectionRange(s,s)}return s||0}onInputClick(){!this.readonly&&this.input.nativeElement.value!==Ne.getSelection()&&this.initCursor()}isNumeralChar(e){return!(1!==e.length||!(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))||(this.resetRegex(),0))}resetRegex(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0}updateValue(e,o,r,s){let l=this.input.nativeElement.value,h=null;null!=o&&(h=this.parseValue(o),h=h||this.allowEmpty?h:0,this.updateInput(h,r,s,o),this.handleOnInput(e,l,h))}handleOnInput(e,o,r){this.isValueChanged(o,r)&&this.onInput.emit({originalEvent:e,value:r,formattedValue:o})}isValueChanged(e,o){return null===o&&null!==e||null!=o&&o!==("string"==typeof e?this.parseValue(e):e)}validateValue(e){return"-"===e||null==e?null:null!=this.min&&e<this.min?this.min:null!=this.max&&e>this.max?this.max:e}updateInput(e,o,r,s){o=o||"";let l=this.input.nativeElement.value,h=this.formatValue(e),f=l.length;if(h!==s&&(h=this.concatValues(h,s)),0===f){this.input.nativeElement.value=h,this.input.nativeElement.setSelectionRange(0,0);const C=this.initCursor()+o.length;this.input.nativeElement.setSelectionRange(C,C)}else{let y=this.input.nativeElement.selectionStart,C=this.input.nativeElement.selectionEnd;if(this.maxlength&&this.maxlength<h.length)return;this.input.nativeElement.value=h;let D=h.length;if("range-insert"===r){const R=this.parseValue((l||"").slice(0,y)),$=(null!==R?R.toString():"").split("").join(`(${this.groupChar})?`),X=new RegExp($,"g");X.test(h);const ee=o.split("").join(`(${this.groupChar})?`),ue=new RegExp(ee,"g");ue.test(h.slice(X.lastIndex)),C=X.lastIndex+ue.lastIndex,this.input.nativeElement.setSelectionRange(C,C)}else if(D===f)"insert"===r||"delete-back-single"===r?this.input.nativeElement.setSelectionRange(C+1,C+1):"delete-single"===r?this.input.nativeElement.setSelectionRange(C-1,C-1):("delete-range"===r||"spin"===r)&&this.input.nativeElement.setSelectionRange(C,C);else if("delete-back-single"===r){let R=l.charAt(C-1),V=l.charAt(C),$=f-D,X=this._group.test(V);X&&1===$?C+=1:!X&&this.isNumeralChar(R)&&(C+=-1*$+1),this._group.lastIndex=0,this.input.nativeElement.setSelectionRange(C,C)}else if("-"===l&&"insert"===r){this.input.nativeElement.setSelectionRange(0,0);const V=this.initCursor()+o.length+1;this.input.nativeElement.setSelectionRange(V,V)}else C+=D-f,this.input.nativeElement.setSelectionRange(C,C)}this.input.nativeElement.setAttribute("aria-valuenow",e)}concatValues(e,o){if(e&&o){let r=o.search(this._decimal);return this._decimal.lastIndex=0,this.suffixChar?e.replace(this.suffixChar,"").split(this._decimal)[0]+o.replace(this.suffixChar,"").slice(r)+this.suffixChar:-1!==r?e.split(this._decimal)[0]+o.slice(r):e}return e}getDecimalLength(e){if(e){const o=e.split(this._decimal);if(2===o.length)return o[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1;let o=this.validateValue(this.parseValue(this.input.nativeElement.value));this.input.nativeElement.value=this.formatValue(o),this.input.nativeElement.setAttribute("aria-valuenow",o),this.updateModel(e,o),this.onBlur.emit(e)}formattedValue(){return this.formatValue(this.value||this.allowEmpty?this.value:0)}updateModel(e,o){this.value!==o&&(this.value=o,this.onModelChange(o)),this.onModelTouched()}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}get filled(){return null!=this.value&&this.value.toString().length>0}clearTimer(){this.timer&&clearInterval(this.timer)}getFormatter(){return this.numberFormat}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Fo))},t.\u0275cmp=Qt({type:t,selectors:[["p-inputNumber"]],viewQuery:function(e,o){if(1&e&&pi(gQ,5),2&e){let r;gn(r=_n())&&(o.input=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,o){2&e&&Ro("p-inputwrapper-filled",o.filled)("p-inputwrapper-focus",o.focused)("p-inputnumber-clearable",o.showClear&&"vertical"!=o.buttonLayout)},inputs:{showButtons:"showButtons",format:"format",buttonLayout:"buttonLayout",inputId:"inputId",styleClass:"styleClass",style:"style",placeholder:"placeholder",size:"size",maxlength:"maxlength",tabindex:"tabindex",title:"title",ariaLabel:"ariaLabel",ariaRequired:"ariaRequired",name:"name",required:"required",autocomplete:"autocomplete",min:"min",max:"max",incrementButtonClass:"incrementButtonClass",decrementButtonClass:"decrementButtonClass",incrementButtonIcon:"incrementButtonIcon",decrementButtonIcon:"decrementButtonIcon",readonly:"readonly",step:"step",allowEmpty:"allowEmpty",locale:"locale",localeMatcher:"localeMatcher",mode:"mode",currency:"currency",currencyDisplay:"currencyDisplay",useGrouping:"useGrouping",minFractionDigits:"minFractionDigits",maxFractionDigits:"maxFractionDigits",prefix:"prefix",suffix:"suffix",inputStyle:"inputStyle",inputStyleClass:"inputStyleClass",showClear:"showClear",disabled:"disabled"},outputs:{onInput:"onInput",onFocus:"onFocus",onBlur:"onBlur",onKeyDown:"onKeyDown",onClear:"onClear"},features:[zi([wQ]),_r],decls:7,vars:32,consts:[[3,"ngClass","ngStyle"],["pInputText","","inputmode","decimal",3,"ngClass","ngStyle","value","disabled","readonly","input","keydown","keypress","paste","click","focus","blur"],["input",""],["class","p-inputnumber-clear-icon pi pi-times",3,"click",4,"ngIf"],["class","p-inputnumber-button-group",4,"ngIf"],["type","button","pButton","","tabindex","-1",3,"ngClass","class","icon","disabled","mousedown","mouseup","mouseleave","keydown","keyup",4,"ngIf"],[1,"p-inputnumber-clear-icon","pi","pi-times",3,"click"],[1,"p-inputnumber-button-group"],["type","button","pButton","","tabindex","-1",3,"ngClass","icon","disabled","mousedown","mouseup","mouseleave","keydown","keyup"]],template:function(e,o){1&e&&(P(0,"span",0)(1,"input",1,2),Te("input",function(s){return o.onUserInput(s)})("keydown",function(s){return o.onInputKeyDown(s)})("keypress",function(s){return o.onInputKeyPress(s)})("paste",function(s){return o.onPaste(s)})("click",function(){return o.onInputClick()})("focus",function(s){return o.onInputFocus(s)})("blur",function(s){return o.onInputBlur(s)}),N(),W(3,_Q,1,0,"i",3),W(4,yQ,3,12,"span",4),W(5,vQ,1,6,"button",5),W(6,bQ,1,6,"button",5),N()),2&e&&(Zn(o.styleClass),L("ngClass",Va(28,xQ,o.showButtons&&"stacked"===o.buttonLayout,o.showButtons&&"horizontal"===o.buttonLayout,o.showButtons&&"vertical"===o.buttonLayout))("ngStyle",o.style),F(1),Zn(o.inputStyleClass),L("ngClass","p-inputnumber-input")("ngStyle",o.inputStyle)("value",o.formattedValue())("disabled",o.disabled)("readonly",o.readonly),at("placeholder",o.placeholder)("title",o.title)("id",o.inputId)("size",o.size)("name",o.name)("autocomplete",o.autocomplete)("maxlength",o.maxlength)("tabindex",o.tabindex)("aria-label",o.ariaLabel)("aria-required",o.ariaRequired)("required",o.required)("min",o.min)("max",o.max),F(2),L("ngIf","vertical"!=o.buttonLayout&&o.showClear&&o.value),F(1),L("ngIf",o.showButtons&&"stacked"===o.buttonLayout),F(1),L("ngIf",o.showButtons&&"stacked"!==o.buttonLayout),F(1),L("ngIf",o.showButtons&&"stacked"!==o.buttonLayout))},dependencies:[ao,Xn,ho,_l,Dr],styles:["p-inputnumber,.p-inputnumber{display:inline-flex}.p-inputnumber-button{display:flex;align-items:center;justify-content:center;flex:0 0 auto}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label{display:none}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up{border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-input{border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down{border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-button-group{display:flex;flex-direction:column}.p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button{flex:1 1 auto}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up{order:3;border-top-left-radius:0;border-bottom-left-radius:0}.p-inputnumber-buttons-horizontal .p-inputnumber-input{order:2;border-radius:0}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down{order:1;border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-vertical{flex-direction:column}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up{order:1;border-bottom-left-radius:0;border-bottom-right-radius:0;width:100%}.p-inputnumber-buttons-vertical .p-inputnumber-input{order:2;border-radius:0;text-align:center}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down{order:3;border-top-left-radius:0;border-top-right-radius:0;width:100%}.p-inputnumber-input{flex:1 1 auto}.p-fluid p-inputnumber,.p-fluid .p-inputnumber{width:100%}.p-fluid .p-inputnumber .p-inputnumber-input{width:1%}.p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input{width:100%}.p-inputnumber-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-inputnumber-clearable{position:relative}\n"],encapsulation:2,changeDetection:0}),t})(),_D=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Nf,gl]}),t})();function CQ(t,n){1&t&&$t(0)}const yD=function(t){return{$implicit:t}};function TQ(t,n){if(1&t&&(P(0,"div",15),W(1,CQ,1,0,"ng-container",16),N()),2&t){const e=U(2);F(1),L("ngTemplateOutlet",e.templateLeft)("ngTemplateOutletContext",Wt(2,yD,e.paginatorState))}}function SQ(t,n){if(1&t&&(P(0,"span",17),ie(1),N()),2&t){const e=U(2);F(1),Ut(e.currentPageReport)}}const OC=function(t){return{"p-disabled":t}};function EQ(t,n){if(1&t){const e=Ye();P(0,"button",18),Te("click",function(r){return be(e),ve(U(2).changePageToFirst(r))}),Ae(1,"span",19),N()}if(2&t){const e=U(2);L("disabled",e.isFirstPage()||e.empty())("ngClass",Wt(2,OC,e.isFirstPage()||e.empty()))}}const IQ=function(t){return{"p-highlight":t}};function DQ(t,n){if(1&t){const e=Ye();P(0,"button",22),Te("click",function(r){const l=be(e).$implicit;return ve(U(3).onPageLinkClick(r,l-1))}),ie(1),N()}if(2&t){const e=n.$implicit,o=U(3);L("ngClass",Wt(2,IQ,e-1==o.getPage())),F(1),jn(" ",e," ")}}function MQ(t,n){if(1&t&&(P(0,"span",20),W(1,DQ,2,4,"button",21),N()),2&t){const e=U(2);F(1),L("ngForOf",e.pageLinks)}}function kQ(t,n){1&t&&ie(0),2&t&&Ut(U(3).currentPageReport)}function AQ(t,n){if(1&t){const e=Ye();P(0,"p-dropdown",23),Te("onChange",function(r){return be(e),ve(U(2).onPageDropdownChange(r))}),W(1,kQ,1,1,"ng-template",24),N()}if(2&t){const e=U(2);L("options",e.pageItems)("ngModel",e.getPage())("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight)}}function PQ(t,n){if(1&t){const e=Ye();P(0,"button",25),Te("click",function(r){return be(e),ve(U(2).changePageToLast(r))}),Ae(1,"span",26),N()}if(2&t){const e=U(2);L("disabled",e.isLastPage()||e.empty())("ngClass",Wt(2,OC,e.isLastPage()||e.empty()))}}function OQ(t,n){if(1&t){const e=Ye();P(0,"p-inputNumber",27),Te("ngModelChange",function(r){return be(e),ve(U(2).changePage(r-1))}),N()}if(2&t){const e=U(2);L("ngModel",e.currentPage())("disabled",e.empty())}}function LQ(t,n){1&t&&$t(0)}function RQ(t,n){if(1&t&&W(0,LQ,1,0,"ng-container",16),2&t){const e=n.$implicit;L("ngTemplateOutlet",U(4).dropdownItemTemplate)("ngTemplateOutletContext",Wt(2,yD,e))}}function FQ(t,n){1&t&&(wn(0),W(1,RQ,1,4,"ng-template",30),Pn())}function NQ(t,n){if(1&t){const e=Ye();P(0,"p-dropdown",28),Te("ngModelChange",function(r){return be(e),ve(U(2).rows=r)})("onChange",function(r){return be(e),ve(U(2).onRppChange(r))}),W(1,FQ,2,0,"ng-container",29),N()}if(2&t){const e=U(2);L("options",e.rowsPerPageItems)("ngModel",e.rows)("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight),F(1),L("ngIf",e.dropdownItemTemplate)}}function zQ(t,n){1&t&&$t(0)}function BQ(t,n){if(1&t&&(P(0,"div",31),W(1,zQ,1,0,"ng-container",16),N()),2&t){const e=U(2);F(1),L("ngTemplateOutlet",e.templateRight)("ngTemplateOutletContext",Wt(2,yD,e.paginatorState))}}function VQ(t,n){if(1&t){const e=Ye();P(0,"div",1),W(1,TQ,2,4,"div",2),W(2,SQ,2,1,"span",3),W(3,EQ,2,4,"button",4),P(4,"button",5),Te("click",function(r){return be(e),ve(U().changePageToPrev(r))}),Ae(5,"span",6),N(),W(6,MQ,2,1,"span",7),W(7,AQ,2,5,"p-dropdown",8),P(8,"button",9),Te("click",function(r){return be(e),ve(U().changePageToNext(r))}),Ae(9,"span",10),N(),W(10,PQ,2,4,"button",11),W(11,OQ,1,2,"p-inputNumber",12),W(12,NQ,2,6,"p-dropdown",13),W(13,BQ,2,4,"div",14),N()}if(2&t){const e=U();Zn(e.styleClass),L("ngStyle",e.style)("ngClass","p-paginator p-component"),F(1),L("ngIf",e.templateLeft),F(1),L("ngIf",e.showCurrentPageReport),F(1),L("ngIf",e.showFirstLastIcon),F(1),L("disabled",e.isFirstPage()||e.empty())("ngClass",Wt(17,OC,e.isFirstPage()||e.empty())),F(2),L("ngIf",e.showPageLinks),F(1),L("ngIf",e.showJumpToPageDropdown),F(1),L("disabled",e.isLastPage()||e.empty())("ngClass",Wt(19,OC,e.isLastPage()||e.empty())),F(2),L("ngIf",e.showFirstLastIcon),F(1),L("ngIf",e.showJumpToPageInput),F(1),L("ngIf",e.rowsPerPageOptions),F(1),L("ngIf",e.templateRight)}}let eN=(()=>{class t{constructor(e){this.cd=e,this.pageLinkSize=5,this.onPageChange=new ht,this.alwaysShow=!0,this.dropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.totalRecords=0,this.rows=0,this.showPageLinks=!0,this._first=0,this._page=0}ngOnInit(){this.updatePaginatorState()}ngOnChanges(e){e.totalRecords&&(this.updatePageLinks(),this.updatePaginatorState(),this.updateFirst(),this.updateRowsPerPageOptions()),e.first&&(this._first=e.first.currentValue,this.updatePageLinks(),this.updatePaginatorState()),e.rows&&(this.updatePageLinks(),this.updatePaginatorState()),e.rowsPerPageOptions&&this.updateRowsPerPageOptions()}get first(){return this._first}set first(e){this._first=e}updateRowsPerPageOptions(){if(this.rowsPerPageOptions){this.rowsPerPageItems=[];for(let e of this.rowsPerPageOptions)"object"==typeof e&&e.showAll?this.rowsPerPageItems.unshift({label:e.showAll,value:this.totalRecords}):this.rowsPerPageItems.push({label:String(e),value:e})}}isFirstPage(){return 0===this.getPage()}isLastPage(){return this.getPage()===this.getPageCount()-1}getPageCount(){return Math.ceil(this.totalRecords/this.rows)}calculatePageLinkBoundaries(){let e=this.getPageCount(),o=Math.min(this.pageLinkSize,e),r=Math.max(0,Math.ceil(this.getPage()-o/2)),s=Math.min(e-1,r+o-1);return r=Math.max(0,r-(this.pageLinkSize-(s-r+1))),[r,s]}updatePageLinks(){this.pageLinks=[];let e=this.calculatePageLinkBoundaries(),r=e[1];for(let s=e[0];s<=r;s++)this.pageLinks.push(s+1);if(this.showJumpToPageDropdown){this.pageItems=[];for(let s=0;s<this.getPageCount();s++)this.pageItems.push({label:String(s+1),value:s})}}changePage(e){var o=this.getPageCount();if(e>=0&&e<o){this._first=this.rows*e;var r={page:e,first:this.first,rows:this.rows,pageCount:o};this.updatePageLinks(),this.onPageChange.emit(r),this.updatePaginatorState()}}updateFirst(){const e=this.getPage();e>0&&this.totalRecords&&this.first>=this.totalRecords&&Promise.resolve(null).then(()=>this.changePage(e-1))}getPage(){return Math.floor(this.first/this.rows)}changePageToFirst(e){this.isFirstPage()||this.changePage(0),e.preventDefault()}changePageToPrev(e){this.changePage(this.getPage()-1),e.preventDefault()}changePageToNext(e){this.changePage(this.getPage()+1),e.preventDefault()}changePageToLast(e){this.isLastPage()||this.changePage(this.getPageCount()-1),e.preventDefault()}onPageLinkClick(e,o){this.changePage(o),e.preventDefault()}onRppChange(e){this.changePage(this.getPage())}onPageDropdownChange(e){this.changePage(e.value)}updatePaginatorState(){this.paginatorState={page:this.getPage(),pageCount:this.getPageCount(),rows:this.rows,first:this.first,totalRecords:this.totalRecords}}empty(){return 0===this.getPageCount()}currentPage(){return this.getPageCount()>0?this.getPage()+1:0}get currentPageReport(){return this.currentPageReportTemplate.replace("{currentPage}",String(this.currentPage())).replace("{totalPages}",String(this.getPageCount())).replace("{first}",String(this.totalRecords>0?this._first+1:0)).replace("{last}",String(Math.min(this._first+this.rows,this.totalRecords))).replace("{rows}",String(this.rows)).replace("{totalRecords}",String(this.totalRecords))}}return t.\u0275fac=function(e){return new(e||t)(ce(Fo))},t.\u0275cmp=Qt({type:t,selectors:[["p-paginator"]],hostAttrs:[1,"p-element"],inputs:{pageLinkSize:"pageLinkSize",style:"style",styleClass:"styleClass",alwaysShow:"alwaysShow",templateLeft:"templateLeft",templateRight:"templateRight",dropdownAppendTo:"dropdownAppendTo",dropdownScrollHeight:"dropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showFirstLastIcon:"showFirstLastIcon",totalRecords:"totalRecords",rows:"rows",rowsPerPageOptions:"rowsPerPageOptions",showJumpToPageDropdown:"showJumpToPageDropdown",showJumpToPageInput:"showJumpToPageInput",showPageLinks:"showPageLinks",dropdownItemTemplate:"dropdownItemTemplate",first:"first"},outputs:{onPageChange:"onPageChange"},features:[_r],decls:1,vars:1,consts:[[3,"class","ngStyle","ngClass",4,"ngIf"],[3,"ngStyle","ngClass"],["class","p-paginator-left-content",4,"ngIf"],["class","p-paginator-current",4,"ngIf"],["type","button","pRipple","","class","p-paginator-first p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-prev","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-left"],["class","p-paginator-pages",4,"ngIf"],["styleClass","p-paginator-page-options",3,"options","ngModel","disabled","appendTo","scrollHeight","onChange",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-next","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-right"],["type","button","pRipple","","class","p-paginator-last p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["class","p-paginator-page-input",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["styleClass","p-paginator-rpp-options",3,"options","ngModel","disabled","appendTo","scrollHeight","ngModelChange","onChange",4,"ngIf"],["class","p-paginator-right-content",4,"ngIf"],[1,"p-paginator-left-content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-paginator-current"],["type","button","pRipple","",1,"p-paginator-first","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-double-left"],[1,"p-paginator-pages"],["type","button","class","p-paginator-page p-paginator-element p-link","pRipple","",3,"ngClass","click",4,"ngFor","ngForOf"],["type","button","pRipple","",1,"p-paginator-page","p-paginator-element","p-link",3,"ngClass","click"],["styleClass","p-paginator-page-options",3,"options","ngModel","disabled","appendTo","scrollHeight","onChange"],["pTemplate","selectedItem"],["type","button","pRipple","",1,"p-paginator-last","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-double-right"],[1,"p-paginator-page-input",3,"ngModel","disabled","ngModelChange"],["styleClass","p-paginator-rpp-options",3,"options","ngModel","disabled","appendTo","scrollHeight","ngModelChange","onChange"],[4,"ngIf"],["pTemplate","item"],[1,"p-paginator-right-content"]],template:function(e,o){1&e&&W(0,VQ,14,21,"div",0),2&e&&L("ngIf",!!o.alwaysShow||o.pageLinks&&o.pageLinks.length>1)},dependencies:[ao,Ns,Xn,Cs,ho,gD,fo,J3,$a,Id,Iu],styles:[".p-paginator{display:flex;align-items:center;justify-content:center;flex-wrap:wrap}.p-paginator-left-content{margin-right:auto}.p-paginator-right-content{margin-left:auto}.p-paginator-page,.p-paginator-next,.p-paginator-last,.p-paginator-first,.p-paginator-prev,.p-paginator-current{cursor:pointer;display:inline-flex;align-items:center;justify-content:center;line-height:1;-webkit-user-select:none;user-select:none;overflow:hidden;position:relative}.p-paginator-element:focus{z-index:1;position:relative}\n"],encapsulation:2,changeDetection:0}),t})(),tN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,zf,_D,Gh,hs,ml,zf,_D,Gh,hs]}),t})();function UQ(t,n){1&t&&Ae(0,"span",8),2&t&&(Zn(U(2).$implicit.icon),L("ngClass","p-button-icon p-button-icon-left"))}function jQ(t,n){if(1&t&&(wn(0),W(1,UQ,1,3,"span",6),P(2,"span",7),ie(3),N(),Pn()),2&t){const e=U().$implicit,o=U();F(1),L("ngIf",e.icon),F(2),Ut(o.getOptionLabel(e))}}function HQ(t,n){1&t&&$t(0)}const $Q=function(t,n){return{$implicit:t,index:n}};function GQ(t,n){if(1&t&&W(0,HQ,1,0,"ng-container",9),2&t){const e=U(),o=e.$implicit,r=e.index;L("ngTemplateOutlet",U().itemTemplate)("ngTemplateOutletContext",Ji(2,$Q,o,r))}}const WQ=function(t,n,e){return{"p-highlight":t,"p-disabled":n,"p-button-icon-only":e}};function qQ(t,n){if(1&t){const e=Ye();P(0,"div",2,3),Te("click",function(r){const s=be(e),l=s.$implicit,h=s.index;return ve(U().onItemClick(r,l,h))})("keydown.enter",function(r){const s=be(e),l=s.$implicit,h=s.index;return ve(U().onItemClick(r,l,h))})("blur",function(){return be(e),ve(U().onBlur())}),W(2,jQ,4,2,"ng-container",4),W(3,GQ,1,5,"ng-template",null,5,Ua),N()}if(2&t){const e=n.$implicit,o=Un(4),r=U();Zn(e.styleClass),L("ngClass",Va(10,WQ,r.isSelected(e),r.disabled||r.isOptionDisabled(e),e.icon&&!r.getOptionLabel(e))),at("aria-pressed",r.isSelected(e))("title",e.title)("aria-label",e.label)("tabindex",r.disabled?null:r.tabindex)("aria-labelledby",r.getOptionLabel(e)),F(2),L("ngIf",!r.itemTemplate)("ngIfElse",o)}}const ZQ={provide:zs,useExisting:Ei(()=>nN),multi:!0};let nN=(()=>{class t{constructor(e){this.cd=e,this.tabindex=0,this.onOptionClick=new ht,this.onChange=new ht,this.onModelChange=()=>{},this.onModelTouched=()=>{}}getOptionLabel(e){return this.optionLabel?xn.resolveFieldData(e,this.optionLabel):null!=e.label?e.label:e}getOptionValue(e){return this.optionValue?xn.resolveFieldData(e,this.optionValue):this.optionLabel||void 0===e.value?e:e.value}isOptionDisabled(e){return this.optionDisabled?xn.resolveFieldData(e,this.optionDisabled):void 0!==e.disabled&&e.disabled}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onItemClick(e,o,r){if(!this.disabled&&!this.isOptionDisabled(o)){if(this.multiple)this.isSelected(o)?this.removeOption(o):this.value=[...this.value||[],this.getOptionValue(o)],this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value});else{let s=this.getOptionValue(o);this.value!==s&&(this.value=this.getOptionValue(o),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}))}this.onOptionClick.emit({originalEvent:e,option:o,index:r})}}onBlur(){this.onModelTouched()}removeOption(e){this.value=this.value.filter(o=>!xn.equals(o,this.getOptionValue(e),this.dataKey))}isSelected(e){let o=!1,r=this.getOptionValue(e);if(this.multiple){if(this.value&&Array.isArray(this.value))for(let s of this.value)if(xn.equals(s,r,this.dataKey)){o=!0;break}}else o=xn.equals(this.getOptionValue(e),this.value,this.dataKey);return o}}return t.\u0275fac=function(e){return new(e||t)(ce(Fo))},t.\u0275cmp=Qt({type:t,selectors:[["p-selectButton"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,bu,5),2&e){let s;gn(s=_n())&&(o.itemTemplate=s.first)}},hostAttrs:[1,"p-element"],inputs:{options:"options",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",tabindex:"tabindex",multiple:"multiple",style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy",disabled:"disabled",dataKey:"dataKey"},outputs:{onOptionClick:"onOptionClick",onChange:"onChange"},features:[zi([ZQ])],decls:2,vars:5,consts:[["role","group",3,"ngClass","ngStyle"],["class","p-button p-component","role","button","pRipple","",3,"class","ngClass","click","keydown.enter","blur",4,"ngFor","ngForOf"],["role","button","pRipple","",1,"p-button","p-component",3,"ngClass","click","keydown.enter","blur"],["btn",""],[4,"ngIf","ngIfElse"],["customcontent",""],[3,"ngClass","class",4,"ngIf"],[1,"p-button-label"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){1&e&&(P(0,"div",0),W(1,qQ,5,14,"div",1),N()),2&e&&(Zn(o.styleClass),L("ngClass","p-selectbutton p-buttonset p-component")("ngStyle",o.style),F(1),L("ngForOf",o.options))},dependencies:[ao,Ns,Xn,Cs,ho,Iu],styles:['.p-button{margin:0;display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;align-items:center;vertical-align:bottom;text-align:center;overflow:hidden;position:relative}.p-button-label{flex:1 1 auto}.p-button-icon-right{order:1}.p-button:disabled{cursor:default}.p-button-icon-only{justify-content:center}.p-button-icon-only:after{content:"p";visibility:hidden;clip:rect(0 0 0 0);width:0}.p-button-vertical{flex-direction:column}.p-button-icon-bottom{order:2}.p-buttonset .p-button{margin:0}.p-buttonset .p-button:not(:last-child){border-right:0 none}.p-buttonset .p-button:not(:first-of-type):not(:last-of-type){border-radius:0}.p-buttonset .p-button:first-of-type{border-top-right-radius:0;border-bottom-right-radius:0}.p-buttonset .p-button:last-of-type{border-top-left-radius:0;border-bottom-left-radius:0}.p-buttonset .p-button:focus{position:relative;z-index:1}\n'],encapsulation:2,changeDetection:0}),t})(),T0=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,ml]}),t})();const KQ=function(t,n,e){return{"p-checkbox-label-active":t,"p-disabled":n,"p-checkbox-label-focus":e}};function XQ(t,n){if(1&t){const e=Ye();P(0,"label",7),Te("click",function(r){be(e);const s=U(),l=Un(3);return ve(s.onClick(r,l))}),ie(1),N()}if(2&t){const e=U();L("ngClass",Va(3,KQ,null!=e.value,e.disabled,e.focused)),at("for",e.inputId),F(1),Ut(e.label)}}const YQ=function(t,n){return{"p-checkbox p-component":!0,"p-checkbox-disabled":t,"p-checkbox-focused":n}},QQ=function(t,n,e){return{"p-highlight":t,"p-disabled":n,"p-focus":e}},JQ={provide:zs,useExisting:Ei(()=>eJ),multi:!0};let eJ=(()=>{class t{constructor(e){this.cd=e,this.checkboxTrueIcon="pi pi-check",this.checkboxFalseIcon="pi pi-times",this.onChange=new ht,this.onModelChange=()=>{},this.onModelTouched=()=>{}}onClick(e,o){!this.disabled&&!this.readonly&&(this.toggle(e),this.focused=!0,o.focus())}onKeydown(e){32==e.keyCode&&e.preventDefault()}onKeyup(e){32==e.keyCode&&!this.readonly&&(this.toggle(e),e.preventDefault())}toggle(e){null==this.value||null==this.value?this.value=!0:1==this.value?this.value=!1:0==this.value&&(this.value=null),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value})}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}writeValue(e){this.value=e,this.cd.markForCheck()}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(ce(Fo))},t.\u0275cmp=Qt({type:t,selectors:[["p-triStateCheckbox"]],hostAttrs:[1,"p-element"],inputs:{disabled:"disabled",name:"name",ariaLabelledBy:"ariaLabelledBy",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",label:"label",readonly:"readonly",checkboxTrueIcon:"checkboxTrueIcon",checkboxFalseIcon:"checkboxFalseIcon"},outputs:{onChange:"onChange"},features:[zi([JQ])],decls:7,vars:21,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","text","inputmode","none",3,"name","readonly","disabled","keyup","keydown","focus","blur"],["input",""],["role","checkbox",1,"p-checkbox-box",3,"ngClass","click"],[1,"p-checkbox-icon",3,"ngClass"],["class","p-checkbox-label",3,"ngClass","click",4,"ngIf"],[1,"p-checkbox-label",3,"ngClass","click"]],template:function(e,o){if(1&e){const r=Ye();P(0,"div",0)(1,"div",1)(2,"input",2,3),Te("keyup",function(l){return o.onKeyup(l)})("keydown",function(l){return o.onKeydown(l)})("focus",function(){return o.onFocus()})("blur",function(){return o.onBlur()}),N()(),P(4,"div",4),Te("click",function(l){be(r);const h=Un(3);return ve(o.onClick(l,h))}),Ae(5,"span",5),N()(),W(6,XQ,2,7,"label",6)}2&e&&(Zn(o.styleClass),L("ngStyle",o.style)("ngClass",Ji(14,YQ,o.disabled,o.focused)),F(2),L("name",o.name)("readonly",o.readonly)("disabled",o.disabled),at("id",o.inputId)("tabindex",o.tabindex)("aria-labelledby",o.ariaLabelledBy),F(2),L("ngClass",Va(17,QQ,null!=o.value,o.disabled,o.focused)),at("aria-checked",!0===o.value),F(1),L("ngClass",!0===o.value?o.checkboxTrueIcon:!1===o.value?o.checkboxFalseIcon:""),F(1),L("ngIf",o.label))},dependencies:[ao,Xn,ho],encapsulation:2,changeDetection:0}),t})(),tJ=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();const nJ=["container"],iJ=["resizeHelper"],oJ=["reorderIndicatorUp"],rJ=["reorderIndicatorDown"],sJ=["wrapper"],aJ=["table"],lJ=["thead"],cJ=["tfoot"],uJ=["scroller"];function dJ(t,n){if(1&t&&(P(0,"div",15),Ae(1,"i"),N()),2&t){const e=U();F(1),Zn("p-datatable-loading-icon pi-spin "+e.loadingIcon)}}function hJ(t,n){1&t&&$t(0)}function pJ(t,n){if(1&t&&(P(0,"div",16),W(1,hJ,1,0,"ng-container",17),N()),2&t){const e=U();F(1),L("ngTemplateOutlet",e.captionTemplate)}}function fJ(t,n){if(1&t){const e=Ye();P(0,"p-paginator",18),Te("onPageChange",function(r){return be(e),ve(U().onPageChange(r))}),N()}if(2&t){const e=U();L("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)}}function mJ(t,n){1&t&&$t(0)}const iN=function(t,n){return{$implicit:t,options:n}};function gJ(t,n){if(1&t&&W(0,mJ,1,0,"ng-container",22),2&t){const e=n.$implicit,o=n.options;U(2),L("ngTemplateOutlet",Un(10))("ngTemplateOutletContext",Ji(2,iN,e,o))}}const _J=function(t){return{height:t}};function yJ(t,n){if(1&t){const e=Ye();P(0,"p-scroller",19,20),Te("onLazyLoad",function(r){return be(e),ve(U().onLazyItemLoad(r))}),W(2,gJ,1,5,"ng-template",21),N()}if(2&t){const e=U();Io(Wt(15,_J,"flex"!==e.scrollHeight?e.scrollHeight:void 0)),L("items",e.processedData)("columns",e.columns)("scrollHeight","flex"!==e.scrollHeight?void 0:"100%")("itemSize",e.virtualScrollItemSize||e._virtualRowHeight)("step",e.rows)("delay",e.lazy?e.virtualScrollDelay:0)("inline",!0)("lazy",e.lazy)("loaderDisabled",!0)("showSpacer",!1)("showLoader",e.loadingBodyTemplate)("options",e.virtualScrollOptions)("autoSize",!0)}}function vJ(t,n){1&t&&$t(0)}const bJ=function(t){return{columns:t}};function xJ(t,n){if(1&t&&(wn(0),W(1,vJ,1,0,"ng-container",22),Pn()),2&t){const e=U(),o=Un(10);F(1),L("ngTemplateOutlet",o)("ngTemplateOutletContext",Ji(4,iN,e.processedData,Wt(2,bJ,e.columns)))}}function wJ(t,n){1&t&&$t(0)}function CJ(t,n){1&t&&$t(0)}function TJ(t,n){if(1&t&&Ae(0,"tbody",31),2&t){const e=U().options,o=U();L("value",o.frozenValue)("frozenRows",!0)("pTableBody",e.columns)("pTableBodyTemplate",o.frozenBodyTemplate)("frozen",!0)}}function SJ(t,n){if(1&t&&Ae(0,"tbody",32),2&t){const e=U().options;Io("height: calc("+e.spacerStyle.height+" - "+e.rows.length*e.itemSize+"px);")}}function EJ(t,n){1&t&&$t(0)}const S0=function(t){return{$implicit:t}};function IJ(t,n){if(1&t&&(P(0,"tfoot",33,34),W(2,EJ,1,0,"ng-container",22),N()),2&t){const e=U().options,o=U();F(2),L("ngTemplateOutlet",o.footerGroupedTemplate||o.footerTemplate)("ngTemplateOutletContext",Wt(2,S0,e.columns))}}const DJ=function(t,n,e){return{"p-datatable-table":!0,"p-datatable-scrollable-table":t,"p-datatable-resizable-table":n,"p-datatable-resizable-table-fit":e}};function MJ(t,n){if(1&t&&(P(0,"table",23,24),W(2,wJ,1,0,"ng-container",22),P(3,"thead",25,26),W(5,CJ,1,0,"ng-container",22),N(),W(6,TJ,1,5,"tbody",27),Ae(7,"tbody",28),W(8,SJ,1,2,"tbody",29),W(9,IJ,3,4,"tfoot",30),N()),2&t){const e=n.options,o=U();Io(o.tableStyle),Zn(o.tableStyleClass),L("ngClass",Va(20,DJ,o.scrollable,o.resizableColumns,o.resizableColumns&&"fit"===o.columnResizeMode)),at("id",o.id+"-table"),F(2),L("ngTemplateOutlet",o.colGroupTemplate)("ngTemplateOutletContext",Wt(24,S0,e.columns)),F(3),L("ngTemplateOutlet",o.headerGroupedTemplate||o.headerTemplate)("ngTemplateOutletContext",Wt(26,S0,e.columns)),F(1),L("ngIf",o.frozenValue||o.frozenBodyTemplate),F(1),Io(e.contentStyle),L("ngClass",e.contentStyleClass)("value",o.dataToRender(e.rows))("pTableBody",e.columns)("pTableBodyTemplate",o.bodyTemplate)("scrollerOptions",e),F(1),L("ngIf",e.spacerStyle),F(1),L("ngIf",o.footerGroupedTemplate||o.footerTemplate)}}function kJ(t,n){if(1&t){const e=Ye();P(0,"p-paginator",35),Te("onPageChange",function(r){return be(e),ve(U().onPageChange(r))}),N()}if(2&t){const e=U();L("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)}}function AJ(t,n){1&t&&$t(0)}function PJ(t,n){if(1&t&&(P(0,"div",36),W(1,AJ,1,0,"ng-container",17),N()),2&t){const e=U();F(1),L("ngTemplateOutlet",e.summaryTemplate)}}function OJ(t,n){1&t&&Ae(0,"div",37,38)}function LJ(t,n){1&t&&Ae(0,"span",39,40)}function RJ(t,n){1&t&&Ae(0,"span",41,42)}const FJ=function(t,n,e){return{"p-datatable p-component":!0,"p-datatable-hoverable-rows":t,"p-datatable-scrollable":n,"p-datatable-flex-scrollable":e}},NJ=function(t){return{maxHeight:t}},zJ=["pTableBody",""];function BJ(t,n){1&t&&$t(0)}const vD=function(t,n,e,o,r){return{$implicit:t,rowIndex:n,columns:e,editing:o,frozen:r}};function VJ(t,n){if(1&t&&(wn(0,3),W(1,BJ,1,0,"ng-container",4),Pn()),2&t){const e=U(),o=e.$implicit,r=e.index,s=U(2);F(1),L("ngTemplateOutlet",s.dt.groupHeaderTemplate)("ngTemplateOutletContext",wb(2,vD,o,s.getRowIndex(r),s.columns,"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function UJ(t,n){1&t&&$t(0)}function jJ(t,n){if(1&t&&(wn(0),W(1,UJ,1,0,"ng-container",4),Pn()),2&t){const e=U(),o=e.$implicit,r=e.index,s=U(2);F(1),L("ngTemplateOutlet",o?s.template:s.dt.loadingBodyTemplate)("ngTemplateOutletContext",wb(2,vD,o,s.getRowIndex(r),s.columns,"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function HJ(t,n){1&t&&$t(0)}const $J=function(t,n,e,o,r,s,l){return{$implicit:t,rowIndex:n,columns:e,editing:o,frozen:r,rowgroup:s,rowspan:l}};function GJ(t,n){if(1&t&&(wn(0),W(1,HJ,1,0,"ng-container",4),Pn()),2&t){const e=U(),o=e.$implicit,r=e.index,s=U(2);F(1),L("ngTemplateOutlet",o?s.template:s.dt.loadingBodyTemplate)("ngTemplateOutletContext",function Gk(t,n,e,o,r,s,l,h,f,y){const C=Zr()+t,D=zt();let R=mt(D,C,e,o,r,s);return Qe(D,C+4,l,h,f)||R?Se(D,C+7,y?n.call(y,e,o,r,s,l,h,f):n(e,o,r,s,l,h,f)):Oe(D,C+7)}(2,$J,o,s.getRowIndex(r),s.columns,"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen,s.shouldRenderRowspan(s.value,o,r),s.calculateRowGroupSize(s.value,o,r)))}}function WJ(t,n){1&t&&$t(0)}function qJ(t,n){if(1&t&&(wn(0,3),W(1,WJ,1,0,"ng-container",4),Pn()),2&t){const e=U(),o=e.$implicit,r=e.index,s=U(2);F(1),L("ngTemplateOutlet",s.dt.groupFooterTemplate)("ngTemplateOutletContext",wb(2,vD,o,s.getRowIndex(r),s.columns,"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function ZJ(t,n){if(1&t&&(W(0,VJ,2,8,"ng-container",2),W(1,jJ,2,8,"ng-container",0),W(2,GJ,2,10,"ng-container",0),W(3,qJ,2,8,"ng-container",2)),2&t){const e=n.$implicit,o=n.index,r=U(2);L("ngIf",r.dt.groupHeaderTemplate&&!r.dt.virtualScroll&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupHeader(r.value,e,o)),F(1),L("ngIf","rowspan"!==r.dt.rowGroupMode),F(1),L("ngIf","rowspan"===r.dt.rowGroupMode),F(1),L("ngIf",r.dt.groupFooterTemplate&&!r.dt.virtualScroll&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupFooter(r.value,e,o))}}function KJ(t,n){if(1&t&&(wn(0),W(1,ZJ,4,4,"ng-template",1),Pn()),2&t){const e=U();F(1),L("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function XJ(t,n){1&t&&$t(0)}const LC=function(t,n,e,o,r,s){return{$implicit:t,rowIndex:n,columns:e,expanded:o,editing:r,frozen:s}};function YJ(t,n){if(1&t&&(wn(0),W(1,XJ,1,0,"ng-container",4),Pn()),2&t){const e=U(),o=e.$implicit,r=e.index,s=U(2);F(1),L("ngTemplateOutlet",s.template)("ngTemplateOutletContext",ry(2,LC,o,s.getRowIndex(r),s.columns,s.dt.isRowExpanded(o),"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function QJ(t,n){1&t&&$t(0)}function JJ(t,n){if(1&t&&(wn(0,3),W(1,QJ,1,0,"ng-container",4),Pn()),2&t){const e=U(),o=e.$implicit,r=e.index,s=U(2);F(1),L("ngTemplateOutlet",s.dt.groupHeaderTemplate)("ngTemplateOutletContext",ry(2,LC,o,s.getRowIndex(r),s.columns,s.dt.isRowExpanded(o),"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}function eee(t,n){1&t&&$t(0)}function tee(t,n){1&t&&$t(0)}function nee(t,n){if(1&t&&(wn(0,3),W(1,tee,1,0,"ng-container",4),Pn()),2&t){const e=U(2),o=e.$implicit,r=e.index,s=U(2);F(1),L("ngTemplateOutlet",s.dt.groupFooterTemplate)("ngTemplateOutletContext",ry(2,LC,o,s.getRowIndex(r),s.columns,s.dt.isRowExpanded(o),"row"===s.dt.editMode&&s.dt.isRowEditing(o),s.frozen))}}const oN=function(t,n,e,o){return{$implicit:t,rowIndex:n,columns:e,frozen:o}};function iee(t,n){if(1&t&&(wn(0),W(1,eee,1,0,"ng-container",4),W(2,nee,2,9,"ng-container",2),Pn()),2&t){const e=U(),o=e.$implicit,r=e.index,s=U(2);F(1),L("ngTemplateOutlet",s.dt.expandedRowTemplate)("ngTemplateOutletContext",vu(3,oN,o,s.getRowIndex(r),s.columns,s.frozen)),F(1),L("ngIf",s.dt.groupFooterTemplate&&"subheader"===s.dt.rowGroupMode&&s.shouldRenderRowGroupFooter(s.value,o,s.getRowIndex(r)))}}function oee(t,n){if(1&t&&(W(0,YJ,2,9,"ng-container",0),W(1,JJ,2,9,"ng-container",2),W(2,iee,3,8,"ng-container",0)),2&t){const e=n.$implicit,o=n.index,r=U(2);L("ngIf",!r.dt.groupHeaderTemplate),F(1),L("ngIf",r.dt.groupHeaderTemplate&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupHeader(r.value,e,r.getRowIndex(o))),F(1),L("ngIf",r.dt.isRowExpanded(e))}}function ree(t,n){if(1&t&&(wn(0),W(1,oee,3,3,"ng-template",1),Pn()),2&t){const e=U();F(1),L("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function see(t,n){1&t&&$t(0)}function aee(t,n){1&t&&$t(0)}function lee(t,n){if(1&t&&(wn(0),W(1,aee,1,0,"ng-container",4),Pn()),2&t){const e=U(),o=e.$implicit,r=e.index,s=U(2);F(1),L("ngTemplateOutlet",s.dt.frozenExpandedRowTemplate)("ngTemplateOutletContext",vu(2,oN,o,s.getRowIndex(r),s.columns,s.frozen))}}function cee(t,n){if(1&t&&(W(0,see,1,0,"ng-container",4),W(1,lee,2,7,"ng-container",0)),2&t){const e=n.$implicit,o=n.index,r=U(2);L("ngTemplateOutlet",r.template)("ngTemplateOutletContext",ry(3,LC,e,r.getRowIndex(o),r.columns,r.dt.isRowExpanded(e),"row"===r.dt.editMode&&r.dt.isRowEditing(e),r.frozen)),F(1),L("ngIf",r.dt.isRowExpanded(e))}}function uee(t,n){if(1&t&&(wn(0),W(1,cee,2,10,"ng-template",1),Pn()),2&t){const e=U();F(1),L("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function dee(t,n){1&t&&$t(0)}const rN=function(t,n){return{$implicit:t,frozen:n}};function hee(t,n){if(1&t&&(wn(0),W(1,dee,1,0,"ng-container",4),Pn()),2&t){const e=U();F(1),L("ngTemplateOutlet",e.dt.loadingBodyTemplate)("ngTemplateOutletContext",Ji(2,rN,e.columns,e.frozen))}}function pee(t,n){1&t&&$t(0)}function fee(t,n){if(1&t&&(wn(0),W(1,pee,1,0,"ng-container",4),Pn()),2&t){const e=U();F(1),L("ngTemplateOutlet",e.dt.emptyMessageTemplate)("ngTemplateOutletContext",Ji(2,rN,e.columns,e.frozen))}}function mee(t,n){if(1&t&&(P(0,"span",2),ie(1),N()),2&t){const e=U();F(1),Ut(e.getBadgeValue())}}const gee=function(t,n,e){return{"pi-sort-amount-up-alt":t,"pi-sort-amount-down":n,"pi-sort-alt":e}};let RC=(()=>{class t{constructor(){this.sortSource=new si,this.selectionSource=new si,this.contextMenuSource=new si,this.valueSource=new si,this.totalRecordsSource=new si,this.columnsSource=new si,this.resetSource=new si,this.sortSource$=this.sortSource.asObservable(),this.selectionSource$=this.selectionSource.asObservable(),this.contextMenuSource$=this.contextMenuSource.asObservable(),this.valueSource$=this.valueSource.asObservable(),this.totalRecordsSource$=this.totalRecordsSource.asObservable(),this.columnsSource$=this.columnsSource.asObservable(),this.resetSource$=this.resetSource.asObservable()}onSort(e){this.sortSource.next(e)}onSelectionChange(){this.selectionSource.next(null)}onResetChange(){this.resetSource.next(null)}onContextMenu(e){this.contextMenuSource.next(e)}onValueChange(e){this.valueSource.next(e)}onTotalRecordsChange(e){this.totalRecordsSource.next(e)}onColumnsChange(e){this.columnsSource.next(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac}),t})(),Nd=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.zone=o,this.tableService=r,this.cd=s,this.filterService=l,this.overlayService=h,this.pageLinks=5,this.alwaysShowPaginator=!0,this.paginatorPosition="bottom",this.paginatorDropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.showPageLinks=!0,this.defaultSortOrder=1,this.sortMode="single",this.resetPageOnSort=!0,this.selectAllChange=new ht,this.selectionChange=new ht,this.contextMenuSelectionChange=new ht,this.contextMenuSelectionMode="separate",this.rowTrackBy=(f,y)=>y,this.lazy=!1,this.lazyLoadOnInit=!0,this.compareSelectionBy="deepEquals",this.csvSeparator=",",this.exportFilename="download",this.filters={},this.filterDelay=300,this.expandedRowKeys={},this.editingRowKeys={},this.rowExpandMode="multiple",this.scrollDirection="vertical",this.virtualScrollDelay=250,this.columnResizeMode="fit",this.loadingIcon="pi pi-spinner",this.showLoader=!0,this.showInitialSortBadge=!0,this.stateStorage="session",this.editMode="cell",this.groupRowsByOrder=1,this.responsiveLayout="scroll",this.breakpoint="960px",this.onRowSelect=new ht,this.onRowUnselect=new ht,this.onPage=new ht,this.onSort=new ht,this.onFilter=new ht,this.onLazyLoad=new ht,this.onRowExpand=new ht,this.onRowCollapse=new ht,this.onContextMenuSelect=new ht,this.onColResize=new ht,this.onColReorder=new ht,this.onRowReorder=new ht,this.onEditInit=new ht,this.onEditComplete=new ht,this.onEditCancel=new ht,this.onHeaderCheckboxToggle=new ht,this.sortFunction=new ht,this.firstChange=new ht,this.rowsChange=new ht,this.onStateSave=new ht,this.onStateRestore=new ht,this._virtualRowHeight=28,this._value=[],this._totalRecords=0,this._first=0,this.selectionKeys={},this._sortOrder=1,this._selectAll=null,this.columnResizing=!1,this.rowGroupHeaderStyleObject={},this.id=Ig()}get responsive(){return this._responsive}set responsive(e){this._responsive=e,console.warn("responsive propery is deprecated as table is always responsive with scrollable behavior.")}get virtualRowHeight(){return this._virtualRowHeight}set virtualRowHeight(e){this._virtualRowHeight=e,console.warn("The virtualRowHeight property is deprecated, use virtualScrollItemSize property instead.")}ngOnInit(){this.lazy&&this.lazyLoadOnInit&&(this.virtualScroll||this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.restoringFilter&&(this.restoringFilter=!1)),"stack"===this.responsiveLayout&&!this.scrollable&&this.createResponsiveStyle(),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"caption":this.captionTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"headergrouped":this.headerGroupedTemplate=e.template;break;case"body":this.bodyTemplate=e.template;break;case"loadingbody":this.loadingBodyTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"footergrouped":this.footerGroupedTemplate=e.template;break;case"summary":this.summaryTemplate=e.template;break;case"colgroup":this.colGroupTemplate=e.template;break;case"rowexpansion":this.expandedRowTemplate=e.template;break;case"groupheader":this.groupHeaderTemplate=e.template;break;case"rowspan":this.rowspanTemplate=e.template;break;case"groupfooter":this.groupFooterTemplate=e.template;break;case"frozenrows":this.frozenRowsTemplate=e.template;break;case"frozenheader":this.frozenHeaderTemplate=e.template;break;case"frozenbody":this.frozenBodyTemplate=e.template;break;case"frozenfooter":this.frozenFooterTemplate=e.template;break;case"frozencolgroup":this.frozenColGroupTemplate=e.template;break;case"frozenrowexpansion":this.frozenExpandedRowTemplate=e.template;break;case"emptymessage":this.emptyMessageTemplate=e.template;break;case"paginatorleft":this.paginatorLeftTemplate=e.template;break;case"paginatorright":this.paginatorRightTemplate=e.template;break;case"paginatordropdownitem":this.paginatorDropdownItemTemplate=e.template}})}ngAfterViewInit(){this.isStateful()&&this.resizableColumns&&this.restoreColumnWidths()}ngOnChanges(e){e.value&&(this.isStateful()&&!this.stateRestored&&this.restoreState(),this._value=e.value.currentValue,this.lazy||(this.totalRecords=this._value?this._value.length:0,"single"==this.sortMode&&(this.sortField||this.groupRowsBy)?this.sortSingle():"multiple"==this.sortMode&&(this.multiSortMeta||this.groupRowsBy)?this.sortMultiple():this.hasFilter()&&this._filter()),this.tableService.onValueChange(e.value.currentValue)),e.columns&&(this._columns=e.columns.currentValue,this.tableService.onColumnsChange(e.columns.currentValue),this._columns&&this.isStateful()&&this.reorderableColumns&&!this.columnOrderStateRestored&&this.restoreColumnOrder()),e.sortField&&(this._sortField=e.sortField.currentValue,(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle()),e.groupRowsBy&&(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle(),e.sortOrder&&(this._sortOrder=e.sortOrder.currentValue,(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle()),e.groupRowsByOrder&&(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle(),e.multiSortMeta&&(this._multiSortMeta=e.multiSortMeta.currentValue,"multiple"===this.sortMode&&(this.initialized||!this.lazy&&!this.virtualScroll)&&this.sortMultiple()),e.selection&&(this._selection=e.selection.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange()),this.preventSelectionSetterPropagation=!1),e.selectAll&&(this._selectAll=e.selectAll.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()),this.preventSelectionSetterPropagation=!1)}get value(){return this._value}set value(e){this._value=e}get columns(){return this._columns}set columns(e){this._columns=e}get first(){return this._first}set first(e){this._first=e}get rows(){return this._rows}set rows(e){this._rows=e}get totalRecords(){return this._totalRecords}set totalRecords(e){this._totalRecords=e,this.tableService.onTotalRecordsChange(this._totalRecords)}get sortField(){return this._sortField}set sortField(e){this._sortField=e}get sortOrder(){return this._sortOrder}set sortOrder(e){this._sortOrder=e}get multiSortMeta(){return this._multiSortMeta}set multiSortMeta(e){this._multiSortMeta=e}get selection(){return this._selection}set selection(e){this._selection=e}get selectAll(){return this._selection}set selectAll(e){this._selection=e}get processedData(){return this.filteredValue||this.value||[]}dataToRender(e){const o=e||this.processedData;if(o&&this.paginator){const r=this.lazy?0:this.first;return o.slice(r,r+this.rows)}return o}updateSelectionKeys(){if(this.dataKey&&this._selection)if(this.selectionKeys={},Array.isArray(this._selection))for(let e of this._selection)this.selectionKeys[String(xn.resolveFieldData(e,this.dataKey))]=1;else this.selectionKeys[String(xn.resolveFieldData(this._selection,this.dataKey))]=1}onPageChange(e){this.first=e.first,this.rows=e.rows,this.onPage.emit({first:this.first,rows:this.rows}),this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.firstChange.emit(this.first),this.rowsChange.emit(this.rows),this.tableService.onValueChange(this.value),this.isStateful()&&this.saveState(),this.anchorRowIndex=null,this.scrollable&&this.resetScrollTop()}sort(e){let o=e.originalEvent;if("single"===this.sortMode&&(this._sortOrder=this.sortField===e.field?-1*this.sortOrder:this.defaultSortOrder,this._sortField=e.field,this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop()),this.sortSingle()),"multiple"===this.sortMode){let r=o.metaKey||o.ctrlKey,s=this.getSortMeta(e.field);s?r?s.order=-1*s.order:(this._multiSortMeta=[{field:e.field,order:-1*s.order}],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop())):((!r||!this.multiSortMeta)&&(this._multiSortMeta=[],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first))),this._multiSortMeta.push({field:e.field,order:this.defaultSortOrder})),this.sortMultiple()}this.isStateful()&&this.saveState(),this.anchorRowIndex=null}sortSingle(){let e=this.sortField||this.groupRowsBy,o=this.sortField?this.sortOrder:this.groupRowsByOrder;if(this.groupRowsBy&&this.sortField&&this.groupRowsBy!==this.sortField)return this._multiSortMeta=[this.getGroupRowsMeta(),{field:this.sortField,order:this.sortOrder}],void this.sortMultiple();if(e&&o){this.restoringSort&&(this.restoringSort=!1),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,field:e,order:o}):(this.value.sort((s,l)=>{let h=xn.resolveFieldData(s,e),f=xn.resolveFieldData(l,e),y=null;return y=null==h&&null!=f?-1:null!=h&&null==f?1:null==h&&null==f?0:"string"==typeof h&&"string"==typeof f?h.localeCompare(f):h<f?-1:h>f?1:0,o*y}),this._value=[...this.value]),this.hasFilter()&&this._filter());let r={field:e,order:o};this.onSort.emit(r),this.tableService.onSort(r)}}sortMultiple(){this.groupRowsBy&&(this._multiSortMeta?this.multiSortMeta[0].field!==this.groupRowsBy&&(this._multiSortMeta=[this.getGroupRowsMeta(),...this._multiSortMeta]):this._multiSortMeta=[this.getGroupRowsMeta()]),this.multiSortMeta&&(this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,multiSortMeta:this.multiSortMeta}):(this.value.sort((e,o)=>this.multisortField(e,o,this.multiSortMeta,0)),this._value=[...this.value]),this.hasFilter()&&this._filter()),this.onSort.emit({multisortmeta:this.multiSortMeta}),this.tableService.onSort(this.multiSortMeta))}multisortField(e,o,r,s){const l=xn.resolveFieldData(e,r[s].field),h=xn.resolveFieldData(o,r[s].field);return 0===xn.compare(l,h,this.filterLocale)?r.length-1>s?this.multisortField(e,o,r,s+1):0:this.compareValuesOnSort(l,h,r[s].order)}compareValuesOnSort(e,o,r){return xn.sort(e,o,r,this.filterLocale,this.sortOrder)}getSortMeta(e){if(this.multiSortMeta&&this.multiSortMeta.length)for(let o=0;o<this.multiSortMeta.length;o++)if(this.multiSortMeta[o].field===e)return this.multiSortMeta[o];return null}isSorted(e){if("single"===this.sortMode)return this.sortField&&this.sortField===e;if("multiple"===this.sortMode){let o=!1;if(this.multiSortMeta)for(let r=0;r<this.multiSortMeta.length;r++)if(this.multiSortMeta[r].field==e){o=!0;break}return o}}handleRowClick(e){let o=e.originalEvent.target,r=o.nodeName,s=o.parentElement&&o.parentElement.nodeName;if("INPUT"!=r&&"BUTTON"!=r&&"A"!=r&&"INPUT"!=s&&"BUTTON"!=s&&"A"!=s&&!Ne.hasClass(e.originalEvent.target,"p-clickable")){if(this.selectionMode){let l=e.rowData,h=e.rowIndex;if(this.preventSelectionSetterPropagation=!0,this.isMultipleSelectionMode()&&e.originalEvent.shiftKey&&null!=this.anchorRowIndex)Ne.clearSelection(),null!=this.rangeRowIndex&&this.clearSelectionRange(e.originalEvent),this.rangeRowIndex=h,this.selectRange(e.originalEvent,h);else{let f=this.isSelected(l);if(!f&&!this.isRowSelectable(l,h))return;let y=!this.rowTouched&&this.metaKeySelection,C=this.dataKey?String(xn.resolveFieldData(l,this.dataKey)):null;if(this.anchorRowIndex=h,this.rangeRowIndex=h,y){let D=e.originalEvent.metaKey||e.originalEvent.ctrlKey;if(f&&D){if(this.isSingleSelectionMode())this._selection=null,this.selectionKeys={},this.selectionChange.emit(null);else{let R=this.findIndexInSelection(l);this._selection=this.selection.filter((V,$)=>$!=R),this.selectionChange.emit(this.selection),C&&delete this.selectionKeys[C]}this.onRowUnselect.emit({originalEvent:e.originalEvent,data:l,type:"row"})}else this.isSingleSelectionMode()?(this._selection=l,this.selectionChange.emit(l),C&&(this.selectionKeys={},this.selectionKeys[C]=1)):this.isMultipleSelectionMode()&&(D?this._selection=this.selection||[]:(this._selection=[],this.selectionKeys={}),this._selection=[...this.selection,l],this.selectionChange.emit(this.selection),C&&(this.selectionKeys[C]=1)),this.onRowSelect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h})}else if("single"===this.selectionMode)f?(this._selection=null,this.selectionKeys={},this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h})):(this._selection=l,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h}),C&&(this.selectionKeys={},this.selectionKeys[C]=1));else if("multiple"===this.selectionMode)if(f){let D=this.findIndexInSelection(l);this._selection=this.selection.filter((R,V)=>V!=D),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h}),C&&delete this.selectionKeys[C]}else this._selection=this.selection?[...this.selection,l]:[l],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:l,type:"row",index:h}),C&&(this.selectionKeys[C]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}this.rowTouched=!1}}handleRowTouchEnd(e){this.rowTouched=!0}handleRowRightClick(e){if(this.contextMenu){const o=e.rowData,r=e.rowIndex;if("separate"===this.contextMenuSelectionMode)this.contextMenuSelection=o,this.contextMenuSelectionChange.emit(o),this.onContextMenuSelect.emit({originalEvent:e.originalEvent,data:o,index:e.rowIndex}),this.contextMenu.show(e.originalEvent),this.tableService.onContextMenu(o);else if("joint"===this.contextMenuSelectionMode){this.preventSelectionSetterPropagation=!0;let s=this.isSelected(o),l=this.dataKey?String(xn.resolveFieldData(o,this.dataKey)):null;if(!s){if(!this.isRowSelectable(o,r))return;this.isSingleSelectionMode()?(this.selection=o,this.selectionChange.emit(o),l&&(this.selectionKeys={},this.selectionKeys[l]=1)):this.isMultipleSelectionMode()&&(this._selection=this.selection?[...this.selection,o]:[o],this.selectionChange.emit(this.selection),l&&(this.selectionKeys[l]=1))}this.tableService.onSelectionChange(),this.contextMenu.show(e.originalEvent),this.onContextMenuSelect.emit({originalEvent:e,data:o,index:e.rowIndex})}}}selectRange(e,o){let r,s;this.anchorRowIndex>o?(r=o,s=this.anchorRowIndex):this.anchorRowIndex<o?(r=this.anchorRowIndex,s=o):(r=o,s=o),this.lazy&&this.paginator&&(r-=this.first,s-=this.first);let l=[];for(let h=r;h<=s;h++){let f=this.filteredValue?this.filteredValue[h]:this.value[h];if(!this.isSelected(f)){if(!this.isRowSelectable(f,o))continue;l.push(f),this._selection=[...this.selection,f];let y=this.dataKey?String(xn.resolveFieldData(f,this.dataKey)):null;y&&(this.selectionKeys[y]=1)}}this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e,data:l,type:"row"})}clearSelectionRange(e){let o,r;this.rangeRowIndex>this.anchorRowIndex?(o=this.anchorRowIndex,r=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(o=this.rangeRowIndex,r=this.anchorRowIndex):(o=this.rangeRowIndex,r=this.rangeRowIndex);for(let s=o;s<=r;s++){let l=this.value[s],h=this.findIndexInSelection(l);this._selection=this.selection.filter((y,C)=>C!=h);let f=this.dataKey?String(xn.resolveFieldData(l,this.dataKey)):null;f&&delete this.selectionKeys[f],this.onRowUnselect.emit({originalEvent:e,data:l,type:"row"})}}isSelected(e){return!(!e||!this.selection)&&(this.dataKey?void 0!==this.selectionKeys[xn.resolveFieldData(e,this.dataKey)]:Array.isArray(this.selection)?this.findIndexInSelection(e)>-1:this.equals(e,this.selection))}findIndexInSelection(e){let o=-1;if(this.selection&&this.selection.length)for(let r=0;r<this.selection.length;r++)if(this.equals(e,this.selection[r])){o=r;break}return o}isRowSelectable(e,o){return!(this.rowSelectable&&!this.rowSelectable({data:e,index:o}))}toggleRowWithRadio(e,o){if(this.preventSelectionSetterPropagation=!0,this.selection!=o){if(!this.isRowSelectable(o,e.rowIndex))return;this._selection=o,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:o,type:"radiobutton"}),this.dataKey&&(this.selectionKeys={},this.selectionKeys[String(xn.resolveFieldData(o,this.dataKey))]=1)}else this._selection=null,this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:o,type:"radiobutton"});this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowWithCheckbox(e,o){this.selection=this.selection||[];let r=this.isSelected(o),s=this.dataKey?String(xn.resolveFieldData(o,this.dataKey)):null;if(this.preventSelectionSetterPropagation=!0,r){let l=this.findIndexInSelection(o);this._selection=this.selection.filter((h,f)=>f!=l),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:o,type:"checkbox"}),s&&delete this.selectionKeys[s]}else{if(!this.isRowSelectable(o,e.rowIndex))return;this._selection=this.selection?[...this.selection,o]:[o],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:o,type:"checkbox"}),s&&(this.selectionKeys[s]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowsWithCheckbox(e,o){if(null!==this._selectAll)this.selectAllChange.emit({originalEvent:e,checked:o});else{const r=this.selectionPageOnly?this.dataToRender(this.processedData):this.processedData;let s=this.selectionPageOnly&&this._selection?this._selection.filter(l=>!r.some(h=>this.equals(l,h))):[];o&&(s=this.frozenValue?[...s,...this.frozenValue,...r]:[...s,...r],s=this.rowSelectable?s.filter((l,h)=>this.rowSelectable({data:l,index:h})):s),this._selection=s,this.preventSelectionSetterPropagation=!0,this.updateSelectionKeys(),this.selectionChange.emit(this._selection),this.tableService.onSelectionChange(),this.onHeaderCheckboxToggle.emit({originalEvent:e,checked:o}),this.isStateful()&&this.saveState()}}equals(e,o){return"equals"===this.compareSelectionBy?e===o:xn.equals(e,o,this.dataKey)}filter(e,o,r){this.filterTimeout&&clearTimeout(this.filterTimeout),this.isFilterBlank(e)?this.filters[o]&&delete this.filters[o]:this.filters[o]={value:e,matchMode:r},this.filterTimeout=setTimeout(()=>{this._filter(),this.filterTimeout=null},this.filterDelay),this.anchorRowIndex=null}filterGlobal(e,o){this.filter(e,"global",o)}isFilterBlank(e){return null==e||!!("string"==typeof e&&0==e.trim().length||Array.isArray(e)&&0==e.length)}_filter(){if(this.restoringFilter||(this.first=0,this.firstChange.emit(this.first)),this.lazy)this.onLazyLoad.emit(this.createLazyLoadMetadata());else{if(!this.value)return;if(this.hasFilter()){let e;if(this.filters.global){if(!this.columns&&!this.globalFilterFields)throw new Error("Global filtering requires dynamic columns or globalFilterFields to be defined.");e=this.globalFilterFields||this.columns}this.filteredValue=[];for(let o=0;o<this.value.length;o++){let h,r=!0,s=!1,l=!1;for(let f in this.filters)if(this.filters.hasOwnProperty(f)&&"global"!==f){l=!0;let y=f,C=this.filters[y];if(Array.isArray(C)){for(let D of C)if(r=this.executeLocalFilter(y,this.value[o],D),D.operator===o3.OR&&r||D.operator===o3.AND&&!r)break}else r=this.executeLocalFilter(y,this.value[o],C);if(!r)break}if(this.filters.global&&!s&&e)for(let f=0;f<e.length&&(s=this.filterService.filters[this.filters.global.matchMode](xn.resolveFieldData(this.value[o],e[f].field||e[f]),this.filters.global.value,this.filterLocale),!s);f++);h=this.filters.global?l?l&&r&&s:s:l&&r,h&&this.filteredValue.push(this.value[o])}this.filteredValue.length===this.value.length&&(this.filteredValue=null),this.paginator&&(this.totalRecords=this.filteredValue?this.filteredValue.length:this.value?this.value.length:0)}else this.filteredValue=null,this.paginator&&(this.totalRecords=this.value?this.value.length:0)}this.onFilter.emit({filters:this.filters,filteredValue:this.filteredValue||this.value}),this.tableService.onValueChange(this.value),this.isStateful()&&!this.restoringFilter&&this.saveState(),this.restoringFilter&&(this.restoringFilter=!1),this.cd.markForCheck(),this.scrollable&&this.resetScrollTop()}executeLocalFilter(e,o,r){let s=r.value,l=r.matchMode||ta.STARTS_WITH,h=xn.resolveFieldData(o,e);return(0,this.filterService.filters[l])(h,s,this.filterLocale)}hasFilter(){let e=!0;for(let o in this.filters)if(this.filters.hasOwnProperty(o)){e=!1;break}return!e}createLazyLoadMetadata(){return{first:this.first,rows:this.rows,sortField:this.sortField,sortOrder:this.sortOrder,filters:this.filters,globalFilter:this.filters&&this.filters.global?this.filters.global.value:null,multiSortMeta:this.multiSortMeta,forceUpdate:()=>this.cd.detectChanges()}}clear(){this._sortField=null,this._sortOrder=this.defaultSortOrder,this._multiSortMeta=null,this.tableService.onSort(null),this.filters.global&&(this.filters.global.value=null),this.filteredValue=null,this.tableService.onResetChange(),this.first=0,this.firstChange.emit(this.first),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.totalRecords=this._value?this._value.length:0}reset(){this.clear()}getExportHeader(e){return e[this.exportHeader]||e.header||e.field}exportCSV(e){let o,r="",s=this.columns;e&&e.selectionOnly?o=this.selection||[]:e&&e.allValues?o=this.value||[]:(o=this.filteredValue||this.value,this.frozenValue&&(o=o?[...this.frozenValue,...o]:this.frozenValue));for(let f=0;f<s.length;f++){let y=s[f];!1!==y.exportable&&y.field&&(r+='"'+this.getExportHeader(y)+'"',f<s.length-1&&(r+=this.csvSeparator))}o.forEach((f,y)=>{r+="\n";for(let C=0;C<s.length;C++){let D=s[C];if(!1!==D.exportable&&D.field){let R=xn.resolveFieldData(f,D.field);R=null!=R?this.exportFunction?this.exportFunction({data:R,field:D.field}):String(R).replace(/"/g,'""'):"",r+='"'+R+'"',C<s.length-1&&(r+=this.csvSeparator)}}});let l=new Blob([r],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a");h.style.display="none",document.body.appendChild(h),void 0!==h.download?(h.setAttribute("href",URL.createObjectURL(l)),h.setAttribute("download",this.exportFilename+".csv"),h.click()):(r="data:text/csv;charset=utf-8,"+r,window.open(encodeURI(r))),document.body.removeChild(h)}onLazyItemLoad(e){this.onLazyLoad.emit({...this.createLazyLoadMetadata(),...e,rows:e.last-e.first})}resetScrollTop(){this.virtualScroll?this.scrollToVirtualIndex(0):this.scrollTo({top:0})}scrollToVirtualIndex(e){this.virtualScroll&&this.scroller.scrollToIndex(e)}scrollTo(e){this.virtualScroll?this.scroller.scrollTo(e):this.wrapperViewChild&&this.wrapperViewChild.nativeElement&&(this.wrapperViewChild.nativeElement.scrollTo?this.wrapperViewChild.nativeElement.scrollTo(e):(this.wrapperViewChild.nativeElement.scrollLeft=e.left,this.wrapperViewChild.nativeElement.scrollTop=e.top))}updateEditingCell(e,o,r,s){this.editingCell=e,this.editingCellData=o,this.editingCellField=r,this.editingCellRowIndex=s,this.bindDocumentEditListener()}isEditingCellValid(){return this.editingCell&&0===Ne.find(this.editingCell,".ng-invalid.ng-dirty").length}bindDocumentEditListener(){this.documentEditListener||(this.documentEditListener=e=>{this.editingCell&&!this.selfClick&&this.isEditingCellValid()&&(Ne.removeClass(this.editingCell,"p-cell-editing"),this.editingCell=null,this.onEditComplete.emit({field:this.editingCellField,data:this.editingCellData,originalEvent:e,index:this.editingCellRowIndex}),this.editingCellField=null,this.editingCellData=null,this.editingCellRowIndex=null,this.unbindDocumentEditListener(),this.cd.markForCheck(),this.overlaySubscription&&this.overlaySubscription.unsubscribe()),this.selfClick=!1},document.addEventListener("click",this.documentEditListener))}unbindDocumentEditListener(){this.documentEditListener&&(document.removeEventListener("click",this.documentEditListener),this.documentEditListener=null)}initRowEdit(e){let o=String(xn.resolveFieldData(e,this.dataKey));this.editingRowKeys[o]=!0}saveRowEdit(e,o){if(0===Ne.find(o,".ng-invalid.ng-dirty").length){let r=String(xn.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[r]}}cancelRowEdit(e){let o=String(xn.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[o]}toggleRow(e,o){if(!this.dataKey)throw new Error("dataKey must be defined to use row expansion");let r=String(xn.resolveFieldData(e,this.dataKey));null!=this.expandedRowKeys[r]?(delete this.expandedRowKeys[r],this.onRowCollapse.emit({originalEvent:o,data:e})):("single"===this.rowExpandMode&&(this.expandedRowKeys={}),this.expandedRowKeys[r]=!0,this.onRowExpand.emit({originalEvent:o,data:e})),o&&o.preventDefault(),this.isStateful()&&this.saveState()}isRowExpanded(e){return!0===this.expandedRowKeys[String(xn.resolveFieldData(e,this.dataKey))]}isRowEditing(e){return!0===this.editingRowKeys[String(xn.resolveFieldData(e,this.dataKey))]}isSingleSelectionMode(){return"single"===this.selectionMode}isMultipleSelectionMode(){return"multiple"===this.selectionMode}onColumnResizeBegin(e){let o=Ne.getOffset(this.containerViewChild.nativeElement).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizerHelperX=e.pageX-o+this.containerViewChild.nativeElement.scrollLeft,this.onColumnResize(e),e.preventDefault()}onColumnResize(e){let o=Ne.getOffset(this.containerViewChild.nativeElement).left;Ne.addClass(this.containerViewChild.nativeElement,"p-unselectable-text"),this.resizeHelperViewChild.nativeElement.style.height=this.containerViewChild.nativeElement.offsetHeight+"px",this.resizeHelperViewChild.nativeElement.style.top="0px",this.resizeHelperViewChild.nativeElement.style.left=e.pageX-o+this.containerViewChild.nativeElement.scrollLeft+"px",this.resizeHelperViewChild.nativeElement.style.display="block"}onColumnResizeEnd(){let e=this.resizeHelperViewChild.nativeElement.offsetLeft-this.lastResizerHelperX,r=this.resizeColumnElement.offsetWidth+e;if(r>=(this.resizeColumnElement.style.minWidth.replace(/[^\d.]/g,"")||15)){if("fit"===this.columnResizeMode){let h=this.resizeColumnElement.nextElementSibling.offsetWidth-e;r>15&&h>15&&this.resizeTableCells(r,h)}else"expand"===this.columnResizeMode&&(this.setResizeTableWidth(this.tableViewChild.nativeElement.offsetWidth+e+"px"),this.resizeTableCells(r,null));this.onColResize.emit({element:this.resizeColumnElement,delta:e}),this.isStateful()&&this.saveState()}this.resizeHelperViewChild.nativeElement.style.display="none",Ne.removeClass(this.containerViewChild.nativeElement,"p-unselectable-text")}resizeTableCells(e,o){let r=Ne.index(this.resizeColumnElement),s=[];const l=Ne.findSingle(this.containerViewChild.nativeElement,".p-datatable-thead");Ne.find(l,"tr > th").forEach(y=>s.push(Ne.getOuterWidth(y))),this.destroyStyleElement(),this.createStyleElement();let f="";s.forEach((y,C)=>{let D=C===r?e:o&&C===r+1?o:y;f+=`\n                #${this.id}-table > .p-datatable-thead > tr > th:nth-child(${C+1}),\n                #${this.id}-table > .p-datatable-tbody > tr > td:nth-child(${C+1}),\n                #${this.id}-table > .p-datatable-tfoot > tr > td:nth-child(${C+1}) {\n                    width: ${D}px !important; max-width: ${D}px !important;\n                }\n            `}),this.styleElement.innerHTML=f}onColumnDragStart(e,o){this.reorderIconWidth=Ne.getHiddenElementOuterWidth(this.reorderIndicatorUpViewChild.nativeElement),this.reorderIconHeight=Ne.getHiddenElementOuterHeight(this.reorderIndicatorDownViewChild.nativeElement),this.draggedColumn=o,e.dataTransfer.setData("text","b")}onColumnDragEnter(e,o){if(this.reorderableColumns&&this.draggedColumn&&o){e.preventDefault();let r=Ne.getOffset(this.containerViewChild.nativeElement),s=Ne.getOffset(o);if(this.draggedColumn!=o){Ne.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),Ne.indexWithinGroup(o,"preorderablecolumn");let f=s.left-r.left,C=s.left+o.offsetWidth/2;this.reorderIndicatorUpViewChild.nativeElement.style.top=s.top-r.top-(this.reorderIconHeight-1)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.top=s.top-r.top+o.offsetHeight+"px",e.pageX>C?(this.reorderIndicatorUpViewChild.nativeElement.style.left=f+o.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=f+o.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=1):(this.reorderIndicatorUpViewChild.nativeElement.style.left=f-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=f-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=-1),this.reorderIndicatorUpViewChild.nativeElement.style.display="block",this.reorderIndicatorDownViewChild.nativeElement.style.display="block"}else e.dataTransfer.dropEffect="none"}}onColumnDragLeave(e){this.reorderableColumns&&this.draggedColumn&&e.preventDefault()}onColumnDrop(e,o){if(e.preventDefault(),this.draggedColumn){let r=Ne.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),s=Ne.indexWithinGroup(o,"preorderablecolumn"),l=r!=s;l&&(s-r==1&&-1===this.dropPosition||r-s==1&&1===this.dropPosition)&&(l=!1),l&&s<r&&1===this.dropPosition&&(s+=1),l&&s>r&&-1===this.dropPosition&&(s-=1),l&&(xn.reorderArray(this.columns,r,s),this.onColReorder.emit({dragIndex:r,dropIndex:s,columns:this.columns}),this.isStateful()&&this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.saveState()})})),this.reorderIndicatorUpViewChild.nativeElement.style.display="none",this.reorderIndicatorDownViewChild.nativeElement.style.display="none",this.draggedColumn.draggable=!1,this.draggedColumn=null,this.dropPosition=null}}onRowDragStart(e,o){this.rowDragging=!0,this.draggedRowIndex=o,e.dataTransfer.setData("text","b")}onRowDragOver(e,o,r){if(this.rowDragging&&this.draggedRowIndex!==o){let s=Ne.getOffset(r).top+Ne.getWindowScrollTop(),l=e.pageY,h=s+Ne.getOuterHeight(r)/2,f=r.previousElementSibling;l<h?(Ne.removeClass(r,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=o,f?Ne.addClass(f,"p-datatable-dragpoint-bottom"):Ne.addClass(r,"p-datatable-dragpoint-top")):(f?Ne.removeClass(f,"p-datatable-dragpoint-bottom"):Ne.addClass(r,"p-datatable-dragpoint-top"),this.droppedRowIndex=o+1,Ne.addClass(r,"p-datatable-dragpoint-bottom"))}}onRowDragLeave(e,o){let r=o.previousElementSibling;r&&Ne.removeClass(r,"p-datatable-dragpoint-bottom"),Ne.removeClass(o,"p-datatable-dragpoint-bottom"),Ne.removeClass(o,"p-datatable-dragpoint-top")}onRowDragEnd(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null}onRowDrop(e,o){if(null!=this.droppedRowIndex){let r=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:0===this.droppedRowIndex?0:this.droppedRowIndex-1;xn.reorderArray(this.value,this.draggedRowIndex,r),this.virtualScroll&&(this._value=[...this._value]),this.onRowReorder.emit({dragIndex:this.draggedRowIndex,dropIndex:r})}this.onRowDragLeave(e,o),this.onRowDragEnd(e)}isEmpty(){let e=this.filteredValue||this.value;return null==e||0==e.length}getBlockableElement(){return this.el.nativeElement.children[0]}getStorage(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}}isStateful(){return null!=this.stateKey}saveState(){const e=this.getStorage();let o={};this.paginator&&(o.first=this.first,o.rows=this.rows),this.sortField&&(o.sortField=this.sortField,o.sortOrder=this.sortOrder),this.multiSortMeta&&(o.multiSortMeta=this.multiSortMeta),this.hasFilter()&&(o.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(o),this.reorderableColumns&&this.saveColumnOrder(o),this.selection&&(o.selection=this.selection),Object.keys(this.expandedRowKeys).length&&(o.expandedRowKeys=this.expandedRowKeys),e.setItem(this.stateKey,JSON.stringify(o)),this.onStateSave.emit(o)}clearState(){const e=this.getStorage();this.stateKey&&e.removeItem(this.stateKey)}restoreState(){const o=this.getStorage().getItem(this.stateKey),r=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/;if(o){let l=JSON.parse(o,function(l,h){return"string"==typeof h&&r.test(h)?new Date(h):h});this.paginator&&(void 0!==this.first&&(this.first=l.first,this.firstChange.emit(this.first)),void 0!==this.rows&&(this.rows=l.rows,this.rowsChange.emit(this.rows))),l.sortField&&(this.restoringSort=!0,this._sortField=l.sortField,this._sortOrder=l.sortOrder),l.multiSortMeta&&(this.restoringSort=!0,this._multiSortMeta=l.multiSortMeta),l.filters&&(this.restoringFilter=!0,this.filters=l.filters),this.resizableColumns&&(this.columnWidthsState=l.columnWidths,this.tableWidthState=l.tableWidth),l.expandedRowKeys&&(this.expandedRowKeys=l.expandedRowKeys),l.selection&&Promise.resolve(null).then(()=>this.selectionChange.emit(l.selection)),this.stateRestored=!0,this.onStateRestore.emit(l)}}saveColumnWidths(e){let o=[];Ne.find(this.containerViewChild.nativeElement,".p-datatable-thead > tr > th").forEach(s=>o.push(Ne.getOuterWidth(s))),e.columnWidths=o.join(","),"expand"===this.columnResizeMode&&(e.tableWidth=Ne.getOuterWidth(this.tableViewChild.nativeElement))}setResizeTableWidth(e){this.tableViewChild.nativeElement.style.width=e,this.tableViewChild.nativeElement.style.minWidth=e}restoreColumnWidths(){if(this.columnWidthsState){let e=this.columnWidthsState.split(",");if("expand"===this.columnResizeMode&&this.tableWidthState&&this.setResizeTableWidth(this.tableWidthState+"px"),xn.isNotEmpty(e)){this.createStyleElement();let o="";e.forEach((r,s)=>{o+=`\n                        #${this.id}-table > .p-datatable-thead > tr > th:nth-child(${s+1}),\n                        #${this.id}-table > .p-datatable-tbody > tr > td:nth-child(${s+1}),\n                        #${this.id}-table > .p-datatable-tfoot > tr > td:nth-child(${s+1}) {\n                            width: ${r}px !important; max-width: ${r}px !important\n                        }\n                    `}),this.styleElement.innerHTML=o}}}saveColumnOrder(e){if(this.columns){let o=[];this.columns.map(r=>{o.push(r.field||r.key)}),e.columnOrder=o}}restoreColumnOrder(){const o=this.getStorage().getItem(this.stateKey);if(o){let s=JSON.parse(o).columnOrder;if(s){let l=[];s.map(h=>{let f=this.findColumnByKey(h);f&&l.push(f)}),this.columnOrderStateRestored=!0,this.columns=l}}}findColumnByKey(e){if(!this.columns)return null;for(let o of this.columns)if(o.key===e||o.field===e)return o}createStyleElement(){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement)}getGroupRowsMeta(){return{field:this.groupRowsBy,order:this.groupRowsByOrder}}createResponsiveStyle(){this.responsiveStyleElement||(this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.head.appendChild(this.responsiveStyleElement),this.responsiveStyleElement.innerHTML=`\n@media screen and (max-width: ${this.breakpoint}) {\n    #${this.id}-table > .p-datatable-thead > tr > th,\n    #${this.id}-table > .p-datatable-tfoot > tr > td {\n        display: none !important;\n    }\n\n    #${this.id}-table > .p-datatable-tbody > tr > td {\n        display: flex;\n        width: 100% !important;\n        align-items: center;\n        justify-content: space-between;\n    }\n\n    #${this.id}-table > .p-datatable-tbody > tr > td:not(:last-child) {\n        border: 0 none;\n    }\n\n    #${this.id}.p-datatable-gridlines > .p-datatable-wrapper > .p-datatable-table > .p-datatable-tbody > tr > td:last-child {\n        border-top: 0;\n        border-right: 0;\n        border-left: 0;\n    }\n\n    #${this.id}-table > .p-datatable-tbody > tr > td > .p-column-title {\n        display: block;\n    }\n}\n`)}destroyResponsiveStyle(){this.responsiveStyleElement&&(document.head.removeChild(this.responsiveStyleElement),this.responsiveStyleElement=null)}destroyStyleElement(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.unbindDocumentEditListener(),this.editingCell=null,this.initialized=null,this.destroyStyleElement(),this.destroyResponsiveStyle()}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(yi),ce(RC),ce(Fo),ce(Y2),ce(y0))},t.\u0275cmp=Qt({type:t,selectors:[["p-table"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(nJ,5),pi(iJ,5),pi(oJ,5),pi(rJ,5),pi(sJ,5),pi(aJ,5),pi(lJ,5),pi(cJ,5),pi(uJ,5)),2&e){let r;gn(r=_n())&&(o.containerViewChild=r.first),gn(r=_n())&&(o.resizeHelperViewChild=r.first),gn(r=_n())&&(o.reorderIndicatorUpViewChild=r.first),gn(r=_n())&&(o.reorderIndicatorDownViewChild=r.first),gn(r=_n())&&(o.wrapperViewChild=r.first),gn(r=_n())&&(o.tableViewChild=r.first),gn(r=_n())&&(o.tableHeaderViewChild=r.first),gn(r=_n())&&(o.tableFooterViewChild=r.first),gn(r=_n())&&(o.scroller=r.first)}},hostAttrs:[1,"p-element"],inputs:{frozenColumns:"frozenColumns",frozenValue:"frozenValue",style:"style",styleClass:"styleClass",tableStyle:"tableStyle",tableStyleClass:"tableStyleClass",paginator:"paginator",pageLinks:"pageLinks",rowsPerPageOptions:"rowsPerPageOptions",alwaysShowPaginator:"alwaysShowPaginator",paginatorPosition:"paginatorPosition",paginatorDropdownAppendTo:"paginatorDropdownAppendTo",paginatorDropdownScrollHeight:"paginatorDropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showJumpToPageDropdown:"showJumpToPageDropdown",showJumpToPageInput:"showJumpToPageInput",showFirstLastIcon:"showFirstLastIcon",showPageLinks:"showPageLinks",defaultSortOrder:"defaultSortOrder",sortMode:"sortMode",resetPageOnSort:"resetPageOnSort",selectionMode:"selectionMode",selectionPageOnly:"selectionPageOnly",contextMenuSelection:"contextMenuSelection",contextMenuSelectionMode:"contextMenuSelectionMode",dataKey:"dataKey",metaKeySelection:"metaKeySelection",rowSelectable:"rowSelectable",rowTrackBy:"rowTrackBy",lazy:"lazy",lazyLoadOnInit:"lazyLoadOnInit",compareSelectionBy:"compareSelectionBy",csvSeparator:"csvSeparator",exportFilename:"exportFilename",filters:"filters",globalFilterFields:"globalFilterFields",filterDelay:"filterDelay",filterLocale:"filterLocale",expandedRowKeys:"expandedRowKeys",editingRowKeys:"editingRowKeys",rowExpandMode:"rowExpandMode",scrollable:"scrollable",scrollDirection:"scrollDirection",rowGroupMode:"rowGroupMode",scrollHeight:"scrollHeight",virtualScroll:"virtualScroll",virtualScrollItemSize:"virtualScrollItemSize",virtualScrollOptions:"virtualScrollOptions",virtualScrollDelay:"virtualScrollDelay",frozenWidth:"frozenWidth",responsive:"responsive",contextMenu:"contextMenu",resizableColumns:"resizableColumns",columnResizeMode:"columnResizeMode",reorderableColumns:"reorderableColumns",loading:"loading",loadingIcon:"loadingIcon",showLoader:"showLoader",rowHover:"rowHover",customSort:"customSort",showInitialSortBadge:"showInitialSortBadge",autoLayout:"autoLayout",exportFunction:"exportFunction",exportHeader:"exportHeader",stateKey:"stateKey",stateStorage:"stateStorage",editMode:"editMode",groupRowsBy:"groupRowsBy",groupRowsByOrder:"groupRowsByOrder",responsiveLayout:"responsiveLayout",breakpoint:"breakpoint",virtualRowHeight:"virtualRowHeight",value:"value",columns:"columns",first:"first",rows:"rows",totalRecords:"totalRecords",sortField:"sortField",sortOrder:"sortOrder",multiSortMeta:"multiSortMeta",selection:"selection",selectAll:"selectAll"},outputs:{selectAllChange:"selectAllChange",selectionChange:"selectionChange",contextMenuSelectionChange:"contextMenuSelectionChange",onRowSelect:"onRowSelect",onRowUnselect:"onRowUnselect",onPage:"onPage",onSort:"onSort",onFilter:"onFilter",onLazyLoad:"onLazyLoad",onRowExpand:"onRowExpand",onRowCollapse:"onRowCollapse",onContextMenuSelect:"onContextMenuSelect",onColResize:"onColResize",onColReorder:"onColReorder",onRowReorder:"onRowReorder",onEditInit:"onEditInit",onEditComplete:"onEditComplete",onEditCancel:"onEditCancel",onHeaderCheckboxToggle:"onHeaderCheckboxToggle",sortFunction:"sortFunction",firstChange:"firstChange",rowsChange:"rowsChange",onStateSave:"onStateSave",onStateRestore:"onStateRestore"},features:[zi([RC]),_r],decls:16,vars:22,consts:[[3,"ngStyle","ngClass"],["container",""],["class","p-datatable-loading-overlay p-component-overlay",4,"ngIf"],["class","p-datatable-header",4,"ngIf"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange",4,"ngIf"],[1,"p-datatable-wrapper",3,"ngStyle"],["wrapper",""],[3,"items","columns","style","scrollHeight","itemSize","step","delay","inline","lazy","loaderDisabled","showSpacer","showLoader","options","autoSize","onLazyLoad",4,"ngIf"],[4,"ngIf"],["buildInTable",""],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange",4,"ngIf"],["class","p-datatable-footer",4,"ngIf"],["class","p-column-resizer-helper","style","display:none",4,"ngIf"],["class","pi pi-arrow-down p-datatable-reorder-indicator-up","style","display: none;",4,"ngIf"],["class","pi pi-arrow-up p-datatable-reorder-indicator-down","style","display: none;",4,"ngIf"],[1,"p-datatable-loading-overlay","p-component-overlay"],[1,"p-datatable-header"],[4,"ngTemplateOutlet"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange"],[3,"items","columns","scrollHeight","itemSize","step","delay","inline","lazy","loaderDisabled","showSpacer","showLoader","options","autoSize","onLazyLoad"],["scroller",""],["pTemplate","content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["role","table",3,"ngClass"],["table",""],[1,"p-datatable-thead"],["thead",""],["class","p-datatable-tbody p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen",4,"ngIf"],[1,"p-datatable-tbody",3,"ngClass","value","pTableBody","pTableBodyTemplate","scrollerOptions"],["class","p-datatable-scroller-spacer",3,"style",4,"ngIf"],["class","p-datatable-tfoot",4,"ngIf"],[1,"p-datatable-tbody","p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen"],[1,"p-datatable-scroller-spacer"],[1,"p-datatable-tfoot"],["tfoot",""],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange"],[1,"p-datatable-footer"],[1,"p-column-resizer-helper",2,"display","none"],["resizeHelper",""],[1,"pi","pi-arrow-down","p-datatable-reorder-indicator-up",2,"display","none"],["reorderIndicatorUp",""],[1,"pi","pi-arrow-up","p-datatable-reorder-indicator-down",2,"display","none"],["reorderIndicatorDown",""]],template:function(e,o){1&e&&(P(0,"div",0,1),W(2,dJ,2,2,"div",2),W(3,pJ,2,1,"div",3),W(4,fJ,1,17,"p-paginator",4),P(5,"div",5,6),W(7,yJ,3,17,"p-scroller",7),W(8,xJ,2,7,"ng-container",8),W(9,MJ,10,28,"ng-template",null,9,Ua),N(),W(11,kJ,1,17,"p-paginator",10),W(12,PJ,2,1,"div",11),W(13,OJ,2,0,"div",12),W(14,LJ,2,0,"span",13),W(15,RJ,2,0,"span",14),N()),2&e&&(Zn(o.styleClass),L("ngStyle",o.style)("ngClass",Va(16,FJ,o.rowHover||o.selectionMode,o.scrollable,o.scrollable&&"flex"===o.scrollHeight)),at("id",o.id),F(2),L("ngIf",o.loading&&o.showLoader),F(1),L("ngIf",o.captionTemplate),F(1),L("ngIf",o.paginator&&("top"===o.paginatorPosition||"both"==o.paginatorPosition)),F(1),L("ngStyle",Wt(20,NJ,o.virtualScroll?"":o.scrollHeight)),F(2),L("ngIf",o.virtualScroll),F(1),L("ngIf",!o.virtualScroll),F(3),L("ngIf",o.paginator&&("bottom"===o.paginatorPosition||"both"==o.paginatorPosition)),F(1),L("ngIf",o.summaryTemplate),F(1),L("ngIf",o.resizableColumns),F(1),L("ngIf",o.reorderableColumns),F(1),L("ngIf",o.reorderableColumns))},dependencies:function(){return[ao,Xn,Cs,ho,eN,fo,W3,Uee]},styles:[".p-datatable{position:relative}.p-datatable>.p-datatable-wrapper{overflow:auto}.p-datatable-table{border-spacing:0px;width:100%}.p-datatable .p-sortable-column{cursor:pointer;-webkit-user-select:none;user-select:none}.p-datatable .p-sortable-column .p-column-title,.p-datatable .p-sortable-column .p-sortable-column-icon,.p-datatable .p-sortable-column .p-sortable-column-badge{vertical-align:middle}.p-datatable .p-sortable-column .p-sortable-column-badge{display:inline-flex;align-items:center;justify-content:center}.p-datatable-hoverable-rows .p-selectable-row{cursor:pointer}.p-datatable-scrollable>.p-datatable-wrapper{position:relative}.p-datatable-scrollable-table>.p-datatable-thead{position:sticky;top:0;z-index:1}.p-datatable-scrollable-table>.p-datatable-frozen-tbody{position:sticky;z-index:1}.p-datatable-scrollable-table>.p-datatable-tfoot{position:sticky;bottom:0;z-index:1}.p-datatable-scrollable .p-frozen-column{position:sticky;background:inherit}.p-datatable-scrollable th.p-frozen-column{z-index:1}.p-datatable-flex-scrollable{display:flex;flex-direction:column;height:100%}.p-datatable-flex-scrollable>.p-datatable-wrapper{display:flex;flex-direction:column;flex:1;height:100%}.p-datatable-scrollable-table>.p-datatable-tbody>.p-rowgroup-header{position:sticky;z-index:1}.p-datatable-resizable-table>.p-datatable-thead>tr>th,.p-datatable-resizable-table>.p-datatable-tfoot>tr>td,.p-datatable-resizable-table>.p-datatable-tbody>tr>td{overflow:hidden;white-space:nowrap}.p-datatable-resizable-table>.p-datatable-thead>tr>th.p-resizable-column:not(.p-frozen-column){background-clip:padding-box;position:relative}.p-datatable-resizable-table-fit>.p-datatable-thead>tr>th.p-resizable-column:last-child .p-column-resizer{display:none}.p-datatable .p-column-resizer{display:block;position:absolute!important;top:0;right:0;margin:0;width:.5rem;height:100%;padding:0;cursor:col-resize;border:1px solid transparent}.p-datatable .p-column-resizer-helper{width:1px;position:absolute;z-index:10;display:none}.p-datatable .p-row-editor-init,.p-datatable .p-row-editor-save,.p-datatable .p-row-editor-cancel,.p-datatable .p-row-toggler{display:inline-flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-datatable-reorder-indicator-up,.p-datatable-reorder-indicator-down{position:absolute}.p-datatable-reorderablerow-handle,[pReorderableColumn]{cursor:move}.p-datatable .p-datatable-loading-overlay{position:absolute;display:flex;align-items:center;justify-content:center;z-index:2}.p-column-filter-row{display:flex;align-items:center;width:100%}.p-column-filter-menu{display:inline-flex}.p-column-filter-row p-columnfilterformelement{flex:1 1 auto;width:1%}.p-column-filter-menu-button,.p-column-filter-clear-button{display:inline-flex;justify-content:center;align-items:center;cursor:pointer;text-decoration:none;overflow:hidden;position:relative}.p-column-filter-overlay{position:absolute;top:0;left:0}.p-column-filter-row-items{margin:0;padding:0;list-style:none}.p-column-filter-row-item{cursor:pointer}.p-column-filter-add-button,.p-column-filter-remove-button{justify-content:center}.p-column-filter-add-button .p-button-label,.p-column-filter-remove-button .p-button-label{flex-grow:0}.p-column-filter-buttonbar{display:flex;align-items:center;justify-content:space-between}.p-column-filter-buttonbar .p-button{width:auto}.p-datatable-tbody>tr>td>.p-column-title{display:none}.p-datatable-scroller-spacer{display:flex}.p-datatable .p-scroller .p-scroller-loading{transform:none!important;min-height:0;position:sticky;top:0;left:0}\n"],encapsulation:2}),t})(),Uee=(()=>{class t{constructor(e,o,r,s){this.dt=e,this.tableService=o,this.cd=r,this.el=s,this.subscription=this.dt.tableService.valueSource$.subscribe(()=>{this.dt.virtualScroll&&this.cd.detectChanges()})}get value(){return this._value}set value(e){this._value=e,this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&"subheader"===this.dt.rowGroupMode&&this.updateFrozenRowGroupHeaderStickyPosition()}ngAfterViewInit(){this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&"subheader"===this.dt.rowGroupMode&&this.updateFrozenRowGroupHeaderStickyPosition()}shouldRenderRowGroupHeader(e,o,r){let s=xn.resolveFieldData(o,this.dt.groupRowsBy),l=e[r-1];return!l||s!==xn.resolveFieldData(l,this.dt.groupRowsBy)}shouldRenderRowGroupFooter(e,o,r){let s=xn.resolveFieldData(o,this.dt.groupRowsBy),l=e[r+1];return!l||s!==xn.resolveFieldData(l,this.dt.groupRowsBy)}shouldRenderRowspan(e,o,r){let s=xn.resolveFieldData(o,this.dt.groupRowsBy),l=e[r-1];return!l||s!==xn.resolveFieldData(l,this.dt.groupRowsBy)}calculateRowGroupSize(e,o,r){let s=xn.resolveFieldData(o,this.dt.groupRowsBy),l=s,h=0;for(;s===l;){h++;let f=e[++r];if(!f)break;l=xn.resolveFieldData(f,this.dt.groupRowsBy)}return 1===h?null:h}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}updateFrozenRowStickyPosition(){this.el.nativeElement.style.top=Ne.getOuterHeight(this.el.nativeElement.previousElementSibling)+"px"}updateFrozenRowGroupHeaderStickyPosition(){if(this.el.nativeElement.previousElementSibling){let e=Ne.getOuterHeight(this.el.nativeElement.previousElementSibling);this.dt.rowGroupHeaderStyleObject.top=e+"px"}}getScrollerOption(e,o){return this.dt.virtualScroll&&(o=o||this.scrollerOptions)?o[e]:null}getRowIndex(e){const o=this.dt.paginator?this.dt.first+e:e,r=this.getScrollerOption("getItemOptions");return r?r(o).index:o}}return t.\u0275fac=function(e){return new(e||t)(ce(Nd),ce(RC),ce(Fo),ce(gi))},t.\u0275cmp=Qt({type:t,selectors:[["","pTableBody",""]],hostAttrs:[1,"p-element"],inputs:{columns:["pTableBody","columns"],template:["pTableBodyTemplate","template"],value:"value",frozen:"frozen",frozenRows:"frozenRows",scrollerOptions:"scrollerOptions"},attrs:zJ,decls:5,vars:5,consts:[[4,"ngIf"],["ngFor","",3,"ngForOf","ngForTrackBy"],["role","row",4,"ngIf"],["role","row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){1&e&&(W(0,KJ,2,2,"ng-container",0),W(1,ree,2,2,"ng-container",0),W(2,uee,2,2,"ng-container",0),W(3,hee,2,5,"ng-container",0),W(4,fee,2,5,"ng-container",0)),2&e&&(L("ngIf",!o.dt.expandedRowTemplate),F(1),L("ngIf",o.dt.expandedRowTemplate&&!(o.frozen&&o.dt.frozenExpandedRowTemplate)),F(1),L("ngIf",o.dt.frozenExpandedRowTemplate&&o.frozen),F(1),L("ngIf",o.dt.loading),F(1),L("ngIf",o.dt.isEmpty()&&!o.dt.loading))},dependencies:[Ns,Xn,Cs],encapsulation:2}),t})(),E0=(()=>{class t{constructor(e){this.dt=e,this.isEnabled()&&(this.subscription=this.dt.tableService.sortSource$.subscribe(o=>{this.updateSortState()}))}ngOnInit(){this.isEnabled()&&this.updateSortState()}updateSortState(){this.sorted=this.dt.isSorted(this.field),this.sortOrder=this.sorted?1===this.dt.sortOrder?"ascending":"descending":"none"}onClick(e){this.isEnabled()&&!this.isFilterElement(e.target)&&(this.updateSortState(),this.dt.sort({originalEvent:e,field:this.field}),Ne.clearSelection())}onEnterKey(e){this.onClick(e)}isEnabled(){return!0!==this.pSortableColumnDisabled}isFilterElement(e){return Ne.hasClass(e,"pi-filter-icon")||Ne.hasClass(e,"p-column-filter-menu-button")}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(ce(Nd))},t.\u0275dir=On({type:t,selectors:[["","pSortableColumn",""]],hostAttrs:[1,"p-element"],hostVars:7,hostBindings:function(e,o){1&e&&Te("click",function(s){return o.onClick(s)})("keydown.enter",function(s){return o.onEnterKey(s)}),2&e&&(at("tabindex",o.isEnabled()?"0":null)("role","columnheader")("aria-sort",o.sortOrder),Ro("p-sortable-column",o.isEnabled())("p-highlight",o.sorted))},inputs:{field:["pSortableColumn","field"],pSortableColumnDisabled:"pSortableColumnDisabled"}}),t})(),FC=(()=>{class t{constructor(e,o){this.dt=e,this.cd=o,this.subscription=this.dt.tableService.sortSource$.subscribe(r=>{this.updateSortState()})}ngOnInit(){this.updateSortState()}onClick(e){e.preventDefault()}updateSortState(){if("single"===this.dt.sortMode)this.sortOrder=this.dt.isSorted(this.field)?this.dt.sortOrder:0;else if("multiple"===this.dt.sortMode){let e=this.dt.getSortMeta(this.field);this.sortOrder=e?e.order:0}this.cd.markForCheck()}getMultiSortMetaIndex(){let e=this.dt._multiSortMeta,o=-1;if(e&&"multiple"===this.dt.sortMode&&(this.dt.showInitialSortBadge||e.length>1))for(let r=0;r<e.length;r++){let s=e[r];if(s.field===this.field||s.field===this.field){o=r;break}}return o}getBadgeValue(){let e=this.getMultiSortMetaIndex();return this.dt.groupRowsBy&&e>-1?e:e+1}isMultiSorted(){return"multiple"===this.dt.sortMode&&this.getMultiSortMetaIndex()>-1}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(ce(Nd),ce(Fo))},t.\u0275cmp=Qt({type:t,selectors:[["p-sortIcon"]],hostAttrs:[1,"p-element"],inputs:{field:"field"},decls:2,vars:6,consts:[[1,"p-sortable-column-icon","pi","pi-fw",3,"ngClass"],["class","p-sortable-column-badge",4,"ngIf"],[1,"p-sortable-column-badge"]],template:function(e,o){1&e&&(Ae(0,"i",0),W(1,mee,2,1,"span",1)),2&e&&(L("ngClass",Va(2,gee,1===o.sortOrder,-1===o.sortOrder,0===o.sortOrder)),F(1),L("ngIf",o.isMultiSorted()))},dependencies:[ao,Xn],encapsulation:2,changeDetection:0}),t})(),sN=(()=>{class t{constructor(e,o){this.dt=e,this.tableService=o,this.isEnabled()&&(this.subscription=this.dt.tableService.selectionSource$.subscribe(()=>{this.selected=this.dt.isSelected(this.data)}))}ngOnInit(){this.isEnabled()&&(this.selected=this.dt.isSelected(this.data))}onClick(e){this.isEnabled()&&this.dt.handleRowClick({originalEvent:e,rowData:this.data,rowIndex:this.index})}onTouchEnd(e){this.isEnabled()&&this.dt.handleRowTouchEnd(e)}onArrowDownKeyDown(e){if(!this.isEnabled())return;const r=this.findNextSelectableRow(e.currentTarget);r&&r.focus(),e.preventDefault()}onArrowUpKeyDown(e){if(!this.isEnabled())return;const r=this.findPrevSelectableRow(e.currentTarget);r&&r.focus(),e.preventDefault()}onEnterKeyDown(e){this.isEnabled()&&this.dt.handleRowClick({originalEvent:e,rowData:this.data,rowIndex:this.index})}onPageDownKeyDown(){this.dt.virtualScroll&&this.dt.scroller.elementViewChild.nativeElement.focus()}onSpaceKeydown(){this.dt.virtualScroll&&!this.dt.editingCell&&this.dt.scroller.elementViewChild.nativeElement.focus()}findNextSelectableRow(e){let o=e.nextElementSibling;return o?Ne.hasClass(o,"p-selectable-row")?o:this.findNextSelectableRow(o):null}findPrevSelectableRow(e){let o=e.previousElementSibling;return o?Ne.hasClass(o,"p-selectable-row")?o:this.findPrevSelectableRow(o):null}isEnabled(){return!0!==this.pSelectableRowDisabled}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(ce(Nd),ce(RC))},t.\u0275dir=On({type:t,selectors:[["","pSelectableRow",""]],hostAttrs:[1,"p-element"],hostVars:5,hostBindings:function(e,o){1&e&&Te("click",function(s){return o.onClick(s)})("touchend",function(s){return o.onTouchEnd(s)})("keydown.arrowdown",function(s){return o.onArrowDownKeyDown(s)})("keydown.arrowup",function(s){return o.onArrowUpKeyDown(s)})("keydown.enter",function(s){return o.onEnterKeyDown(s)})("keydown.shift.enter",function(s){return o.onEnterKeyDown(s)})("keydown.meta.enter",function(s){return o.onEnterKeyDown(s)})("keydown.pagedown",function(){return o.onPageDownKeyDown()})("keydown.pageup",function(){return o.onPageDownKeyDown()})("keydown.home",function(){return o.onPageDownKeyDown()})("keydown.end",function(){return o.onPageDownKeyDown()})("keydown.space",function(){return o.onSpaceKeydown()}),2&e&&(at("tabindex",o.isEnabled()?0:void 0),Ro("p-selectable-row",o.isEnabled())("p-highlight",o.selected))},inputs:{data:["pSelectableRow","data"],index:["pSelectableRowIndex","index"],pSelectableRowDisabled:"pSelectableRowDisabled"}}),t})(),NC=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,tN,Nf,zf,Gh,gl,T0,IX,_D,tJ,PC,hs,PC]}),t})();function jee(t,n){if(1&t){const e=Ye();P(0,"div",8)(1,"div",9)(2,"div",10)(3,"h4",11),ie(4," Usuarios encontrados "),N(),P(5,"div",12)(6,"span",13),Ae(7,"i",14),P(8,"input",15),Te("input",function(r){be(e);const s=U();return ve(Un(4).filterGlobal(s.getEventValue(r),"contains"))}),N()()()()()()}}function Hee(t,n){1&t&&(P(0,"tr")(1,"th",16)(2,"div",17),ie(3," Nombre "),Ae(4,"p-sortIcon",18),N()(),P(5,"th",19)(6,"div",17),ie(7," Usuario "),Ae(8,"p-sortIcon",20),N()(),P(9,"th",21)(10,"div",22),ie(11," Enviar "),N()()())}function $ee(t,n){if(1&t&&Ae(0,"img",32),2&t){const e=U().$implicit;Ai("src",e.profileImage,Ui),L("alt",e.name)}}function Gee(t,n){1&t&&Ae(0,"img",33),2&t&&L("alt",U().$implicit.name)}function Wee(t,n){if(1&t){const e=Ye();P(0,"button",38),Te("click",function(){be(e);const r=U(2).$implicit;return ve(U().onViewProfile(r.userId))}),P(1,"span",39),ie(2," Ver perfil "),N()()}2&t&&L("disabled",U(2).$implicit.friendRequestSent)}function qee(t,n){if(1&t){const e=Ye();P(0,"button",40),Te("click",function(){be(e);const r=U(2).$implicit;return ve(U().onAcceptRequest(r.userId,r.name))}),P(1,"span",39),ie(2," Aceptar solicitud "),N()()}}function Zee(t,n){1&t&&(P(0,"button",41)(1,"span",39),ie(2," Solicitud enviada "),N()()),2&t&&L("disabled",U(2).$implicit.friendRequestReceived)}function Kee(t,n){if(1&t){const e=Ye();P(0,"button",38),Te("click",function(){be(e);const r=U(2).$implicit;return ve(U().sendRequest(r.userId,r.name))}),P(1,"span",39),ie(2," Enviar "),N()()}2&t&&L("disabled",U(2).$implicit.friendRequestSent)}function Xee(t,n){if(1&t&&(P(0,"div",34),W(1,Wee,3,1,"button",35),W(2,qee,3,0,"button",36),W(3,Zee,3,1,"button",37),W(4,Kee,3,1,"button",35),N()),2&t){const e=U().$implicit;F(1),L("ngIf",e.isFriend),F(1),L("ngIf",e.friendRequestSent),F(1),L("ngIf",e.friendRequestReceived),F(1),L("ngIf",!e.isFriend&&!e.friendRequestSent&&!e.friendRequestReceived)}}function Yee(t,n){if(1&t&&(P(0,"tr")(1,"td",23)(2,"div",24)(3,"div",25),W(4,$ee,1,2,"img",26),W(5,Gee,1,1,"img",27),N(),P(6,"div",28),ie(7),wo(8,"slice"),N()()(),P(9,"td",29),ie(10),N(),P(11,"td",30),W(12,Xee,5,4,"div",31),N()()),2&t){const e=n.$implicit,o=U();F(4),L("ngIf",""!=e.profileImage),F(1),L("ngIf",""==e.profileImage),F(2),Ut(e.name.length>15?Nr(8,5,e.name,0,14)+"...":e.name),F(3),jn("@",e.nickname,""),F(2),L("ngIf",e.userId!=o.appLayout.user.userId)}}function Qee(t,n){1&t&&(P(0,"tr")(1,"td",42),ie(2,"No se ha encontrado ning\xfan usuario."),N()())}const Jee=function(){return["name","nickname"]},ete=function(){return[10,25,50]};let tte=(()=>{class t{constructor(e,o,r){this.friendsService=e,this.router=o,this.appLayout=r,this.loading=!0,this.newFriend=new ht}getEventValue(e){return e.target.value}onViewProfile(e){this.router.navigate(["/friendProfile",e])}onAcceptRequest(e,o){var r=this;return Ft(function*(){try{yield r.friendsService.acceptFriendRequest(e,!0);for(let s=0;s<r.searchedUsers.length;s++)if(r.searchedUsers[s].userId==e){r.searchedUsers[s].isFriend=!0,r.searchedUsers[s].friendRequestSent=!1,r.appLayout.messageService.add({severity:"success",summary:"Solicitud aceptada",detail:"Has aceptado la solicitd de "+o}),r.newFriend.emit(r.searchedUsers[s]);break}}catch(s){403==s.status?r.appLayout.handle403Error():r.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.data.status})}})()}sendRequest(e,o){var r=this;return Ft(function*(){try{yield r.friendsService.sendFriendRequest(e);for(let s=0;s<r.searchedUsers.length;s++)if(r.searchedUsers[s].userId==e){r.searchedUsers[s].friendRequestReceived=!0,r.appLayout.messageService.add({severity:"success",summary:"Solicitud enviada",detail:"Has enviado una solicitud de amistad a "+o});break}}catch(s){403==s.status?r.appLayout.handle403Error():r.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.response.data.status})}})()}}return t.\u0275fac=function(e){return new(e||t)(ce(Py),ce(Ss),ce(Zo))},t.\u0275cmp=Qt({type:t,selectors:[["app-friends-table"]],inputs:{searchedUsers:"searchedUsers",loading:"loading"},outputs:{newFriend:"newFriend"},decls:9,vars:10,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers"],["data-cy","users-table","currentPageReportTemplate","{first} a {last}",3,"value","paginator","rows","loading","rowHover","showCurrentPageReport","globalFilterFields","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],["data-cy","found-users",1,"md:m-0","mb-3","text-center","md:text-left"],[1,"flex","align-items-center","justify-content-center"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center","name-size"],["field","name"],["pSortableColumn","nickname"],["field","nickname"],["pSortableColumn","boton"],[1,"flex","justify-content-between","align-items-center","margin-td-right",2,"float","right"],["data-cy","username",1,"padding-td"],[2,"display","flex","align-items","flex-start"],[1,"round-images-size"],["class","round-images round-images-size",3,"src","alt",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","class","round-images round-images-size",3,"alt",4,"ngIf"],[1,"ml-3","name-size",2,"height","40px","text-align","start","display","flex","align-items","center"],["data-cy","nickname",1,"padding-td","name-size"],[1,"padding-td"],["class","margin-td-right","style","float:right;",4,"ngIf"],[1,"round-images","round-images-size",3,"src","alt"],["src","assets/images/profilePlaceholder.svg",1,"round-images","round-images-size",3,"alt"],[1,"margin-td-right",2,"float","right"],["pButton","","pRipple","","type","button","class","p-button-raised p-button-width p-button-text border-round-xl h-2rem button-gradient",3,"disabled","click",4,"ngIf"],["pButton","","pRipple","","type","button","class","p-button-raised p-button-width p-button-text border-round-xl h-2rem button-gradient",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","class","p-button-raised p-button-width p-button-text border-round-xl h-2rem button-gradient",3,"disabled",4,"ngIf"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient",3,"disabled","click"],[1,"vibe-btn-text-white","font-normal","text-xs"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient",3,"click"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient",3,"disabled"],["data-cy","no-users","colspan","8"]],template:function(e,o){1&e&&(P(0,"h3",0),ie(1," Usuarios encontrados "),N(),P(2,"div",1)(3,"p-table",2,3),W(5,jee,9,0,"ng-template",4),W(6,Hee,12,0,"ng-template",5),W(7,Yee,13,9,"ng-template",6),W(8,Qee,3,0,"ng-template",7),N()()),2&e&&(F(3),L("value",o.searchedUsers)("paginator",!0)("rows",10)("loading",o.loading)("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",Kn(8,Jee))("rowsPerPageOptions",Kn(9,ete)))},dependencies:[Xn,Dr,fo,_l,Nd,E0,FC,Su],styles:[".padding-td[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important;padding-left:1rem!important;padding-right:0!important}.margin-td-right[_ngcontent-%COMP%]{margin-right:1rem!important}.name-size[_ngcontent-%COMP%]{font-size:1rem!important}@media (max-width: 710px){.padding-td[_ngcontent-%COMP%]{padding-top:.75rem!important;padding-bottom:.75rem!important;padding-left:.75rem!important;padding-right:0!important}.margin-td-right[_ngcontent-%COMP%]{margin-right:.75rem!important}}@media (max-width: 600px){.name-size[_ngcontent-%COMP%]{font-size:.9rem!important}}"]}),t})();const nte=["itemsContainer"];function ite(t,n){1&t&&$t(0)}function ote(t,n){if(1&t&&(P(0,"div",11),ro(1),W(2,ite,1,0,"ng-container",12),N()),2&t){const e=U();F(2),L("ngTemplateOutlet",e.headerTemplate)}}const rte=function(t){return{"p-carousel-prev p-link":!0,"p-disabled":t}},ste=function(t,n){return{"p-carousel-prev-icon pi":!0,"pi-chevron-left":t,"pi-chevron-up":n}};function ate(t,n){if(1&t){const e=Ye();P(0,"button",13),Te("click",function(r){return be(e),ve(U().navBackward(r))}),Ae(1,"span",2),N()}if(2&t){const e=U();L("ngClass",Wt(3,rte,e.isBackwardNavDisabled()))("disabled",e.isBackwardNavDisabled()),F(1),L("ngClass",Ji(5,ste,!e.isVertical(),e.isVertical()))}}function lte(t,n){1&t&&$t(0)}const aN=function(t,n,e){return{"p-carousel-item p-carousel-item-cloned":!0,"p-carousel-item-active":t,"p-carousel-item-start":n,"p-carousel-item-end":e}},bD=function(t){return{$implicit:t}};function cte(t,n){if(1&t&&(P(0,"div",2),W(1,lte,1,0,"ng-container",14),N()),2&t){const e=n.$implicit,o=n.index,r=U();L("ngClass",Va(3,aN,-1*r.totalShiftedItems===r.value.length,0===o,r.clonedItemsForStarting.length-1===o)),F(1),L("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",Wt(7,bD,e))}}function ute(t,n){1&t&&$t(0)}const dte=function(t,n,e){return{"p-carousel-item":!0,"p-carousel-item-active":t,"p-carousel-item-start":n,"p-carousel-item-end":e}};function hte(t,n){if(1&t&&(P(0,"div",2),W(1,ute,1,0,"ng-container",14),N()),2&t){const e=n.$implicit,o=n.index,r=U();L("ngClass",Va(3,dte,r.firstIndex()<=o&&r.lastIndex()>=o,r.firstIndex()===o,r.lastIndex()===o)),F(1),L("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",Wt(7,bD,e))}}function pte(t,n){1&t&&$t(0)}function fte(t,n){if(1&t&&(P(0,"div",2),W(1,pte,1,0,"ng-container",14),N()),2&t){const e=n.$implicit,o=n.index,r=U();L("ngClass",Va(3,aN,-1*r.totalShiftedItems===r.numVisible,0===o,r.clonedItemsForFinishing.length-1===o)),F(1),L("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",Wt(7,bD,e))}}const mte=function(t){return{"p-carousel-next p-link":!0,"p-disabled":t}},gte=function(t,n){return{"p-carousel-prev-icon pi":!0,"pi-chevron-right":t,"pi-chevron-down":n}};function _te(t,n){if(1&t){const e=Ye();P(0,"button",13),Te("click",function(r){return be(e),ve(U().navForward(r))}),Ae(1,"span",2),N()}if(2&t){const e=U();L("ngClass",Wt(3,mte,e.isForwardNavDisabled()))("disabled",e.isForwardNavDisabled()),F(1),L("ngClass",Ji(5,gte,!e.isVertical(),e.isVertical()))}}const yte=function(t){return{"p-carousel-indicator":!0,"p-highlight":t}};function vte(t,n){if(1&t){const e=Ye();P(0,"li",2)(1,"button",15),Te("click",function(r){const l=be(e).index;return ve(U(2).onDotClick(r,l))}),N()()}if(2&t){const e=n.index,o=U(2);L("ngClass",Wt(5,yte,o._page===e)),F(1),Zn(o.indicatorStyleClass),L("ngClass","p-link")("ngStyle",o.indicatorStyle)}}function bte(t,n){if(1&t&&(P(0,"ul",0),W(1,vte,2,7,"li",8),N()),2&t){const e=U();Zn(e.indicatorsContentClass),L("ngClass","p-carousel-indicators p-reset")("ngStyle",e.indicatorsContentStyle),F(1),L("ngForOf",e.totalDotsArray())}}function xte(t,n){1&t&&$t(0)}function wte(t,n){if(1&t&&(P(0,"div",16),ro(1,1),W(2,xte,1,0,"ng-container",12),N()),2&t){const e=U();F(2),L("ngTemplateOutlet",e.footerTemplate)}}const Cte=[[["p-header"]],[["p-footer"]]],Tte=function(t,n){return{"p-carousel p-component":!0,"p-carousel-vertical":t,"p-carousel-horizontal":n}},Ste=function(t){return{height:t}},Ete=["p-header","p-footer"];let lN=(()=>{class t{constructor(e,o,r,s,l){this.el=e,this.zone=o,this.cd=r,this.renderer=s,this.document=l,this.orientation="horizontal",this.verticalViewPortHeight="300px",this.contentClass="",this.indicatorsContentClass="",this.indicatorStyleClass="",this.circular=!1,this.showIndicators=!0,this.showNavigators=!0,this.autoplayInterval=0,this.onPage=new ht,this._numVisible=1,this._numScroll=1,this._oldNumScroll=0,this.prevState={numScroll:0,numVisible:0,value:[]},this.defaultNumScroll=1,this.defaultNumVisible=1,this._page=0,this.isRemainingItemsAdded=!1,this.remainingItems=0,this.swipeThreshold=20,this.totalShiftedItems=this.page*this.numScroll*-1}get page(){return this._page}set page(e){this.isCreated&&e!==this._page&&(this.autoplayInterval&&(this.stopAutoplay(),this.allowAutoplay=!1),e>this._page&&e<=this.totalDots()-1?this.step(-1,e):e<this._page&&this.step(1,e)),this._page=e}get numVisible(){return this._numVisible}set numVisible(e){this._numVisible=e}get numScroll(){return this._numVisible}set numScroll(e){this._numScroll=e}get value(){return this._value}set value(e){this._value=e}ngOnChanges(e){e.value&&this.circular&&this._value&&this.setCloneItems(),this.isCreated&&(e.numVisible&&(this.responsiveOptions&&(this.defaultNumVisible=this.numVisible),this.isCircular()&&this.setCloneItems(),this.createStyle(),this.calculatePosition()),e.numScroll&&this.responsiveOptions&&(this.defaultNumScroll=this.numScroll))}ngAfterContentInit(){this.id=Ig(),this.allowAutoplay=!!this.autoplayInterval,this.circular&&this.setCloneItems(),this.responsiveOptions&&(this.defaultNumScroll=this._numScroll,this.defaultNumVisible=this._numVisible),this.createStyle(),this.calculatePosition(),this.responsiveOptions&&this.bindDocumentListeners(),this.templates.forEach(e=>{switch(e.getType()){case"item":default:this.itemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngAfterContentChecked(){const e=this.isCircular();let o=this.totalShiftedItems;if(this.value&&this.itemsContainer&&(this.prevState.numScroll!==this._numScroll||this.prevState.numVisible!==this._numVisible||this.prevState.value.length!==this.value.length)){this.autoplayInterval&&this.stopAutoplay(),this.remainingItems=(this.value.length-this._numVisible)%this._numScroll;let r=this._page;0!==this.totalDots()&&r>=this.totalDots()&&(r=this.totalDots()-1,this._page=r,this.onPage.emit({page:this.page})),o=r*this._numScroll*-1,e&&(o-=this._numVisible),r===this.totalDots()-1&&this.remainingItems>0?(o+=-1*this.remainingItems+this._numScroll,this.isRemainingItemsAdded=!0):this.isRemainingItemsAdded=!1,o!==this.totalShiftedItems&&(this.totalShiftedItems=o),this._oldNumScroll=this._numScroll,this.prevState.numScroll=this._numScroll,this.prevState.numVisible=this._numVisible,this.prevState.value=[...this._value],this.totalDots()>0&&this.itemsContainer.nativeElement&&(this.itemsContainer.nativeElement.style.transform=this.isVertical()?`translate3d(0, ${o*(100/this._numVisible)}%, 0)`:`translate3d(${o*(100/this._numVisible)}%, 0, 0)`),this.isCreated=!0,this.autoplayInterval&&this.isAutoplay()&&this.startAutoplay()}e&&(0===this.page?o=-1*this._numVisible:0===o&&(o=-1*this.value.length,this.remainingItems>0&&(this.isRemainingItemsAdded=!0)),o!==this.totalShiftedItems&&(this.totalShiftedItems=o))}createStyle(){this.carouselStyle||(this.carouselStyle=this.renderer.createElement("style"),this.carouselStyle.type="text/css",this.renderer.appendChild(this.document.head,this.carouselStyle));let e=`\n            #${this.id} .p-carousel-item {\n\t\t\t\tflex: 1 0 ${100/this.numVisible}%\n\t\t\t}\n        `;if(this.responsiveOptions){this.responsiveOptions.sort((o,r)=>{const s=o.breakpoint,l=r.breakpoint;let h=null;return h=null==s&&null!=l?-1:null!=s&&null==l?1:null==s&&null==l?0:"string"==typeof s&&"string"==typeof l?s.localeCompare(l,void 0,{numeric:!0}):s<l?-1:s>l?1:0,-1*h});for(let o=0;o<this.responsiveOptions.length;o++){let r=this.responsiveOptions[o];e+=`\n                    @media screen and (max-width: ${r.breakpoint}) {\n                        #${this.id} .p-carousel-item {\n                            flex: 1 0 ${100/r.numVisible}%\n                        }\n                    }\n                `}}this.carouselStyle.innerHTML=e}calculatePosition(){if(this.responsiveOptions){let e={numVisible:this.defaultNumVisible,numScroll:this.defaultNumScroll};if(typeof window<"u"){let o=window.innerWidth;for(let r=0;r<this.responsiveOptions.length;r++){let s=this.responsiveOptions[r];parseInt(s.breakpoint,10)>=o&&(e=s)}}if(this._numScroll!==e.numScroll){let o=this._page;o=Math.floor(o*this._numScroll/e.numScroll);let r=e.numScroll*this.page*-1;this.isCircular()&&(r-=e.numVisible),this.totalShiftedItems=r,this._numScroll=e.numScroll,this._page=o,this.onPage.emit({page:this.page})}this._numVisible!==e.numVisible&&(this._numVisible=e.numVisible,this.setCloneItems()),this.cd.markForCheck()}}setCloneItems(){this.clonedItemsForStarting=[],this.clonedItemsForFinishing=[],this.isCircular()&&(this.clonedItemsForStarting.push(...this.value.slice(-1*this._numVisible)),this.clonedItemsForFinishing.push(...this.value.slice(0,this._numVisible)))}firstIndex(){return this.isCircular()?-1*(this.totalShiftedItems+this.numVisible):-1*this.totalShiftedItems}lastIndex(){return this.firstIndex()+this.numVisible-1}totalDots(){return this.value?.length?Math.ceil((this.value.length-this._numVisible)/this._numScroll)+1:0}totalDotsArray(){const e=this.totalDots();return e<=0?[]:Array(e).fill(0)}isVertical(){return"vertical"===this.orientation}isCircular(){return this.circular&&this.value&&this.value.length>=this.numVisible}isAutoplay(){return this.autoplayInterval&&this.allowAutoplay}isForwardNavDisabled(){return this.isEmpty()||this._page>=this.totalDots()-1&&!this.isCircular()}isBackwardNavDisabled(){return this.isEmpty()||this._page<=0&&!this.isCircular()}isEmpty(){return!this.value||0===this.value.length}navForward(e,o){(this.isCircular()||this._page<this.totalDots()-1)&&this.step(-1,o),this.autoplayInterval&&(this.stopAutoplay(),this.allowAutoplay=!1),e&&e.cancelable&&e.preventDefault()}navBackward(e,o){(this.isCircular()||0!==this._page)&&this.step(1,o),this.autoplayInterval&&(this.stopAutoplay(),this.allowAutoplay=!1),e&&e.cancelable&&e.preventDefault()}onDotClick(e,o){let r=this._page;this.autoplayInterval&&(this.stopAutoplay(),this.allowAutoplay=!1),o>r?this.navForward(e,o):o<r&&this.navBackward(e,o)}step(e,o){let r=this.totalShiftedItems;const s=this.isCircular();null!=o?(r=this._numScroll*o*-1,s&&(r-=this._numVisible),this.isRemainingItemsAdded=!1):(r+=this._numScroll*e,this.isRemainingItemsAdded&&(r+=this.remainingItems-this._numScroll*e,this.isRemainingItemsAdded=!1),o=Math.abs(Math.floor((s?r+this._numVisible:r)/this._numScroll))),s&&this.page===this.totalDots()-1&&-1===e?(r=-1*(this.value.length+this._numVisible),o=0):s&&0===this.page&&1===e?(r=0,o=this.totalDots()-1):o===this.totalDots()-1&&this.remainingItems>0&&(r+=-1*this.remainingItems-this._numScroll*e,this.isRemainingItemsAdded=!0),this.itemsContainer&&(this.itemsContainer.nativeElement.style.transform=this.isVertical()?`translate3d(0, ${r*(100/this._numVisible)}%, 0)`:`translate3d(${r*(100/this._numVisible)}%, 0, 0)`,this.itemsContainer.nativeElement.style.transition="transform 500ms ease 0s"),this.totalShiftedItems=r,this._page=o,this.onPage.emit({page:this.page})}startAutoplay(){this.interval=setInterval(()=>{this.totalDots()>0&&(this.page===this.totalDots()-1?this.step(-1,0):this.step(-1,this.page+1))},this.autoplayInterval)}stopAutoplay(){this.interval&&clearInterval(this.interval)}onTransitionEnd(){this.itemsContainer&&(this.itemsContainer.nativeElement.style.transition="",(0===this.page||this.page===this.totalDots()-1)&&this.isCircular()&&(this.itemsContainer.nativeElement.style.transform=this.isVertical()?`translate3d(0, ${this.totalShiftedItems*(100/this._numVisible)}%, 0)`:`translate3d(${this.totalShiftedItems*(100/this._numVisible)}%, 0, 0)`))}onTouchStart(e){let o=e.changedTouches[0];this.startPos={x:o.pageX,y:o.pageY}}onTouchMove(e){e.cancelable&&e.preventDefault()}onTouchEnd(e){let o=e.changedTouches[0];this.isVertical()?this.changePageOnTouch(e,o.pageY-this.startPos.y):this.changePageOnTouch(e,o.pageX-this.startPos.x)}changePageOnTouch(e,o){Math.abs(o)>this.swipeThreshold&&(o<0?this.navForward(e):this.navBackward(e))}bindDocumentListeners(){!this.documentResizeListener&&typeof window<"u"&&(this.documentResizeListener=e=>{this.calculatePosition()},window.addEventListener("resize",this.documentResizeListener))}unbindDocumentListeners(){this.documentResizeListener&&typeof window<"u"&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}ngOnDestroy(){this.responsiveOptions&&this.unbindDocumentListeners(),this.autoplayInterval&&this.stopAutoplay()}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(yi),ce(Fo),ce(Jr),ce(uo))},t.\u0275cmp=Qt({type:t,selectors:[["p-carousel"]],contentQueries:function(e,o,r){if(1&e&&(Bo(r,Q2,5),Bo(r,vC,5),Bo(r,fo,4)),2&e){let s;gn(s=_n())&&(o.headerFacet=s.first),gn(s=_n())&&(o.footerFacet=s.first),gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&pi(nte,5),2&e){let r;gn(r=_n())&&(o.itemsContainer=r.first)}},hostAttrs:[1,"p-element"],inputs:{page:"page",numVisible:"numVisible",numScroll:"numScroll",responsiveOptions:"responsiveOptions",orientation:"orientation",verticalViewPortHeight:"verticalViewPortHeight",contentClass:"contentClass",indicatorsContentClass:"indicatorsContentClass",indicatorsContentStyle:"indicatorsContentStyle",indicatorStyleClass:"indicatorStyleClass",indicatorStyle:"indicatorStyle",value:"value",circular:"circular",showIndicators:"showIndicators",showNavigators:"showNavigators",autoplayInterval:"autoplayInterval",style:"style",styleClass:"styleClass"},outputs:{onPage:"onPage"},features:[_r],ngContentSelectors:Ete,decls:14,vars:22,consts:[[3,"ngClass","ngStyle"],["class","p-carousel-header",4,"ngIf"],[3,"ngClass"],[1,"p-carousel-container"],["type","button","pRipple","",3,"ngClass","disabled","click",4,"ngIf"],[1,"p-carousel-items-content",3,"ngStyle"],[1,"p-carousel-items-container",3,"transitionend","touchend","touchstart","touchmove"],["itemsContainer",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass","class","ngStyle",4,"ngIf"],["class","p-carousel-footer",4,"ngIf"],[1,"p-carousel-header"],[4,"ngTemplateOutlet"],["type","button","pRipple","",3,"ngClass","disabled","click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button",3,"ngClass","ngStyle","click"],[1,"p-carousel-footer"]],template:function(e,o){1&e&&(hr(Cte),P(0,"div",0),W(1,ote,3,1,"div",1),P(2,"div",2)(3,"div",3),W(4,ate,2,8,"button",4),P(5,"div",5)(6,"div",6,7),Te("transitionend",function(){return o.onTransitionEnd()})("touchend",function(s){return o.onTouchEnd(s)})("touchstart",function(s){return o.onTouchStart(s)})("touchmove",function(s){return o.onTouchMove(s)}),W(8,cte,2,9,"div",8),W(9,hte,2,9,"div",8),W(10,fte,2,9,"div",8),N()(),W(11,_te,2,8,"button",4),N(),W(12,bte,2,5,"ul",9),N(),W(13,wte,3,1,"div",10),N()),2&e&&(Zn(o.styleClass),L("ngClass",Ji(17,Tte,o.isVertical(),!o.isVertical()))("ngStyle",o.style),at("id",o.id),F(1),L("ngIf",o.headerFacet||o.headerTemplate),F(1),Zn(o.contentClass),L("ngClass","p-carousel-content"),F(2),L("ngIf",o.showNavigators),F(1),L("ngStyle",Wt(20,Ste,o.isVertical()?o.verticalViewPortHeight:"auto")),F(3),L("ngForOf",o.clonedItemsForStarting),F(1),L("ngForOf",o.value),F(1),L("ngForOf",o.clonedItemsForFinishing),F(1),L("ngIf",o.showNavigators),F(1),L("ngIf",o.showIndicators),F(1),L("ngIf",o.footerFacet||o.footerTemplate))},dependencies:[ao,Ns,Xn,Cs,ho,Iu],styles:[".p-carousel{display:flex;flex-direction:column}.p-carousel-content{display:flex;flex-direction:column;overflow:auto}.p-carousel-prev,.p-carousel-next{align-self:center;flex-grow:0;flex-shrink:0;display:flex;justify-content:center;align-items:center;overflow:hidden;position:relative}.p-carousel-container{display:flex;flex-direction:row}.p-carousel-items-content{overflow:hidden;width:100%}.p-carousel-items-container{display:flex;flex-direction:row}.p-carousel-indicators{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap}.p-carousel-indicator>button{display:flex;align-items:center;justify-content:center}.p-carousel-vertical .p-carousel-container{flex-direction:column}.p-carousel-vertical .p-carousel-items-container{flex-direction:column;height:100%}.p-items-hidden .p-carousel-item{visibility:hidden}.p-items-hidden .p-carousel-item.p-carousel-item-active{visibility:visible}\n"],encapsulation:2,changeDetection:0}),t})(),zC=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,hs,ml,bi,hs]}),t})();function Ite(t,n){1&t&&(P(0,"h3",7),ie(1," Mis amigos "),N())}function Dte(t,n){if(1&t&&Ae(0,"img",17),2&t){const e=U().$implicit;Ai("src",e.profileImage,Ui),L("alt",e.name)}}function Mte(t,n){1&t&&Ae(0,"img",18),2&t&&L("alt",U().$implicit.name)}function kte(t,n){if(1&t){const e=Ye();P(0,"div",8)(1,"div",9)(2,"div",10),W(3,Dte,1,2,"img",11),W(4,Mte,1,1,"img",12),N(),P(5,"div")(6,"h4",13),ie(7),N()(),P(8,"div")(9,"h5",14),ie(10),N()(),P(11,"div")(12,"button",15),Te("click",function(){const s=be(e).$implicit;return ve(U(2).goToProfile(s.userId))}),P(13,"span",16),ie(14," Ver perfil "),N()()()()()}if(2&t){const e=n.$implicit;F(3),L("ngIf",""!=e.profileImage),F(1),L("ngIf",""==e.profileImage),F(3),Ut(e.name),F(3),Ut(e.nickname)}}function Ate(t,n){if(1&t&&(P(0,"p-carousel",4),W(1,Ite,2,0,"ng-template",5),W(2,kte,15,4,"ng-template",6),N()),2&t){const e=U();L("value",e.friends)("numVisible",7)("numScroll",7)("circular",!0)("responsiveOptions",e.responsiveOptions)("showIndicators",!0)}}function Pte(t,n){1&t&&(P(0,"p",19),ie(1," No se han encontrado amigos"),N())}let cN=(()=>{class t{constructor(e,o){this.appLayout=e,this.friendsService=o,this.responsiveOptions=[{breakpoint:"2200px",numVisible:5,numScroll:5},{breakpoint:"1800px",numVisible:4,numScroll:4},{breakpoint:"1600px",numVisible:3,numScroll:3},{breakpoint:"1400px",numVisible:2,numScroll:2},{breakpoint:"950px",numVisible:1,numScroll:1},{breakpoint:"699px",numVisible:2,numScroll:2},{breakpoint:"600px",numVisible:1,numScroll:1}],this.friends=new Array}ngOnInit(){this.getFriends()}getFriends(){var e=this;return Ft(function*(){try{const o=yield e.friendsService.getFriends();e.friends=o.friends}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}goToProfile(e){this.appLayout.currentRouteId=7,this.appLayout.router.navigate(["/friendProfile",e])}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(Py))},t.\u0275cmp=Qt({type:t,selectors:[["app-friends-carousel"]],inputs:{friends:"friends"},decls:5,vars:2,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers-carousel"],[3,"value","numVisible","numScroll","circular","responsiveOptions","showIndicators",4,"ngIf"],["class","ml-3 text-lg",4,"ngIf"],[3,"value","numVisible","numScroll","circular","responsiveOptions","showIndicators"],["pTemplate","header"],["pTemplate","item"],[1,"mb-4","ml-3","show-titles-sm"],[1,"product-item"],[1,"product-item-content",2,"display","flex","flex-direction","column","align-items","center"],[1,"mb-3","mx-auto","mt-2","overflow-hidden",2,"height","180px","width","180px","border-radius","100%","box-shadow","var(--shadows)"],["style","height: 180px; width: 180px; object-fit: cover;",3,"src","alt",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","style","height: 180px; width: 180px; object-fit: cover;",3,"alt",4,"ngIf"],[1,"mb-1"],[1,"mt-0","mb-3","font-normal"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient","mb-2",3,"click"],[1,"vibe-btn-text-white","font-normal","text-xs"],[2,"height","180px","width","180px","object-fit","cover",3,"src","alt"],["src","assets/images/profilePlaceholder.svg",2,"height","180px","width","180px","object-fit","cover",3,"alt"],[1,"ml-3","text-lg"]],template:function(e,o){1&e&&(P(0,"h3",0),ie(1," Mis amigos "),N(),P(2,"div",1),W(3,Ate,3,6,"p-carousel",2),W(4,Pte,2,0,"p",3),N()),2&e&&(F(3),L("ngIf",0!=o.friends.length),F(1),L("ngIf",0==o.friends.length))},dependencies:[Xn,Dr,lN,fo]}),t})(),Mu=(()=>{class t{constructor(){this.strokeWidth="2",this.fill="none",this.animationDuration="2s"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["p-progressSpinner"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",strokeWidth:"strokeWidth",fill:"fill",animationDuration:"animationDuration"},decls:3,vars:6,consts:[["role","alert","aria-busy","true",1,"p-progress-spinner",3,"ngStyle","ngClass"],["viewBox","25 25 50 50",1,"p-progress-spinner-svg"],["cx","50","cy","50","r","20","stroke-miterlimit","10",1,"p-progress-spinner-circle"]],template:function(e,o){1&e&&(P(0,"div",0),function he(){ni.lFrame.currentNamespace=dm}(),P(1,"svg",1),Ae(2,"circle",2),N()()),2&e&&(L("ngStyle",o.style)("ngClass",o.styleClass),F(1),za("animation-duration",o.animationDuration),F(1),at("fill",o.fill)("stroke-width",o.strokeWidth))},dependencies:[ao,ho],styles:['.p-progress-spinner{position:relative;margin:0 auto;width:100px;height:100px;display:inline-block}.p-progress-spinner:before{content:"";display:block;padding-top:100%}.p-progress-spinner-svg{animation:p-progress-spinner-rotate 2s linear infinite;height:100%;transform-origin:center center;width:100%;position:absolute;inset:0;margin:auto}.p-progress-spinner-circle{stroke-dasharray:89,200;stroke-dashoffset:0;stroke:#d62d20;animation:p-progress-spinner-dash 1.5s ease-in-out infinite,p-progress-spinner-color 6s ease-in-out infinite;stroke-linecap:round}@keyframes p-progress-spinner-rotate{to{transform:rotate(360deg)}}@keyframes p-progress-spinner-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35px}to{stroke-dasharray:89,200;stroke-dashoffset:-124px}}@keyframes p-progress-spinner-color{to,0%{stroke:#d62d20}40%{stroke:#0057e7}66%{stroke:#008744}80%,90%{stroke:#ffa700}}\n'],encapsulation:2,changeDetection:0}),t})(),I0=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();const Ote=function(t){return{height:t}},Lte=function(){return{width:"200px",height:"200px"}};let zd=(()=>{class t{constructor(){this.component=!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["app-loader"]],inputs:{component:"component"},decls:6,vars:6,consts:[[2,"width","100%",3,"ngStyle"],[1,"flex","align-items-center","align-content-center","justify-content-center","w-full","h-full"],[1,"frostedBackground","align-items-center","align-content-center","justify-content-center","border-round-xl","window-width",2,"display","grid","transition","var(--transition)"],["strokeWidth","3",1,"text-center"],[1,"mx-auto","text-center"]],template:function(e,o){1&e&&(P(0,"div",0)(1,"div",1)(2,"div",2),Ae(3,"p-progressSpinner",3),P(4,"p",4),ie(5,"Cargando..."),N()()()()),2&e&&(L("ngStyle",Wt(3,Ote,o.component?"100%":"100vh")),F(3),Io(Kn(5,Lte)))},dependencies:[ho,Mu],styles:["[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:var(--primary-color)!important}"]}),t})();function Rte(t,n){if(1&t&&(P(0,"div",2)(1,"h1",3),ie(2),N()()),2&t){const e=U();F(2),jn(" ",e.appLayout.currentRoute," ")}}function Fte(t,n){1&t&&(P(0,"div",25)(1,"span",26),ie(2,"Introduzca un nombre de usuario"),N()())}function Nte(t,n){if(1&t){const e=Ye();P(0,"app-friends-table",27),Te("newFriend",function(r){return be(e),ve(U(2).addNewFriend(r))}),N()}if(2&t){const e=U(2);L("@onEnterDisolve",void 0)("searchedUsers",e.users)("loading",e.searching)}}const zte=function(t,n){return{"elastic-height":t,"elastic-height-active":n}};function Bte(t,n){if(1&t){const e=Ye();P(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"section",8)(5,"div",9)(6,"h1",10),ie(7," Buscar amigos"),N(),P(8,"h3",11),ie(9," Tus vibes suenan mejor con amigos"),N(),P(10,"h3",12),ie(11," B\xfascalos aqu\xed"),N(),P(12,"form",13),Te("ngSubmit",function(){be(e);const r=U();return ve(r.onSubmit(r.searchForm))}),P(13,"div",14)(14,"span",15),Ae(15,"i",16),N(),Ae(16,"input",17)(17,"button",18),N(),W(18,Fte,3,0,"div",19),N()()()(),P(19,"div",20),Ae(20,"img",21),N()()(),P(21,"div",22),W(22,Nte,1,3,"app-friends-table",23),N(),Ae(23,"app-friends-carousel",24),N()}if(2&t){const e=U();let o;F(12),L("formGroup",e.searchForm),F(5),L("disabled",!e.searchForm.valid),F(1),L("ngIf",(null==(o=e.searchForm.get("nickname"))?null:o.hasError("required"))&&(e.searchForm.controls.nickname.dirty||e.searchForm.controls.nickname.touched)),F(2),Ai("src",e.image,Ui),F(1),L("ngClass",Ji(7,zte,!e.showFriendsTable,e.showFriendsTable)),F(1),L("ngIf",e.showFriendsTable),F(1),L("friends",e.friends)}}function Vte(t,n){1&t&&(P(0,"div",4),Ae(1,"app-loader"),N())}let Ute=(()=>{class t{constructor(e,o,r,s){this.appLayout=e,this.friendsService=o,this.usersService=r,this.titleService=s,this.pageLoading=!0,this.searching=!1,this.showFriendsTable=!1,this.searchForm=new Qs({}),this.titleService.setTitle("Amigos | Spotivibes"),this.users=new Array,this.friends=new Array}ngOnInit(){this.searchForm=new Qs({nickname:new Sr(this.nickname,[pr.required])}),this.image=this.getImage(),this.getFriends()}onSubmit(e){var o=this;return Ft(function*(){if(e.valid){o.searching=!0,o.showFriendsTable=!0;try{var r=yield o.usersService.searchUsers(e.value.nickname);o.users=r.users,o.searching=!1}catch(s){403==s.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.response.data.status})}}})()}addNewFriend(e){this.friends.push(e)}getImage(){return"assets/images/"+Math.floor(5*Math.random())+".jpg"}getFriends(){var e=this;return Ft(function*(){try{const o=yield e.friendsService.getFriends();e.friends=o.friends,e.pageLoading=!1}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.response.data.status})}})()}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(Py),ce(Mg),ce(_c))},t.\u0275cmp=Qt({type:t,selectors:[["app-friends"]],decls:3,vars:3,consts:[["class","route-name",4,"ngIf"],["class","content",4,"ngIf"],[1,"route-name"],[1,"current-route"],[1,"content"],[1,"card","w-full","container-image"],[1,"grid","grid-nogutter","min-height"],[1,"col-12","lg:col-6","p-5","flex","align-items-center"],[1,"h-14rem","grid","w-full","m-0"],[1,"w-full","text-aligment"],[1,"mt-0","mb-2","text-gradient","w-fit","margin-text-gradient","search-friends-text"],[1,"mt-0","mb-2","font-semibold"],[1,"mt-0","mb-4","font-light","text-base"],[2,"max-width","600px",3,"formGroup","ngSubmit"],[1,"p-inputgroup"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-users"],["id","nickname","name","nickname","formControlName","nickname","placeholder","Nombre de usuario","type","text","pInputText","",1,"form-control","h-3rem"],["type","submit","pButton","","pRipple","","icon","pi pi-search","styleClass","p-button-danger",1,"button-gradient-45","w-3rem",2,"border-top-left-radius","0 !important","border-bottom-left-radius","0 !important",3,"disabled"],["class","mb-2 flex",4,"ngIf"],[1,"col-12","lg:col-6","overflow-hidden"],["alt","Spotivibes",1,"md:ml-auto","block","h-full","w-full","poligon-clip",2,"object-fit","cover",3,"src"],[3,"ngClass"],[3,"searchedUsers","loading","newFriend",4,"ngIf"],[3,"friends"],[1,"mb-2","flex"],[1,"text-base","mt-2",2,"color","var(--validationErrors)"],[3,"searchedUsers","loading","newFriend"]],template:function(e,o){1&e&&(W(0,Rte,3,1,"div",0),W(1,Bte,24,10,"div",1),W(2,Vte,2,0,"div",1)),2&e&&(L("ngIf",!o.appLayout.showBar),F(1),L("ngIf",!o.pageLoading),F(1),L("ngIf",o.pageLoading))},dependencies:[ao,Xn,Dd,yc,$a,Ed,vc,Md,Dr,_l,tte,cN,zd],styles:["[_nghost-%COMP%]{width:100%}.poligon-clip[_ngcontent-%COMP%]{transition:var(--transition);clip-path:polygon(15% 0,100% 0,100% 100%,0 100%);border-top-right-radius:10px;border-bottom-right-radius:10px}.container-image[_ngcontent-%COMP%]{transition:var(--transition);border-radius:10px;background-color:var(--containerBackground);margin-bottom:3rem}.elastic-height[_ngcontent-%COMP%]{transition:var(--transition);transition:all 3s;max-height:0px}.elastic-height-active[_ngcontent-%COMP%]{transition:all 3s;max-height:5000px}.min-height[_ngcontent-%COMP%]{min-height:500px}.text-aligment[_ngcontent-%COMP%]{text-align:left}.search-friends-text[_ngcontent-%COMP%]{transition:var(--transition);font-size:3rem}@media (max-width: 1200px){.container-image[_ngcontent-%COMP%]{margin-bottom:1.5rem}}@media (max-width: 900px){.container-image[_ngcontent-%COMP%]{margin-bottom:16px}}@media (max-width: 991px){.poligon-clip[_ngcontent-%COMP%]{clip-path:polygon(0 0,100% 0,100% 100%,0 100%);border-top-right-radius:0;border-bottom-right-radius:10px;border-bottom-left-radius:10px}.min-height[_ngcontent-%COMP%]{min-height:300px}.text-aligment[_ngcontent-%COMP%]{text-align:center}.margin-text-gradient[_ngcontent-%COMP%]{margin:auto!important;margin-bottom:.5rem!important}.search-friends-text[_ngcontent-%COMP%]{transition:var(--transition);font-size:2.5rem}}"],data:{animation:[pl("onEnterDisolve",[qo(":enter",[po({opacity:0,animation:"disolve 0.8s"}),$o(1e3)])])]}}),t})(),ku=(()=>{class t{constructor(){}getPlaylists(){return Ft(function*(){const o=Qn_server+"/users/me/playlists",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}getPlaylistsById(e){return Ft(function*(){const r=Qn_server+"/users/"+e+"/playlists",s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}addToPlaylist(e,o){return Ft(function*(){const s=Qn_server+"/playlists/"+e+"/vibes/"+o,l={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.post(s,"",l)).data}catch(f){throw f.response}})()}createPlaylist(e){return Ft(function*(){const r=Qn_server+"/playlists",s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}},l={name:e.name,description:e.description,vibesIds:e.vibesIds};try{return(yield ui.post(r,l,s)).data}catch(h){throw h.response}})()}getPlaylist(e){return Ft(function*(){const r=Qn_server+"/playlists/"+e,s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}commentPlaylist(e,o){return Ft(function*(){const s=Qn_server+"/playlists/"+e+"/comments",l={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken"),Accept:"application/json"}},h={description:o};try{return(yield ui.post(s,h,l)).data}catch(f){throw f.response}})()}getComments(e){return Ft(function*(){var r=Qn_server+"/playlists/"+e+"/comments";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}deleteVibeFromPlaylist(e,o){return Ft(function*(){var s=Qn_server+"/playlists/"+e+"/vibes/"+o;const l={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.delete(s,l)).data}catch(h){throw h.response}})()}updatePlaylist(e,o,r){return Ft(function*(){const l=Qn_server+"/playlists/"+e,h={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}},f={name:o,description:r};try{return(yield ui.put(l,f,h)).data}catch(y){throw y.response}})()}deletePlaylist(e){return Ft(function*(){var r=Qn_server+"/playlists/"+e;const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.delete(r,s)).data}catch(l){throw l.response}})()}likePlaylist(e){return Ft(function*(){var r=Qn_server+"/playlists/"+e+"/like";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.put(r,"",s)).data}catch(h){throw h.response}})()}dislikePlaylist(e){return Ft(function*(){var r=Qn_server+"/playlists/"+e+"/dislike";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.put(r,"",s)).data}catch(h){throw h.response}})()}followPlaylist(e){return Ft(function*(){const r=Qn_server+"/playlists/"+e+"/followers",s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.put(r,"",s)).data}catch(h){throw h.response}})()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();let uN=(()=>{class t{constructor(){}getNotifications(){return Ft(function*(){var o=Qn_server+"/users/me/notifications?userId=2kymupyc98e";const r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}getActivity(){return Ft(function*(){var o=Qn_server+"/users/me/activity";const r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Oy=(()=>{class t{constructor(){}searchSong(e){return Ft(function*(){var r=Qn_server+"/vibes/songs/search";r+="?input="+e;const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}getLocationName(e,o){return Ft(function*(){try{const s=yield(yield fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e},${o}.json?access_token=${Qn_mapboxKey}`)).json();return s.features[0].text+", "+s.features[0].context.find(f=>f.id.includes("country")).text}catch(r){throw r}})()}createVibe(e){return Ft(function*(){var r=Qn_server+"/vibes";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.post(r,e,s)).data}catch(l){throw l.response}})()}getVibes(e){return Ft(function*(){var r=Qn_server+"/vibes/search";r+="?type="+e+"&latitude=0&longitude=0";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}likeVibe(e){return Ft(function*(){var r=Qn_server+"/vibes/"+e+"/like";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.put(r,"",s)).data}catch(h){throw h.response}})()}dislikeVibe(e){return Ft(function*(){var r=Qn_server+"/vibes/"+e+"/dislike";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.put(r,"",s)).data}catch(h){throw h.response}})()}editVibe(e,o,r,s){return Ft(function*(){const h=Qn_server+"/vibes/"+e,f={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}},y={longitude:o,latitude:r,description:s};try{return(yield ui.put(h,y,f)).data}catch(C){throw C.response}})()}deleteVibe(e){return Ft(function*(){const r=Qn_server+"/vibes/"+e,s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken"),Accept:"application/json"}};try{return(yield ui.delete(r,s)).data}catch(l){throw l.response}})()}commentVibe(e,o){return Ft(function*(){const s=Qn_server+"/vibes/"+e+"/comments",l={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken"),Accept:"application/json"}},h={description:o};try{return(yield ui.post(s,h,l)).data}catch(f){throw f.response}})()}getVibeComments(e){return Ft(function*(){var r=Qn_server+"/vibes/"+e+"/comments";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}getComments(e){return Ft(function*(){var r=Qn_server+"/vibes/"+e+"/comments";const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Wte{constructor(n,e){this._document=e;const o=this._textarea=this._document.createElement("textarea"),r=o.style;r.position="fixed",r.top=r.opacity="0",r.left="-999em",o.setAttribute("aria-hidden","true"),o.value=n,o.readOnly=!0,this._document.body.appendChild(o)}copy(){const n=this._textarea;let e=!1;try{if(n){const o=this._document.activeElement;n.select(),n.setSelectionRange(0,n.value.length),e=this._document.execCommand("copy"),o&&o.focus()}}catch{}return e}destroy(){const n=this._textarea;n&&(n.remove(),this._textarea=void 0)}}let qte=(()=>{class t{constructor(e){this._document=e}copy(e){const o=this.beginCopy(e),r=o.copy();return o.destroy(),r}beginCopy(e){return new Wte(e,this._document)}}return t.\u0275fac=function(e){return new(e||t)(Rt(uo))},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Bd=pt(898),Zte=pt(545);let Kte=(()=>{class t{constructor(e){this.el=e}onkeydown(e){if(!0!==this.pFocusTrapDisabled){e.preventDefault();const o=Ne.getNextFocusableElement(this.el.nativeElement,e.shiftKey);o&&(o.focus(),o.select?.())}}}return t.\u0275fac=function(e){return new(e||t)(ce(gi))},t.\u0275dir=On({type:t,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],hostBindings:function(e,o){1&e&&Te("keydown.tab",function(s){return o.onkeydown(s)})("keydown.shift.tab",function(s){return o.onkeydown(s)})},inputs:{pFocusTrapDisabled:"pFocusTrapDisabled"}}),t})(),Xte=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();const Yte=["titlebar"],Qte=["content"],Jte=["footer"];function ene(t,n){if(1&t){const e=Ye();P(0,"div",11),Te("mousedown",function(r){return be(e),ve(U(3).initResize(r))}),N()}}function tne(t,n){if(1&t&&(P(0,"span",18),ie(1),N()),2&t){const e=U(4);at("id",e.id+"-label"),F(1),Ut(e.header)}}function nne(t,n){1&t&&(P(0,"span",18),ro(1,1),N()),2&t&&at("id",U(4).id+"-label")}function ine(t,n){1&t&&$t(0)}const one=function(){return{"p-dialog-header-icon p-dialog-header-maximize p-link":!0}};function rne(t,n){if(1&t){const e=Ye();P(0,"button",19),Te("click",function(){return be(e),ve(U(4).maximize())})("keydown.enter",function(){return be(e),ve(U(4).maximize())}),Ae(1,"span",20),N()}if(2&t){const e=U(4);L("ngClass",Kn(2,one)),F(1),L("ngClass",e.maximized?e.minimizeIcon:e.maximizeIcon)}}const sne=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function ane(t,n){if(1&t){const e=Ye();P(0,"button",21),Te("click",function(r){return be(e),ve(U(4).close(r))})("keydown.enter",function(r){return be(e),ve(U(4).close(r))}),Ae(1,"span",22),N()}if(2&t){const e=U(4);L("ngClass",Kn(4,sne)),at("aria-label",e.closeAriaLabel)("tabindex",e.closeTabindex),F(1),L("ngClass",e.closeIcon)}}function lne(t,n){if(1&t){const e=Ye();P(0,"div",12,13),Te("mousedown",function(r){return be(e),ve(U(3).initDrag(r))}),W(2,tne,2,2,"span",14),W(3,nne,2,1,"span",14),W(4,ine,1,0,"ng-container",9),P(5,"div",15),W(6,rne,2,3,"button",16),W(7,ane,2,5,"button",17),N()()}if(2&t){const e=U(3);F(2),L("ngIf",!e.headerFacet&&!e.headerTemplate),F(1),L("ngIf",e.headerFacet),F(1),L("ngTemplateOutlet",e.headerTemplate),F(2),L("ngIf",e.maximizable),F(1),L("ngIf",e.closable)}}function cne(t,n){1&t&&$t(0)}function une(t,n){1&t&&$t(0)}function dne(t,n){if(1&t&&(P(0,"div",23,24),ro(2,2),W(3,une,1,0,"ng-container",9),N()),2&t){const e=U(3);F(3),L("ngTemplateOutlet",e.footerTemplate)}}const hne=function(t,n,e,o){return{"p-dialog p-component":!0,"p-dialog-rtl":t,"p-dialog-draggable":n,"p-dialog-resizable":e,"p-dialog-maximized":o}},pne=function(t,n){return{transform:t,transition:n}},fne=function(t){return{value:"visible",params:t}};function mne(t,n){if(1&t){const e=Ye();P(0,"div",3,4),Te("@animation.start",function(r){return be(e),ve(U(2).onAnimationStart(r))})("@animation.done",function(r){return be(e),ve(U(2).onAnimationEnd(r))}),W(2,ene,1,0,"div",5),W(3,lne,8,5,"div",6),P(4,"div",7,8),ro(6),W(7,cne,1,0,"ng-container",9),N(),W(8,dne,4,1,"div",10),N()}if(2&t){const e=U(2);Zn(e.styleClass),L("ngClass",vu(15,hne,e.rtl,e.draggable,e.resizable,e.maximized))("ngStyle",e.style)("pFocusTrapDisabled",!1===e.focusTrap)("@animation",Wt(23,fne,Ji(20,pne,e.transformOptions,e.transitionOptions))),at("aria-labelledby",e.id+"-label"),F(2),L("ngIf",e.resizable),F(1),L("ngIf",e.showHeader),F(1),Zn(e.contentStyleClass),L("ngClass","p-dialog-content")("ngStyle",e.contentStyle),F(3),L("ngTemplateOutlet",e.contentTemplate),F(1),L("ngIf",e.footerFacet||e.footerTemplate)}}const gne=function(t,n,e,o,r,s,l,h,f,y){return{"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":t,"p-dialog-mask-scrollblocker":n,"p-dialog-left":e,"p-dialog-right":o,"p-dialog-top":r,"p-dialog-top-left":s,"p-dialog-top-right":l,"p-dialog-bottom":h,"p-dialog-bottom-left":f,"p-dialog-bottom-right":y}};function _ne(t,n){if(1&t&&(P(0,"div",1),W(1,mne,9,25,"div",2),N()),2&t){const e=U();Zn(e.maskStyleClass),L("ngClass",hE(4,gne,[e.modal,e.modal||e.blockScroll,"left"===e.position,"right"===e.position,"top"===e.position,"topleft"===e.position||"top-left"===e.position,"topright"===e.position||"top-right"===e.position,"bottom"===e.position,"bottomleft"===e.position||"bottom-left"===e.position,"bottomright"===e.position||"bottom-right"===e.position])),F(1),L("ngIf",e.visible)}}const yne=["*",[["p-header"]],[["p-footer"]]],vne=["*","p-header","p-footer"],bne=If([po({transform:"{{transform}}",opacity:0}),$o("{{transition}}")]),xne=If([$o("{{transition}}",po({transform:"{{transform}}",opacity:0}))]);let jl=(()=>{class t{constructor(e,o,r,s,l){this.el=e,this.renderer=o,this.zone=r,this.cd=s,this.config=l,this.draggable=!0,this.resizable=!0,this.closeOnEscape=!0,this.closable=!0,this.showHeader=!0,this.blockScroll=!1,this.autoZIndex=!0,this.baseZIndex=0,this.minX=0,this.minY=0,this.focusOnShow=!0,this.keepInViewport=!0,this.focusTrap=!0,this.transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)",this.closeIcon="pi pi-times",this.closeTabindex="-1",this.minimizeIcon="pi pi-window-minimize",this.maximizeIcon="pi pi-window-maximize",this.onShow=new ht,this.onHide=new ht,this.visibleChange=new ht,this.onResizeInit=new ht,this.onResizeEnd=new ht,this.onDragEnd=new ht,this.onMaximize=new ht,this.id=Ig(),this._style={},this._position="center",this.transformOptions="scale(0.7)"}get positionLeft(){return 0}set positionLeft(e){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(e){console.log("positionTop property is deprecated.")}get responsive(){return!1}set responsive(e){console.log("Responsive property is deprecated.")}get breakpoint(){return 649}set breakpoint(e){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"content":default:this.contentTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngOnInit(){this.breakpoints&&this.createStyle()}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(e){e&&(this._style={...e},this.originalStyle=e)}get position(){return this._position}set position(e){switch(this._position=e,e){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}focus(){let e=Ne.findSingle(this.container,"[autofocus]");e&&this.zone.runOutsideAngular(()=>{setTimeout(()=>e.focus(),5)})}close(e){this.visibleChange.emit(!1),e.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.close(e)})),this.modal&&Ne.addClass(document.body,"p-overflow-hidden")}disableModality(){this.wrapper&&(this.dismissableMask&&this.unbindMaskClickListener(),this.modal&&Ne.removeClass(document.body,"p-overflow-hidden"),this.cd.destroyed||this.cd.detectChanges())}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?Ne.addClass(document.body,"p-overflow-hidden"):Ne.removeClass(document.body,"p-overflow-hidden")),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(Ir.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if(!this.styleElement){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement);let e="";for(let o in this.breakpoints)e+=`\n                    @media screen and (max-width: ${o}) {\n                        .p-dialog[${this.id}] {\n                            width: ${this.breakpoints[o]} !important;\n                        }\n                    }\n                `;this.styleElement.innerHTML=e}}initDrag(e){Ne.hasClass(e.target,"p-dialog-header-icon")||Ne.hasClass(e.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,this.container.style.margin="0",Ne.addClass(document.body,"p-unselectable-text"))}onKeydown(e){if(this.focusTrap&&9===e.which){e.preventDefault();let o=Ne.getFocusableElements(this.container);if(o&&o.length>0)if(o[0].ownerDocument.activeElement){let r=o.indexOf(o[0].ownerDocument.activeElement);e.shiftKey?-1==r||0===r?o[o.length-1].focus():o[r-1].focus():-1==r||r===o.length-1?o[0].focus():o[r+1].focus()}else o[0].focus()}}onDrag(e){if(this.dragging){let o=Ne.getOuterWidth(this.container),r=Ne.getOuterHeight(this.container),s=e.pageX-this.lastPageX,l=e.pageY-this.lastPageY,h=this.container.getBoundingClientRect(),f=h.left+s,y=h.top+l,C=Ne.getViewport();this.container.style.position="fixed",this.keepInViewport?(f>=this.minX&&f+o<C.width&&(this._style.left=f+"px",this.lastPageX=e.pageX,this.container.style.left=f+"px"),y>=this.minY&&y+r<C.height&&(this._style.top=y+"px",this.lastPageY=e.pageY,this.container.style.top=y+"px")):(this.lastPageX=e.pageX,this.container.style.left=f+"px",this.lastPageY=e.pageY,this.container.style.top=y+"px")}}endDrag(e){this.dragging&&(this.dragging=!1,Ne.removeClass(document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(e))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(e){this.resizable&&(this.resizing=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,Ne.addClass(document.body,"p-unselectable-text"),this.onResizeInit.emit(e))}onResize(e){if(this.resizing){let o=e.pageX-this.lastPageX,r=e.pageY-this.lastPageY,s=Ne.getOuterWidth(this.container),l=Ne.getOuterHeight(this.container),h=Ne.getOuterHeight(this.contentViewChild.nativeElement),f=s+o,y=l+r,C=this.container.style.minWidth,D=this.container.style.minHeight,R=this.container.getBoundingClientRect(),V=Ne.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(f+=o,y+=r),(!C||f>parseInt(C))&&R.left+f<V.width&&(this._style.width=f+"px",this.container.style.width=this._style.width),(!D||y>parseInt(D))&&R.top+y<V.height&&(this.contentViewChild.nativeElement.style.height=h+y-l+"px",this._style.height&&(this._style.height=y+"px",this.container.style.height=this._style.height)),this.lastPageX=e.pageX,this.lastPageY=e.pageY}}resizeEnd(e){this.resizing&&(this.resizing=!1,Ne.removeClass(document.body,"p-unselectable-text"),this.onResizeEnd.emit(e))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.zone.runOutsideAngular(()=>{this.documentDragListener=this.onDrag.bind(this),window.document.addEventListener("mousemove",this.documentDragListener)})}unbindDocumentDragListener(){this.documentDragListener&&(window.document.removeEventListener("mousemove",this.documentDragListener),this.documentDragListener=null)}bindDocumentDragEndListener(){this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.endDrag.bind(this),window.document.addEventListener("mouseup",this.documentDragEndListener)})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(window.document.removeEventListener("mouseup",this.documentDragEndListener),this.documentDragEndListener=null)}bindDocumentResizeListeners(){this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.onResize.bind(this),this.documentResizeEndListener=this.resizeEnd.bind(this),window.document.addEventListener("mousemove",this.documentResizeListener),window.document.addEventListener("mouseup",this.documentResizeEndListener)})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(window.document.removeEventListener("mousemove",this.documentResizeListener),window.document.removeEventListener("mouseup",this.documentResizeEndListener),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",o=>{27==o.which&&this.close(o)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.wrapper):Ne.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.wrapper=this.container.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&Ne.addClass(document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&Ne.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(e){switch(e.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({})}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(Ne.removeClass(document.body,"p-overflow-hidden"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&Ne.removeClass(document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&Ir.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?{...this.originalStyle}:{}}destroyStyle(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Jr),ce(yi),ce(Fo),ce(fl))},t.\u0275cmp=Qt({type:t,selectors:[["p-dialog"]],contentQueries:function(e,o,r){if(1&e&&(Bo(r,Q2,5),Bo(r,vC,5),Bo(r,fo,4)),2&e){let s;gn(s=_n())&&(o.headerFacet=s.first),gn(s=_n())&&(o.footerFacet=s.first),gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(Yte,5),pi(Qte,5),pi(Jte,5)),2&e){let r;gn(r=_n())&&(o.headerViewChild=r.first),gn(r=_n())&&(o.contentViewChild=r.first),gn(r=_n())&&(o.footerViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:"draggable",resizable:"resizable",positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:"modal",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",rtl:"rtl",closable:"closable",responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",showHeader:"showHeader",breakpoint:"breakpoint",blockScroll:"blockScroll",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",minX:"minX",minY:"minY",focusOnShow:"focusOnShow",maximizable:"maximizable",keepInViewport:"keepInViewport",focusTrap:"focusTrap",transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},ngContentSelectors:vne,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],["container",""],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["content",""],[4,"ngTemplateOutlet"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["titlebar",""],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],["type","button","pRipple","",3,"ngClass","click","keydown.enter"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"],["footer",""]],template:function(e,o){1&e&&(hr(yne),W(0,_ne,2,15,"div",0)),2&e&&L("ngIf",o.maskVisible)},dependencies:[ao,Xn,Cs,ho,Kte,Iu],styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[pl("animation",[qo("void => visible",[yy(bne)]),qo("visible => void",[yy(xne)])])]},changeDetection:0}),t})(),Ly=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Xte,ml,hs]}),t})();function wne(t,n){1&t&&(P(0,"div",12)(1,"h2",13),ie(2,"A\xf1adir a playlist"),N()())}function Cne(t,n){if(1&t&&(P(0,"div",15)(1,"div"),ie(2),N()()),2&t){const e=U(2);F(2),Ut(e.selectedPlaylist.name)}}function Tne(t,n){1&t&&W(0,Cne,3,1,"div",14),2&t&&L("ngIf",U().selectedPlaylist)}function Sne(t,n){1&t&&Ae(0,"p-progressSpinner",16)}const Ene=function(){return{width:"600px",transition:"all 500ms"}},Ine=function(){return{"650px":"95vw"}};let dN=(()=>{class t{constructor(e,o){this.appLayout=e,this.playlistsService=o,this.hide=new ht,this.showAddToPlaylistDialog=new ht,this.loadingPLaylist=!1,this.uploadingPlaylist="A\xf1adir a playlist",this.uploading=!1,this.deletedPlaylist=new Array,this.playlists=new Array}onCancel(){this.loadingPLaylist=!1,this.uploadingPlaylist="A\xf1adir a playlist",this.playlists=this.playlists.concat(this.deletedPlaylist),this.deletedPlaylist=new Array,this.uploading=!1,this.hide.emit(!1)}onCreate(e){this.onCancel(),this.showAddToPlaylistDialog.emit(e)}checkPlaylist(){this.playlists.forEach(e=>{e.vibesIds.includes(this.vibeId)&&(this.deletedPlaylist.push(e),this.playlists=this.playlists.filter(o=>o!==e))})}addToPlaylist(e,o){var r=this;return Ft(function*(){r.loadingPLaylist=!0,r.uploadingPlaylist="A\xf1adiendo a playlist...",r.uploading=!0;try{yield r.playlistsService.addToPlaylist(e,o),r.onCancel()}catch(s){403==s.status?r.appLayout.handle403Error():r.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.data.status})}})()}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(ku))},t.\u0275cmp=Qt({type:t,selectors:[["app-add-to-playlist-dialog"]],inputs:{display:"display",vibeId:"vibeId",playlists:"playlists"},outputs:{hide:"hide",showAddToPlaylistDialog:"showAddToPlaylistDialog"},decls:21,vars:16,consts:[[3,"visible","closable","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[1,""],[1,"mt-3"],["optionLabel","name","filterBy","name","emptyMessage","Ning\xfan resultado","emptyFilterMessage","Ning\xfan resultado","placeholder","Selecciona una Playlist",3,"options","ngModel","filter","showClear","ngModelChange","click"],["pTemplate","selectedItem"],["pButton","","pRipple","",1,"mt-4","mb-3","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],[1,"vibe-btn-text-white","w-full"],["pButton","","pRipple","",1,"mt-3","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"],["class","country-item country-item-value",4,"ngIf"],[1,"country-item","country-item-value"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"]],template:function(e,o){1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s})("onHide",function(){return o.onCancel()}),W(1,wne,3,0,"ng-template",1),P(2,"div",2)(3,"label"),ie(4,"A\xf1ade el vibe a una playlist existente:"),N(),P(5,"div",3)(6,"p-dropdown",4),Te("ngModelChange",function(s){return o.selectedPlaylist=s})("click",function(){return o.checkPlaylist()}),W(7,Tne,1,1,"ng-template",5),N()(),P(8,"button",6),Te("click",function(){return o.addToPlaylist(o.selectedPlaylist.playlistId,o.vibeId)}),P(9,"div",7)(10,"span",8),W(11,Sne,1,0,"p-progressSpinner",9),P(12,"p",10),ie(13),N()()()(),P(14,"label"),ie(15,"O crea una nueva playlist:"),N(),P(16,"button",11),Te("click",function(){return o.onCreate(o.vibeId)}),P(17,"div",7)(18,"span",8)(19,"p",10),ie(20," Crear nueva playlist "),N()()()()()()),2&e&&(Io(Kn(14,Ene)),L("visible",o.display)("closable",!o.uploading)("modal",!0)("draggable",!1)("breakpoints",Kn(15,Ine)),F(6),L("options",o.playlists)("ngModel",o.selectedPlaylist)("filter",!0)("showClear",!0),F(2),L("disabled",null==o.selectedPlaylist||o.uploading),F(3),L("ngIf",o.loadingPLaylist),F(2),jn(" ",o.uploadingPlaylist,""))},dependencies:[Xn,gD,fo,jl,$a,Id,Dr,Mu],styles:["[_nghost-%COMP%]     .p-dialog-content{overflow:visible}[_nghost-%COMP%]     .p-dropdown{width:100%}[_nghost-%COMP%]     .p-component{width:100%!important}[_nghost-%COMP%]     .p-overlay-content{width:100%}[_nghost-%COMP%]     .p-dropdown-panel{display:block!important}[_nghost-%COMP%]     .p-dropdown-label{width:100%}[_nghost-%COMP%]     .p-dropdown-panel{border-radius:10px!important}[_nghost-%COMP%]     .p-dropdown-filter{border-radius:10px!important}[_nghost-%COMP%]     .p-dropdown{border-radius:10px!important}[_nghost-%COMP%]     .p-button:last-of-type{border-radius:10px!important}p[_ngcontent-%COMP%]{margin:0}  .p-progress-spinner-circle{stroke:#fff!important}"]}),t})();function kne(t,n){if(1&t&&Ae(0,"img",19),2&t){const e=U().$implicit;Ai("src",e.userProfileImage,Ui),Ai("alt",e.userName)}}function Ane(t,n){1&t&&Ae(0,"img",20)}function Pne(t,n){if(1&t&&(P(0,"div",12)(1,"div",13)(2,"div",4),W(3,kne,1,2,"img",14),W(4,Ane,1,0,"img",6),N(),P(5,"div",7)(6,"div",15)(7,"div",16),ie(8),N(),P(9,"div",17),ie(10),wo(11,"date"),wo(12,"date"),N()(),P(13,"p",18),ie(14),N()()()()),2&t){const e=n.$implicit;F(3),L("ngIf",""!=e.userProfileImage),F(1),L("ngIf",""==e.userProfileImage),F(4),jn(" ",e.userName,"\xa0 "),F(2),vf(" ",zl(11,6,e.commentDate,"dd/MM/yyyy")," \xb7 ",zl(12,9,e.commentDate,"HH:mm:ss")," "),F(4),Ut(e.description)}}function One(t,n){if(1&t&&(P(0,"div",23)(1,"div",24)(2,"h1",25),ie(3),N(),P(4,"p",26),ie(5,"No hay comentarios"),N()()()),2&t){const e=U(2);F(3),Ut(e.textEmpty)}}function Lne(t,n){if(1&t&&(P(0,"div",21),W(1,One,6,1,"div",22),N()),2&t){const e=U();F(1),L("ngIf",0==e.comments.length)}}function Rne(t,n){if(1&t&&Ae(0,"img",27),2&t){const e=U();Ai("src",e.appLayout.user.profileImage,Ui),Ai("alt",e.appLayout.user.name)}}function Fne(t,n){1&t&&Ae(0,"img",20)}let hN=(()=>{class t{constructor(e,o,r){this.appLayout=e,this.playlistService=o,this.vibesService=r,this.numComments=new ht,this.newComment="",this.sendingComment=!1,this.textEmpty="",this.user=new bC,this.comments=new Array}ngOnInit(){this.textEmpty=this.getRandomText()}sendComment(){var e=this;return Ft(function*(){e.sendingComment=!0;var o=e.playlistId;if(null!=e.vibeId&&(o=e.vibeId),null!=e.vibeId)try{yield e.vibesService.commentVibe(o,e.newComment),e.addComment(o)}catch(r){403==r.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}else try{yield e.playlistService.commentPlaylist(o,e.newComment),e.addComment(o)}catch(r){403==r.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}})()}addComment(e){const o=document.getElementById("chat");var r=new Date;try{this.comments.push({userId:this.appLayout.user.userId,userName:this.appLayout.user.name,userProfileImage:this.appLayout.user.profileImage,commentDate:r.toISOString(),description:this.newComment})}catch(l){403==l.status?this.appLayout.handle403Error():this.appLayout.messageService.add({severity:"error",summary:"Error",detail:l.data.status})}this.newComment="",this.sendingComment=!1;var s=new class Dne{};s.id=e,s.numComments=this.comments.length,this.numComments.emit(s),setTimeout(()=>{o.scroll({top:o.scrollHeight,behavior:"smooth"})},1)}getRandomText(){const R=["(='X'=)","(='.'=)","(-_-)","(^_^)","(\u2265o\u2264)","(\xac_\xac)","(\xac\u203f\xac)","(o_o)/","(\xb0_\xb0)","(\xb0o\xb0)"];return R[Math.floor(Math.random()*R.length)]}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(ku),ce(Oy))},t.\u0275cmp=Qt({type:t,selectors:[["app-comments"]],inputs:{playlistId:"playlistId",vibeId:"vibeId",comments:"comments"},outputs:{numComments:"numComments"},decls:12,vars:6,consts:[["id","chat",1,"h-20rem",2,"overflow-y","scroll","overflow-x","hidden"],["id","message","key","index",4,"ngFor","ngForOf"],["class","h-full",4,"ngIf"],[1,"flex","text-center","align-content-center","align-items-center","mt-4","p-1"],[1,"image-column"],["class","round-images round-images-size",3,"src","alt",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","alt","placeholder","class","round-images round-images-size","style","background: var(--containerBackground);",4,"ngIf"],[1,"text-column"],[1,"flex","font-bold","w-full","relative"],["id","name","name","name","placeholder","Comentario","type","text","pInputText","",1,"w-full",2,"height","50px",3,"ngModel","ngModelChange"],[1,"absolute","image-column",2,"width","35px","right","9px"],["pButton","","icon","pi pi-send","type","button",1,"p-button-raised","p-button-text","round-button",2,"width","100%",3,"disabled","click"],["id","message","key","index"],[1,"activity-container","mt-3","p-1"],["class","round-images round-images-size","style","box-shadow: 0px 1px 5px 0px rgba(0,0,0,0.2);",3,"src","alt",4,"ngIf"],[1,"comment-header"],[1,"comment-header","font-bold","mb-1",2,"color","var(--fontColor)"],[1,"comment-header","text-600","font-normal"],[1,"mt-1"],[1,"round-images","round-images-size",2,"box-shadow","0px 1px 5px 0px rgba(0,0,0,0.2)",3,"src","alt"],["src","assets/images/profilePlaceholder.svg","alt","placeholder",1,"round-images","round-images-size",2,"background","var(--containerBackground)"],[1,"h-full"],["class","h-full flex align-content-center justify-content-center align-items-center",4,"ngIf"],[1,"h-full","flex","align-content-center","justify-content-center","align-items-center"],[1,"flex-column","align-content-center","justify-content-center","align-items-center"],[1,"text-center","mb-2","text-8xl","text-500"],[1,"mt-3","text-center","text-lg","text-500"],[1,"round-images","round-images-size",3,"src","alt"]],template:function(e,o){1&e&&(P(0,"div",0),W(1,Pne,15,12,"div",1),W(2,Lne,2,1,"div",2),N(),P(3,"div",3)(4,"div",4),W(5,Rne,1,2,"img",5),W(6,Fne,1,0,"img",6),N(),P(7,"div",7)(8,"div",8)(9,"input",9),Te("ngModelChange",function(s){return o.newComment=s}),N(),P(10,"div",10)(11,"button",11),Te("click",function(){return o.sendComment()}),N()()()()()),2&e&&(F(1),L("ngForOf",o.comments),F(1),L("ngIf",null!=o.comments),F(3),L("ngIf",""!=o.user.profileImage),F(1),L("ngIf",""==o.user.profileImage),F(3),L("ngModel",o.newComment),F(2),L("disabled",""==o.newComment||o.sendingComment))},dependencies:[Ns,Xn,_l,yc,$a,Id,Dr,Ab],styles:["p[_ngcontent-%COMP%]{margin:0}.image-column[_ngcontent-%COMP%]{width:50px;height:100%;align-items:start;right:0;top:7px}.text-column[_ngcontent-%COMP%]{margin-left:1rem;flex-grow:1;width:100%;height:100%;justify-content:center;align-items:start}.activity-container[_ngcontent-%COMP%]{transition:var(--transition);width:100%;display:flex;padding-bottom:1.5rem}.round-button[_ngcontent-%COMP%]{width:35px;height:35px;background:var(--gradient45);border-radius:100px!important;right:0;color:#fff}.round-button[_ngcontent-%COMP%]:hover{background:var(--gradient45Hover)!important;color:#fff!important;cursor:pointer}[_nghost-%COMP%]     .p-inputtext{border-radius:100px!important;padding-left:1rem;padding-right:3rem}.comment-header[_ngcontent-%COMP%]{display:flex}@media (max-width: 500px){.comment-header[_ngcontent-%COMP%]{flex-direction:column}}"]}),t})();function Nne(t,n){1&t&&(P(0,"div",3)(1,"h2",4),ie(2,"Comentarios"),N()())}const zne=function(){return{width:"600px",transition:"all 500ms"}},Bne=function(){return{"650px":"95vw"}};let pN=(()=>{class t{constructor(){this.hide=new ht,this.numComments=new ht}ngOnInit(){}onCancel(){this.hide.emit(!1)}updateNumComments(e){this.numComments.emit(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["app-comments-dialog"]],inputs:{display:"display",playlistId:"playlistId",vibeId:"vibeId",comments:"comments"},outputs:{hide:"hide",numComments:"numComments"},decls:3,vars:11,consts:[[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[3,"playlistId","comments","vibeId","numComments"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"]],template:function(e,o){1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s})("onHide",function(){return o.onCancel()}),W(1,Nne,3,0,"ng-template",1),P(2,"app-comments",2),Te("numComments",function(s){return o.updateNumComments(s)}),N()()),2&e&&(Io(Kn(9,zne)),L("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",Kn(10,Bne)),F(2),L("playlistId",o.playlistId)("comments",o.comments)("vibeId",o.vibeId))},dependencies:[jl,fo,hN]}),t})();const BC=class Vne{constructor(){this.followed=!1}};function Une(t,n){1&t&&(P(0,"div",20)(1,"h2",21),ie(2," Crear playlist "),N()())}function jne(t,n){1&t&&(P(0,"div",22)(1,"span",23),ie(2,"El nombre de la playlist no puede tener m\xe1s de 25 caracteres"),N()())}function Hne(t,n){1&t&&Ae(0,"p-progressSpinner",24)}function $ne(t,n){if(1&t){const e=Ye();P(0,"div",25)(1,"button",26),Te("click",function(){return be(e),ve(U().onCancelSuccess())}),P(2,"div",13)(3,"span",14)(4,"p",16),ie(5,"Aceptar"),N()()()()()}}const Gne=function(){return{width:"700px"}},Wne=function(){return{"700px":"95vw"}},qne=function(t,n){return{"h-410":t,"h-6":n}},Zne=function(){return{width:"500px"}},Kne=function(){return{"500px":"95vw"}};let Xne=(()=>{class t{constructor(e,o){this.playlistsService=e,this.appLayout=o,this.showDialog=new ht,this.buttonTitle="Crear playlist",this.uploadingPlaylist=!1,this.displaySuccess=!1}ngOnInit(){this.searchForm=new Qs({playlistTitle:new Sr(this.playlistTitle,[pr.required,pr.maxLength(25)]),playlistDescription:new Sr(this.playlistDescription,[])})}cancel(){this.buttonTitle="Crear playlist",this.uploadingPlaylist=!1,this.searchForm.reset(),this.showDialog.emit(!1)}onCancelSuccess(){this.displaySuccess=!1}createPlaylist(e){var o=this;return Ft(function*(){o.uploadingPlaylist=!0,o.buttonTitle="Creando playlist...";var r=new BC;r.name=e.value.playlistTitle,r.description=e.value.playlistDescription,r.vibesIds=[o.vibeId];try{yield o.playlistsService.createPlaylist(r),o.cancel(),o.displaySuccess=!0}catch(s){o.buttonTitle="Crear playlist",o.uploadingPlaylist=!1,403==s.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.response.data.status})}})()}}return t.\u0275fac=function(e){return new(e||t)(ce(ku),ce(Zo))},t.\u0275cmp=Qt({type:t,selectors:[["app-new-playlist-dialog-one-vibe"]],inputs:{display:"display",vibeId:"vibeId"},outputs:{showDialog:"showDialog"},decls:27,vars:27,consts:[[3,"visible","closable","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[1,"h-120","pt-2",3,"ngClass"],[1,"flex","justify-content-between","flex-wrap","card-container"],[1,"flex"],[1,"mt-2",2,"margin-bottom","15px"],[3,"formGroup"],[1,"p-inputgroup","h-fit"],["id","playlistTitle","name","playlistTitle","formControlName","playlistTitle","placeholder","Nombre de la playlist","type","text","pInputText","",1,"form-control","h-3rem"],["class","mb-2",4,"ngIf"],[2,"margin-bottom","15px","margin-top","15px"],["id","playlistDescription","name","playlistDescription","formControlName","playlistDescription","placeholder","A\xf1adir descripci\xf3n",1,"w-full","h-10rem","border-none","p-3",2,"resize","none","border-radius","10px","font-family","Lato","color","var(--fontColor)","background","var(--frostedBackground)","outline","0.15rem solid #93cbf9"],["pButton","","pRipple","",1,"mt-4","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"formGroup","disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],[1,"vibe-btn-text-white","w-full"],[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],[1,"text-center"],["pTemplate","footer"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"],[1,"mb-2"],[1,"text-xs",2,"color","var(--validationErrors)"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"],[1,"p-3"],["pButton","","pRipple","","type","submit",1,"p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"]],template:function(e,o){if(1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s})("onHide",function(){return o.cancel()}),W(1,Une,3,0,"ng-template",1),P(2,"div",2)(3,"div",3)(4,"div",4)(5,"div")(6,"p",5),ie(7,"Introduce un t\xedtulo para tu playlist"),N()()()(),P(8,"form",6)(9,"div",7),Ae(10,"input",8),N(),W(11,jne,3,0,"div",9),P(12,"p",10),ie(13,"Introduce una descripci\xf3n para tu playlist"),N(),Ae(14,"textarea",11),N(),P(15,"button",12),Te("click",function(){return o.createPlaylist(o.searchForm)}),P(16,"div",13)(17,"span",14),W(18,Hne,1,0,"p-progressSpinner",15),P(19,"p",16),ie(20),N()()()()()(),P(21,"p-dialog",17),Te("visibleChange",function(s){return o.displaySuccess=s})("onHide",function(){return o.onCancelSuccess()}),P(22,"h3",18),ie(23," \xa1Playlist creada ! "),N(),P(24,"p",18),ie(25," La playlist ha sido creada correctamente con tu vibe "),N(),W(26,$ne,6,0,"ng-template",19),N()),2&e){let r,s;Io(Kn(20,Gne)),L("visible",o.display)("closable",!o.uploadingPlaylist)("modal",!0)("draggable",!1)("breakpoints",Kn(21,Wne)),F(2),L("ngClass",Ji(22,qne,!(null!=(r=o.searchForm.get("playlistTitle"))&&r.hasError("maxlength")),null==(r=o.searchForm.get("playlistTitle"))?null:r.hasError("maxlength"))),F(6),L("formGroup",o.searchForm),F(3),L("ngIf",(null==(s=o.searchForm.get("playlistTitle"))?null:s.hasError("maxlength"))&&(o.searchForm.controls.playlistTitle.dirty||o.searchForm.controls.playlistTitle.touched)),F(4),L("formGroup",o.searchForm)("disabled",!o.searchForm.valid||o.uploadingPlaylist),F(3),L("ngIf",o.uploadingPlaylist),F(2),jn(" ",o.buttonTitle,""),F(1),Io(Kn(25,Zne)),L("visible",o.displaySuccess)("modal",!0)("draggable",!1)("breakpoints",Kn(26,Kne))}},dependencies:[ao,Xn,Dd,yc,$a,Ed,vc,Md,Dr,_l,jl,fo,Mu],styles:[".h-6[_ngcontent-%COMP%]{height:395px!important}"]}),t})(),VC=(()=>{class t{constructor(e,o,r,s){this.appLayout=e,this.vibesService=o,this.confirmationService=r,this.playlistsService=s,this.playlistDetail=!1,this.newVibe=!1,this.map=!1,this.vibesArray=[],this.home=!1,this.deletedVibe=new ht,this.loaded=new ht,this.vibeLocation=new ht,this.playlistToAdd=-1,this.displayDialog=!1,this.displayComments=!1,this.markers={},this.playing="",this.displayNewPlaylistDialog=!1}ngOnInit(){this.initMapEvent.subscribe(()=>{this.initMapbox(this.vibesArray)}),this.appLayout.appComponent.changeThemeEvent.subscribe(e=>{this.mapa.setStyle(e)}),this.appLayout.newVibeAdded.subscribe(e=>{this.createCustomMarkerPopup(e.songPreview,e.spotifySongId,e.spotifyUrl,e.vibeId,e.longitude,e.latitude,e.songName,e.songAuthor,e.songImage,e.userName,e.description,e.creationDate,e.likes.length,e.comments.length,!1,!0)}),this.appLayout.deletedVibeFromPlaylist.subscribe(e=>{const o=this.markers[e];o&&(o.remove(),delete this.markers[e])}),this.appLayout.centerOnMap.subscribe(e=>{this.mapa.flyTo({center:[e[0],e[1]],zoom:15})})}ngAfterViewInit(){if(null!=this.vibe)this.initMapbox([this.vibe]);else if(null!=this.vibesArray)this.initMapbox(this.vibesArray);else{const e=new Array;this.initMapbox(e)}this.getPlaylists()}initMapbox(e){Bd.accessToken=Qn_mapboxKey;var o=-3.7037902,r=40.4167754;if(e.length>0&&(o=e[0].longitude,r=e[0].latitude),this.mapa=new Bd.Map({container:this.id,style:this.appLayout.appComponent.mapStyle,center:[o,r],zoom:this.map?2:11.15,cooperativeGestures:!this.map}),this.showLocationButton&&this.mapa.addControl(new Bd.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),this.showSearchBar){const s=document.createElement("img");s.src="assets/images/spotivibesLogo.png",s.style.width="35px";const l=new Zte({accessToken:Bd.accessToken,placeholder:"Buscar",mapboxgl:Bd,marker:{color:"purple",draggable:!1,element:this.newVibe?s:void 0},enableGeolocation:!0});l.on("result",h=>{this.marker&&this.marker.remove(),this.marker=l.mapMarker,this.vibeLocation.emit([h.result.center[0],h.result.center[1]])}),this.mapa.addControl(l,"top-left")}this.mapa.addControl(new Bd.NavigationControl,"bottom-right"),this.mapa.touchZoomRotate.disableRotation(),this.newVibe||this.mapa.on("load",()=>{for(const h of e){var s=!1;const f=sessionStorage.getItem("userId");f==h.userId&&(s=!0);var l=!1;for(let y=0;y<h.likes.length;y++)if(h.likes[y].userId==f){l=!0;break}this.createCustomMarkerPopup(h.songPreview,h.spotifySongId,h.spotifyUrl,h.vibeId,h.longitude,h.latitude,h.songName,h.songAuthor,h.songImage,h.userName,h.description,h.creationDate,h.likes.length,h.comments.length,l,s)}}),this.newVibe&&this.mapa.on("click",s=>{this.marker&&this.marker.remove();const l=document.createElement("img");l.src="assets/images/spotivibesLogo.png",l.style.width="35px",this.marker=new Bd.Marker({draggable:!1,color:"purple",element:l}).setLngLat([s.lngLat.lng,s.lngLat.lat]).addTo(this.mapa),this.vibeLocation.emit([s.lngLat.lng,s.lngLat.lat])})}setMapStyle(){this.mapa.setStyle(this.appLayout.appComponent.mapStyle)}hideDialogPlaylist(e){this.displayDialog=e}addToPlaylist(e){this.displayDialog=!0,this.addToPlaylistVibeId=e}hideDialogCommnets(e){this.displayComments=e}createCustomMarkerPopup(e,o,r,s,l,h,f,y,C,D,R,V,$,X,ee,ue){var fe=this;V=new Date(V).toLocaleDateString(),f=f.length>30?f.substring(0,30)+"...":f,y=y.length>30?y.substring(0,30)+"...":y;const _e=new Bd.Popup({offset:25}).setHTML(`\n      <div class="image-icons w-full">\n        <div class="flex h-auto" style="width: auto">\n          \x3c!--BIG SCREEN--\x3e\n          <div class="image-icons" style="height: fit-content">\n            <div class="relative image-size-popup m-auto" style="background-size: 100% 100% !important; border-radius: 5px; background: var(--gradient), url('${C}') no-repeat; box-shadow: var(--shadowsMapBtn); object-fit: cover;">\n              <div class=" absolute" style="bottom: 10px; left: 10px; ">\n                <h2 id="song-title" class="hide-title text-white text-2xl font-bold" style="line-height: initial;">${f}</h2>\n                <h2 class="show-title text-white text-sm font-bold" style="line-height: initial;">${f}</h2>\n                <h4 class="text-white" style="font-weight: normal; margin-top: 5px;">${y}</h4>\n                <div class="flex mt-2">\n                  <div id="like-${s}" class="align-items-center hover-icon-spoty text-white mr-2" style="display: flex; font-weight: normal">\n                    <img src="assets/icons/like-color.svg" style="height: 20px; width: 20px; margin-right: 5px;">\n                    <span id="num-likes-${s}">${$}</span>\n                  </div>\n\n                  <div id="like-outline-${s}" class="align-items-center hover-icon-spoty text-white mr-2" style="display: flex; font-weight: normal">\n                    <img src="assets/icons/like-color-outline.svg" style="height: 20px; width: 20px; margin-right: 5px;">\n                    <span id="num-likes-outline-${s}">${$}</span>\n                  </div>\n \n                  <div id="comments-${s}" class="flex align-items-center hover-icon mr-2" style="font-weight: normal;">\n                    <img class="text-white" src="assets/icons/chat.svg" style="height: 20px; width: 20px; margin-right: 5px; filter: invert(100) sepia(100) saturate(0) brightness(100);">\n                    <span id="num-comments-${s}" class="text-white">${X}</span>\n                  </div>\n                  <div id="spotify-${s}" class="flex align-items-center hover-icon-spoty" style="font-weight: normal;">\n                    <img class="text-white" src="assets/icons/spotify.svg" style="height: 20px; width: 20px; margin-right: 5px; filter: invert(100) sepia(100) saturate(89) brightness(100) hue-rotate(50deg)">\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n        </div>\n        <div class="flex h-auto margin-card-popup " style="flex-direction: column">\n          \x3c!--SMALL SCREEN--\x3e\n          <h4 class="show-title text-popup padding-popup-close mt-2" style="max-width: 240px; font-weight: normal; margin-top: 5px">${D}</h4>\n\n          \x3c!--BIG SCREEN--\x3e\n          <h4 class="hide-title text-popup padding-popup-close" style="max-width: 240px; font-weight: normal; margin-top: 5px">${D}</h4>\n          <span class="text-popup text-600">${V}</span>\n          \n          <h5 class="text-popup mb-4" id="description-${s}" style="max-width: 280px; min-width: 180px; font-weight: normal; font-style: italic; margin-top: 5px; margin-bottom: 10px; font-size: 0.8rem ">${null!=R?'"'+R+'"':"Vibe sin descripci\xf3n"}</h5>\n\n          <textarea class="text-popup border-1 map-text-area" id="descriptionEdit-${s}" rows="5" style="resize: none; margin-top: 5px; display: none; font-family: Lato; font-family: Lato; border-radius: 7px; background: var(--frostedBackground)">${R}</textarea>\n          <div class="flex flex-row center-butttons" style="margin-top: auto">\n            \n            \x3c!--<div id="spotify-${s}" class="flex spoty-button align-items-center justify-content-center">\n              <img class="flex justify-content-center" src="assets/icons/spotify.svg" style="display: flex; width: 23px; height: 23px; filter: invert(100) sepia(100) saturate(89) brightness(100) hue-rotate(50deg)">\n            </div>--\x3e\n\n            <button id="play-${s}" class="align-items-center justify-content-center border-circle border-none" style="margin-right: 7px; display: flex; background: var(--gradient45); width: 36px; height: 36px; cursor: pointer;">\n              <div class="flex align-items-center justify-content-center border-circle bg-white">\n                <img id="play-icon-${s}" class="flex justify-content-center" src="assets/icons/play-color.svg" style="display: flex; width: 26px; height: 26px;">\n              </div>\n            </button>\n\n            \x3c!--<div id="like-${s}">\n              <div class="flex black-buttons-map align-items-center justify-content-center mr-2" style="">\n                <img class="flex justify-content-center" src="assets/icons/like.svg" style="display: flex; width: 23px; height: 23px; filter: var(--whiteSvg);">\n              </div>\n            </div>--\x3e\n\n\n            \x3c!--<div id="like-outline" class="black-buttons-map align-items-center justify-content-center mr-2" style="display: none; ">\n              <img class="flex justify-content-center" src="assets/icons/like-outline.svg" style="display: flex; width: 23px; height: 23px; filter: var(--whiteSvg);">\n            </div>--\x3e\n\n            <div id="addBtn-${s}" class="flex black-buttons-map align-items-center justify-content-center" style="margin-right: 7px; ">\n              <img class="flex justify-content-center" src="assets/icons/playlist.svg" style="display: flex; width: 23px; height: 23px; filter: var(--whiteSvg);">\n            </div>\n            \n            <div id="edit-${s}">\n              <div class="flex black-buttons-map align-items-center justify-content-center" style="margin-right: 7px; ">\n                <img class="flex justify-content-center" src="assets/icons/edit.svg" style="display: flex; width: 23px; height: 23px; filter: var(--whiteSvg);">\n              </div>\n            </div>\n\n            <div id="submit-${s}" class="black-buttons-map align-items-center justify-content-center" style="margin-right: 7px; display: none; ">\n              <img class="flex justify-content-center" src="assets/icons/check.svg" style="display: flex; width: 23px; height: 23px; filter: var(--whiteSvg);">\n            </div>\n\n            <div id="delete-${s}">\n              <div class="flex delete-button align-items-center justify-content-center">\n                <img class="flex justify-content-center" src="assets/icons/delete.svg" style="display: flex; width: 23px; height: 23px; filter: invert(100) sepia(100) saturate(0) brightness(100);">\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `);_e.setMaxWidth("auto");const Be=document.createElement("img");Be.src="assets/images/spotivibesLogo.png",Be.style.width="35px";const et=new Bd.Marker(Be).setLngLat([l,h]).setPopup(_e).addTo(this.mapa);et.getElement().setAttribute("id",s),this.markers[s]=et,this.loaded.emit(!0),_e.on("open",()=>{null!=e?document.getElementById("play-icon-"+s).src=this.appLayout.playingSong!=o?"assets/icons/play-color.svg":"assets/icons/pause-color.svg":document.getElementById("play-"+s).style.display="none";ue||(document.getElementById("edit-"+s).style.display="none",document.getElementById("delete-"+s).style.display="none"),ee?(document.getElementById("like-outline-"+s).style.display="none",document.getElementById("like-"+s).style.display="flex"):(document.getElementById("like-outline-"+s).style.display="flex",document.getElementById("like-"+s).style.display="none"),document.getElementById("play-"+s).onclick=()=>{if(e){var kt=document.getElementById("play-icon-"+s);this.appLayout.playingSong==o?(this.appLayout.playingSong="",this.appLayout.previewIcon="play_arrow",kt.src="assets/icons/play-color.svg",this.appLayout.songSounding.pause()):(kt.src="assets/icons/pause-color.svg",this.appLayout.playingSong=o,this.appLayout.previewIcon="pause",this.appLayout.songSounding.src=e,this.appLayout.songSounding.load(),this.appLayout.songSounding.play(),this.appLayout.songSounding.onended=()=>{this.appLayout.playingSong="",this.appLayout.previewIcon="play_arrow",kt.src="assets/icons/play-color.svg"})}},document.getElementById("spotify-"+s).onclick=()=>{var kt;this.confirmationService.confirm({header:"Ir a Spotify",message:"Se va a abrir una nueva pesta\xf1a en tu navegador para que puedas escuchar la canci\xf3n en Spotify.",acceptLabel:"Ir a Spotify",rejectLabel:"Cancelar",accept:(kt=Ft(function*(){window.open(r,"_blank")}),function(){return kt.apply(this,arguments)})})},document.getElementById("addBtn-"+s).onclick=Ft(function*(){fe.addToPlaylist(s)}),document.getElementById("edit-"+s).onclick=()=>{document.getElementById("descriptionEdit-"+s).style.display="block",document.getElementById("description-"+s).style.display="none",document.getElementById("edit-"+s).style.display="none",document.getElementById("delete-"+s).style.display="none",document.getElementById("addBtn-"+s).style.display="none",document.getElementById("submit-"+s).style.display="flex"},document.getElementById("submit-"+s).onclick=Ft(function*(){document.getElementById("submit-"+s).style.display="none",document.getElementById("descriptionEdit-"+s).style.display="none",document.getElementById("description-"+s).style.display="flex",document.getElementById("edit-"+s).style.display="flex",document.getElementById("delete-"+s).style.display="flex",document.getElementById("addBtn-"+s).style.display="flex",document.getElementById("description-"+s).innerHTML='"'+document.getElementById("descriptionEdit-"+s).value+'"';try{yield fe.vibesService.editVibe(s,l,h,document.getElementById("descriptionEdit-"+s).value)}catch(kt){403==kt.status?fe.appLayout.handle403Error():fe.appLayout.messageService.add({severity:"error",summary:"Error",detail:kt.data.status})}}),document.getElementById("like-"+s).onclick=Ft(function*(){document.getElementById("like-"+s).style.display="none",document.getElementById("like-outline-"+s).style.display="flex",$-=1,ee=!1,document.getElementById("num-likes-"+s).textContent=$.toString(),document.getElementById("num-likes-outline-"+s).textContent=$.toString();try{yield fe.vibesService.dislikeVibe(s),fe.appLayout.messageService.add({severity:"info",summary:"Unliked vibe",detail:"Has dado dislike al vibe"})}catch(kt){403==kt.status?fe.appLayout.handle403Error():fe.appLayout.messageService.add({severity:"error",summary:"Error",detail:kt.data.status})}}),document.getElementById("like-outline-"+s).onclick=Ft(function*(){document.getElementById("like-outline-"+s).style.display="none",document.getElementById("like-"+s).style.display="flex",$+=1,ee=!0,document.getElementById("num-likes-"+s).textContent=$.toString(),document.getElementById("num-likes-outline-"+s).textContent=$.toString();try{yield fe.vibesService.likeVibe(s),fe.appLayout.messageService.add({severity:"info",summary:"Liked vibe",detail:"Has dado like al vibe"})}catch(kt){403==kt.status?fe.appLayout.handle403Error():fe.appLayout.messageService.add({severity:"error",summary:"Error",detail:kt.data.status})}}),document.getElementById("delete-"+s).onclick=Ft(function*(){var kt;fe.confirmationService.confirm({header:"Borrar vibe",message:"\xbfSeguro que deseas borrar este vibe? Una vez borrado no se podr\xe1 recuperar",acceptLabel:"Borrar vibe",rejectLabel:"Cancelar",accept:(kt=Ft(function*(){try{yield fe.vibesService.deleteVibe(s),fe.playlistDetail&&fe.deletedVibe.emit(s),et.remove()}catch(Kt){403==Kt.status?fe.appLayout.handle403Error():fe.appLayout.messageService.add({severity:"error",summary:"Error",detail:Kt.data.status})}}),function(){return kt.apply(this,arguments)})})}),document.getElementById("comments-"+s).onclick=Ft(function*(){fe.commentsVibeId=s,fe.getComments(s)})})}getPlaylists(){var e=this;return Ft(function*(){try{const o=yield e.playlistsService.getPlaylists();e.playlists=o.myPlaylists}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}getComments(e){var o=this;return Ft(function*(){try{const r=yield o.vibesService.getVibeComments(e);o.commentsForDialog=r.comments,o.displayComments=!0}catch(r){403==r.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}})()}showAddToPlaylistDialog(e){this.newPlaylistVibeId=e,this.displayNewPlaylistDialog=!0}hideNewPlaylistDialog(e){this.getPlaylists(),this.displayNewPlaylistDialog=e}updateNumComments(e){document.getElementById("num-comments-"+e.id).textContent=e.numComments.toString()}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(Oy),ce(Dg),ce(ku))},t.\u0275cmp=Qt({type:t,selectors:[["app-map-vibes"]],inputs:{id:"id",mapHeight:"mapHeight",showSearchBar:"showSearchBar",showLocationButton:"showLocationButton",playlistDetail:"playlistDetail",newVibe:"newVibe",map:"map",vibesArray:"vibesArray",vibe:"vibe",home:"home",initMapEvent:"initMapEvent"},outputs:{deletedVibe:"deletedVibe",loaded:"loaded",vibeLocation:"vibeLocation"},decls:4,vars:11,consts:[[1,"body-map",3,"id"],[3,"display","vibeId","playlists","hide","showAddToPlaylistDialog"],[3,"display","vibeId","showDialog"],[3,"display","comments","vibeId","hide","numComments"]],template:function(e,o){1&e&&(Ae(0,"div",0),P(1,"app-add-to-playlist-dialog",1),Te("hide",function(s){return o.hideDialogPlaylist(s)})("showAddToPlaylistDialog",function(s){return o.showAddToPlaylistDialog(s)}),N(),P(2,"app-new-playlist-dialog-one-vibe",2),Te("showDialog",function(s){return o.hideNewPlaylistDialog(s)}),N(),P(3,"app-comments-dialog",3),Te("hide",function(s){return o.hideDialogCommnets(s)})("numComments",function(s){return o.updateNumComments(s)}),N()),2&e&&(za("height",o.mapHeight),Ai("id",o.id),F(1),L("display",o.displayDialog)("vibeId",o.addToPlaylistVibeId)("playlists",o.playlists),F(1),L("display",o.displayNewPlaylistDialog)("vibeId",o.newPlaylistVibeId),F(1),L("display",o.displayComments)("comments",o.commentsForDialog)("vibeId",o.commentsVibeId))},dependencies:[dN,pN,Xne],styles:[".marker[_ngcontent-%COMP%]{width:40px;height:40px;background-size:cover;background-repeat:no-repeat;background-position:center}.body-map[_ngcontent-%COMP%]{width:100%;border-radius:10px;box-shadow:var(--shadows)!important}[_nghost-%COMP%]     .mapboxgl-popup{width:auto}[_nghost-%COMP%]     .mapboxgl-popup-content{background:var(--frostedBackground)!important;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)!important;border-radius:10px;width:auto;padding:20px;box-shadow:var(--shadowsMap);min-width:215px}  .mapboxgl-popup-anchor-top   .mapboxgl-popup-tip{border-bottom-color:var(--MapTip)}  .mapboxgl-popup-anchor-bottom   .mapboxgl-popup-tip{border-top-color:var(--MapTip)}  .mapboxgl-popup-anchor-left   .mapboxgl-popup-tip{border-right-color:var(--MapTip)}  .mapboxgl-popup-anchor-right   .mapboxgl-popup-tip{border-left-color:var(--MapTip)}  .mapboxgl-popup-anchor-top-left   .mapboxgl-popup-tip{display:none}  .mapboxgl-popup-anchor-bottom-left   .mapboxgl-popup-tip{display:none}  .mapboxgl-popup-anchor-top-right   .mapboxgl-popup-tip{display:none}  .mapboxgl-popup-anchor-bottom-right   .mapboxgl-popup-tip{display:none}  .mapboxgl-ctrl{display:flex;align-items:center}  a.mapboxgl-ctrl-logo{display:none}  .mapboxgl-ctrl-attrib-inner{display:none}  .mapboxgl-popup-close-button{height:25px;width:25px;font-size:1.1rem;margin:8px;display:flex;align-items:center;justify-content:center;border-radius:100%;color:var(--fontColor)}  .mapboxgl-ctrl-zoom-out{border:none!important}  .mapboxgl-ctrl-compass{border:none!important}  .mapboxgl-map{border-radius:10px!important;-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC)}  .mapboxgl-ctrl-geocoder   .mapboxgl-ctrl-geocoder--pin-right>*{top:auto}  .mapboxgl-ctrl-geocoder--pin-right{display:flex;align-items:center}  .mapboxgl-ctrl-attrib{display:none!important}  .mapboxgl-ctrl-geocoder--powered-by{display:none!important}  .mapboxgl-ctrl-geocoder--input{transition:var(--transition);background-color:var(--containerBackground)}  .mapboxgl-ctrl-geocoder--button{transition:var(--transition);background-color:var(--containerBackground)}  .mapboxgl-ctrl-group{transition:var(--transition);background:var(--containerBackground)}  .mapboxgl-ctrl-icon{transition:var(--transition);filter:var(--mapIcons)}  .mapboxgl-ctrl-geocoder--input{color:var(--fontColor)!important}"]}),t})();function Yne(t,n){1&t&&(P(0,"div",20)(1,"h2",21),ie(2," Crear playlist "),N()())}function Qne(t,n){1&t&&(P(0,"div",22)(1,"span",23),ie(2,"El nombre de la playlist no puede tener m\xe1s de 25 caracteres"),N()())}function Jne(t,n){1&t&&Ae(0,"p-progressSpinner",24)}function eie(t,n){if(1&t){const e=Ye();P(0,"div",25)(1,"button",26),Te("click",function(){return be(e),ve(U().onCancelSuccess())}),P(2,"div",13)(3,"span",14)(4,"p",16),ie(5,"Aceptar"),N()()()()()}}const tie=function(){return{width:"700px"}},nie=function(){return{"700px":"95vw"}},iie=function(t,n){return{"h-410":t,"h-6":n}},oie=function(){return{width:"500px"}},rie=function(){return{"500px":"95vw"}};let sie=(()=>{class t{constructor(e,o){this.playlistsService=e,this.appLayout=o,this.showDialog=new ht,this.newPlaylist=new ht,this.buttonTitle="Crear playlist",this.uploadingPlaylist=!1,this.displaySuccess=!1}ngOnInit(){this.searchForm=new Qs({playlistTitle:new Sr(this.playlistTitle,[pr.required,pr.maxLength(25)]),playlistDescription:new Sr(this.playlistDescription,[])})}cancel(){this.buttonTitle="Crear playlist",this.uploadingPlaylist=!1,this.searchForm.reset(),this.showDialog.emit(!1)}onCancelSuccess(){this.displaySuccess=!1}createPlaylist(e){var o=this;return Ft(function*(){o.uploadingPlaylist=!0,o.buttonTitle="Creando playlist...";var r=new BC;r.name=e.value.playlistTitle,r.description=e.value.playlistDescription,r.creationDate=(new Date).toISOString(),r.playlistImage="",r.vibesIds=[o.vibeId];try{yield o.playlistsService.createPlaylist(r),o.cancel(),o.newPlaylist.emit(r),o.displaySuccess=!0}catch(l){o.buttonTitle="Crear playlist",o.uploadingPlaylist=!1,403==l.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:l.response.data.status})}})()}}return t.\u0275fac=function(e){return new(e||t)(ce(ku),ce(Zo))},t.\u0275cmp=Qt({type:t,selectors:[["app-new-playlist-dialog-one-vibe-home"]],inputs:{display:"display",vibeId:"vibeId"},outputs:{showDialog:"showDialog",newPlaylist:"newPlaylist"},decls:27,vars:27,consts:[[3,"visible","closable","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[1,"h-120","pt-2",3,"ngClass"],[1,"flex","justify-content-between","flex-wrap","card-container"],[1,"flex"],[1,"mt-2",2,"margin-bottom","15px"],[3,"formGroup"],[1,"p-inputgroup","h-fit"],["id","playlistTitle","name","playlistTitle","formControlName","playlistTitle","placeholder","Nombre de la playlist","type","text","pInputText","",1,"form-control","h-3rem"],["class","mb-2",4,"ngIf"],[2,"margin-bottom","15px","margin-top","15px"],["id","playlistDescription","name","playlistDescription","formControlName","playlistDescription","placeholder","A\xf1adir descripci\xf3n",1,"w-full","h-10rem","border-none","p-3",2,"resize","none","border-radius","10px","font-family","Lato","color","var(--fontColor)","background","var(--frostedBackground)","outline","0.15rem solid #93cbf9"],["pButton","","pRipple","",1,"mt-4","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"formGroup","disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],[1,"vibe-btn-text-white","w-full"],[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],[1,"text-center"],["pTemplate","footer"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"],[1,"mb-2"],[1,"text-xs",2,"color","var(--validationErrors)"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"],[1,"p-3"],["pButton","","pRipple","","type","submit",1,"p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"]],template:function(e,o){if(1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s})("onHide",function(){return o.cancel()}),W(1,Yne,3,0,"ng-template",1),P(2,"div",2)(3,"div",3)(4,"div",4)(5,"div")(6,"p",5),ie(7,"Introduce un t\xedtulo para tu playlist"),N()()()(),P(8,"form",6)(9,"div",7),Ae(10,"input",8),N(),W(11,Qne,3,0,"div",9),P(12,"p",10),ie(13,"Introduce una descripci\xf3n para tu playlist"),N(),Ae(14,"textarea",11),N(),P(15,"button",12),Te("click",function(){return o.createPlaylist(o.searchForm)}),P(16,"div",13)(17,"span",14),W(18,Jne,1,0,"p-progressSpinner",15),P(19,"p",16),ie(20),N()()()()()(),P(21,"p-dialog",17),Te("visibleChange",function(s){return o.displaySuccess=s})("onHide",function(){return o.onCancelSuccess()}),P(22,"h3",18),ie(23," \xa1Playlist creada ! "),N(),P(24,"p",18),ie(25," La playlist ha sido creada correctamente con tu vibe "),N(),W(26,eie,6,0,"ng-template",19),N()),2&e){let r,s;Io(Kn(20,tie)),L("visible",o.display)("closable",!o.uploadingPlaylist)("modal",!0)("draggable",!1)("breakpoints",Kn(21,nie)),F(2),L("ngClass",Ji(22,iie,!(null!=(r=o.searchForm.get("playlistTitle"))&&r.hasError("maxlength")),null==(r=o.searchForm.get("playlistTitle"))?null:r.hasError("maxlength"))),F(6),L("formGroup",o.searchForm),F(3),L("ngIf",(null==(s=o.searchForm.get("playlistTitle"))?null:s.hasError("maxlength"))&&(o.searchForm.controls.playlistTitle.dirty||o.searchForm.controls.playlistTitle.touched)),F(4),L("formGroup",o.searchForm)("disabled",!o.searchForm.valid||o.uploadingPlaylist),F(3),L("ngIf",o.uploadingPlaylist),F(2),jn(" ",o.buttonTitle,""),F(1),Io(Kn(25,oie)),L("visible",o.displaySuccess)("modal",!0)("draggable",!1)("breakpoints",Kn(26,rie))}},dependencies:[ao,Xn,Dd,yc,$a,Ed,vc,Md,Dr,fo,_l,jl,Mu],styles:[".h-6[_ngcontent-%COMP%]{height:395px!important}"]}),t})();const UC=function(t){return{opacity:t}};function aie(t,n){if(1&t){const e=Ye();P(0,"mat-icon",15),Te("click",function(){be(e);const r=U();return ve(r.playPreview(r.vibe.spotifySongId,r.vibe.songPreview))}),ie(1),N()}if(2&t){const e=U();L("ngStyle",Wt(2,UC,e.appLayout.playingSong==e.vibe.spotifySongId?"1":"0")),F(1),Ut(e.appLayout.playingSong==e.vibe.spotifySongId?e.appLayout.previewIcon:"play_arrow")}}function lie(t,n){if(1&t){const e=Ye();P(0,"mat-icon",15),Te("click",function(){be(e);const r=U();return ve(r.playPreview(r.vibe.spotifySongId,r.vibe.songPreview))}),ie(1),N()}if(2&t){const e=U();L("ngStyle",Wt(2,UC,e.appLayout.playingSong==e.vibe.spotifySongId?"1":"0")),F(1),Ut(e.appLayout.playingSong==e.vibe.spotifySongId?e.appLayout.previewIcon:"play_arrow")}}const fN=function(t){return{"diffuse-image":t}};let cie=(()=>{class t{constructor(e){this.appLayout=e,this.staticImageUrl=""}ngOnInit(){this.appLayout.appComponent.changeThemeEvent.subscribe(()=>{this.initMapbox(this.vibe)})}ngAfterViewInit(){this.initMapbox(this.vibe)}initMapbox(e){Bd.accessToken=Qn_mapboxKey;const o=e.longitude,r=e.latitude,f=this.appLayout.appComponent.mapStyle.split("mapbox://styles/")[1];this.staticImageUrl=`https://api.mapbox.com/styles/v1/${f}/static/${o},${r},12/1080x720?access_token=${Qn_mapboxKey}`}playPreview(e,o){this.appLayout.playPreview(e,o)}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo))},t.\u0275cmp=Qt({type:t,selectors:[["app-static-map-vibes"]],inputs:{id:"id",mapHeight:"mapHeight",vibe:"vibe"},decls:32,vars:39,consts:[["alt","Description of the image",1,"w-full","h-full","relative",2,"object-fit","cover",3,"src"],[1,"absolute",2,"top","40%","left","48%"],[1,"absolute","flex"],["src","assets/images/spotivibesLogo.svg","height","40"],[1,"p-1","ml-2","p-slidemenu","absolute","popup-vibe",2,"color","var(--fontColor)","width","auto","border-radius","10px"],[1,"grow","relative","flex","align-items-center","justify-content-center","align-content-center","p-1",3,"ngClass"],[1,"flex-initial","flex","align-items-center","justify-content-center","relative",2,"color","var(--fontColor)"],["height","45",1,"song-list-img","mr-1",2,"border-radius","5px",3,"src","ngStyle","alt"],["class","play-icon-preview absolute flex align-items-center w-full h-full",3,"ngStyle","click",4,"ngIf"],[1,"flex-column","align-items-center","justify-content-center","align-content-center"],[1,"row","px-1","flex","align-items-center","align-content-center",2,"width","max-content"],[1,"text-sm","font-bold"],[1,"row","px-1","flex","align-items-center","align-content-center"],[1,"text-xs"],[1,"p-1","ml-2","p-slidemenu","absolute","popup-vibe-sm",2,"color","var(--fontColor)","width","auto","border-radius","10px"],[1,"play-icon-preview","absolute","flex","align-items-center","w-full","h-full",3,"ngStyle","click"]],template:function(e,o){1&e&&(Ae(0,"img",0),P(1,"div",1)(2,"div",2),Ae(3,"img",3),P(4,"div",4)(5,"div",5)(6,"div",6),Ae(7,"img",7),W(8,aie,2,4,"mat-icon",8),N(),P(9,"div",9)(10,"div",10)(11,"span",11),ie(12),wo(13,"slice"),N()(),P(14,"div",12)(15,"span",13),ie(16),wo(17,"slice"),N()()()()()()(),P(18,"div",14)(19,"div",5)(20,"div",6),Ae(21,"img",7),W(22,lie,2,4,"mat-icon",8),N(),P(23,"div",9)(24,"div",10)(25,"span",11),ie(26),wo(27,"slice"),N()(),P(28,"div",12)(29,"span",13),ie(30),wo(31,"slice"),N()()()()()),2&e&&(L("src",o.staticImageUrl,Ui),F(5),L("ngClass",Wt(31,fN,null!=o.vibe.songPreview)),F(2),Ai("src",o.vibe.songImage,Ui),Ai("alt",o.vibe.songName),L("ngStyle",Wt(33,UC,o.appLayout.playingSong==o.vibe.spotifySongId?"0.4":"1")),F(1),L("ngIf",null!=o.vibe.songPreview),F(4),Ut(o.vibe.songName.length>28?Nr(13,15,o.vibe.songName,0,28)+"...":o.vibe.songName),F(4),Ut(o.vibe.songAuthor.length>28?Nr(17,19,o.vibe.songAuthor,0,28)+"...":o.vibe.songAuthor),F(3),L("ngClass",Wt(35,fN,null!=o.vibe.songPreview)),F(2),Ai("src",o.vibe.songImage,Ui),Ai("alt",o.vibe.songName),L("ngStyle",Wt(37,UC,o.appLayout.playingSong==o.vibe.spotifySongId?"0.4":"1")),F(1),L("ngIf",null!=o.vibe.songPreview),F(4),Ut(o.vibe.songName.length>28?Nr(27,23,o.vibe.songName,0,28)+"...":o.vibe.songName),F(4),Ut(o.vibe.songAuthor.length>28?Nr(31,27,o.vibe.songAuthor,0,28)+"...":o.vibe.songAuthor))},dependencies:[ao,Xn,ho,_a,Su],styles:["[_nghost-%COMP%]{width:100%;height:100%;overflow:hidden;border-radius:10px}.popup-vibe[_ngcontent-%COMP%]{left:30px;bottom:30px;visibility:visible;opacity:1;transition:opacity 1s linear}.popup-vibe-sm[_ngcontent-%COMP%]{visibility:hidden;opacity:0}@media (max-width: 1050px){.popup-vibe[_ngcontent-%COMP%]{display:none;visibility:hidden;opacity:0;transition:visibility 0s 1s,opacity 1s linear}.popup-vibe-sm[_ngcontent-%COMP%]{visibility:visible;left:0;bottom:10px;opacity:1;transition:opacity 1s linear}}"]}),t})();function uie(t,n){1&t&&Ae(0,"img",29),2&t&&Ai("src",U().$implicit.creatorProfileImage,Ui)}function die(t,n){1&t&&Ae(0,"img",30)}function hie(t,n){1&t&&Ae(0,"img",31),2&t&&Ai("src",U().$implicit.creatorProfileImage,Ui)}function pie(t,n){1&t&&Ae(0,"img",32)}function fie(t,n){1&t&&(P(0,"div",33),Ae(1,"app-loader",34),N()),2&t&&(F(1),L("component",!0))}function mie(t,n){if(1&t){const e=Ye();P(0,"app-map-vibes",40),Te("loaded",function(r){return be(e),ve(U(3).mapLoaded(r))}),N()}if(2&t){const e=U(2).$implicit,o=U();L("home",!0)("initMapEvent",o.vibesLoaded.asObservable())("id","activity"+e.activityId)("vibesArray",e.playlist.vibes)("showSearchBar",!1)("showLocationButton",!0)}}function gie(t,n){if(1&t&&Ae(0,"app-static-map-vibes",41),2&t){const e=U(2).$implicit;L("id","activity"+e.activityId)("vibe",e.vibe)}}function _ie(t,n){1&t&&Ae(0,"img",49),2&t&&Ai("src",U(3).$implicit.playlist.playlistImage,Ui)}function yie(t,n){1&t&&Ae(0,"img",50)}const mN=function(t){return["/playlists/",t]};function vie(t,n){if(1&t&&(P(0,"div",42)(1,"div",43)(2,"div",44),W(3,_ie,1,1,"img",45),W(4,yie,1,0,"img",46),N(),P(5,"h3",47),ie(6),N(),P(7,"p",48),ie(8),N()()()),2&t){const e=U(2).$implicit;F(2),L("routerLink",Wt(5,mN,e.playlist.playlistId)),F(1),L("ngIf",""!=e.playlist.playlistImage),F(1),L("ngIf",""==e.playlist.playlistImage),F(2),Ut(e.playlist.name),F(2),jn(" De ",e.creatorUserName," ")}}function bie(t,n){1&t&&Ae(0,"img",60),2&t&&L("src",U(3).$implicit.playlist.playlistImage,Ui)}function xie(t,n){1&t&&Ae(0,"img",61)}function wie(t,n){if(1&t&&(P(0,"div",51)(1,"div",52),W(2,bie,1,1,"img",53),W(3,xie,1,0,"img",54),P(4,"div",55)(5,"div",56)(6,"span",57),ie(7),wo(8,"slice"),N()(),P(9,"div",58)(10,"span",59),ie(11),wo(12,"slice"),N()()()()()),2&t){const e=U(2).$implicit;L("routerLink",Wt(13,mN,e.playlist.playlistId)),F(2),L("ngIf",""!=e.playlist.playlistImage),F(1),L("ngIf",""==e.playlist.playlistImage),F(4),Ut(e.playlist.name.length>28?Nr(8,5,e.playlist.name,0,28)+"...":e.playlist.name),F(4),Ut(e.creatorUserName.length>28?Nr(12,9,e.creatorUserName,0,28)+"...":e.creatorUserName)}}function Cie(t,n){if(1&t&&(P(0,"div",35),W(1,mie,1,6,"app-map-vibes",36),W(2,gie,1,2,"app-static-map-vibes",37),W(3,vie,9,7,"div",38),W(4,wie,13,15,"div",39),N()),2&t){const e=U().$implicit;F(1),L("ngIf",null!=e.playlist),F(1),L("ngIf",null!=e.vibe),F(1),L("ngIf",null!=e.playlist),F(1),L("ngIf",null!=e.playlist)}}function Tie(t,n){if(1&t&&(P(0,"div",65),ie(1),N()),2&t){const e=U(2).$implicit;F(1),Ut(1!=e.playlist.comments.length?e.playlist.comments.length+" Comentarios":e.playlist.comments.length+" Comentario")}}function Sie(t,n){if(1&t){const e=Ye();P(0,"div",62),Te("click",function(){be(e);const r=U().$implicit;return ve(U().openCommentsDialog("playlist",r.playlist.playlistId,r.activityId))}),P(1,"mat-icon",63),ie(2,"maps_ugc"),N(),W(3,Tie,2,1,"div",64),N()}if(2&t){const e=U().$implicit;F(3),L("ngIf","playlist"==e.typeOfContent)}}function Eie(t,n){if(1&t&&(P(0,"div",65),ie(1),N()),2&t){const e=U(2).$implicit;F(1),Ut(1!=e.vibe.comments.length?e.vibe.comments.length+" Comentarios":e.vibe.comments.length+" Comentario")}}function Iie(t,n){if(1&t){const e=Ye();P(0,"div",62),Te("click",function(){be(e);const r=U().$implicit;return ve(U().openCommentsDialog("vibe",r.vibe.vibeId,r.activityId))}),P(1,"mat-icon",63),ie(2,"maps_ugc"),N(),W(3,Eie,2,1,"div",64),N()}if(2&t){const e=U().$implicit;F(3),L("ngIf","vibe"==e.typeOfContent)}}function Die(t,n){1&t&&(P(0,"div",69)(1,"mat-icon",63),ie(2,"subscriptions"),N(),P(3,"div",70),ie(4," Playlist a\xf1adida "),N()()),2&t&&L("@fadeInOut",void 0)}function Mie(t,n){if(1&t){const e=Ye();P(0,"button",66),Te("click",function(){be(e);const r=U().$implicit;return ve(U().addToPlaylist("playlist",r.playlist.playlistId,r.activityId))}),P(1,"div",67)(2,"mat-icon",63),ie(3,"add"),N(),P(4,"div",65),ie(5," A\xf1adir playlist "),N(),W(6,Die,5,1,"div",68),N()()}if(2&t){const e=U().$implicit,o=U();L("disabled",o.selectedId==e.activityId),F(6),L("ngIf",o.playlistToAdd==e.playlist.playlistId)}}function kie(t,n){1&t&&(P(0,"div",71)(1,"div",72)(2,"mat-icon",63),ie(3,"done"),N(),P(4,"div",65),ie(5," Playlist seguida "),N()()())}function Aie(t,n){if(1&t){const e=Ye();P(0,"div",73),Te("click",function(){be(e);const r=U().$implicit;return ve(U().addToPlaylist("vibe",r.vibe.vibeId,r.activityId))}),P(1,"div",67)(2,"mat-icon",63),ie(3,"add"),N(),P(4,"div",65),ie(5," A\xf1adir a playlist "),N()()()}}function Pie(t,n){1&t&&(P(0,"div",69)(1,"mat-icon",63),ie(2,"link"),N(),P(3,"div",70),ie(4," Enlace copiado "),N()()),2&t&&L("@fadeInOut",void 0)}function Oie(t,n){if(1&t){const e=Ye();P(0,"div",74),Te("click",function(){be(e);const r=U().$implicit;return ve(U().copy(r.playlist.spotifyPlaylistId))}),P(1,"div",67)(2,"mat-icon",63),ie(3,"share"),N(),P(4,"div",65),ie(5," Compartir "),N(),W(6,Pie,5,1,"div",68),N()()}if(2&t){const e=U().$implicit,o=U();F(6),L("ngIf",o.copyLink==e.playlist.spotifyPlaylistId)}}function Lie(t,n){1&t&&(P(0,"div",69)(1,"mat-icon",63),ie(2,"link"),N(),P(3,"div",70),ie(4," Enlace copiado "),N()()),2&t&&L("@fadeInOut",void 0)}function Rie(t,n){if(1&t){const e=Ye();P(0,"div",74),Te("click",function(){be(e);const r=U().$implicit;return ve(U().copy(r.vibe.spotifyUrl))}),P(1,"div",67)(2,"mat-icon",63),ie(3,"share"),N(),P(4,"div",65),ie(5," Compartir "),N(),W(6,Lie,5,1,"div",68),N()()}if(2&t){const e=U().$implicit,o=U();F(6),L("ngIf",o.copyLink==e.vibe.spotifyUrl)}}function Fie(t,n){1&t&&(P(0,"mat-icon",63),ie(1,"favorite_border"),N())}function Nie(t,n){1&t&&(P(0,"mat-icon",77),ie(1,"favorite"),N())}function zie(t,n){if(1&t){const e=Ye();P(0,"div",62),Te("click",function(){be(e);const r=U().$implicit;return ve(U().addLike("playlist",r.playlist.playlistId,r.activityId,r.liked))}),W(1,Fie,2,0,"mat-icon",75),W(2,Nie,2,0,"mat-icon",76),P(3,"div",65),ie(4),N()()}if(2&t){const e=U().$implicit;F(1),L("ngIf",!e.liked),F(1),L("ngIf",e.liked),F(2),Ut(1!=e.numLikes?e.numLikes+" Likes":e.numLikes+" Like")}}function Bie(t,n){1&t&&(P(0,"mat-icon",63),ie(1,"favorite_border"),N())}function Vie(t,n){1&t&&(P(0,"mat-icon",77),ie(1,"favorite"),N())}function Uie(t,n){if(1&t){const e=Ye();P(0,"div",62),Te("click",function(){be(e);const r=U().$implicit;return ve(U().addLike("vibe",r.vibe.vibeId,r.activityId,r.liked))}),W(1,Bie,2,0,"mat-icon",75),W(2,Vie,2,0,"mat-icon",76),P(3,"div",65),ie(4),N()()}if(2&t){const e=U().$implicit;F(1),L("ngIf",!e.liked),F(1),L("ngIf",e.liked),F(2),Ut(1!=e.numLikes?e.numLikes+" Likes":e.numLikes+" Like")}}function jie(t,n){if(1&t){const e=Ye();P(0,"app-comments-dialog",78),Te("numComments",function(r){return be(e),ve(U(2).addComment(r))})("hide",function(r){return be(e),ve(U(2).hideDialog(r))}),N()}if(2&t){const e=U().$implicit,o=U();L("playlistId",e.playlist.playlistId)("display",o.displayCommentsDialog)("comments",o.comments)}}function Hie(t,n){if(1&t){const e=Ye();P(0,"app-comments-dialog",79),Te("numComments",function(r){return be(e),ve(U(2).addComment(r))})("hide",function(r){return be(e),ve(U(2).hideDialog(r))}),N()}if(2&t){const e=U().$implicit,o=U();L("vibeId",e.vibe.vibeId)("display",o.displayCommentsDialog)("comments",o.comments)}}function $ie(t,n){if(1&t){const e=Ye();P(0,"app-add-to-playlist-dialog",80),Te("hide",function(r){return be(e),ve(U(2).hideDialogPlaylist(r))})("showAddToPlaylistDialog",function(r){return be(e),ve(U(2).showNewPlaylistDialog(r))}),N()}if(2&t){const e=U().$implicit,o=U();L("vibeId",e.vibe.vibeId)("playlists",o.playlists)("display",o.displayAddToPlaylistDialog)}}function Gie(t,n){if(1&t){const e=Ye();P(0,"app-new-playlist-dialog-one-vibe-home",81),Te("showDialog",function(r){return be(e),ve(U(2).hideNewPlaylistDialog(r))})("newPlaylist",function(r){return be(e),ve(U(2).newPlaylistEvent(r))}),N()}if(2&t){const e=U().$implicit;L("display",U().displayNewPlaylistDialog)("vibeId",e.vibe.vibeId)}}function Wie(t,n){if(1&t&&(P(0,"div",2)(1,"div",3),W(2,uie,1,1,"img",4),W(3,die,1,0,"img",5),N(),P(4,"div",6)(5,"div",7)(6,"mat-icon",8),ie(7),N(),P(8,"p",9),ie(9),P(10,"span",10),ie(11),N()()(),P(12,"div",11),W(13,hie,1,1,"img",12),W(14,pie,1,0,"img",13),P(15,"p",14),ie(16),N()(),P(17,"p",15),ie(18),N(),W(19,fie,2,1,"div",16),W(20,Cie,5,4,"div",17),P(21,"div",18)(22,"div",19),W(23,Sie,4,1,"div",20),W(24,Iie,4,1,"div",20),N(),P(25,"div",19),W(26,Mie,7,2,"button",21),W(27,kie,6,0,"div",22),W(28,Aie,6,0,"div",23),N(),P(29,"div",19),W(30,Oie,7,1,"div",24),W(31,Rie,7,1,"div",24),N(),P(32,"div",19),W(33,zie,5,3,"div",20),W(34,Uie,5,3,"div",20),N()()(),W(35,jie,1,3,"app-comments-dialog",25),W(36,Hie,1,3,"app-comments-dialog",26),W(37,$ie,1,3,"app-add-to-playlist-dialog",27),W(38,Gie,1,2,"app-new-playlist-dialog-one-vibe-home",28),N()),2&t){const e=n.$implicit,o=U();F(2),L("ngIf",""!=e.creatorProfileImage),F(1),L("ngIf",""==e.creatorProfileImage),F(4),Ut("like"==e.typeOfInteraction?"favorite":"add_circle"),F(2),jn(" ","creation"==e.typeOfInteraction?null!=e.playlist?"Nueva":"Nuevo":e.userName+" le ha gustado "+(null!=e.playlist?"una":"un"),"\xa0 "),F(2),jn(" ",null!=e.playlist?"playlist":"vibe","\xa0 "),F(2),L("ngIf",""!=e.creatorProfileImage),F(1),L("ngIf",""==e.creatorProfileImage),F(2),jn(" ",e.creatorUserName," "),F(2),jn(" ",null!=e.playlist?e.playlist.description:e.vibe.description," "),F(1),L("ngIf",!o.mapLoaded),F(1),L("ngIf",o.mapLoaded),F(3),L("ngIf",null!=e.playlist),F(1),L("ngIf",null!=e.vibe),F(2),L("ngIf",null!=e.playlist&&!e.playlist.followed),F(1),L("ngIf",null!=e.playlist&&e.playlist.followed),F(1),L("ngIf",null!=e.vibe),F(2),L("ngIf",null!=e.playlist),F(1),L("ngIf",null!=e.vibe),F(2),L("ngIf",null!=e.playlist),F(1),L("ngIf",null!=e.vibe),F(1),L("ngIf",null!=e.playlist&&o.selectedCommentId==e.activityId),F(1),L("ngIf",null!=e.vibe&&o.selectedCommentId==e.activityId),F(1),L("ngIf",null!=e.vibe&&o.selectedId==e.activityId),F(1),L("ngIf",null!=e.vibe&&o.selectedId==e.activityId)}}function qie(t,n){1&t&&(P(0,"div")(1,"div",82)(2,"div",83),Ae(3,"div",84),P(4,"h3",85),ie(5,"No hay actividad reciente"),N()()()())}let Zie=(()=>{class t{constructor(e,o,r,s,l){this.activity=e,this.appLayout=o,this.vibesService=r,this.playlistsService=s,this.clipboard=l,this.loaded=new ht,this.newPlaylist=new ht,this.mapPublico="mapPublico",this.mapPrivado="mapPrivado",this.copyLink="",this.playlistToAdd="",this.displayCommentsDialog=!1,this.displayAddToPlaylistDialog=!1,this.displayNewPlaylistDialog=!1,this.loadedMap=!1,this.pageLoaded=!1,this.vibesLoaded=new si,this.comments=new Array,this.activities=new Array}ngOnInit(){this.getActivity()}getActivity(){var e=this;return Ft(function*(){try{const o=yield e.activity.getActivity();e.activities=o.activities;for(let r=0;r<e.activities.length;r++)if(e.activities[r].numLikes=0,e.activities[r].activityId=r,null!=e.activities[r].playlist){e.activities[r].numLikes=e.activities[r].playlist.likes.length,e.activities[r].playlist.followersIds.includes(e.appLayout.user.userId)&&(e.activities[r].playlist.followed=!0);for(let s=0;s<e.activities[r].playlist.likes.length;s++)e.activities[r].playlist.likes[s].userId==e.appLayout.user.userId&&(e.activities[r].liked=!0)}else if(null!=e.activities[r].vibe){e.activities[r].numLikes=e.activities[r].vibe.likes.length;for(let s=0;s<e.activities[r].vibe.likes.length;s++)e.activities[r].vibe.likes[s].userId==e.appLayout.user.userId&&(e.activities[r].liked=!0)}e.pageLoaded=!0,e.loaded.emit(!1),e.vibesLoaded.next()}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.response.data.status})}})()}addLike(e,o,r,s){var l=this;return Ft(function*(){try{"playlist"==e?s?(yield l.playlistsService.dislikePlaylist(o),l.addLikeToPlaylist(r)):(yield l.playlistsService.likePlaylist(o),l.addLikeToPlaylist(r)):s?(yield l.vibesService.dislikeVibe(o),l.addLikeToPlaylist(r)):(yield l.vibesService.likeVibe(o),l.addLikeToPlaylist(r))}catch(h){403==h.status?l.appLayout.handle403Error():l.appLayout.messageService.add({severity:"error",summary:"Error",detail:h.response.data.status})}})()}addLikeToPlaylist(e){var o=new class $te{};o.userId=this.appLayout.user.userId,o.likeDate=new Date;for(let r=0;r<this.activities.length;r++)this.activities[r].activityId===e&&(this.activities[r].liked?this.activities[r].numLikes--:this.activities[r].numLikes++,this.activities[r].liked=!this.activities[r].liked)}copy(e){var o=this;return Ft(function*(){o.copyLink=e,e.includes("http")?o.clipboard.copy(e):o.clipboard.copy("https://open.spotify.com/playlist/"+e),yield new Promise(r=>setTimeout(r,3e3)),o.copyLink=""})()}openCommentsDialog(e,o,r){var s=this;return Ft(function*(){try{var l;l="playlist"==e?yield s.playlistsService.getComments(o):yield s.vibesService.getComments(o),s.comments=l.comments,s.selectedCommentId=r,s.displayCommentsDialog=!0}catch(h){403==h.status?s.appLayout.handle403Error():s.appLayout.messageService.add({severity:"error",summary:"Error",detail:h.data.status})}})()}addToPlaylist(e,o,r){var s=this;return Ft(function*(){if(s.selectedId=r,"playlist"==e)try{yield s.playlistsService.followPlaylist(o);for(let l=0;l<s.activities.length;l++)null!=s.activities[l].playlist&&s.activities[l].playlist.playlistId==o&&!s.activities[l].playlist.followersIds.includes(s.appLayout.user.userId)&&(s.activities[l].playlist.followed=!0);s.playlistToAdd=o,yield new Promise(l=>setTimeout(l,3e3)),s.playlistToAdd=""}catch(l){403==l.status?s.appLayout.handle403Error():s.appLayout.messageService.add({severity:"error",summary:"Error",detail:l.data.status})}else s.displayAddToPlaylistDialog=!0})()}hideDialog(e){this.displayCommentsDialog=e}hideDialogPlaylist(e){this.displayAddToPlaylistDialog=e}hideNewPlaylistDialog(e){this.displayNewPlaylistDialog=e}showNewPlaylistDialog(e){this.displayNewPlaylistDialog=!0}mapLoaded(e){this.loadedMap=e}addComment(e){var o=new class jte{};o.userId=this.appLayout.user.userId,o.userName=this.appLayout.user.name,o.userProfileImage=this.appLayout.user.profileImage,o.description="",o.commentDate=(new Date).toString();for(let r=0;r<this.activities.length;r++)null!=this.activities[r].vibe?this.activities[r].vibe.vibeId===e.id&&this.activities[r].vibe.comments.push(o):null!=this.activities[r].playlist&&this.activities[r].playlist.playlistId===e.id&&this.activities[r].playlist.comments.push(o)}newPlaylistEvent(e){this.newPlaylist.emit(e)}}return t.\u0275fac=function(e){return new(e||t)(ce(uN),ce(Zo),ce(Oy),ce(ku),ce(qte))},t.\u0275cmp=Qt({type:t,selectors:[["app-home-activity"]],inputs:{playlists:"playlists"},outputs:{loaded:"loaded",newPlaylist:"newPlaylist"},decls:2,vars:2,consts:[["class","activity-container",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"activity-container"],[1,"image-column","hide-image-column",2,"margin-top","38px"],["alt","profile","class","round-images round-images-size",3,"src",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","alt","profile","class","round-images round-images-size",4,"ngIf"],[1,"text-column"],[1,"flex","mb-2","align-content-center"],[1,"text-600","text-lg","flex","align-items-center","mr-1"],[1,"text-600","flex","align-items-center"],[1,"text-gradient","font-bold"],[1,"flex","align-items-center","margin-image"],["alt","profile","class","hide-image round-images round-images-size mr-3",3,"src",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","alt","profile","class","hide-image round-images round-images-size mr-3",4,"ngIf"],[1,"mb-2","font-bold"],[1,"mb-4"],["class","mb-4","style","height: 400px; box-shadow: var(--shadows) !important; border-radius: 10px;",4,"ngIf"],["class","mb-4 body-map relative",4,"ngIf"],[1,"flex","text-600"],[1,"w-3","flex"],["class","bottom-icons m-auto text-600 flex align-content-center align-items-center",3,"click",4,"ngIf"],["class","relative w-full flex","style","border: none; background: transparent; font-size: 0.9rem;",3,"disabled","click",4,"ngIf"],["class","relative w-full flex",4,"ngIf"],["class","w-full flex",3,"click",4,"ngIf"],["class","relative w-full flex",3,"click",4,"ngIf"],[3,"playlistId","display","comments","numComments","hide",4,"ngIf"],[3,"vibeId","display","comments","numComments","hide",4,"ngIf"],[3,"vibeId","playlists","display","hide","showAddToPlaylistDialog",4,"ngIf"],[3,"display","vibeId","showDialog","newPlaylist",4,"ngIf"],["alt","profile",1,"round-images","round-images-size",3,"src"],["src","assets/images/profilePlaceholder.svg","alt","profile",1,"round-images","round-images-size"],["alt","profile",1,"hide-image","round-images","round-images-size","mr-3",3,"src"],["src","assets/images/profilePlaceholder.svg","alt","profile",1,"hide-image","round-images","round-images-size","mr-3"],[1,"mb-4",2,"height","400px","box-shadow","var(--shadows) !important","border-radius","10px"],[3,"component"],[1,"mb-4","body-map","relative"],["mapHeight","400px !important",3,"home","initMapEvent","id","vibesArray","showSearchBar","showLocationButton","loaded",4,"ngIf"],["mapHeight","400px !important",3,"id","vibe",4,"ngIf"],["class","hide-album z-1 absolute h-full w-15rem flex align-items-center justify-content-center playlist-background","style","border-top-left-radius: 10px; border-bottom-left-radius: 10px;",4,"ngIf"],["class","p-1 ml-2 p-slidemenu absolute popup-vibe-sm","style","color: var(--fontColor); width: auto; border-radius: 10px; bottom: 10px;",3,"routerLink",4,"ngIf"],["mapHeight","400px !important",3,"home","initMapEvent","id","vibesArray","showSearchBar","showLocationButton","loaded"],["mapHeight","400px !important",3,"id","vibe"],[1,"hide-album","z-1","absolute","h-full","w-15rem","flex","align-items-center","justify-content-center","playlist-background",2,"border-top-left-radius","10px","border-bottom-left-radius","10px"],[1,"m-auto","grow"],[1,"h-auto","w-full","px-6","mb-1",2,"cursor","pointer",3,"routerLink"],["class","w-full border-round-lg",3,"src",4,"ngIf"],["src","assets/images/playlist-placeholder.svg","class","w-full border-round-lg","style","background: var(--background); border-radius: 5px;",4,"ngIf"],[1,"text-center","mt-3","mb-2","px-3",2,"overflow","hidden","text-overflow","ellipsis"],[1,"text-center","px-3"],[1,"w-full","border-round-lg",3,"src"],["src","assets/images/playlist-placeholder.svg",1,"w-full","border-round-lg",2,"background","var(--background)","border-radius","5px"],[1,"p-1","ml-2","p-slidemenu","absolute","popup-vibe-sm",2,"color","var(--fontColor)","width","auto","border-radius","10px","bottom","10px",3,"routerLink"],[1,"flex","align-items-center","justify-content-center","align-content-center"],["class","flex align-items-center justify-content-center align-content-center m-1","height","45","style","border-radius: 5px;",3,"src",4,"ngIf"],["src","assets/images/playlist-placeholder.svg","class","flex align-items-center justify-content-center align-content-center m-1","height","45","style","background: var(--background); border-radius: 5px;",4,"ngIf"],[1,"flex-column","align-items-center","justify-content-center","align-content-center"],[1,"row","px-1","flex","align-items-center","align-content-center",2,"width","max-content"],[1,"text-sm","font-bold"],[1,"row","px-1","flex","align-items-center","align-content-center"],[1,"text-xs"],["height","45",1,"flex","align-items-center","justify-content-center","align-content-center","m-1",2,"border-radius","5px",3,"src"],["src","assets/images/playlist-placeholder.svg","height","45",1,"flex","align-items-center","justify-content-center","align-content-center","m-1",2,"background","var(--background)","border-radius","5px"],[1,"bottom-icons","m-auto","text-600","flex","align-content-center","align-items-center",3,"click"],[1,"mr-1","material-icons-outlined"],["class","bottom-icons-text",4,"ngIf"],[1,"bottom-icons-text"],[1,"relative","w-full","flex",2,"border","none","background","transparent","font-size","0.9rem",3,"disabled","click"],[1,"bottom-icons","m-auto","text-600","flex","align-content-center","align-items-center"],["class","z-1 absolute w-fit h-2rem p-3 text-center flex align-items-center align-content-center popup","style","top: 30px; border-radius: 15px; box-shadow: var(--shadows);",4,"ngIf"],[1,"z-1","absolute","w-fit","h-2rem","p-3","text-center","flex","align-items-center","align-content-center","popup",2,"top","30px","border-radius","15px","box-shadow","var(--shadows)"],[1,"w-8rem","h-2rem","flex","justify-content-center","align-items-center"],[1,"relative","w-full","flex"],[1,"m-auto","text-600","flex","align-content-center","align-items-center"],[1,"w-full","flex",3,"click"],[1,"relative","w-full","flex",3,"click"],["class","mr-1 material-icons-outlined",4,"ngIf"],["class","mr-1","style","background: var(--gradient45); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;",4,"ngIf"],[1,"mr-1",2,"background","var(--gradient45)","-webkit-background-clip","text","-moz-background-clip","text","background-clip","text","-webkit-text-fill-color","transparent"],[3,"playlistId","display","comments","numComments","hide"],[3,"vibeId","display","comments","numComments","hide"],[3,"vibeId","playlists","display","hide","showAddToPlaylistDialog"],[3,"display","vibeId","showDialog","newPlaylist"],[1,"flex","align-items-center","justify-content-center","no-activity",2,"width","100%"],[1,"flex","flex-column","align-items-center","justify-content-center"],[2,"height","300px","width","300px","content","var(--logoEmpty)","background-size","cover","background-repeat","no-repeat","background-position","center"],["data-cy","no-activity",1,"text-center"]],template:function(e,o){1&e&&(W(0,Wie,39,24,"div",0),W(1,qie,6,0,"div",1)),2&e&&(L("ngForOf",o.activities),F(1),L("ngIf",0==o.activities.length&&o.pageLoaded))},dependencies:[Qh,Ns,Xn,_a,VC,dN,pN,zd,sie,cie,Su],styles:["p[_ngcontent-%COMP%]{margin:0;transition:none}.activity-container[_ngcontent-%COMP%]{border-bottom:solid 1px var(--separationLine);width:100%;display:flex;padding:1.5rem}.image-column[_ngcontent-%COMP%]{width:50px;height:100%;align-items:start;margin-right:1rem}.text-column[_ngcontent-%COMP%]{flex-grow:1;width:100%;height:100%;justify-content:center;align-items:start}.bottom-icons[_ngcontent-%COMP%]:hover{color:var(--primary-color)!important;cursor:pointer}.bottom-icons-text[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.clipboard-position[_ngcontent-%COMP%]{right:40px}.body-map[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;justify-content:flex-end;border-radius:10px;height:400px;box-shadow:var(--shadows)!important}.playlist-background[_ngcontent-%COMP%]{background:var(--gradientVerticalAlpha);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}.popup[_ngcontent-%COMP%]{color:var(--primary-color);background-color:var(--frostedBackground);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:none}.hide-album[_ngcontent-%COMP%]{visibility:visible;opacity:1;transition:opacity 1s linear}.hide-image[_ngcontent-%COMP%]{display:none}.no-activity[_ngcontent-%COMP%]{height:calc(100vh - 184px)}.popup-vibe-sm[_ngcontent-%COMP%]{visibility:hidden;opacity:0;background:var(--gradientHorizontalAlpha);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);cursor:pointer}@media (max-width: 1450px){.bottom-icons-text[_ngcontent-%COMP%]{width:90px}.clipboard-position[_ngcontent-%COMP%]{right:10px}}@media (max-width: 1300px){.bottom-icons-text[_ngcontent-%COMP%]{width:68px}.clipboard-position[_ngcontent-%COMP%]{right:0}.no-activity[_ngcontent-%COMP%]{height:100%}}@media (max-width: 1200px){.bottom-icons-text[_ngcontent-%COMP%]{width:120px}.clipboard-position[_ngcontent-%COMP%]{right:40px}}@media (max-width: 1050px){.bottom-icons-text[_ngcontent-%COMP%]{width:100px}.clipboard-position[_ngcontent-%COMP%]{right:20px}.hide-album[_ngcontent-%COMP%]{visibility:hidden;opacity:0;transition:visibility 0s 1s,opacity 1s linear}.popup-vibe-sm[_ngcontent-%COMP%]{visibility:visible;left:0;bottom:10px;opacity:1;transition:opacity 1s linear}}@media (max-width: 950px){.bottom-icons-text[_ngcontent-%COMP%]{width:90px}.clipboard-position[_ngcontent-%COMP%]{right:0}}@media (max-width: 910px){.bottom-icons-text[_ngcontent-%COMP%]{display:none}}@media (max-width: 640px){.hide-image[_ngcontent-%COMP%]{display:flex}.hide-image-column[_ngcontent-%COMP%]{display:none}.margin-image[_ngcontent-%COMP%]{margin-bottom:10px}}"],data:{animation:[pl("fadeInOut",[qo(":enter",[po({opacity:0}),$o("500ms",po({opacity:1}))]),qo(":leave",[$o("500ms",po({opacity:0}))])])]}}),t})();function Kie(t,n){1&t&&(P(0,"div",7),Ae(1,"app-loader"),N())}function Xie(t,n){1&t&&(P(0,"div",8)(1,"h1",9),ie(2," Actividad reciente "),N()())}function Yie(t,n){1&t&&Ae(0,"img",26),2&t&&Ai("src",U().$implicit.profileImage,Ui)}function Qie(t,n){1&t&&Ae(0,"img",27)}const Jie=function(t){return["/friendProfile/",t]};function eoe(t,n){if(1&t&&(P(0,"div",16)(1,"div",17),W(2,Yie,1,1,"img",18),W(3,Qie,1,0,"img",19),N(),P(4,"div",20)(5,"div")(6,"p",21),ie(7),wo(8,"slice"),N(),P(9,"p",22),ie(10),N()()(),P(11,"div",23)(12,"button",24)(13,"span",25),ie(14," Conectar "),N()()()()),2&t){const e=n.$implicit;F(2),L("ngIf",""!=e.profileImage),F(1),L("ngIf",""==e.profileImage),F(4),jn(" ",e.name.length>20?Nr(8,5,e.name,0,18)+"...":e.name," "),F(3),jn(" @",e.nickname," "),F(2),L("routerLink",Wt(9,Jie,e.userId))}}function toe(t,n){1&t&&(P(0,"div",16)(1,"div",20)(2,"div")(3,"p",21),ie(4," No hay sugerencias "),N()()()())}function noe(t,n){1&t&&Ae(0,"img",32),2&t&&Ai("src",U().$implicit.playlistImage,Ui)}function ioe(t,n){1&t&&Ae(0,"img",33)}const ooe=function(t){return["/playlists/",t]};function roe(t,n){if(1&t&&(P(0,"div",28)(1,"div",29),W(2,noe,1,1,"img",30),W(3,ioe,1,0,"img",31),N(),P(4,"div",20)(5,"div")(6,"p",21),ie(7),N(),P(8,"p",22),ie(9),wo(10,"date"),N()()()()),2&t){const e=n.$implicit;L("routerLink",Wt(8,ooe,e.playlistId)),F(2),L("ngIf",""!=e.playlistImage),F(1),L("ngIf",""==e.playlistImage),F(4),jn(" ",e.name," "),F(2),jn(" ",zl(10,5,e.creationDate,"dd/MM/yyyy"),"")}}function soe(t,n){1&t&&(P(0,"div",16)(1,"div",20)(2,"div")(3,"p",21),ie(4," No hay playlists "),N()()()())}function aoe(t,n){if(1&t&&(P(0,"div",10)(1,"div",11)(2,"h2",12),ie(3," A qui\xe9n seguir "),N(),W(4,eoe,15,11,"div",13),W(5,toe,5,0,"div",14),N(),P(6,"div",11)(7,"h2",12),ie(8," Tus playlists "),N(),W(9,roe,11,10,"div",15),W(10,soe,5,0,"div",14),N()()),2&t){const e=U();F(4),L("ngForOf",e.followSuggestions),F(1),L("ngIf",0==e.followSuggestions.length),F(4),L("ngForOf",e.yourPaylists),F(1),L("ngIf",0==e.yourPaylists.length)}}let loe=(()=>{class t{constructor(e,o,r,s,l){this.router=e,this.appLayout=o,this.usersService=r,this.playlistsService=s,this.titleService=l,this.loadingPage=!0,this.titleService.setTitle("Inicio | Spotivibes")}ngOnInit(){this.getUserReccomendations(),this.getPlaylists()}getUserReccomendations(){var e=this;return Ft(function*(){try{const o=yield e.usersService.recommendUsers();e.followSuggestions=o.users}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}getPlaylists(){var e=this;return Ft(function*(){try{const o=yield e.playlistsService.getPlaylists();e.yourPaylists=o.myPlaylists}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}activityLoaded(e){this.loadingPage=e}newPlaylistEvent(e){this.yourPaylists.push(e)}}return t.\u0275fac=function(e){return new(e||t)(ce(Ss),ce(Zo),ce(Mg),ce(ku),ce(_c))},t.\u0275cmp=Qt({type:t,selectors:[["app-home"]],decls:7,vars:4,consts:[["class","content",4,"ngIf"],[1,"home-main-container"],[1,"home-primary-column"],["class","route-name sticky-topbar",4,"ngIf"],[1,"primary-column-content","pb-6"],[3,"playlists","loaded","newPlaylist"],["class","home-secondary-column",4,"ngIf"],[1,"content"],[1,"route-name","sticky-topbar"],[1,"current-route"],[1,"home-secondary-column"],[1,"secondary-column-continer"],[1,"mb-2"],["class","flex align-items-center w-full mt-3",4,"ngFor","ngForOf"],["class","flex align-items-center w-full mt-3",4,"ngIf"],["class","grow flex align-items-center w-full mt-1 hover-item p-2",3,"routerLink",4,"ngFor","ngForOf"],[1,"flex","align-items-center","w-full","mt-3"],[1,"round-images-size","mr-3"],["alt","suggestion.name","class","round-images round-images-size",3,"src",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","alt","suggestion.name","class","round-images round-images-size","style","background: var(--background);",4,"ngIf"],[1,"flex-grow-1","flex","mr-3"],[1,"p-0","m-0"],[1,"p-0","m-0","text-500"],[1,"margin-td-right",2,"float","right"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient",3,"routerLink"],[1,"vibe-btn-text-white","font-normal","text-xs"],["alt","suggestion.name",1,"round-images","round-images-size",3,"src"],["src","assets/images/profilePlaceholder.svg","alt","suggestion.name",1,"round-images","round-images-size",2,"background","var(--background)"],[1,"grow","flex","align-items-center","w-full","mt-1","hover-item","p-2",3,"routerLink"],[1,"mr-3",2,"height","60px","width","60px","border-radius","5px"],["alt","suggestion.name","style","height: 60px; width: 60px; object-fit: cover; border-radius: 5px; box-shadow: var(--shadows);",3,"src",4,"ngIf"],["src","assets/images/playlist-placeholder.svg","alt","suggestion.name","style","background: var(--background); height: 60px; width: 60px; object-fit: cover; border-radius: 5px; box-shadow: var(--shadows);",4,"ngIf"],["alt","suggestion.name",2,"height","60px","width","60px","object-fit","cover","border-radius","5px","box-shadow","var(--shadows)",3,"src"],["src","assets/images/playlist-placeholder.svg","alt","suggestion.name",2,"background","var(--background)","height","60px","width","60px","object-fit","cover","border-radius","5px","box-shadow","var(--shadows)"]],template:function(e,o){1&e&&(W(0,Kie,2,0,"div",0),P(1,"div",1)(2,"div",2),W(3,Xie,3,0,"div",3),P(4,"div",4)(5,"app-home-activity",5),Te("loaded",function(s){return o.activityLoaded(s)})("newPlaylist",function(s){return o.newPlaylistEvent(s)}),N()()(),W(6,aoe,11,4,"div",6),N()),2&e&&(L("ngIf",o.loadingPage),F(3),L("ngIf",!o.appLayout.showBar&&!o.loadingPage),F(2),L("playlists",o.yourPaylists),F(1),L("ngIf",!o.loadingPage))},dependencies:[Qh,Ns,Xn,Dr,Zie,zd,Su,Ab],styles:["[_nghost-%COMP%]{width:100%}.home-main-container[_ngcontent-%COMP%]{display:flex}.home-primary-column[_ngcontent-%COMP%]{flex-grow:1;width:100%;height:100vh;overflow:scroll}.primary-column-content[_ngcontent-%COMP%]{border-right:solid 1px var(--separationLine);padding-top:1rem}.home-secondary-column[_ngcontent-%COMP%]{width:500px;height:100vh;overflow:scroll;padding:1.5rem}.secondary-column-continer[_ngcontent-%COMP%]{background:var(--containerBackground);border-radius:10px;padding:1rem;margin-bottom:1.5rem}.sticky-topbar[_ngcontent-%COMP%]{position:sticky;z-index:1000;position:-webkit-sticky;top:0;box-shadow:var(--shadows);background:var(--frostedBackground);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}.hover-item[_ngcontent-%COMP%]{transition:var(--transition)}.hover-item[_ngcontent-%COMP%]:hover{transition:var(--transition);border-radius:10px;background:var(--surface-hover);cursor:pointer}.hover-item[_ngcontent-%COMP%]:active{border-radius:10px;background:var(--surface-300);transition:var(--transition)}@media (max-width: 1300px){.home-main-container[_ngcontent-%COMP%]{display:grid}.home-primary-column[_ngcontent-%COMP%]{transition:var(--transition);height:100%}.home-secondary-column[_ngcontent-%COMP%]{height:100%;width:100%}.primary-column-content[_ngcontent-%COMP%]{transition:var(--transition);border:none}}"]}),t})();function coe(t,n){1&t&&Ae(0,"p-progressSpinner",29)}let jC=(()=>{class t{constructor(e,o,r,s,l){this.appComponent=e,this.authService=o,this.router=r,this.route=s,this.messageService=l,this.displayFirstLogin=!1,this.displaySuccess=!1,this.loadingSpotify=!1,this.loadingSpotifyText="Iniciar sesi\xf3n con Spotify",this.newAccount=!1,this.isAdmin=!1}ngOnInit(){this.image=this.getImage(),this.route.snapshot.queryParams.code&&this.route.snapshot.queryParams.state?(this.loadingSpotify=!0,this.loadingSpotifyText="Conectando...",this.authService.doLogin(this.route.snapshot.queryParams.code,this.route.snapshot.queryParams.state).then(e=>{"Authenticated"==e.status?this.router.navigate(["/home"]):"Spotify token invalid or expired"==e.status?(this.messageService.add({severity:"error",summary:"Error de conexi\xf3n",detail:"Error de conexi\xf3n con Spotify"}),this.loadingSpotify=!1,this.loadingSpotifyText="Iniciar sesi\xf3n con Spotify"):"User not registered"==e.status&&(sessionStorage.setItem("spotifyAccessToken",e.spotifyAccessToken),sessionStorage.setItem("spotifyRefreshToken",e.spotifyRefreshToken),this.displayFirstLogin=!0,this.loadingSpotify=!1,this.loadingSpotifyText="Iniciar sesi\xf3n con Spotify")})):(this.loadingSpotify=!1,this.loadingSpotifyText="Iniciar sesi\xf3n con Spotify")}getImage(){return"assets/images/"+Math.floor(5*Math.random())+".jpg"}onError(e){this.messageService.add({severity:"error",summary:"Error de conexi\xf3n",detail:e})}connectSpotify(){var e=this;return Ft(function*(){e.loadingSpotify=!0,e.loadingSpotifyText="Conectando...",e.authService.redirect().then(o=>{console.log(o)})})()}}return t.\u0275fac=function(e){return new(e||t)(ce(pD),ce(AC),ce(Ss),ce(Yh),ce(Rd))},t.\u0275cmp=Qt({type:t,selectors:[["app-landing-page"]],features:[zi([Rd])],decls:70,vars:4,consts:[[1,"content-wrapper"],[1,"grid","grid-nogutter","containers-image","sombra","text-800","overflow-hidden",2,"transition","var(--transition)"],[1,"col-whidth","p-6","text-center","md:text-left","flex","align-items-center"],[1,"grid","align-items-center","align-content-center","min-height",2,"max-width","800px"],["alt","logo",1,"logo"],[1,"mt-2","mb-4","text-700","line-height-3"],["pButton","","pRipple","","type","button",1,"spoty-btn","h-3rem","w-17rem","button-margin",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],["src","assets/images/spotify-white.svg","width","20","height","20","alt","logo",1,"spoty-icon","mr-2"],[1,"vibe-btn-text-white","w-full"],[1,"col-whidth","overflow-hidden"],["alt","Spotivibes",1,"md:ml-auto","block","h-full","w-full","poligon-clip",2,"object-fit","cover",3,"src"],["id","features",1,"p-7"],[1,"grid","justify-content-center"],[1,"col-12","text-center","mb-6"],[1,"text-900","font-normal","mb-2"],[1,"text-600","text-2xl"],[1,"col-12","md:col-6","lg:col-3","p-0","lg:pr-5","lg:pb-5","mt-4","lg:mt-0"],[1,"flex","align-items-center","justify-content-center","mb-3","sombra",2,"width","10rem","height","10rem","border-radius","100%","background","var(--gradientVertical)"],[1,"flex","align-items-center","justify-content-center","bg-white",2,"width","8rem","height","8rem","border-radius","100%"],[1,"pi","pi-fw","pi-users","gradient-btn-text",2,"font-size","4rem"],[1,"text-center"],[1,"font-bold"],[1,"pi","pi-fw","pi-map","gradient-btn-text",2,"font-size","4rem"],[1,"pi","pi-fw","pi-images","gradient-btn-text",2,"font-size","4rem"],[1,"pi","pi-fw","pi-heart","gradient-btn-text",2,"font-size","4rem"],[3,"errorMessage"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"]],template:function(e,o){1&e&&(Ae(0,"p-toast"),P(1,"div",0)(2,"div",1)(3,"div",2)(4,"section",3),Ae(5,"img",4),P(6,"p",5),ie(7,"Crea tus vibes poniendo en el mapa las canciones que te recuerdan a cada uno de tus lugares favoritos. Haz playlists y comp\xe1rtelas con tus amigos."),N(),P(8,"button",6),Te("click",function(){return o.connectSpotify()}),P(9,"div",7)(10,"span",8),W(11,coe,1,0,"p-progressSpinner",9),Ae(12,"img",10),P(13,"p",11),ie(14),N()()()()()(),P(15,"div",12),Ae(16,"img",13),N()(),P(17,"div",14)(18,"div",15)(19,"div",16)(20,"h2",17),ie(21,"\xbfQu\xe9 puedes hacer en Spotivibes?"),N(),P(22,"span",18),ie(23,"Spotivibes te ofrece todo esto \xa1Y m\xe1s!"),N()(),P(24,"div",19)(25,"div",8)(26,"div",20)(27,"div",21),Ae(28,"i",22),N()()(),P(29,"div",23)(30,"p",24),ie(31,"Explora los vibes de tus amigos"),N()(),P(32,"div",23)(33,"p"),ie(34,"Visualizalos en el mapa de canciones"),N()()(),P(35,"div",19)(36,"div",8)(37,"div",20)(38,"div",21),Ae(39,"i",25),N()()(),P(40,"div",23)(41,"p",24),ie(42,"Comparte tu m\xfasica"),N()(),P(43,"div",23)(44,"p"),ie(45,"Sit\xfaa tus canciones en el mapa"),N()()(),P(46,"div",19)(47,"div",8)(48,"div",20)(49,"div",21),Ae(50,"i",26),N()()(),P(51,"div",23)(52,"p",24),ie(53,"Crea y escucha tus playlists en Spotify"),N()(),P(54,"div",23)(55,"p"),ie(56,"Con las canciones que m\xe1s te gustan"),N()()(),P(57,"div",19)(58,"div",8)(59,"div",20)(60,"div",21),Ae(61,"i",27),N()()(),P(62,"div",23)(63,"p",24),ie(64,"Haz amigos y comparte su m\xfasica"),N()(),P(65,"div",23)(66,"p"),ie(67,"Conoce gente con tus mismos gustos"),N()()()()()(),Ae(68,"app-footer"),P(69,"app-login-dialog",28),Te("errorMessage",function(s){return o.onError(s)}),N()),2&e&&(F(8),L("disabled",o.loadingSpotify),F(3),L("ngIf",o.loadingSpotify),F(3),Ut(o.loadingSpotifyText),F(2),Ai("src",o.image,Ui))},styles:[".logo[_ngcontent-%COMP%]{content:var(--logo);background-size:cover;background-repeat:no-repeat;background-position:center;color:red;width:100%}.col-whidth[_ngcontent-%COMP%]{width:50%}.min-height[_ngcontent-%COMP%]{min-height:500px}.poligon-clip[_ngcontent-%COMP%]{transition:var(--transition);clip-path:polygon(15% 0,100% 0,100% 100%,0 100%)}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:#fff!important}@media (max-width: 767px){.poligon-clip[_ngcontent-%COMP%]{clip-path:polygon(0 0,100% 0,100% 100%,0 100%)}.button-margin[_ngcontent-%COMP%]{margin:auto}.col-whidth[_ngcontent-%COMP%]{width:100%}.min-height[_ngcontent-%COMP%]{min-height:300px}}.sombra[_ngcontent-%COMP%]{box-shadow:var(--shadows)}.gradient-btn-text[_ngcontent-%COMP%]{background-image:var(--gradientVertical);font-weight:700;font-size:larger;width:100%;background-size:100%;background-clip:border-box;-webkit-background-clip:text;-moz-background-clip:text;-webkit-text-fill-color:transparent;-moz-text-fill-color:transparent}[_nghost-%COMP%]     .p-dialog{border-radius:1rem}[_nghost-%COMP%]     .p-dialog-header{border-top-left-radius:1rem;border-top-right-radius:1rem}[_nghost-%COMP%]     .p-dialog-footer{border-bottom-left-radius:1rem;border-bottom-right-radius:1rem}"]}),t})();function uoe(t,n){if(1&t){const e=Ye();P(0,"div",3)(1,"h1",4),ie(2),N(),P(3,"p-selectButton",5),Te("ngModelChange",function(r){return be(e),ve(U().selectedButton=r)}),N()()}if(2&t){const e=U();F(2),jn(" ",e.appLayout.currentRoute," "),F(1),L("options",e.options)("ngModel",e.selectedButton)}}function doe(t,n){if(1&t&&Ae(0,"app-map-vibes",10),2&t){const e=U(2);L("initMapEvent",e.vibesLoaded.asObservable())("vibesArray",e.allVibes)("mapHeight",e.mapHeight)("id",e.mapPublico)("map",!0)("showSearchBar",!0)("showLocationButton",!1)}}function hoe(t,n){if(1&t&&Ae(0,"app-map-vibes",10),2&t){const e=U(2);L("initMapEvent",e.vibesLoaded.asObservable())("vibesArray",e.friendsVibes)("mapHeight",e.mapHeight)("id",e.mapAmigos)("map",!0)("showSearchBar",!0)("showLocationButton",!1)}}function poe(t,n){if(1&t&&Ae(0,"app-map-vibes",10),2&t){const e=U(2);L("initMapEvent",e.vibesLoaded.asObservable())("vibesArray",e.myVibes)("mapHeight",e.mapHeight)("id",e.mapPrivado)("map",!0)("showSearchBar",!0)("showLocationButton",!1)}}function foe(t,n){if(1&t){const e=Ye();P(0,"div",6)(1,"p-selectButton",7),Te("ngModelChange",function(r){return be(e),ve(U().selectedButton=r)}),N(),P(2,"div",8),W(3,doe,1,7,"app-map-vibes",9),W(4,hoe,1,7,"app-map-vibes",9),W(5,poe,1,7,"app-map-vibes",9),N()()}if(2&t){const e=U();F(1),L("options",e.options)("ngModel",e.selectedButton),F(2),L("ngIf",1==e.selectedButton),F(1),L("ngIf",2==e.selectedButton),F(1),L("ngIf",3==e.selectedButton)}}function moe(t,n){1&t&&(P(0,"div",11),Ae(1,"app-loader"),N())}let goe=(()=>{class t{constructor(e,o,r){this.appLayout=e,this.vibesService=o,this.titleService=r,this.selectedButton=1,this.mapPublico="mapPublico",this.mapPrivado="mapPrivado",this.mapAmigos="mapAmigos",this.mapHeight="calc(100vh)",this.pageLoading=!0,this.vibesLoaded=new si,this.titleService.setTitle("Mapa | Spotivibes"),this.options=[{name:"Todos los vibes",value:1},{name:"Vibes de mis amigos",value:2},{name:"Mis vibes",value:3}]}ngOnInit(){this.getVibes()}ngAfterViewChecked(){window.innerWidth>=1400?this.mapHeight="calc(100vh - 200px)":window.innerWidth<1400&&window.innerWidth>=1e3?this.mapHeight="calc(100vh - 175px)":window.innerWidth<1e3&&window.innerWidth>=900?this.mapHeight="calc(100vh - 230px)":window.innerWidth<900&&window.innerWidth>=700?this.mapHeight="calc(100vh - 215px)":window.innerWidth<700&&(this.mapHeight="calc(100vh - 160px)")}getVibes(){var e=this;return Ft(function*(){try{const o=yield e.vibesService.getVibes("all"),r=o.vibes.filter(l=>e.appLayout.user.friendsIds.includes(l.userId)),s=o.vibes.filter(l=>l.userId==e.appLayout.user.userId);e.allVibes=o.vibes,e.friendsVibes=r,e.myVibes=s,yield new Promise(l=>setTimeout(l,200)),e.vibesLoaded.next(),e.pageLoading=!1}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(Oy),ce(_c))},t.\u0275cmp=Qt({type:t,selectors:[["app-map"]],decls:3,vars:3,consts:[["class","route-name flex align-items-center",4,"ngIf"],["class","content","style","transition: none !important;",4,"ngIf"],["class","content",4,"ngIf"],[1,"route-name","flex","align-items-center"],[1,"current-route","w-full"],["optionLabel","name","optionValue","value",1,"hide-buttons-lg",3,"options","ngModel","ngModelChange"],[1,"content",2,"transition","none !important"],["optionLabel","name","optionValue","value",1,"diaplay-buttons-sm",3,"options","ngModel","ngModelChange"],["id","map",1,"map-container"],[3,"initMapEvent","vibesArray","mapHeight","id","map","showSearchBar","showLocationButton",4,"ngIf"],[3,"initMapEvent","vibesArray","mapHeight","id","map","showSearchBar","showLocationButton"],[1,"content"]],template:function(e,o){1&e&&(W(0,uoe,4,3,"div",0),W(1,foe,6,5,"div",1),W(2,moe,2,0,"div",2)),2&e&&(L("ngIf",!o.appLayout.showBar),F(1),L("ngIf",!o.pageLoading),F(1),L("ngIf",o.pageLoading))},dependencies:[Xn,$a,Id,nN,VC,zd],styles:["[_nghost-%COMP%]{width:100%}.mapboxgl-popup[_ngcontent-%COMP%]{max-width:400px;font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif}.map-container[_ngcontent-%COMP%]{box-shadow:var(--shadows);border-radius:10px}[_nghost-%COMP%]     .p-component{display:flex;width:max-content;border-radius:10px}  .p-buttonset .p-button:first-of-type{border-radius:10px 0 0 10px!important}  .p-buttonset .p-button:not(:first-of-type):not(:last-of-type){border-radius:0!important}  .p-buttonset .p-button:last-of-type{border-top-left-radius:0!important;border-bottom-left-radius:0!important}  .p-component{border-radius:.6rem}.hide-buttons-lg[_ngcontent-%COMP%]{display:grid}.diaplay-buttons-sm[_ngcontent-%COMP%]{display:none}@media (max-width: 1000px){.hide-buttons-lg[_ngcontent-%COMP%]{display:none}.diaplay-buttons-sm[_ngcontent-%COMP%]{display:grid}[_nghost-%COMP%]     .p-button .p-button-label{font-size:.9rem}[_nghost-%COMP%]     .p-component{width:100%;margin-bottom:1rem}}"]}),t})();function _oe(t,n){1&t&&(P(0,"div",8)(1,"div",9)(2,"div",10)(3,"h4",11),ie(4," Solicitudes de amistad "),N()()()())}function yoe(t,n){1&t&&(P(0,"tr")(1,"th",12)(2,"div",13),ie(3," Nombre "),N()(),P(4,"th",14)(5,"div",15),ie(6," Aceptar / Rechazar "),N()()())}function voe(t,n){if(1&t&&Ae(0,"img",27),2&t){const e=U().$implicit;Ai("src",e.profileImage,Ui),L("alt",e.name)}}function boe(t,n){1&t&&Ae(0,"img",28),2&t&&L("alt",U().$implicit.name)}function xoe(t,n){if(1&t){const e=Ye();P(0,"tr")(1,"td",16)(2,"div",17)(3,"div",18),W(4,voe,1,2,"img",19),W(5,boe,1,1,"img",20),N(),P(6,"div",21),ie(7),N()()(),P(8,"td",16)(9,"div",22)(10,"button",23),Te("click",function(){const s=be(e).$implicit;return ve(U().onClickRequest(s.userId,!0))}),P(11,"span",24)(12,"mat-icon"),ie(13,"check"),N()()(),P(14,"button",25),Te("click",function(){const s=be(e).$implicit;return ve(U().onClickRequest(s.userId,!1))}),P(15,"span",26)(16,"mat-icon"),ie(17,"close"),N()()()()()()}if(2&t){const e=n.$implicit,o=U();F(4),L("ngIf",""!=e.profileImage),F(1),L("ngIf",""==e.profileImage),F(2),Ut(e.name),F(3),L("disabled",o.buttonDisabled),F(4),L("disabled",o.buttonDisabled)}}function woe(t,n){1&t&&(P(0,"tr")(1,"td",29),ie(2,"No tienes solicitudes de amistad."),N()())}const Coe=function(){return["name","nickname"]},Toe=function(){return[10,25,50]};let Soe=(()=>{class t{constructor(e,o){this.friendsService=e,this.appLayout=o,this.buttonDisabled=!1}ngOnInit(){this.getFriendRequests()}getEventValue(e){return e.target.value}getFriendRequests(){var e=this;return Ft(function*(){try{const o=yield e.friendsService.getFriendRequests();e.requests=o.friendsRequests;const r=o.friendsRequests.length;e.appLayout.hayNotificaciones=r>0,e.appLayout.numNotificaciones=r.toString()}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}onClickRequest(e,o){var r=this;return Ft(function*(){try{r.buttonDisabled=!0,yield r.friendsService.acceptFriendRequest(e,o);for(let s=0;s<r.requests.length;s++)if(r.requests[s].userId==e){r.requests.splice(s,1),r.appLayout.messageService.add({severity:"success",summary:"Solicitud cancelada",detail:"Has cancelado la solicitd de "+r.requests[s].name});break}}catch(s){403==s.status?r.appLayout.handle403Error():r.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.data.status})}})()}}return t.\u0275fac=function(e){return new(e||t)(ce(Py),ce(Zo))},t.\u0275cmp=Qt({type:t,selectors:[["app-notifications-table"]],decls:9,vars:8,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers"],["currentPageReportTemplate","{first} a {last}",3,"value","rows","rowHover","globalFilterFields","paginator","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"text-center","md:text-left"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center"],["pSortableColumn","boton"],[1,"flex","justify-content-between","align-items-center",2,"float","right"],[1,"padding-td"],[2,"display","flex","align-items","flex-start"],[1,"round-images-size"],["class","round-images round-images-size","style","opacity: 1 !important;",3,"src","alt",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","class","round-images round-images-size","style","opacity: 1 !important; background-color: var(--background);",3,"alt",4,"ngIf"],[1,"ml-3","name-size",2,"height","40px","text-align","center","display","flex","align-items","center","line-height","40px"],[1,"margin-td-right",2,"float","right"],["type","button",1,"button-width","text-base","p-button-text","border-round-xl","h-2rem","vibe-btn","mr-2",3,"disabled","click"],[1,"text-green-500","flex","align-items-center","justify-content-center"],["type","button",1,"button-width","text-base","p-button-text","border-round-xl","h-2rem","vibe-btn",3,"disabled","click"],[1,"text-pink-500","flex","align-items-center","justify-content-center"],[1,"round-images","round-images-size",2,"opacity","1 !important",3,"src","alt"],["src","assets/images/profilePlaceholder.svg",1,"round-images","round-images-size",2,"opacity","1 !important","background-color","var(--background)",3,"alt"],["colspan","8"]],template:function(e,o){1&e&&(P(0,"h3",0),ie(1," Solicitudes de amistad "),N(),P(2,"div",1)(3,"p-table",2,3),W(5,_oe,5,0,"ng-template",4),W(6,yoe,7,0,"ng-template",5),W(7,xoe,18,5,"ng-template",6),W(8,woe,3,0,"ng-template",7),N()()),2&e&&(F(3),L("value",o.requests)("rows",10)("rowHover",!0)("globalFilterFields",Kn(6,Coe))("paginator",!0)("rowsPerPageOptions",Kn(7,Toe)))},dependencies:[Xn,fo,Nd,E0,_a],styles:[".padding-td[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important;padding-left:1rem!important;padding-right:0!important}.margin-td-right[_ngcontent-%COMP%]{margin-right:1rem!important}.name-size[_ngcontent-%COMP%]{font-size:1rem!important}.button-width[_ngcontent-%COMP%]{width:80px!important}@media (max-width: 710px){.padding-td[_ngcontent-%COMP%]{padding-top:.75rem!important;padding-bottom:.75rem!important;padding-left:.75rem!important;padding-right:0!important}.margin-td-right[_ngcontent-%COMP%]{margin-right:.75rem!important}}@media (max-width: 600px){.name-size[_ngcontent-%COMP%]{font-size:.9rem!important}.button-width[_ngcontent-%COMP%]{width:60px!important}}"]}),t})();function Eoe(t,n){1&t&&(P(0,"div",7)(1,"div",8)(2,"div",9)(3,"h4",10),ie(4," Notificaciones recientes"),N()()()())}function Ioe(t,n){if(1&t&&Ae(0,"img",30),2&t){const e=U().$implicit;Ai("src",e.userProfileImage,Ui),L("alt",e.userName)}}function Doe(t,n){1&t&&Ae(0,"img",31),2&t&&L("alt",U().$implicit.userName)}const gN=function(t){return{opacity:t}};function Moe(t,n){if(1&t&&Ae(0,"img",32),2&t){const e=U().$implicit,o=U();Ai("src",e.vibe.songImage,Ui),L("ngStyle",Wt(2,gN,o.appLayout.playingSong==e.vibe.spotifySongId?"0.4":"1"))}}function koe(t,n){if(1&t){const e=Ye();P(0,"mat-icon",34),Te("click",function(){be(e);const r=U(2).$implicit;return ve(U().playPreview(r.vibe.spotifySongId,r.vibe.songPreview))}),ie(1),N()}if(2&t){const e=U(2).$implicit,o=U();L("ngStyle",Wt(2,gN,o.appLayout.playingSong==e.vibe.spotifySongId?"1":"0")),F(1),Ut(o.appLayout.playingSong==e.vibe.spotifySongId?o.appLayout.previewIcon:"play_arrow")}}function Aoe(t,n){if(1&t&&(P(0,"div"),W(1,koe,2,4,"mat-icon",33),N()),2&t){const e=U().$implicit;F(1),L("ngIf",null!=e.vibe.songPreview)}}function Poe(t,n){1&t&&Ae(0,"img",35),2&t&&Ai("src",U().$implicit.playlist.playlistImage,Ui)}function Ooe(t,n){1&t&&Ae(0,"img",36)}function Loe(t,n){if(1&t&&(P(0,"h4",37),ie(1),wo(2,"slice"),N()),2&t){const e=U().$implicit;F(1),jn("",e.vibe.songName.length>20?Nr(2,1,e.vibe.songName,0,20)+"...":e.vibe.songName," ")}}function Roe(t,n){if(1&t&&(P(0,"h5",38),ie(1),N()),2&t){const e=U().$implicit;F(1),Ut(e.vibe.songAuthor)}}function Foe(t,n){if(1&t&&(P(0,"h4",39),ie(1),wo(2,"slice"),N()),2&t){const e=U().$implicit;F(1),Ut(e.playlist.name.length>20?Nr(2,1,e.playlist.name,0,20)+"...":e.playlist.name)}}function Noe(t,n){if(1&t&&(P(0,"tr")(1,"td",11)(2,"div",12)(3,"div",13),W(4,Ioe,1,2,"img",14),W(5,Doe,1,1,"img",15),N(),P(6,"div")(7,"div",16),ie(8),N(),P(9,"div",17),ie(10),N()()()(),P(11,"td",18)(12,"div",19)(13,"div",20)(14,"div",21),W(15,Moe,1,4,"img",22),W(16,Aoe,2,1,"div",23),W(17,Poe,1,1,"img",24),W(18,Ooe,1,0,"img",25),N(),P(19,"div",26),W(20,Loe,3,5,"h4",27),W(21,Roe,2,1,"h5",28),N(),W(22,Foe,3,5,"h4",29),N()()()()),2&t){const e=n.$implicit;F(4),L("ngIf",""!=e.userProfileImage),F(1),L("ngIf",""==e.userProfileImage),F(3),jn(" \xa1",e.message,"! "),F(2),jn(" ",e.userName," "),F(5),L("ngIf",null!=e.vibe),F(1),L("ngIf",null!=e.vibe),F(1),L("ngIf",null!=e.playlist&&""!=e.playlist.playlistImage),F(1),L("ngIf",null!=e.playlist&&""==e.playlist.playlistImage),F(2),L("ngIf",null!=e.vibe),F(1),L("ngIf",null!=e.vibe),F(1),L("ngIf",null!=e.playlist)}}function zoe(t,n){1&t&&(P(0,"tr")(1,"td",40),ie(2,"No tienes notificaciones."),N()())}const Boe=function(){return[10,25,50]};let Voe=(()=>{class t{constructor(e){this.appLayout=e}getEventValue(e){return e.target.value}playPreview(e,o){this.appLayout.playPreview(e,o)}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo))},t.\u0275cmp=Qt({type:t,selectors:[["app-notifications-list"]],inputs:{notificaciones:"notificaciones"},decls:8,vars:7,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers"],["currentPageReportTemplate","{first} a {last}",3,"value","rows","paginator","rowHover","showCurrentPageReport","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"md:m-0","text-center","md:text-left"],[1,"padding-td",2,"max-width","fit-content"],[1,"flex","align-items-center"],[1,"round-images-size","mr-3"],["class","round-images round-images-size","style","opacity: 1 !important;",3,"src","alt",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","class","round-images round-images-size","style","opacity: 1 !important; background-color: var(--containerBackground);",3,"alt",4,"ngIf"],[1,"text-left","font-size","max-with-desc"],[1,"text-left","font-size","max-with-desc","text-500","mt-1"],[1,"padding-td"],[1,"flex"],[1,"flex","align-items-center","margin-sm"],[1,"overflow-hidden","mr-3","relative",2,"min-width","40px","height","40px","width","40px","border-radius","5px","box-shadow","var(--shadows)"],["alt","album","height","100","width","200","class","h-full w-auto","style","border-radius: 5px; overflow: hidden; cursor: pointer;",3,"src","ngStyle",4,"ngIf"],[4,"ngIf"],["height","100","width","200","class","h-full w-auto","style","overflow: hidden; opacity: 1 !important;",3,"src","alt",4,"ngIf"],["src","assets/images/playlist-placeholder.svg","height","100","width","200","class","h-full w-auto","style","background-color: var(--containerBackground); overflow: hidden; opacity: 1 !important;",3,"alt",4,"ngIf"],[1,"max-width-noti"],["class","text-align-right font-size",4,"ngIf"],["class","text-align-right font-size font-normal",4,"ngIf"],["class","flex align-items-center font-size h-full",4,"ngIf"],[1,"round-images","round-images-size",2,"opacity","1 !important",3,"src","alt"],["src","assets/images/profilePlaceholder.svg",1,"round-images","round-images-size",2,"opacity","1 !important","background-color","var(--containerBackground)",3,"alt"],["alt","album","height","100","width","200",1,"h-full","w-auto",2,"border-radius","5px","overflow","hidden","cursor","pointer",3,"src","ngStyle"],["class","play-icon-preview absolute","style","top:8px; left: 8px",3,"ngStyle","click",4,"ngIf"],[1,"play-icon-preview","absolute",2,"top","8px","left","8px",3,"ngStyle","click"],["height","100","width","200",1,"h-full","w-auto",2,"overflow","hidden","opacity","1 !important",3,"src","alt"],["src","assets/images/playlist-placeholder.svg","height","100","width","200",1,"h-full","w-auto",2,"background-color","var(--containerBackground)","overflow","hidden","opacity","1 !important",3,"alt"],[1,"text-align-right","font-size"],[1,"text-align-right","font-size","font-normal"],[1,"flex","align-items-center","font-size","h-full"],["colspan","8"]],template:function(e,o){1&e&&(P(0,"h3",0),ie(1," Notificaciones "),N(),P(2,"div",1)(3,"p-table",2,3),W(5,Eoe,5,0,"ng-template",4),W(6,Noe,23,11,"ng-template",5),W(7,zoe,3,0,"ng-template",6),N()()),2&e&&(F(3),L("value",o.notificaciones)("rows",10)("paginator",!0)("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",Kn(6,Boe)))},dependencies:[Xn,ho,fo,Nd,_a,Su],styles:[".padding-td[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important;padding-left:1rem!important;padding-right:0!important}.margin-sm[_ngcontent-%COMP%]{margin-right:1rem!important}.font-size[_ngcontent-%COMP%]{font-size:1rem!important}@media (max-width: 1100px){.padding-td[_ngcontent-%COMP%]{padding-top:.75rem!important;padding-bottom:.75rem!important;padding-left:.75rem!important;padding-right:0!important}.font-size[_ngcontent-%COMP%]{font-size:.9rem!important}.margin-sm[_ngcontent-%COMP%]{margin-right:.75rem!important}.max-with-desc[_ngcontent-%COMP%]{max-width:220px!important}}@media (max-width: 800px){.max-with-desc[_ngcontent-%COMP%]{max-width:150px!important}.font-size[_ngcontent-%COMP%]{font-size:.8rem!important}.margin-sm[_ngcontent-%COMP%]{margin-right:.75rem!important}.max-width-noti[_ngcontent-%COMP%]{max-width:150px!important}}@media (max-width: 500px){.max-with-desc[_ngcontent-%COMP%]{max-width:100px!important}.font-size[_ngcontent-%COMP%]{font-size:.8rem!important}.margin-sm[_ngcontent-%COMP%]{margin-right:.75rem!important}.max-width-noti[_ngcontent-%COMP%]{max-width:100px!important}}"]}),t})();function Uoe(t,n){if(1&t&&(P(0,"div",2)(1,"h1",3),ie(2),N()()),2&t){const e=U();F(2),jn(" ",e.appLayout.currentRoute," ")}}function joe(t,n){if(1&t&&(P(0,"div",4),Ae(1,"app-notifications-table")(2,"app-notifications-list",5),N()),2&t){const e=U();F(2),L("notificaciones",e.notificaciones)}}function Hoe(t,n){1&t&&(P(0,"div",4),Ae(1,"app-loader"),N())}let $oe=(()=>{class t{constructor(e,o,r){this.appLayout=e,this.activity=o,this.titleService=r,this.loading=!0,this.titleService.setTitle("Notificaciones | Spotivibes")}ngOnInit(){this.getNotifications()}getNotifications(){var e=this;return Ft(function*(){try{const o=yield e.activity.getNotifications();e.notificaciones=o.notifications,e.loading=!1}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.response.data.status})}})()}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(uN),ce(_c))},t.\u0275cmp=Qt({type:t,selectors:[["app-notifications"]],decls:3,vars:3,consts:[["class","route-name",4,"ngIf"],["class","content",4,"ngIf"],[1,"route-name"],[1,"current-route"],[1,"content"],[3,"notificaciones"]],template:function(e,o){1&e&&(W(0,Uoe,3,1,"div",0),W(1,joe,3,1,"div",1),W(2,Hoe,2,0,"div",1)),2&e&&(L("ngIf",!o.appLayout.showBar),F(1),L("ngIf",!o.loading),F(1),L("ngIf",o.loading))},dependencies:[Xn,Soe,Voe,zd],styles:["[_nghost-%COMP%]{width:100%}  .p-datatable .p-paginator-bottom{border-top-left-radius:0!important;border-top-right-radius:0!important}"]}),t})();function Goe(t,n){if(1&t){const e=Ye();P(0,"button",10),Te("click",function(){return be(e),ve(U(2).showFirstPage=!0)}),P(1,"mat-icon"),ie(2,"arrow_back"),N()()}2&t&&L("disabled",U(2).uploadingPlaylist)}function Woe(t,n){if(1&t&&(P(0,"div",7),W(1,Goe,3,1,"button",8),P(2,"h2",9),ie(3),N()()),2&t){const e=U();F(1),L("ngIf",!e.showFirstPage),F(2),Ut(e.newPLaylist?"Crear playlist":"A\xf1adir un vibe")}}function qoe(t,n){1&t&&(P(0,"p",19),ie(1,"Introduce un t\xedtulo para tu playlist"),N())}function Zoe(t,n){1&t&&(P(0,"div",26)(1,"span",27),ie(2,"El nombre de la playlist no puede tener m\xe1s de 25 caracteres"),N()())}function Koe(t,n){1&t&&(P(0,"p",28),ie(1,"Introduce una descripci\xf3n para tu playlist"),N())}function Xoe(t,n){if(1&t&&(P(0,"form",20)(1,"div",21),Ae(2,"input",22),N(),W(3,Zoe,3,0,"div",23),W(4,Koe,2,0,"p",24),Ae(5,"textarea",25),N()),2&t){const e=U(2);let o;L("formGroup",e.searchForm),F(3),L("ngIf",(null==(o=e.searchForm.get("playlistTitle"))?null:o.hasError("maxlength"))&&(e.searchForm.controls.playlistTitle.dirty||e.searchForm.controls.playlistTitle.touched)),F(1),L("ngIf",e.newPLaylist)}}function Yoe(t,n){if(1&t){const e=Ye();P(0,"div")(1,"div",11)(2,"div",12)(3,"div"),W(4,qoe,2,0,"p",13),N()()(),W(5,Xoe,6,3,"form",14),P(6,"button",15),Te("click",function(){return be(e),ve(U().continue())}),P(7,"div",16)(8,"span",17)(9,"p",18),ie(10," Continuar "),N()()()()()}if(2&t){const e=U();F(4),L("ngIf",e.newPLaylist),F(1),L("ngIf",e.newPLaylist),F(1),L("disabled",!e.searchForm.valid&&e.newPLaylist||(e.newPLaylist||e.uploadingPlaylist||0==e.selectedVibes.length)&&!e.newPLaylist)}}function Qoe(t,n){if(1&t){const e=Ye();P(0,"div",39)(1,"div",40)(2,"div",41)(3,"h4",42),ie(4," Tus vibes "),N(),P(5,"div",17)(6,"span",43),Ae(7,"i",44),P(8,"input",45),Te("input",function(r){be(e),U();const s=Un(1),l=U(2);return ve(s.filterGlobal(l.getEventValue(r),"contains"))}),N()()()()()()}}function Joe(t,n){1&t&&(P(0,"tr")(1,"th",46)(2,"div",47),ie(3," T\xedtulo "),Ae(4,"p-sortIcon",48),N()(),P(5,"th")(6,"div",49)(7,"mat-icon",50),ie(8,"access_time"),N()()()())}const HC=function(t){return{opacity:t}},_N=function(t){return{"play-icon-preview":t}};function ere(t,n){if(1&t){const e=Ye();P(0,"mat-icon",62),Te("click",function(){be(e);const r=U().$implicit;return ve(U(3).playPreview(r.spotifySongId,r.songPreview))}),ie(1),N()}if(2&t){const e=U().$implicit,o=U(3);L("ngStyle",Wt(3,HC,o.appLayout.playingSong==e.spotifySongId?"1":"0"))("ngClass",Wt(5,_N,null!=e.songPreview)),F(1),Ut(o.appLayout.playingSong==e.spotifySongId?o.appLayout.previewIcon:"play_arrow")}}const yN=function(t){return{"image-preview":t}};function tre(t,n){if(1&t&&(P(0,"tr",51)(1,"td",52)(2,"div",53)(3,"div",54),Ae(4,"img",55),W(5,ere,2,7,"mat-icon",56),N(),P(6,"div",57)(7,"p",58),ie(8),wo(9,"slice"),N(),P(10,"p",59),ie(11),wo(12,"slice"),N()()()(),P(13,"td",52)(14,"div",60)(15,"div",61),ie(16),N()()()()),2&t){const e=n.$implicit,o=n.rowIndex,r=U(3);L("pSelectableRow",e)("pSelectableRowIndex",o),F(3),L("ngClass",Wt(18,yN,null!=e.songPreview)),F(1),Ai("src",e.songImage,Ui),Ai("alt",e.songName),L("ngStyle",Wt(20,HC,r.appLayout.playingSong==e.spotifySongId?"0.4":"1")),F(1),L("ngIf",null!=e.songPreview),F(3),Ut(e.songName.length>28?Nr(9,10,e.songName,0,28)+"...":e.songName),F(3),jn(" ",e.songAlbum.length>25?Nr(12,14,e.songAlbum,0,25)+"...":e.songAlbum," "),F(5),Ut(e.songDuration)}}function nre(t,n){1&t&&(P(0,"tr")(1,"td",63),ie(2,"No se ha encontrado ning\xfan vibe"),N()())}function ire(t,n){if(1&t&&(P(0,"div",64),ie(1),N()),2&t){const e=U(3);F(1),jn(" ",e.vibes.length," vibes encontrados ")}}const vN=function(){return["name","album"]},bN=function(){return[10,25,50]};function ore(t,n){if(1&t){const e=Ye();P(0,"p-table",32,33),Te("selectionChange",function(r){return be(e),ve(U(2).selectedVibes=r)}),W(2,Qoe,9,0,"ng-template",34),W(3,Joe,9,0,"ng-template",35),W(4,tre,17,22,"ng-template",36),W(5,nre,3,0,"ng-template",37),W(6,ire,2,1,"ng-template",38),N()}if(2&t){const e=U(2);L("value",e.vibes)("scrollable",!0)("selection",e.selectedVibes)("selectionMode",e.newPLaylist?"multiple":"single")("loading",e.loading)("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",Kn(9,vN))("rowsPerPageOptions",Kn(10,bN))}}function rre(t,n){if(1&t){const e=Ye();P(0,"div",39)(1,"div",40)(2,"div",41)(3,"h4",42),ie(4," Tus vibes "),N(),P(5,"div",17)(6,"span",43),Ae(7,"i",44),P(8,"input",45),Te("input",function(r){be(e),U();const s=Un(1),l=U(2);return ve(s.filterGlobal(l.getEventValue(r),"contains"))}),N()()()()()()}}function sre(t,n){1&t&&(P(0,"tr")(1,"th",46)(2,"div",47),ie(3," T\xedtulo "),Ae(4,"p-sortIcon",48),N()(),P(5,"th")(6,"div",49)(7,"mat-icon",50),ie(8,"access_time"),N()()()())}function are(t,n){if(1&t){const e=Ye();P(0,"mat-icon",62),Te("click",function(){be(e);const r=U().$implicit;return ve(U(3).playPreview(r.spotifySongId,r.songPreview))}),ie(1),N()}if(2&t){const e=U().$implicit,o=U(3);L("ngStyle",Wt(3,HC,o.appLayout.playingSong==e.spotifySongId?"1":"0"))("ngClass",Wt(5,_N,null!=e.songPreview)),F(1),Ut(o.appLayout.playingSong==e.spotifySongId?o.appLayout.previewIcon:"play_arrow")}}function lre(t,n){if(1&t&&(P(0,"tr",51)(1,"td",52)(2,"div",53)(3,"div",54),Ae(4,"img",55),W(5,are,2,7,"mat-icon",56),N(),P(6,"div",57)(7,"p",58),ie(8),wo(9,"slice"),N(),P(10,"p",59),ie(11),wo(12,"slice"),N()()()(),P(13,"td",52)(14,"div",60)(15,"div",61),ie(16),N()()()()),2&t){const e=n.$implicit,o=n.rowIndex,r=U(3);L("pSelectableRow",e)("pSelectableRowIndex",o),F(3),L("ngClass",Wt(18,yN,null!=e.songPreview)),F(1),Ai("src",e.songImage,Ui),Ai("alt",e.songName),L("ngStyle",Wt(20,HC,r.appLayout.playingSong==e.spotifySongId?"0.4":"1")),F(1),L("ngIf",null!=e.songPreview),F(3),Ut(e.songName.length>28?Nr(9,10,e.songName,0,28)+"...":e.songName),F(3),jn(" ",e.songAlbum.length>25?Nr(12,14,e.songAlbum,0,25)+"...":e.songAlbum," "),F(5),Ut(e.songDuration)}}function cre(t,n){1&t&&(P(0,"tr")(1,"td",63),ie(2,"No se ha encontrado ning\xfan vibe"),N()())}function ure(t,n){if(1&t&&(P(0,"div",64),ie(1),N()),2&t){const e=U(3);F(1),jn(" ",e.vibes.length," vibes encontrados ")}}function dre(t,n){if(1&t){const e=Ye();P(0,"p-table",32,33),Te("selectionChange",function(r){return be(e),ve(U(2).oneVibeSelected=r)}),W(2,rre,9,0,"ng-template",34),W(3,sre,9,0,"ng-template",35),W(4,lre,17,22,"ng-template",36),W(5,cre,3,0,"ng-template",37),W(6,ure,2,1,"ng-template",38),N()}if(2&t){const e=U(2);L("value",e.vibes)("scrollable",!0)("selection",e.oneVibeSelected)("selectionMode",e.newPLaylist?"multiple":"single")("loading",e.loading)("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",Kn(9,vN))("rowsPerPageOptions",Kn(10,bN))}}function hre(t,n){1&t&&Ae(0,"p-progressSpinner",65)}function pre(t,n){if(1&t){const e=Ye();P(0,"div")(1,"p",29),ie(2,"Selecciona un vibe"),N(),W(3,ore,7,11,"p-table",30),W(4,dre,7,11,"p-table",30),P(5,"button",15),Te("click",function(){return be(e),ve(U().uploadPlaylist())}),P(6,"div",16)(7,"span",17),W(8,hre,1,0,"p-progressSpinner",31),P(9,"p",18),ie(10),N()()()()()}if(2&t){const e=U();F(3),L("ngIf",e.newPLaylist),F(1),L("ngIf",!e.newPLaylist),F(1),L("disabled",(!e.searchForm.valid||e.uploadingPlaylist||0==e.selectedVibes.length)&&e.newPLaylist||(e.newPLaylist||e.uploadingPlaylist||null==e.oneVibeSelected)&&!e.newPLaylist),F(3),L("ngIf",e.uploadingPlaylist),F(2),jn(" ",e.buttonTitle,"")}}function fre(t,n){if(1&t){const e=Ye();P(0,"div",66)(1,"button",67),Te("click",function(){return be(e),ve(U().displaySuccess=!1)}),P(2,"div",16)(3,"span",17)(4,"p",18),ie(5,"Aceptar"),N()()()()()}}const mre=function(){return{width:"700px"}},gre=function(){return{"700px":"95vw"}},_re=function(t,n,e,o,r,s,l,h){return{"h-410":t,"h-0":n,"h-1":e,"h-2":o,"h-3":r,"h-4":s,"h-5":l,"h-6":h}},yre=function(){return{width:"500px"}},vre=function(){return{"500px":"95vw"}};let xN=(()=>{class t{constructor(e,o,r){this.playlistsService=e,this.vibesService=o,this.appLayout=r,this.showDialog=new ht,this.newPlaylistAdded=new ht,this.newVibeAdded=new ht,this.showFirstPage=!0,this.uploadingPlaylist=!1,this.displayTable=!1,this.loading=!1,this.creatingPlaylist="Crear playlist",this.displaySuccess=!1,this.vibes=new Array,this.selectedVibes=new Array}ngOnInit(){this.searchForm=new Qs({playlistTitle:new Sr(this.playlistTitle,[pr.required,pr.maxLength(25)]),playlistDescription:new Sr(this.playlistDescription,[])}),this.getVibes()}cancel(){this.buttonTitle="Crear playlist",this.newPLaylist?this.showFirstPage=!0:this.buttonTitle="A\xf1adir vibe",this.uploadingPlaylist=!1,this.selectedVibes=[],this.searchForm.reset(),this.showDialog.emit(!1)}getEventValue(e){return e.target.value}uploadPlaylist(){var e=this;return Ft(function*(){if(e.newPLaylist){e.buttonTitle="Creando playlist...",e.uploadingPlaylist=!0;var o=new BC;o.name=e.searchForm.value.playlistTitle,o.description="",e.searchForm.value.playlistDescription&&(o.description=e.searchForm.value.playlistDescription);var r=new Array;for(let s=0;s<e.selectedVibes.length;s++)r.push(e.selectedVibes[s].vibeId);o.vibesIds=r;try{const s=yield e.playlistsService.createPlaylist(o);e.newPlaylistAdded.emit(s.playlist),e.cancel(),e.displaySuccess=!0}catch(s){e.buttonTitle="Crear playlist",e.uploadingPlaylist=!1,403==s.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.response.data.status})}}else e.buttonTitle="A\xf1adiendo vibe...",e.uploadingPlaylist=!0,yield e.addToPlaylist(e.playlistId,e.oneVibeSelected.vibeId),e.newVibeAdded.emit(e.oneVibeSelected);e.showDialog.emit(!1),e.newPLaylist?(e.successTitle="Playlist creada",e.successMessage="La playlist se ha creado correctamente"):(e.successTitle="Playlist actualizada",e.successMessage="Se ha a\xf1adido el vibe correctamente"),e.displaySuccess=!0})()}addToPlaylist(e,o){var r=this;return Ft(function*(){try{yield r.playlistsService.addToPlaylist(e,o)}catch(s){403==s.status?r.appLayout.handle403Error():r.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.data.status})}})()}getVibes(){var e=this;return Ft(function*(){try{const o=yield e.vibesService.getVibes("personal");if(e.vibes=o.vibes,!e.newPLaylist){yield new Promise(r=>setTimeout(r,500));for(let r=0;r<e.vibesInPlaylist.length;r++)for(let s=0;s<e.vibes.length;s++)if(e.vibesInPlaylist[r].vibeId==e.vibes[s].vibeId)try{e.vibes.splice(s,1)}catch(l){console.log(l)}}}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}onHide(e){this.displaySuccess=e}continue(){this.showFirstPage=!1}playPreview(e,o){this.appLayout.playPreview(e,o)}}return t.\u0275fac=function(e){return new(e||t)(ce(ku),ce(Oy),ce(Zo))},t.\u0275cmp=Qt({type:t,selectors:[["app-new-playlist-dialog"]],inputs:{display:"display",newPLaylist:"newPLaylist",playlistId:"playlistId",buttonTitle:"buttonTitle",vibesInPlaylist:"vibesInPlaylist"},outputs:{showDialog:"showDialog",newPlaylistAdded:"newPlaylistAdded",newVibeAdded:"newVibeAdded"},decls:11,vars:31,consts:[[3,"visible","closable","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[1,"animation","h-120","pt-2",3,"ngClass"],[4,"ngIf"],[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],[1,"text-center"],["pTemplate","footer"],[1,"flex","align-items-center","mb-1"],["class","back-buttons flex align-items-center justify-content-center mr-2","type","button",3,"disabled","click",4,"ngIf"],[1,"p-dialog-title"],["type","button",1,"back-buttons","flex","align-items-center","justify-content-center","mr-2",3,"disabled","click"],[1,"flex","justify-content-between","flex-wrap","card-container"],[1,"flex"],["class","mt-2","style","margin-bottom: 15px;",4,"ngIf"],[3,"formGroup",4,"ngIf"],["pButton","","pRipple","",1,"mt-4","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"],[1,"mt-2",2,"margin-bottom","15px"],[3,"formGroup"],[1,"p-inputgroup","h-fit"],["id","playlistTitle","name","playlistTitle","formControlName","playlistTitle","placeholder","Nombre de la playlist","type","text","pInputText","",1,"form-control","h-3rem"],["class","mb-2",4,"ngIf"],["style","margin-bottom: 15px; margin-top: 15px;",4,"ngIf"],["id","playlistDescription","name","playlistDescription","formControlName","playlistDescription","placeholder","A\xf1adir descripci\xf3n",1,"w-full","h-10rem","p-3","text-base",2,"resize","none","border-radius","10px","font-family","Lato","color","var(--fontColor)","background","var(--frostedBackground)"],[1,"mb-2"],[1,"text-xs",2,"color","var(--validationErrors)"],[2,"margin-bottom","15px","margin-top","15px"],[1,"mt-4",2,"margin-bottom","15px"],["dataKey","vibeId","styleClass","p-datatable-sm","scrollHeight","330px","currentPageReportTemplate","{first} a {last}",3,"value","scrollable","selection","selectionMode","loading","rowHover","showCurrentPageReport","globalFilterFields","rowsPerPageOptions","selectionChange",4,"ngIf"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],["dataKey","vibeId","styleClass","p-datatable-sm","scrollHeight","330px","currentPageReportTemplate","{first} a {last}",3,"value","scrollable","selection","selectionMode","loading","rowHover","showCurrentPageReport","globalFilterFields","rowsPerPageOptions","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"md:m-0","mb-3","text-center","md:text-left"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Filtrar",3,"input"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center","name-size"],["field","name"],[1,"flex","justify-content-between","align-items-center","margin-td-right",2,"float","right"],[1,"mr-2"],[3,"pSelectableRow","pSelectableRowIndex"],[1,"padding-td"],[1,"flex","align-items-center","justify-content-start","w-auto","h-auto"],[1,"round-images-size","relative",3,"ngClass"],[1,"h-3rem","w-3rem","border-round-sm","mr-3",2,"box-shadow","var(--shadows)",3,"src","ngStyle","alt"],["class","absolute","style","top:10px; left: 10px",3,"ngStyle","ngClass","click",4,"ngIf"],[1,"ml-3","text-left"],[1,"text-lg","mb-1"],[1,"text-sm","text-color-secondary","mb-1"],[1,"margin-td-right",2,"float","right"],[1,"ml-3","name-size",2,"height","40px","text-align","start","display","flex","align-items","center"],[1,"absolute",2,"top","10px","left","10px",3,"ngStyle","ngClass","click"],["colspan","8"],[1,"flex","align-items-center","justify-content-between"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"],[1,"p-3"],["pButton","","pRipple","","type","submit",1,"p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"]],template:function(e,o){if(1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s})("onHide",function(){return o.cancel()}),W(1,Woe,4,2,"ng-template",1),P(2,"div",2),W(3,Yoe,11,3,"div",3),W(4,pre,11,5,"div",3),N()(),P(5,"p-dialog",4),Te("visibleChange",function(s){return o.displaySuccess=s})("onHide",function(){return o.displaySuccess=!1}),P(6,"h3",5),ie(7),N(),P(8,"p",5),ie(9),N(),W(10,fre,6,0,"ng-template",6),N()),2&e){let r;Io(Kn(18,mre)),L("visible",o.display)("closable",!o.uploadingPlaylist)("modal",!0)("draggable",!1)("breakpoints",Kn(19,gre)),F(2),L("ngClass",dE(20,_re,o.showFirstPage&&o.newPLaylist&&!(null!=(r=o.searchForm.get("playlistTitle"))&&r.hasError("maxlength")),!(0!=o.vibes.length||o.showFirstPage&&o.newPLaylist),!(1!=o.vibes.length||o.showFirstPage&&o.newPLaylist),!(2!=o.vibes.length||o.showFirstPage&&o.newPLaylist),!(3!=o.vibes.length||o.showFirstPage&&o.newPLaylist),!(4!=o.vibes.length||o.showFirstPage&&o.newPLaylist),o.vibes.length>=5&&(!o.showFirstPage||!o.newPLaylist),(null==(r=o.searchForm.get("playlistTitle"))?null:r.hasError("maxlength"))&&o.showFirstPage)),F(1),L("ngIf",o.showFirstPage&&o.newPLaylist),F(1),L("ngIf",!o.showFirstPage||!o.newPLaylist),F(1),Io(Kn(29,yre)),L("visible",o.displaySuccess)("modal",!0)("draggable",!1)("breakpoints",Kn(30,vre)),F(2),jn(" ",o.successTitle," "),F(2),jn(" ",o.successMessage," ")}},dependencies:[ao,Xn,ho,Dd,yc,$a,Ed,vc,Md,Dr,_l,jl,fo,Nd,E0,sN,FC,_a,Mu,Su],styles:["p[_ngcontent-%COMP%]{margin:0}.vibe-container[_ngcontent-%COMP%]{width:100%;display:flex}.image-column[_ngcontent-%COMP%]{width:50px;height:100%;align-items:start;right:0;top:7px}.text-column[_ngcontent-%COMP%]{margin-left:1rem;flex-grow:1;width:100%;height:100%;justify-content:center;align-items:start}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:#fff!important}[_nghost-%COMP%]     .p-dialog .p-dialog-header{padding-bottom:0}[_nghost-%COMP%]     .p-datatable.p-datatable-sm .p-datatable-footer{border-bottom-left-radius:10px!important;border-bottom-right-radius:10px}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr:focus{outline:.15rem solid #93cbf9;outline-offset:-.15rem}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr.p-highlight{background:var(--selectedItemTable)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr{background:var(--frostedTable)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background:var(--selectedItemTable)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-header{background:var(--selectedItem)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-footer{background:var(--selectedItem)!important;border-width:0px 1px 1px 1px}[_nghost-%COMP%]     .p-datatable.p-datatable-scrollable>.p-datatable-wrapper>.p-datatable-table>.p-datatable-thead{background:var(--selectedItem)!important}[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{background:var(--frostedTable)!important}.p-datatable[_ngcontent-%COMP%]   .p-datatable-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover{background:var(--selectedItemTable)!important}tr[_ngcontent-%COMP%]:hover   .play-icon-preview[_ngcontent-%COMP%]{transition:var(--transition);opacity:1!important}tr[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transition:var(--transition);opacity:.3!important}.animation[_ngcontent-%COMP%]{transition:var(--transition)}.h-120[_ngcontent-%COMP%]{height:150px}.h-410[_ngcontent-%COMP%]{height:380px}.h-0[_ngcontent-%COMP%]{height:305px!important}.h-1[_ngcontent-%COMP%]{height:335px!important}.h-2[_ngcontent-%COMP%]{height:395px!important}.h-3[_ngcontent-%COMP%]{height:460px!important}.h-4[_ngcontent-%COMP%]{height:525px!important}.h-5[_ngcontent-%COMP%]{height:560px!important}.h-6[_ngcontent-%COMP%]{height:395px!important}.h-460[_ngcontent-%COMP%]{height:300px!important}.h-thirdPage[_ngcontent-%COMP%]{height:470px!important}textarea[_ngcontent-%COMP%]{border:1px solid var(--textAreaBorder)}textarea[_ngcontent-%COMP%]:hover{transition:var(--transition);box-shadow:0 0 0 1.5px #93cbf9}"]}),t})();function bre(t,n){if(1&t&&(P(0,"div",10)(1,"div",11),Ae(2,"i"),N()()),2&t){const e=U();F(2),Zn("p-dataview-loading-icon pi-spin "+e.loadingIcon)}}function xre(t,n){1&t&&$t(0)}function wre(t,n){if(1&t&&(P(0,"div",12),ro(1),W(2,xre,1,0,"ng-container",13),N()),2&t){const e=U();F(2),L("ngTemplateOutlet",e.headerTemplate)}}function Cre(t,n){if(1&t){const e=Ye();P(0,"p-paginator",14),Te("onPageChange",function(r){return be(e),ve(U().paginate(r))}),N()}if(2&t){const e=U();L("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showPageLinks",e.showPageLinks)}}function Tre(t,n){1&t&&$t(0)}const Sre=function(t,n){return{$implicit:t,rowIndex:n}};function Ere(t,n){if(1&t&&W(0,Tre,1,0,"ng-container",15),2&t){const e=n.$implicit,o=n.index;L("ngTemplateOutlet",U().itemTemplate)("ngTemplateOutletContext",Ji(2,Sre,e,o))}}function Ire(t,n){if(1&t&&(wn(0),ie(1),Pn()),2&t){const e=U(2);F(1),jn(" ",e.emptyMessageLabel," ")}}function Dre(t,n){1&t&&$t(0,null,19)}function Mre(t,n){if(1&t&&(P(0,"div",16)(1,"div",17),W(2,Ire,2,1,"ng-container",18),W(3,Dre,2,0,"ng-container",13),N()()),2&t){const e=U();F(2),L("ngIf",!e.emptyMessageTemplate)("ngIfElse",e.emptyFilter),F(1),L("ngTemplateOutlet",e.emptyMessageTemplate)}}function kre(t,n){if(1&t){const e=Ye();P(0,"p-paginator",20),Te("onPageChange",function(r){return be(e),ve(U().paginate(r))}),N()}if(2&t){const e=U();L("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showPageLinks",e.showPageLinks)}}function Are(t,n){1&t&&$t(0)}function Pre(t,n){if(1&t&&(P(0,"div",21),ro(1,1),W(2,Are,1,0,"ng-container",13),N()),2&t){const e=U();F(2),L("ngTemplateOutlet",e.footerTemplate)}}const Ore=[[["p-header"]],[["p-footer"]]],Lre=function(t,n){return{"p-dataview p-component":!0,"p-dataview-list":t,"p-dataview-grid":n}},Rre=["p-header","p-footer"],wN=function(t){return{"p-highlight":t}};let CN=(()=>{class t{constructor(e,o,r,s){this.el=e,this.cd=o,this.filterService=r,this.config=s,this.pageLinks=5,this.paginatorPosition="bottom",this.alwaysShowPaginator=!0,this.paginatorDropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.showPageLinks=!0,this.emptyMessage="",this.onLazyLoad=new ht,this.gridStyleClass="",this.trackBy=(l,h)=>h,this.loadingIcon="pi pi-spinner",this.first=0,this.onPage=new ht,this.onSort=new ht,this.onChangeLayout=new ht,this._layout="list"}get layout(){return this._layout}set layout(e){this._layout=e,this.initialized&&this.changeLayout(e)}ngOnInit(){this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()}),this.initialized=!0}ngOnChanges(e){e.value&&(this._value=e.value.currentValue,this.updateTotalRecords(),!this.lazy&&this.hasFilter()&&this.filter(this.filterValue)),(e.sortField||e.sortOrder)&&(!this.lazy||this.initialized)&&this.sort()}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"listItem":this.listItemTemplate=e.template;break;case"gridItem":this.gridItemTemplate=e.template;break;case"paginatorleft":this.paginatorLeftTemplate=e.template;break;case"paginatorright":this.paginatorRightTemplate=e.template;break;case"paginatordropdownitem":this.paginatorDropdownItemTemplate=e.template;break;case"empty":this.emptyMessageTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}}),this.updateItemTemplate()}updateItemTemplate(){switch(this.layout){case"list":this.itemTemplate=this.listItemTemplate;break;case"grid":this.itemTemplate=this.gridItemTemplate}}changeLayout(e){this._layout=e,this.onChangeLayout.emit({layout:this.layout}),this.updateItemTemplate(),this.cd.markForCheck()}updateTotalRecords(){this.totalRecords=this.lazy?this.totalRecords:this._value?this._value.length:0}paginate(e){this.first=e.first,this.rows=e.rows,this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.onPage.emit({first:this.first,rows:this.rows})}sort(){this.first=0,this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.value.sort((e,o)=>{let r=xn.resolveFieldData(e,this.sortField),s=xn.resolveFieldData(o,this.sortField),l=null;return l=null==r&&null!=s?-1:null!=r&&null==s?1:null==r&&null==s?0:"string"==typeof r&&"string"==typeof s?r.localeCompare(s):r<s?-1:r>s?1:0,this.sortOrder*l}),this.hasFilter()&&this.filter(this.filterValue)),this.onSort.emit({sortField:this.sortField,sortOrder:this.sortOrder})}isEmpty(){let e=this.filteredValue||this.value;return null==e||0==e.length}createLazyLoadMetadata(){return{first:this.first,rows:this.rows,sortField:this.sortField,sortOrder:this.sortOrder}}getBlockableElement(){return this.el.nativeElement.children[0]}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(zr.EMPTY_MESSAGE)}filter(e,o="contains"){if(this.filterValue=e,this.value&&this.value.length){let r=this.filterBy.split(",");this.filteredValue=this.filterService.filter(this.value,r,e,o,this.filterLocale),this.filteredValue.length===this.value.length&&(this.filteredValue=null),this.paginator&&(this.first=0,this.totalRecords=this.filteredValue?this.filteredValue.length:this.value?this.value.length:0),this.cd.markForCheck()}}hasFilter(){return this.filterValue&&this.filterValue.trim().length>0}ngOnDestroy(){this.translationSubscription&&this.translationSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Fo),ce(Y2),ce(fl))},t.\u0275cmp=Qt({type:t,selectors:[["p-dataView"]],contentQueries:function(e,o,r){if(1&e&&(Bo(r,Q2,5),Bo(r,vC,5),Bo(r,fo,4)),2&e){let s;gn(s=_n())&&(o.header=s.first),gn(s=_n())&&(o.footer=s.first),gn(s=_n())&&(o.templates=s)}},hostAttrs:[1,"p-element"],inputs:{paginator:"paginator",rows:"rows",totalRecords:"totalRecords",pageLinks:"pageLinks",rowsPerPageOptions:"rowsPerPageOptions",paginatorPosition:"paginatorPosition",alwaysShowPaginator:"alwaysShowPaginator",paginatorDropdownAppendTo:"paginatorDropdownAppendTo",paginatorDropdownScrollHeight:"paginatorDropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showJumpToPageDropdown:"showJumpToPageDropdown",showFirstLastIcon:"showFirstLastIcon",showPageLinks:"showPageLinks",lazy:"lazy",emptyMessage:"emptyMessage",style:"style",styleClass:"styleClass",gridStyleClass:"gridStyleClass",trackBy:"trackBy",filterBy:"filterBy",filterLocale:"filterLocale",loading:"loading",loadingIcon:"loadingIcon",first:"first",sortField:"sortField",sortOrder:"sortOrder",value:"value",layout:"layout"},outputs:{onLazyLoad:"onLazyLoad",onPage:"onPage",onSort:"onSort",onChangeLayout:"onChangeLayout"},features:[_r],ngContentSelectors:Rre,decls:11,vars:20,consts:[[3,"ngClass","ngStyle"],["class","p-dataview-loading",4,"ngIf"],["class","p-dataview-header",4,"ngIf"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","dropdownAppendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","onPageChange",4,"ngIf"],[1,"p-dataview-content"],[1,"p-grid","p-nogutter","grid","grid-nogutter",3,"ngClass"],["ngFor","",3,"ngForOf","ngForTrackBy"],["class","p-col col",4,"ngIf"],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","dropdownAppendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","onPageChange",4,"ngIf"],["class","p-dataview-footer",4,"ngIf"],[1,"p-dataview-loading"],[1,"p-dataview-loading-overlay","p-component-overlay"],[1,"p-dataview-header"],[4,"ngTemplateOutlet"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","dropdownAppendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","onPageChange"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-col","col"],[1,"p-dataview-emptymessage"],[4,"ngIf","ngIfElse"],["emptyFilter",""],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","dropdownAppendTo","dropdownScrollHeight","templateLeft","templateRight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showPageLinks","onPageChange"],[1,"p-dataview-footer"]],template:function(e,o){1&e&&(hr(Ore),P(0,"div",0),W(1,bre,3,2,"div",1),W(2,wre,3,1,"div",2),W(3,Cre,1,16,"p-paginator",3),P(4,"div",4)(5,"div",5),W(6,Ere,1,5,"ng-template",6),wo(7,"slice"),W(8,Mre,4,3,"div",7),N()(),W(9,kre,1,16,"p-paginator",8),W(10,Pre,3,1,"div",9),N()),2&e&&(Zn(o.styleClass),L("ngClass",Ji(17,Lre,"list"===o.layout,"grid"===o.layout))("ngStyle",o.style),F(1),L("ngIf",o.loading),F(1),L("ngIf",o.header||o.headerTemplate),F(1),L("ngIf",o.paginator&&("top"===o.paginatorPosition||"both"==o.paginatorPosition)),F(2),L("ngClass",o.gridStyleClass),F(1),L("ngForOf",o.paginator?Nr(7,13,o.filteredValue||o.value,o.lazy?0:o.first,(o.lazy?0:o.first)+o.rows):o.filteredValue||o.value)("ngForTrackBy",o.trackBy),F(2),L("ngIf",o.isEmpty()&&!o.loading),F(1),L("ngIf",o.paginator&&("bottom"===o.paginatorPosition||"both"==o.paginatorPosition)),F(1),L("ngIf",o.footer||o.footerTemplate))},dependencies:[ao,Ns,Xn,Cs,ho,eN,Su],styles:[".p-dataview{position:relative}.p-dataview .p-dataview-loading-overlay{position:absolute;display:flex;align-items:center;justify-content:center;z-index:2}\n"],encapsulation:2,changeDetection:0}),t})(),Fre=(()=>{class t{constructor(e){this.dv=e}changeLayout(e,o){this.dv.changeLayout(o),e.preventDefault()}}return t.\u0275fac=function(e){return new(e||t)(ce(CN))},t.\u0275cmp=Qt({type:t,selectors:[["p-dataViewLayoutOptions"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass"},decls:5,vars:10,consts:[[3,"ngClass","ngStyle"],["type","button",1,"p-button","p-button-icon-only",3,"ngClass","click","keydown.enter"],[1,"pi","pi-bars"],[1,"pi","pi-th-large"]],template:function(e,o){1&e&&(P(0,"div",0)(1,"button",1),Te("click",function(s){return o.changeLayout(s,"list")})("keydown.enter",function(s){return o.changeLayout(s,"list")}),Ae(2,"i",2),N(),P(3,"button",1),Te("click",function(s){return o.changeLayout(s,"grid")})("keydown.enter",function(s){return o.changeLayout(s,"grid")}),Ae(4,"i",3),N()()),2&e&&(Zn(o.styleClass),L("ngClass","p-dataview-layout-options p-selectbutton p-buttonset")("ngStyle",o.style),F(1),L("ngClass",Wt(6,wN,"list"===o.dv.layout)),F(2),L("ngClass",Wt(8,wN,"grid"===o.dv.layout)))},dependencies:[ao,ho],encapsulation:2}),t})(),Nre=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,hs,tN,hs]}),t})();const zre=["playlistCard"];function Bre(t,n){if(1&t){const e=Ye();P(0,"div",8)(1,"h3",9),ie(2),N(),P(3,"div",10)(4,"span",11)(5,"div",12),Ae(6,"i",13),P(7,"input",14),Te("input",function(r){be(e);const s=U();return ve(Un(4).filter(s.getEventValue(r),"contains"))}),N()()()(),Ae(8,"p-dataViewLayoutOptions",15),N()}if(2&t){const e=U();F(2),Ut(e.title)}}function Vre(t,n){if(1&t&&Ae(0,"img",27),2&t){const e=U().$implicit;L("src",e.playlistImage,Ui)("alt",e.name)}}function Ure(t,n){1&t&&Ae(0,"img",28),2&t&&L("alt",U().$implicit.name)}const $C=function(t){return["/playlists",t]};function jre(t,n){if(1&t&&(P(0,"div",16)(1,"div",17)(2,"div",18),W(3,Vre,1,2,"img",19),W(4,Ure,1,1,"img",20),N(),P(5,"div",21)(6,"div",22),ie(7),N(),P(8,"div",23),ie(9),N()(),P(10,"div",24)(11,"button",25)(12,"div",26)(13,"mat-icon"),ie(14,"play_arrow"),N()()()()()()),2&t){const e=n.$implicit;F(1),L("routerLink",Wt(6,$C,e.playlistId)),F(2),L("ngIf",""!=e.playlistImage),F(1),L("ngIf",""==e.playlistImage),F(3),Ut(e.name),F(2),Ut(e.userName),F(2),L("routerLink",Wt(8,$C,e.playlistId))}}function Hre(t,n){if(1&t&&Ae(0,"img",27),2&t){const e=U().$implicit;L("src",e.playlistImage,Ui)("alt",e.name)}}function $re(t,n){1&t&&Ae(0,"img",28),2&t&&L("alt",U().$implicit.name)}const Gre=function(t){return{background:t}},Wre=function(t){return{display:t}};function qre(t,n){if(1&t){const e=Ye();P(0,"div",29)(1,"div",30),Te("mouseenter",function(){const s=be(e).$implicit;return ve(U().mouseEnter(s.playlistId,"card"))})("mouseleave",function(){return be(e),ve(U().mouseLeave("card"))}),P(2,"div",31)(3,"div",32),W(4,Hre,1,2,"img",19),W(5,$re,1,1,"img",20),P(6,"button",33)(7,"div",26)(8,"mat-icon"),ie(9,"play_arrow"),N()()()(),P(10,"div",34)(11,"p",35),ie(12),N()(),P(13,"div",23)(14,"p",36),ie(15),N()()()()()}if(2&t){const e=n.$implicit,o=U();F(1),L("ngStyle",Wt(8,Gre,o.mouseInCard&&o.selected==e.playlistId?"var(--selectedItem)":"transparent"))("routerLink",Wt(10,$C,e.playlistId)),F(3),L("ngIf",""!=e.playlistImage),F(1),L("ngIf",""==e.playlistImage),F(1),L("routerLink",Wt(12,$C,e.playlistId))("ngStyle",Wt(14,Wre,o.mouseInCard&&o.selected==e.playlistId?"flex":"none")),F(6),Ut(e.name),F(3),Ut(e.userId==o.userId?"":e.userName)}}function Zre(t,n){1&t&&(P(0,"p",37),ie(1,"No se ha encontrado ninguna playlist"),N())}let Kre=(()=>{class t{constructor(){this.mouseInCard=!1,this.selected=0,this.numElements=5}ngOnInit(){this.userId=sessionStorage.getItem("userId")}ngAfterViewChecked(){this.numElements=window.innerWidth<600?5:window.innerWidth>=600&&window.innerWidth<1e3?2:window.innerWidth>=1e3&&window.innerWidth<1100?4:window.innerWidth>=1100&&window.innerWidth<1300?6:window.innerWidth>=1300&&window.innerWidth<1600?12:window.innerWidth>=1600&&window.innerWidth<2e3?15:18}mouseEnter(e,o){this.mouseInCard=!0,this.selected=e}mouseLeave(e){this.mouseInCard=!1,this.selected=0}getEventValue(e){return e.target.value}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["app-playlist-table"]],viewQuery:function(e,o){if(1&e&&pi(zre,5),2&e){let r;gn(r=_n())&&(o.playlistCard=r.first)}},inputs:{title:"title",playlists:"playlists"},decls:9,vars:4,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"containers"],["filterBy","name","layout","grid",3,"value","paginator","rows"],["dv",""],["pTemplate","header"],["pTemplate","listItem"],["pTemplate","gridItem"],["pTemplate","empty"],[1,"flex","flex-column","md:flex-row","md:justify-content-between"],[1,"mb-2","show-titles-sm","text-center","md:text-left"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"p-input-icon-left","mb-2","md:mb-0","flex","align-items-center","justify-content-center"],[1,"relative"],[1,"pi","pi-search","absolute",2,"top","10px","left","10px"],["type","search","pInputText","","placeholder","Buscar por nombre",2,"padding-left","30px",3,"input"],[1,"flex","align-items-center","justify-content-center"],[1,"col-12"],[1,"grow","product-list-item",3,"routerLink"],[1,"mr-4",2,"width","8%"],["style","border-radius: 5px;",3,"src","alt",4,"ngIf"],["src","assets/images/playlist-placeholder.svg","style","background: var(--background); border-radius: 5px;",3,"alt",4,"ngIf"],[1,"product-list-detail"],[1,"product-name"],[1,"product-description"],[1,"product-list-action"],["id","play-btn",1,"flex","align-items-center","justify-content-center","border-circle","play-icon","border-none",2,"width","50px","height","50px","cursor","pointer",3,"routerLink"],[1,"flex","align-items-center","justify-content-center","border-circle","bg-white",2,"height","28px !important","width","28px !important"],[2,"border-radius","5px",3,"src","alt"],["src","assets/images/playlist-placeholder.svg",2,"background","var(--background)","border-radius","5px",3,"alt"],[1,"playlist-width"],[1,"product-grid-item","card",2,"cursor","pointer",3,"ngStyle","routerLink","mouseenter","mouseleave"],[1,"product-grid-item-content"],[1,"relative","mb-2",2,"width","100%"],["id","play-btn",1,"z-2","absolute","align-items-center","justify-content-center","border-circle","play-icon","border-none",2,"width","50px","height","50px","bottom","10px","left","10px","cursor","pointer",3,"routerLink","ngStyle"],[1,"product-name","mb-1"],["data-cy","playlist-name"],["data-cy","playlist-author"],["data-cy","no-playlists"]],template:function(e,o){1&e&&(P(0,"h3",0),ie(1),N(),P(2,"div",1)(3,"p-dataView",2,3),W(5,Bre,9,1,"ng-template",4),W(6,jre,15,10,"ng-template",5),W(7,qre,16,16,"ng-template",6),W(8,Zre,2,0,"ng-template",7),N()()),2&e&&(F(1),jn(" ",o.title," "),F(2),L("value",o.playlists)("paginator",!0)("rows",o.numElements))},dependencies:[Qh,Xn,ho,fo,_l,_a,CN,Fre],styles:[".play-icon[_ngcontent-%COMP%]{background:var(--gradient45);box-shadow:var(--shadows)}mat-icon[_ngcontent-%COMP%]{background:var(--gradient45);-webkit-background-clip:text;-moz-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}.card[_ngcontent-%COMP%]{background:var(--surface-card);padding:1rem;border-radius:10px;margin-bottom:0rem}.product-grid-item[_ngcontent-%COMP%]{margin:.5em;display:grid;align-items:start;justify-content:space-between;text-align:center}.product-grid-item-bottom[_ngcontent-%COMP%], .product-grid-item-top[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.product-grid-item-content[_ngcontent-%COMP%]{text-align:center}.product-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}.product-description[_ngcontent-%COMP%]{font-size:.875rem}.product-category-icon[_ngcontent-%COMP%]{vertical-align:middle;margin-right:.5rem}.product-category[_ngcontent-%COMP%]{font-weight:600;vertical-align:middle}.product-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem;width:100%;align-self:flex-end;flex-direction:column;flex-direction:row;justify-content:space-between}.product-list-action[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-right:10px}.product-list-detail[_ngcontent-%COMP%]{flex:1 1 0}img[_ngcontent-%COMP%]{box-shadow:0 3px 6px #00000029,0 3px 6px #0000003b;margin-right:2rem;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.playlist-width[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .p-dataview-header{border-width:1px;border-top-left-radius:7px;border-top-right-radius:7px}[_nghost-%COMP%]     .p-dataview-content{border:1px solid var(--surface-border);border-width:0 1px 0 1px}[_nghost-%COMP%]     .p-paginator-bottom{border-width:1px 1px 1px 1px;border-bottom-left-radius:7px;border-bottom-right-radius:7px}[_nghost-%COMP%]     .p-button{border-radius:5px!important;height:auto;border:none;background:var(--selectedItemTable)}[_nghost-%COMP%]     .product-list-item:hover{background:var(--selectedItem);cursor:pointer}@media (min-width: 500px){.playlist-width[_ngcontent-%COMP%]{width:100%}}@media (min-width: 600px){.playlist-width[_ngcontent-%COMP%]{width:50%}}@media (min-width: 1100px){.playlist-width[_ngcontent-%COMP%]{width:33.333333%}}@media (min-width: 1300px){.playlist-width[_ngcontent-%COMP%]{width:25%}}@media (min-width: 1600px){.playlist-width[_ngcontent-%COMP%]{width:20%}}@media (min-width: 2000px){.playlist-width[_ngcontent-%COMP%]{width:16.66666666%}}@media (min-width: 2500px){.playlist-width[_ngcontent-%COMP%]{width:14,2857142857%}}"]}),t})();function Xre(t,n){if(1&t){const e=Ye();P(0,"div",8)(1,"h1",9),ie(2),N(),P(3,"button",10),Te("click",function(){return be(e),ve(U(2).displayNewPlaylistDialog=!0)}),ie(4," Crear playlist "),N()()}if(2&t){const e=U(2);F(2),jn(" ",e.appLayout.currentRoute," ")}}function Yre(t,n){if(1&t){const e=Ye();P(0,"div"),W(1,Xre,5,1,"div",3),P(2,"div",4)(3,"button",5),Te("click",function(){return be(e),ve(U().displayNewPlaylistDialog=!0)}),ie(4," Crear playlist "),N(),Ae(5,"app-playlist-table",6)(6,"app-playlist-table",7),N()()}if(2&t){const e=U();F(1),L("ngIf",!e.appLayout.showBar),F(4),L("playlists",e.yourplaylists),F(1),L("playlists",e.following)}}function Qre(t,n){1&t&&(P(0,"div",4),Ae(1,"app-loader"),N())}let Jre=(()=>{class t{constructor(e,o,r){this.appLayout=e,this.playlistsService=o,this.titleService=r,this.outline=!0,this.pageLoading=!0,this.buttonTitle="Crear playlist",this.newPlaylist=!0,this.displayNewPlaylistDialog=!1,this.titleService.setTitle("Playlists | Spotivibes")}ngOnInit(){this.getAllPlaylists()}getAllPlaylists(){var e=this;return Ft(function*(){try{const o=yield e.playlistsService.getPlaylists();e.yourplaylists=o.myPlaylists,e.following=o.followedPlaylists,e.pageLoading=!1}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}hideDialog(e){this.displayNewPlaylistDialog=e}newPlaylistAdded(e){this.yourplaylists.push(e)}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(ku),ce(_c))},t.\u0275cmp=Qt({type:t,selectors:[["app-playlists"]],decls:3,vars:5,consts:[[4,"ngIf"],["class","content",4,"ngIf"],[3,"display","newPLaylist","buttonTitle","showDialog","newPlaylistAdded"],["class","route-name flex align-items-center",4,"ngIf"],[1,"content"],["type","button","tabindex","1",1,"p-button-text","border-round-xl","h-3rem","mb-3","button-gradient","w-full","border-none","display-btn",3,"click"],["title","Tus playlists",3,"playlists"],["title","Siguiendo",3,"playlists"],[1,"route-name","flex","align-items-center"],[1,"current-route","w-full"],["type","button","tabindex","1",1,"p-button-text","border-round-xl","h-3rem","button-gradient","w-15rem","border-none",3,"click"]],template:function(e,o){1&e&&(W(0,Yre,7,3,"div",0),W(1,Qre,2,0,"div",1),P(2,"app-new-playlist-dialog",2),Te("showDialog",function(s){return o.hideDialog(s)})("newPlaylistAdded",function(s){return o.newPlaylistAdded(s)}),N()),2&e&&(L("ngIf",!o.pageLoading),F(1),L("ngIf",o.pageLoading),F(1),L("display",o.displayNewPlaylistDialog)("newPLaylist",!0)("buttonTitle",o.buttonTitle))},dependencies:[Xn,xN,Kre,zd],styles:["[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]     .p-buttonset .p-button:first-of-type{border-radius:10px!important;margin-right:5px!important}[_nghost-%COMP%]     .p-buttonset .p-button:not(:first-of-type):not(:last-of-type){border-radius:10px!important}[_nghost-%COMP%]     .p-buttonset .p-button:last-of-type{border-radius:10px!important;margin-left:5px!important}"]}),t})();if(!tp)var tp={map:function(t,n){var e={};return n?t.map(function(o,r){return e.index=r,n.call(e,o)}):t.slice()},naturalOrder:function(t,n){return t<n?-1:t>n?1:0},sum:function(t,n){var e={};return t.reduce(n?function(o,r,s){return e.index=s,o+n.call(e,r)}:function(o,r){return o+r},0)},max:function(t,n){return Math.max.apply(null,n?tp.map(t,n):t)}};var ese=function(){var t=5,n=8-t,e=1e3;function o(f,y,C){return(f<<2*t)+(y<<t)+C}function r(f){var y=[],C=!1;function D(){y.sort(f),C=!0}return{push:function(R){y.push(R),C=!1},peek:function(R){return C||D(),void 0===R&&(R=y.length-1),y[R]},pop:function(){return C||D(),y.pop()},size:function(){return y.length},map:function(R){return y.map(R)},debug:function(){return C||D(),y}}}function s(f,y,C,D,R,V,$){var X=this;X.r1=f,X.r2=y,X.g1=C,X.g2=D,X.b1=R,X.b2=V,X.histo=$}function l(){this.vboxes=new r(function(f,y){return tp.naturalOrder(f.vbox.count()*f.vbox.volume(),y.vbox.count()*y.vbox.volume())})}function h(f,y){if(y.count()){var C=y.r2-y.r1+1,D=y.g2-y.g1+1,R=tp.max([C,D,y.b2-y.b1+1]);if(1==y.count())return[y.copy()];var V,$,X,ee,ue=0,fe=[],_e=[];if(R==C)for(V=y.r1;V<=y.r2;V++){for(ee=0,$=y.g1;$<=y.g2;$++)for(X=y.b1;X<=y.b2;X++)ee+=f[o(V,$,X)]||0;fe[V]=ue+=ee}else if(R==D)for(V=y.g1;V<=y.g2;V++){for(ee=0,$=y.r1;$<=y.r2;$++)for(X=y.b1;X<=y.b2;X++)ee+=f[o($,V,X)]||0;fe[V]=ue+=ee}else for(V=y.b1;V<=y.b2;V++){for(ee=0,$=y.r1;$<=y.r2;$++)for(X=y.g1;X<=y.g2;X++)ee+=f[o($,X,V)]||0;fe[V]=ue+=ee}return fe.forEach(function(Be,et){_e[et]=ue-Be}),function(Be){var et,gt,Ht,kt,Kt,Ln=Be+"1",oi=Be+"2",Ri=0;for(V=y[Ln];V<=y[oi];V++)if(fe[V]>ue/2){for(Ht=y.copy(),kt=y.copy(),Kt=(et=V-y[Ln])<=(gt=y[oi]-V)?Math.min(y[oi]-1,~~(V+gt/2)):Math.max(y[Ln],~~(V-1-et/2));!fe[Kt];)Kt++;for(Ri=_e[Kt];!Ri&&fe[Kt-1];)Ri=_e[--Kt];return Ht[oi]=Kt,kt[Ln]=Ht[oi]+1,[Ht,kt]}}(R==C?"r":R==D?"g":"b")}}return s.prototype={volume:function(f){var y=this;return y._volume&&!f||(y._volume=(y.r2-y.r1+1)*(y.g2-y.g1+1)*(y.b2-y.b1+1)),y._volume},count:function(f){var y=this,C=y.histo;if(!y._count_set||f){var D,R,V,$=0;for(D=y.r1;D<=y.r2;D++)for(R=y.g1;R<=y.g2;R++)for(V=y.b1;V<=y.b2;V++)$+=C[o(D,R,V)]||0;y._count=$,y._count_set=!0}return y._count},copy:function(){var f=this;return new s(f.r1,f.r2,f.g1,f.g2,f.b1,f.b2,f.histo)},avg:function(f){var y=this,C=y.histo;if(!y._avg||f){var D,R,V,$,X=0,ee=1<<8-t,ue=0,fe=0,_e=0;for(R=y.r1;R<=y.r2;R++)for(V=y.g1;V<=y.g2;V++)for($=y.b1;$<=y.b2;$++)X+=D=C[o(R,V,$)]||0,ue+=D*(R+.5)*ee,fe+=D*(V+.5)*ee,_e+=D*($+.5)*ee;y._avg=X?[~~(ue/X),~~(fe/X),~~(_e/X)]:[~~(ee*(y.r1+y.r2+1)/2),~~(ee*(y.g1+y.g2+1)/2),~~(ee*(y.b1+y.b2+1)/2)]}return y._avg},contains:function(f){var y=this,C=f[0]>>n;return gval=f[1]>>n,bval=f[2]>>n,C>=y.r1&&C<=y.r2&&gval>=y.g1&&gval<=y.g2&&bval>=y.b1&&bval<=y.b2}},l.prototype={push:function(f){this.vboxes.push({vbox:f,color:f.avg()})},palette:function(){return this.vboxes.map(function(f){return f.color})},size:function(){return this.vboxes.size()},map:function(f){for(var y=this.vboxes,C=0;C<y.size();C++)if(y.peek(C).vbox.contains(f))return y.peek(C).color;return this.nearest(f)},nearest:function(f){for(var y,C,D,R=this.vboxes,V=0;V<R.size();V++)((C=Math.sqrt(Math.pow(f[0]-R.peek(V).color[0],2)+Math.pow(f[1]-R.peek(V).color[1],2)+Math.pow(f[2]-R.peek(V).color[2],2)))<y||void 0===y)&&(y=C,D=R.peek(V).color);return D},forcebw:function(){var f=this.vboxes;f.sort(function(R,V){return tp.naturalOrder(tp.sum(R.color),tp.sum(V.color))});var y=f[0].color;y[0]<5&&y[1]<5&&y[2]<5&&(f[0].color=[0,0,0]);var C=f.length-1,D=f[C].color;D[0]>251&&D[1]>251&&D[2]>251&&(f[C].color=[255,255,255])}},{quantize:function(f,y){if(!f.length||y<2||y>256)return!1;var ee,ue,fe,C=(ee=f,fe=new Array(1<<3*t),ee.forEach(function(_e){ue=o(_e[0]>>n,_e[1]>>n,_e[2]>>n),fe[ue]=(fe[ue]||0)+1}),fe);C.forEach(function(){});var D=function(ee,ue){var fe,_e,Be,et=1e6,gt=0,Ht=1e6,kt=0,Kt=1e6,Ln=0;return ee.forEach(function(oi){(fe=oi[0]>>n)<et?et=fe:fe>gt&&(gt=fe),(_e=oi[1]>>n)<Ht?Ht=_e:_e>kt&&(kt=_e),(Be=oi[2]>>n)<Kt?Kt=Be:Be>Ln&&(Ln=Be)}),new s(et,gt,Ht,kt,Kt,Ln,ue)}(f,C),R=new r(function(ee,ue){return tp.naturalOrder(ee.count(),ue.count())});function V(ee,ue){for(var fe,_e=ee.size(),Be=0;Be<e;){if(_e>=ue||Be++>e)return;if((fe=ee.pop()).count()){var et=h(C,fe),gt=et[0],Ht=et[1];if(!gt)return;ee.push(gt),Ht&&(ee.push(Ht),_e++)}else ee.push(fe),Be++}}R.push(D),V(R,.75*y);for(var $=new r(function(ee,ue){return tp.naturalOrder(ee.count()*ee.volume(),ue.count()*ue.volume())});R.size();)$.push(R.pop());V($,y);for(var X=new l;$.size();)X.push($.pop());return X}}}().quantize,TN=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=t.naturalWidth,this.height=this.canvas.height=t.naturalHeight,this.context.drawImage(t,0,0,this.width,this.height)};TN.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var Ry=function(){};Ry.prototype.getColor=function(t,n){return void 0===n&&(n=10),this.getPalette(t,5,n)[0]},Ry.prototype.getPalette=function(t,n,e){var o=function(h){var f=h.colorCount,y=h.quality;if(void 0!==f&&Number.isInteger(f)){if(1===f)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");f=Math.max(f,2),f=Math.min(f,20)}else f=10;return(void 0===y||!Number.isInteger(y)||y<1)&&(y=10),{colorCount:f,quality:y}}({colorCount:n,quality:e}),r=new TN(t),s=function(h,f,y){for(var C,D,R,V,$,X=h,ee=[],ue=0;ue<f;ue+=y)D=X[0+(C=4*ue)],R=X[C+1],V=X[C+2],(void 0===($=X[C+3])||$>=125)&&(D>250&&R>250&&V>250||ee.push([D,R,V]));return ee}(r.getImageData().data,r.width*r.height,o.quality),l=ese(s,o.colorCount);return l?l.palette():null},Ry.prototype.getColorFromUrl=function(t,n,e){var o=this,r=document.createElement("img");r.addEventListener("load",function(){var s=o.getPalette(r,5,e);n(s[0],t)}),r.src=t},Ry.prototype.getImageData=function(t,n){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){if(200==this.status){var o=new Uint8Array(this.response);i=o.length;for(var r=new Array(i),s=0;s<o.length;s++)r[s]=String.fromCharCode(o[s]);var l=r.join(""),h=window.btoa(l);n("data:image/png;base64,"+h)}},e.send()},Ry.prototype.getColorAsync=function(t,n,e){var o=this;this.getImageData(t,function(r){var s=document.createElement("img");s.addEventListener("load",function(){var l=o.getPalette(s,5,e);n(l[0],this)}),s.src=r})};const tse=["toggleButton"],nse=["toggleButtonIcon"],ise=["menuDiv"];function ose(t,n){1&t&&(P(0,"div"),Ae(1,"app-loader"),N())}function rse(t,n){1&t&&Ae(0,"img",22),2&t&&Ai("src",U(2).playlist.playlistImage,Ui)}function sse(t,n){1&t&&Ae(0,"img",23),2&t&&L("alt",U(2).playlist.name)}function ase(t,n){if(1&t){const e=Ye();P(0,"div",24)(1,"input",25),Te("ngModelChange",function(r){return be(e),ve(U(2).playlist.name=r)}),N(),P(2,"button",26),Te("click",function(){be(e);const r=U(2);return ve(r.updateName(r.playlist.playlistId,r.playlist.name,r.playlist.description))}),P(3,"mat-icon"),ie(4,"done"),N()()()}if(2&t){const e=U(2);F(1),L("ngModel",e.playlist.name)}}function lse(t,n){if(1&t&&(P(0,"h1",33),ie(1),N()),2&t){const e=U(3);F(1),Ut(e.playlist.name)}}function cse(t,n){if(1&t){const e=Ye();P(0,"button",34),Te("click",function(){be(e);const r=U(3);return ve(r.changingName=!r.changingName)}),P(1,"mat-icon"),ie(2,"edit"),N()()}}function use(t,n){1&t&&(P(0,"mat-icon"),ie(1,"favorite_outline"),N())}function dse(t,n){1&t&&(P(0,"mat-icon"),ie(1,"favorite"),N())}function hse(t,n){if(1&t){const e=Ye();P(0,"button",35),Te("click",function(){be(e);const r=U(3);return ve(r.deletePlaylist(r.playlist.playlistId))}),P(1,"mat-icon"),ie(2,"delete"),N()()}}function pse(t,n){if(1&t){const e=Ye();P(0,"button",34),Te("click",function(){be(e);const r=U(3);return ve(r.onFollow(r.playlist.playlistId))}),P(1,"mat-icon"),ie(2,"add"),N()()}}function fse(t,n){if(1&t){const e=Ye();P(0,"div",27),W(1,lse,2,1,"h1",28),P(2,"div",29),W(3,cse,3,0,"button",30),P(4,"button",31),Te("click",function(){be(e);const r=U(2);return ve(r.onFavorite(r.playlist.playlistId))}),W(5,use,2,0,"mat-icon",1),W(6,dse,2,0,"mat-icon",1),N(),W(7,hse,3,0,"button",32),W(8,pse,3,0,"button",30),N()()}if(2&t){const e=U(2);F(1),L("ngIf",!e.changingName),F(2),L("ngIf",e.itsMe),F(1),L("disabled",e.disableLike),F(1),L("ngIf",!e.favorite),F(1),L("ngIf",e.favorite),F(1),L("ngIf",e.itsMe),F(1),L("ngIf",!e.itsMe&&!e.following)}}function mse(t,n){if(1&t){const e=Ye();P(0,"div",24)(1,"textarea",38),Te("ngModelChange",function(r){return be(e),ve(U(3).playlist.description=r)}),N(),P(2,"button",39),Te("click",function(){be(e);const r=U(3);return ve(r.updateDesc(r.playlist.playlistId,r.playlist.name,r.playlist.description))}),P(3,"mat-icon"),ie(4,"done"),N()()()}if(2&t){const e=U(3);F(1),L("ngModel",e.playlist.description)}}function gse(t,n){if(1&t&&(P(0,"p",44),ie(1),N()),2&t){const e=U(4);F(1),jn(" ",e.playlist.description," ")}}function _se(t,n){if(1&t){const e=Ye();P(0,"div",45)(1,"button",34),Te("click",function(){be(e);const r=U(4);return ve(r.changingDesc=!r.changingDesc)}),P(2,"mat-icon"),ie(3,"edit"),N()()()}}function yse(t,n){if(1&t&&(P(0,"div",40)(1,"div",41),W(2,gse,2,1,"p",42),W(3,_se,4,0,"div",43),N()()),2&t){const e=U(3);F(2),L("ngIf",!e.changingDesc),F(1),L("ngIf",e.itsMe)}}function vse(t,n){if(1&t&&(P(0,"div",36),W(1,mse,5,1,"div",13),W(2,yse,4,2,"div",37),N()),2&t){const e=U(2);F(1),L("ngIf",e.changingDesc),F(1),L("ngIf",!e.changingDesc)}}function bse(t,n){if(1&t){const e=Ye();P(0,"div")(1,"div",4)(2,"button",5),Te("click",function(){return be(e),ve(U().goBack())}),P(3,"mat-icon"),ie(4,"arrow_back"),N()(),P(5,"span",6),ie(6," Volver "),N()(),P(7,"div",7)(8,"div",8),W(9,rse,1,1,"img",9),W(10,sse,1,1,"img",10),N(),P(11,"div",11)(12,"div",12),W(13,ase,5,1,"div",13),W(14,fse,9,7,"div",14),N(),W(15,vse,3,2,"div",15),P(16,"div",16),Ae(17,"img",17),P(18,"p",18),ie(19),N()(),P(20,"button",19),Te("click",function(){be(e);const r=U();return ve(r.redirectToSpotify(r.playlist.spotifyPlaylistId))}),P(21,"div",20),Ae(22,"img",21),ie(23," Escuchar en Spotify "),N()()()()()}if(2&t){const e=U();F(9),L("ngIf",""!=e.playlist.playlistImage),F(1),L("ngIf",""==e.playlist.playlistImage),F(3),L("ngIf",e.changingName),F(1),L("ngIf",!e.changingName),F(1),L("ngIf",""!=e.playlist.description),F(2),Ai("src",e.playlist.userProfileImage,Ui),F(2),w1("",e.playlist.userName," \xb7 ",e.numVibes," vibes \xb7 ",e.numLikes," me gusta")}}function xse(t,n){if(1&t){const e=Ye();P(0,"button",67,64),Te("click",function(){be(e);const r=U(3);return ve(r.edit=!r.edit)}),P(2,"mat-icon",null,65),ie(4,"edit"),N()()}}function wse(t,n){if(1&t){const e=Ye();P(0,"button",67,64),Te("click",function(){be(e);const r=U(3);return ve(r.edit=!r.edit)}),P(2,"mat-icon",null,65),ie(4,"check"),N()()}}function Cse(t,n){if(1&t){const e=Ye();P(0,"div",62)(1,"button",63,64),Te("click",function(){return be(e),ve(U(2).displayAddToPLaylistDialog=!0)}),P(3,"mat-icon",null,65),ie(5,"add"),N()(),W(6,xse,5,0,"button",66),W(7,wse,5,0,"button",66),N()}if(2&t){const e=U(2);F(6),L("ngIf",!e.edit),F(1),L("ngIf",e.edit)}}const SN=function(t){return{opacity:t}};function Tse(t,n){if(1&t){const e=Ye();P(0,"mat-icon",78),Te("click",function(){be(e);const r=U().$implicit;return ve(U(2).playPreview(r.spotifySongId,r.songPreview))}),ie(1),N()}if(2&t){const e=U().$implicit,o=U(2);L("ngStyle",Wt(2,SN,o.appLayout.playingSong==e.spotifySongId?"1":"0")),F(1),Ut(o.appLayout.playingSong==e.spotifySongId?o.appLayout.previewIcon:"play_arrow")}}function Sse(t,n){if(1&t){const e=Ye();P(0,"button",79,64),Te("click",function(){be(e);const r=U().$implicit;return ve(U(2).deleteViveFromPlaylist(r.vibeId))}),P(2,"mat-icon",null,65),ie(4,"remove_circle_outline"),N()()}}const Ese=function(t){return{"diffuse-image":t}};function Ise(t,n){if(1&t){const e=Ye();P(0,"div")(1,"div",68),Te("click",function(){const s=be(e).$implicit;return ve(U(2).centerMap(s.longitude,s.latitude))}),P(2,"div",69),Ae(3,"img",70),W(4,Tse,2,4,"mat-icon",71),N(),P(5,"div",72)(6,"p",73)(7,"span",74),ie(8),N(),P(9,"span",75),ie(10),N()()(),P(11,"div",76),W(12,Sse,5,0,"button",77),N()()()}if(2&t){const e=n.$implicit,o=U(2);F(1),L("ngClass",Wt(8,Ese,null!=e.songPreview)),F(2),Ai("src",e.songImage,Ui),Ai("alt",e.songName),L("ngStyle",Wt(10,SN,o.appLayout.playingSong==e.spotifySongId?"0.4":"1")),F(1),L("ngIf",null!=e.songPreview),F(4),Ut(e.songName),F(2),Ut(e.userName),F(2),L("ngIf",o.edit)}}function Dse(t,n){1&t&&(P(0,"h4",80),ie(1," No hay ningun vibe en esta playlist "),N())}function Mse(t,n){if(1&t){const e=Ye();P(0,"div",46)(1,"div",47)(2,"div",48)(3,"app-map-vibes",49),Te("deletedVibe",function(r){return be(e),ve(U().deleteVibe(r))}),N()(),P(4,"div",50)(5,"div",51)(6,"div",52)(7,"h3"),ie(8,"Vibes"),N(),W(9,Cse,8,2,"div",53),N()(),P(10,"div",54),W(11,Ise,13,12,"div",55),W(12,Dse,2,0,"h4",56),N()()(),P(13,"div",57)(14,"h3",58),ie(15,"Comentarios"),N(),P(16,"div",59)(17,"h3",60),ie(18,"Comentarios"),N(),Ae(19,"app-comments",61),N()()()}if(2&t){const e=U();F(3),L("mapHeight",e.mapHeight)("id",e.id)("showSearchBar",!0)("initMapEvent",e.vibesLoaded.asObservable())("showLocationButton",!1)("playlistDetail",!0)("vibesArray",e.playlist.vibes),F(6),L("ngIf",e.itsMe),F(2),L("ngForOf",e.playlist.vibes),F(1),L("ngIf",0==(null==e.playlist.vibes?null:e.playlist.vibes.length)),F(7),L("playlistId",e.playlist.playlistId)("comments",e.comments)}}let kse=(()=>{class t{constructor(e,o,r,s,l,h,f,y){this.route=e,this.router=o,this.location=r,this.confirmationService=s,this.renderer=l,this.playlistsService=h,this.appLayout=f,this.titleService=y,this.loaded=!1,this.vibesLoaded=new si,this.displayAddToPLaylistDialog=!1,this.favorite=!1,this.isMenuOpen=!1,this.menuHeight=135,this.mapHeight="800px",this.changingName=!1,this.changingDesc=!1,this.comments=new Array,this.edit=!1,this.numLikes=0,this.numVibes=0,this.itsMe=!1,this.following=!1,this.disableLike=!1,this.deletedVibe=new si,this.renderer.listen("window","click",C=>{"more-button border-none flex justify-content-center align-items-center"==C.target.attributes.class.nodeValue||"mat-icon notranslate material-icons mat-ligature-font mat-icon-no-color"==C.target.attributes.class.nodeValue||C.target.attributes.class.nodeValue.includes("ng-tns-")||C.target.attributes.class.nodeValue.includes("p-menuitem")||C.target.attributes.class.nodeValue.includes("p-submenu")||C.target.attributes.class.nodeValue.includes("p-menuitem-text")||"ng-tns-c146-3"==C.target.attributes.class.nodeValue||C.target.attributes.class.nodeValue.includes("p-slidemenu-backward")||(this.isMenuOpen=!1)}),this.titleService.setTitle(this.route.snapshot.paramMap.get("name")),this.playlist=new BC}ngOnInit(){this.id=this.route.snapshot.paramMap.get("playlistId"),this.getPlaylist(),this.getComments()}ngAfterViewChecked(){window.innerWidth>=1650?this.mapHeight="800px":window.innerWidth<1650&&window.innerWidth>1200?this.mapHeight="600px":window.innerWidth<=1200&&window.innerWidth>900?this.mapHeight="700px":window.innerWidth<=900&&(this.mapHeight="500px")}changeBackground(){const e=new Ry,o=new Image;o.crossOrigin="Anonymous",o.src="https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&refresh=2592000&url="+encodeURIComponent(this.playlist.playlistImage),o.addEventListener("load",()=>{var s=e.getColor(o),l="linear-gradient(45deg, var(--background) 0%, rgba("+s[0]+","+s[1]+","+s[2]+",1) 100%)";document.getElementById("colored-background").style.background=l,this.loaded=!0})}redirectToSpotify(e){var o;this.confirmationService.confirm({header:"Ir a Spotify",message:"Se va a abrir una nueva pesta\xf1a en tu navegador para que puedas escuchar la playlist en Spotify.",acceptLabel:"Ir a Spotify",rejectLabel:"Cancelar",accept:(o=Ft(function*(){window.open("https://open.spotify.com/playlist/"+e,"_blank")}),function(){return o.apply(this,arguments)})})}goBack(){this.location.back()}updatePlaylist(e,o,r){var s=this;return Ft(function*(){try{yield s.playlistsService.updatePlaylist(e,o,r)}catch(l){403==l.status?s.appLayout.handle403Error():s.appLayout.messageService.add({severity:"error",summary:"Error",detail:l.data.status})}})()}updateName(e,o,r){this.changingName=!this.changingName,this.updatePlaylist(e,o,r)}updateDesc(e,o,r){this.changingDesc=!this.changingDesc,this.updatePlaylist(e,o,r)}deletePlaylist(e){var r,o=this;this.confirmationService.confirm({header:"Borrar playlist",message:"\xbfSeguro que deseas borrar esta playlist? Una vez borrada no se podr\xe1 recuperar",acceptLabel:"Borrar playlist",rejectLabel:"Cancelar",accept:(r=Ft(function*(){try{yield o.playlistsService.deletePlaylist(e),o.router.navigate(["/playlists"])}catch(s){403==s.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.data.status})}}),function(){return r.apply(this,arguments)})})}onFollow(e){var o=this;return Ft(function*(){try{yield o.playlistsService.followPlaylist(e),o.following=!0}catch(r){403==r.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}})()}deleteViveFromPlaylist(e){var o=this;return Ft(function*(){var r;o.confirmationService.confirm({header:"Borrar vibe",message:"\xbfSeguro que deseas borrar este vibe? S\xf3lo se borrar\xe1 de la playlist actual",acceptLabel:"Borrar vibe",rejectLabel:"Cancelar",accept:(r=Ft(function*(){try{yield o.playlistsService.deleteVibeFromPlaylist(o.id,e),o.appLayout.deletedVibeFromPlaylist.emit(e),o.deleteVibe(e)}catch(s){403==s.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.data.status})}}),function(){return r.apply(this,arguments)})})})()}onFavorite(e){var o=this;return Ft(function*(){if(o.disableLike=!0,o.favorite)try{yield o.playlistsService.dislikePlaylist(e),o.favorite=!o.favorite,o.numLikes-=1}catch(r){403==r.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}else try{yield o.playlistsService.likePlaylist(e),o.favorite=!o.favorite,o.numLikes+=1}catch(r){403==r.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}o.disableLike=!1})()}hideDialog(e){this.displayAddToPLaylistDialog=e}deleteVibe(e){this.numVibes-=1;for(let o=0;o<this.playlist.vibes.length;o++)if(this.playlist.vibes[o].vibeId==e){this.playlist.vibes.splice(o,1);break}}getPlaylist(){var e=this;return Ft(function*(){try{const o=yield e.playlistsService.getPlaylist(e.id);e.playlist=o.playlist,e.playlist.userId==e.appLayout.user.userId&&(e.itsMe=!0);for(let r=0;r<e.playlist.followersIds.length;r++)if(e.playlist.followersIds[r]==e.appLayout.user.userId){e.following=!0;break}e.vibes=e.playlist.vibes;for(let r=0;r<e.playlist.likes.length;r++)if(e.playlist.likes[r].userId==e.playlist.userId){e.favorite=!0;break}e.numLikes=e.playlist.likes.length,e.numVibes=e.playlist.vibes.length,""!=e.playlist.playlistImage?e.changeBackground():e.loaded=!0}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}getComments(){var e=this;return Ft(function*(){try{const o=yield e.playlistsService.getComments(e.id);e.comments=o.comments}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}playPreview(e,o){this.appLayout.playPreview(e,o)}centerMap(e,o){this.appLayout.centerOnMap.emit([e,o])}addNewVibe(e){this.playlist.vibes.push(e),this.appLayout.newVibeAdded.emit(e)}}return t.\u0275fac=function(e){return new(e||t)(ce(Yh),ce(Ss),ce(V1),ce(Dg),ce(Jr),ce(ku),ce(Zo),ce(_c))},t.\u0275cmp=Qt({type:t,selectors:[["app-playlist-detail"]],viewQuery:function(e,o){if(1&e&&(pi(tse,5),pi(nse,5),pi(ise,5)),2&e){let r;gn(r=_n())&&(o.toggleButton=r.first),gn(r=_n())&&(o.toggleButtonIcon=r.first),gn(r=_n())&&(o.menuDiv=r.first)}},decls:5,vars:7,consts:[["id","colored-background",1,"header-background","content",2,"margin","0"],[4,"ngIf"],["class","content",4,"ngIf"],["buttonTitle","A\xf1adir vibe",3,"newPLaylist","display","playlistId","vibesInPlaylist","showDialog","newVibeAdded"],[1,"flex","align-items-center","mb-2"],["mat-icon-button","","type","button",1,"black-buttons","flex","align-items-center","justify-content-center",3,"click"],[1,"ml-1","text-xl",2,"color","var(--fontColor)"],[1,"playlist-header"],[1,"playlist-image-container","justify-content-center"],["class","playlist-image","alt","Playlist Image","crossorigin","anonymous",3,"src",4,"ngIf"],["src","assets/images/playlist-placeholder.svg","class","playlist-image","style","background: var(--background); border-radius: 5px;",3,"alt",4,"ngIf"],[1,"playlist-desc-continer"],[1,"flex","align-items-center","align-content-center","mb-2"],["class","flex align-items-center width-desc","style","margin-bottom: 7px",4,"ngIf"],["class","text-buttons",4,"ngIf"],["class","flex align-items-center align-content-center mb-2 w-full margin-buttons mt-0",4,"ngIf"],[1,"flex","align-items-center","mb-4"],["alt","logo",1,"profile-image","mr-2",3,"src"],[1,"m-0","text-base"],["type","button",1,"spoty-btn","w-15rem",3,"click"],[1,"flex","align-items-center","justify-content-center","text-lg"],["src","assets/images/spotify-white.svg","width","20","height","20","alt","logo",1,"spoty-icon","mr-2"],["alt","Playlist Image","crossorigin","anonymous",1,"playlist-image",3,"src"],["src","assets/images/playlist-placeholder.svg",1,"playlist-image",2,"background","var(--background)","border-radius","5px",3,"alt"],[1,"flex","align-items-center","width-desc",2,"margin-bottom","7px"],["type","text","pInputText","",1,"text-6xl","width-desc-2",3,"ngModel","ngModelChange"],["type","button",1,"ml-2","black-buttons",3,"click"],[1,"text-buttons"],["id","playlistName","class","text-6xl text-elipsis","style","white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",4,"ngIf"],[1,"flex","justify-content-center","margin-buttons"],["class","flex justify-content-center align-items-center ml-2 black-buttons","type","button",3,"click",4,"ngIf"],["type","button",1,"flex","justify-content-center","align-items-center","ml-2","black-buttons",3,"disabled","click"],["class","flex justify-content-center align-items-center ml-2 black-buttons text-pink-500","type","button",3,"click",4,"ngIf"],["id","playlistName",1,"text-6xl","text-elipsis",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],["type","button",1,"flex","justify-content-center","align-items-center","ml-2","black-buttons",3,"click"],["type","button",1,"flex","justify-content-center","align-items-center","ml-2","black-buttons","text-pink-500",3,"click"],[1,"flex","align-items-center","align-content-center","mb-2","w-full","margin-buttons","mt-0"],["class","flex align-items-center align-content-center text-buttons",4,"ngIf"],["placeholder","A\xf1adir descripci\xf3n",1,"flex","align-items-center","align-content-center","width-desc-2","h-5rem","border-none","p-3",2,"resize","none","border-radius","10px","font-family","Lato","color","var(--fontColor)","background","var(--frostedBackground)","outline","0.15rem solid #93cbf9",3,"ngModel","ngModelChange"],["type","button",1,"flex","align-items-center","align-content-center","justify-content-center","ml-2","black-buttons",3,"click"],[1,"flex","align-items-center","align-content-center","text-buttons"],[1,"flex","align-content-center","align-items-center","justify-content-center","w-full"],["class","w-full text-base desc-with text-left",4,"ngIf"],["class","flex justify-content-center",4,"ngIf"],[1,"w-full","text-base","desc-with","text-left"],[1,"flex","justify-content-center"],[1,"content"],[1,"body-container"],[1,"body-map"],[3,"mapHeight","id","showSearchBar","initMapEvent","showLocationButton","playlistDetail","vibesArray","deletedVibe"],[1,"margin-sm"],[2,"border-top-left-radius","10px","border-top-right-radius","10px","background","var(--containerBackground)"],[1,"flex","justify-content-between","align-items-center","h-5rem","mx-3",2,"border-bottom","1px solid var(--separationLine)"],["class","flex align-content-center align-items-end",4,"ngIf"],[1,"song-list","containers",2,"padding","0","border-top-left-radius","0","border-top-right-radius","0"],[4,"ngFor","ngForOf"],["class","p-3 flex align-items-center justify-content-center","style","height: calc(100% - 3rem);",4,"ngIf"],[1,"comments-margin"],[1,"font-bold","pb-4","hide-title-sm"],[1,"card","w-full","container-chat","text-base"],[1,"show-title-sm","pb-4",2,"border-bottom","1px solid var(--separationLine)"],[3,"playlistId","comments"],[1,"flex","align-content-center","align-items-end"],["mat-icon-button","","type","button",1,"black-buttons","mr-2",2,"cursor","pointer","height","45px","width","45px","border-radius","100% !important",3,"click"],["toggleButton",""],["toggleButtonIcon",""],["mat-icon-button","","class","black-buttons","type","button","style","cursor: pointer; height: 45px; width: 45px; border-radius: 100% !important;",3,"click",4,"ngIf"],["mat-icon-button","","type","button",1,"black-buttons",2,"cursor","pointer","height","45px","width","45px","border-radius","100% !important",3,"click"],[1,"grow","relative","flex","pl-3","pr-3","pt-3",3,"ngClass","click"],[1,"flex-initial","flex","align-items-center","justify-content-center","relative",2,"color","var(--fontColor)"],[1,"song-list-img",2,"box-shadow","var(--shadows)",3,"src","ngStyle","alt"],["class","play-icon-preview absolute flex align-items-center w-full h-full",3,"ngStyle","click",4,"ngIf"],[1,"flex-grow-1","flex","align-items-center",2,"cursor","pointer"],[1,"ml-3","m-0","block","text-lg"],[1,"block","mb-1"],[1,"block","mt-1","text-sm",2,"font-weight","lighter !important"],[1,"flex-initial","flex","align-items-center","justify-content-center"],["mat-icon-button","","class","black-buttons vibe-list-buttons text-pink-500","type","button","style","cursor: pointer; height: 45px; width: 45px; border-radius: 100% !important;",3,"click",4,"ngIf"],[1,"play-icon-preview","absolute","flex","align-items-center","w-full","h-full",3,"ngStyle","click"],["mat-icon-button","","type","button",1,"black-buttons","vibe-list-buttons","text-pink-500",2,"cursor","pointer","height","45px","width","45px","border-radius","100% !important",3,"click"],[1,"p-3","flex","align-items-center","justify-content-center",2,"height","calc(100% - 3rem)"]],template:function(e,o){1&e&&(P(0,"div",0),W(1,ose,2,0,"div",1),W(2,bse,24,9,"div",1),N(),W(3,Mse,20,12,"div",2),P(4,"app-new-playlist-dialog",3),Te("showDialog",function(s){return o.hideDialog(s)})("newVibeAdded",function(s){return o.addNewVibe(s)}),N()),2&e&&(F(1),L("ngIf",!o.loaded),F(1),L("ngIf",o.loaded),F(1),L("ngIf",o.loaded),F(1),L("newPLaylist",!1)("display",o.displayAddToPLaylistDialog)("playlistId",o.playlist.playlistId)("vibesInPlaylist",o.vibes))},dependencies:[ao,Ns,Xn,ho,yc,$a,_l,_a,Id,VC,hN,xN,zd],styles:["[_nghost-%COMP%]{width:100%;height:100%}.playlist-header[_ngcontent-%COMP%]{transition:var(--transition);display:flex}.playlist-image-container[_ngcontent-%COMP%]{transition:var(--transition);display:flex;flex:0 1 auto;align-items:center;height:250px;width:250px}.playlist-image[_ngcontent-%COMP%]{height:250px;width:250px;object-fit:cover;border-radius:10px;box-shadow:0 1px 5px #00000075}.playlist-desc-continer[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;margin-left:2rem}.profile-image[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;object-fit:cover;box-shadow:0 1px 5px #00000075}.header-background[_ngcontent-%COMP%]{background:var(--containerBackground);box-shadow:var(--shadows)}.body-container[_ngcontent-%COMP%]{transition:var(--transition);display:flex;margin-top:1.5rem}.body-map[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;justify-content:flex-end;border-radius:10px;margin-right:2rem;height:800px;box-shadow:var(--shadows)!important}.song-list[_ngcontent-%COMP%]{width:400px;height:720px;overflow:scroll;margin:0!important}.song-list-img[_ngcontent-%COMP%]{height:75px;width:75px;object-fit:cover;border-radius:5px}.text-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:left}.vibe-list-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.text-elipsis[_ngcontent-%COMP%]{max-width:800px}.width-desc[_ngcontent-%COMP%]{transition:var(--transition);width:70%}.width-desc-2[_ngcontent-%COMP%]{transition:var(--transition);width:95%!important}.comments-margin[_ngcontent-%COMP%]{margin-top:1.5rem}.show-title-sm[_ngcontent-%COMP%]{display:none}.desc-with[_ngcontent-%COMP%]{max-width:750px}.black-buttons[_ngcontent-%COMP%]{background:var(--frostedButtons);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.spoty-btn[_ngcontent-%COMP%]{box-shadow:0 1px 5px #00000075}  .p-progress-spinner-circle{stroke:var(--fontColor)!important}@media (max-width: 1650px){.text-elipsis[_ngcontent-%COMP%]{max-width:700px}.song-list[_ngcontent-%COMP%]{height:520px}.body-map[_ngcontent-%COMP%]{height:600px}}@media (max-width: 1500px){.text-elipsis[_ngcontent-%COMP%]{max-width:600px}.width-desc[_ngcontent-%COMP%]{width:100%}}@media (max-width: 1400px){.body-container[_ngcontent-%COMP%]{margin-top:0}}@media (max-width: 1350px){.text-elipsis[_ngcontent-%COMP%]{max-width:500px}}@media (max-width: 1260px){.text-elipsis[_ngcontent-%COMP%]{max-width:450px}}@media (max-width: 1200px){.text-elipsis[_ngcontent-%COMP%]{overflow:visible!important;text-align:center!important;white-space:inherit!important}.playlist-header[_ngcontent-%COMP%]{flex-direction:column;width:100%}.playlist-image-container[_ngcontent-%COMP%]{width:100%}.playlist-desc-continer[_ngcontent-%COMP%]{width:100%;align-items:center;margin-top:1rem;margin-left:0}.body-container[_ngcontent-%COMP%]{flex-direction:column;width:100%;margin-top:.25rem}.body-map[_ngcontent-%COMP%]{width:100%;height:700px;margin-right:0}.song-list[_ngcontent-%COMP%]{width:100%;margin-bottom:1.5rem!important}.text-buttons[_ngcontent-%COMP%]{width:100%;margin:auto;display:block;align-items:center;align-content:center;text-align:center}.margin-sm[_ngcontent-%COMP%]{margin-top:1.5rem}.margin-buttons[_ngcontent-%COMP%]{margin-top:1rem}.comments-margin[_ngcontent-%COMP%]{margin-top:0}.hide-title-sm[_ngcontent-%COMP%]{display:none}.show-title-sm[_ngcontent-%COMP%]{display:block}.desc-with[_ngcontent-%COMP%]{max-width:-moz-fit-content;max-width:fit-content}}@media (max-width: 900px){.margin-sm[_ngcontent-%COMP%]{margin-top:16px}.song-list[_ngcontent-%COMP%]{margin-bottom:16px!important}.body-map[_ngcontent-%COMP%]{height:500px}}"]}),t})();function D0(t){return(D0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(t)}function Nn(t,n,e){return(n=function Pse(t){var n=function Ase(t,n){if("object"!==D0(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var o=e.call(t,n||"default");if("object"!==D0(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===D0(n)?n:String(n)}(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function Fy(t){return t+.5|0}const np=(t,n,e)=>Math.max(Math.min(t,e),n);function M0(t){return np(Fy(2.55*t),0,255)}function Bf(t){return np(Fy(255*t),0,255)}function ip(t){return np(Fy(t/2.55)/100,0,1)}function EN(t){return np(Fy(100*t),0,100)}const Dc={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},xD=[..."0123456789ABCDEF"],Ose=t=>xD[15&t],Lse=t=>xD[(240&t)>>4]+xD[15&t],GC=t=>(240&t)>>4==(15&t),Bse=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function IN(t,n,e){const o=n*Math.min(e,1-e),r=(s,l=(s+t/30)%12)=>e-o*Math.max(Math.min(l-3,9-l,1),-1);return[r(0),r(8),r(4)]}function Vse(t,n,e){const o=(r,s=(r+t/60)%6)=>e-e*n*Math.max(Math.min(s,4-s,1),0);return[o(5),o(3),o(1)]}function Use(t,n,e){const o=IN(t,1,.5);let r;for(n+e>1&&(r=1/(n+e),n*=r,e*=r),r=0;r<3;r++)o[r]*=1-n-e,o[r]+=n;return o}function wD(t){const e=t.r/255,o=t.g/255,r=t.b/255,s=Math.max(e,o,r),l=Math.min(e,o,r),h=(s+l)/2;let f,y,C;return s!==l&&(C=s-l,y=h>.5?C/(2-s-l):C/(s+l),f=function jse(t,n,e,o,r){return t===r?(n-e)/o+(n<e?6:0):n===r?(e-t)/o+2:(t-n)/o+4}(e,o,r,C,s),f=60*f+.5),[0|f,y||0,h]}function CD(t,n,e,o){return(Array.isArray(n)?t(n[0],n[1],n[2]):t(n,e,o)).map(Bf)}function TD(t,n,e){return CD(IN,t,n,e)}function DN(t){return(t%360+360)%360}const MN={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},kN={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let WC;const Xse=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,SD=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,Ny=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function qC(t,n,e){if(t){let o=wD(t);o[n]=Math.max(0,Math.min(o[n]+o[n]*e,0===n?360:1)),o=TD(o),t.r=o[0],t.g=o[1],t.b=o[2]}}function AN(t,n){return t&&Object.assign(n||{},t)}function PN(t){var n={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(n={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(n.a=Bf(t[3]))):(n=AN(t,{r:0,g:0,b:0,a:1})).a=Bf(n.a),n}function eae(t){return"r"===t.charAt(0)?function Yse(t){const n=Xse.exec(t);let o,r,s,e=255;if(n){if(n[7]!==o){const l=+n[7];e=n[8]?M0(l):np(255*l,0,255)}return o=+n[1],r=+n[3],s=+n[5],o=255&(n[2]?M0(o):np(o,0,255)),r=255&(n[4]?M0(r):np(r,0,255)),s=255&(n[6]?M0(s):np(s,0,255)),{r:o,g:r,b:s,a:e}}}(t):function Gse(t){const n=Bse.exec(t);let o,e=255;if(!n)return;n[5]!==o&&(e=n[6]?M0(+n[5]):Bf(+n[5]));const r=DN(+n[2]),s=+n[3]/100,l=+n[4]/100;return o="hwb"===n[1]?function Hse(t,n,e){return CD(Use,t,n,e)}(r,s,l):"hsv"===n[1]?function $se(t,n,e){return CD(Vse,t,n,e)}(r,s,l):TD(r,s,l),{r:o[0],g:o[1],b:o[2],a:e}}(t)}class zy{constructor(n){if(n instanceof zy)return n;const e=typeof n;let o;"object"===e?o=PN(n):"string"===e&&(o=function Fse(t){var e,n=t.length;return"#"===t[0]&&(4===n||5===n?e={r:255&17*Dc[t[1]],g:255&17*Dc[t[2]],b:255&17*Dc[t[3]],a:5===n?17*Dc[t[4]]:255}:(7===n||9===n)&&(e={r:Dc[t[1]]<<4|Dc[t[2]],g:Dc[t[3]]<<4|Dc[t[4]],b:Dc[t[5]]<<4|Dc[t[6]],a:9===n?Dc[t[7]]<<4|Dc[t[8]]:255})),e}(n)||function Kse(t){WC||(WC=function Zse(){const t={},n=Object.keys(kN),e=Object.keys(MN);let o,r,s,l,h;for(o=0;o<n.length;o++){for(l=h=n[o],r=0;r<e.length;r++)s=e[r],h=h.replace(s,MN[s]);s=parseInt(kN[l],16),t[h]=[s>>16&255,s>>8&255,255&s]}return t}(),WC.transparent=[0,0,0,0]);const n=WC[t.toLowerCase()];return n&&{r:n[0],g:n[1],b:n[2],a:4===n.length?n[3]:255}}(n)||eae(n)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var n=AN(this._rgb);return n&&(n.a=ip(n.a)),n}set rgb(n){this._rgb=PN(n)}rgbString(){return this._valid?function Qse(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${ip(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}(this._rgb):void 0}hexString(){return this._valid?function zse(t){var n=(t=>GC(t.r)&&GC(t.g)&&GC(t.b)&&GC(t.a))(t)?Ose:Lse;return t?"#"+n(t.r)+n(t.g)+n(t.b)+((t,n)=>t<255?n(t):"")(t.a,n):void 0}(this._rgb):void 0}hslString(){return this._valid?function qse(t){if(!t)return;const n=wD(t),e=n[0],o=EN(n[1]),r=EN(n[2]);return t.a<255?`hsla(${e}, ${o}%, ${r}%, ${ip(t.a)})`:`hsl(${e}, ${o}%, ${r}%)`}(this._rgb):void 0}mix(n,e){if(n){const o=this.rgb,r=n.rgb;let s;const l=e===s?.5:e,h=2*l-1,f=o.a-r.a,y=((h*f==-1?h:(h+f)/(1+h*f))+1)/2;s=1-y,o.r=255&y*o.r+s*r.r+.5,o.g=255&y*o.g+s*r.g+.5,o.b=255&y*o.b+s*r.b+.5,o.a=l*o.a+(1-l)*r.a,this.rgb=o}return this}interpolate(n,e){return n&&(this._rgb=function Jse(t,n,e){const o=Ny(ip(t.r)),r=Ny(ip(t.g)),s=Ny(ip(t.b));return{r:Bf(SD(o+e*(Ny(ip(n.r))-o))),g:Bf(SD(r+e*(Ny(ip(n.g))-r))),b:Bf(SD(s+e*(Ny(ip(n.b))-s))),a:t.a+e*(n.a-t.a)}}(this._rgb,n._rgb,e)),this}clone(){return new zy(this.rgb)}alpha(n){return this._rgb.a=Bf(n),this}clearer(n){return this._rgb.a*=1-n,this}greyscale(){const n=this._rgb,e=Fy(.3*n.r+.59*n.g+.11*n.b);return n.r=n.g=n.b=e,this}opaquer(n){return this._rgb.a*=1+n,this}negate(){const n=this._rgb;return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,this}lighten(n){return qC(this._rgb,2,n),this}darken(n){return qC(this._rgb,2,-n),this}saturate(n){return qC(this._rgb,1,n),this}desaturate(n){return qC(this._rgb,1,-n),this}rotate(n){return function Wse(t,n){var e=wD(t);e[0]=DN(e[0]+n),e=TD(e),t.r=e[0],t.g=e[1],t.b=e[2]}(this._rgb,n),this}}function op(){}const tae=(()=>{let t=0;return()=>t++})();function Do(t){return null===t||typeof t>"u"}function rr(t){if(Array.isArray&&Array.isArray(t))return!0;const n=Object.prototype.toString.call(t);return"[object"===n.slice(0,7)&&"Array]"===n.slice(-6)}function mo(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function Br(t){return("number"==typeof t||t instanceof Number)&&isFinite(+t)}function Hl(t,n){return Br(t)?t:n}function Bi(t,n){return typeof t>"u"?n:t}const ON=(t,n)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*n:+t;function Qo(t,n,e){if(t&&"function"==typeof t.call)return t.apply(e,n)}function Vo(t,n,e,o){let r,s,l;if(rr(t))if(s=t.length,o)for(r=s-1;r>=0;r--)n.call(e,t[r],r);else for(r=0;r<s;r++)n.call(e,t[r],r);else if(mo(t))for(l=Object.keys(t),s=l.length,r=0;r<s;r++)n.call(e,t[l[r]],l[r])}function ZC(t,n){let e,o,r,s;if(!t||!n||t.length!==n.length)return!1;for(e=0,o=t.length;e<o;++e)if(r=t[e],s=n[e],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function KC(t){if(rr(t))return t.map(KC);if(mo(t)){const n=Object.create(null),e=Object.keys(t),o=e.length;let r=0;for(;r<o;++r)n[e[r]]=KC(t[e[r]]);return n}return t}function LN(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function iae(t,n,e,o){if(!LN(t))return;const r=n[t],s=e[t];mo(r)&&mo(s)?k0(r,s,o):n[t]=KC(s)}function k0(t,n,e){const o=rr(n)?n:[n],r=o.length;if(!mo(t))return t;const s=(e=e||{}).merger||iae;let l;for(let h=0;h<r;++h){if(l=o[h],!mo(l))continue;const f=Object.keys(l);for(let y=0,C=f.length;y<C;++y)s(f[y],t,l,e)}return t}function A0(t,n){return k0(t,n,{merger:oae})}function oae(t,n,e){if(!LN(t))return;const o=n[t],r=e[t];mo(o)&&mo(r)?A0(o,r):Object.prototype.hasOwnProperty.call(n,t)||(n[t]=KC(r))}const RN={"":t=>t,x:t=>t.x,y:t=>t.y};function Vf(t,n){return(RN[n]||(RN[n]=function sae(t){const n=function rae(t){const n=t.split("."),e=[];let o="";for(const r of n)o+=r,o.endsWith("\\")?o=o.slice(0,-1)+".":(e.push(o),o="");return e}(t);return e=>{for(const o of n){if(""===o)break;e=e&&e[o]}return e}}(n)))(t)}function ED(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Mc=t=>typeof t<"u",Uf=t=>"function"==typeof t,FN=(t,n)=>{if(t.size!==n.size)return!1;for(const e of t)if(!n.has(e))return!1;return!0},fr=Math.PI,sr=2*fr,lae=sr+fr,XC=Number.POSITIVE_INFINITY,cae=fr/180,Vr=fr/2,Ag=fr/4,NN=2*fr/3,jf=Math.log10,Vd=Math.sign;function P0(t,n,e){return Math.abs(t-n)<e}function zN(t){const n=Math.round(t);t=P0(t,n,t/1e3)?n:t;const e=Math.pow(10,Math.floor(jf(t))),o=t/e;return(o<=1?1:o<=2?2:o<=5?5:10)*e}function By(t){return!isNaN(parseFloat(t))&&isFinite(t)}function BN(t,n,e){let o,r,s;for(o=0,r=t.length;o<r;o++)s=t[o][e],isNaN(s)||(n.min=Math.min(n.min,s),n.max=Math.max(n.max,s))}function Au(t){return t*(fr/180)}function ID(t){return t*(180/fr)}function VN(t){if(!Br(t))return;let n=1,e=0;for(;Math.round(t*n)/n!==t;)n*=10,e++;return e}function UN(t,n){const e=n.x-t.x,o=n.y-t.y,r=Math.sqrt(e*e+o*o);let s=Math.atan2(o,e);return s<-.5*fr&&(s+=sr),{angle:s,distance:r}}function DD(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))}function hae(t,n){return(t-n+lae)%sr-fr}function $l(t){return(t%sr+sr)%sr}function O0(t,n,e,o){const r=$l(t),s=$l(n),l=$l(e),h=$l(s-r),f=$l(l-r),y=$l(r-s),C=$l(r-l);return r===s||r===l||o&&s===l||h>f&&y<C}function Bs(t,n,e){return Math.max(n,Math.min(e,t))}function rp(t,n,e,o=1e-6){return t>=Math.min(n,e)-o&&t<=Math.max(n,e)+o}function MD(t,n,e){e=e||(l=>t[l]<n);let s,o=t.length-1,r=0;for(;o-r>1;)s=r+o>>1,e(s)?r=s:o=s;return{lo:r,hi:o}}const sp=(t,n,e,o)=>MD(t,e,o?r=>{const s=t[r][n];return s<e||s===e&&t[r+1][n]===e}:r=>t[r][n]<e),fae=(t,n,e)=>MD(t,e,o=>t[o][n]>=e),jN=["push","pop","shift","splice","unshift"];function HN(t,n){const e=t._chartjs;if(!e)return;const o=e.listeners,r=o.indexOf(n);-1!==r&&o.splice(r,1),!(o.length>0)&&(jN.forEach(s=>{delete t[s]}),delete t._chartjs)}function $N(t){const n=new Set;let e,o;for(e=0,o=t.length;e<o;++e)n.add(t[e]);return n.size===o?t:Array.from(n)}const GN=typeof window>"u"?function(t){return t()}:window.requestAnimationFrame;function WN(t,n){let e=[],o=!1;return function(...r){e=r,o||(o=!0,GN.call(window,()=>{o=!1,t.apply(n,e)}))}}const kD=t=>"start"===t?"left":"end"===t?"right":"center",ya=(t,n,e)=>"start"===t?n:"end"===t?e:(n+e)/2;function qN(t,n,e){const o=n.length;let r=0,s=o;if(t._sorted){const{iScale:l,_parsed:h}=t,f=l.axis,{min:y,max:C,minDefined:D,maxDefined:R}=l.getUserBounds();D&&(r=Bs(Math.min(sp(h,l.axis,y).lo,e?o:sp(n,f,l.getPixelForValue(y)).lo),0,o-1)),s=R?Bs(Math.max(sp(h,l.axis,C,!0).hi+1,e?0:sp(n,f,l.getPixelForValue(C),!0).hi+1),r,o)-r:o-r}return{start:r,count:s}}function ZN(t){const{xScale:n,yScale:e,_scaleRanges:o}=t,r={xmin:n.min,xmax:n.max,ymin:e.min,ymax:e.max};if(!o)return t._scaleRanges=r,!0;const s=o.xmin!==n.min||o.xmax!==n.max||o.ymin!==e.min||o.ymax!==e.max;return Object.assign(o,r),s}const YC=t=>0===t||1===t,KN=(t,n,e)=>-Math.pow(2,10*(t-=1))*Math.sin((t-n)*sr/e),XN=(t,n,e)=>Math.pow(2,-10*t)*Math.sin((t-n)*sr/e)+1,L0={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*Vr),easeOutSine:t=>Math.sin(t*Vr),easeInOutSine:t=>-.5*(Math.cos(fr*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>YC(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>YC(t)?t:KN(t,.075,.3),easeOutElastic:t=>YC(t)?t:XN(t,.075,.3),easeInOutElastic:t=>YC(t)?t:t<.5?.5*KN(2*t,.1125,.45):.5+.5*XN(2*t-1,.1125,.45),easeInBack:t=>t*t*(2.70158*t-1.70158),easeOutBack:t=>(t-=1)*t*(2.70158*t+1.70158)+1,easeInOutBack(t){let n=1.70158;return(t/=.5)<1?t*t*((1+(n*=1.525))*t-n)*.5:.5*((t-=2)*t*((1+(n*=1.525))*t+n)+2)},easeInBounce:t=>1-L0.easeOutBounce(1-t),easeOutBounce:t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,easeInOutBounce:t=>t<.5?.5*L0.easeInBounce(2*t):.5*L0.easeOutBounce(2*t-1)+.5};function YN(t){if(t&&"object"==typeof t){const n=t.toString();return"[object CanvasPattern]"===n||"[object CanvasGradient]"===n}return!1}function QN(t){return YN(t)?t:new zy(t)}function AD(t){return YN(t)?t:new zy(t).saturate(.5).darken(.1).hexString()}const vae=["x","y","borderWidth","radius","tension"],bae=["color","borderColor","backgroundColor"],JN=new Map;function R0(t,n,e){return function Cae(t,n){n=n||{};const e=t+JSON.stringify(n);let o=JN.get(e);return o||(o=new Intl.NumberFormat(t,n),JN.set(e,o)),o}(n,e).format(t)}const ez={values:t=>rr(t)?t:""+t,numeric(t,n,e){if(0===t)return"0";const o=this.chart.options.locale;let r,s=t;if(e.length>1){const y=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(y<1e-4||y>1e15)&&(r="scientific"),s=function Tae(t,n){let e=n.length>3?n[2].value-n[1].value:n[1].value-n[0].value;return Math.abs(e)>=1&&t!==Math.floor(t)&&(e=t-Math.floor(t)),e}(t,e)}const l=jf(Math.abs(s)),h=Math.max(Math.min(-1*Math.floor(l),20),0),f={notation:r,minimumFractionDigits:h,maximumFractionDigits:h};return Object.assign(f,this.options.ticks.format),R0(t,o,f)},logarithmic(t,n,e){if(0===t)return"0";const o=e[n].significand||t/Math.pow(10,Math.floor(jf(t)));return[1,2,3,5,10,15].includes(o)||n>.8*e.length?ez.numeric.call(this,t,n,e):""}};var QC={formatters:ez};const Pg=Object.create(null),PD=Object.create(null);function F0(t,n){if(!n)return t;const e=n.split(".");for(let o=0,r=e.length;o<r;++o){const s=e[o];t=t[s]||(t[s]=Object.create(null))}return t}function OD(t,n,e){return"string"==typeof n?k0(F0(t,n),e):k0(F0(t,""),n)}class Eae{constructor(n,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,r)=>AD(r.backgroundColor),this.hoverBorderColor=(o,r)=>AD(r.borderColor),this.hoverColor=(o,r)=>AD(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(n),this.apply(e)}set(n,e){return OD(this,n,e)}get(n){return F0(this,n)}describe(n,e){return OD(PD,n,e)}override(n,e){return OD(Pg,n,e)}route(n,e,o,r){const s=F0(this,n),l=F0(this,o),h="_"+e;Object.defineProperties(s,{[h]:{value:s[e],writable:!0},[e]:{enumerable:!0,get(){const f=this[h],y=l[r];return mo(f)?Object.assign({},y,f):Bi(f,y)},set(f){this[h]=f}}})}apply(n){n.forEach(e=>e(this))}}var os=new Eae({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function xae(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>"onProgress"!==n&&"onComplete"!==n&&"fn"!==n}),t.set("animations",{colors:{type:"color",properties:bae},numbers:{type:"number",properties:vae}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>0|n}}}})},function wae(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function Sae(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,e)=>e.lineWidth,tickColor:(n,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:QC.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&"callback"!==n&&"parser"!==n,_indexable:n=>"borderDash"!==n&&"tickBorderDash"!==n&&"dash"!==n}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:n=>"backdropPadding"!==n&&"callback"!==n,_indexable:n=>"backdropPadding"!==n})}]);function JC(t,n,e,o,r){let s=n[r];return s||(s=n[r]=t.measureText(r).width,e.push(r)),s>o&&(o=s),o}function Dae(t,n,e,o){let r=(o=o||{}).data=o.data||{},s=o.garbageCollect=o.garbageCollect||[];o.font!==n&&(r=o.data={},s=o.garbageCollect=[],o.font=n),t.save(),t.font=n;let l=0;const h=e.length;let f,y,C,D,R;for(f=0;f<h;f++)if(D=e[f],null!=D&&!0!==rr(D))l=JC(t,r,s,l,D);else if(rr(D))for(y=0,C=D.length;y<C;y++)R=D[y],null!=R&&!rr(R)&&(l=JC(t,r,s,l,R));t.restore();const V=s.length/2;if(V>e.length){for(f=0;f<V;f++)delete r[s[f]];s.splice(0,V)}return l}function Og(t,n,e){const o=t.currentDevicePixelRatio,r=0!==e?Math.max(e/2,.5):0;return Math.round((n-r)*o)/o+r}function tz(t,n){(n=n||t.getContext("2d")).save(),n.resetTransform(),n.clearRect(0,0,t.width,t.height),n.restore()}function LD(t,n,e,o){nz(t,n,e,o,null)}function nz(t,n,e,o,r){let s,l,h,f,y,C,D,R;const V=n.pointStyle,$=n.rotation,X=n.radius;let ee=($||0)*cae;if(V&&"object"==typeof V&&(s=V.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return t.save(),t.translate(e,o),t.rotate(ee),t.drawImage(V,-V.width/2,-V.height/2,V.width,V.height),void t.restore();if(!(isNaN(X)||X<=0)){switch(t.beginPath(),V){default:r?t.ellipse(e,o,r/2,X,0,0,sr):t.arc(e,o,X,0,sr),t.closePath();break;case"triangle":C=r?r/2:X,t.moveTo(e+Math.sin(ee)*C,o-Math.cos(ee)*X),ee+=NN,t.lineTo(e+Math.sin(ee)*C,o-Math.cos(ee)*X),ee+=NN,t.lineTo(e+Math.sin(ee)*C,o-Math.cos(ee)*X),t.closePath();break;case"rectRounded":y=.516*X,f=X-y,l=Math.cos(ee+Ag)*f,D=Math.cos(ee+Ag)*(r?r/2-y:f),h=Math.sin(ee+Ag)*f,R=Math.sin(ee+Ag)*(r?r/2-y:f),t.arc(e-D,o-h,y,ee-fr,ee-Vr),t.arc(e+R,o-l,y,ee-Vr,ee),t.arc(e+D,o+h,y,ee,ee+Vr),t.arc(e-R,o+l,y,ee+Vr,ee+fr),t.closePath();break;case"rect":if(!$){f=Math.SQRT1_2*X,C=r?r/2:f,t.rect(e-C,o-f,2*C,2*f);break}ee+=Ag;case"rectRot":D=Math.cos(ee)*(r?r/2:X),l=Math.cos(ee)*X,h=Math.sin(ee)*X,R=Math.sin(ee)*(r?r/2:X),t.moveTo(e-D,o-h),t.lineTo(e+R,o-l),t.lineTo(e+D,o+h),t.lineTo(e-R,o+l),t.closePath();break;case"crossRot":ee+=Ag;case"cross":D=Math.cos(ee)*(r?r/2:X),l=Math.cos(ee)*X,h=Math.sin(ee)*X,R=Math.sin(ee)*(r?r/2:X),t.moveTo(e-D,o-h),t.lineTo(e+D,o+h),t.moveTo(e+R,o-l),t.lineTo(e-R,o+l);break;case"star":D=Math.cos(ee)*(r?r/2:X),l=Math.cos(ee)*X,h=Math.sin(ee)*X,R=Math.sin(ee)*(r?r/2:X),t.moveTo(e-D,o-h),t.lineTo(e+D,o+h),t.moveTo(e+R,o-l),t.lineTo(e-R,o+l),ee+=Ag,D=Math.cos(ee)*(r?r/2:X),l=Math.cos(ee)*X,h=Math.sin(ee)*X,R=Math.sin(ee)*(r?r/2:X),t.moveTo(e-D,o-h),t.lineTo(e+D,o+h),t.moveTo(e+R,o-l),t.lineTo(e-R,o+l);break;case"line":l=r?r/2:Math.cos(ee)*X,h=Math.sin(ee)*X,t.moveTo(e-l,o-h),t.lineTo(e+l,o+h);break;case"dash":t.moveTo(e,o),t.lineTo(e+Math.cos(ee)*(r?r/2:X),o+Math.sin(ee)*X);break;case!1:t.closePath()}t.fill(),n.borderWidth>0&&t.stroke()}}function N0(t,n,e){return e=e||.5,!n||t&&t.x>n.left-e&&t.x<n.right+e&&t.y>n.top-e&&t.y<n.bottom+e}function eT(t,n){t.save(),t.beginPath(),t.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),t.clip()}function tT(t){t.restore()}function Mae(t,n,e,o,r){if(!n)return t.lineTo(e.x,e.y);if("middle"===r){const s=(n.x+e.x)/2;t.lineTo(s,n.y),t.lineTo(s,e.y)}else"after"===r!=!!o?t.lineTo(n.x,e.y):t.lineTo(e.x,n.y);t.lineTo(e.x,e.y)}function kae(t,n,e,o){if(!n)return t.lineTo(e.x,e.y);t.bezierCurveTo(o?n.cp1x:n.cp2x,o?n.cp1y:n.cp2y,o?e.cp2x:e.cp1x,o?e.cp2y:e.cp1y,e.x,e.y)}function Lg(t,n,e,o,r,s={}){const l=rr(n)?n:[n],h=s.strokeWidth>0&&""!==s.strokeColor;let f,y;for(t.save(),t.font=r.string,function Aae(t,n){n.translation&&t.translate(n.translation[0],n.translation[1]),Do(n.rotation)||t.rotate(n.rotation),n.color&&(t.fillStyle=n.color),n.textAlign&&(t.textAlign=n.textAlign),n.textBaseline&&(t.textBaseline=n.textBaseline)}(t,s),f=0;f<l.length;++f)y=l[f],s.backdrop&&Oae(t,s.backdrop),h&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),Do(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(y,e,o,s.maxWidth)),t.fillText(y,e,o,s.maxWidth),Pae(t,e,o,y,s),o+=r.lineHeight;t.restore()}function Pae(t,n,e,o,r){if(r.strikethrough||r.underline){const s=t.measureText(o),l=n-s.actualBoundingBoxLeft,h=n+s.actualBoundingBoxRight,y=e+s.actualBoundingBoxDescent,C=r.strikethrough?(e-s.actualBoundingBoxAscent+y)/2:y;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(l,C),t.lineTo(h,C),t.stroke()}}function Oae(t,n){const e=t.fillStyle;t.fillStyle=n.color,t.fillRect(n.left,n.top,n.width,n.height),t.fillStyle=e}function z0(t,n){const{x:e,y:o,w:r,h:s,radius:l}=n;t.arc(e+l.topLeft,o+l.topLeft,l.topLeft,-Vr,fr,!0),t.lineTo(e,o+s-l.bottomLeft),t.arc(e+l.bottomLeft,o+s-l.bottomLeft,l.bottomLeft,fr,Vr,!0),t.lineTo(e+r-l.bottomRight,o+s),t.arc(e+r-l.bottomRight,o+s-l.bottomRight,l.bottomRight,Vr,0,!0),t.lineTo(e+r,o+l.topRight),t.arc(e+r-l.topRight,o+l.topRight,l.topRight,0,-Vr,!0),t.lineTo(e+l.topLeft,o)}const Lae=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Rae=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Fae(t,n){const e=(""+t).match(Lae);if(!e||"normal"===e[1])return 1.2*n;switch(t=+e[2],e[3]){case"px":return t;case"%":t/=100}return n*t}const Nae=t=>+t||0;function RD(t,n){const e={},o=mo(n),r=o?Object.keys(n):n,s=mo(t)?o?l=>Bi(t[l],t[n[l]]):l=>t[l]:()=>t;for(const l of r)e[l]=Nae(s(l));return e}function iz(t){return RD(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Rg(t){return RD(t,["topLeft","topRight","bottomLeft","bottomRight"])}function va(t){const n=iz(t);return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function Is(t,n){let e=Bi((t=t||{}).size,(n=n||os.font).size);"string"==typeof e&&(e=parseInt(e,10));let o=Bi(t.style,n.style);o&&!(""+o).match(Rae)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const r={family:Bi(t.family,n.family),lineHeight:Fae(Bi(t.lineHeight,n.lineHeight),e),size:e,style:o,weight:Bi(t.weight,n.weight),string:""};return r.string=function Iae(t){return!t||Do(t.size)||Do(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(r),r}function B0(t,n,e,o){let s,l,h,r=!0;for(s=0,l=t.length;s<l;++s)if(h=t[s],void 0!==h&&(void 0!==n&&"function"==typeof h&&(h=h(n),r=!1),void 0!==e&&rr(h)&&(h=h[e%h.length],r=!1),void 0!==h))return o&&!r&&(o.cacheable=!1),h}function Hf(t,n){return Object.assign(Object.create(t),n)}function FD(t,n=[""],e=t,o,r=(()=>t[0])){Mc(o)||(o=lz("_fallback",t));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:e,_fallback:o,_getTarget:r,override:l=>FD([l,...t],n,e,o)};return new Proxy(s,{deleteProperty:(l,h)=>(delete l[h],delete l._keys,delete t[0][h],!0),get:(l,h)=>rz(l,h,()=>function Wae(t,n,e,o){let r;for(const s of n)if(r=lz(Bae(s,t),e),Mc(r))return ND(t,r)?zD(e,o,t,r):r}(h,n,t,l)),getOwnPropertyDescriptor:(l,h)=>Reflect.getOwnPropertyDescriptor(l._scopes[0],h),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(l,h)=>cz(l).includes(h),ownKeys:l=>cz(l),set(l,h,f){const y=l._storage||(l._storage=r());return l[h]=y[h]=f,delete l._keys,!0}})}function Vy(t,n,e,o){const r={_cacheable:!1,_proxy:t,_context:n,_subProxy:e,_stack:new Set,_descriptors:oz(t,o),setContext:s=>Vy(t,s,e,o),override:s=>Vy(t.override(s),n,e,o)};return new Proxy(r,{deleteProperty:(s,l)=>(delete s[l],delete t[l],!0),get:(s,l,h)=>rz(s,l,()=>function Vae(t,n,e){const{_proxy:o,_context:r,_subProxy:s,_descriptors:l}=t;let h=o[n];return Uf(h)&&l.isScriptable(n)&&(h=function Uae(t,n,e,o){const{_proxy:r,_context:s,_subProxy:l,_stack:h}=e;if(h.has(t))throw new Error("Recursion detected: "+Array.from(h).join("->")+"->"+t);return h.add(t),n=n(s,l||o),h.delete(t),ND(t,n)&&(n=zD(r._scopes,r,t,n)),n}(n,h,t,e)),rr(h)&&h.length&&(h=function jae(t,n,e,o){const{_proxy:r,_context:s,_subProxy:l,_descriptors:h}=e;if(Mc(s.index)&&o(t))n=n[s.index%n.length];else if(mo(n[0])){const f=n,y=r._scopes.filter(C=>C!==f);n=[];for(const C of f){const D=zD(y,r,t,C);n.push(Vy(D,s,l&&l[t],h))}}return n}(n,h,t,l.isIndexable)),ND(n,h)&&(h=Vy(h,r,s&&s[n],l)),h}(s,l,h)),getOwnPropertyDescriptor:(s,l)=>s._descriptors.allKeys?Reflect.has(t,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,l),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(s,l)=>Reflect.has(t,l),ownKeys:()=>Reflect.ownKeys(t),set:(s,l,h)=>(t[l]=h,delete s[l],!0)})}function oz(t,n={scriptable:!0,indexable:!0}){const{_scriptable:e=n.scriptable,_indexable:o=n.indexable,_allKeys:r=n.allKeys}=t;return{allKeys:r,scriptable:e,indexable:o,isScriptable:Uf(e)?e:()=>e,isIndexable:Uf(o)?o:()=>o}}const Bae=(t,n)=>t?t+ED(n):n,ND=(t,n)=>mo(n)&&"adapters"!==t&&(null===Object.getPrototypeOf(n)||n.constructor===Object);function rz(t,n,e){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];const o=e();return t[n]=o,o}function sz(t,n,e){return Uf(t)?t(n,e):t}const Hae=(t,n)=>!0===t?n:"string"==typeof t?Vf(n,t):void 0;function $ae(t,n,e,o,r){for(const s of n){const l=Hae(e,s);if(l){t.add(l);const h=sz(l._fallback,e,r);if(Mc(h)&&h!==e&&h!==o)return h}else if(!1===l&&Mc(o)&&e!==o)return null}return!1}function zD(t,n,e,o){const r=n._rootScopes,s=sz(n._fallback,e,o),l=[...t,...r],h=new Set;h.add(o);let f=az(h,l,e,s||e,o);return!(null===f||Mc(s)&&s!==e&&(f=az(h,l,s,f,o),null===f))&&FD(Array.from(h),[""],r,s,()=>function Gae(t,n,e){const o=t._getTarget();n in o||(o[n]={});const r=o[n];return rr(r)&&mo(e)?e:r||{}}(n,e,o))}function az(t,n,e,o,r){for(;e;)e=$ae(t,n,e,o,r);return e}function lz(t,n){for(const e of n){if(!e)continue;const o=e[t];if(Mc(o))return o}}function cz(t){let n=t._keys;return n||(n=t._keys=function qae(t){const n=new Set;for(const e of t)for(const o of Object.keys(e).filter(r=>!r.startsWith("_")))n.add(o);return Array.from(n)}(t._scopes)),n}function uz(t,n,e,o){const{iScale:r}=t,{key:s="r"}=this._parsing,l=new Array(o);let h,f,y,C;for(h=0,f=o;h<f;++h)y=h+e,C=n[y],l[h]={r:r.parse(Vf(C,s),y)};return l}const Zae=Number.EPSILON||1e-14,Uy=(t,n)=>n<t.length&&!t[n].skip&&t[n],dz=t=>"x"===t?"y":"x";function Kae(t,n,e,o){const r=t.skip?n:t,s=n,l=e.skip?n:e,h=DD(s,r),f=DD(l,s);let y=h/(h+f),C=f/(h+f);y=isNaN(y)?0:y,C=isNaN(C)?0:C;const D=o*y,R=o*C;return{previous:{x:s.x-D*(l.x-r.x),y:s.y-D*(l.y-r.y)},next:{x:s.x+R*(l.x-r.x),y:s.y+R*(l.y-r.y)}}}function nT(t,n,e){return Math.max(Math.min(t,e),n)}function ele(t,n,e,o,r){let s,l,h,f;if(n.spanGaps&&(t=t.filter(y=>!y.skip)),"monotone"===n.cubicInterpolationMode)!function Qae(t,n="x"){const e=dz(n),o=t.length,r=Array(o).fill(0),s=Array(o);let l,h,f,y=Uy(t,0);for(l=0;l<o;++l)if(h=f,f=y,y=Uy(t,l+1),f){if(y){const C=y[n]-f[n];r[l]=0!==C?(y[e]-f[e])/C:0}s[l]=h?y?Vd(r[l-1])!==Vd(r[l])?0:(r[l-1]+r[l])/2:r[l-1]:r[l]}(function Xae(t,n,e){const o=t.length;let r,s,l,h,f,y=Uy(t,0);for(let C=0;C<o-1;++C)if(f=y,y=Uy(t,C+1),f&&y){if(P0(n[C],0,Zae)){e[C]=e[C+1]=0;continue}r=e[C]/n[C],s=e[C+1]/n[C],h=Math.pow(r,2)+Math.pow(s,2),!(h<=9)&&(l=3/Math.sqrt(h),e[C]=r*l*n[C],e[C+1]=s*l*n[C])}})(t,r,s),function Yae(t,n,e="x"){const o=dz(e),r=t.length;let s,l,h,f=Uy(t,0);for(let y=0;y<r;++y){if(l=h,h=f,f=Uy(t,y+1),!h)continue;const C=h[e],D=h[o];l&&(s=(C-l[e])/3,h[`cp1${e}`]=C-s,h[`cp1${o}`]=D-s*n[y]),f&&(s=(f[e]-C)/3,h[`cp2${e}`]=C+s,h[`cp2${o}`]=D+s*n[y])}}(t,s,n)}(t,r);else{let y=o?t[t.length-1]:t[0];for(s=0,l=t.length;s<l;++s)h=t[s],f=Kae(y,h,t[Math.min(s+1,l-(o?0:1))%l],n.tension),h.cp1x=f.previous.x,h.cp1y=f.previous.y,h.cp2x=f.next.x,h.cp2y=f.next.y,y=h}n.capBezierPoints&&function Jae(t,n){let e,o,r,s,l,h=N0(t[0],n);for(e=0,o=t.length;e<o;++e)l=s,s=h,h=e<o-1&&N0(t[e+1],n),s&&(r=t[e],l&&(r.cp1x=nT(r.cp1x,n.left,n.right),r.cp1y=nT(r.cp1y,n.top,n.bottom)),h&&(r.cp2x=nT(r.cp2x,n.left,n.right),r.cp2y=nT(r.cp2y,n.top,n.bottom)))}(t,e)}function hz(){return typeof window<"u"&&typeof document<"u"}function BD(t){let n=t.parentNode;return n&&"[object ShadowRoot]"===n.toString()&&(n=n.host),n}function iT(t,n,e){let o;return"string"==typeof t?(o=parseInt(t,10),-1!==t.indexOf("%")&&(o=o/100*n.parentNode[e])):o=t,o}const oT=t=>t.ownerDocument.defaultView.getComputedStyle(t,null),nle=["top","right","bottom","left"];function Fg(t,n,e){const o={};e=e?"-"+e:"";for(let r=0;r<4;r++){const s=nle[r];o[s]=parseFloat(t[n+"-"+s+e])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const ile=(t,n,e)=>(t>0||n>0)&&(!e||!e.shadowRoot);function Ng(t,n){if("native"in t)return t;const{canvas:e,currentDevicePixelRatio:o}=n,r=oT(e),s="border-box"===r.boxSizing,l=Fg(r,"padding"),h=Fg(r,"border","width"),{x:f,y,box:C}=function ole(t,n){const e=t.touches,o=e&&e.length?e[0]:t,{offsetX:r,offsetY:s}=o;let h,f,l=!1;if(ile(r,s,t.target))h=r,f=s;else{const y=n.getBoundingClientRect();h=o.clientX-y.left,f=o.clientY-y.top,l=!0}return{x:h,y:f,box:l}}(t,e),D=l.left+(C&&h.left),R=l.top+(C&&h.top);let{width:V,height:$}=n;return s&&(V-=l.width+h.width,$-=l.height+h.height),{x:Math.round((f-D)/V*e.width/o),y:Math.round((y-R)/$*e.height/o)}}const rT=t=>Math.round(10*t)/10;function pz(t,n,e){const o=n||1,r=Math.floor(t.height*o),s=Math.floor(t.width*o);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const l=t.canvas;return l.style&&(e||!l.style.height&&!l.style.width)&&(l.style.height=`${t.height}px`,l.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==o||l.height!==r||l.width!==s)&&(t.currentDevicePixelRatio=o,l.height=r,l.width=s,t.ctx.setTransform(o,0,0,o,0,0),!0)}const ale=function(){let t=!1;try{const n={get passive(){return t=!0,!1}};window.addEventListener("test",null,n),window.removeEventListener("test",null,n)}catch{}return t}();function fz(t,n){const e=function tle(t,n){return oT(t).getPropertyValue(n)}(t,n),o=e&&e.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}function zg(t,n,e,o){return{x:t.x+e*(n.x-t.x),y:t.y+e*(n.y-t.y)}}function lle(t,n,e,o){return{x:t.x+e*(n.x-t.x),y:"middle"===o?e<.5?t.y:n.y:"after"===o?e<1?t.y:n.y:e>0?n.y:t.y}}function cle(t,n,e,o){const r={x:t.cp2x,y:t.cp2y},s={x:n.cp1x,y:n.cp1y},l=zg(t,r,e),h=zg(r,s,e),f=zg(s,n,e),y=zg(l,h,e),C=zg(h,f,e);return zg(y,C,e)}const ule=function(t,n){return{x:e=>t+t+n-e,setWidth(e){n=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,o)=>e-o,leftForLtr:(e,o)=>e-o}},dle=function(){return{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,n)=>t+n,leftForLtr:(t,n)=>t}};function jy(t,n,e){return t?ule(n,e):dle()}function mz(t,n){let e,o;("ltr"===n||"rtl"===n)&&(e=t.canvas.style,o=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",n,"important"),t.prevTextDirection=o)}function gz(t,n){void 0!==n&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",n[0],n[1]))}function _z(t){return"angle"===t?{between:O0,compare:hae,normalize:$l}:{between:rp,compare:(n,e)=>n-e,normalize:n=>n}}function yz({start:t,end:n,count:e,loop:o,style:r}){return{start:t%e,end:n%e,loop:o&&(n-t+1)%e==0,style:r}}function vz(t,n,e){if(!e)return[t];const{property:o,start:r,end:s}=e,l=n.length,{compare:h,between:f,normalize:y}=_z(o),{start:C,end:D,loop:R,style:V}=function hle(t,n,e){const{property:o,start:r,end:s}=e,{between:l,normalize:h}=_z(o),f=n.length;let R,V,{start:y,end:C,loop:D}=t;if(D){for(y+=f,C+=f,R=0,V=f;R<V&&l(h(n[y%f][o]),r,s);++R)y--,C--;y%=f,C%=f}return C<y&&(C+=f),{start:y,end:C,loop:D,style:t.style}}(t,n,e),$=[];let ue,fe,_e,X=!1,ee=null;for(let kt=C,Kt=C;kt<=D;++kt)fe=n[kt%l],!fe.skip&&(ue=y(fe[o]),ue!==_e&&(X=f(ue,r,s),null===ee&&(X||f(r,_e,ue)&&0!==h(r,_e))&&(ee=0===h(ue,r)?kt:Kt),null!==ee&&(!X||0===h(s,ue)||f(s,_e,ue))&&($.push(yz({start:ee,end:kt,loop:R,count:l,style:V})),ee=null),Kt=kt,_e=ue));return null!==ee&&$.push(yz({start:ee,end:D,loop:R,count:l,style:V})),$}function bz(t,n){const e=[],o=t.segments;for(let r=0;r<o.length;r++){const s=vz(o[r],t.points,n);s.length&&e.push(...s)}return e}function wz(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function _le(t,n){return n&&JSON.stringify(t)!==JSON.stringify(n)}class yle{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(n,e,o,r){const l=e.duration;e.listeners[r].forEach(h=>h({chart:n,initial:e.initial,numSteps:l,currentStep:Math.min(o-e.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=GN.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(n=Date.now()){let e=0;this._charts.forEach((o,r)=>{if(!o.running||!o.items.length)return;const s=o.items;let f,l=s.length-1,h=!1;for(;l>=0;--l)f=s[l],f._active?(f._total>o.duration&&(o.duration=f._total),f.tick(n),h=!0):(s[l]=s[s.length-1],s.pop());h&&(r.draw(),this._notify(r,o,n,"progress")),s.length||(o.running=!1,this._notify(r,o,n,"complete"),o.initial=!1),e+=s.length}),this._lastDate=n,0===e&&(this._running=!1)}_getAnims(n){const e=this._charts;let o=e.get(n);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(n,o)),o}listen(n,e,o){this._getAnims(n).listeners[e].push(o)}add(n,e){!e||!e.length||this._getAnims(n).items.push(...e)}has(n){return this._getAnims(n).items.length>0}start(n){const e=this._charts.get(n);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((o,r)=>Math.max(o,r._duration),0),this._refresh())}running(n){if(!this._running)return!1;const e=this._charts.get(n);return!(!e||!e.running||!e.items.length)}stop(n){const e=this._charts.get(n);if(!e||!e.items.length)return;const o=e.items;let r=o.length-1;for(;r>=0;--r)o[r].cancel();e.items=[],this._notify(n,e,Date.now(),"complete")}remove(n){return this._charts.delete(n)}}var ap=new yle;const Cz="transparent",vle={boolean:(t,n,e)=>e>.5?n:t,color(t,n,e){const o=QN(t||Cz),r=o.valid&&QN(n||Cz);return r&&r.valid?r.mix(o,e).hexString():n},number:(t,n,e)=>t+(n-t)*e};class ble{constructor(n,e,o,r){const s=e[o];r=B0([n.to,r,s,n.from]);const l=B0([n.from,s,r]);this._active=!0,this._fn=n.fn||vle[n.type||typeof l],this._easing=L0[n.easing]||L0.linear,this._start=Math.floor(Date.now()+(n.delay||0)),this._duration=this._total=Math.floor(n.duration),this._loop=!!n.loop,this._target=e,this._prop=o,this._from=l,this._to=r,this._promises=void 0}active(){return this._active}update(n,e,o){if(this._active){this._notify(!1);const r=this._target[this._prop],s=o-this._start,l=this._duration-s;this._start=o,this._duration=Math.floor(Math.max(l,n.duration)),this._total+=s,this._loop=!!n.loop,this._to=B0([n.to,e,r,n.from]),this._from=B0([n.from,r,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(n){const e=n-this._start,o=this._duration,r=this._prop,s=this._from,l=this._loop,h=this._to;let f;if(this._active=s!==h&&(l||e<o),!this._active)return this._target[r]=h,void this._notify(!0);e<0?this._target[r]=s:(f=e/o%2,f=l&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[r]=this._fn(s,h,f))}wait(){const n=this._promises||(this._promises=[]);return new Promise((e,o)=>{n.push({res:e,rej:o})})}_notify(n){const e=n?"res":"rej",o=this._promises||[];for(let r=0;r<o.length;r++)o[r][e]()}}class Tz{constructor(n,e){this._chart=n,this._properties=new Map,this.configure(e)}configure(n){if(!mo(n))return;const e=Object.keys(os.animation),o=this._properties;Object.getOwnPropertyNames(n).forEach(r=>{const s=n[r];if(!mo(s))return;const l={};for(const h of e)l[h]=s[h];(rr(s.properties)&&s.properties||[r]).forEach(h=>{(h===r||!o.has(h))&&o.set(h,l)})})}_animateOptions(n,e){const o=e.options,r=function wle(t,n){if(!n)return;let e=t.options;if(e)return e.$shared&&(t.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e;t.options=n}(n,o);if(!r)return[];const s=this._createAnimations(r,o);return o.$shared&&function xle(t,n){const e=[],o=Object.keys(n);for(let r=0;r<o.length;r++){const s=t[o[r]];s&&s.active()&&e.push(s.wait())}return Promise.all(e)}(n.options.$animations,o).then(()=>{n.options=o},()=>{}),s}_createAnimations(n,e){const o=this._properties,r=[],s=n.$animations||(n.$animations={}),l=Object.keys(e),h=Date.now();let f;for(f=l.length-1;f>=0;--f){const y=l[f];if("$"===y.charAt(0))continue;if("options"===y){r.push(...this._animateOptions(n,e));continue}const C=e[y];let D=s[y];const R=o.get(y);if(D){if(R&&D.active()){D.update(R,C,h);continue}D.cancel()}R&&R.duration?(s[y]=D=new ble(R,n,y,C),r.push(D)):n[y]=C}return r}update(n,e){if(0===this._properties.size)return void Object.assign(n,e);const o=this._createAnimations(n,e);return o.length?(ap.add(this._chart,o),!0):void 0}}function Sz(t,n){const e=t&&t.options||{},o=e.reverse,r=void 0===e.min?n:0,s=void 0===e.max?n:0;return{start:o?s:r,end:o?r:s}}function Ez(t,n){const e=[],o=t._getSortedDatasetMetas(n);let r,s;for(r=0,s=o.length;r<s;++r)e.push(o[r].index);return e}function Iz(t,n,e,o={}){const r=t.keys,s="single"===o.mode;let l,h,f,y;if(null!==n){for(l=0,h=r.length;l<h;++l){if(f=+r[l],f===e){if(o.all)continue;break}y=t.values[f],Br(y)&&(s||0===n||Vd(n)===Vd(y))&&(n+=y)}return n}}function Dz(t,n){const e=t&&t.options.stacked;return e||void 0===e&&void 0!==n.stack}function Dle(t,n,e){const o=t[n]||(t[n]={});return o[e]||(o[e]={})}function Mz(t,n,e,o){for(const r of n.getMatchingVisibleMetas(o).reverse()){const s=t[r.index];if(e&&s>0||!e&&s<0)return r.index}return null}function kz(t,n){const{chart:e,_cachedMeta:o}=t,r=e._stacks||(e._stacks={}),{iScale:s,vScale:l,index:h}=o,f=s.axis,y=l.axis,C=function Ele(t,n,e){return`${t.id}.${n.id}.${e.stack||e.type}`}(s,l,o),D=n.length;let R;for(let V=0;V<D;++V){const $=n[V],{[f]:X,[y]:ee}=$;R=($._stacks||($._stacks={}))[y]=Dle(r,C,X),R[h]=ee,R._top=Mz(R,l,!0,o.type),R._bottom=Mz(R,l,!1,o.type),(R._visualValues||(R._visualValues={}))[h]=ee}}function VD(t,n){const e=t.scales;return Object.keys(e).filter(o=>e[o].axis===n).shift()}function V0(t,n){const e=t.controller.index,o=t.vScale&&t.vScale.axis;if(o){n=n||t._parsed;for(const r of n){const s=r._stacks;if(!s||void 0===s[o]||void 0===s[o][e])return;delete s[o][e],void 0!==s[o]._visualValues&&void 0!==s[o]._visualValues[e]&&delete s[o]._visualValues[e]}}}const UD=t=>"reset"===t||"none"===t,Az=(t,n)=>n?t:Object.assign({},t);let $f=(()=>{class t{constructor(e,o){this.chart=e,this._ctx=e.ctx,this.index=o,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Dz(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&V0(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,o=this._cachedMeta,r=this.getDataset(),s=(R,V,$,X)=>"x"===R?V:"r"===R?X:$,l=o.xAxisID=Bi(r.xAxisID,VD(e,"x")),h=o.yAxisID=Bi(r.yAxisID,VD(e,"y")),f=o.rAxisID=Bi(r.rAxisID,VD(e,"r")),y=o.indexAxis,C=o.iAxisID=s(y,l,h,f),D=o.vAxisID=s(y,h,l,f);o.xScale=this.getScaleForId(l),o.yScale=this.getScaleForId(h),o.rScale=this.getScaleForId(f),o.iScale=this.getScaleForId(C),o.vScale=this.getScaleForId(D)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const o=this._cachedMeta;return e===o.iScale?o.vScale:o.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&HN(this._data,this),e._stacked&&V0(e)}_dataCheck(){const e=this.getDataset(),o=e.data||(e.data=[]),r=this._data;if(mo(o))this._data=function Sle(t){const n=Object.keys(t),e=new Array(n.length);let o,r,s;for(o=0,r=n.length;o<r;++o)s=n[o],e[o]={x:s,y:t[s]};return e}(o);else if(r!==o){if(r){HN(r,this);const s=this._cachedMeta;V0(s),s._parsed=[]}o&&Object.isExtensible(o)&&function gae(t,n){t._chartjs?t._chartjs.listeners.push(n):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[n]}}),jN.forEach(e=>{const o="_onData"+ED(e),r=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...s){const l=r.apply(this,s);return t._chartjs.listeners.forEach(h=>{"function"==typeof h[o]&&h[o](...s)}),l}})}))}(o,this),this._syncList=[],this._data=o}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const o=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const l=o._stacked;o._stacked=Dz(o.vScale,o),o.stack!==r.stack&&(s=!0,V0(o),o.stack=r.stack),this._resyncElements(e),(s||l!==o._stacked)&&kz(this,o._parsed)}configure(){const e=this.chart.config,o=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),o,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,o){const{_cachedMeta:r,_data:s}=this,{iScale:l,_stacked:h}=r,f=l.axis;let D,R,V,y=0===e&&o===s.length||r._sorted,C=e>0&&r._parsed[e-1];if(!1===this._parsing)r._parsed=s,r._sorted=!0,V=s;else{V=rr(s[e])?this.parseArrayData(r,s,e,o):mo(s[e])?this.parseObjectData(r,s,e,o):this.parsePrimitiveData(r,s,e,o);const $=()=>null===R[f]||C&&R[f]<C[f];for(D=0;D<o;++D)r._parsed[D+e]=R=V[D],y&&($()&&(y=!1),C=R);r._sorted=y}h&&kz(this,V)}parsePrimitiveData(e,o,r,s){const{iScale:l,vScale:h}=e,f=l.axis,y=h.axis,C=l.getLabels(),D=l===h,R=new Array(s);let V,$,X;for(V=0,$=s;V<$;++V)X=V+r,R[V]={[f]:D||l.parse(C[X],X),[y]:h.parse(o[X],X)};return R}parseArrayData(e,o,r,s){const{xScale:l,yScale:h}=e,f=new Array(s);let y,C,D,R;for(y=0,C=s;y<C;++y)D=y+r,R=o[D],f[y]={x:l.parse(R[0],D),y:h.parse(R[1],D)};return f}parseObjectData(e,o,r,s){const{xScale:l,yScale:h}=e,{xAxisKey:f="x",yAxisKey:y="y"}=this._parsing,C=new Array(s);let D,R,V,$;for(D=0,R=s;D<R;++D)V=D+r,$=o[V],C[D]={x:l.parse(Vf($,f),V),y:h.parse(Vf($,y),V)};return C}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,o,r){const l=this._cachedMeta,h=o[e.axis];return Iz({keys:Ez(this.chart,!0),values:o._stacks[e.axis]._visualValues},h,l.index,{mode:r})}updateRangeFromParsed(e,o,r,s){const l=r[o.axis];let h=null===l?NaN:l;const f=s&&r._stacks[o.axis];s&&f&&(s.values=f,h=Iz(s,l,this._cachedMeta.index)),e.min=Math.min(e.min,h),e.max=Math.max(e.max,h)}getMinMax(e,o){const r=this._cachedMeta,s=r._parsed,l=r._sorted&&e===r.iScale,h=s.length,f=this._getOtherScale(e),y=((t,n,e)=>t&&!n.hidden&&n._stacked&&{keys:Ez(this.chart,!0),values:null})(o,r),C={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:D,max:R}=function Ile(t){const{min:n,max:e,minDefined:o,maxDefined:r}=t.getUserBounds();return{min:o?n:Number.NEGATIVE_INFINITY,max:r?e:Number.POSITIVE_INFINITY}}(f);let V,$;function X(){$=s[V];const ee=$[f.axis];return!Br($[e.axis])||D>ee||R<ee}for(V=0;V<h&&(X()||(this.updateRangeFromParsed(C,e,$,y),!l));++V);if(l)for(V=h-1;V>=0;--V)if(!X()){this.updateRangeFromParsed(C,e,$,y);break}return C}getAllParsedValues(e){const o=this._cachedMeta._parsed,r=[];let s,l,h;for(s=0,l=o.length;s<l;++s)h=o[s][e.axis],Br(h)&&r.push(h);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const o=this._cachedMeta,r=o.iScale,s=o.vScale,l=this.getParsed(e);return{label:r?""+r.getLabelForValue(l[r.axis]):"",value:s?""+s.getLabelForValue(l[s.axis]):""}}_update(e){const o=this._cachedMeta;this.update(e||"default"),o._clip=function Tle(t){let n,e,o,r;return mo(t)?(n=t.top,e=t.right,o=t.bottom,r=t.left):n=e=o=r=t,{top:n,right:e,bottom:o,left:r,disabled:!1===t}}(Bi(this.options.clip,function Cle(t,n,e){if(!1===e)return!1;const o=Sz(t,e),r=Sz(n,e);return{top:r.end,right:o.end,bottom:r.start,left:o.start}}(o.xScale,o.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,r=this._cachedMeta,s=r.data||[],l=this.chart.chartArea,h=[],f=this._drawStart||0,y=this._drawCount||s.length-f,C=this.options.drawActiveElementsOnTop;let D;for(r.dataset&&r.dataset.draw(e,l,f,y),D=f;D<f+y;++D){const R=s[D];R.hidden||(R.active&&C?h.push(R):R.draw(e,l))}for(D=0;D<h.length;++D)h[D].draw(e,l)}getStyle(e,o){const r=o?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,o,r){const s=this.getDataset();let l;if(e>=0&&e<this._cachedMeta.data.length){const h=this._cachedMeta.data[e];l=h.$context||(h.$context=function kle(t,n,e){return Hf(t,{active:!1,dataIndex:n,parsed:void 0,raw:void 0,element:e,index:n,mode:"default",type:"data"})}(this.getContext(),e,h)),l.parsed=this.getParsed(e),l.raw=s.data[e],l.index=l.dataIndex=e}else l=this.$context||(this.$context=function Mle(t,n){return Hf(t,{active:!1,dataset:void 0,datasetIndex:n,index:n,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),l.dataset=s,l.index=l.datasetIndex=this.index;return l.active=!!o,l.mode=r,l}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,o){return this._resolveElementOptions(this.dataElementType.id,o,e)}_resolveElementOptions(e,o="default",r){const s="active"===o,l=this._cachedDataOpts,h=e+"-"+o,f=l[h],y=this.enableOptionSharing&&Mc(r);if(f)return Az(f,y);const C=this.chart.config,D=C.datasetElementScopeKeys(this._type,e),R=s?[`${e}Hover`,"hover",e,""]:[e,""],V=C.getOptionScopes(this.getDataset(),D),$=Object.keys(os.elements[e]),ee=C.resolveNamedOptions(V,$,()=>this.getContext(r,s,o),R);return ee.$shared&&(ee.$shared=y,l[h]=Object.freeze(Az(ee,y))),ee}_resolveAnimations(e,o,r){const s=this.chart,l=this._cachedDataOpts,h=`animation-${o}`,f=l[h];if(f)return f;let y;if(!1!==s.options.animation){const D=this.chart.config,R=D.datasetAnimationScopeKeys(this._type,o),V=D.getOptionScopes(this.getDataset(),R);y=D.createResolver(V,this.getContext(e,r,o))}const C=new Tz(s,y&&y.animations);return y&&y._cacheable&&(l[h]=Object.freeze(C)),C}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,o){return!o||UD(e)||this.chart._animationsDisabled}_getSharedOptions(e,o){const r=this.resolveDataElementOptions(e,o),s=this._sharedOptions,l=this.getSharedOptions(r),h=this.includeOptions(o,l)||l!==s;return this.updateSharedOptions(l,o,r),{sharedOptions:l,includeOptions:h}}updateElement(e,o,r,s){UD(s)?Object.assign(e,r):this._resolveAnimations(o,s).update(e,r)}updateSharedOptions(e,o,r){e&&!UD(o)&&this._resolveAnimations(void 0,o).update(e,r)}_setStyle(e,o,r,s){e.active=s;const l=this.getStyle(o,s);this._resolveAnimations(o,r,s).update(e,{options:!s&&this.getSharedOptions(l)||l})}removeHoverStyle(e,o,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,o,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const o=this._data,r=this._cachedMeta.data;for(const[f,y,C]of this._syncList)this[f](y,C);this._syncList=[];const s=r.length,l=o.length,h=Math.min(l,s);h&&this.parse(0,h),l>s?this._insertElements(s,l-s,e):l<s&&this._removeElements(l,s-l)}_insertElements(e,o,r=!0){const s=this._cachedMeta,l=s.data,h=e+o;let f;const y=C=>{for(C.length+=o,f=C.length-1;f>=h;f--)C[f]=C[f-o]};for(y(l),f=e;f<h;++f)l[f]=new this.dataElementType;this._parsing&&y(s._parsed),this.parse(e,o),r&&this.updateElements(l,e,o,"reset")}updateElements(e,o,r,s){}_removeElements(e,o){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,o);r._stacked&&V0(r,s)}r.data.splice(e,o)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[o,r,s]=e;this[o](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,o){o&&this._sync(["_removeElements",e,o]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return Nn(t,"defaults",{}),Nn(t,"datasetElementType",null),Nn(t,"dataElementType",null),t})();function Ole(t){const n=t.iScale,e=function Ple(t,n){if(!t._cache.$bar){const e=t.getMatchingVisibleMetas(n);let o=[];for(let r=0,s=e.length;r<s;r++)o=o.concat(e[r].controller.getAllParsedValues(t));t._cache.$bar=$N(o.sort((r,s)=>r-s))}return t._cache.$bar}(n,t.type);let r,s,l,h,o=n._length;const f=()=>{32767===l||-32768===l||(Mc(h)&&(o=Math.min(o,Math.abs(l-h)||o)),h=l)};for(r=0,s=e.length;r<s;++r)l=n.getPixelForValue(e[r]),f();for(h=void 0,r=0,s=n.ticks.length;r<s;++r)l=n.getPixelForTick(r),f();return o}function Pz(t,n,e,o){return rr(t)?function Fle(t,n,e,o){const r=e.parse(t[0],o),s=e.parse(t[1],o),l=Math.min(r,s),h=Math.max(r,s);let f=l,y=h;Math.abs(l)>Math.abs(h)&&(f=h,y=l),n[e.axis]=y,n._custom={barStart:f,barEnd:y,start:r,end:s,min:l,max:h}}(t,n,e,o):n[e.axis]=e.parse(t,o),n}function Oz(t,n,e,o){const r=t.iScale,s=t.vScale,l=r.getLabels(),h=r===s,f=[];let y,C,D,R;for(y=e,C=e+o;y<C;++y)R=n[y],D={},D[r.axis]=h||r.parse(l[y],y),f.push(Pz(R,D,s,y));return f}function jD(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function Ble(t,n,e,o){let r=n.borderSkipped;const s={};if(!r)return void(t.borderSkipped=s);if(!0===r)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:l,end:h,reverse:f,top:y,bottom:C}=function zle(t){let n,e,o,r,s;return t.horizontal?(n=t.base>t.x,e="left",o="right"):(n=t.base<t.y,e="bottom",o="top"),n?(r="end",s="start"):(r="start",s="end"),{start:e,end:o,reverse:n,top:r,bottom:s}}(t);"middle"===r&&e&&(t.enableBorderRadius=!0,(e._top||0)===o?r=y:(e._bottom||0)===o?r=C:(s[Lz(C,l,h,f)]=!0,r=y)),s[Lz(r,l,h,f)]=!0,t.borderSkipped=s}function Lz(t,n,e,o){return o?(t=function Vle(t,n,e){return t===n?e:t===e?n:t}(t,n,e),t=Rz(t,e,n)):t=Rz(t,n,e),t}function Rz(t,n,e){return"start"===t?n:"end"===t?e:t}function Ule(t,{inflateAmount:n},e){t.inflateAmount="auto"===n?1===e?.33:0:n}let jle=(()=>{class t extends $f{parsePrimitiveData(e,o,r,s){return Oz(e,o,r,s)}parseArrayData(e,o,r,s){return Oz(e,o,r,s)}parseObjectData(e,o,r,s){const{iScale:l,vScale:h}=e,{xAxisKey:f="x",yAxisKey:y="y"}=this._parsing,C="x"===l.axis?f:y,D="x"===h.axis?f:y,R=[];let V,$,X,ee;for(V=r,$=r+s;V<$;++V)ee=o[V],X={},X[l.axis]=l.parse(Vf(ee,C),V),R.push(Pz(Vf(ee,D),X,h,V));return R}updateRangeFromParsed(e,o,r,s){super.updateRangeFromParsed(e,o,r,s);const l=r._custom;l&&o===this._cachedMeta.vScale&&(e.min=Math.min(e.min,l.min),e.max=Math.max(e.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const o=this._cachedMeta,{iScale:r,vScale:s}=o,l=this.getParsed(e),h=l._custom,f=jD(h)?"["+h.start+", "+h.end+"]":""+s.getLabelForValue(l[s.axis]);return{label:""+r.getLabelForValue(l[r.axis]),value:f}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(e){const o=this._cachedMeta;this.updateElements(o.data,0,o.data.length,e)}updateElements(e,o,r,s){const l="reset"===s,{index:h,_cachedMeta:{vScale:f}}=this,y=f.getBasePixel(),C=f.isHorizontal(),D=this._getRuler(),{sharedOptions:R,includeOptions:V}=this._getSharedOptions(o,s);for(let $=o;$<o+r;$++){const X=this.getParsed($),ee=l||Do(X[f.axis])?{base:y,head:y}:this._calculateBarValuePixels($),ue=this._calculateBarIndexPixels($,D),fe=(X._stacks||{})[f.axis],_e={horizontal:C,base:ee.base,enableBorderRadius:!fe||jD(X._custom)||h===fe._top||h===fe._bottom,x:C?ee.head:ue.center,y:C?ue.center:ee.head,height:C?ue.size:Math.abs(ee.size),width:C?Math.abs(ee.size):ue.size};V&&(_e.options=R||this.resolveDataElementOptions($,e[$].active?"active":s));const Be=_e.options||e[$].options;Ble(_e,Be,fe,h),Ule(_e,Be,D.ratio),this.updateElement(e[$],$,_e,s)}}_getStacks(e,o){const{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(y=>y.controller.options.grouped),l=r.options.stacked,h=[],f=y=>{const C=y.controller.getParsed(o),D=C&&C[y.vScale.axis];if(Do(D)||isNaN(D))return!0};for(const y of s)if((void 0===o||!f(y))&&((!1===l||-1===h.indexOf(y.stack)||void 0===l&&void 0===y.stack)&&h.push(y.stack),y.index===e))break;return h.length||h.push(void 0),h}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,o,r){const s=this._getStacks(e,r),l=void 0!==o?s.indexOf(o):-1;return-1===l?s.length-1:l}_getRuler(){const e=this.options,o=this._cachedMeta,r=o.iScale,s=[];let l,h;for(l=0,h=o.data.length;l<h;++l)s.push(r.getPixelForValue(this.getParsed(l)[r.axis],l));const f=e.barThickness;return{min:f||Ole(o),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:f?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:o,_stacked:r,index:s},options:{base:l,minBarLength:h}}=this,f=l||0,y=this.getParsed(e),C=y._custom,D=jD(C);let X,ee,R=y[o.axis],V=0,$=r?this.applyStack(o,y,r):R;$!==R&&(V=$-R,$=R),D&&(R=C.barStart,$=C.barEnd-C.barStart,0!==R&&Vd(R)!==Vd(C.barEnd)&&(V=0),V+=R);const ue=Do(l)||D?V:l;let fe=o.getPixelForValue(ue);if(X=this.chart.getDataVisibility(e)?o.getPixelForValue(V+$):fe,ee=X-fe,Math.abs(ee)<h){ee=function Nle(t,n,e){return 0!==t?Vd(t):(n.isHorizontal()?1:-1)*(n.min>=e?1:-1)}(ee,o,f)*h,R===f&&(fe-=ee/2);const _e=o.getPixelForDecimal(0),Be=o.getPixelForDecimal(1),et=Math.min(_e,Be),gt=Math.max(_e,Be);fe=Math.max(Math.min(fe,gt),et),X=fe+ee,r&&!D&&(y._stacks[o.axis]._visualValues[s]=o.getValueForPixel(X)-o.getValueForPixel(fe))}if(fe===o.getPixelForValue(f)){const _e=Vd(ee)*o.getLineWidthForValue(f)/2;fe+=_e,ee-=_e}return{size:ee,base:fe,head:X,center:X+ee/2}}_calculateBarIndexPixels(e,o){const r=o.scale,s=this.options,l=s.skipNull,h=Bi(s.maxBarThickness,1/0);let f,y;if(o.grouped){const C=l?this._getStackCount(e):o.stackCount,D="flex"===s.barThickness?function Rle(t,n,e,o){const r=n.pixels,s=r[t];let l=t>0?r[t-1]:null,h=t<r.length-1?r[t+1]:null;const f=e.categoryPercentage;null===l&&(l=s-(null===h?n.end-n.start:h-s)),null===h&&(h=s+s-l);const y=s-(s-Math.min(l,h))/2*f;return{chunk:Math.abs(h-l)/2*f/o,ratio:e.barPercentage,start:y}}(e,o,s,C):function Lle(t,n,e,o){const r=e.barThickness;let s,l;return Do(r)?(s=n.min*e.categoryPercentage,l=e.barPercentage):(s=r*o,l=1),{chunk:s/o,ratio:l,start:n.pixels[t]-s/2}}(e,o,s,C),R=this._getStackIndex(this.index,this._cachedMeta.stack,l?e:void 0);f=D.start+D.chunk*R+D.chunk/2,y=Math.min(h,D.chunk*D.ratio)}else f=r.getPixelForValue(this.getParsed(e)[r.axis],e),y=Math.min(h,o.min*o.ratio);return{base:f-y/2,head:f+y/2,center:f,size:y}}draw(){const e=this._cachedMeta,o=e.vScale,r=e.data,s=r.length;let l=0;for(;l<s;++l)null!==this.getParsed(l)[o.axis]&&r[l].draw(this._ctx)}}return Nn(t,"id","bar"),Nn(t,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Nn(t,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}}),t})(),Hle=(()=>{class t extends $f{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,o,r,s){const l=super.parsePrimitiveData(e,o,r,s);for(let h=0;h<l.length;h++)l[h]._custom=this.resolveDataElementOptions(h+r).radius;return l}parseArrayData(e,o,r,s){const l=super.parseArrayData(e,o,r,s);for(let h=0;h<l.length;h++)l[h]._custom=Bi(o[r+h][2],this.resolveDataElementOptions(h+r).radius);return l}parseObjectData(e,o,r,s){const l=super.parseObjectData(e,o,r,s);for(let h=0;h<l.length;h++){const f=o[r+h];l[h]._custom=Bi(f&&f.r&&+f.r,this.resolveDataElementOptions(h+r).radius)}return l}getMaxOverflow(){const e=this._cachedMeta.data;let o=0;for(let r=e.length-1;r>=0;--r)o=Math.max(o,e[r].size(this.resolveDataElementOptions(r))/2);return o>0&&o}getLabelAndValue(e){const o=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:l}=o,h=this.getParsed(e),f=s.getLabelForValue(h.x),y=l.getLabelForValue(h.y),C=h._custom;return{label:r[e]||"",value:"("+f+", "+y+(C?", "+C:"")+")"}}update(e){const o=this._cachedMeta.data;this.updateElements(o,0,o.length,e)}updateElements(e,o,r,s){const l="reset"===s,{iScale:h,vScale:f}=this._cachedMeta,{sharedOptions:y,includeOptions:C}=this._getSharedOptions(o,s),D=h.axis,R=f.axis;for(let V=o;V<o+r;V++){const $=e[V],X=!l&&this.getParsed(V),ee={},ue=ee[D]=l?h.getPixelForDecimal(.5):h.getPixelForValue(X[D]),fe=ee[R]=l?f.getBasePixel():f.getPixelForValue(X[R]);ee.skip=isNaN(ue)||isNaN(fe),C&&(ee.options=y||this.resolveDataElementOptions(V,$.active?"active":s),l&&(ee.options.radius=0)),this.updateElement($,V,ee,s)}}resolveDataElementOptions(e,o){const r=this.getParsed(e);let s=super.resolveDataElementOptions(e,o);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const l=s.radius;return"active"!==o&&(s.radius=0),s.radius+=Bi(r&&r._custom,l),s}}return Nn(t,"id","bubble"),Nn(t,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Nn(t,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}}),t})(),HD=(()=>{class t extends $f{constructor(e,o){super(e,o),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,o){const r=this.getDataset().data,s=this._cachedMeta;if(!1===this._parsing)s._parsed=r;else{let h,f,l=y=>+r[y];if(mo(r[e])){const{key:y="value"}=this._parsing;l=C=>+Vf(r[C],y)}for(h=e,f=e+o;h<f;++h)s._parsed[h]=l(h)}}_getRotation(){return Au(this.options.rotation-90)}_getCircumference(){return Au(this.options.circumference)}_getRotationExtents(){let e=sr,o=-sr;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const s=this.chart.getDatasetMeta(r).controller,l=s._getRotation(),h=s._getCircumference();e=Math.min(e,l),o=Math.max(o,l+h)}return{rotation:e,circumference:o-e}}update(e){const o=this.chart,{chartArea:r}=o,s=this._cachedMeta,l=s.data,h=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,f=Math.max((Math.min(r.width,r.height)-h)/2,0),y=Math.min(((t,n)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:+t/n)(this.options.cutout,f),1),C=this._getRingWeight(this.index),{circumference:D,rotation:R}=this._getRotationExtents(),{ratioX:V,ratioY:$,offsetX:X,offsetY:ee}=function $le(t,n,e){let o=1,r=1,s=0,l=0;if(n<sr){const h=t,f=h+n,y=Math.cos(h),C=Math.sin(h),D=Math.cos(f),R=Math.sin(f),V=(_e,Be,et)=>O0(_e,h,f,!0)?1:Math.max(Be,Be*e,et,et*e),$=(_e,Be,et)=>O0(_e,h,f,!0)?-1:Math.min(Be,Be*e,et,et*e),X=V(0,y,D),ee=V(Vr,C,R),ue=$(fr,y,D),fe=$(fr+Vr,C,R);o=(X-ue)/2,r=(ee-fe)/2,s=-(X+ue)/2,l=-(ee+fe)/2}return{ratioX:o,ratioY:r,offsetX:s,offsetY:l}}(R,D,y),_e=Math.max(Math.min((r.width-h)/V,(r.height-h)/$)/2,0),Be=ON(this.options.radius,_e),gt=(Be-Math.max(Be*y,0))/this._getVisibleDatasetWeightTotal();this.offsetX=X*Be,this.offsetY=ee*Be,s.total=this.calculateTotal(),this.outerRadius=Be-gt*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-gt*C,0),this.updateElements(l,0,l.length,e)}_circumference(e,o){const r=this.options,s=this._cachedMeta,l=this._getCircumference();return o&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||null===s._parsed[e]||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*l/sr)}updateElements(e,o,r,s){const l="reset"===s,h=this.chart,f=h.chartArea,D=(f.left+f.right)/2,R=(f.top+f.bottom)/2,V=l&&h.options.animation.animateScale,$=V?0:this.innerRadius,X=V?0:this.outerRadius,{sharedOptions:ee,includeOptions:ue}=this._getSharedOptions(o,s);let _e,fe=this._getRotation();for(_e=0;_e<o;++_e)fe+=this._circumference(_e,l);for(_e=o;_e<o+r;++_e){const Be=this._circumference(_e,l),et=e[_e],gt={x:D+this.offsetX,y:R+this.offsetY,startAngle:fe,endAngle:fe+Be,circumference:Be,outerRadius:X,innerRadius:$};ue&&(gt.options=ee||this.resolveDataElementOptions(_e,et.active?"active":s)),fe+=Be,this.updateElement(et,_e,gt,s)}}calculateTotal(){const e=this._cachedMeta,o=e.data;let s,r=0;for(s=0;s<o.length;s++){const l=e._parsed[s];null!==l&&!isNaN(l)&&this.chart.getDataVisibility(s)&&!o[s].hidden&&(r+=Math.abs(l))}return r}calculateCircumference(e){const o=this._cachedMeta.total;return o>0&&!isNaN(e)?sr*(Math.abs(e)/o):0}getLabelAndValue(e){const r=this.chart,s=r.data.labels||[],l=R0(this._cachedMeta._parsed[e],r.options.locale);return{label:s[e]||"",value:l}}getMaxBorderWidth(e){let o=0;const r=this.chart;let s,l,h,f,y;if(!e)for(s=0,l=r.data.datasets.length;s<l;++s)if(r.isDatasetVisible(s)){h=r.getDatasetMeta(s),e=h.data,f=h.controller;break}if(!e)return 0;for(s=0,l=e.length;s<l;++s)y=f.resolveDataElementOptions(s),"inner"!==y.borderAlign&&(o=Math.max(o,y.borderWidth||0,y.hoverBorderWidth||0));return o}getMaxOffset(e){let o=0;for(let r=0,s=e.length;r<s;++r){const l=this.resolveDataElementOptions(r);o=Math.max(o,l.offset||0,l.hoverOffset||0)}return o}_getRingWeightOffset(e){let o=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(o+=this._getRingWeight(r));return o}_getRingWeight(e){return Math.max(Bi(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return Nn(t,"id","doughnut"),Nn(t,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Nn(t,"descriptors",{_scriptable:n=>"spacing"!==n,_indexable:n=>"spacing"!==n}),Nn(t,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const e=n.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:o,color:r}}=n.legend.options;return e.labels.map((s,l)=>{const f=n.getDatasetMeta(0).controller.getStyle(l);return{text:s,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:r,lineWidth:f.borderWidth,pointStyle:o,hidden:!n.getDataVisibility(l),index:l}})}return[]}},onClick(n,e,o){o.chart.toggleDataVisibility(e.index),o.chart.update()}}}}),t})(),Gle=(()=>{class t extends $f{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const o=this._cachedMeta,{dataset:r,data:s=[],_dataset:l}=o,h=this.chart._animationsDisabled;let{start:f,count:y}=qN(o,s,h);this._drawStart=f,this._drawCount=y,ZN(o)&&(f=0,y=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!l._decimated,r.points=s;const C=this.resolveDatasetElementOptions(e);this.options.showLine||(C.borderWidth=0),C.segment=this.options.segment,this.updateElement(r,void 0,{animated:!h,options:C},e),this.updateElements(s,f,y,e)}updateElements(e,o,r,s){const l="reset"===s,{iScale:h,vScale:f,_stacked:y,_dataset:C}=this._cachedMeta,{sharedOptions:D,includeOptions:R}=this._getSharedOptions(o,s),V=h.axis,$=f.axis,{spanGaps:X,segment:ee}=this.options,ue=By(X)?X:Number.POSITIVE_INFINITY,fe=this.chart._animationsDisabled||l||"none"===s,_e=o+r,Be=e.length;let et=o>0&&this.getParsed(o-1);for(let gt=0;gt<Be;++gt){const Ht=e[gt],kt=fe?Ht:{};if(gt<o||gt>=_e){kt.skip=!0;continue}const Kt=this.getParsed(gt),Ln=Do(Kt[$]),oi=kt[V]=h.getPixelForValue(Kt[V],gt),Ri=kt[$]=l||Ln?f.getBasePixel():f.getPixelForValue(y?this.applyStack(f,Kt,y):Kt[$],gt);kt.skip=isNaN(oi)||isNaN(Ri)||Ln,kt.stop=gt>0&&Math.abs(Kt[V]-et[V])>ue,ee&&(kt.parsed=Kt,kt.raw=C.data[gt]),R&&(kt.options=D||this.resolveDataElementOptions(gt,Ht.active?"active":s)),fe||this.updateElement(Ht,gt,kt,s),et=Kt}}getMaxOverflow(){const e=this._cachedMeta,o=e.dataset,r=o.options&&o.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const l=s[0].size(this.resolveDataElementOptions(0)),h=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,l,h)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}return Nn(t,"id","line"),Nn(t,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Nn(t,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}}),t})(),Fz=(()=>{class t extends $f{constructor(e,o){super(e,o),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const r=this.chart,s=r.data.labels||[],l=R0(this._cachedMeta._parsed[e].r,r.options.locale);return{label:s[e]||"",value:l}}parseObjectData(e,o,r,s){return uz.bind(this)(e,o,r,s)}update(e){const o=this._cachedMeta.data;this._updateRadius(),this.updateElements(o,0,o.length,e)}getMinMax(){const o={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return this._cachedMeta.data.forEach((r,s)=>{const l=this.getParsed(s).r;!isNaN(l)&&this.chart.getDataVisibility(s)&&(l<o.min&&(o.min=l),l>o.max&&(o.max=l))}),o}_updateRadius(){const e=this.chart,o=e.chartArea,r=e.options,s=Math.min(o.right-o.left,o.bottom-o.top),l=Math.max(s/2,0),f=(l-Math.max(r.cutoutPercentage?l/100*r.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=l-f*this.index,this.innerRadius=this.outerRadius-f}updateElements(e,o,r,s){const l="reset"===s,h=this.chart,y=h.options.animation,C=this._cachedMeta.rScale,D=C.xCenter,R=C.yCenter,V=C.getIndexAngle(0)-.5*fr;let X,$=V;const ee=360/this.countVisibleElements();for(X=0;X<o;++X)$+=this._computeAngle(X,s,ee);for(X=o;X<o+r;X++){const ue=e[X];let fe=$,_e=$+this._computeAngle(X,s,ee),Be=h.getDataVisibility(X)?C.getDistanceFromCenterForValue(this.getParsed(X).r):0;$=_e,l&&(y.animateScale&&(Be=0),y.animateRotate&&(fe=_e=V));const et={x:D,y:R,innerRadius:0,outerRadius:Be,startAngle:fe,endAngle:_e,options:this.resolveDataElementOptions(X,ue.active?"active":s)};this.updateElement(ue,X,et,s)}}countVisibleElements(){let o=0;return this._cachedMeta.data.forEach((r,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&o++}),o}_computeAngle(e,o,r){return this.chart.getDataVisibility(e)?Au(this.resolveDataElementOptions(e,o).angle||r):0}}return Nn(t,"id","polarArea"),Nn(t,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Nn(t,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const e=n.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:o,color:r}}=n.legend.options;return e.labels.map((s,l)=>{const f=n.getDatasetMeta(0).controller.getStyle(l);return{text:s,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:r,lineWidth:f.borderWidth,pointStyle:o,hidden:!n.getDataVisibility(l),index:l}})}return[]}},onClick(n,e,o){o.chart.toggleDataVisibility(e.index),o.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}}),t})();var Wle=Object.freeze({__proto__:null,BarController:jle,BubbleController:Hle,DoughnutController:HD,LineController:Gle,PolarAreaController:Fz,PieController:(()=>{class t extends HD{}return Nn(t,"id","pie"),Nn(t,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"}),t})(),RadarController:(()=>{class t extends $f{getLabelAndValue(e){const o=this._cachedMeta.vScale,r=this.getParsed(e);return{label:o.getLabels()[e],value:""+o.getLabelForValue(r[o.axis])}}parseObjectData(e,o,r,s){return uz.bind(this)(e,o,r,s)}update(e){const o=this._cachedMeta,r=o.dataset,s=o.data||[],l=o.iScale.getLabels();if(r.points=s,"resize"!==e){const h=this.resolveDatasetElementOptions(e);this.options.showLine||(h.borderWidth=0),this.updateElement(r,void 0,{_loop:!0,_fullLoop:l.length===s.length,options:h},e)}this.updateElements(s,0,s.length,e)}updateElements(e,o,r,s){const l=this._cachedMeta.rScale,h="reset"===s;for(let f=o;f<o+r;f++){const y=e[f],C=this.resolveDataElementOptions(f,y.active?"active":s),D=l.getPointPositionForValue(f,this.getParsed(f).r),R=h?l.xCenter:D.x,V=h?l.yCenter:D.y,$={x:R,y:V,angle:D.angle,skip:isNaN(R)||isNaN(V),options:C};this.updateElement(y,f,$,s)}}}return Nn(t,"id","radar"),Nn(t,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Nn(t,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}}),t})(),ScatterController:(()=>{class t extends $f{getLabelAndValue(e){const o=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:l}=o,h=this.getParsed(e),f=s.getLabelForValue(h.x),y=l.getLabelForValue(h.y);return{label:r[e]||"",value:"("+f+", "+y+")"}}update(e){const o=this._cachedMeta,{data:r=[]}=o,s=this.chart._animationsDisabled;let{start:l,count:h}=qN(o,r,s);if(this._drawStart=l,this._drawCount=h,ZN(o)&&(l=0,h=r.length),this.options.showLine){const{dataset:f,_dataset:y}=o;f._chart=this.chart,f._datasetIndex=this.index,f._decimated=!!y._decimated,f.points=r;const C=this.resolveDatasetElementOptions(e);C.segment=this.options.segment,this.updateElement(f,void 0,{animated:!s,options:C},e)}this.updateElements(r,l,h,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,o,r,s){const l="reset"===s,{iScale:h,vScale:f,_stacked:y,_dataset:C}=this._cachedMeta,D=this.resolveDataElementOptions(o,s),R=this.getSharedOptions(D),V=this.includeOptions(s,R),$=h.axis,X=f.axis,{spanGaps:ee,segment:ue}=this.options,fe=By(ee)?ee:Number.POSITIVE_INFINITY,_e=this.chart._animationsDisabled||l||"none"===s;let Be=o>0&&this.getParsed(o-1);for(let et=o;et<o+r;++et){const gt=e[et],Ht=this.getParsed(et),kt=_e?gt:{},Kt=Do(Ht[X]),Ln=kt[$]=h.getPixelForValue(Ht[$],et),oi=kt[X]=l||Kt?f.getBasePixel():f.getPixelForValue(y?this.applyStack(f,Ht,y):Ht[X],et);kt.skip=isNaN(Ln)||isNaN(oi)||Kt,kt.stop=et>0&&Math.abs(Ht[$]-Be[$])>fe,ue&&(kt.parsed=Ht,kt.raw=C.data[et]),V&&(kt.options=R||this.resolveDataElementOptions(et,gt.active?"active":s)),_e||this.updateElement(gt,et,kt,s),Be=Ht}this.updateSharedOptions(R,s,D)}getMaxOverflow(){const e=this._cachedMeta,o=e.data||[];if(!this.options.showLine){let f=0;for(let y=o.length-1;y>=0;--y)f=Math.max(f,o[y].size(this.resolveDataElementOptions(y))/2);return f>0&&f}const r=e.dataset,s=r.options&&r.options.borderWidth||0;if(!o.length)return s;const l=o[0].size(this.resolveDataElementOptions(0)),h=o[o.length-1].size(this.resolveDataElementOptions(o.length-1));return Math.max(s,l,h)/2}}return Nn(t,"id","scatter"),Nn(t,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Nn(t,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}}),t})()});function Bg(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class $D{static override(n){Object.assign($D.prototype,n)}constructor(n){this.options=n||{}}init(){}formats(){return Bg()}parse(){return Bg()}format(){return Bg()}add(){return Bg()}diff(){return Bg()}startOf(){return Bg()}endOf(){return Bg()}}var qle__date=$D;function Zle(t,n,e,o){const{controller:r,data:s,_sorted:l}=t,h=r._cachedMeta.iScale;if(h&&n===h.axis&&"r"!==n&&l&&s.length){const f=h._reversePixels?fae:sp;if(!o)return f(s,n,e);if(r._sharedOptions){const y=s[0],C="function"==typeof y.getRange&&y.getRange(n);if(C){const D=f(s,n,e-C),R=f(s,n,e+C);return{lo:D.lo,hi:R.hi}}}}return{lo:0,hi:s.length-1}}function U0(t,n,e,o,r){const s=t.getSortedVisibleDatasetMetas(),l=e[n];for(let h=0,f=s.length;h<f;++h){const{index:y,data:C}=s[h],{lo:D,hi:R}=Zle(s[h],n,l,r);for(let V=D;V<=R;++V){const $=C[V];$.skip||o($,y,V)}}}function GD(t,n,e,o,r){const s=[];return!r&&!t.isPointInArea(n)||U0(t,e,n,function(h,f,y){!r&&!N0(h,t.chartArea,0)||h.inRange(n.x,n.y,o)&&s.push({element:h,datasetIndex:f,index:y})},!0),s}function WD(t,n,e,o,r,s){return s||t.isPointInArea(n)?"r"!==e||o?function Yle(t,n,e,o,r,s){let l=[];const h=function Kle(t){const n=-1!==t.indexOf("x"),e=-1!==t.indexOf("y");return function(o,r){const s=n?Math.abs(o.x-r.x):0,l=e?Math.abs(o.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(l,2))}}(e);let f=Number.POSITIVE_INFINITY;return U0(t,e,n,function y(C,D,R){const V=C.inRange(n.x,n.y,r);if(o&&!V)return;const $=C.getCenterPoint(r);if(!s&&!t.isPointInArea($)&&!V)return;const ee=h(n,$);ee<f?(l=[{element:C,datasetIndex:D,index:R}],f=ee):ee===f&&l.push({element:C,datasetIndex:D,index:R})}),l}(t,n,e,o,r,s):function Xle(t,n,e,o){let r=[];return U0(t,e,n,function s(l,h,f){const{startAngle:y,endAngle:C}=l.getProps(["startAngle","endAngle"],o),{angle:D}=UN(l,{x:n.x,y:n.y});O0(D,y,C)&&r.push({element:l,datasetIndex:h,index:f})}),r}(t,n,e,r):[]}function Nz(t,n,e,o,r){const s=[],l="x"===e?"inXRange":"inYRange";let h=!1;return U0(t,e,n,(f,y,C)=>{f[l](n[e],r)&&(s.push({element:f,datasetIndex:y,index:C}),h=h||f.inRange(n.x,n.y,r))}),o&&!h?[]:s}var Qle={evaluateInteractionItems:U0,modes:{index(t,n,e,o){const r=Ng(n,t),s=e.axis||"x",l=e.includeInvisible||!1,h=e.intersect?GD(t,r,s,o,l):WD(t,r,s,!1,o,l),f=[];return h.length?(t.getSortedVisibleDatasetMetas().forEach(y=>{const C=h[0].index,D=y.data[C];D&&!D.skip&&f.push({element:D,datasetIndex:y.index,index:C})}),f):[]},dataset(t,n,e,o){const r=Ng(n,t),s=e.axis||"xy",l=e.includeInvisible||!1;let h=e.intersect?GD(t,r,s,o,l):WD(t,r,s,!1,o,l);if(h.length>0){const f=h[0].datasetIndex,y=t.getDatasetMeta(f).data;h=[];for(let C=0;C<y.length;++C)h.push({element:y[C],datasetIndex:f,index:C})}return h},point:(t,n,e,o)=>GD(t,Ng(n,t),e.axis||"xy",o,e.includeInvisible||!1),nearest:(t,n,e,o)=>WD(t,Ng(n,t),e.axis||"xy",e.intersect,o,e.includeInvisible||!1),x:(t,n,e,o)=>Nz(t,Ng(n,t),"x",e.intersect,o),y:(t,n,e,o)=>Nz(t,Ng(n,t),"y",e.intersect,o)}};const zz=["left","top","right","bottom"];function j0(t,n){return t.filter(e=>e.pos===n)}function Bz(t,n){return t.filter(e=>-1===zz.indexOf(e.pos)&&e.box.axis===n)}function H0(t,n){return t.sort((e,o)=>{const r=n?o:e,s=n?e:o;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function Vz(t,n,e,o){return Math.max(t[e],n[e])+Math.max(t[o],n[o])}function Uz(t,n){t.top=Math.max(t.top,n.top),t.left=Math.max(t.left,n.left),t.bottom=Math.max(t.bottom,n.bottom),t.right=Math.max(t.right,n.right)}function ice(t,n,e,o){const{pos:r,box:s}=e,l=t.maxPadding;if(!mo(r)){e.size&&(t[r]-=e.size);const D=o[e.stack]||{size:0,count:1};D.size=Math.max(D.size,e.horizontal?s.height:s.width),e.size=D.size/D.count,t[r]+=e.size}s.getPadding&&Uz(l,s.getPadding());const h=Math.max(0,n.outerWidth-Vz(l,t,"left","right")),f=Math.max(0,n.outerHeight-Vz(l,t,"top","bottom")),y=h!==t.w,C=f!==t.h;return t.w=h,t.h=f,e.horizontal?{same:y,other:C}:{same:C,other:y}}function rce(t,n){const e=n.maxPadding;return function o(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(l=>{s[l]=Math.max(n[l],e[l])}),s}(t?["left","right"]:["top","bottom"])}function $0(t,n,e,o){const r=[];let s,l,h,f,y,C;for(s=0,l=t.length,y=0;s<l;++s){h=t[s],f=h.box,f.update(h.width||n.w,h.height||n.h,rce(h.horizontal,n));const{same:D,other:R}=ice(n,e,h,o);y|=D&&r.length,C=C||R,f.fullSize||r.push(h)}return y&&$0(r,n,e,o)||C}function sT(t,n,e,o,r){t.top=e,t.left=n,t.right=n+o,t.bottom=e+r,t.width=o,t.height=r}function jz(t,n,e,o){const r=e.padding;let{x:s,y:l}=n;for(const h of t){const f=h.box,y=o[h.stack]||{count:1,placed:0,weight:1},C=h.stackWeight/y.weight||1;if(h.horizontal){const D=n.w*C,R=y.size||f.height;Mc(y.start)&&(l=y.start),f.fullSize?sT(f,r.left,l,e.outerWidth-r.right-r.left,R):sT(f,n.left+y.placed,l,D,R),y.start=l,y.placed+=D,l=f.bottom}else{const D=n.h*C,R=y.size||f.width;Mc(y.start)&&(s=y.start),f.fullSize?sT(f,s,r.top,R,e.outerHeight-r.bottom-r.top):sT(f,s,n.top+y.placed,R,D),y.start=s,y.placed+=D,s=f.right}}n.x=s,n.y=l}var ba={addBox(t,n){t.boxes||(t.boxes=[]),n.fullSize=n.fullSize||!1,n.position=n.position||"top",n.weight=n.weight||0,n._layers=n._layers||function(){return[{z:0,draw(e){n.draw(e)}}]},t.boxes.push(n)},removeBox(t,n){const e=t.boxes?t.boxes.indexOf(n):-1;-1!==e&&t.boxes.splice(e,1)},configure(t,n,e){n.fullSize=e.fullSize,n.position=e.position,n.weight=e.weight},update(t,n,e,o){if(!t)return;const r=va(t.options.layout.padding),s=Math.max(n-r.width,0),l=Math.max(e-r.height,0),h=function nce(t){const n=function Jle(t){const n=[];let e,o,r,s,l,h;for(e=0,o=(t||[]).length;e<o;++e)r=t[e],({position:s,options:{stack:l,stackWeight:h=1}}=r),n.push({index:e,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:l&&s+l,stackWeight:h});return n}(t),e=H0(n.filter(y=>y.box.fullSize),!0),o=H0(j0(n,"left"),!0),r=H0(j0(n,"right")),s=H0(j0(n,"top"),!0),l=H0(j0(n,"bottom")),h=Bz(n,"x"),f=Bz(n,"y");return{fullSize:e,leftAndTop:o.concat(s),rightAndBottom:r.concat(f).concat(l).concat(h),chartArea:j0(n,"chartArea"),vertical:o.concat(r).concat(f),horizontal:s.concat(l).concat(h)}}(t.boxes),f=h.vertical,y=h.horizontal;Vo(t.boxes,X=>{"function"==typeof X.beforeLayout&&X.beforeLayout()});const C=f.reduce((X,ee)=>ee.box.options&&!1===ee.box.options.display?X:X+1,0)||1,D=Object.freeze({outerWidth:n,outerHeight:e,padding:r,availableWidth:s,availableHeight:l,vBoxMaxWidth:s/2/C,hBoxMaxHeight:l/2}),R=Object.assign({},r);Uz(R,va(o));const V=Object.assign({maxPadding:R,w:s,h:l,x:r.left,y:r.top},r),$=function tce(t,n){const e=function ece(t){const n={};for(const e of t){const{stack:o,pos:r,stackWeight:s}=e;if(!o||!zz.includes(r))continue;const l=n[o]||(n[o]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=s}return n}(t),{vBoxMaxWidth:o,hBoxMaxHeight:r}=n;let s,l,h;for(s=0,l=t.length;s<l;++s){h=t[s];const{fullSize:f}=h.box,y=e[h.stack],C=y&&h.stackWeight/y.weight;h.horizontal?(h.width=C?C*o:f&&n.availableWidth,h.height=r):(h.width=o,h.height=C?C*r:f&&n.availableHeight)}return e}(f.concat(y),D);$0(h.fullSize,V,D,$),$0(f,V,D,$),$0(y,V,D,$)&&$0(f,V,D,$),function oce(t){const n=t.maxPadding;function e(o){const r=Math.max(n[o]-t[o],0);return t[o]+=r,r}t.y+=e("top"),t.x+=e("left"),e("right"),e("bottom")}(V),jz(h.leftAndTop,V,D,$),V.x+=V.w,V.y+=V.h,jz(h.rightAndBottom,V,D,$),t.chartArea={left:V.left,top:V.top,right:V.left+V.w,bottom:V.top+V.h,height:V.h,width:V.w},Vo(h.chartArea,X=>{const ee=X.box;Object.assign(ee,t.chartArea),ee.update(V.w,V.h,{left:0,top:0,right:0,bottom:0})})}};class Hz{acquireContext(n,e){}releaseContext(n){return!1}addEventListener(n,e,o){}removeEventListener(n,e,o){}getDevicePixelRatio(){return 1}getMaximumSize(n,e,o,r){return e=Math.max(0,e||n.width),o=o||n.height,{width:e,height:Math.max(0,r?Math.floor(e/r):o)}}isAttached(n){return!0}updateConfig(n){}}class sce extends Hz{acquireContext(n){return n&&n.getContext&&n.getContext("2d")||null}updateConfig(n){n.options.animation=!1}}const aT="$chartjs",ace={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},$z=t=>null===t||""===t,Gz=!!ale&&{passive:!0};function uce(t,n,e){t.canvas.removeEventListener(n,e,Gz)}function lT(t,n){for(const e of t)if(e===n||e.contains(n))return!0}function hce(t,n,e){const o=t.canvas,r=new MutationObserver(s=>{let l=!1;for(const h of s)l=l||lT(h.addedNodes,o),l=l&&!lT(h.removedNodes,o);l&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}function pce(t,n,e){const o=t.canvas,r=new MutationObserver(s=>{let l=!1;for(const h of s)l=l||lT(h.removedNodes,o),l=l&&!lT(h.addedNodes,o);l&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}const G0=new Map;let Wz=0;function qz(){const t=window.devicePixelRatio;t!==Wz&&(Wz=t,G0.forEach((n,e)=>{e.currentDevicePixelRatio!==t&&n()}))}function gce(t,n,e){const o=t.canvas,r=o&&BD(o);if(!r)return;const s=WN((h,f)=>{const y=r.clientWidth;e(h,f),y<r.clientWidth&&e()},window),l=new ResizeObserver(h=>{const f=h[0],y=f.contentRect.width,C=f.contentRect.height;0===y&&0===C||s(y,C)});return l.observe(r),function fce(t,n){G0.size||window.addEventListener("resize",qz),G0.set(t,n)}(t,s),l}function qD(t,n,e){e&&e.disconnect(),"resize"===n&&function mce(t){G0.delete(t),G0.size||window.removeEventListener("resize",qz)}(t)}function _ce(t,n,e){const o=t.canvas,r=WN(s=>{null!==t.ctx&&e(function dce(t,n){const e=ace[t.type]||t.type,{x:o,y:r}=Ng(t,n);return{type:e,chart:n,native:t,x:void 0!==o?o:null,y:void 0!==r?r:null}}(s,t))},t);return function cce(t,n,e){t.addEventListener(n,e,Gz)}(o,n,r),r}class yce extends Hz{acquireContext(n,e){const o=n&&n.getContext&&n.getContext("2d");return o&&o.canvas===n?(function lce(t,n){const e=t.style,o=t.getAttribute("height"),r=t.getAttribute("width");if(t[aT]={initial:{height:o,width:r,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",$z(r)){const s=fz(t,"width");void 0!==s&&(t.width=s)}if($z(o))if(""===t.style.height)t.height=t.width/(n||2);else{const s=fz(t,"height");void 0!==s&&(t.height=s)}}(n,e),o):null}releaseContext(n){const e=n.canvas;if(!e[aT])return!1;const o=e[aT].initial;["height","width"].forEach(s=>{const l=o[s];Do(l)?e.removeAttribute(s):e.setAttribute(s,l)});const r=o.style||{};return Object.keys(r).forEach(s=>{e.style[s]=r[s]}),e.width=e.width,delete e[aT],!0}addEventListener(n,e,o){this.removeEventListener(n,e),(n.$proxies||(n.$proxies={}))[e]=({attach:hce,detach:pce,resize:gce}[e]||_ce)(n,e,o)}removeEventListener(n,e){const o=n.$proxies||(n.$proxies={}),r=o[e];r&&(({attach:qD,detach:qD,resize:qD}[e]||uce)(n,e,r),o[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(n,e,o,r){return function sle(t,n,e,o){const r=oT(t),s=Fg(r,"margin"),l=iT(r.maxWidth,t,"clientWidth")||XC,h=iT(r.maxHeight,t,"clientHeight")||XC,f=function rle(t,n,e){let o,r;if(void 0===n||void 0===e){const s=BD(t);if(s){const l=s.getBoundingClientRect(),h=oT(s),f=Fg(h,"border","width"),y=Fg(h,"padding");n=l.width-y.width-f.width,e=l.height-y.height-f.height,o=iT(h.maxWidth,s,"clientWidth"),r=iT(h.maxHeight,s,"clientHeight")}else n=t.clientWidth,e=t.clientHeight}return{width:n,height:e,maxWidth:o||XC,maxHeight:r||XC}}(t,n,e);let{width:y,height:C}=f;if("content-box"===r.boxSizing){const R=Fg(r,"border","width"),V=Fg(r,"padding");y-=V.width+R.width,C-=V.height+R.height}return y=Math.max(0,y-s.width),C=Math.max(0,o?y/o:C-s.height),y=rT(Math.min(y,l,f.maxWidth)),C=rT(Math.min(C,h,f.maxHeight)),y&&!C&&(C=rT(y/2)),(void 0!==n||void 0!==e)&&o&&f.height&&C>f.height&&(C=f.height,y=rT(Math.floor(C*o))),{width:y,height:C}}(n,e,o,r)}isAttached(n){const e=BD(n);return!(!e||!e.isConnected)}}class Pu{constructor(){Nn(this,"active",!1)}tooltipPosition(n){const{x:e,y:o}=this.getProps(["x","y"],n);return{x:e,y:o}}hasValue(){return By(this.x)&&By(this.y)}getProps(n,e){const o=this.$animations;if(!e||!o)return this;const r={};return n.forEach(s=>{r[s]=o[s]&&o[s].active()?o[s]._to:this[s]}),r}}function cT(t,n,e,o,r){const s=Bi(o,0),l=Math.min(Bi(r,t.length),t.length);let f,y,C,h=0;for(e=Math.ceil(e),r&&(f=r-o,e=f/Math.floor(f/e)),C=s;C<0;)h++,C=Math.round(s+h*e);for(y=Math.max(s,0);y<l;y++)y===C&&(n.push(t[y]),h++,C=Math.round(s+h*e))}Nn(Pu,"defaults",{}),Nn(Pu,"defaultRoutes",void 0);const Ece=t=>"left"===t?"right":"right"===t?"left":t,Zz=(t,n,e)=>"top"===n||"left"===n?t[n]+e:t[n]-e,Kz=(t,n)=>Math.min(n||t,t);function Xz(t,n){const e=[],o=t.length/n,r=t.length;let s=0;for(;s<r;s+=o)e.push(t[Math.floor(s)]);return e}function Ice(t,n,e){const o=t.ticks.length,r=Math.min(n,o-1),s=t._startPixel,l=t._endPixel,h=1e-6;let y,f=t.getPixelForTick(r);if(!(e&&(y=1===o?Math.max(f-s,l-f):0===n?(t.getPixelForTick(1)-f)/2:(f-t.getPixelForTick(r-1))/2,f+=r<n?y:-y,f<s-h||f>l+h)))return f}function W0(t){return t.drawTicks?t.tickLength:0}function Yz(t,n){if(!t.display)return 0;const e=Is(t.font,n),o=va(t.padding);return(rr(t.text)?t.text.length:1)*e.lineHeight+o.height}function Ace(t,n,e){let o=kD(t);return(e&&"right"!==n||!e&&"right"===n)&&(o=Ece(o)),o}class Vg extends Pu{constructor(n){super(),this.id=n.id,this.type=n.type,this.options=void 0,this.ctx=n.ctx,this.chart=n.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(n){this.options=n.setContext(this.getContext()),this.axis=n.axis,this._userMin=this.parse(n.min),this._userMax=this.parse(n.max),this._suggestedMin=this.parse(n.suggestedMin),this._suggestedMax=this.parse(n.suggestedMax)}parse(n,e){return n}getUserBounds(){let{_userMin:n,_userMax:e,_suggestedMin:o,_suggestedMax:r}=this;return n=Hl(n,Number.POSITIVE_INFINITY),e=Hl(e,Number.NEGATIVE_INFINITY),o=Hl(o,Number.POSITIVE_INFINITY),r=Hl(r,Number.NEGATIVE_INFINITY),{min:Hl(n,o),max:Hl(e,r),minDefined:Br(n),maxDefined:Br(e)}}getMinMax(n){let l,{min:e,max:o,minDefined:r,maxDefined:s}=this.getUserBounds();if(r&&s)return{min:e,max:o};const h=this.getMatchingVisibleMetas();for(let f=0,y=h.length;f<y;++f)l=h[f].controller.getMinMax(this,n),r||(e=Math.min(e,l.min)),s||(o=Math.max(o,l.max));return e=s&&e>o?o:e,o=r&&e>o?e:o,{min:Hl(e,Hl(o,e)),max:Hl(o,Hl(e,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const n=this.chart.data;return this.options.labels||(this.isHorizontal()?n.xLabels:n.yLabels)||n.labels||[]}getLabelItems(n=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(n))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Qo(this.options.beforeUpdate,[this])}update(n,e,o){const{beginAtZero:r,grace:s,ticks:l}=this.options,h=l.sampleSize;this.beforeUpdate(),this.maxWidth=n,this.maxHeight=e,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function zae(t,n,e){const{min:o,max:r}=t,s=ON(n,(r-o)/2),l=(h,f)=>e&&0===h?0:h+f;return{min:l(o,-Math.abs(s)),max:l(r,s)}}(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=h<this.ticks.length;this._convertTicksToLabels(f?Xz(this.ticks,h):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||"auto"===l.source)&&(this.ticks=function bce(t,n){const e=t.options.ticks,o=function xce(t){const n=t.options.offset,e=t._tickSize();return Math.floor(Math.min(t._length/e+(n?0:1),t._maxLength/e))}(t),r=Math.min(e.maxTicksLimit||o,o),s=e.major.enabled?function Cce(t){const n=[];let e,o;for(e=0,o=t.length;e<o;e++)t[e].major&&n.push(e);return n}(n):[],l=s.length,h=s[0],f=s[l-1],y=[];if(l>r)return function Tce(t,n,e,o){let l,r=0,s=e[0];for(o=Math.ceil(o),l=0;l<t.length;l++)l===s&&(n.push(t[l]),r++,s=e[r*o])}(n,y,s,l/r),y;const C=function wce(t,n,e){const o=function Sce(t){const n=t.length;let e,o;if(n<2)return!1;for(o=t[0],e=1;e<n;++e)if(t[e]-t[e-1]!==o)return!1;return o}(t),r=n.length/e;if(!o)return Math.max(r,1);const s=function uae(t){const n=[],e=Math.sqrt(t);let o;for(o=1;o<e;o++)t%o==0&&(n.push(o),n.push(t/o));return e===(0|e)&&n.push(e),n.sort((r,s)=>r-s).pop(),n}(o);for(let l=0,h=s.length-1;l<h;l++){const f=s[l];if(f>r)return f}return Math.max(r,1)}(s,n,r);if(l>0){let D,R;const V=l>1?Math.round((f-h)/(l-1)):null;for(cT(n,y,C,Do(V)?0:h-V,h),D=0,R=l-1;D<R;D++)cT(n,y,C,s[D],s[D+1]);return cT(n,y,C,f,Do(V)?n.length:f+V),y}return cT(n,y,C),y}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,o,n=this.options.reverse;this.isHorizontal()?(e=this.left,o=this.right):(e=this.top,o=this.bottom,n=!n),this._startPixel=e,this._endPixel=o,this._reversePixels=n,this._length=o-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Qo(this.options.afterUpdate,[this])}beforeSetDimensions(){Qo(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Qo(this.options.afterSetDimensions,[this])}_callHooks(n){this.chart.notifyPlugins(n,this.getContext()),Qo(this.options[n],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Qo(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(n){const e=this.options.ticks;let o,r,s;for(o=0,r=n.length;o<r;o++)s=n[o],s.label=Qo(e.callback,[s.value,o,n],this)}afterTickToLabelConversion(){Qo(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Qo(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const n=this.options,e=n.ticks,o=Kz(this.ticks.length,n.ticks.maxTicksLimit),r=e.minRotation||0,s=e.maxRotation;let h,f,y,l=r;if(!this._isVisible()||!e.display||r>=s||o<=1||!this.isHorizontal())return void(this.labelRotation=r);const C=this._getLabelSizes(),D=C.widest.width,R=C.highest.height,V=Bs(this.chart.width-D,0,this.maxWidth);h=n.offset?this.maxWidth/o:V/(o-1),D+6>h&&(h=V/(o-(n.offset?.5:1)),f=this.maxHeight-W0(n.grid)-e.padding-Yz(n.title,this.chart.options.font),y=Math.sqrt(D*D+R*R),l=ID(Math.min(Math.asin(Bs((C.highest.height+6)/h,-1,1)),Math.asin(Bs(f/y,-1,1))-Math.asin(Bs(R/y,-1,1)))),l=Math.max(r,Math.min(s,l))),this.labelRotation=l}afterCalculateLabelRotation(){Qo(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Qo(this.options.beforeFit,[this])}fit(){const n={width:0,height:0},{chart:e,options:{ticks:o,title:r,grid:s}}=this,l=this._isVisible(),h=this.isHorizontal();if(l){const f=Yz(r,e.options.font);if(h?(n.width=this.maxWidth,n.height=W0(s)+f):(n.height=this.maxHeight,n.width=W0(s)+f),o.display&&this.ticks.length){const{first:y,last:C,widest:D,highest:R}=this._getLabelSizes(),V=2*o.padding,$=Au(this.labelRotation),X=Math.cos($),ee=Math.sin($);h?n.height=Math.min(this.maxHeight,n.height+(o.mirror?0:ee*D.width+X*R.height)+V):n.width=Math.min(this.maxWidth,n.width+(o.mirror?0:X*D.width+ee*R.height)+V),this._calculatePadding(y,C,ee,X)}}this._handleMargins(),h?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=n.height):(this.width=n.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(n,e,o,r){const{ticks:{align:s,padding:l},position:h}=this.options,f=0!==this.labelRotation,y="top"!==h&&"x"===this.axis;if(this.isHorizontal()){const C=this.getPixelForTick(0)-this.left,D=this.right-this.getPixelForTick(this.ticks.length-1);let R=0,V=0;f?y?(R=r*n.width,V=o*e.height):(R=o*n.height,V=r*e.width):"start"===s?V=e.width:"end"===s?R=n.width:"inner"!==s&&(R=n.width/2,V=e.width/2),this.paddingLeft=Math.max((R-C+l)*this.width/(this.width-C),0),this.paddingRight=Math.max((V-D+l)*this.width/(this.width-D),0)}else{let C=e.height/2,D=n.height/2;"start"===s?(C=0,D=n.height):"end"===s&&(C=e.height,D=0),this.paddingTop=C+l,this.paddingBottom=D+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Qo(this.options.afterFit,[this])}isHorizontal(){const{axis:n,position:e}=this.options;return"top"===e||"bottom"===e||"x"===n}isFullSize(){return this.options.fullSize}_convertTicksToLabels(n){let e,o;for(this.beforeTickToLabelConversion(),this.generateTickLabels(n),e=0,o=n.length;e<o;e++)Do(n[e].label)&&(n.splice(e,1),o--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let n=this._labelSizes;if(!n){const e=this.options.ticks.sampleSize;let o=this.ticks;e<o.length&&(o=Xz(o,e)),this._labelSizes=n=this._computeLabelSizes(o,o.length,this.options.ticks.maxTicksLimit)}return n}_computeLabelSizes(n,e,o){const{ctx:r,_longestTextCache:s}=this,l=[],h=[],f=Math.floor(e/Kz(e,o));let D,R,V,$,X,ee,ue,fe,_e,Be,et,y=0,C=0;for(D=0;D<e;D+=f){if($=n[D].label,X=this._resolveTickFontOptions(D),r.font=ee=X.string,ue=s[ee]=s[ee]||{data:{},gc:[]},fe=X.lineHeight,_e=Be=0,Do($)||rr($)){if(rr($))for(R=0,V=$.length;R<V;++R)et=$[R],!Do(et)&&!rr(et)&&(_e=JC(r,ue.data,ue.gc,_e,et),Be+=fe)}else _e=JC(r,ue.data,ue.gc,_e,$),Be=fe;l.push(_e),h.push(Be),y=Math.max(_e,y),C=Math.max(Be,C)}!function Dce(t,n){Vo(t,e=>{const o=e.gc,r=o.length/2;let s;if(r>n){for(s=0;s<r;++s)delete e.data[o[s]];o.splice(0,r)}})}(s,e);const gt=l.indexOf(y),Ht=h.indexOf(C),kt=Kt=>({width:l[Kt]||0,height:h[Kt]||0});return{first:kt(0),last:kt(e-1),widest:kt(gt),highest:kt(Ht),widths:l,heights:h}}getLabelForValue(n){return n}getPixelForValue(n,e){return NaN}getValueForPixel(n){}getPixelForTick(n){const e=this.ticks;return n<0||n>e.length-1?null:this.getPixelForValue(e[n].value)}getPixelForDecimal(n){this._reversePixels&&(n=1-n);const e=this._startPixel+n*this._length;return function pae(t){return Bs(t,-32768,32767)}(this._alignToPixels?Og(this.chart,e,0):e)}getDecimalForPixel(n){const e=(n-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:n,max:e}=this;return n<0&&e<0?e:n>0&&e>0?n:0}getContext(n){const e=this.ticks||[];if(n>=0&&n<e.length){const o=e[n];return o.$context||(o.$context=function kce(t,n,e){return Hf(t,{tick:e,index:n,type:"tick"})}(this.getContext(),n,o))}return this.$context||(this.$context=function Mce(t,n){return Hf(t,{scale:n,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const n=this.options.ticks,e=Au(this.labelRotation),o=Math.abs(Math.cos(e)),r=Math.abs(Math.sin(e)),s=this._getLabelSizes(),l=n.autoSkipPadding||0,h=s?s.widest.width+l:0,f=s?s.highest.height+l:0;return this.isHorizontal()?f*o>h*r?h/o:f/r:f*r<h*o?f/o:h/r}_isVisible(){const n=this.options.display;return"auto"!==n?!!n:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(n){const e=this.axis,o=this.chart,r=this.options,{grid:s,position:l,border:h}=r,f=s.offset,y=this.isHorizontal(),D=this.ticks.length+(f?1:0),R=W0(s),V=[],$=h.setContext(this.getContext()),X=$.display?$.width:0,ee=X/2,ue=function(sn){return Og(o,sn,X)};let fe,_e,Be,et,gt,Ht,kt,Kt,Ln,oi,Ri,ar;if("top"===l)fe=ue(this.bottom),Ht=this.bottom-R,Kt=fe-ee,oi=ue(n.top)+ee,ar=n.bottom;else if("bottom"===l)fe=ue(this.top),oi=n.top,ar=ue(n.bottom)-ee,Ht=fe+ee,Kt=this.top+R;else if("left"===l)fe=ue(this.right),gt=this.right-R,kt=fe-ee,Ln=ue(n.left)+ee,Ri=n.right;else if("right"===l)fe=ue(this.left),Ln=n.left,Ri=ue(n.right)-ee,gt=fe+ee,kt=this.left+R;else if("x"===e){if("center"===l)fe=ue((n.top+n.bottom)/2+.5);else if(mo(l)){const sn=Object.keys(l)[0];fe=ue(this.chart.scales[sn].getPixelForValue(l[sn]))}oi=n.top,ar=n.bottom,Ht=fe+ee,Kt=Ht+R}else if("y"===e){if("center"===l)fe=ue((n.left+n.right)/2);else if(mo(l)){const sn=Object.keys(l)[0];fe=ue(this.chart.scales[sn].getPixelForValue(l[sn]))}gt=fe-ee,kt=gt-R,Ln=n.left,Ri=n.right}const xa=Bi(r.ticks.maxTicksLimit,D),Oo=Math.max(1,Math.ceil(D/xa));for(_e=0;_e<D;_e+=Oo){const sn=this.getContext(_e),Cn=s.setContext(sn),Wn=h.setContext(sn),fi=Cn.lineWidth,lr=Cn.color,Ga=Wn.dash||[],ps=Wn.dashOffset,bl=Cn.tickWidth,Uo=Cn.tickColor,Wf=Cn.tickBorderDash||[],jg=Cn.tickBorderDashOffset;Be=Ice(this,_e,f),void 0!==Be&&(et=Og(o,Be,fi),y?gt=kt=Ln=Ri=et:Ht=Kt=oi=ar=et,V.push({tx1:gt,ty1:Ht,tx2:kt,ty2:Kt,x1:Ln,y1:oi,x2:Ri,y2:ar,width:fi,color:lr,borderDash:Ga,borderDashOffset:ps,tickWidth:bl,tickColor:Uo,tickBorderDash:Wf,tickBorderDashOffset:jg}))}return this._ticksLength=D,this._borderValue=fe,V}_computeLabelItems(n){const e=this.axis,o=this.options,{position:r,ticks:s}=o,l=this.isHorizontal(),h=this.ticks,{align:f,crossAlign:y,padding:C,mirror:D}=s,R=W0(o.grid),V=R+C,$=D?-C:V,X=-Au(this.labelRotation),ee=[];let ue,fe,_e,Be,et,gt,Ht,kt,Kt,Ln,oi,Ri,ar="middle";if("top"===r)gt=this.bottom-$,Ht=this._getXAxisLabelAlignment();else if("bottom"===r)gt=this.top+$,Ht=this._getXAxisLabelAlignment();else if("left"===r){const Oo=this._getYAxisLabelAlignment(R);Ht=Oo.textAlign,et=Oo.x}else if("right"===r){const Oo=this._getYAxisLabelAlignment(R);Ht=Oo.textAlign,et=Oo.x}else if("x"===e){if("center"===r)gt=(n.top+n.bottom)/2+V;else if(mo(r)){const Oo=Object.keys(r)[0];gt=this.chart.scales[Oo].getPixelForValue(r[Oo])+V}Ht=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===r)et=(n.left+n.right)/2-V;else if(mo(r)){const Oo=Object.keys(r)[0];et=this.chart.scales[Oo].getPixelForValue(r[Oo])}Ht=this._getYAxisLabelAlignment(R).textAlign}"y"===e&&("start"===f?ar="top":"end"===f&&(ar="bottom"));const xa=this._getLabelSizes();for(ue=0,fe=h.length;ue<fe;++ue){_e=h[ue],Be=_e.label;const Oo=s.setContext(this.getContext(ue));kt=this.getPixelForTick(ue)+s.labelOffset,Kt=this._resolveTickFontOptions(ue),Ln=Kt.lineHeight,oi=rr(Be)?Be.length:1;const sn=oi/2,Cn=Oo.color,Wn=Oo.textStrokeColor,fi=Oo.textStrokeWidth;let Ga,lr=Ht;if(l?(et=kt,"inner"===Ht&&(lr=ue===fe-1?this.options.reverse?"left":"right":0===ue?this.options.reverse?"right":"left":"center"),Ri="top"===r?"near"===y||0!==X?-oi*Ln+Ln/2:"center"===y?-xa.highest.height/2-sn*Ln+Ln:Ln/2-xa.highest.height:"near"===y||0!==X?Ln/2:"center"===y?xa.highest.height/2-sn*Ln:xa.highest.height-oi*Ln,D&&(Ri*=-1),0!==X&&!Oo.showLabelBackdrop&&(et+=Ln/2*Math.sin(X))):(gt=kt,Ri=(1-oi)*Ln/2),Oo.showLabelBackdrop){const ps=va(Oo.backdropPadding),bl=xa.heights[ue],Uo=xa.widths[ue];let Wf=Ri-ps.top,jg=0-ps.left;switch(ar){case"middle":Wf-=bl/2;break;case"bottom":Wf-=bl}switch(Ht){case"center":jg-=Uo/2;break;case"right":jg-=Uo}Ga={left:jg,top:Wf,width:Uo+ps.width,height:bl+ps.height,color:Oo.backdropColor}}ee.push({label:Be,font:Kt,textOffset:Ri,options:{rotation:X,color:Cn,strokeColor:Wn,strokeWidth:fi,textAlign:lr,textBaseline:ar,translation:[et,gt],backdrop:Ga}})}return ee}_getXAxisLabelAlignment(){const{position:n,ticks:e}=this.options;if(-Au(this.labelRotation))return"top"===n?"left":"right";let r="center";return"start"===e.align?r="left":"end"===e.align?r="right":"inner"===e.align&&(r="inner"),r}_getYAxisLabelAlignment(n){const{position:e,ticks:{crossAlign:o,mirror:r,padding:s}}=this.options,h=n+s,f=this._getLabelSizes().widest.width;let y,C;return"left"===e?r?(C=this.right+s,"near"===o?y="left":"center"===o?(y="center",C+=f/2):(y="right",C+=f)):(C=this.right-h,"near"===o?y="right":"center"===o?(y="center",C-=f/2):(y="left",C=this.left)):"right"===e?r?(C=this.left+s,"near"===o?y="right":"center"===o?(y="center",C-=f/2):(y="left",C-=f)):(C=this.left+h,"near"===o?y="left":"center"===o?(y="center",C+=f/2):(y="right",C=this.right)):y="right",{textAlign:y,x:C}}_computeLabelArea(){if(this.options.ticks.mirror)return;const n=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:n.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:n.width}:void 0}drawBackground(){const{ctx:n,options:{backgroundColor:e},left:o,top:r,width:s,height:l}=this;e&&(n.save(),n.fillStyle=e,n.fillRect(o,r,s,l),n.restore())}getLineWidthForValue(n){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const r=this.ticks.findIndex(s=>s.value===n);return r>=0?e.setContext(this.getContext(r)).lineWidth:0}drawGrid(n){const e=this.options.grid,o=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(n));let s,l;const h=(f,y,C)=>{!C.width||!C.color||(o.save(),o.lineWidth=C.width,o.strokeStyle=C.color,o.setLineDash(C.borderDash||[]),o.lineDashOffset=C.borderDashOffset,o.beginPath(),o.moveTo(f.x,f.y),o.lineTo(y.x,y.y),o.stroke(),o.restore())};if(e.display)for(s=0,l=r.length;s<l;++s){const f=r[s];e.drawOnChartArea&&h({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),e.drawTicks&&h({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:n,ctx:e,options:{border:o,grid:r}}=this,s=o.setContext(this.getContext()),l=o.display?s.width:0;if(!l)return;const h=r.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let y,C,D,R;this.isHorizontal()?(y=Og(n,this.left,l)-l/2,C=Og(n,this.right,h)+h/2,D=R=f):(D=Og(n,this.top,l)-l/2,R=Og(n,this.bottom,h)+h/2,y=C=f),e.save(),e.lineWidth=s.width,e.strokeStyle=s.color,e.beginPath(),e.moveTo(y,D),e.lineTo(C,R),e.stroke(),e.restore()}drawLabels(n){if(!this.options.ticks.display)return;const o=this.ctx,r=this._computeLabelArea();r&&eT(o,r);const s=this.getLabelItems(n);for(const l of s)Lg(o,l.label,0,l.textOffset,l.font,l.options);r&&tT(o)}drawTitle(){const{ctx:n,options:{position:e,title:o,reverse:r}}=this;if(!o.display)return;const s=Is(o.font),l=va(o.padding),h=o.align;let f=s.lineHeight/2;"bottom"===e||"center"===e||mo(e)?(f+=l.bottom,rr(o.text)&&(f+=s.lineHeight*(o.text.length-1))):f+=l.top;const{titleX:y,titleY:C,maxWidth:D,rotation:R}=function Pce(t,n,e,o){const{top:r,left:s,bottom:l,right:h,chart:f}=t,{chartArea:y,scales:C}=f;let R,V,$,D=0;const X=l-r,ee=h-s;if(t.isHorizontal()){if(V=ya(o,s,h),mo(e)){const ue=Object.keys(e)[0];$=C[ue].getPixelForValue(e[ue])+X-n}else $="center"===e?(y.bottom+y.top)/2+X-n:Zz(t,e,n);R=h-s}else{if(mo(e)){const ue=Object.keys(e)[0];V=C[ue].getPixelForValue(e[ue])-ee+n}else V="center"===e?(y.left+y.right)/2-ee+n:Zz(t,e,n);$=ya(o,l,r),D="left"===e?-Vr:Vr}return{titleX:V,titleY:$,maxWidth:R,rotation:D}}(this,f,e,h);Lg(n,o.text,0,0,s,{color:o.color,maxWidth:D,rotation:R,textAlign:Ace(h,e,r),textBaseline:"middle",translation:[y,C]})}draw(n){this._isVisible()&&(this.drawBackground(),this.drawGrid(n),this.drawBorder(),this.drawTitle(),this.drawLabels(n))}_layers(){const n=this.options,e=n.ticks&&n.ticks.z||0,o=Bi(n.grid&&n.grid.z,-1),r=Bi(n.border&&n.border.z,0);return this._isVisible()&&this.draw===Vg.prototype.draw?[{z:o,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:e,draw:s=>{this.drawLabels(s)}}]:[{z:e,draw:s=>{this.draw(s)}}]}getMatchingVisibleMetas(n){const e=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",r=[];let s,l;for(s=0,l=e.length;s<l;++s){const h=e[s];h[o]===this.id&&(!n||h.type===n)&&r.push(h)}return r}_resolveTickFontOptions(n){return Is(this.options.ticks.setContext(this.getContext(n)).font)}_maxDigits(){const n=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/n}}class uT{constructor(n,e,o){this.type=n,this.scope=e,this.override=o,this.items=Object.create(null)}isForType(n){return Object.prototype.isPrototypeOf.call(this.type.prototype,n.prototype)}register(n){const e=Object.getPrototypeOf(n);let o;(function Rce(t){return"id"in t&&"defaults"in t})(e)&&(o=this.register(e));const r=this.items,s=n.id,l=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+n);return s in r||(r[s]=n,function Oce(t,n,e){const o=k0(Object.create(null),[e?os.get(e):{},os.get(n),t.defaults]);os.set(n,o),t.defaultRoutes&&function Lce(t,n){Object.keys(n).forEach(e=>{const o=e.split("."),r=o.pop(),s=[t].concat(o).join("."),l=n[e].split("."),h=l.pop(),f=l.join(".");os.route(s,r,f,h)})}(n,t.defaultRoutes),t.descriptors&&os.describe(n,t.descriptors)}(n,l,o),this.override&&os.override(n.id,n.overrides)),l}get(n){return this.items[n]}unregister(n){const e=this.items,o=n.id,r=this.scope;o in e&&delete e[o],r&&o in os[r]&&(delete os[r][o],this.override&&delete Pg[o])}}class Fce{constructor(){this.controllers=new uT($f,"datasets",!0),this.elements=new uT(Pu,"elements"),this.plugins=new uT(Object,"plugins"),this.scales=new uT(Vg,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...n){this._each("register",n)}remove(...n){this._each("unregister",n)}addControllers(...n){this._each("register",n,this.controllers)}addElements(...n){this._each("register",n,this.elements)}addPlugins(...n){this._each("register",n,this.plugins)}addScales(...n){this._each("register",n,this.scales)}getController(n){return this._get(n,this.controllers,"controller")}getElement(n){return this._get(n,this.elements,"element")}getPlugin(n){return this._get(n,this.plugins,"plugin")}getScale(n){return this._get(n,this.scales,"scale")}removeControllers(...n){this._each("unregister",n,this.controllers)}removeElements(...n){this._each("unregister",n,this.elements)}removePlugins(...n){this._each("unregister",n,this.plugins)}removeScales(...n){this._each("unregister",n,this.scales)}_each(n,e,o){[...e].forEach(r=>{const s=o||this._getRegistryForType(r);o||s.isForType(r)||s===this.plugins&&r.id?this._exec(n,s,r):Vo(r,l=>{const h=o||this._getRegistryForType(l);this._exec(n,h,l)})})}_exec(n,e,o){const r=ED(n);Qo(o["before"+r],[],o),e[n](o),Qo(o["after"+r],[],o)}_getRegistryForType(n){for(let e=0;e<this._typedRegistries.length;e++){const o=this._typedRegistries[e];if(o.isForType(n))return o}return this.plugins}_get(n,e,o){const r=e.get(n);if(void 0===r)throw new Error('"'+n+'" is not a registered '+o+".");return r}}var Ud=new Fce;class Nce{constructor(){this._init=[]}notify(n,e,o,r){"beforeInit"===e&&(this._init=this._createDescriptors(n,!0),this._notify(this._init,n,"install"));const s=r?this._descriptors(n).filter(r):this._descriptors(n),l=this._notify(s,n,e,o);return"afterDestroy"===e&&(this._notify(s,n,"stop"),this._notify(this._init,n,"uninstall")),l}_notify(n,e,o,r){r=r||{};for(const s of n){const l=s.plugin;if(!1===Qo(l[o],[e,r,s.options],l)&&r.cancelable)return!1}return!0}invalidate(){Do(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(n){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(n);return this._notifyStateChanges(n),e}_createDescriptors(n,e){const o=n&&n.config,r=Bi(o.options&&o.options.plugins,{}),s=function zce(t){const n={},e=[],o=Object.keys(Ud.plugins.items);for(let s=0;s<o.length;s++)e.push(Ud.getPlugin(o[s]));const r=t.plugins||[];for(let s=0;s<r.length;s++){const l=r[s];-1===e.indexOf(l)&&(e.push(l),n[l.id]=!0)}return{plugins:e,localIds:n}}(o);return!1!==r||e?function Vce(t,{plugins:n,localIds:e},o,r){const s=[],l=t.getContext();for(const h of n){const f=h.id,y=Bce(o[f],r);null!==y&&s.push({plugin:h,options:Uce(t.config,{plugin:h,local:e[f]},y,l)})}return s}(n,s,r,e):[]}_notifyStateChanges(n){const e=this._oldCache||[],o=this._cache,r=(s,l)=>s.filter(h=>!l.some(f=>h.plugin.id===f.plugin.id));this._notify(r(e,o),n,"stop"),this._notify(r(o,e),n,"start")}}function Bce(t,n){return n||!1!==t?!0===t?{}:t:null}function Uce(t,{plugin:n,local:e},o,r){const s=t.pluginScopeKeys(n),l=t.getOptionScopes(o,s);return e&&n.defaults&&l.push(n.defaults),t.createResolver(l,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ZD(t,n){return((n.datasets||{})[t]||{}).indexAxis||n.indexAxis||(os.datasets[t]||{}).indexAxis||"x"}function dT(t,n){if("x"===t||"y"===t||"r"===t||(t=n.axis||function $ce(t){return"top"===t||"bottom"===t?"x":"left"===t||"right"===t?"y":void 0}(n.position)||t.length>1&&dT(t[0].toLowerCase(),n)))return t;throw new Error(`Cannot determine type of '${name}' axis. Please provide 'axis' or 'position' option.`)}function Qz(t){const n=t.options||(t.options={});n.plugins=Bi(n.plugins,{}),n.scales=function Gce(t,n){const e=Pg[t.type]||{scales:{}},o=n.scales||{},r=ZD(t.type,n),s=Object.create(null);return Object.keys(o).forEach(l=>{const h=o[l];if(!mo(h))return console.error(`Invalid scale configuration for scale: ${l}`);if(h._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const f=dT(l,h),y=function Hce(t,n){return t===n?"_index_":"_value_"}(f,r),C=e.scales||{};s[l]=A0(Object.create(null),[{axis:f},h,C[f],C[y]])}),t.data.datasets.forEach(l=>{const h=l.type||t.type,f=l.indexAxis||ZD(h,n),C=(Pg[h]||{}).scales||{};Object.keys(C).forEach(D=>{const R=function jce(t,n){let e=t;return"_index_"===t?e=n:"_value_"===t&&(e="x"===n?"y":"x"),e}(D,f),V=l[R+"AxisID"]||R;s[V]=s[V]||Object.create(null),A0(s[V],[{axis:R},o[V],C[D]])})}),Object.keys(s).forEach(l=>{const h=s[l];A0(h,[os.scales[h.type],os.scale])}),s}(t,n)}function Jz(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const eB=new Map,tB=new Set;function hT(t,n){let e=eB.get(t);return e||(e=n(),eB.set(t,e),tB.add(e)),e}const q0=(t,n,e)=>{const o=Vf(n,e);void 0!==o&&t.add(o)};class qce{constructor(n){this._config=function Wce(t){return(t=t||{}).data=Jz(t.data),Qz(t),t}(n),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(n){this._config.type=n}get data(){return this._config.data}set data(n){this._config.data=Jz(n)}get options(){return this._config.options}set options(n){this._config.options=n}get plugins(){return this._config.plugins}update(){const n=this._config;this.clearCache(),Qz(n)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(n){return hT(n,()=>[[`datasets.${n}`,""]])}datasetAnimationScopeKeys(n,e){return hT(`${n}.transition.${e}`,()=>[[`datasets.${n}.transitions.${e}`,`transitions.${e}`],[`datasets.${n}`,""]])}datasetElementScopeKeys(n,e){return hT(`${n}-${e}`,()=>[[`datasets.${n}.elements.${e}`,`datasets.${n}`,`elements.${e}`,""]])}pluginScopeKeys(n){const e=n.id;return hT(`${this.type}-plugin-${e}`,()=>[[`plugins.${e}`,...n.additionalOptionScopes||[]]])}_cachedScopes(n,e){const o=this._scopeCache;let r=o.get(n);return(!r||e)&&(r=new Map,o.set(n,r)),r}getOptionScopes(n,e,o){const{options:r,type:s}=this,l=this._cachedScopes(n,o),h=l.get(e);if(h)return h;const f=new Set;e.forEach(C=>{n&&(f.add(n),C.forEach(D=>q0(f,n,D))),C.forEach(D=>q0(f,r,D)),C.forEach(D=>q0(f,Pg[s]||{},D)),C.forEach(D=>q0(f,os,D)),C.forEach(D=>q0(f,PD,D))});const y=Array.from(f);return 0===y.length&&y.push(Object.create(null)),tB.has(e)&&l.set(e,y),y}chartOptionScopes(){const{options:n,type:e}=this;return[n,Pg[e]||{},os.datasets[e]||{},{type:e},os,PD]}resolveNamedOptions(n,e,o,r=[""]){const s={$shared:!0},{resolver:l,subPrefixes:h}=nB(this._resolverCache,n,r);let f=l;(function Kce(t,n){const{isScriptable:e,isIndexable:o}=oz(t);for(const r of n){const s=e(r),l=o(r),h=(l||s)&&t[r];if(s&&(Uf(h)||Zce(h))||l&&rr(h))return!0}return!1})(l,e)&&(s.$shared=!1,f=Vy(l,o=Uf(o)?o():o,this.createResolver(n,o,h)));for(const y of e)s[y]=f[y];return s}createResolver(n,e,o=[""],r){const{resolver:s}=nB(this._resolverCache,n,o);return mo(e)?Vy(s,e,void 0,r):s}}function nB(t,n,e){let o=t.get(n);o||(o=new Map,t.set(n,o));const r=e.join();let s=o.get(r);return s||(s={resolver:FD(n,e),subPrefixes:e.filter(h=>!h.toLowerCase().includes("hover"))},o.set(r,s)),s}const Zce=t=>mo(t)&&Object.getOwnPropertyNames(t).reduce((n,e)=>n||Uf(t[e]),!1),Yce=["top","bottom","left","right","chartArea"];function iB(t,n){return"top"===t||"bottom"===t||-1===Yce.indexOf(t)&&"x"===n}function oB(t,n){return function(e,o){return e[t]===o[t]?e[n]-o[n]:e[t]-o[t]}}function rB(t){const n=t.chart,e=n.options.animation;n.notifyPlugins("afterRender"),Qo(e&&e.onComplete,[t],n)}function Qce(t){const n=t.chart,e=n.options.animation;Qo(e&&e.onProgress,[t],n)}function sB(t){return hz()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const pT={},aB=t=>{const n=sB(t);return Object.values(pT).filter(e=>e.canvas===n).pop()};function Jce(t,n,e){const o=Object.keys(t);for(const r of o){const s=+r;if(s>=n){const l=t[r];delete t[r],(e>0||s>n)&&(t[s+e]=l)}}}let Hy=(()=>{class t{static register(...e){Ud.add(...e),lB()}static unregister(...e){Ud.remove(...e),lB()}constructor(e,o){const r=this.config=new qce(o),s=sB(e),l=aB(s);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const h=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||function vce(t){return!hz()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?sce:yce}(s)),this.platform.updateConfig(r);const f=this.platform.acquireContext(s,h.aspectRatio),y=f&&f.canvas,C=y&&y.height,D=y&&y.width;this.id=tae(),this.ctx=f,this.canvas=y,this.width=D,this.height=C,this._options=h,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Nce,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function _ae(t,n){let e;return function(...o){return n?(clearTimeout(e),e=setTimeout(t,n,o)):t.apply(this,o),n}}(R=>this.update(R),h.resizeDelay||0),this._dataChanges=[],pT[this.id]=this,f&&y?(ap.listen(this,"complete",rB),ap.listen(this,"progress",Qce),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:o},width:r,height:s,_aspectRatio:l}=this;return Do(e)?o&&l?l:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Ud}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():pz(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return tz(this.canvas,this.ctx),this}stop(){return ap.stop(this),this}resize(e,o){ap.running(this)?this._resizeBeforeDraw={width:e,height:o}:this._resize(e,o)}_resize(e,o){const r=this.options,h=this.platform.getMaximumSize(this.canvas,e,o,r.maintainAspectRatio&&this.aspectRatio),f=r.devicePixelRatio||this.platform.getDevicePixelRatio(),y=this.width?"resize":"attach";this.width=h.width,this.height=h.height,this._aspectRatio=this.aspectRatio,pz(this,f,!0)&&(this.notifyPlugins("resize",{size:h}),Qo(r.onResize,[this,h],this),this.attached&&this._doResize(y)&&this.render())}ensureScalesHaveIDs(){Vo(this.options.scales||{},(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,o=e.scales,r=this.scales,s=Object.keys(r).reduce((h,f)=>(h[f]=!1,h),{});let l=[];o&&(l=l.concat(Object.keys(o).map(h=>{const f=o[h],y=dT(h,f),C="r"===y,D="x"===y;return{options:f,dposition:C?"chartArea":D?"bottom":"left",dtype:C?"radialLinear":D?"category":"linear"}}))),Vo(l,h=>{const f=h.options,y=f.id,C=dT(y,f),D=Bi(f.type,h.dtype);(void 0===f.position||iB(f.position,C)!==iB(h.dposition))&&(f.position=h.dposition),s[y]=!0;let R=null;y in r&&r[y].type===D?R=r[y]:(R=new(Ud.getScale(D))({id:y,type:D,ctx:this.ctx,chart:this}),r[R.id]=R),R.init(f,e)}),Vo(s,(h,f)=>{h||delete r[f]}),Vo(r,h=>{ba.configure(this,h,h.options),ba.addBox(this,h)})}_updateMetasets(){const e=this._metasets,o=this.data.datasets.length,r=e.length;if(e.sort((s,l)=>s.index-l.index),r>o){for(let s=o;s<r;++s)this._destroyDatasetMeta(s);e.splice(o,r-o)}this._sortedMetasets=e.slice(0).sort(oB("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:o}}=this;e.length>o.length&&delete this._stacks,e.forEach((r,s)=>{0===o.filter(l=>l===r._dataset).length&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],o=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=o.length;r<s;r++){const l=o[r];let h=this.getDatasetMeta(r);const f=l.type||this.config.type;if(h.type&&h.type!==f&&(this._destroyDatasetMeta(r),h=this.getDatasetMeta(r)),h.type=f,h.indexAxis=l.indexAxis||ZD(f,this.options),h.order=l.order||0,h.index=r,h.label=""+l.label,h.visible=this.isDatasetVisible(r),h.controller)h.controller.updateIndex(r),h.controller.linkScales();else{const y=Ud.getController(f),{datasetElementType:C,dataElementType:D}=os.datasets[f];Object.assign(y,{dataElementType:Ud.getElement(D),datasetElementType:C&&Ud.getElement(C)}),h.controller=new y(this,r),e.push(h.controller)}}return this._updateMetasets(),e}_resetElements(){Vo(this.data.datasets,(e,o)=>{this.getDatasetMeta(o).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const o=this.config;o.update();const r=this._options=o.createResolver(o.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let h=0;for(let C=0,D=this.data.datasets.length;C<D;C++){const{controller:R}=this.getDatasetMeta(C),V=!s&&-1===l.indexOf(R);R.buildOrUpdateElements(V),h=Math.max(+R.getMaxOverflow(),h)}h=this._minPadding=r.layout.autoPadding?h:0,this._updateLayout(h),s||Vo(l,C=>{C.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(oB("z","_idx"));const{_active:f,_lastEvent:y}=this;y?this._eventHandler(y,!0):f.length&&this._updateHoverStyles(f,f,!0),this.render()}_updateScales(){Vo(this.scales,e=>{ba.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,o=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!FN(o,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,o=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:l}of o)Jce(e,s,"_removeElements"===r?-l:l)}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const o=this.data.datasets.length,r=l=>new Set(e.filter(h=>h[0]===l).map((h,f)=>f+","+h.splice(1).join(","))),s=r(0);for(let l=1;l<o;l++)if(!FN(s,r(l)))return;return Array.from(s).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;ba.update(this,this.width,this.height,e);const o=this.chartArea,r=o.width<=0||o.height<=0;this._layers=[],Vo(this.boxes,s=>{r&&"chartArea"===s.position||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,l)=>{s._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let o=0,r=this.data.datasets.length;o<r;++o)this.getDatasetMeta(o).controller.configure();for(let o=0,r=this.data.datasets.length;o<r;++o)this._updateDataset(o,Uf(e)?e({datasetIndex:o}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,o){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:o,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",s)&&(r.controller._update(o),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(ap.has(this)?this.attached&&!ap.running(this)&&ap.start(this):(this.draw(),rB({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resize(r,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const o=this._layers;for(e=0;e<o.length&&o[e].z<=0;++e)o[e].draw(this.chartArea);for(this._drawDatasets();e<o.length;++e)o[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const o=this._sortedMetasets,r=[];let s,l;for(s=0,l=o.length;s<l;++s){const h=o[s];(!e||h.visible)&&r.push(h)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let o=e.length-1;o>=0;--o)this._drawDataset(e[o]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const o=this.ctx,r=e._clip,s=!r.disabled,l=function tue(t){const{xScale:n,yScale:e}=t;if(n&&e)return{left:n.left,right:n.right,top:e.top,bottom:e.bottom}}(e)||this.chartArea,h={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",h)&&(s&&eT(o,{left:!1===r.left?0:l.left-r.left,right:!1===r.right?this.width:l.right+r.right,top:!1===r.top?0:l.top-r.top,bottom:!1===r.bottom?this.height:l.bottom+r.bottom}),e.controller.draw(),s&&tT(o),h.cancelable=!1,this.notifyPlugins("afterDatasetDraw",h))}isPointInArea(e){return N0(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,o,r,s){const l=Qle.modes[o];return"function"==typeof l?l(this,e,r,s):[]}getDatasetMeta(e){const o=this.data.datasets[e],r=this._metasets;let s=r.filter(l=>l&&l._dataset===o).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:o&&o.order||0,index:e,_dataset:o,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=Hf(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const o=this.data.datasets[e];if(!o)return!1;const r=this.getDatasetMeta(e);return"boolean"==typeof r.hidden?!r.hidden:!o.hidden}setDatasetVisibility(e,o){this.getDatasetMeta(e).hidden=!o}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,o,r){const s=r?"show":"hide",l=this.getDatasetMeta(e),h=l.controller._resolveAnimations(void 0,s);Mc(o)?(l.data[o].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),h.update(l,{visible:r}),this.update(f=>f.datasetIndex===e?s:void 0))}hide(e,o){this._updateVisibility(e,o,!1)}show(e,o){this._updateVisibility(e,o,!0)}_destroyDatasetMeta(e){const o=this._metasets[e];o&&o.controller&&o.controller._destroy(),delete this._metasets[e]}_stop(){let e,o;for(this.stop(),ap.remove(this),e=0,o=this.data.datasets.length;e<o;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:o}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),tz(e,o),this.platform.releaseContext(o),this.canvas=null,this.ctx=null),delete pT[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,o=this.platform,r=(l,h)=>{o.addEventListener(this,l,h),e[l]=h},s=(l,h,f)=>{l.offsetX=h,l.offsetY=f,this._eventHandler(l)};Vo(this.options.events,l=>r(l,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,o=this.platform,r=(y,C)=>{o.addEventListener(this,y,C),e[y]=C},s=(y,C)=>{e[y]&&(o.removeEventListener(this,y,C),delete e[y])},l=(y,C)=>{this.canvas&&this.resize(y,C)};let h;const f=()=>{s("attach",f),this.attached=!0,this.resize(),r("resize",l),r("detach",h)};h=()=>{this.attached=!1,s("resize",l),this._stop(),this._resize(0,0),r("attach",f)},o.isAttached(this.canvas)?f():h()}unbindEvents(){Vo(this._listeners,(e,o)=>{this.platform.removeEventListener(this,o,e)}),this._listeners={},Vo(this._responsiveListeners,(e,o)=>{this.platform.removeEventListener(this,o,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,o,r){const s=r?"set":"remove";let l,h,f,y;for("dataset"===o&&(l=this.getDatasetMeta(e[0].datasetIndex),l.controller["_"+s+"DatasetHoverStyle"]()),f=0,y=e.length;f<y;++f){h=e[f];const C=h&&this.getDatasetMeta(h.datasetIndex).controller;C&&C[s+"HoverStyle"](h.element,h.datasetIndex,h.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const o=this._active||[],r=e.map(({datasetIndex:l,index:h})=>{const f=this.getDatasetMeta(l);if(!f)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:f.data[h],index:h}});!ZC(r,o)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,o))}notifyPlugins(e,o,r){return this._plugins.notify(this,e,o,r)}isPluginEnabled(e){return 1===this._plugins._cache.filter(o=>o.plugin.id===e).length}_updateHoverStyles(e,o,r){const s=this.options.hover,l=(y,C)=>y.filter(D=>!C.some(R=>D.datasetIndex===R.datasetIndex&&D.index===R.index)),h=l(o,e),f=r?e:l(e,o);h.length&&this.updateHoverStyle(h,s.mode,!1),f.length&&s.mode&&this.updateHoverStyle(f,s.mode,!0)}_eventHandler(e,o){const r={event:e,replay:o,cancelable:!0,inChartArea:this.isPointInArea(e)},s=h=>(h.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",r,s))return;const l=this._handleEvent(e,o,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(l||r.changed)&&this.render(),this}_handleEvent(e,o,r){const{_active:s=[],options:l}=this,f=this._getActiveElements(e,s,r,o),y=function aae(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}(e),C=function eue(t,n,e,o){return e&&"mouseout"!==t.type?o?n:t:null}(e,this._lastEvent,r,y);r&&(this._lastEvent=null,Qo(l.onHover,[e,f,this],this),y&&Qo(l.onClick,[e,f,this],this));const D=!ZC(f,s);return(D||o)&&(this._active=f,this._updateHoverStyles(f,s,o)),this._lastEvent=C,D}_getActiveElements(e,o,r,s){if("mouseout"===e.type)return[];if(!r)return o;const l=this.options.hover;return this.getElementsAtEventForMode(e,l.mode,l,s)}}return Nn(t,"defaults",os),Nn(t,"instances",pT),Nn(t,"overrides",Pg),Nn(t,"registry",Ud),Nn(t,"version","4.2.1"),Nn(t,"getChart",aB),t})();function lB(){return Vo(Hy.instances,t=>t._plugins.invalidate())}function $y(t,n,e,o){return{x:e+t*Math.cos(n),y:o+t*Math.sin(n)}}function fT(t,n,e,o,r,s){const{x:l,y:h,startAngle:f,pixelMargin:y,innerRadius:C}=n,D=Math.max(n.outerRadius+o+e-y,0),R=C>0?C+o+e+y:0;let V=0;const $=r-f;if(o){const Cn=((C>0?C-o:0)+(D>0?D-o:0))/2;V=($-(0!==Cn?$*Cn/(Cn+o):$))/2}const ee=($-Math.max(.001,$*D-e/fr)/D)/2,ue=f+ee+V,fe=r-ee-V,{outerStart:_e,outerEnd:Be,innerStart:et,innerEnd:gt}=function oue(t,n,e,o){const r=function iue(t){return RD(t,["outerStart","outerEnd","innerStart","innerEnd"])}(t.options.borderRadius),s=(e-n)/2,l=Math.min(s,o*n/2),h=f=>{const y=(e-Math.min(s,f))*o/2;return Bs(f,0,Math.min(s,y))};return{outerStart:h(r.outerStart),outerEnd:h(r.outerEnd),innerStart:Bs(r.innerStart,0,l),innerEnd:Bs(r.innerEnd,0,l)}}(n,R,D,fe-ue),Ht=D-_e,kt=D-Be,Kt=ue+_e/Ht,Ln=fe-Be/kt,oi=R+et,Ri=R+gt,ar=ue+et/oi,xa=fe-gt/Ri;if(t.beginPath(),s){const Oo=(Kt+Ln)/2;if(t.arc(l,h,D,Kt,Oo),t.arc(l,h,D,Oo,Ln),Be>0){const fi=$y(kt,Ln,l,h);t.arc(fi.x,fi.y,Be,Ln,fe+Vr)}const sn=$y(Ri,fe,l,h);if(t.lineTo(sn.x,sn.y),gt>0){const fi=$y(Ri,xa,l,h);t.arc(fi.x,fi.y,gt,fe+Vr,xa+Math.PI)}const Cn=(fe-gt/R+(ue+et/R))/2;if(t.arc(l,h,R,fe-gt/R,Cn,!0),t.arc(l,h,R,Cn,ue+et/R,!0),et>0){const fi=$y(oi,ar,l,h);t.arc(fi.x,fi.y,et,ar+Math.PI,ue-Vr)}const Wn=$y(Ht,ue,l,h);if(t.lineTo(Wn.x,Wn.y),_e>0){const fi=$y(Ht,Kt,l,h);t.arc(fi.x,fi.y,_e,ue-Vr,Kt)}}else{t.moveTo(l,h);const Oo=Math.cos(Kt)*D+l,sn=Math.sin(Kt)*D+h;t.lineTo(Oo,sn);const Cn=Math.cos(Ln)*D+l,Wn=Math.sin(Ln)*D+h;t.lineTo(Cn,Wn)}t.closePath()}class mT extends Pu{constructor(n){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,e,o){const r=this.getProps(["x","y"],o),{angle:s,distance:l}=UN(r,{x:n,y:e}),{startAngle:h,endAngle:f,innerRadius:y,outerRadius:C,circumference:D}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],o),R=this.options.spacing/2,$=Bi(D,f-h)>=sr||O0(s,h,f),X=rp(l,y+R,C+R);return $&&X}getCenterPoint(n){const{x:e,y:o,startAngle:r,endAngle:s,innerRadius:l,outerRadius:h}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:f,spacing:y}=this.options,C=(r+s)/2,D=(l+h+y+f)/2;return{x:e+Math.cos(C)*D,y:o+Math.sin(C)*D}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:e,circumference:o}=this,r=(e.offset||0)/4,s=(e.spacing||0)/2,l=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=o>sr?Math.floor(o/sr):0,0===o||this.innerRadius<0||this.outerRadius<0)return;n.save();const h=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(h)*r,Math.sin(h)*r);const y=r*(1-Math.sin(Math.min(fr,o||0)));n.fillStyle=e.backgroundColor,n.strokeStyle=e.borderColor,function rue(t,n,e,o,r){const{fullCircles:s,startAngle:l,circumference:h}=n;let f=n.endAngle;if(s){fT(t,n,e,o,f,r);for(let y=0;y<s;++y)t.fill();isNaN(h)||(f=l+(h%sr||sr))}fT(t,n,e,o,f,r),t.fill()}(n,this,y,s,l),function sue(t,n,e,o,r){const{fullCircles:s,startAngle:l,circumference:h,options:f}=n,{borderWidth:y,borderJoinStyle:C}=f,D="inner"===f.borderAlign;if(!y)return;D?(t.lineWidth=2*y,t.lineJoin=C||"round"):(t.lineWidth=y,t.lineJoin=C||"bevel");let R=n.endAngle;if(s){fT(t,n,e,o,R,r);for(let V=0;V<s;++V)t.stroke();isNaN(h)||(R=l+(h%sr||sr))}D&&function nue(t,n,e){const{startAngle:o,pixelMargin:r,x:s,y:l,outerRadius:h,innerRadius:f}=n;let y=r/h;t.beginPath(),t.arc(s,l,h,o-y,e+y),f>r?(y=r/f,t.arc(s,l,f,e+y,o-y,!0)):t.arc(s,l,r,e+Vr,o-Vr),t.closePath(),t.clip()}(t,n,R),s||(fT(t,n,e,o,R,r),t.stroke())}(n,this,y,s,l),n.restore()}}function cB(t,n,e=n){t.lineCap=Bi(e.borderCapStyle,n.borderCapStyle),t.setLineDash(Bi(e.borderDash,n.borderDash)),t.lineDashOffset=Bi(e.borderDashOffset,n.borderDashOffset),t.lineJoin=Bi(e.borderJoinStyle,n.borderJoinStyle),t.lineWidth=Bi(e.borderWidth,n.borderWidth),t.strokeStyle=Bi(e.borderColor,n.borderColor)}function aue(t,n,e){t.lineTo(e.x,e.y)}function uB(t,n,e={}){const o=t.length,{start:r=0,end:s=o-1}=e,{start:l,end:h}=n,f=Math.max(r,l),y=Math.min(s,h);return{count:o,start:f,loop:n.loop,ilen:y<f&&!(r<l&&s<l||r>h&&s>h)?o+y-f:y-f}}function cue(t,n,e,o){const{points:r,options:s}=n,{count:l,start:h,loop:f,ilen:y}=uB(r,e,o),C=function lue(t){return t.stepped?Mae:t.tension||"monotone"===t.cubicInterpolationMode?kae:aue}(s);let V,$,X,{move:D=!0,reverse:R}=o||{};for(V=0;V<=y;++V)$=r[(h+(R?y-V:V))%l],!$.skip&&(D?(t.moveTo($.x,$.y),D=!1):C(t,X,$,R,s.stepped),X=$);return f&&($=r[(h+(R?y:0))%l],C(t,X,$,R,s.stepped)),!!f}function uue(t,n,e,o){const r=n.points,{count:s,start:l,ilen:h}=uB(r,e,o),{move:f=!0,reverse:y}=o||{};let R,V,$,X,ee,ue,C=0,D=0;const fe=Be=>(l+(y?h-Be:Be))%s,_e=()=>{X!==ee&&(t.lineTo(C,ee),t.lineTo(C,X),t.lineTo(C,ue))};for(f&&(V=r[fe(0)],t.moveTo(V.x,V.y)),R=0;R<=h;++R){if(V=r[fe(R)],V.skip)continue;const Be=V.x,et=V.y,gt=0|Be;gt===$?(et<X?X=et:et>ee&&(ee=et),C=(D*C+Be)/++D):(_e(),t.lineTo(Be,et),$=gt,D=0,X=ee=et),ue=et}_e()}function KD(t){const n=t.options;return t._decimated||t._loop||n.tension||"monotone"===n.cubicInterpolationMode||n.stepped||n.borderDash&&n.borderDash.length?cue:uue}Nn(mT,"id","arc"),Nn(mT,"defaults",{borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Nn(mT,"defaultRoutes",{backgroundColor:"backgroundColor"});const fue="function"==typeof Path2D;let gT=(()=>{class t extends Pu{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,o){const r=this.options;!r.tension&&"monotone"!==r.cubicInterpolationMode||r.stepped||this._pointsUpdated||(ele(this._points,r,e,r.spanGaps?this._loop:this._fullLoop,o),this._pointsUpdated=!0)}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function mle(t,n){const e=t.points,o=t.options.spanGaps,r=e.length;if(!r)return[];const s=!!t._loop,{start:l,end:h}=function ple(t,n,e,o){let r=0,s=n-1;if(e&&!o)for(;r<n&&!t[r].skip;)r++;for(;r<n&&t[r].skip;)r++;for(r%=n,e&&(s+=r);s>r&&t[s%n].skip;)s--;return s%=n,{start:r,end:s}}(e,r,s,o);return function xz(t,n,e,o){return o&&o.setContext&&e?function gle(t,n,e,o){const r=t._chart.getContext(),s=wz(t.options),{_datasetIndex:l,options:{spanGaps:h}}=t,f=e.length,y=[];let C=s,D=n[0].start,R=D;function V($,X,ee,ue){const fe=h?-1:1;if($!==X){for($+=f;e[$%f].skip;)$-=fe;for(;e[X%f].skip;)X+=fe;$%f!=X%f&&(y.push({start:$%f,end:X%f,loop:ee,style:ue}),C=ue,D=X%f)}}for(const $ of n){D=h?D:$.start;let ee,X=e[D%f];for(R=D+1;R<=$.end;R++){const ue=e[R%f];ee=wz(o.setContext(Hf(r,{type:"segment",p0:X,p1:ue,p0DataIndex:(R-1)%f,p1DataIndex:R%f,datasetIndex:l}))),_le(ee,C)&&V(D,R-1,$.loop,C),X=ue,C=ee}D<R-1&&V(D,R-1,$.loop,C)}return y}(t,n,e,o):n}(t,!0===o?[{start:l,end:h,loop:s}]:function fle(t,n,e,o){const r=t.length,s=[];let f,l=n,h=t[n];for(f=n+1;f<=e;++f){const y=t[f%r];y.skip||y.stop?h.skip||(s.push({start:n%r,end:(f-1)%r,loop:o=!1}),n=l=y.stop?f:null):(l=f,h.skip&&(n=f)),h=y}return null!==l&&s.push({start:n%r,end:l%r,loop:o}),s}(e,l,h<l?h+r:h,!!t._fullLoop&&0===l&&h===r-1),e,n)}(this,this.options.segment))}first(){const e=this.segments;return e.length&&this.points[e[0].start]}last(){const e=this.segments,r=e.length;return r&&this.points[e[r-1].end]}interpolate(e,o){const r=this.options,s=e[o],l=this.points,h=bz(this,{property:o,start:s,end:s});if(!h.length)return;const f=[],y=function due(t){return t.stepped?lle:t.tension||"monotone"===t.cubicInterpolationMode?cle:zg}(r);let C,D;for(C=0,D=h.length;C<D;++C){const{start:R,end:V}=h[C],$=l[R],X=l[V];if($===X){f.push($);continue}const ue=y($,X,Math.abs((s-$[o])/(X[o]-$[o])),r.stepped);ue[o]=e[o],f.push(ue)}return 1===f.length?f[0]:f}pathSegment(e,o,r){return KD(this)(e,this,o,r)}path(e,o,r){const s=this.segments,l=KD(this);let h=this._loop;o=o||0,r=r||this.points.length-o;for(const f of s)h&=l(e,this,f,{start:o,end:o+r-1});return!!h}draw(e,o,r,s){(this.points||[]).length&&(this.options||{}).borderWidth&&(e.save(),function mue(t,n,e,o){fue&&!n.options.segment?function hue(t,n,e,o){let r=n._path;r||(r=n._path=new Path2D,n.path(r,e,o)&&r.closePath()),cB(t,n.options),t.stroke(r)}(t,n,e,o):function pue(t,n,e,o){const{segments:r,options:s}=n,l=KD(n);for(const h of r)cB(t,s,h.style),t.beginPath(),l(t,n,h,{start:e,end:e+o-1})&&t.closePath(),t.stroke()}(t,n,e,o)}(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return Nn(t,"id","line"),Nn(t,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Nn(t,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Nn(t,"descriptors",{_scriptable:!0,_indexable:n=>"borderDash"!==n&&"fill"!==n}),t})();function dB(t,n,e,o){const r=t.options,{[e]:s}=t.getProps([e],o);return Math.abs(n-s)<r.radius+r.hitRadius}let gue=(()=>{class t extends Pu{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,o,r){const s=this.options,{x:l,y:h}=this.getProps(["x","y"],r);return Math.pow(e-l,2)+Math.pow(o-h,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,o){return dB(this,e,"x",o)}inYRange(e,o){return dB(this,e,"y",o)}getCenterPoint(e){const{x:o,y:r}=this.getProps(["x","y"],e);return{x:o,y:r}}size(e){let o=(e=e||this.options||{}).radius||0;return o=Math.max(o,o&&e.hoverRadius||0),2*(o+(o&&e.borderWidth||0))}draw(e,o){const r=this.options;this.skip||r.radius<.1||!N0(this,o,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,LD(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}return Nn(t,"id","point"),Nn(t,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Nn(t,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),t})();function hB(t,n){const{x:e,y:o,base:r,width:s,height:l}=t.getProps(["x","y","base","width","height"],n);let h,f,y,C,D;return t.horizontal?(D=l/2,h=Math.min(e,r),f=Math.max(e,r),y=o-D,C=o+D):(D=s/2,h=e-D,f=e+D,y=Math.min(o,r),C=Math.max(o,r)),{left:h,top:y,right:f,bottom:C}}function Gf(t,n,e,o){return t?0:Bs(n,e,o)}function XD(t,n,e,o){const r=null===n,s=null===e,h=t&&!(r&&s)&&hB(t,o);return h&&(r||rp(n,h.left,h.right))&&(s||rp(e,h.top,h.bottom))}function xue(t,n){t.rect(n.x,n.y,n.w,n.h)}function YD(t,n,e={}){const o=t.x!==e.x?-n:0,r=t.y!==e.y?-n:0;return{x:t.x+o,y:t.y+r,w:t.w+((t.x+t.w!==e.x+e.w?n:0)-o),h:t.h+((t.y+t.h!==e.y+e.h?n:0)-r),radius:t.radius}}class _T extends Pu{constructor(n){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,n&&Object.assign(this,n)}draw(n){const{inflateAmount:e,options:{borderColor:o,backgroundColor:r}}=this,{inner:s,outer:l}=function vue(t){const n=hB(t),e=n.right-n.left,o=n.bottom-n.top,r=function _ue(t,n,e){const r=t.borderSkipped,s=iz(t.options.borderWidth);return{t:Gf(r.top,s.top,0,e),r:Gf(r.right,s.right,0,n),b:Gf(r.bottom,s.bottom,0,e),l:Gf(r.left,s.left,0,n)}}(t,e/2,o/2),s=function yue(t,n,e){const{enableBorderRadius:o}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,s=Rg(r),l=Math.min(n,e),h=t.borderSkipped,f=o||mo(r);return{topLeft:Gf(!f||h.top||h.left,s.topLeft,0,l),topRight:Gf(!f||h.top||h.right,s.topRight,0,l),bottomLeft:Gf(!f||h.bottom||h.left,s.bottomLeft,0,l),bottomRight:Gf(!f||h.bottom||h.right,s.bottomRight,0,l)}}(t,e/2,o/2);return{outer:{x:n.left,y:n.top,w:e,h:o,radius:s},inner:{x:n.left+r.l,y:n.top+r.t,w:e-r.l-r.r,h:o-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}(this),h=function bue(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}(l.radius)?z0:xue;n.save(),(l.w!==s.w||l.h!==s.h)&&(n.beginPath(),h(n,YD(l,e,s)),n.clip(),h(n,YD(s,-e,l)),n.fillStyle=o,n.fill("evenodd")),n.beginPath(),h(n,YD(s,e)),n.fillStyle=r,n.fill(),n.restore()}inRange(n,e,o){return XD(this,n,e,o)}inXRange(n,e){return XD(this,n,null,e)}inYRange(n,e){return XD(this,null,n,e)}getCenterPoint(n){const{x:e,y:o,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],n);return{x:s?(e+r)/2:e,y:s?o:(o+r)/2}}getRange(n){return"x"===n?this.width/2:this.height/2}}Nn(_T,"id","bar"),Nn(_T,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Nn(_T,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var wue=Object.freeze({__proto__:null,ArcElement:mT,LineElement:gT,PointElement:gue,BarElement:_T});const QD=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],pB=QD.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function fB(t){return QD[t%QD.length]}function mB(t){return pB[t%pB.length]}function gB(t){let n;for(n in t)if(t[n].borderColor||t[n].backgroundColor)return!0;return!1}var Due={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,n,e){if(!e.enabled)return;const{data:{datasets:o},options:r}=t.config,{elements:s}=r;if(!e.forceOverride&&(gB(o)||function Iue(t){return t&&(t.borderColor||t.backgroundColor)}(r)||s&&gB(s)))return;const l=function Eue(t){let n=0;return(e,o)=>{const r=t.getDatasetMeta(o).controller;r instanceof HD?n=function Tue(t,n){return t.backgroundColor=t.data.map(()=>fB(n++)),n}(e,n):r instanceof Fz?n=function Sue(t,n){return t.backgroundColor=t.data.map(()=>mB(n++)),n}(e,n):r&&(n=function Cue(t,n){return t.borderColor=fB(n),t.backgroundColor=mB(n),++n}(e,n))}}(t);o.forEach(l)}};function _B(t){if(t._decimated){const n=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:n})}}function yB(t){t.data.datasets.forEach(n=>{_B(n)})}var Pue={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,n,e)=>{if(!e.enabled)return void yB(t);const o=t.width;t.data.datasets.forEach((r,s)=>{const{_data:l,indexAxis:h}=r,f=t.getDatasetMeta(s),y=l||r.data;if("y"===B0([h,t.options.indexAxis])||!f.controller.supportsDecimation)return;const C=t.scales[f.xAxisID];if("linear"!==C.type&&"time"!==C.type||t.options.parsing)return;let $,{start:D,count:R}=function Aue(t,n){const e=n.length;let r,o=0;const{iScale:s}=t,{min:l,max:h,minDefined:f,maxDefined:y}=s.getUserBounds();return f&&(o=Bs(sp(n,s.axis,l).lo,0,e-1)),r=y?Bs(sp(n,s.axis,h).hi+1,o,e)-o:e-o,{start:o,count:r}}(f,y);if(R<=(e.threshold||4*o))_B(r);else{switch(Do(l)&&(r._data=y,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(X){this._data=X}})),e.algorithm){case"lttb":$=function Mue(t,n,e,o,r){const s=r.samples||o;if(s>=e)return t.slice(n,n+e);const l=[],h=(e-2)/(s-2);let f=0;const y=n+e-1;let D,R,V,$,X,C=n;for(l[f++]=t[C],D=0;D<s-2;D++){let fe,ee=0,ue=0;const _e=Math.floor((D+1)*h)+1+n,Be=Math.min(Math.floor((D+2)*h)+1,e)+n,et=Be-_e;for(fe=_e;fe<Be;fe++)ee+=t[fe].x,ue+=t[fe].y;ee/=et,ue/=et;const gt=Math.floor(D*h)+1+n,Ht=Math.min(Math.floor((D+1)*h)+1,e)+n,{x:kt,y:Kt}=t[C];for(V=$=-1,fe=gt;fe<Ht;fe++)$=.5*Math.abs((kt-ee)*(t[fe].y-Kt)-(kt-t[fe].x)*(ue-Kt)),$>V&&(V=$,R=t[fe],X=fe);l[f++]=R,C=X}return l[f++]=t[y],l}(y,D,R,o,e);break;case"min-max":$=function kue(t,n,e,o){let l,h,f,y,C,D,R,V,$,X,r=0,s=0;const ee=[],fe=t[n].x,Be=t[n+e-1].x-fe;for(l=n;l<n+e;++l){h=t[l],f=(h.x-fe)/Be*o,y=h.y;const et=0|f;if(et===C)y<$?($=y,D=l):y>X&&(X=y,R=l),r=(s*r+h.x)/++s;else{const gt=l-1;if(!Do(D)&&!Do(R)){const Ht=Math.min(D,R),kt=Math.max(D,R);Ht!==V&&Ht!==gt&&ee.push({...t[Ht],x:r}),kt!==V&&kt!==gt&&ee.push({...t[kt],x:r})}l>0&&gt!==V&&ee.push(t[gt]),ee.push(h),C=et,s=0,$=X=y,D=R=V=l}}return ee}(y,D,R,o);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}r._decimated=$}})},destroy(t){yB(t)}};function JD(t,n,e,o){if(o)return;let r=n[t],s=e[t];return"angle"===t&&(r=$l(r),s=$l(s)),{property:t,start:r,end:s}}function eM(t,n,e){for(;n>t;n--){const o=e[n];if(!isNaN(o.x)&&!isNaN(o.y))break}return n}function vB(t,n,e,o){return t&&n?o(t[e],n[e]):t?t[e]:n?n[e]:0}function bB(t,n){let e=[],o=!1;return rr(t)?(o=!0,e=t):e=function Lue(t,n){const{x:e=null,y:o=null}=t||{},r=n.points,s=[];return n.segments.forEach(({start:l,end:h})=>{h=eM(l,h,r);const f=r[l],y=r[h];null!==o?(s.push({x:f.x,y:o}),s.push({x:y.x,y:o})):null!==e&&(s.push({x:e,y:f.y}),s.push({x:e,y:y.y}))}),s}(t,n),e.length?new gT({points:e,options:{tension:0},_loop:o,_fullLoop:o}):null}function xB(t){return t&&!1!==t.fill}function Rue(t,n,e){let r=t[n].fill;const s=[n];let l;if(!e)return r;for(;!1!==r&&-1===s.indexOf(r);){if(!Br(r))return r;if(l=t[r],!l)return!1;if(l.visible)return r;s.push(r),r=l.fill}return!1}function Fue(t,n,e){const o=function Vue(t){const n=t.options,e=n.fill;let o=Bi(e&&e.target,e);return void 0===o&&(o=!!n.backgroundColor),!1!==o&&null!==o&&(!0===o?"origin":o)}(t);if(mo(o))return!isNaN(o.value)&&o;let r=parseFloat(o);return Br(r)&&Math.floor(r)===r?function Nue(t,n,e,o){return("-"===t||"+"===t)&&(e=n+e),!(e===n||e<0||e>=o)&&e}(o[0],n,r,e):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}function Hue(t,n,e){const o=[];for(let r=0;r<e.length;r++){const s=e[r],{first:l,last:h,point:f}=$ue(s,n,"x");if(!(!f||l&&h))if(l)o.unshift(f);else if(t.push(f),!h)break}t.push(...o)}function $ue(t,n,e){const o=t.interpolate(n,e);if(!o)return{};const r=o[e],s=t.segments,l=t.points;let h=!1,f=!1;for(let y=0;y<s.length;y++){const C=s[y],D=l[C.start][e],R=l[C.end][e];if(rp(r,D,R)){h=r===D,f=r===R;break}}return{first:h,last:f,point:o}}class wB{constructor(n){this.x=n.x,this.y=n.y,this.radius=n.radius}pathSegment(n,e,o){const{x:r,y:s,radius:l}=this;return n.arc(r,s,l,(e=e||{start:0,end:sr}).end,e.start,!0),!o.bounds}interpolate(n){const{x:e,y:o,radius:r}=this,s=n.angle;return{x:e+Math.cos(s)*r,y:o+Math.sin(s)*r,angle:s}}}function tM(t,n,e){const o=function Gue(t){const{chart:n,fill:e,line:o}=t;if(Br(e))return function Wue(t,n){const e=t.getDatasetMeta(n);return e&&t.isDatasetVisible(n)?e.dataset:null}(n,e);if("stack"===e)return function Uue(t){const{scale:n,index:e,line:o}=t,r=[],s=o.segments,l=o.points,h=function jue(t,n){const e=[],o=t.getMatchingVisibleMetas("line");for(let r=0;r<o.length;r++){const s=o[r];if(s.index===n)break;s.hidden||e.unshift(s.dataset)}return e}(n,e);h.push(bB({x:null,y:n.bottom},o));for(let f=0;f<s.length;f++){const y=s[f];for(let C=y.start;C<=y.end;C++)Hue(r,l[C],h)}return new gT({points:r,options:{}})}(t);if("shape"===e)return!0;const r=function que(t){return(t.scale||{}).getPointPositionForValue?function Kue(t){const{scale:n,fill:e}=t,o=n.options,r=n.getLabels().length,s=o.reverse?n.max:n.min,l=function Bue(t,n,e){let o;return o="start"===t?e:"end"===t?n.options.reverse?n.min:n.max:mo(t)?t.value:n.getBaseValue(),o}(e,n,s),h=[];if(o.grid.circular){const f=n.getPointPositionForValue(0,s);return new wB({x:f.x,y:f.y,radius:n.getDistanceFromCenterForValue(l)})}for(let f=0;f<r;++f)h.push(n.getPointPositionForValue(f,l));return h}(t):function Zue(t){const{scale:n={},fill:e}=t,o=function zue(t,n){let e=null;return"start"===t?e=n.bottom:"end"===t?e=n.top:mo(t)?e=n.getPixelForValue(t.value):n.getBasePixel&&(e=n.getBasePixel()),e}(e,n);if(Br(o)){const r=n.isHorizontal();return{x:r?o:null,y:r?null:o}}return null}(t)}(t);return r instanceof wB?r:bB(r,o)}(n),{line:r,scale:s,axis:l}=n,h=r.options,f=h.fill,y=h.backgroundColor,{above:C=y,below:D=y}=f||{};o&&r.points.length&&(eT(t,e),function Xue(t,n){const{line:e,target:o,above:r,below:s,area:l,scale:h}=n,f=e._loop?"angle":n.axis;t.save(),"x"===f&&s!==r&&(CB(t,o,l.top),TB(t,{line:e,target:o,color:r,scale:h,property:f}),t.restore(),t.save(),CB(t,o,l.bottom)),TB(t,{line:e,target:o,color:s,scale:h,property:f}),t.restore()}(t,{line:r,target:o,above:C,below:D,area:e,scale:s,axis:l}),tT(t))}function CB(t,n,e){const{segments:o,points:r}=n;let s=!0,l=!1;t.beginPath();for(const h of o){const{start:f,end:y}=h,C=r[f],D=r[eM(f,y,r)];s?(t.moveTo(C.x,C.y),s=!1):(t.lineTo(C.x,e),t.lineTo(C.x,C.y)),l=!!n.pathSegment(t,h,{move:l}),l?t.closePath():t.lineTo(D.x,e)}t.lineTo(n.first().x,e),t.closePath(),t.clip()}function TB(t,n){const{line:e,target:o,property:r,color:s,scale:l}=n,h=function Oue(t,n,e){const o=t.segments,r=t.points,s=n.points,l=[];for(const h of o){let{start:f,end:y}=h;y=eM(f,y,r);const C=JD(e,r[f],r[y],h.loop);if(!n.segments){l.push({source:h,target:C,start:r[f],end:r[y]});continue}const D=bz(n,C);for(const R of D){const V=JD(e,s[R.start],s[R.end],R.loop),$=vz(h,r,V);for(const X of $)l.push({source:X,target:R,start:{[e]:vB(C,V,"start",Math.max)},end:{[e]:vB(C,V,"end",Math.min)}})}}return l}(e,o,r);for(const{source:f,target:y,start:C,end:D}of h){const{style:{backgroundColor:R=s}={}}=f,V=!0!==o;t.save(),t.fillStyle=R,Yue(t,l,V&&JD(r,C,D)),t.beginPath();const $=!!e.pathSegment(t,f);let X;if(V){$?t.closePath():SB(t,o,D,r);const ee=!!o.pathSegment(t,y,{move:$,reverse:!0});X=$&&ee,X||SB(t,o,C,r)}t.closePath(),t.fill(X?"evenodd":"nonzero"),t.restore()}}function Yue(t,n,e){const{top:o,bottom:r}=n.chart.chartArea,{property:s,start:l,end:h}=e||{};"x"===s&&(t.beginPath(),t.rect(l,o,h-l,r-o),t.clip())}function SB(t,n,e,o){const r=n.interpolate(e,o);r&&t.lineTo(r.x,r.y)}var Que={id:"filler",afterDatasetsUpdate(t,n,e){const o=(t.data.datasets||[]).length,r=[];let s,l,h,f;for(l=0;l<o;++l)s=t.getDatasetMeta(l),h=s.dataset,f=null,h&&h.options&&h instanceof gT&&(f={visible:t.isDatasetVisible(l),index:l,fill:Fue(h,l,o),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:h}),s.$filler=f,r.push(f);for(l=0;l<o;++l)f=r[l],f&&!1!==f.fill&&(f.fill=Rue(r,l,e.propagate))},beforeDraw(t,n,e){const o="beforeDraw"===e.drawTime,r=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let l=r.length-1;l>=0;--l){const h=r[l].$filler;h&&(h.line.updateControlPoints(s,h.axis),o&&h.fill&&tM(t.ctx,h,s))}},beforeDatasetsDraw(t,n,e){if("beforeDatasetsDraw"!==e.drawTime)return;const o=t.getSortedVisibleDatasetMetas();for(let r=o.length-1;r>=0;--r){const s=o[r].$filler;xB(s)&&tM(t.ctx,s,t.chartArea)}},beforeDatasetDraw(t,n,e){const o=n.meta.$filler;!xB(o)||"beforeDatasetDraw"!==e.drawTime||tM(t.ctx,o,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const EB=(t,n)=>{let{boxHeight:e=n,boxWidth:o=n}=t;return t.usePointStyle&&(e=Math.min(e,n),o=t.pointStyleWidth||Math.min(o,n)),{boxWidth:o,boxHeight:e,itemHeight:Math.max(n,e)}};class IB extends Pu{constructor(n){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,e,o){this.maxWidth=n,this.maxHeight=e,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const n=this.options.labels||{};let e=Qo(n.generateLabels,[this.chart],this)||[];n.filter&&(e=e.filter(o=>n.filter(o,this.chart.data))),n.sort&&(e=e.sort((o,r)=>n.sort(o,r,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:n,ctx:e}=this;if(!n.display)return void(this.width=this.height=0);const o=n.labels,r=Is(o.font),s=r.size,l=this._computeTitleHeight(),{boxWidth:h,itemHeight:f}=EB(o,s);let y,C;e.font=r.string,this.isHorizontal()?(y=this.maxWidth,C=this._fitRows(l,s,h,f)+10):(C=this.maxHeight,y=this._fitCols(l,r,h,f)+10),this.width=Math.min(y,n.maxWidth||this.maxWidth),this.height=Math.min(C,n.maxHeight||this.maxHeight)}_fitRows(n,e,o,r){const{ctx:s,maxWidth:l,options:{labels:{padding:h}}}=this,f=this.legendHitBoxes=[],y=this.lineWidths=[0],C=r+h;let D=n;s.textAlign="left",s.textBaseline="middle";let R=-1,V=-C;return this.legendItems.forEach(($,X)=>{const ee=o+e/2+s.measureText($.text).width;(0===X||y[y.length-1]+ee+2*h>l)&&(D+=C,y[y.length-(X>0?0:1)]=0,V+=C,R++),f[X]={left:0,top:V,row:R,width:ee,height:r},y[y.length-1]+=ee+h}),D}_fitCols(n,e,o,r){const{ctx:s,maxHeight:l,options:{labels:{padding:h}}}=this,f=this.legendHitBoxes=[],y=this.columnSizes=[],C=l-n;let D=h,R=0,V=0,$=0,X=0;return this.legendItems.forEach((ee,ue)=>{const{itemWidth:fe,itemHeight:_e}=function ede(t,n,e,o,r){const s=function tde(t,n,e,o){let r=t.text;return r&&"string"!=typeof r&&(r=r.reduce((s,l)=>s.length>l.length?s:l)),n+e.size/2+o.measureText(r).width}(o,t,n,e),l=function nde(t,n,e){let o=t;return"string"!=typeof n.text&&(o=DB(n,e)),o}(r,o,n.lineHeight);return{itemWidth:s,itemHeight:l}}(o,e,s,ee,r);ue>0&&V+_e+2*h>C&&(D+=R+h,y.push({width:R,height:V}),$+=R+h,X++,R=V=0),f[ue]={left:$,top:V,col:X,width:fe,height:_e},R=Math.max(R,fe),V+=_e+h}),D+=R,y.push({width:R,height:V}),D}adjustHitBoxes(){if(!this.options.display)return;const n=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:o,labels:{padding:r},rtl:s}}=this,l=jy(s,this.left,this.width);if(this.isHorizontal()){let h=0,f=ya(o,this.left+r,this.right-this.lineWidths[h]);for(const y of e)h!==y.row&&(h=y.row,f=ya(o,this.left+r,this.right-this.lineWidths[h])),y.top+=this.top+n+r,y.left=l.leftForLtr(l.x(f),y.width),f+=y.width+r}else{let h=0,f=ya(o,this.top+n+r,this.bottom-this.columnSizes[h].height);for(const y of e)y.col!==h&&(h=y.col,f=ya(o,this.top+n+r,this.bottom-this.columnSizes[h].height)),y.top=f,y.left+=this.left+r,y.left=l.leftForLtr(l.x(y.left),y.width),f+=y.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const n=this.ctx;eT(n,this),this._draw(),tT(n)}}_draw(){const{options:n,columnSizes:e,lineWidths:o,ctx:r}=this,{align:s,labels:l}=n,h=os.color,f=jy(n.rtl,this.left,this.width),y=Is(l.font),{padding:C}=l,D=y.size,R=D/2;let V;this.drawTitle(),r.textAlign=f.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=y.string;const{boxWidth:$,boxHeight:X,itemHeight:ee}=EB(l,D),_e=this.isHorizontal(),Be=this._computeTitleHeight();V=_e?{x:ya(s,this.left+C,this.right-o[0]),y:this.top+C+Be,line:0}:{x:this.left+C,y:ya(s,this.top+Be+C,this.bottom-e[0].height),line:0},mz(this.ctx,n.textDirection);const et=ee+C;this.legendItems.forEach((gt,Ht)=>{r.strokeStyle=gt.fontColor,r.fillStyle=gt.fontColor;const kt=r.measureText(gt.text).width,Kt=f.textAlign(gt.textAlign||(gt.textAlign=l.textAlign)),Ln=$+R+kt;let oi=V.x,Ri=V.y;f.setWidth(this.width),_e?Ht>0&&oi+Ln+C>this.right&&(Ri=V.y+=et,V.line++,oi=V.x=ya(s,this.left+C,this.right-o[V.line])):Ht>0&&Ri+et>this.bottom&&(oi=V.x=oi+e[V.line].width+C,V.line++,Ri=V.y=ya(s,this.top+Be+C,this.bottom-e[V.line].height)),function(gt,Ht,kt){if(isNaN($)||$<=0||isNaN(X)||X<0)return;r.save();const Kt=Bi(kt.lineWidth,1);if(r.fillStyle=Bi(kt.fillStyle,h),r.lineCap=Bi(kt.lineCap,"butt"),r.lineDashOffset=Bi(kt.lineDashOffset,0),r.lineJoin=Bi(kt.lineJoin,"miter"),r.lineWidth=Kt,r.strokeStyle=Bi(kt.strokeStyle,h),r.setLineDash(Bi(kt.lineDash,[])),l.usePointStyle){const Ln={radius:X*Math.SQRT2/2,pointStyle:kt.pointStyle,rotation:kt.rotation,borderWidth:Kt},oi=f.xPlus(gt,$/2);nz(r,Ln,oi,Ht+R,l.pointStyleWidth&&$)}else{const Ln=Ht+Math.max((D-X)/2,0),oi=f.leftForLtr(gt,$),Ri=Rg(kt.borderRadius);r.beginPath(),Object.values(Ri).some(ar=>0!==ar)?z0(r,{x:oi,y:Ln,w:$,h:X,radius:Ri}):r.rect(oi,Ln,$,X),r.fill(),0!==Kt&&r.stroke()}r.restore()}(f.x(oi),Ri,gt),oi=((t,n,e,o)=>t===(o?"left":"right")?e:"center"===t?(n+e)/2:n)(Kt,oi+$+R,_e?oi+Ln:this.right,n.rtl),function(gt,Ht,kt){Lg(r,kt.text,gt,Ht+ee/2,y,{strikethrough:kt.hidden,textAlign:f.textAlign(kt.textAlign)})}(f.x(oi),Ri,gt),_e?V.x+=Ln+C:V.y+="string"!=typeof gt.text?DB(gt,y.lineHeight):et}),gz(this.ctx,n.textDirection)}drawTitle(){const n=this.options,e=n.title,o=Is(e.font),r=va(e.padding);if(!e.display)return;const s=jy(n.rtl,this.left,this.width),l=this.ctx,h=e.position,y=r.top+o.size/2;let C,D=this.left,R=this.width;if(this.isHorizontal())R=Math.max(...this.lineWidths),C=this.top+y,D=ya(n.align,D,this.right-R);else{const $=this.columnSizes.reduce((X,ee)=>Math.max(X,ee.height),0);C=y+ya(n.align,this.top,this.bottom-$-n.labels.padding-this._computeTitleHeight())}const V=ya(h,D,D+R);l.textAlign=s.textAlign(kD(h)),l.textBaseline="middle",l.strokeStyle=e.color,l.fillStyle=e.color,l.font=o.string,Lg(l,e.text,V,C,o)}_computeTitleHeight(){const n=this.options.title,e=Is(n.font),o=va(n.padding);return n.display?e.lineHeight+o.height:0}_getLegendItemAt(n,e){let o,r,s;if(rp(n,this.left,this.right)&&rp(e,this.top,this.bottom))for(s=this.legendHitBoxes,o=0;o<s.length;++o)if(r=s[o],rp(n,r.left,r.left+r.width)&&rp(e,r.top,r.top+r.height))return this.legendItems[o];return null}handleEvent(n){const e=this.options;if(!function ide(t,n){return!(("mousemove"!==t&&"mouseout"!==t||!n.onHover&&!n.onLeave)&&(!n.onClick||"click"!==t&&"mouseup"!==t))}(n.type,e))return;const o=this._getLegendItemAt(n.x,n.y);if("mousemove"===n.type||"mouseout"===n.type){const r=this._hoveredItem,s=((t,n)=>null!==t&&null!==n&&t.datasetIndex===n.datasetIndex&&t.index===n.index)(r,o);r&&!s&&Qo(e.onLeave,[n,r,this],this),this._hoveredItem=o,o&&!s&&Qo(e.onHover,[n,o,this],this)}else o&&Qo(e.onClick,[n,o,this],this)}}function DB(t,n){return n*(t.text?t.text.length+.5:0)}var ode={id:"legend",_element:IB,start(t,n,e){const o=t.legend=new IB({ctx:t.ctx,options:e,chart:t});ba.configure(t,o,e),ba.addBox(t,o)},stop(t){ba.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,n,e){const o=t.legend;ba.configure(t,o,e),o.options=e},afterUpdate(t){const n=t.legend;n.buildLabels(),n.adjustHitBoxes()},afterEvent(t,n){n.replay||t.legend.handleEvent(n.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,n,e){const o=n.datasetIndex,r=e.chart;r.isDatasetVisible(o)?(r.hide(o),n.hidden=!0):(r.show(o),n.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const n=t.data.datasets,{labels:{usePointStyle:e,pointStyle:o,textAlign:r,color:s,useBorderRadius:l,borderRadius:h}}=t.legend.options;return t._getSortedDatasetMetas().map(f=>{const y=f.controller.getStyle(e?0:void 0),C=va(y.borderWidth);return{text:n[f.index].label,fillStyle:y.backgroundColor,fontColor:s,hidden:!f.visible,lineCap:y.borderCapStyle,lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:(C.width+C.height)/4,strokeStyle:y.borderColor,pointStyle:o||y.pointStyle,rotation:y.rotation,textAlign:r||y.textAlign,borderRadius:l&&(h||y.borderRadius),datasetIndex:f.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class nM extends Pu{constructor(n){super(),this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,e){const o=this.options;if(this.left=0,this.top=0,!o.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=n,this.height=this.bottom=e;const r=rr(o.text)?o.text.length:1;this._padding=va(o.padding);const s=r*Is(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const n=this.options.position;return"top"===n||"bottom"===n}_drawArgs(n){const{top:e,left:o,bottom:r,right:s,options:l}=this,h=l.align;let y,C,D,f=0;return this.isHorizontal()?(C=ya(h,o,s),D=e+n,y=s-o):("left"===l.position?(C=o+n,D=ya(h,r,e),f=-.5*fr):(C=s-n,D=ya(h,e,r),f=.5*fr),y=r-e),{titleX:C,titleY:D,maxWidth:y,rotation:f}}draw(){const n=this.ctx,e=this.options;if(!e.display)return;const o=Is(e.font),s=o.lineHeight/2+this._padding.top,{titleX:l,titleY:h,maxWidth:f,rotation:y}=this._drawArgs(s);Lg(n,e.text,0,0,o,{color:e.color,maxWidth:f,rotation:y,textAlign:kD(e.align),textBaseline:"middle",translation:[l,h]})}}var sde={id:"title",_element:nM,start(t,n,e){!function rde(t,n){const e=new nM({ctx:t.ctx,options:n,chart:t});ba.configure(t,e,n),ba.addBox(t,e),t.titleBlock=e}(t,e)},stop(t){ba.removeBox(t,t.titleBlock),delete t.titleBlock},beforeUpdate(t,n,e){const o=t.titleBlock;ba.configure(t,o,e),o.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const yT=new WeakMap;var ade={id:"subtitle",start(t,n,e){const o=new nM({ctx:t.ctx,options:e,chart:t});ba.configure(t,o,e),ba.addBox(t,o),yT.set(t,o)},stop(t){ba.removeBox(t,yT.get(t)),yT.delete(t)},beforeUpdate(t,n,e){const o=yT.get(t);ba.configure(t,o,e),o.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Z0={average(t){if(!t.length)return!1;let n,e,o=0,r=0,s=0;for(n=0,e=t.length;n<e;++n){const l=t[n].element;if(l&&l.hasValue()){const h=l.tooltipPosition();o+=h.x,r+=h.y,++s}}return{x:o/s,y:r/s}},nearest(t,n){if(!t.length)return!1;let s,l,h,e=n.x,o=n.y,r=Number.POSITIVE_INFINITY;for(s=0,l=t.length;s<l;++s){const f=t[s].element;if(f&&f.hasValue()){const C=DD(n,f.getCenterPoint());C<r&&(r=C,h=f)}}if(h){const f=h.tooltipPosition();e=f.x,o=f.y}return{x:e,y:o}}};function jd(t,n){return n&&(rr(n)?Array.prototype.push.apply(t,n):t.push(n)),t}function lp(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function lde(t,n){const{element:e,datasetIndex:o,index:r}=n,s=t.getDatasetMeta(o).controller,{label:l,value:h}=s.getLabelAndValue(r);return{chart:t,label:l,parsed:s.getParsed(r),raw:t.data.datasets[o].data[r],formattedValue:h,dataset:s.getDataset(),dataIndex:r,datasetIndex:o,element:e}}function MB(t,n){const e=t.chart.ctx,{body:o,footer:r,title:s}=t,{boxWidth:l,boxHeight:h}=n,f=Is(n.bodyFont),y=Is(n.titleFont),C=Is(n.footerFont),D=s.length,R=r.length,V=o.length,$=va(n.padding);let X=$.height,ee=0,ue=o.reduce((Be,et)=>Be+et.before.length+et.lines.length+et.after.length,0);ue+=t.beforeBody.length+t.afterBody.length,D&&(X+=D*y.lineHeight+(D-1)*n.titleSpacing+n.titleMarginBottom),ue&&(X+=V*(n.displayColors?Math.max(h,f.lineHeight):f.lineHeight)+(ue-V)*f.lineHeight+(ue-1)*n.bodySpacing),R&&(X+=n.footerMarginTop+R*C.lineHeight+(R-1)*n.footerSpacing);let fe=0;const _e=function(Be){ee=Math.max(ee,e.measureText(Be).width+fe)};return e.save(),e.font=y.string,Vo(t.title,_e),e.font=f.string,Vo(t.beforeBody.concat(t.afterBody),_e),fe=n.displayColors?l+2+n.boxPadding:0,Vo(o,Be=>{Vo(Be.before,_e),Vo(Be.lines,_e),Vo(Be.after,_e)}),fe=0,e.font=C.string,Vo(t.footer,_e),e.restore(),ee+=$.width,{width:ee,height:X}}function dde(t,n,e,o){const{x:r,width:s}=e,{width:l,chartArea:{left:h,right:f}}=t;let y="center";return"center"===o?y=r<=(h+f)/2?"left":"right":r<=s/2?y="left":r>=l-s/2&&(y="right"),function ude(t,n,e,o){const{x:r,width:s}=o,l=e.caretSize+e.caretPadding;if("left"===t&&r+s+l>n.width||"right"===t&&r-s-l<0)return!0}(y,t,n,e)&&(y="center"),y}function kB(t,n,e){const o=e.yAlign||n.yAlign||function cde(t,n){const{y:e,height:o}=n;return e<o/2?"top":e>t.height-o/2?"bottom":"center"}(t,e);return{xAlign:e.xAlign||n.xAlign||dde(t,n,e,o),yAlign:o}}function AB(t,n,e,o){const{caretSize:r,caretPadding:s,cornerRadius:l}=t,{xAlign:h,yAlign:f}=e,y=r+s,{topLeft:C,topRight:D,bottomLeft:R,bottomRight:V}=Rg(l);let $=function hde(t,n){let{x:e,width:o}=t;return"right"===n?e-=o:"center"===n&&(e-=o/2),e}(n,h);const X=function pde(t,n,e){let{y:o,height:r}=t;return"top"===n?o+=e:o-="bottom"===n?r+e:r/2,o}(n,f,y);return"center"===f?"left"===h?$+=y:"right"===h&&($-=y):"left"===h?$-=Math.max(C,R)+r:"right"===h&&($+=Math.max(D,V)+r),{x:Bs($,0,o.width-n.width),y:Bs(X,0,o.height-n.height)}}function vT(t,n,e){const o=va(e.padding);return"center"===n?t.x+t.width/2:"right"===n?t.x+t.width-o.right:t.x+o.left}function PB(t){return jd([],lp(t))}function OB(t,n){const e=n&&n.dataset&&n.dataset.tooltip&&n.dataset.tooltip.callbacks;return e?t.override(e):t}const LB={beforeTitle:op,title(t){if(t.length>0){const n=t[0],e=n.chart.data.labels,o=e?e.length:0;if(this&&this.options&&"dataset"===this.options.mode)return n.dataset.label||"";if(n.label)return n.label;if(o>0&&n.dataIndex<o)return e[n.dataIndex]}return""},afterTitle:op,beforeBody:op,beforeLabel:op,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let n=t.dataset.label||"";n&&(n+=": ");const e=t.formattedValue;return Do(e)||(n+=e),n},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:op,afterBody:op,beforeFooter:op,footer:op,afterFooter:op};function yl(t,n,e,o){const r=t[n].call(e,o);return typeof r>"u"?LB[n].call(e,o):r}let RB=(()=>{class t extends Pu{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const o=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&o.options.animation&&r.animations,l=new Tz(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=function fde(t,n,e){return Hf(t,{tooltip:n,tooltipItems:e,type:"tooltip"})}(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,o){const{callbacks:r}=o,s=yl(r,"beforeTitle",this,e),l=yl(r,"title",this,e),h=yl(r,"afterTitle",this,e);let f=[];return f=jd(f,lp(s)),f=jd(f,lp(l)),f=jd(f,lp(h)),f}getBeforeBody(e,o){return PB(yl(o.callbacks,"beforeBody",this,e))}getBody(e,o){const{callbacks:r}=o,s=[];return Vo(e,l=>{const h={before:[],lines:[],after:[]},f=OB(r,l);jd(h.before,lp(yl(f,"beforeLabel",this,l))),jd(h.lines,yl(f,"label",this,l)),jd(h.after,lp(yl(f,"afterLabel",this,l))),s.push(h)}),s}getAfterBody(e,o){return PB(yl(o.callbacks,"afterBody",this,e))}getFooter(e,o){const{callbacks:r}=o,s=yl(r,"beforeFooter",this,e),l=yl(r,"footer",this,e),h=yl(r,"afterFooter",this,e);let f=[];return f=jd(f,lp(s)),f=jd(f,lp(l)),f=jd(f,lp(h)),f}_createItems(e){const o=this._active,r=this.chart.data,s=[],l=[],h=[];let y,C,f=[];for(y=0,C=o.length;y<C;++y)f.push(lde(this.chart,o[y]));return e.filter&&(f=f.filter((D,R,V)=>e.filter(D,R,V,r))),e.itemSort&&(f=f.sort((D,R)=>e.itemSort(D,R,r))),Vo(f,D=>{const R=OB(e.callbacks,D);s.push(yl(R,"labelColor",this,D)),l.push(yl(R,"labelPointStyle",this,D)),h.push(yl(R,"labelTextColor",this,D))}),this.labelColors=s,this.labelPointStyles=l,this.labelTextColors=h,this.dataPoints=f,f}update(e,o){const r=this.options.setContext(this.getContext()),s=this._active;let l,h=[];if(s.length){const f=Z0[r.position].call(this,s,this._eventPosition);h=this._createItems(r),this.title=this.getTitle(h,r),this.beforeBody=this.getBeforeBody(h,r),this.body=this.getBody(h,r),this.afterBody=this.getAfterBody(h,r),this.footer=this.getFooter(h,r);const y=this._size=MB(this,r),C=Object.assign({},f,y),D=kB(this.chart,r,C),R=AB(r,C,D,this.chart);this.xAlign=D.xAlign,this.yAlign=D.yAlign,l={opacity:1,x:R.x,y:R.y,width:y.width,height:y.height,caretX:f.x,caretY:f.y}}else 0!==this.opacity&&(l={opacity:0});this._tooltipItems=h,this.$context=void 0,l&&this._resolveAnimations().update(this,l),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:o})}drawCaret(e,o,r,s){const l=this.getCaretPosition(e,r,s);o.lineTo(l.x1,l.y1),o.lineTo(l.x2,l.y2),o.lineTo(l.x3,l.y3)}getCaretPosition(e,o,r){const{xAlign:s,yAlign:l}=this,{caretSize:h,cornerRadius:f}=r,{topLeft:y,topRight:C,bottomLeft:D,bottomRight:R}=Rg(f),{x:V,y:$}=e,{width:X,height:ee}=o;let ue,fe,_e,Be,et,gt;return"center"===l?(et=$+ee/2,"left"===s?(ue=V,fe=ue-h,Be=et+h,gt=et-h):(ue=V+X,fe=ue+h,Be=et-h,gt=et+h),_e=ue):(fe="left"===s?V+Math.max(y,D)+h:"right"===s?V+X-Math.max(C,R)-h:this.caretX,"top"===l?(Be=$,et=Be-h,ue=fe-h,_e=fe+h):(Be=$+ee,et=Be+h,ue=fe+h,_e=fe-h),gt=Be),{x1:ue,x2:fe,x3:_e,y1:Be,y2:et,y3:gt}}drawTitle(e,o,r){const s=this.title,l=s.length;let h,f,y;if(l){const C=jy(r.rtl,this.x,this.width);for(e.x=vT(this,r.titleAlign,r),o.textAlign=C.textAlign(r.titleAlign),o.textBaseline="middle",h=Is(r.titleFont),f=r.titleSpacing,o.fillStyle=r.titleColor,o.font=h.string,y=0;y<l;++y)o.fillText(s[y],C.x(e.x),e.y+h.lineHeight/2),e.y+=h.lineHeight+f,y+1===l&&(e.y+=r.titleMarginBottom-f)}}_drawColorBox(e,o,r,s,l){const h=this.labelColors[r],f=this.labelPointStyles[r],{boxHeight:y,boxWidth:C,boxPadding:D}=l,R=Is(l.bodyFont),V=vT(this,"left",l),$=s.x(V),ee=o.y+(y<R.lineHeight?(R.lineHeight-y)/2:0);if(l.usePointStyle){const ue={radius:Math.min(C,y)/2,pointStyle:f.pointStyle,rotation:f.rotation,borderWidth:1},fe=s.leftForLtr($,C)+C/2,_e=ee+y/2;e.strokeStyle=l.multiKeyBackground,e.fillStyle=l.multiKeyBackground,LD(e,ue,fe,_e),e.strokeStyle=h.borderColor,e.fillStyle=h.backgroundColor,LD(e,ue,fe,_e)}else{e.lineWidth=mo(h.borderWidth)?Math.max(...Object.values(h.borderWidth)):h.borderWidth||1,e.strokeStyle=h.borderColor,e.setLineDash(h.borderDash||[]),e.lineDashOffset=h.borderDashOffset||0;const ue=s.leftForLtr($,C-D),fe=s.leftForLtr(s.xPlus($,1),C-D-2),_e=Rg(h.borderRadius);Object.values(_e).some(Be=>0!==Be)?(e.beginPath(),e.fillStyle=l.multiKeyBackground,z0(e,{x:ue,y:ee,w:C,h:y,radius:_e}),e.fill(),e.stroke(),e.fillStyle=h.backgroundColor,e.beginPath(),z0(e,{x:fe,y:ee+1,w:C-2,h:y-2,radius:_e}),e.fill()):(e.fillStyle=l.multiKeyBackground,e.fillRect(ue,ee,C,y),e.strokeRect(ue,ee,C,y),e.fillStyle=h.backgroundColor,e.fillRect(fe,ee+1,C-2,y-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,o,r){const{body:s}=this,{bodySpacing:l,bodyAlign:h,displayColors:f,boxHeight:y,boxWidth:C,boxPadding:D}=r,R=Is(r.bodyFont);let V=R.lineHeight,$=0;const X=jy(r.rtl,this.x,this.width),ee=function(Kt){o.fillText(Kt,X.x(e.x+$),e.y+V/2),e.y+=V+l},ue=X.textAlign(h);let fe,_e,Be,et,gt,Ht,kt;for(o.textAlign=h,o.textBaseline="middle",o.font=R.string,e.x=vT(this,ue,r),o.fillStyle=r.bodyColor,Vo(this.beforeBody,ee),$=f&&"right"!==ue?"center"===h?C/2+D:C+2+D:0,et=0,Ht=s.length;et<Ht;++et){for(fe=s[et],_e=this.labelTextColors[et],o.fillStyle=_e,Vo(fe.before,ee),Be=fe.lines,f&&Be.length&&(this._drawColorBox(o,e,et,X,r),V=Math.max(R.lineHeight,y)),gt=0,kt=Be.length;gt<kt;++gt)ee(Be[gt]),V=R.lineHeight;Vo(fe.after,ee)}$=0,V=R.lineHeight,Vo(this.afterBody,ee),e.y-=l}drawFooter(e,o,r){const s=this.footer,l=s.length;let h,f;if(l){const y=jy(r.rtl,this.x,this.width);for(e.x=vT(this,r.footerAlign,r),e.y+=r.footerMarginTop,o.textAlign=y.textAlign(r.footerAlign),o.textBaseline="middle",h=Is(r.footerFont),o.fillStyle=r.footerColor,o.font=h.string,f=0;f<l;++f)o.fillText(s[f],y.x(e.x),e.y+h.lineHeight/2),e.y+=h.lineHeight+r.footerSpacing}}drawBackground(e,o,r,s){const{xAlign:l,yAlign:h}=this,{x:f,y}=e,{width:C,height:D}=r,{topLeft:R,topRight:V,bottomLeft:$,bottomRight:X}=Rg(s.cornerRadius);o.fillStyle=s.backgroundColor,o.strokeStyle=s.borderColor,o.lineWidth=s.borderWidth,o.beginPath(),o.moveTo(f+R,y),"top"===h&&this.drawCaret(e,o,r,s),o.lineTo(f+C-V,y),o.quadraticCurveTo(f+C,y,f+C,y+V),"center"===h&&"right"===l&&this.drawCaret(e,o,r,s),o.lineTo(f+C,y+D-X),o.quadraticCurveTo(f+C,y+D,f+C-X,y+D),"bottom"===h&&this.drawCaret(e,o,r,s),o.lineTo(f+$,y+D),o.quadraticCurveTo(f,y+D,f,y+D-$),"center"===h&&"left"===l&&this.drawCaret(e,o,r,s),o.lineTo(f,y+R),o.quadraticCurveTo(f,y,f+R,y),o.closePath(),o.fill(),s.borderWidth>0&&o.stroke()}_updateAnimationTarget(e){const o=this.chart,r=this.$animations,s=r&&r.x,l=r&&r.y;if(s||l){const h=Z0[e.position].call(this,this._active,this._eventPosition);if(!h)return;const f=this._size=MB(this,e),y=Object.assign({},h,this._size),C=kB(o,e,y),D=AB(e,y,C,o);(s._to!==D.x||l._to!==D.y)&&(this.xAlign=C.xAlign,this.yAlign=C.yAlign,this.width=f.width,this.height=f.height,this.caretX=h.x,this.caretY=h.y,this._resolveAnimations().update(this,D))}}_willRender(){return!!this.opacity}draw(e){const o=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(o);const s={width:this.width,height:this.height},l={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const h=va(o.padding);o.enabled&&(this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length)&&(e.save(),e.globalAlpha=r,this.drawBackground(l,e,s,o),mz(e,o.textDirection),l.y+=h.top,this.drawTitle(l,e,o),this.drawBody(l,e,o),this.drawFooter(l,e,o),gz(e,o.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,o){const r=this._active,s=e.map(({datasetIndex:f,index:y})=>{const C=this.chart.getDatasetMeta(f);if(!C)throw new Error("Cannot find a dataset at index "+f);return{datasetIndex:f,element:C.data[y],index:y}}),l=!ZC(r,s),h=this._positionChanged(s,o);(l||h)&&(this._active=s,this._eventPosition=o,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,o,r=!0){if(o&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,l=this._active||[],h=this._getActiveElements(e,l,o,r),f=this._positionChanged(h,e),y=o||!ZC(h,l)||f;return y&&(this._active=h,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,o))),y}_getActiveElements(e,o,r,s){const l=this.options;if("mouseout"===e.type)return[];if(!s)return o;const h=this.chart.getElementsAtEventForMode(e,l.mode,l,r);return l.reverse&&h.reverse(),h}_positionChanged(e,o){const{caretX:r,caretY:s,options:l}=this,h=Z0[l.position].call(this,e,o);return!1!==h&&(r!==h.x||s!==h.y)}}return Nn(t,"positioners",Z0),t})();var mde={id:"tooltip",_element:RB,positioners:Z0,afterInit(t,n,e){e&&(t.tooltip=new RB({chart:t,options:e}))},beforeUpdate(t,n,e){t.tooltip&&t.tooltip.initialize(e)},reset(t,n,e){t.tooltip&&t.tooltip.initialize(e)},afterDraw(t){const n=t.tooltip;if(n&&n._willRender()){const e={tooltip:n};if(!1===t.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0}))return;n.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",e)}},afterEvent(t,n){t.tooltip&&t.tooltip.handleEvent(n.event,n.replay,n.inChartArea)&&(n.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,n)=>n.bodyFont.size,boxWidth:(t,n)=>n.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:LB},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},gde=Object.freeze({__proto__:null,Colors:Due,Decimation:Pue,Filler:Que,Legend:ode,SubTitle:ade,Title:sde,Tooltip:mde});function FB(t){const n=this.getLabels();return t>=0&&t<n.length?n[t]:t}let bde=(()=>{class t extends Vg{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const o=this._addedLabels;if(o.length){const r=this.getLabels();for(const{index:s,label:l}of o)r[s]===l&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,o){if(Do(e))return null;const r=this.getLabels();return o=isFinite(o)&&r[o]===e?o:function yde(t,n,e,o){const r=t.indexOf(n);return-1===r?((t,n,e,o)=>("string"==typeof n?(e=t.push(n)-1,o.unshift({index:e,label:n})):isNaN(n)&&(e=null),e))(t,n,e,o):r!==t.lastIndexOf(n)?e:r}(r,e,Bi(o,e),this._addedLabels),((t,n)=>null===t?null:Bs(Math.round(t),0,n))(o,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:o}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(r=0),o||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,o=this.max,r=this.options.offset,s=[];let l=this.getLabels();l=0===e&&o===l.length-1?l:l.slice(e,o+1),this._valueRange=Math.max(l.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let h=e;h<=o;h++)s.push({value:h});return s}getLabelForValue(e){return FB.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!=typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const o=this.ticks;return e<0||e>o.length-1?null:this.getPixelForValue(o[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}return Nn(t,"id","category"),Nn(t,"defaults",{ticks:{callback:FB}}),t})();function NB(t,n,{horizontal:e,minRotation:o}){const r=Au(o),s=(e?Math.sin(r):Math.cos(r))||.001;return Math.min(n/s,.75*n*(""+t).length)}class bT extends Vg{constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(n,e){return Do(n)||("number"==typeof n||n instanceof Number)&&!isFinite(+n)?null:+n}handleTickRangeOptions(){const{beginAtZero:n}=this.options,{minDefined:e,maxDefined:o}=this.getUserBounds();let{min:r,max:s}=this;const l=f=>r=e?r:f,h=f=>s=o?s:f;if(n){const f=Vd(r),y=Vd(s);f<0&&y<0?h(0):f>0&&y>0&&l(0)}if(r===s){let f=0===s?1:Math.abs(.05*s);h(s+f),n||l(r-f)}this.min=r,this.max=s}getTickLimit(){const n=this.options.ticks;let r,{maxTicksLimit:e,stepSize:o}=n;return o?(r=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),e=e||11),e&&(r=Math.min(e,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const n=this.options,e=n.ticks;let o=this.getTickLimit();o=Math.max(2,o);const l=function xde(t,n){const e=[],{bounds:r,step:s,min:l,max:h,precision:f,count:y,maxTicks:C,maxDigits:D,includeBounds:R}=t,V=s||1,$=C-1,{min:X,max:ee}=n,ue=!Do(l),fe=!Do(h),_e=!Do(y),Be=(ee-X)/(D+1);let gt,Ht,kt,Kt,et=zN((ee-X)/$/V)*V;if(et<1e-14&&!ue&&!fe)return[{value:X},{value:ee}];Kt=Math.ceil(ee/et)-Math.floor(X/et),Kt>$&&(et=zN(Kt*et/$/V)*V),Do(f)||(gt=Math.pow(10,f),et=Math.ceil(et*gt)/gt),"ticks"===r?(Ht=Math.floor(X/et)*et,kt=Math.ceil(ee/et)*et):(Ht=X,kt=ee),ue&&fe&&s&&function dae(t,n){const e=Math.round(t);return e-n<=t&&e+n>=t}((h-l)/s,et/1e3)?(Kt=Math.round(Math.min((h-l)/et,C)),et=(h-l)/Kt,Ht=l,kt=h):_e?(Ht=ue?l:Ht,kt=fe?h:kt,Kt=y-1,et=(kt-Ht)/Kt):(Kt=(kt-Ht)/et,Kt=P0(Kt,Math.round(Kt),et/1e3)?Math.round(Kt):Math.ceil(Kt));const Ln=Math.max(VN(et),VN(Ht));gt=Math.pow(10,Do(f)?Ln:f),Ht=Math.round(Ht*gt)/gt,kt=Math.round(kt*gt)/gt;let oi=0;for(ue&&(R&&Ht!==l?(e.push({value:l}),Ht<l&&oi++,P0(Math.round((Ht+oi*et)*gt)/gt,l,NB(l,Be,t))&&oi++):Ht<l&&oi++);oi<Kt;++oi)e.push({value:Math.round((Ht+oi*et)*gt)/gt});return fe&&R&&kt!==h?e.length&&P0(e[e.length-1].value,h,NB(h,Be,t))?e[e.length-1].value=h:e.push({value:h}):(!fe||kt===h)&&e.push({value:kt}),e}({maxTicks:o,bounds:n.bounds,min:n.min,max:n.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===n.bounds&&BN(l,this,"value"),n.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const n=this.ticks;let e=this.min,o=this.max;if(super.configure(),this.options.offset&&n.length){const r=(o-e)/Math.max(n.length-1,1)/2;e-=r,o+=r}this._startValue=e,this._endValue=o,this._valueRange=o-e}getLabelForValue(n){return R0(n,this.chart.options.locale,this.options.ticks.format)}}class iM extends bT{determineDataLimits(){const{min:n,max:e}=this.getMinMax(!0);this.min=Br(n)?n:0,this.max=Br(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const n=this.isHorizontal(),e=n?this.width:this.height,o=Au(this.options.ticks.minRotation),r=(n?Math.sin(o):Math.cos(o))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,s.lineHeight/r))}getPixelForValue(n){return null===n?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getValueForPixel(n){return this._startValue+this.getDecimalForPixel(n)*this._valueRange}}Nn(iM,"id","linear"),Nn(iM,"defaults",{ticks:{callback:QC.formatters.numeric}});const K0=t=>Math.floor(jf(t)),Ug=(t,n)=>Math.pow(10,K0(t)+n);function zB(t){return t/Math.pow(10,K0(t))==1}function BB(t,n,e){const o=Math.pow(10,e),r=Math.floor(t/o);return Math.ceil(n/o)-r}class oM extends Vg{constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(n,e){const o=bT.prototype.parse.apply(this,[n,e]);if(0!==o)return Br(o)&&o>0?o:null;this._zero=!0}determineDataLimits(){const{min:n,max:e}=this.getMinMax(!0);this.min=Br(n)?Math.max(0,n):null,this.max=Br(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Br(this._userMin)&&(this.min=n===Ug(this.min,0)?Ug(this.min,-1):Ug(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:n,maxDefined:e}=this.getUserBounds();let o=this.min,r=this.max;const s=h=>o=n?o:h,l=h=>r=e?r:h;o===r&&(o<=0?(s(1),l(10)):(s(Ug(o,-1)),l(Ug(r,1)))),o<=0&&s(Ug(r,-1)),r<=0&&l(Ug(o,1)),this.min=o,this.max=r}buildTicks(){const n=this.options,o=function Cde(t,{min:n,max:e}){n=Hl(t.min,n);const o=[],r=K0(n);let s=function wde(t,n){let o=K0(n-t);for(;BB(t,n,o)>10;)o++;for(;BB(t,n,o)<10;)o--;return Math.min(o,K0(t))}(n,e),l=s<0?Math.pow(10,Math.abs(s)):1;const h=Math.pow(10,s),f=r>s?Math.pow(10,r):0,y=Math.round((n-f)*l)/l,C=Math.floor((n-f)/h/10)*h*10;let D=Math.floor((y-C)/Math.pow(10,s)),R=Hl(t.min,Math.round((f+C+D*Math.pow(10,s))*l)/l);for(;R<e;)o.push({value:R,major:zB(R),significand:D}),D>=10?D=D<15?15:20:D++,D>=20&&(s++,D=2,l=s>=0?1:l),R=Math.round((f+C+D*Math.pow(10,s))*l)/l;const V=Hl(t.max,R);return o.push({value:V,major:zB(V),significand:D}),o}({min:this._userMin,max:this._userMax},this);return"ticks"===n.bounds&&BN(o,this,"value"),n.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}getLabelForValue(n){return void 0===n?"0":R0(n,this.chart.options.locale,this.options.ticks.format)}configure(){const n=this.min;super.configure(),this._startValue=jf(n),this._valueRange=jf(this.max)-jf(n)}getPixelForValue(n){return(void 0===n||0===n)&&(n=this.min),null===n||isNaN(n)?NaN:this.getPixelForDecimal(n===this.min?0:(jf(n)-this._startValue)/this._valueRange)}getValueForPixel(n){const e=this.getDecimalForPixel(n);return Math.pow(10,this._startValue+e*this._valueRange)}}function rM(t){const n=t.ticks;if(n.display&&t.display){const e=va(n.backdropPadding);return Bi(n.font&&n.font.size,os.font.size)+e.height}return 0}function Tde(t,n,e){return e=rr(e)?e:[e],{w:Dae(t,n.string,e),h:e.length*n.lineHeight}}function VB(t,n,e,o,r){return t===o||t===r?{start:n-e/2,end:n+e/2}:t<o||t>r?{start:n-e,end:n}:{start:n,end:n+e}}function Ede(t,n,e,o,r){const s=Math.abs(Math.sin(e)),l=Math.abs(Math.cos(e));let h=0,f=0;o.start<n.l?(h=(n.l-o.start)/s,t.l=Math.min(t.l,n.l-h)):o.end>n.r&&(h=(o.end-n.r)/s,t.r=Math.max(t.r,n.r+h)),r.start<n.t?(f=(n.t-r.start)/l,t.t=Math.min(t.t,n.t-f)):r.end>n.b&&(f=(r.end-n.b)/l,t.b=Math.max(t.b,n.b+f))}function Dde(t){return 0===t||180===t?"center":t<180?"left":"right"}function Mde(t,n,e){return"right"===e?t-=n:"center"===e&&(t-=n/2),t}function kde(t,n,e){return 90===e||270===e?t-=n/2:(e>270||e<90)&&(t-=n),t}function UB(t,n,e,o){const{ctx:r}=t;if(e)r.arc(t.xCenter,t.yCenter,n,0,sr);else{let s=t.getPointPosition(0,n);r.moveTo(s.x,s.y);for(let l=1;l<o;l++)s=t.getPointPosition(l,n),r.lineTo(s.x,s.y)}}Nn(oM,"id","logarithmic"),Nn(oM,"defaults",{ticks:{callback:QC.formatters.logarithmic,major:{enabled:!0}}});class X0 extends bT{constructor(n){super(n),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const n=this._padding=va(rM(this.options)/2),e=this.width=this.maxWidth-n.width,o=this.height=this.maxHeight-n.height;this.xCenter=Math.floor(this.left+e/2+n.left),this.yCenter=Math.floor(this.top+o/2+n.top),this.drawingArea=Math.floor(Math.min(e,o)/2)}determineDataLimits(){const{min:n,max:e}=this.getMinMax(!1);this.min=Br(n)&&!isNaN(n)?n:0,this.max=Br(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/rM(this.options))}generateTickLabels(n){bT.prototype.generateTickLabels.call(this,n),this._pointLabels=this.getLabels().map((e,o)=>{const r=Qo(this.options.pointLabels.callback,[e,o],this);return r||0===r?r:""}).filter((e,o)=>this.chart.getDataVisibility(o))}fit(){const n=this.options;n.display&&n.pointLabels.display?function Sde(t){const n={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},e=Object.assign({},n),o=[],r=[],s=t._pointLabels.length,l=t.options.pointLabels,h=l.centerPointLabels?fr/s:0;for(let f=0;f<s;f++){const y=l.setContext(t.getPointLabelContext(f));r[f]=y.padding;const C=t.getPointPosition(f,t.drawingArea+r[f],h),D=Is(y.font),R=Tde(t.ctx,D,t._pointLabels[f]);o[f]=R;const V=$l(t.getIndexAngle(f)+h),$=Math.round(ID(V));Ede(e,n,V,VB($,C.x,R.w,0,180),VB($,C.y,R.h,90,270))}t.setCenterPoint(n.l-e.l,e.r-n.r,n.t-e.t,e.b-n.b),t._pointLabelItems=function Ide(t,n,e){const o=[],r=t._pointLabels.length,s=t.options,l=rM(s)/2,h=t.drawingArea,f=s.pointLabels.centerPointLabels?fr/r:0;for(let y=0;y<r;y++){const C=t.getPointPosition(y,h+l+e[y],f),D=Math.round(ID($l(C.angle+Vr))),R=n[y],V=kde(C.y,R.h,D),$=Dde(D),X=Mde(C.x,R.w,$);o.push({x:C.x,y:V,textAlign:$,left:X,top:V,right:X+R.w,bottom:V+R.h})}return o}(t,o,r)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(n,e,o,r){this.xCenter+=Math.floor((n-e)/2),this.yCenter+=Math.floor((o-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(n,e,o,r))}getIndexAngle(n){return $l(n*(sr/(this._pointLabels.length||1))+Au(this.options.startAngle||0))}getDistanceFromCenterForValue(n){if(Do(n))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-n)*e:(n-this.min)*e}getValueForDistanceFromCenter(n){if(Do(n))return NaN;const e=n/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(n){const e=this._pointLabels||[];if(n>=0&&n<e.length){const o=e[n];return function Ode(t,n,e){return Hf(t,{label:e,index:n,type:"pointLabel"})}(this.getContext(),n,o)}}getPointPosition(n,e,o=0){const r=this.getIndexAngle(n)-Vr+o;return{x:Math.cos(r)*e+this.xCenter,y:Math.sin(r)*e+this.yCenter,angle:r}}getPointPositionForValue(n,e){return this.getPointPosition(n,this.getDistanceFromCenterForValue(e))}getBasePosition(n){return this.getPointPositionForValue(n||0,this.getBaseValue())}getPointLabelPosition(n){const{left:e,top:o,right:r,bottom:s}=this._pointLabelItems[n];return{left:e,top:o,right:r,bottom:s}}drawBackground(){const{backgroundColor:n,grid:{circular:e}}=this.options;if(n){const o=this.ctx;o.save(),o.beginPath(),UB(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),o.closePath(),o.fillStyle=n,o.fill(),o.restore()}}drawGrid(){const n=this.ctx,e=this.options,{angleLines:o,grid:r,border:s}=e,l=this._pointLabels.length;let h,f,y;if(e.pointLabels.display&&function Ade(t,n){const{ctx:e,options:{pointLabels:o}}=t;for(let r=n-1;r>=0;r--){const s=o.setContext(t.getPointLabelContext(r)),l=Is(s.font),{x:h,y:f,textAlign:y,left:C,top:D,right:R,bottom:V}=t._pointLabelItems[r],{backdropColor:$}=s;if(!Do($)){const X=Rg(s.borderRadius),ee=va(s.backdropPadding);e.fillStyle=$;const ue=C-ee.left,fe=D-ee.top,_e=R-C+ee.width,Be=V-D+ee.height;Object.values(X).some(et=>0!==et)?(e.beginPath(),z0(e,{x:ue,y:fe,w:_e,h:Be,radius:X}),e.fill()):e.fillRect(ue,fe,_e,Be)}Lg(e,t._pointLabels[r],h,f+l.lineHeight/2,l,{color:s.color,textAlign:y,textBaseline:"middle"})}}(this,l),r.display&&this.ticks.forEach((C,D)=>{if(0!==D){f=this.getDistanceFromCenterForValue(C.value);const R=this.getContext(D),V=r.setContext(R),$=s.setContext(R);!function Pde(t,n,e,o,r){const s=t.ctx,l=n.circular,{color:h,lineWidth:f}=n;!l&&!o||!h||!f||e<0||(s.save(),s.strokeStyle=h,s.lineWidth=f,s.setLineDash(r.dash),s.lineDashOffset=r.dashOffset,s.beginPath(),UB(t,e,l,o),s.closePath(),s.stroke(),s.restore())}(this,V,f,l,$)}}),o.display){for(n.save(),h=l-1;h>=0;h--){const C=o.setContext(this.getPointLabelContext(h)),{color:D,lineWidth:R}=C;!R||!D||(n.lineWidth=R,n.strokeStyle=D,n.setLineDash(C.borderDash),n.lineDashOffset=C.borderDashOffset,f=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),y=this.getPointPosition(h,f),n.beginPath(),n.moveTo(this.xCenter,this.yCenter),n.lineTo(y.x,y.y),n.stroke())}n.restore()}}drawBorder(){}drawLabels(){const n=this.ctx,e=this.options,o=e.ticks;if(!o.display)return;const r=this.getIndexAngle(0);let s,l;n.save(),n.translate(this.xCenter,this.yCenter),n.rotate(r),n.textAlign="center",n.textBaseline="middle",this.ticks.forEach((h,f)=>{if(0===f&&!e.reverse)return;const y=o.setContext(this.getContext(f)),C=Is(y.font);if(s=this.getDistanceFromCenterForValue(this.ticks[f].value),y.showLabelBackdrop){n.font=C.string,l=n.measureText(h.label).width,n.fillStyle=y.backdropColor;const D=va(y.backdropPadding);n.fillRect(-l/2-D.left,-s-C.size/2-D.top,l+D.width,C.size+D.height)}Lg(n,h.label,0,-s,C,{color:y.color})}),n.restore()}drawTitle(){}}Nn(X0,"id","radialLinear"),Nn(X0,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:QC.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}}),Nn(X0,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Nn(X0,"descriptors",{angleLines:{_fallback:"grid"}});const xT={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},vl=Object.keys(xT);function Lde(t,n){return t-n}function jB(t,n){if(Do(n))return null;const e=t._adapter,{parser:o,round:r,isoWeekday:s}=t._parseOpts;let l=n;return"function"==typeof o&&(l=o(l)),Br(l)||(l="string"==typeof o?e.parse(l,o):e.parse(l)),null===l?null:(r&&(l="week"!==r||!By(s)&&!0!==s?e.startOf(l,r):e.startOf(l,"isoWeek",s)),+l)}function HB(t,n,e,o){const r=vl.length;for(let s=vl.indexOf(t);s<r-1;++s){const l=xT[vl[s]];if(l.common&&Math.ceil((e-n)/((l.steps?l.steps:Number.MAX_SAFE_INTEGER)*l.size))<=o)return vl[s]}return vl[r-1]}function $B(t,n,e){if(e){if(e.length){const{lo:o,hi:r}=MD(e,n);t[e[o]>=n?e[o]:e[r]]=!0}}else t[n]=!0}function GB(t,n,e){const o=[],r={},s=n.length;let l,h;for(l=0;l<s;++l)h=n[l],r[h]=l,o.push({value:h,major:!1});return 0!==s&&e?function Nde(t,n,e,o){const r=t._adapter,s=+r.startOf(n[0].value,o),l=n[n.length-1].value;let h,f;for(h=s;h<=l;h=+r.add(h,1,o))f=e[h],f>=0&&(n[f].major=!0);return n}(t,o,r,e):o}let sM=(()=>{class t extends Vg{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,o={}){const r=e.time||(e.time={}),s=this._adapter=new qle__date(e.adapters.date);s.init(o),A0(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=o.normalized}parse(e,o){return void 0===e?null:jB(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,o=this._adapter,r=e.time.unit||"day";let{min:s,max:l,minDefined:h,maxDefined:f}=this.getUserBounds();function y(C){!h&&!isNaN(C.min)&&(s=Math.min(s,C.min)),!f&&!isNaN(C.max)&&(l=Math.max(l,C.max))}(!h||!f)&&(y(this._getLabelBounds()),("ticks"!==e.bounds||"labels"!==e.ticks.source)&&y(this.getMinMax(!1))),s=Br(s)&&!isNaN(s)?s:+o.startOf(Date.now(),r),l=Br(l)&&!isNaN(l)?l:+o.endOf(Date.now(),r)+1,this.min=Math.min(s,l-1),this.max=Math.max(s+1,l)}_getLabelBounds(){const e=this.getLabelTimestamps();let o=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(o=e[0],r=e[e.length-1]),{min:o,max:r}}buildTicks(){const e=this.options,o=e.time,r=e.ticks,s="labels"===r.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const l=this.min,f=function mae(t,n,e){let o=0,r=t.length;for(;o<r&&t[o]<n;)o++;for(;r>o&&t[r-1]>e;)r--;return o>0||r<t.length?t.slice(o,r):t}(s,l,this.max);return this._unit=o.unit||(r.autoSkip?HB(o.minUnit,this.min,this.max,this._getLabelCapacity(l)):function Rde(t,n,e,o,r){for(let s=vl.length-1;s>=vl.indexOf(e);s--){const l=vl[s];if(xT[l].common&&t._adapter.diff(r,o,l)>=n-1)return l}return vl[e?vl.indexOf(e):0]}(this,f.length,o.minUnit,this.min,this.max)),this._majorUnit=r.major.enabled&&"year"!==this._unit?function Fde(t){for(let n=vl.indexOf(t)+1,e=vl.length;n<e;++n)if(xT[vl[n]].common)return vl[n]}(this._unit):void 0,this.initOffsets(s),e.reverse&&f.reverse(),GB(this,f,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let s,l,o=0,r=0;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),o=1===e.length?1-s:(this.getDecimalForValue(e[1])-s)/2,l=this.getDecimalForValue(e[e.length-1]),r=1===e.length?l:(l-this.getDecimalForValue(e[e.length-2]))/2);const h=e.length<3?.5:.25;o=Bs(o,0,h),r=Bs(r,0,h),this._offsets={start:o,end:r,factor:1/(o+1+r)}}_generate(){const e=this._adapter,o=this.min,r=this.max,s=this.options,l=s.time,h=l.unit||HB(l.minUnit,o,r,this._getLabelCapacity(o)),f=Bi(s.ticks.stepSize,1),y="week"===h&&l.isoWeekday,C=By(y)||!0===y,D={};let V,$,R=o;if(C&&(R=+e.startOf(R,"isoWeek",y)),R=+e.startOf(R,C?"day":h),e.diff(r,o,h)>1e5*f)throw new Error(o+" and "+r+" are too far apart with stepSize of "+f+" "+h);const X="data"===s.ticks.source&&this.getDataTimestamps();for(V=R,$=0;V<r;V=+e.add(V,f,h),$++)$B(D,V,X);return(V===r||"ticks"===s.bounds||1===$)&&$B(D,V,X),Object.keys(D).sort((ee,ue)=>ee-ue).map(ee=>+ee)}getLabelForValue(e){const r=this.options.time;return this._adapter.format(e,r.tooltipFormat?r.tooltipFormat:r.displayFormats.datetime)}format(e,o){return this._adapter.format(e,o||this.options.time.displayFormats[this._unit])}_tickFormatFunction(e,o,r,s){const l=this.options,h=l.ticks.callback;if(h)return Qo(h,[e,o,r],this);const f=l.time.displayFormats,y=this._unit,C=this._majorUnit,R=C&&f[C],V=r[o];return this._adapter.format(e,s||(C&&R&&V&&V.major?R:y&&f[y]))}generateTickLabels(e){let o,r,s;for(o=0,r=e.length;o<r;++o)s=e[o],s.label=this._tickFormatFunction(s.value,o,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const o=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((o.start+r)*o.factor)}getValueForPixel(e){const o=this._offsets,r=this.getDecimalForPixel(e)/o.factor-o.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const o=this.options.ticks,r=this.ctx.measureText(e).width,s=Au(this.isHorizontal()?o.maxRotation:o.minRotation),l=Math.cos(s),h=Math.sin(s),f=this._resolveTickFontOptions(0).size;return{w:r*l+f*h,h:r*h+f*l}}_getLabelCapacity(e){const o=this.options.time,r=o.displayFormats,s=r[o.unit]||r.millisecond,l=this._tickFormatFunction(e,0,GB(this,[e],this._majorUnit),s),h=this._getLabelSize(l),f=Math.floor(this.isHorizontal()?this.width/h.w:this.height/h.h)-1;return f>0?f:1}getDataTimestamps(){let o,r,e=this._cache.data||[];if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(o=0,r=s.length;o<r;++o)e=e.concat(s[o].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let o,r;if(e.length)return e;const s=this.getLabels();for(o=0,r=s.length;o<r;++o)e.push(jB(this,s[o]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return $N(e.sort(Lde))}}return Nn(t,"id","time"),Nn(t,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}}),t})();function wT(t,n,e){let s,l,h,f,o=0,r=t.length-1;e?(n>=t[o].pos&&n<=t[r].pos&&({lo:o,hi:r}=sp(t,"pos",n)),({pos:s,time:h}=t[o]),({pos:l,time:f}=t[r])):(n>=t[o].time&&n<=t[r].time&&({lo:o,hi:r}=sp(t,"time",n)),({time:s,pos:h}=t[o]),({time:l,pos:f}=t[r]));const y=l-s;return y?h+(f-h)*(n-s)/y:h}class aM extends sM{constructor(n){super(n),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const n=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(n);this._minPos=wT(e,this.min),this._tableRange=wT(e,this.max)-this._minPos,super.initOffsets(n)}buildLookupTable(n){const{min:e,max:o}=this,r=[],s=[];let l,h,f,y,C;for(l=0,h=n.length;l<h;++l)y=n[l],y>=e&&y<=o&&r.push(y);if(r.length<2)return[{time:e,pos:0},{time:o,pos:1}];for(l=0,h=r.length;l<h;++l)C=r[l+1],f=r[l-1],y=r[l],Math.round((C+f)/2)!==y&&s.push({time:y,pos:l/(h-1)});return s}_getTimestampsForTable(){let n=this._cache.all||[];if(n.length)return n;const e=this.getDataTimestamps(),o=this.getLabelTimestamps();return n=e.length&&o.length?this.normalize(e.concat(o)):e.length?e:o,n=this._cache.all=n,n}getDecimalForValue(n){return(wT(this._table,n)-this._minPos)/this._tableRange}getValueForPixel(n){const e=this._offsets,o=this.getDecimalForPixel(n)/e.factor-e.end;return wT(this._table,o*this._tableRange+this._minPos,!0)}}Nn(aM,"id","timeseries"),Nn(aM,"defaults",sM.defaults),Hy.register(Wle,wue,gde,Object.freeze({__proto__:null,CategoryScale:bde,LinearScale:iM,LogarithmicScale:oM,RadialLinearScale:X0,TimeScale:sM,TimeSeriesScale:aM}));let WB=(()=>{class t{constructor(){}registerPushNotifications(){var e=this;return Ft(function*(){const o=yield navigator.serviceWorker.register("./assets/service-worker.js");yield new Promise(s=>setTimeout(s,3e3));const r=yield o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e.urlB64ToUint8Array("BLIjCfKJdaxyQk6DGN6mrtu--2uTOiNsruCl9jAQ1xIO_73y7KCEqQlyK_S7gMcflx8-ciSMyZmv3b4FXw16r8E")});try{yield e.registerSubscription(r),localStorage.setItem("pushNotifications","active")}catch{console.error("Error al suscribirse a las notificaciones")}})()}unregisterPushNotifications(){var e=this;return Ft(function*(){const r=yield(yield navigator.serviceWorker.getRegistration("/assets/")).pushManager.getSubscription();try{yield e.unregisterSubscription(r),localStorage.removeItem("pushNotifications")}catch{console.error("Error al desuscribirse a las notificaciones")}})()}urlB64ToUint8Array(e){const r=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),s=window.atob(r),l=new Uint8Array(s.length);for(let h=0;h<s.length;++h)l[h]=s.charCodeAt(h);return l}registerSubscription(e){return Ft(function*(){const r=Qn_server+"/pushnotifications/subscribe",s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};return(yield ui.post(r,e,s)).data})()}unregisterSubscription(e){return Ft(function*(){const r=Qn_server+"/pushnotifications/unsubscribe",s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};return(yield ui.post(r,e,s)).data})()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Vde=function(t,n,e){return{"p-inputswitch p-component":!0,"p-inputswitch-checked":t,"p-disabled":n,"p-focus":e}},Ude={provide:zs,useExisting:Ei(()=>qB),multi:!0};let qB=(()=>{class t{constructor(e){this.cd=e,this.trueValue=!0,this.falseValue=!1,this.onChange=new ht,this.modelValue=!1,this.focused=!1,this.onModelChange=()=>{},this.onModelTouched=()=>{}}onClick(e,o){!this.disabled&&!this.readonly&&(e.preventDefault(),this.toggle(e),o.focus())}onInputChange(e){this.readonly||this.updateModel(e,e.target.checked)}toggle(e){this.updateModel(e,!this.checked())}updateModel(e,o){this.modelValue=o?this.trueValue:this.falseValue,this.onModelChange(this.modelValue),this.onChange.emit({originalEvent:e,checked:this.modelValue})}onFocus(e){this.focused=!0}onBlur(e){this.focused=!1,this.onModelTouched()}writeValue(e){this.modelValue=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}checked(){return this.modelValue===this.trueValue}}return t.\u0275fac=function(e){return new(e||t)(ce(Fo))},t.\u0275cmp=Qt({type:t,selectors:[["p-inputSwitch"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",tabindex:"tabindex",inputId:"inputId",name:"name",disabled:"disabled",readonly:"readonly",trueValue:"trueValue",falseValue:"falseValue",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy"},outputs:{onChange:"onChange"},features:[zi([Ude])],decls:5,vars:16,consts:[[3,"ngClass","ngStyle","click"],[1,"p-hidden-accessible"],["type","checkbox","role","switch",3,"checked","disabled","change","focus","blur"],["cb",""],[1,"p-inputswitch-slider"]],template:function(e,o){if(1&e){const r=Ye();P(0,"div",0),Te("click",function(l){be(r);const h=Un(3);return ve(o.onClick(l,h))}),P(1,"div",1)(2,"input",2,3),Te("change",function(l){return o.onInputChange(l)})("focus",function(l){return o.onFocus(l)})("blur",function(l){return o.onBlur(l)}),N()(),Ae(4,"span",4),N()}2&e&&(Zn(o.styleClass),L("ngClass",Va(12,Vde,o.checked(),o.disabled,o.focused))("ngStyle",o.style),F(2),L("checked",o.checked())("disabled",o.disabled),at("aria-label",o.ariaLabel)("id",o.inputId)("name",o.name)("tabindex",o.tabindex)("aria-checked",o.checked())("aria-labelledby",o.ariaLabelledBy))},dependencies:[ao,ho],styles:['.p-inputswitch{position:relative;display:inline-block;-webkit-user-select:none;user-select:none}.p-inputswitch-slider{position:absolute;cursor:pointer;inset:0}.p-inputswitch-slider:before{position:absolute;content:"";top:50%}\n'],encapsulation:2,changeDetection:0}),t})(),CT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();const jde=["playlistCard"];function Hde(t,n){if(1&t&&(P(0,"h3",7),ie(1),N()),2&t){const e=U(2);F(1),Ut(e.carouselTitle)}}function $de(t,n){if(1&t&&Ae(0,"img",20),2&t){const e=U().$implicit;Ai("src",e.playlistImage,Ui),L("alt",e.name)}}function Gde(t,n){1&t&&Ae(0,"img",21),2&t&&L("alt",U().$implicit.name)}const Wde=function(t){return{background:t}},ZB=function(t){return["/playlists",t]},qde=function(t){return{display:t}};function Zde(t,n){if(1&t){const e=Ye();P(0,"div",8)(1,"div",9),Te("mouseenter",function(){const s=be(e).$implicit;return ve(U(2).mouseEnter(s.playlistId,"card"))})("mouseleave",function(){return be(e),ve(U(2).mouseLeave("card"))}),P(2,"div",10)(3,"div",11)(4,"div",12),W(5,$de,1,2,"img",13),W(6,Gde,1,1,"img",14),N(),P(7,"div",15)(8,"div")(9,"h5",16),ie(10),wo(11,"slice"),N(),P(12,"h5",17),ie(13),wo(14,"slice"),N()()()()()(),P(15,"button",18),Te("mouseenter",function(){const s=be(e).$implicit;return ve(U(2).mouseEnter(s.playlistId,"button"))})("mouseleave",function(){return be(e),ve(U(2).mouseLeave("button"))}),P(16,"div",19)(17,"mat-icon"),ie(18,"play_arrow"),N()()()()}if(2&t){const e=n.$implicit,o=U(2);F(1),L("ngStyle",Wt(16,Wde,o.mouseInCard&&o.selected==e.playlistId?"var(--selectedItem)":"transparent")),F(3),L("routerLink",Wt(18,ZB,e.playlistId)),F(1),L("ngIf",""!=e.playlistImage),F(1),L("ngIf",""==e.playlistImage),F(4),Ut(e.name.length>15?Nr(11,8,e.name,0,15)+"...":e.name),F(3),Ut(e.userName.length>18?Nr(14,12,e.userName,0,18)+"...":e.userName),F(2),L("routerLink",Wt(20,ZB,e.playlistId))("ngStyle",Wt(22,qde,o.mouseInCard&&o.selected==e.playlistId?"flex":"none"))}}function Kde(t,n){if(1&t&&(P(0,"p-carousel",4),W(1,Hde,2,1,"ng-template",5),W(2,Zde,19,24,"ng-template",6),N()),2&t){const e=U();L("value",e.playlists)("numVisible",7)("numScroll",7)("circular",!0)("responsiveOptions",e.responsiveOptions)("showIndicators",!1)}}function Xde(t,n){1&t&&(P(0,"div")(1,"p",22),ie(2,"No hay playlists disponibles"),N()())}let Yde=(()=>{class t{constructor(){this.mouseInCard=!1,this.selected=0,this.responsiveOptions=[{breakpoint:"2100px",numVisible:5,numScroll:5},{breakpoint:"1650px",numVisible:4,numScroll:4},{breakpoint:"1450px",numVisible:3,numScroll:3},{breakpoint:"1150px",numVisible:2,numScroll:2},{breakpoint:"900px",numVisible:1,numScroll:1},{breakpoint:"699px",numVisible:2,numScroll:2},{breakpoint:"600px",numVisible:1,numScroll:1}]}clickImage(){alert("CLICK")}mouseEnter(e,o){this.mouseInCard=!0,this.selected=e}mouseLeave(e){this.mouseInCard=!1,this.selected=0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["app-carousel"]],viewQuery:function(e,o){if(1&e&&pi(jde,5),2&e){let r;gn(r=_n())&&(o.playlistCard=r.first)}},inputs:{carouselTitle:"carouselTitle",playlists:"playlists"},decls:5,vars:3,consts:[[1,"mb-4","hide-titles","font-bold"],[1,"card","w-full","containers-carousel"],[3,"value","numVisible","numScroll","circular","responsiveOptions","showIndicators",4,"ngIf"],[4,"ngIf"],[3,"value","numVisible","numScroll","circular","responsiveOptions","showIndicators"],["pTemplate","header"],["pTemplate","item"],[1,"mb-4","ml-3","show-titles-sm"],[1,"flex","flex-wrap","justify-content-center"],[1,"z-0","flex","flex-column","h-16rem","relative",2,"border-radius","15px",3,"ngStyle","mouseenter","mouseleave"],[1,"h-full","w-13rem","carousel-line"],[1,"w-full","h-full","p-3"],[1,"w-full","overflow-hidden","image-shadow",2,"aspect-ratio","1/1","cursor","pointer","border-radius","5px !important",3,"routerLink"],["class","h-full w-auto",3,"src","alt",4,"ngIf"],["src","assets/images/playlist-placeholder.svg","class","h-full w-auto","style","background: var(--background); border-radius: 5px;",3,"alt",4,"ngIf"],[1,"flex","mt-2"],[1,"mb-1","text-left"],[1,"carousel-text","text-left"],["id","play-btn",1,"z-2","absolute","align-items-center","justify-content-center","border-circle","play-icon","border-none",2,"width","50px","height","50px","top","130px","margin-right","110px","padding-top","0.5rem","padding-bottom","0.5rem","cursor","pointer",3,"routerLink","ngStyle","mouseenter","mouseleave"],[1,"flex","align-items-center","justify-content-center","border-circle","bg-white",2,"height","28px !important","width","28px !important"],[1,"h-full","w-auto",3,"src","alt"],["src","assets/images/playlist-placeholder.svg",1,"h-full","w-auto",2,"background","var(--background)","border-radius","5px",3,"alt"],[1,"ml-3",2,"font-size","medium","margin","0"]],template:function(e,o){1&e&&(P(0,"h3",0),ie(1),N(),P(2,"div",1),W(3,Kde,3,6,"p-carousel",2),W(4,Xde,3,0,"div",3),N()),2&e&&(F(1),Ut(o.carouselTitle),F(2),L("ngIf",0!=o.playlists.length),F(1),L("ngIf",0==o.playlists.length))},dependencies:[Qh,Xn,ho,lN,fo,_a,Su],styles:[".carousel-line[_ngcontent-%COMP%]{border:var(--carouselOutline);border-radius:.75rem}.carousel-text[_ngcontent-%COMP%]{color:var(--carouselText);font-size:small;font-weight:400}.play-icon[_ngcontent-%COMP%]{background:var(--gradient45);box-shadow:var(--shadows)}mat-icon[_ngcontent-%COMP%]{background:var(--gradient45);-webkit-background-clip:text;-moz-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}.image-shadow[_ngcontent-%COMP%]{box-shadow:0 3px 6px #00000029,0 3px 6px #0000003b}"]}),t})();function Qde(t,n){if(1&t){const e=Ye();P(0,"div",3)(1,"button",4),Te("click",function(){return be(e),ve(U().onCancel())}),P(2,"div",5)(3,"span",6)(4,"p",7),ie(5,"Aceptar"),N()()()()()}}const Jde=function(){return{width:"500px"}},ehe=function(){return{"500px":"95vw"}};let lM=(()=>{class t{constructor(){this.showDialog=new ht}onCancel(){this.showDialog.emit(!1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["app-success-dialog-edit"]],inputs:{display:"display",message:"message",title:"title"},outputs:{showDialog:"showDialog"},decls:6,vars:10,consts:[[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],[1,"text-center"],["pTemplate","footer"],[1,"p-3"],["pButton","","pRipple","","type","submit",1,"p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"]],template:function(e,o){1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s})("onHide",function(){return o.onCancel()}),P(1,"h3",1),ie(2),N(),P(3,"p",1),ie(4),N(),W(5,Qde,6,0,"ng-template",2),N()),2&e&&(Io(Kn(8,Jde)),L("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",Kn(9,ehe)),F(2),jn(" ",o.title," "),F(2),jn(" ",o.message," "))},dependencies:[Dr,fo,jl]}),t})();function the(t,n){1&t&&(P(0,"div",31)(1,"h2",32),ie(2,"Editar perfil"),N()())}function nhe(t,n){1&t&&(P(0,"div",33)(1,"span",34),ie(2,"El nombre no puede tener m\xe1s de 20 caracteres"),N()())}function ihe(t,n){1&t&&(P(0,"div",33)(1,"span",34),ie(2,"Introduzca un nombre"),N()())}function ohe(t,n){1&t&&(P(0,"div",33)(1,"span",34),ie(2,"El nombre de usuario no puede tener m\xe1s de 10 caracteres"),N()())}function rhe(t,n){1&t&&(P(0,"div",33)(1,"span",34),ie(2,"Introduzca un nombre de usuario"),N()())}function she(t,n){1&t&&(P(0,"div")(1,"span",34),ie(2,"Introduzca un correo v\xe1lido"),N()())}function ahe(t,n){1&t&&(P(0,"div",33)(1,"span",34),ie(2,"Introduzca un correo"),N()())}function lhe(t,n){1&t&&Ae(0,"p-progressSpinner",35)}function che(t,n){1&t&&(P(0,"mat-icon",36),ie(1,"check"),N())}const uhe=function(){return{width:"600px"}},dhe=function(){return{"650px":"95vw"}};let hhe=(()=>{class t{constructor(e,o){this.appLayout=e,this.usersService=o,this.showDialog=new ht,this.userUpdated=new ht,this.user=new bC,this.updateForm=new Qs({}),this.acceptLabel="Aceptar",this.loading=!1,this.emailDisabled=!0,this.displaySuccess=!1}ngOnInit(){this.events.subscribe(e=>{this.user=e,this.updateFields(this.updateForm)}),this.updateForm=new Qs({email:new Sr({value:this.user.email,disabled:!0},[pr.required,pr.email]),name:new Sr({value:this.user.name,disabled:!0},[pr.required,pr.maxLength(20)]),nickname:new Sr({value:this.user.nickname,disabled:!0},[pr.required,pr.maxLength(10)])}),this.updateFields(this.updateForm)}onSubmit(e){var o=this;return Ft(function*(){o.loading=!0,o.acceptLabel="Actualizando...",e.controls.email.touched&&(o.user.email=e.value.email),e.controls.name.touched&&(o.user.name=e.value.name),e.controls.nickname.touched&&(o.user.nickname=e.value.nickname);try{yield o.usersService.updateUser(o.user.name,o.user.email,o.user.nickname),o.displaySuccess=!0,o.cancel(e)}catch(r){o.loading=!1,o.acceptLabel="Aceptar",403==r.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.response.data.status})}})()}cancel(e){this.showDialog.emit(!1),this.userUpdated.emit(this.user),this.updateForm.markAsPristine(),this.updateForm.markAsUntouched(),this.updateForm.get("email").disable(),this.updateForm.get("name").disable(),this.updateForm.get("nickname").disable(),this.updateFields(e),this.acceptLabel="Aceptar",this.loading=!1}updateFields(e){e.get("email")?.setValue(this.user.email),e.get("name")?.setValue(this.user.name),e.get("nickname")?.setValue(this.user.nickname)}onHide(e){this.displaySuccess=e}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(Mg))},t.\u0275cmp=Qt({type:t,selectors:[["app-edit-profile-dialog"]],inputs:{display:"display",events:"events"},outputs:{showDialog:"showDialog",userUpdated:"userUpdated"},decls:52,vars:26,consts:[[3,"closable","visible","modal","draggable","breakpoints","visibleChange"],["pTemplate","header","class","py-0"],[3,"formGroup","ngSubmit"],[2,"transition","var(--transition)"],[1,"form-label-container"],["for","name",1,"block","mb-2"],[1,"p-inputgroup"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-user"],["id","name","name","name","formControlName","name","placeholder","Nombre Apellido","type","text","pInputText","",1,"form-control","h-3rem"],["type","button","pButton","","pRipple","","icon","pi pi-pencil","styleClass","p-button-danger",1,"w-3rem",2,"border-top-left-radius","0 !important","border-bottom-left-radius","0 !important",3,"click"],["class","mb-2",4,"ngIf"],["for","nickname",1,"block","mb-2"],[1,"pi","pi-at"],["id","nickname","name","nickname","formControlName","nickname","placeholder","Nombre de usuario","type","text","pInputText","",1,"form-control","h-3rem"],[1,"pi","pi-envelope"],["id","email","name","email","formControlName","email","placeholder","correo@email.com","type","text","pInputText","",1,"form-control","h-3rem"],[4,"ngIf"],[1,"flex","mt-3"],[1,"flex","align-items-center","justify-content-center","w-6","mr-1"],["pButton","","pRipple","","type","button",1,"mt-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"text-pink-500","w-3rem"],[1,"text-pink-500","w-full"],[1,"flex","align-items-center","justify-content-center","w-6","ml-1"],["pButton","","pRipple","","type","submit",1,"mt-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],["class","text-green-500 w-3rem",4,"ngIf"],[1,"w-full"],["title","Perfil actualizado","message","Informaci\xf3n del perfil actualizada correctamente",3,"display","showDialog"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"],[1,"mb-2"],[1,"text-xs",2,"color","var(--validationErrors)"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"],[1,"text-green-500","w-3rem"]],template:function(e,o){if(1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s}),W(1,the,3,0,"ng-template",1),P(2,"form",2),Te("ngSubmit",function(){return o.onSubmit(o.updateForm)}),P(3,"div",3)(4,"div",4)(5,"label",5),ie(6,"Nombre"),N(),P(7,"div",6)(8,"span",7),Ae(9,"i",8),N(),Ae(10,"input",9),P(11,"button",10),Te("click",function(){return o.updateForm.get("name").enable()}),N()(),W(12,nhe,3,0,"div",11),W(13,ihe,3,0,"div",11),N(),P(14,"div",4)(15,"label",12),ie(16,"Nombre de usuario"),N(),P(17,"div",6)(18,"span",7),Ae(19,"i",13),N(),Ae(20,"input",14),P(21,"button",10),Te("click",function(){return o.updateForm.get("nickname").enable()}),N()(),W(22,ohe,3,0,"div",11),W(23,rhe,3,0,"div",11),N(),P(24,"div",4)(25,"label",5),ie(26,"Email"),N(),P(27,"div",6)(28,"span",7),Ae(29,"i",15),N(),Ae(30,"input",16),P(31,"button",10),Te("click",function(){return o.updateForm.get("email").enable()}),N()(),W(32,she,3,0,"div",17),W(33,ahe,3,0,"div",11),N()(),P(34,"div",18)(35,"div",19)(36,"button",20),Te("click",function(){return o.cancel(o.updateForm)}),P(37,"div",21)(38,"span",22)(39,"mat-icon",23),ie(40,"close"),N(),P(41,"p",24),ie(42," Cancelar "),N()()()()(),P(43,"div",25)(44,"button",26)(45,"div",21)(46,"span",22),W(47,lhe,1,0,"p-progressSpinner",27),W(48,che,2,0,"mat-icon",28),P(49,"p",29),ie(50),N()()()()()()()(),P(51,"app-success-dialog-edit",30),Te("showDialog",function(s){return o.onHide(s)}),N()),2&e){let r,s,l,h,f,y;Io(Kn(24,uhe)),L("closable",!1)("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",Kn(25,dhe)),F(2),L("formGroup",o.updateForm),F(10),L("ngIf",(null==(r=o.updateForm.get("name"))?null:r.hasError("maxlength"))&&(o.updateForm.controls.name.dirty||o.updateForm.controls.name.touched)),F(1),L("ngIf",(null==(s=o.updateForm.get("name"))?null:s.hasError("required"))&&(o.updateForm.controls.name.dirty||o.updateForm.controls.name.touched)),F(9),L("ngIf",(null==(l=o.updateForm.get("nickname"))?null:l.hasError("maxlength"))&&(o.updateForm.controls.nickname.dirty||o.updateForm.controls.nickname.touched)),F(1),L("ngIf",(null==(h=o.updateForm.get("nickname"))?null:h.hasError("required"))&&(o.updateForm.controls.nickname.dirty||o.updateForm.controls.nickname.touched)),F(9),L("ngIf",o.updateForm.controls.email.invalid&&!(null!=(f=o.updateForm.get("email"))&&f.hasError("required"))&&(o.updateForm.controls.email.dirty||o.updateForm.controls.email.touched)),F(1),L("ngIf",(null==(y=o.updateForm.get("email"))?null:y.hasError("required"))&&(o.updateForm.controls.email.dirty||o.updateForm.controls.email.touched)),F(3),L("disabled",o.loading),F(8),L("disabled",!o.updateForm.valid||o.loading),F(3),L("ngIf",o.loading),F(1),L("ngIf",!o.loading),F(1),Ro("text-green-500",!o.loading)("text-blue-500",o.loading),F(1),jn(" ",o.acceptLabel," "),F(1),L("display",o.displaySuccess)}},dependencies:[Xn,Dd,yc,$a,Ed,vc,Md,Dr,fo,_l,jl,_a,Mu,lM],styles:["[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:var(--primary-color)!important}"]}),t})();function phe(t,n){1&t&&Ae(0,"span",11),2&t&&L("innerHTML",U(2).$implicit.summary,Lh)}function fhe(t,n){1&t&&Ae(0,"span",12),2&t&&L("innerHTML",U(2).$implicit.detail,Lh)}function mhe(t,n){if(1&t&&(wn(0),W(1,phe,1,1,"span",9),W(2,fhe,1,1,"span",10),Pn()),2&t){const e=U().$implicit;F(1),L("ngIf",e.summary),F(1),L("ngIf",e.detail)}}function ghe(t,n){if(1&t&&(P(0,"span",15),ie(1),N()),2&t){const e=U(2).$implicit;F(1),Ut(e.summary)}}function _he(t,n){if(1&t&&(P(0,"span",16),ie(1),N()),2&t){const e=U(2).$implicit;F(1),Ut(e.detail)}}function yhe(t,n){if(1&t&&(W(0,ghe,2,1,"span",13),W(1,_he,2,1,"span",14)),2&t){const e=U().$implicit;L("ngIf",e.summary),F(1),L("ngIf",e.detail)}}function vhe(t,n){if(1&t){const e=Ye();P(0,"button",17),Te("click",function(){be(e);const r=U().index;return ve(U(2).removeMessage(r))}),Ae(1,"i",18),N()}}const bhe=function(t,n){return{showTransitionParams:t,hideTransitionParams:n}},xhe=function(t){return{value:"visible",params:t}},whe=function(t,n,e,o){return{"pi-info-circle":t,"pi-check":n,"pi-exclamation-triangle":e,"pi-times-circle":o}};function Che(t,n){if(1&t&&(P(0,"div",4)(1,"div",5),Ae(2,"span",6),W(3,mhe,3,2,"ng-container",1),W(4,yhe,2,2,"ng-template",null,7,Ua),W(6,vhe,2,0,"button",8),N()()),2&t){const e=n.$implicit,o=Un(5),r=U(2);Zn("p-message p-message-"+e.severity),L("@messageAnimation",Wt(12,xhe,Ji(9,bhe,r.showTransitionOptions,r.hideTransitionOptions))),F(2),Zn("p-message-icon pi"+(e.icon?" "+e.icon:"")),L("ngClass",vu(14,whe,"info"===e.severity,"success"===e.severity,"warn"===e.severity,"error"===e.severity)),F(1),L("ngIf",!r.escape)("ngIfElse",o),F(3),L("ngIf",r.closable)}}function The(t,n){if(1&t&&(wn(0),W(1,Che,7,19,"div",3),Pn()),2&t){const e=U();F(1),L("ngForOf",e.messages)}}function She(t,n){1&t&&$t(0)}function Ehe(t,n){if(1&t&&(P(0,"div",19)(1,"div",5),W(2,She,1,0,"ng-container",20),N()()),2&t){const e=U();L("ngClass","p-message p-message-"+e.severity),F(2),L("ngTemplateOutlet",e.contentTemplate)}}let TT=(()=>{class t{constructor(e,o,r){this.messageService=e,this.el=o,this.cd=r,this.closable=!0,this.enableService=!0,this.escape=!0,this.showTransitionOptions="300ms ease-out",this.hideTransitionOptions="200ms cubic-bezier(0.86, 0, 0.07, 1)",this.valueChange=new ht,this.timerSubscriptions=[]}set value(e){this.messages=e,this.startMessageLifes(this.messages)}ngAfterContentInit(){this.templates.forEach(e=>{e.getType(),this.contentTemplate=e.template}),this.messageService&&this.enableService&&!this.contentTemplate&&(this.messageSubscription=this.messageService.messageObserver.subscribe(e=>{if(e){Array.isArray(e)||(e=[e]);const o=e.filter(r=>this.key===r.key);this.messages=this.messages?[...this.messages,...o]:[...o],this.startMessageLifes(o),this.cd.markForCheck()}}),this.clearSubscription=this.messageService.clearObserver.subscribe(e=>{e?this.key===e&&(this.messages=null):this.messages=null,this.cd.markForCheck()}))}hasMessages(){let e=this.el.nativeElement.parentElement;return!(!e||!e.offsetParent)&&(null!=this.contentTemplate||this.messages&&this.messages.length>0)}clear(){this.messages=[],this.valueChange.emit(this.messages)}removeMessage(e){this.messages=this.messages.filter((o,r)=>r!==e),this.valueChange.emit(this.messages)}get icon(){const e=this.severity||(this.hasMessages()?this.messages[0].severity:null);if(this.hasMessages())switch(e){case"success":return"pi-check";case"info":default:return"pi-info-circle";case"error":return"pi-times";case"warn":return"pi-exclamation-triangle"}return null}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.timerSubscriptions?.forEach(e=>e.unsubscribe())}startMessageLifes(e){e?.forEach(o=>o.life&&this.startMessageLife(o))}startMessageLife(e){const o=ZF(e.life).subscribe(()=>{this.messages=this.messages?.filter(r=>r!==e),this.timerSubscriptions=this.timerSubscriptions?.filter(r=>r!==o),this.valueChange.emit(this.messages),this.cd.markForCheck()});this.timerSubscriptions.push(o)}}return t.\u0275fac=function(e){return new(e||t)(ce(Rd,8),ce(gi),ce(Fo))},t.\u0275cmp=Qt({type:t,selectors:[["p-messages"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},hostAttrs:[1,"p-element"],inputs:{value:"value",closable:"closable",style:"style",styleClass:"styleClass",enableService:"enableService",key:"key",escape:"escape",severity:"severity",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{valueChange:"valueChange"},decls:4,vars:5,consts:[["role","alert",1,"p-messages","p-component",3,"ngStyle"],[4,"ngIf","ngIfElse"],["staticMessage",""],["role","alert",3,"class",4,"ngFor","ngForOf"],["role","alert"],[1,"p-message-wrapper"],[3,"ngClass"],["escapeOut",""],["class","p-message-close p-link","type","button","pRipple","",3,"click",4,"ngIf"],["class","p-message-summary",3,"innerHTML",4,"ngIf"],["class","p-message-detail",3,"innerHTML",4,"ngIf"],[1,"p-message-summary",3,"innerHTML"],[1,"p-message-detail",3,"innerHTML"],["class","p-message-summary",4,"ngIf"],["class","p-message-detail",4,"ngIf"],[1,"p-message-summary"],[1,"p-message-detail"],["type","button","pRipple","",1,"p-message-close","p-link",3,"click"],[1,"p-message-close-icon","pi","pi-times"],["role","alert",3,"ngClass"],[4,"ngTemplateOutlet"]],template:function(e,o){if(1&e&&(P(0,"div",0),W(1,The,2,1,"ng-container",1),W(2,Ehe,3,2,"ng-template",null,2,Ua),N()),2&e){const r=Un(3);Zn(o.styleClass),L("ngStyle",o.style),F(1),L("ngIf",!o.contentTemplate)("ngIfElse",r)}},dependencies:[ao,Ns,Xn,Cs,ho,Iu],styles:[".p-message-wrapper{display:flex;align-items:center}.p-message-close{display:flex;align-items:center;justify-content:center}.p-message-close.p-link{margin-left:auto;overflow:hidden;position:relative}.p-messages .p-message.ng-animating{overflow:hidden}\n"],encapsulation:2,data:{animation:[pl("messageAnimation",[qo(":enter",[po({opacity:0,transform:"translateY(-25%)"}),$o("{{showTransitionParams}}")]),qo(":leave",[$o("{{hideTransitionParams}}",po({height:0,marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,opacity:0}))])])]},changeDetection:0}),t})(),Gy=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,ml]}),t})();const Ihe=["input"];function Dhe(t,n){if(1&t){const e=Ye();P(0,"i",5),Te("click",function(){return be(e),ve(U().clear())}),N()}}function Mhe(t,n){if(1&t){const e=Ye();P(0,"i",6),Te("click",function(){return be(e),ve(U().onMaskToggle())}),wo(1,"mapper"),N()}if(2&t){const e=U();L("ngClass",zl(1,1,e.unmasked,e.toggleIconClass))}}function khe(t,n){1&t&&$t(0)}function Ahe(t,n){1&t&&$t(0)}function Phe(t,n){if(1&t&&(wn(0),W(1,Ahe,1,0,"ng-container",8),Pn()),2&t){const e=U(2);F(1),L("ngTemplateOutlet",e.contentTemplate)}}const Ohe=function(t){return{width:t}};function Lhe(t,n){if(1&t&&(P(0,"div",11),Ae(1,"div",0),wo(2,"mapper"),N(),P(3,"div",12),ie(4),N()),2&t){const e=U(2);F(1),L("ngClass",zl(2,3,e.meter,e.strengthClass))("ngStyle",Wt(6,Ohe,e.meter?e.meter.width:"")),F(3),Ut(e.infoText)}}function Rhe(t,n){1&t&&$t(0)}const Fhe=function(t,n){return{showTransitionParams:t,hideTransitionParams:n}},Nhe=function(t){return{value:"visible",params:t}};function zhe(t,n){if(1&t){const e=Ye();P(0,"div",6,7),Te("click",function(r){return be(e),ve(U().onOverlayClick(r))})("@overlayAnimation.start",function(r){return be(e),ve(U().onAnimationStart(r))})("@overlayAnimation.done",function(r){return be(e),ve(U().onAnimationEnd(r))}),W(2,khe,1,0,"ng-container",8),W(3,Phe,2,1,"ng-container",9),W(4,Lhe,5,8,"ng-template",null,10,Ua),W(6,Rhe,1,0,"ng-container",8),N()}if(2&t){const e=Un(5),o=U();L("ngClass","p-password-panel p-component")("@overlayAnimation",Wt(9,Nhe,Ji(6,Fhe,o.showTransitionOptions,o.hideTransitionOptions))),F(2),L("ngTemplateOutlet",o.headerTemplate),F(1),L("ngIf",o.contentTemplate)("ngIfElse",e),F(3),L("ngTemplateOutlet",o.footerTemplate)}}let Bhe=(()=>{class t{transform(e,o,...r){return o(e,...r)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=Hr({name:"mapper",type:t,pure:!0}),t})();const Vhe={provide:zs,useExisting:Ei(()=>KB),multi:!0};let KB=(()=>{class t{constructor(e,o,r,s){this.cd=e,this.config=o,this.el=r,this.overlayService=s,this.mediumRegex="^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})",this.strongRegex="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})",this.feedback=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.showClear=!1,this.onFocus=new ht,this.onBlur=new ht,this.onClear=new ht,this.overlayVisible=!1,this.focused=!1,this.unmasked=!1,this.value=null,this.onModelChange=()=>{},this.onModelTouched=()=>{}}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"content":default:this.contentTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngOnInit(){this.infoText=this.promptText(),this.mediumCheckRegExp=new RegExp(this.mediumRegex),this.strongCheckRegExp=new RegExp(this.strongRegex),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.updateUI(this.value||"")})}onAnimationStart(e){switch(e.toState){case"visible":this.overlay=e.element,Ir.set("overlay",this.overlay,this.config.zIndex.overlay),this.appendContainer(),this.alignOverlay(),this.bindScrollListener(),this.bindResizeListener();break;case"void":this.unbindScrollListener(),this.unbindResizeListener(),this.overlay=null}}onAnimationEnd(e){"void"===e.toState&&Ir.clear(e.element)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):document.getElementById(this.appendTo).appendChild(this.overlay))}alignOverlay(){this.appendTo?(this.overlay.style.minWidth=Ne.getOuterWidth(this.input.nativeElement)+"px",Ne.absolutePosition(this.overlay,this.input.nativeElement)):Ne.relativePosition(this.overlay,this.input.nativeElement)}onInput(e){this.value=e.target.value,this.onModelChange(this.value)}onInputFocus(e){this.focused=!0,this.feedback&&(this.overlayVisible=!0),this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.feedback&&(this.overlayVisible=!1),this.onModelTouched(),this.onBlur.emit(e)}onKeyDown(e){"Escape"===e.key&&(this.overlayVisible=!1)}onKeyUp(e){this.feedback&&(this.updateUI(e.target.value),this.overlayVisible||(this.overlayVisible=!0))}updateUI(e){let o=null,r=null;switch(this.testStrength(e)){case 1:o=this.weakText(),r={strength:"weak",width:"33.33%"};break;case 2:o=this.mediumText(),r={strength:"medium",width:"66.66%"};break;case 3:o=this.strongText(),r={strength:"strong",width:"100%"};break;default:o=this.promptText(),r=null}this.meter=r,this.infoText=o}onMaskToggle(){this.unmasked=!this.unmasked}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}testStrength(e){let o=0;return this.strongCheckRegExp.test(e)?o=3:this.mediumCheckRegExp.test(e)?o=2:e.length&&(o=1),o}writeValue(e){this.value=void 0===e?null:e,this.feedback&&this.updateUI(this.value||""),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new w0(this.input.nativeElement,()=>{this.overlayVisible&&(this.overlayVisible=!1)})),this.scrollHandler.bindScrollListener()}bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&!Ne.isTouchDevice()&&(this.overlayVisible=!1)},window.addEventListener("resize",this.resizeListener))}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)}containerClass(e){return{"p-password p-component p-inputwrapper":!0,"p-input-icon-right":e}}inputFieldClass(e){return{"p-password-input":!0,"p-disabled":e}}toggleIconClass(e){return e?"pi pi-eye-slash":"pi pi-eye"}strengthClass(e){return`p-password-strength ${e?e.strength:""}`}filled(){return null!=this.value&&this.value.toString().length>0}promptText(){return this.promptLabel||this.getTranslation(zr.PASSWORD_PROMPT)}weakText(){return this.weakLabel||this.getTranslation(zr.WEAK)}mediumText(){return this.mediumLabel||this.getTranslation(zr.MEDIUM)}strongText(){return this.strongLabel||this.getTranslation(zr.STRONG)}restoreAppend(){this.overlay&&this.appendTo&&("body"===this.appendTo?document.body.removeChild(this.overlay):document.getElementById(this.appendTo).removeChild(this.overlay))}inputType(e){return e?"text":"password"}getTranslation(e){return this.config.getTranslation(e)}clear(){this.value=null,this.onModelChange(this.value),this.writeValue(this.value),this.onClear.emit()}ngOnDestroy(){this.overlay&&(Ir.clear(this.overlay),this.overlay=null),this.restoreAppend(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.translationSubscription&&this.translationSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(ce(Fo),ce(fl),ce(gi),ce(y0))},t.\u0275cmp=Qt({type:t,selectors:[["p-password"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&pi(Ihe,5),2&e){let r;gn(r=_n())&&(o.input=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:8,hostBindings:function(e,o){2&e&&Ro("p-inputwrapper-filled",o.filled())("p-inputwrapper-focus",o.focused)("p-password-clearable",o.showClear)("p-password-mask",o.toggleMask)},inputs:{ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",label:"label",disabled:"disabled",promptLabel:"promptLabel",mediumRegex:"mediumRegex",strongRegex:"strongRegex",weakLabel:"weakLabel",mediumLabel:"mediumLabel",maxLength:"maxLength",strongLabel:"strongLabel",inputId:"inputId",feedback:"feedback",appendTo:"appendTo",toggleMask:"toggleMask",inputStyleClass:"inputStyleClass",panelStyle:"panelStyle",panelStyleClass:"panelStyleClass",styleClass:"styleClass",style:"style",inputStyle:"inputStyle",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",placeholder:"placeholder",showClear:"showClear"},outputs:{onFocus:"onFocus",onBlur:"onBlur",onClear:"onClear"},features:[zi([Vhe])],decls:9,vars:28,consts:[[3,"ngClass","ngStyle"],["pInputText","",3,"ngClass","ngStyle","value","input","focus","blur","keyup","keydown"],["input",""],["class","p-password-clear-icon pi pi-times",3,"click",4,"ngIf"],[3,"ngClass","click",4,"ngIf"],[1,"p-password-clear-icon","pi","pi-times",3,"click"],[3,"ngClass","click"],["overlay",""],[4,"ngTemplateOutlet"],[4,"ngIf","ngIfElse"],["content",""],[1,"p-password-meter"],["className","p-password-info"]],template:function(e,o){1&e&&(P(0,"div",0),wo(1,"mapper"),P(2,"input",1,2),Te("input",function(s){return o.onInput(s)})("focus",function(s){return o.onInputFocus(s)})("blur",function(s){return o.onInputBlur(s)})("keyup",function(s){return o.onKeyUp(s)})("keydown",function(s){return o.onKeyDown(s)}),wo(4,"mapper"),wo(5,"mapper"),N(),W(6,Dhe,1,0,"i",3),W(7,Mhe,2,4,"i",4),W(8,zhe,7,11,"div",4),N()),2&e&&(Zn(o.styleClass),L("ngClass",zl(1,19,o.toggleMask,o.containerClass))("ngStyle",o.style),F(2),Zn(o.inputStyleClass),L("ngClass",zl(4,22,o.disabled,o.inputFieldClass))("ngStyle",o.inputStyle)("value",o.value),at("label",o.label)("aria-label",o.ariaLabel)("aria-labelledBy",o.ariaLabelledBy)("id",o.inputId)("type",zl(5,25,o.unmasked,o.inputType))("placeholder",o.placeholder)("maxlength",o.maxLength),F(4),L("ngIf",o.showClear&&null!=o.value),F(1),L("ngIf",o.toggleMask),F(1),L("ngIf",o.overlayVisible))},dependencies:[ao,Xn,Cs,ho,_l,Bhe],styles:[".p-password{position:relative;display:inline-flex}.p-password-panel{position:absolute;top:0;left:0}.p-password .p-password-panel{min-width:100%}.p-password-meter{height:10px}.p-password-strength{height:100%;width:0%;transition:width 1s ease-in-out}.p-fluid .p-password{display:flex}.p-password-input::-ms-reveal,.p-password-input::-ms-clear{display:none}.p-password-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-password-clearable{position:relative}\n"],encapsulation:2,data:{animation:[pl("overlayAnimation",[qo(":enter",[po({opacity:0,transform:"scaleY(0.8)"}),$o("{{showTransitionParams}}")]),qo(":leave",[$o("{{hideTransitionParams}}",po({opacity:0}))])])]},changeDetection:0}),t})(),ST=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Nf,hs]}),t})();function Uhe(t,n){1&t&&(P(0,"div",27)(1,"span",28),ie(2,"Introduzca una contrase\xf1a"),N()())}function jhe(t,n){1&t&&(P(0,"div",27)(1,"span",28),ie(2,"La contrase\xf1a debe tener 8 caracteres como m\xednimo"),N()())}function Hhe(t,n){1&t&&(P(0,"div",27)(1,"span",28),ie(2,"Introduzca una contrase\xf1a"),N()())}function $he(t,n){1&t&&(P(0,"div",27)(1,"span",28),ie(2,"Introduzca una contrase\xf1a"),N()())}function Ghe(t,n){1&t&&(P(0,"div",27)(1,"span",28),ie(2,"Las contrase\xf1as no coinciden"),N()())}function Whe(t,n){1&t&&(Ae(0,"i",29),P(1,"span",30),ie(2,"La contrase\xf1a actual es incorrecta."),N())}function qhe(t,n){1&t&&Ae(0,"p-progressSpinner",31)}function Zhe(t,n){1&t&&(P(0,"mat-icon",32),ie(1,"check"),N())}const Khe=function(){return{width:"600px"}},Xhe=function(){return{"650px":"95vw"}};let Yhe=(()=>{class t{constructor(){this.showDialog=new ht,this.loading=!1,this.acceptLabel="Aceptar",this.displaySuccess=!1}ngOnInit(){this.updatePwd=new Qs({oldPassword:new Sr(this.oldPassword,[pr.required]),newPassword:new Sr(this.newPassword,[pr.required,pr.minLength(8)]),newPasswordConfirm:new Sr(this.newPasswordConfirm,[pr.required])})}onSubmit(e){var o=this;return Ft(function*(){o.loading=!0,o.acceptLabel="Actualizando...",yield new Promise(r=>setTimeout(r,500)),o.cancel(),o.displaySuccess=!0})()}cancel(){this.showDialog.emit(!1),this.updatePwd.reset(),this.loading=!1,this.acceptLabel="Aceptar"}onHide(e){this.displaySuccess=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["app-edit-password-dialog"]],inputs:{display:"display"},outputs:{showDialog:"showDialog"},decls:49,vars:33,consts:[["header","Editar contrase\xf1a",3,"closable","visible","modal","draggable","breakpoints","visibleChange"],[3,"formGroup","ngSubmit"],[1,"md:px-3","pt-3",2,"transition","var(--transition)"],[1,"form-label-container"],["for","name",1,"block","mb-2"],[1,"flex"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-key"],["id","oldPassword","name","oldPassword","formControlName","oldPassword","placeholder","Contrase\xf1a actual","type","text",1,"form-control","w-full","h-3rem",3,"feedback","toggleMask"],["class","mb-2",4,"ngIf"],["id","newPassword","name","newPassword","formControlName","newPassword","placeholder","Contrase\xf1a","type","text",1,"form-control","w-full","h-3rem",3,"feedback","toggleMask"],["for","newPasswordConfirm",1,"block","mb-2"],["id","newPasswordConfirm","name","newPasswordConfirm","formControlName","newPasswordConfirm","placeholder","Confirmar contrase\xf1a","type","text",1,"ng-dirty","form-control","w-full","h-3rem",3,"feedback","toggleMask"],["severity","error"],["pTemplate",""],[1,"flex","card-container","blue-container","overflow-hidden","md:px-3","md:pb-3","pt-1",2,"transition","var(--transition)"],[1,"flex","align-items-center","justify-content-center","w-6"],["pButton","","pRipple","","type","button",1,"mt-2","mb-2","mr-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"text-pink-500","w-3rem"],[1,"text-pink-500","w-full"],["pButton","","pRipple","","type","submit",1,"mt-2","mb-2","ml-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],["class","text-green-500 w-3rem",4,"ngIf"],[1,"w-full"],["title","Contrase\xf1a actualizada","message","La contrase\xf1a se ha actualizado correctamente",3,"display","showDialog"],[1,"mb-2"],[1,"text-xs",2,"color","var(--validationErrors)"],[1,"pi","pi-exclamation-triangle","mr-2"],[1,"custom-message"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"],[1,"text-green-500","w-3rem"]],template:function(e,o){if(1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s}),P(1,"form",1),Te("ngSubmit",function(){return o.onSubmit(o.updatePwd)}),P(2,"div",2)(3,"div",3)(4,"label",4),ie(5,"Contase\xf1a actual"),N(),P(6,"div",5)(7,"span",6),Ae(8,"i",7),N(),Ae(9,"p-password",8),N(),W(10,Uhe,3,0,"div",9),N(),P(11,"div",3)(12,"label",4),ie(13,"Nueva contrase\xf1a"),N(),P(14,"div",5)(15,"span",6),Ae(16,"i",7),N(),Ae(17,"p-password",10),N(),W(18,jhe,3,0,"div",9),W(19,Hhe,3,0,"div",9),N(),P(20,"div",3)(21,"label",11),ie(22,"Confirmar contrase\xf1a"),N(),P(23,"div",5)(24,"span",6),Ae(25,"i",7),N(),Ae(26,"p-password",12),N(),W(27,$he,3,0,"div",9),W(28,Ghe,3,0,"div",9),N(),P(29,"p-messages",13),W(30,Whe,3,0,"ng-template",14),N()(),P(31,"div",15)(32,"div",16)(33,"button",17),Te("click",function(){return o.cancel()}),P(34,"div",18)(35,"span",19)(36,"mat-icon",20),ie(37,"close"),N(),P(38,"p",21),ie(39," Cancelar "),N()()()()(),P(40,"div",16)(41,"button",22)(42,"div",18)(43,"span",19),W(44,qhe,1,0,"p-progressSpinner",23),W(45,Zhe,2,0,"mat-icon",24),P(46,"p",25),ie(47),N()()()()()()()(),P(48,"app-success-dialog-edit",26),Te("showDialog",function(s){return o.onHide(s)}),N()),2&e){let r,s,l,h,f,y,C;Io(Kn(31,Khe)),L("closable",!1)("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",Kn(32,Xhe)),F(1),L("formGroup",o.updatePwd),F(8),L("feedback",!1)("toggleMask",!0),F(1),L("ngIf",(null==(r=o.updatePwd.get("oldPassword"))?null:r.hasError("required"))&&(o.updatePwd.controls.oldPassword.dirty||o.updatePwd.controls.oldPassword.touched)),F(7),L("feedback",!1)("toggleMask",!0),F(1),L("ngIf",(null==(s=o.updatePwd.get("newPassword"))?null:s.hasError("minlength"))&&(o.updatePwd.controls.newPassword.dirty||o.updatePwd.controls.newPassword.touched)),F(1),L("ngIf",(null==(l=o.updatePwd.get("newPassword"))?null:l.hasError("required"))&&(o.updatePwd.controls.newPassword.dirty||o.updatePwd.controls.newPassword.touched)),F(7),Ro("ng-invalid",(null==(h=o.updatePwd.get("newPassword"))?null:h.value)!=(null==(h=o.updatePwd.get("newPasswordConfirm"))?null:h.value)&&(o.updatePwd.controls.newPasswordConfirm.dirty||o.updatePwd.controls.newPasswordConfirm.touched)),L("feedback",!1)("toggleMask",!0),F(1),L("ngIf",(null==(f=o.updatePwd.get("newPasswordConfirm"))?null:f.hasError("required"))&&(o.updatePwd.controls.newPasswordConfirm.dirty||o.updatePwd.controls.newPasswordConfirm.touched)),F(1),L("ngIf",(null==(y=o.updatePwd.get("newPassword"))?null:y.value)!=(null==(y=o.updatePwd.get("newPasswordConfirm"))?null:y.value)&&!(null!=(y=o.updatePwd.get("newPasswordConfirm"))&&y.hasError("required"))&&(o.updatePwd.controls.newPasswordConfirm.dirty||o.updatePwd.controls.newPasswordConfirm.touched)),F(5),L("disabled",o.loading),F(8),L("disabled",!o.updatePwd.valid||o.loading||(null==(C=o.updatePwd.get("newPassword"))?null:C.value)!=(null==(C=o.updatePwd.get("newPasswordConfirm"))?null:C.value)),F(3),L("ngIf",o.loading),F(1),L("ngIf",!o.loading),F(1),Ro("text-green-500",!o.loading)("text-blue-500",o.loading),F(1),jn(" ",o.acceptLabel," "),F(1),L("display",o.displaySuccess)}},dependencies:[Xn,Dd,$a,Ed,vc,Md,Dr,fo,jl,_a,TT,KB,Mu,lM],styles:["[_nghost-%COMP%]     .p-password{width:100%;margin-bottom:1rem}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:var(--primary-color)!important}[_nghost-%COMP%]     .p-inputtext{width:100%;height:3rem;border-top-left-radius:0;border-bottom-left-radius:0}"]}),t})();function Qhe(t,n){if(1&t&&(P(0,"div",5),ie(1),N()),2&t){const e=U(2);za("display",null!=e.value&&0!==e.value?"flex":"none"),F(1),vf("",e.value,"",e.unit,"")}}function Jhe(t,n){if(1&t&&(P(0,"div",3),W(1,Qhe,2,4,"div",4),N()),2&t){const e=U();za("width",e.value+"%")("background",e.color),F(1),L("ngIf",e.showValue)}}function epe(t,n){if(1&t&&(P(0,"div",6),Ae(1,"div",7),N()),2&t){const e=U();F(1),za("background",e.color)}}const tpe=function(t,n){return{"p-progressbar p-component":!0,"p-progressbar-determinate":t,"p-progressbar-indeterminate":n}};let npe=(()=>{class t{constructor(){this.showValue=!0,this.unit="%",this.mode="determinate"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["p-progressBar"]],hostAttrs:[1,"p-element"],inputs:{value:"value",showValue:"showValue",style:"style",styleClass:"styleClass",unit:"unit",mode:"mode",color:"color"},decls:3,vars:10,consts:[["role","progressbar","aria-valuemin","0","aria-valuemax","100",3,"ngStyle","ngClass"],["class","p-progressbar-value p-progressbar-value-animate","style","display:flex",3,"width","background",4,"ngIf"],["class","p-progressbar-indeterminate-container",4,"ngIf"],[1,"p-progressbar-value","p-progressbar-value-animate",2,"display","flex"],["class","p-progressbar-label",3,"display",4,"ngIf"],[1,"p-progressbar-label"],[1,"p-progressbar-indeterminate-container"],[1,"p-progressbar-value","p-progressbar-value-animate"]],template:function(e,o){1&e&&(P(0,"div",0),W(1,Jhe,2,5,"div",1),W(2,epe,2,2,"div",2),N()),2&e&&(Zn(o.styleClass),L("ngStyle",o.style)("ngClass",Ji(7,tpe,"determinate"===o.mode,"indeterminate"===o.mode)),at("aria-valuenow",o.value),F(1),L("ngIf","determinate"===o.mode),F(1),L("ngIf","indeterminate"===o.mode))},dependencies:[ao,Xn,ho],styles:['.p-progressbar{position:relative;overflow:hidden}.p-progressbar-determinate .p-progressbar-value{height:100%;width:0%;position:absolute;display:none;border:0 none;display:flex;align-items:center;justify-content:center;overflow:hidden}.p-progressbar-determinate .p-progressbar-label{display:inline-flex}.p-progressbar-determinate .p-progressbar-value-animate{transition:width 1s ease-in-out}.p-progressbar-indeterminate .p-progressbar-value:before{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite}.p-progressbar-indeterminate .p-progressbar-value:after{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;animation-delay:1.15s}@keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}\n'],encapsulation:2,changeDetection:0}),t})(),XB=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();const ipe=["advancedfileinput"],ope=["basicfileinput"],rpe=["content"];function spe(t,n){if(1&t){const e=Ye();P(0,"p-button",17),Te("onClick",function(){return be(e),ve(U(2).upload())}),N()}if(2&t){const e=U(2);L("label",e.uploadButtonLabel)("icon",e.uploadIcon)("disabled",!e.hasFiles()||e.isFileLimitExceeded())("styleClass",e.uploadStyleClass)}}function ape(t,n){if(1&t){const e=Ye();P(0,"p-button",17),Te("onClick",function(){return be(e),ve(U(2).clear())}),N()}if(2&t){const e=U(2);L("label",e.cancelButtonLabel)("icon",e.cancelIcon)("disabled",!e.hasFiles()||e.uploading)("styleClass",e.cancelStyleClass)}}function lpe(t,n){1&t&&$t(0)}function cpe(t,n){1&t&&Ae(0,"p-progressBar",18),2&t&&L("value",U(2).progress)("showValue",!1)}function upe(t,n){if(1&t){const e=Ye();P(0,"img",26),Te("error",function(r){return be(e),ve(U(5).imageError(r))}),N()}if(2&t){const e=U().$implicit,o=U(4);L("src",e.objectURL,Ui)("width",o.previewWidth)}}function dpe(t,n){if(1&t){const e=Ye();P(0,"div",22)(1,"div"),W(2,upe,1,2,"img",23),N(),P(3,"div",24),ie(4),N(),P(5,"div"),ie(6),N(),P(7,"div")(8,"button",25),Te("click",function(r){const l=be(e).index;return ve(U(4).remove(r,l))}),N()()()}if(2&t){const e=n.$implicit,o=U(4);F(2),L("ngIf",o.isImage(e)),F(2),Ut(e.name),F(2),Ut(o.formatSize(e.size)),F(2),Zn(o.removeStyleClass),L("disabled",o.uploading)}}function hpe(t,n){if(1&t&&(P(0,"div"),W(1,dpe,9,6,"div",21),N()),2&t){const e=U(3);F(1),L("ngForOf",e.files)}}function ppe(t,n){}function fpe(t,n){if(1&t&&(P(0,"div"),W(1,ppe,0,0,"ng-template",27),N()),2&t){const e=U(3);F(1),L("ngForOf",e.files)("ngForTemplate",e.fileTemplate)}}function mpe(t,n){if(1&t&&(P(0,"div",19),W(1,hpe,2,1,"div",20),W(2,fpe,2,2,"div",20),N()),2&t){const e=U(2);F(1),L("ngIf",!e.fileTemplate),F(1),L("ngIf",e.fileTemplate)}}function gpe(t,n){1&t&&$t(0)}const _pe=function(t,n){return{"p-focus":t,"p-disabled":n}},ype=function(t){return{$implicit:t}};function vpe(t,n){if(1&t){const e=Ye();P(0,"div",2)(1,"div",3)(2,"span",4),Te("focus",function(){return be(e),ve(U().onFocus())})("blur",function(){return be(e),ve(U().onBlur())})("click",function(){return be(e),ve(U().choose())})("keydown.enter",function(){return be(e),ve(U().choose())}),P(3,"input",5,6),Te("change",function(r){return be(e),ve(U().onFileSelect(r))}),N(),Ae(5,"span",7),P(6,"span",8),ie(7),N()(),W(8,spe,1,4,"p-button",9),W(9,ape,1,4,"p-button",9),W(10,lpe,1,0,"ng-container",10),N(),P(11,"div",11,12),Te("dragenter",function(r){return be(e),ve(U().onDragEnter(r))})("dragleave",function(r){return be(e),ve(U().onDragLeave(r))})("drop",function(r){return be(e),ve(U().onDrop(r))}),W(13,cpe,1,2,"p-progressBar",13),Ae(14,"p-messages",14),W(15,mpe,3,2,"div",15),W(16,gpe,1,0,"ng-container",16),N()()}if(2&t){const e=U();Zn(e.styleClass),L("ngClass","p-fileupload p-fileupload-advanced p-component")("ngStyle",e.style),F(2),Zn(e.chooseStyleClass),L("ngClass",Ji(24,_pe,e.focus,e.disabled||e.isChooseDisabled())),F(1),L("multiple",e.multiple)("accept",e.accept)("disabled",e.disabled||e.isChooseDisabled()),at("title",""),F(2),Zn(e.chooseIcon),L("ngClass","p-button-icon p-button-icon-left"),F(2),Ut(e.chooseButtonLabel),F(1),L("ngIf",!e.auto&&e.showUploadButton),F(1),L("ngIf",!e.auto&&e.showCancelButton),F(1),L("ngTemplateOutlet",e.toolbarTemplate),F(3),L("ngIf",e.hasFiles()),F(1),L("value",e.msgs)("enableService",!1),F(1),L("ngIf",e.hasFiles()),F(1),L("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",Wt(27,ype,e.files))}}function bpe(t,n){if(1&t&&(P(0,"span",8),ie(1),N()),2&t){const e=U(2);F(1),Ut(e.basicButtonLabel)}}function xpe(t,n){if(1&t){const e=Ye();P(0,"input",33,34),Te("change",function(r){return be(e),ve(U(2).onFileSelect(r))})("focus",function(){return be(e),ve(U(2).onFocus())})("blur",function(){return be(e),ve(U(2).onBlur())}),N()}if(2&t){const e=U(2);L("accept",e.accept)("multiple",e.multiple)("disabled",e.disabled)}}const wpe=function(t,n,e,o){return{"p-button p-component p-fileupload-choose":!0,"p-button-icon-only":t,"p-fileupload-choose-selected":n,"p-focus":e,"p-disabled":o}};function Cpe(t,n){if(1&t){const e=Ye();P(0,"div",28),Ae(1,"p-messages",14),P(2,"span",29),Te("mouseup",function(){return be(e),ve(U().onBasicUploaderClick())})("keydown",function(r){return be(e),ve(U().onBasicKeydown(r))}),Ae(3,"span",30),W(4,bpe,2,1,"span",31),W(5,xpe,2,3,"input",32),N()()}if(2&t){const e=U();F(1),L("value",e.msgs)("enableService",!1),F(1),Zn(e.styleClass),L("ngClass",vu(9,wpe,!e.basicButtonLabel,e.hasFiles(),e.focus,e.disabled))("ngStyle",e.style),F(1),L("ngClass",e.hasFiles()&&!e.auto?e.uploadIcon:e.chooseIcon),F(1),L("ngIf",e.basicButtonLabel),F(1),L("ngIf",!e.hasFiles())}}let Tpe=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.sanitizer=o,this.zone=r,this.http=s,this.cd=l,this.config=h,this.method="post",this.invalidFileSizeMessageSummary="{0}: Invalid file size, ",this.invalidFileSizeMessageDetail="maximum upload size is {0}.",this.invalidFileTypeMessageSummary="{0}: Invalid file type, ",this.invalidFileTypeMessageDetail="allowed file types: {0}.",this.invalidFileLimitMessageDetail="limit is {0} at most.",this.invalidFileLimitMessageSummary="Maximum number of files exceeded, ",this.previewWidth=50,this.chooseIcon="pi pi-plus",this.uploadIcon="pi pi-upload",this.cancelIcon="pi pi-times",this.showUploadButton=!0,this.showCancelButton=!0,this.mode="advanced",this.onBeforeUpload=new ht,this.onSend=new ht,this.onUpload=new ht,this.onError=new ht,this.onClear=new ht,this.onRemove=new ht,this.onSelect=new ht,this.onProgress=new ht,this.uploadHandler=new ht,this.onImageError=new ht,this._files=[],this.progress=0,this.uploadedFileCount=0}set files(e){this._files=[];for(let o=0;o<e.length;o++){let r=e[o];this.validate(r)&&(this.isImage(r)&&(r.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(e[o]))),this._files.push(e[o]))}}get files(){return this._files}get basicButtonLabel(){return this.auto||!this.hasFiles()?this.chooseLabel:this.uploadLabel??this.files[0].name}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"file":default:this.fileTemplate=e.template;break;case"content":this.contentTemplate=e.template;break;case"toolbar":this.toolbarTemplate=e.template}})}ngOnInit(){this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()})}ngAfterViewInit(){"advanced"===this.mode&&this.zone.runOutsideAngular(()=>{this.content&&this.content.nativeElement.addEventListener("dragover",this.onDragOver.bind(this))})}choose(){this.advancedFileInput.nativeElement.click()}onFileSelect(e){if("drop"!==e.type&&this.isIE11()&&this.duplicateIEEvent)return void(this.duplicateIEEvent=!1);this.msgs=[],this.multiple||(this.files=[]);let o=e.dataTransfer?e.dataTransfer.files:e.target.files;for(let r=0;r<o.length;r++){let s=o[r];this.isFileSelected(s)||this.validate(s)&&(this.isImage(s)&&(s.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(o[r]))),this.files.push(o[r]))}this.onSelect.emit({originalEvent:e,files:o,currentFiles:this.files}),this.fileLimit&&"advanced"==this.mode&&this.checkFileLimit(),this.hasFiles()&&this.auto&&("advanced"!==this.mode||!this.isFileLimitExceeded())&&this.upload(),"drop"!==e.type&&this.isIE11()?this.clearIEInput():this.clearInputElement()}isFileSelected(e){for(let o of this.files)if(o.name+o.type+o.size===e.name+e.type+e.size)return!0;return!1}isIE11(){return!!window.MSInputMethodContext&&!!document.documentMode}validate(e){return this.msgs=[],this.accept&&!this.isFileTypeValid(e)?(this.msgs.push({severity:"error",summary:this.invalidFileTypeMessageSummary.replace("{0}",e.name),detail:this.invalidFileTypeMessageDetail.replace("{0}",this.accept)}),!1):!(this.maxFileSize&&e.size>this.maxFileSize&&(this.msgs.push({severity:"error",summary:this.invalidFileSizeMessageSummary.replace("{0}",e.name),detail:this.invalidFileSizeMessageDetail.replace("{0}",this.formatSize(this.maxFileSize))}),1))}isFileTypeValid(e){let o=this.accept.split(",").map(r=>r.trim());for(let r of o)if(this.isWildcard(r)?this.getTypeClass(e.type)===this.getTypeClass(r):e.type==r||this.getFileExtension(e).toLowerCase()===r.toLowerCase())return!0;return!1}getTypeClass(e){return e.substring(0,e.indexOf("/"))}isWildcard(e){return-1!==e.indexOf("*")}getFileExtension(e){return"."+e.name.split(".").pop()}isImage(e){return/^image\//.test(e.type)}onImageLoad(e){window.URL.revokeObjectURL(e.src)}upload(){if(this.customUpload)this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.uploadHandler.emit({files:this.files}),this.cd.markForCheck();else{this.uploading=!0,this.msgs=[];let e=new FormData;this.onBeforeUpload.emit({formData:e});for(let o=0;o<this.files.length;o++)e.append(this.name,this.files[o],this.files[o].name);this.http[this.method](this.url,e,{headers:this.headers,reportProgress:!0,observe:"events",withCredentials:this.withCredentials}).subscribe(o=>{switch(o.type){case Er.Sent:this.onSend.emit({originalEvent:o,formData:e});break;case Er.Response:this.uploading=!1,this.progress=0,o.status>=200&&o.status<300?(this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.onUpload.emit({originalEvent:o,files:this.files})):this.onError.emit({files:this.files}),this.clear();break;case Er.UploadProgress:o.loaded&&(this.progress=Math.round(100*o.loaded/o.total)),this.onProgress.emit({originalEvent:o,progress:this.progress})}this.cd.markForCheck()},o=>{this.uploading=!1,this.onError.emit({files:this.files,error:o})})}}clear(){this.files=[],this.onClear.emit(),this.clearInputElement(),this.cd.markForCheck()}remove(e,o){this.clearInputElement(),this.onRemove.emit({originalEvent:e,file:this.files[o]}),this.files.splice(o,1),this.checkFileLimit()}isFileLimitExceeded(){return this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount&&this.focus&&(this.focus=!1),this.fileLimit&&this.fileLimit<this.files.length+this.uploadedFileCount}isChooseDisabled(){return this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount}checkFileLimit(){this.msgs=[],this.isFileLimitExceeded()?this.msgs.push({severity:"error",summary:this.invalidFileLimitMessageSummary.replace("{0}",this.fileLimit.toString()),detail:this.invalidFileLimitMessageDetail.replace("{0}",this.fileLimit.toString())}):this.msgs=[]}clearInputElement(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.advancedFileInput.nativeElement.value=""),this.basicFileInput&&this.basicFileInput.nativeElement&&(this.basicFileInput.nativeElement.value="")}clearIEInput(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.duplicateIEEvent=!0,this.advancedFileInput.nativeElement.value="")}hasFiles(){return this.files&&this.files.length>0}onDragEnter(e){this.disabled||(e.stopPropagation(),e.preventDefault())}onDragOver(e){this.disabled||(Ne.addClass(this.content.nativeElement,"p-fileupload-highlight"),this.dragHighlight=!0,e.stopPropagation(),e.preventDefault())}onDragLeave(e){this.disabled||Ne.removeClass(this.content.nativeElement,"p-fileupload-highlight")}onDrop(e){if(!this.disabled){Ne.removeClass(this.content.nativeElement,"p-fileupload-highlight"),e.stopPropagation(),e.preventDefault();let o=e.dataTransfer?e.dataTransfer.files:e.target.files;(this.multiple||o&&1===o.length)&&this.onFileSelect(e)}}onFocus(){this.focus=!0}onBlur(){this.focus=!1}formatSize(e){if(0==e)return"0 B";let l=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,l)).toFixed(3))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][l]}onBasicUploaderClick(){this.hasFiles()?this.upload():this.basicFileInput.nativeElement.click()}onBasicKeydown(e){switch(e.code){case"Space":case"Enter":this.onBasicUploaderClick(),e.preventDefault()}}imageError(e){this.onImageError.emit(e)}getBlockableElement(){return this.el.nativeElement.children[0]}get chooseButtonLabel(){return this.chooseLabel||this.config.getTranslation(zr.CHOOSE)}get uploadButtonLabel(){return this.uploadLabel||this.config.getTranslation(zr.UPLOAD)}get cancelButtonLabel(){return this.cancelLabel||this.config.getTranslation(zr.CANCEL)}ngOnDestroy(){this.content&&this.content.nativeElement&&this.content.nativeElement.removeEventListener("dragover",this.onDragOver),this.translationSubscription&&this.translationSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(nw),ce(yi),ce(Tw),ce(Fo),ce(fl))},t.\u0275cmp=Qt({type:t,selectors:[["p-fileUpload"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&(pi(ipe,5),pi(ope,5),pi(rpe,5)),2&e){let r;gn(r=_n())&&(o.advancedFileInput=r.first),gn(r=_n())&&(o.basicFileInput=r.first),gn(r=_n())&&(o.content=r.first)}},hostAttrs:[1,"p-element"],inputs:{name:"name",url:"url",method:"method",multiple:"multiple",accept:"accept",disabled:"disabled",auto:"auto",withCredentials:"withCredentials",maxFileSize:"maxFileSize",invalidFileSizeMessageSummary:"invalidFileSizeMessageSummary",invalidFileSizeMessageDetail:"invalidFileSizeMessageDetail",invalidFileTypeMessageSummary:"invalidFileTypeMessageSummary",invalidFileTypeMessageDetail:"invalidFileTypeMessageDetail",invalidFileLimitMessageDetail:"invalidFileLimitMessageDetail",invalidFileLimitMessageSummary:"invalidFileLimitMessageSummary",style:"style",styleClass:"styleClass",previewWidth:"previewWidth",chooseLabel:"chooseLabel",uploadLabel:"uploadLabel",cancelLabel:"cancelLabel",chooseIcon:"chooseIcon",uploadIcon:"uploadIcon",cancelIcon:"cancelIcon",showUploadButton:"showUploadButton",showCancelButton:"showCancelButton",mode:"mode",headers:"headers",customUpload:"customUpload",fileLimit:"fileLimit",uploadStyleClass:"uploadStyleClass",cancelStyleClass:"cancelStyleClass",removeStyleClass:"removeStyleClass",chooseStyleClass:"chooseStyleClass",files:"files"},outputs:{onBeforeUpload:"onBeforeUpload",onSend:"onSend",onUpload:"onUpload",onError:"onError",onClear:"onClear",onRemove:"onRemove",onSelect:"onSelect",onProgress:"onProgress",uploadHandler:"uploadHandler",onImageError:"onImageError"},decls:2,vars:2,consts:[[3,"ngClass","ngStyle","class",4,"ngIf"],["class","p-fileupload p-fileupload-basic p-component",4,"ngIf"],[3,"ngClass","ngStyle"],[1,"p-fileupload-buttonbar"],["pRipple","","tabindex","0",1,"p-button","p-component","p-fileupload-choose",3,"ngClass","focus","blur","click","keydown.enter"],["type","file",3,"multiple","accept","disabled","change"],["advancedfileinput",""],[3,"ngClass"],[1,"p-button-label"],["type","button",3,"label","icon","disabled","styleClass","onClick",4,"ngIf"],[4,"ngTemplateOutlet"],[1,"p-fileupload-content",3,"dragenter","dragleave","drop"],["content",""],[3,"value","showValue",4,"ngIf"],[3,"value","enableService"],["class","p-fileupload-files",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button",3,"label","icon","disabled","styleClass","onClick"],[3,"value","showValue"],[1,"p-fileupload-files"],[4,"ngIf"],["class","p-fileupload-row",4,"ngFor","ngForOf"],[1,"p-fileupload-row"],[3,"src","width","error",4,"ngIf"],[1,"p-fileupload-filename"],["type","button","icon","pi pi-times","pButton","",3,"disabled","click"],[3,"src","width","error"],["ngFor","",3,"ngForOf","ngForTemplate"],[1,"p-fileupload","p-fileupload-basic","p-component"],["tabindex","0","pRipple","",3,"ngClass","ngStyle","mouseup","keydown"],[1,"p-button-icon","p-button-icon-left","pi",3,"ngClass"],["class","p-button-label",4,"ngIf"],["type","file",3,"accept","multiple","disabled","change","focus","blur",4,"ngIf"],["type","file",3,"accept","multiple","disabled","change","focus","blur"],["basicfileinput",""]],template:function(e,o){1&e&&(W(0,vpe,17,29,"div",0),W(1,Cpe,6,14,"div",1)),2&e&&(L("ngIf","advanced"===o.mode),F(1),L("ngIf","basic"===o.mode))},dependencies:[ao,Ns,Xn,Cs,ho,Dr,PK,npe,TT,Iu],styles:[".p-fileupload-content{position:relative}.p-fileupload-row{display:flex;align-items:center}.p-fileupload-row>div{flex:1 1 auto;width:25%}.p-fileupload-row>div:last-child{text-align:right}.p-fileupload-content .p-progressbar{width:100%;position:absolute;top:0;left:0}.p-button.p-fileupload-choose{position:relative;overflow:hidden}.p-button.p-fileupload-choose input[type=file],.p-fileupload-choose.p-fileupload-choose-selected input[type=file]{display:none}.p-fluid .p-fileupload .p-button{width:auto}.p-fileupload-filename{word-break:break-all}\n"],encapsulation:2,changeDetection:0}),t})(),ET=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,hs,gl,XB,Gy,ml,hs,gl,XB,Gy]}),t})();const Spe=["fileUpload"];function Epe(t,n){1&t&&(P(0,"div",19)(1,"h2",20),ie(2,"Editar foto de perfil"),N()())}function Ipe(t,n){1&t&&(Ae(0,"i",23),P(1,"span",24),ie(2,"Por favor especifique una imagen."),N())}function Dpe(t,n){1&t&&(P(0,"p-messages",21),W(1,Ipe,3,0,"ng-template",22),N())}function Mpe(t,n){1&t&&Ae(0,"p-progressSpinner",25)}function kpe(t,n){1&t&&(P(0,"mat-icon",26),ie(1,"check"),N())}const Ape=function(){return{width:"600px"}},Ppe=function(){return{"650px":"95vw"}};let Ope=(()=>{class t{constructor(e,o,r){this.fb=e,this.appLayout=o,this.ussersService=r,this.showDialog=new ht,this.imageUploaded=!1,this.loading=!1,this.error=!1,this.acceptLabel="Aceptar",this.displaySuccess=!1}ngOnInit(){this.form=this.fb.group({myFile:new Sr})}uploadFile(e){for(let o of e.files)this.form.patchValue({myFile:o}),this.form.get("myFile").updateValueAndValidity()}save(){var e=this;return Ft(function*(){if(e.loading=!0,e.acceptLabel="Actualizando...",e.fileUpload.upload(),null!=e.form.value.myFile){e.error=!1;try{yield e.ussersService.updateProfileImage(e.form.value.myFile),e.showDialog.emit(!1),e.loading=!1,e.acceptLabel="Aceptar",e.cancel(),e.displaySuccess=!0}catch(o){e.loading=!1,e.acceptLabel="Aceptar",403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.response.data.status})}}else e.imageUploaded=!1,e.error=!0})()}cancel(){this.imageUploaded=!1,this.error=!1,this.form.value.myFile=null,this.fileUpload.clear(),this.showDialog.emit(!1)}onHide(e){this.displaySuccess=e}}return t.\u0275fac=function(e){return new(e||t)(ce(c8),ce(Zo),ce(Mg))},t.\u0275cmp=Qt({type:t,selectors:[["app-image-upload-dialog"]],viewQuery:function(e,o){if(1&e&&pi(Spe,5),2&e){let r;gn(r=_n())&&(o.fileUpload=r.first)}},inputs:{display:"display"},outputs:{showDialog:"showDialog"},features:[zi([Dg])],decls:25,vars:22,consts:[[3,"closable","visible","modal","draggable","breakpoints","visibleChange"],["pTemplate","header","class","py-0"],[3,"formGroup"],[2,"transition","var(--transition)"],["mode","basic","chooseLabel","Subir foto",3,"customUpload","click","uploadHandler"],["fileUpload",""],["severity","error",4,"ngIf"],[1,"flex","mt-3"],[1,"flex-grow-1","flex","align-items-center","justify-content-center","w-6","mr-1"],["pButton","","pRipple","",1,"mt-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"text-pink-500","w-3rem"],[1,"text-pink-500","w-full"],[1,"flex-grow-1","flex","align-items-center","justify-content-center","w-6","ml-1"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],["class","text-green-500 w-3rem",4,"ngIf"],[1,"w-full"],["title","Imagen actualizada","message","La foto de perfil se ha actualizado correctamente",3,"display","showDialog"],[1,"flex","align-items-center","mb-1"],[1,"p-dialog-title"],["severity","error"],["pTemplate",""],[1,"pi","pi-exclamation-triangle","mr-2"],[1,"custom-message"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"],[1,"text-green-500","w-3rem"]],template:function(e,o){1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s}),W(1,Epe,3,0,"ng-template",1),P(2,"form",2)(3,"div",3)(4,"p-fileUpload",4,5),Te("click",function(){return o.imageUploaded=!0})("uploadHandler",function(s){return o.uploadFile(s)}),N(),W(6,Dpe,2,0,"p-messages",6),N()(),P(7,"div",7)(8,"div",8)(9,"button",9),Te("click",function(){return o.cancel()}),P(10,"div",10)(11,"span",11)(12,"mat-icon",12),ie(13,"close"),N(),P(14,"p",13),ie(15," Cancelar "),N()()()()(),P(16,"div",14)(17,"button",9),Te("click",function(){return o.save()}),P(18,"div",10)(19,"span",11),W(20,Mpe,1,0,"p-progressSpinner",15),W(21,kpe,2,0,"mat-icon",16),P(22,"p",17),ie(23),N()()()()()()(),P(24,"app-success-dialog-edit",18),Te("showDialog",function(s){return o.onHide(s)}),N()),2&e&&(Io(Kn(20,Ape)),L("closable",!1)("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",Kn(21,Ppe)),F(2),L("formGroup",o.form),F(2),L("customUpload",!0),F(2),L("ngIf",o.error),F(3),L("disabled",o.loading),F(8),L("disabled",!o.imageUploaded),F(3),L("ngIf",o.loading),F(1),L("ngIf",!o.loading),F(1),Ro("text-green-500",!o.loading)("text-blue-500",o.loading),F(1),jn(" ",o.acceptLabel," "),F(1),L("display",o.displaySuccess))},dependencies:[Xn,Dd,Ed,vc,Dr,fo,jl,_a,Tpe,TT,Mu,lM],styles:["[_nghost-%COMP%]     .p-message{margin-bottom:0!important}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:var(--primary-color)!important}"]}),t})();function Lpe(t,n){if(1&t&&(P(0,"div",4)(1,"h1",5),ie(2),N()()),2&t){const e=U();F(2),vf(" ",e.appLayout.currentRoute," de ",e.user.name," ")}}function Rpe(t,n){if(1&t&&Ae(0,"img",26),2&t){const e=U(2);Ai("src",e.user.profileImage,Ui),L("alt",e.user.name)}}function Fpe(t,n){1&t&&Ae(0,"img",27),2&t&&L("alt",U(2).user.name)}function Npe(t,n){if(1&t){const e=Ye();P(0,"button",28),Te("click",function(){return be(e),ve(U(2).showImageDialog())}),P(1,"div",29)(2,"mat-icon",30),ie(3,"edit"),N()()()}}function zpe(t,n){if(1&t){const e=Ye();P(0,"div",31)(1,"p-inputSwitch",32),Te("ngModelChange",function(r){return be(e),ve(U(2).pushNotificationsEnabled=r)})("click",function(){return be(e),ve(U(2).changedNotificationsPermissions())}),N(),P(2,"span",33),ie(3," Notificaciones "),N()()}if(2&t){const e=U(2);F(1),L("ngModel",e.pushNotificationsEnabled)}}function Bpe(t,n){if(1&t){const e=Ye();P(0,"div",34)(1,"button",35),Te("click",function(){return be(e),ve(U(2).showDialog())}),P(2,"span",36),ie(3,"Editar perfil"),N()(),P(4,"button",37),Te("click",function(){return be(e),ve(U(2).deleteAccount())}),P(5,"span",38),ie(6,"Borrar cuenta"),N()()()}}function Vpe(t,n){if(1&t){const e=Ye();P(0,"div",34)(1,"button",39),Te("click",function(){be(e);const r=U(2);return ve(r.deleteFriendship(r.user.userId))}),P(2,"span",38),ie(3,"Eliminar amigo"),N()()()}}function Upe(t,n){1&t&&(P(0,"span",36),ie(1,"Enviar solicitud"),N())}function jpe(t,n){1&t&&(P(0,"span",36),ie(1,"Solicitud enviada"),N())}function Hpe(t,n){if(1&t){const e=Ye();P(0,"div",34)(1,"button",40),Te("click",function(){be(e);const r=U(2);return ve(r.addFriendship(r.user.userId))}),W(2,Upe,2,0,"span",41),W(3,jpe,2,0,"span",41),N()()}if(2&t){const e=U(2);F(1),L("disabled",e.friendRequestSent),F(1),L("ngIf",!e.friendRequestSent),F(1),L("ngIf",e.friendRequestSent)}}function $pe(t,n){1&t&&Ae(0,"app-friends-carousel",42),2&t&&L("friends",U(2).misAmigos)}function Gpe(t,n){1&t&&(P(0,"h3",43),ie(1," An\xe1lisis de tu actividad por horas "),N())}function Wpe(t,n){if(1&t&&(P(0,"div",7)(1,"h2",44),ie(2," Tu actividad por horas "),N(),P(3,"div",45)(4,"canvas",46),ie(5),N()()()),2&t){const e=U(2);F(5),Ut(e.activityPerHourChart)}}function qpe(t,n){if(1&t&&(P(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9),W(4,Rpe,1,2,"img",10),W(5,Fpe,1,1,"img",11),W(6,Npe,4,0,"button",12),N()(),P(7,"div",13)(8,"div",14)(9,"h1",15),ie(10),N()(),P(11,"div",16)(12,"p",17),ie(13),N()(),P(14,"div",18)(15,"p",17),ie(16),N()(),W(17,zpe,4,1,"div",19),W(18,Bpe,7,0,"div",20),W(19,Vpe,4,0,"div",20),W(20,Hpe,4,3,"div",20),N()(),Ae(21,"app-carousel",21)(22,"app-carousel",22),W(23,$pe,1,1,"app-friends-carousel",23),W(24,Gpe,2,0,"h3",24),W(25,Wpe,6,1,"div",25),N()),2&t){const e=U();F(4),L("ngIf",""!=e.user.profileImage),F(1),L("ngIf",""==e.user.profileImage),F(1),L("ngIf",e.itsMe),F(4),jn(" ",e.user.name," "),F(3),jn(" @",e.user.nickname," "),F(3),w1("",e.user.numberPlaylists," playlists \xb7 ",e.user.numberFriends," amigos \xb7 ",e.user.numberVibes," vibes"),F(1),L("ngIf",e.itsMe&&e.navigatorAllowsPushNotifications),F(1),L("ngIf",e.itsMe),F(1),L("ngIf",!e.itsMe&&e.isFriend),F(1),L("ngIf",!e.itsMe&&!e.isFriend),F(1),L("carouselTitle",e.playlistTitle)("playlists",e.yourplaylists),F(1),L("playlists",e.following),F(1),L("ngIf",e.itsMe),F(1),L("ngIf",e.itsMe),F(1),L("ngIf",e.itsMe)}}function Zpe(t,n){1&t&&(P(0,"div",6),Ae(1,"app-loader"),N())}let YB=(()=>{class t{constructor(e,o,r,s,l,h,f,y,C){this.authService=e,this.route=o,this.playlistsService=r,this.appLayout=s,this.usersService=l,this.friendsService=h,this.confirmationService=f,this.titleService=y,this.pushNotificationsService=C,this.yourplaylists=[],this.following=[],this.misAmigos=[],this.userId="",this.pageLoading=!0,this.displayEditProfileDialog=!1,this.displayEditPwdDialog=!1,this.displayEditImageDialog=!1,this.isFriend=!1,this.friendRequestSent=!1,this.playlistTitle="Tus playlists",this.itsMe=!0,this.dataEmitter=new ht,this.pushNotificationsEnabled=!1,this.pushNotificationsOptions=[{label:"On",value:!0},{label:"Off",value:!1}],this.navigatorAllowsPushNotifications=!1,this.user=new bC}ngOnInit(){if(this.appLayout.currentRoute=" Perfil",this.appLayout.currentRouteId=7,this.userId=this.route.snapshot.paramMap.get("userId"),sessionStorage.getItem("userId")==this.userId?this.getUser():(this.itsMe=!1,this.getOtherUser(this.userId)),"serviceWorker"in navigator){this.navigatorAllowsPushNotifications=!0;let e=localStorage.getItem("pushNotifications");null!=e&&"active"==e&&(this.pushNotificationsEnabled=!0)}else console.log("Service worker not supported");this.appLayout.appComponent.changeColorSchemeEvent.subscribe(e=>{e?this.setDarkGrapics():this.setLightGrapics()})}showDialog(){this.displayEditProfileDialog=!0,this.dataEmitter.next(this.user)}showDialogPassword(){this.displayEditPwdDialog=!0}showImageDialog(){this.displayEditImageDialog=!0}hideDialogProfile(e){this.displayEditProfileDialog=e}updateUserData(e){this.user=e}hideDialogPassword(e){this.displayEditPwdDialog=e}hideDialogImage(e){this.displayEditImageDialog=e,this.getUser()}getUser(){var e=this;return Ft(function*(){try{const o=yield e.usersService.getMe(),r=yield e.playlistsService.getPlaylists();e.yourplaylists=r.myPlaylists,e.following=r.followedPlaylists,e.user=o.user,e.titleService.setTitle("Perfil de "+e.user.name+" | Spotivibes"),e.appLayout.user=o.user,e.pageLoading=!1,e.getActivityPerHour()}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}getOtherUser(e){var o=this;return Ft(function*(){try{const r=yield o.usersService.getOtherUser(e),s=yield o.playlistsService.getPlaylistsById(e);o.yourplaylists=s.myPlaylists,o.following=s.followedPlaylists,o.user=r.user,o.playlistTitle="Playlists de "+o.user.name,o.friendRequestSent=o.appLayout.user.friendsRequestsSentIds.includes(o.user.userId),o.isFriend=o.appLayout.user.friendsIds.includes(o.user.userId),o.pageLoading=!1}catch(r){403==r.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}})()}deleteAccount(){this.confirmationService.confirm({header:"Borrar cuenta",message:"\xbfSeguro que deseas borrar tu cuenta? Una vez borrada se eliminar\xe1n todos tus datos y no podr\xe1s recuperarlos.",acceptLabel:"Borrar cuenta",rejectLabel:"Cancelar",accept:()=>{try{this.usersService.deleteUser(),this.authService.logout()}catch(e){403==e.status?(this.appLayout.expired=!0,this.appLayout.displayExpiredDialog=!0):this.appLayout.messageService.add({severity:"error",summary:"Error",detail:e.data.status})}}})}deleteFriendship(e){var o=this;return Ft(function*(){var r;o.confirmationService.confirm({header:"Eliminar amigo",message:"\xbfSeguro que eliminar a"+o.user.name+" de tu lista de amigos?",acceptLabel:"Borrar amigo",rejectLabel:"Cancelar",accept:(r=Ft(function*(){try{yield o.friendsService.disconnectFriend(e),o.isFriend=!1}catch(s){403==s.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:s.data.status})}}),function(){return r.apply(this,arguments)})})})()}addFriendship(e){var o=this;return Ft(function*(){try{yield o.friendsService.sendFriendRequest(e),o.friendRequestSent=!0}catch(r){403==r.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}})()}changedNotificationsPermissions(){this.pushNotificationsEnabled?this.pushNotificationsService.registerPushNotifications():this.pushNotificationsService.unregisterPushNotifications()}getActivityPerHour(){var e=this;return Ft(function*(){try{const f=yield e.usersService.getActivityPerHour();var o=[],r=[],s=[],l=[],h=[];for(let y=0;y<f.hours.length;y++)o.push(f.hours[y].hour.replace("-","/").replace("-","/")),r.push(f.hours[y].numberLikesToVibes),s.push(f.hours[y].numberVibesCreated),l.push(f.hours[y].numberLikesToVibes),h.push(f.hours[y].numberPlaylistsCreated);e.activityPerHourChart=new Hy("activityPerHourChart",{type:"bar",data:{labels:o,datasets:[{label:"Likes a vibes por hora",data:r},{label:"Vibes creados por hora",data:s},{label:"Likes a playlists por hora",data:l},{label:"Playlists creadas por hora",data:h}]},options:{maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgb(137, 137, 137)"}}},scales:{}}}),"light_mode"!=e.appLayout.appComponent.themeIcon?e.setLightGrapics():e.setDarkGrapics()}catch(f){403==f.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:f.data.status})}})()}setLightGrapics(){this.activityPerHourChart.config._config.options.scales.x.grid.color="rgb(241, 241, 241)",this.activityPerHourChart.config._config.options.scales.y.grid.color="rgb(241, 241, 241)",this.activityPerHourChart.config._config.options.scales.x.ticks.color="rgb(73, 73, 73)",this.activityPerHourChart.config._config.options.scales.y.ticks.color="rgb(73, 73, 73)",this.activityPerHourChart.update()}setDarkGrapics(){this.activityPerHourChart.config._config.options.scales.x.grid.color="rgb(39, 57, 82)",this.activityPerHourChart.config._config.options.scales.y.grid.color="rgb(39, 57, 82)",this.activityPerHourChart.config._config.options.scales.x.ticks.color="rgb(91, 139, 204)",this.activityPerHourChart.config._config.options.scales.y.ticks.color="rgb(91, 139, 204)",this.activityPerHourChart.update()}}return t.\u0275fac=function(e){return new(e||t)(ce(AC),ce(Yh),ce(ku),ce(Zo),ce(Mg),ce(Py),ce(Dg),ce(_c),ce(WB))},t.\u0275cmp=Qt({type:t,selectors:[["app-profile"]],decls:6,vars:7,consts:[["class","route-name",4,"ngIf"],["class","content",4,"ngIf"],[3,"display","events","showDialog","userUpdated"],[3,"display","showDialog"],[1,"route-name"],[1,"current-route"],[1,"content"],[1,"containers","playlist-header"],[1,"playlist-image-container","justify-content-center"],[1,"relative"],["class","playlist-image","style","box-shadow: var(--shadows);",3,"src","alt",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","class","playlist-image","style","box-shadow: var(--shadows);",3,"alt",4,"ngIf"],["id","play-btn","class","z-2 absolute align-items-center justify-content-center vibe-btn play-icon border-circle border-none w-3rem h-3rem absolute-position-btn",3,"click",4,"ngIf"],[1,"playlist-desc-continer"],[1,"flex","align-items-center","mb-1"],[1,"text-7xl"],[1,"flex","align-items-center","mb-3"],[1,"m-0","text-xl","text-600"],[1,"flex","align-items-center","mb-2"],["class","mt-2 flex align-items-center justify-content-start",4,"ngIf"],["class","flex align-items-center align-content-center",4,"ngIf"],[3,"carouselTitle","playlists"],["carouselTitle","Siguiendo",3,"playlists"],[3,"friends",4,"ngIf"],["class","mb-4 hide-titles font-bold",4,"ngIf"],["class","containers playlist-header",4,"ngIf"],[1,"playlist-image",2,"box-shadow","var(--shadows)",3,"src","alt"],["src","assets/images/profilePlaceholder.svg",1,"playlist-image",2,"box-shadow","var(--shadows)",3,"alt"],["id","play-btn",1,"z-2","absolute","align-items-center","justify-content-center","vibe-btn","play-icon","border-circle","border-none","w-3rem","h-3rem","absolute-position-btn",3,"click"],[1,"flex","align-items-center","justify-content-center","border-circle"],[2,"color","black"],[1,"mt-2","flex","align-items-center","justify-content-start"],[1,"flex","align-itmes-center","mr-2",3,"ngModel","ngModelChange","click"],[1,"flex","align-itmes-center","text-base","text-600"],[1,"flex","align-items-center","align-content-center"],["type","button",1,"mr-2","button-width","p-button-text","mt-3","border-round-xl","h-3rem","vibe-btn",3,"click"],[1,"vibe-btn-text"],["type","button",1,"ml-2","button-width","p-button-text","mt-3","border-round-xl","h-3rem","vibe-btn","delete-btn",3,"click"],[1,""],["type","button",1,"button-width","p-button-text","mt-3","border-round-xl","h-3rem","vibe-btn","delete-btn",3,"click"],["type","button",1,"button-width","p-button-text","mt-5","border-round-xl","h-3rem","vibe-btn",3,"disabled","click"],["class","vibe-btn-text",4,"ngIf"],[3,"friends"],[1,"mb-4","hide-titles","font-bold"],[1,"show-titles-sm","mb-2","text-center","card-titles"],[1,"chart-full-container"],["id","activityPerHourChart"]],template:function(e,o){1&e&&(W(0,Lpe,3,2,"div",0),W(1,qpe,26,18,"div",1),W(2,Zpe,2,0,"div",1),P(3,"app-edit-profile-dialog",2),Te("showDialog",function(s){return o.hideDialogProfile(s)})("userUpdated",function(s){return o.updateUserData(s)}),N(),P(4,"app-edit-password-dialog",3),Te("showDialog",function(s){return o.hideDialogPassword(s)}),N(),P(5,"app-image-upload-dialog",3),Te("showDialog",function(s){return o.hideDialogImage(s)}),N()),2&e&&(L("ngIf",!o.appLayout.showBar),F(1),L("ngIf",!o.pageLoading),F(1),L("ngIf",o.pageLoading),F(1),L("display",o.displayEditProfileDialog)("events",o.dataEmitter.asObservable()),F(1),L("display",o.displayEditPwdDialog),F(1),L("display",o.displayEditImageDialog))},dependencies:[Xn,$a,_a,Id,qB,Yde,cN,hhe,Yhe,Ope,zd],styles:["[_nghost-%COMP%]{width:100%;height:100%}.playlist-header[_ngcontent-%COMP%]{transition:var(--transition);display:flex}.playlist-image-container[_ngcontent-%COMP%]{transition:var(--transition);display:flex;flex:0 1 auto;align-items:center;height:250px;width:250px}.playlist-image[_ngcontent-%COMP%]{height:250px;width:250px;object-fit:cover;border-radius:100%}.playlist-desc-continer[_ngcontent-%COMP%]{transition:var(--transition);display:flex;flex:1 1 auto;flex-direction:column;justify-content:flex-end;margin-left:2rem}.absolute-position-btn[_ngcontent-%COMP%]{right:30px;bottom:3px;cursor:pointer}.button-width[_ngcontent-%COMP%]{transition:var(--transition);width:11rem!important;font-size:.9rem}.delete-btn[_ngcontent-%COMP%]{background:var(--pink-400)!important;color:var(--surface-f)!important;font-size:var(--buttonsFontSize)}.delete-btn[_ngcontent-%COMP%]:hover{background:var(--pink-300)!important}.chart-full-container[_ngcontent-%COMP%]{transition:var(--transition);display:flex;align-items:center;align-content:center;justify-content:center;margin:auto;height:50vh;width:70vw}@media (max-width: 1200px){.playlist-header[_ngcontent-%COMP%]{flex-direction:column;width:100%;padding:1.5rem;text-align:center}.playlist-image-container[_ngcontent-%COMP%]{width:100%}.playlist-desc-continer[_ngcontent-%COMP%]{width:100%;align-items:center;margin-top:1rem;margin-left:0}.body-container[_ngcontent-%COMP%]{flex-direction:column;width:100%;margin-top:.25rem}}@media (max-width: 1300px){.chart-full-container[_ngcontent-%COMP%]{height:40vh;width:65vw}}@media (max-width: 1050px){.chart-full-container[_ngcontent-%COMP%]{height:35vh;width:55vw}}@media (max-width: 900px){.chart-full-container[_ngcontent-%COMP%]{height:30vh;width:50vw}}@media (max-width: 800px){.chart-full-container[_ngcontent-%COMP%]{height:30vh;width:45vw}}@media (max-width: 700px){.chart-full-container[_ngcontent-%COMP%]{height:30vh;width:80vw}}@media (max-width: 450px){.chart-full-container[_ngcontent-%COMP%]{height:40vh;width:80vw}}@media (max-width: 440px){.button-width[_ngcontent-%COMP%]{transition:var(--transition);width:9rem!important;font-size:.7rem}}"]}),t})();const QB=(t,n={})=>{const{action:e="start",duration:o=1e3,delay:r=16}=n;if("stop"===e)return void JB(t);if(JB(t),!/[0-9]/.test(t.innerHTML))return;const s=Kpe(t.innerHTML,{duration:o||t.getAttribute("data-duration"),delay:r||t.getAttribute("data-delay")});t._countUpOrigInnerHTML=t.innerHTML,t.innerHTML=s[0]||"&nbsp;",t.style.visibility="visible";const l=function(){t.innerHTML=s.shift()||"&nbsp;",s.length?(clearTimeout(t.countUpTimeout),t.countUpTimeout=setTimeout(l,r)):t._countUpOrigInnerHTML=void 0};t.countUpTimeout=setTimeout(l,r)},JB=t=>{clearTimeout(t.countUpTimeout),t._countUpOrigInnerHTML&&(t.innerHTML=t._countUpOrigInnerHTML,t._countUpOrigInnerHTML=void 0),t.style.visibility=""},Kpe=(t,n={})=>{const{duration:e=1e3,delay:o=16}=n,r=e/o,s=t.toString().split(/(<[^>]+>|[0-9.][,.0-9]*[0-9]*)/),l=[];for(let h=0;h<r;h++)l.push("");for(let h=0;h<s.length;h++)if(/([0-9.][,.0-9]*[0-9]*)/.test(s[h])&&!/<[^>]+>/.test(s[h])){let f=s[h];const y=[...f.matchAll(/[.,]/g)].map(D=>({char:D[0],i:f.length-D.index-1})).sort((D,R)=>D.i-R.i);f=f.replace(/[.,]/g,"");let C=l.length-1;for(let D=r;D>=1;D--){let R=parseInt(f/r*D,10);R=y.reduce((V,{char:$,i:X})=>V.length<=X?V:V.slice(0,-X)+$+V.slice(-X),R.toString()),l[C--]+=R}}else for(let f=0;f<r;f++)l[f]+=s[h];return l[l.length]=t.toString(),l};let cM=(()=>{class t{constructor(){}getUsers(){return Ft(function*(){const o=Qn_server+"/admin/users",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}getExcel(){return Ft(function*(){const o=Qn_server+"/admin/users/excel",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")},responseType:"blob"};try{const s=yield ui.get(o,r),l=new Blob([s.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),h=URL.createObjectURL(l),f=document.createElement("a");f.href=h,f.download="users.xlsx",document.body.appendChild(f),f.click(),document.body.removeChild(f)}catch(s){throw s.response}})()}getPdf(){return Ft(function*(){const o=Qn_server+"/admin/users/pdf",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")},responseType:"blob"};try{const s=yield ui.get(o,r),l=new Blob([s.data],{type:"application/pdf"}),h=URL.createObjectURL(l),f=document.createElement("a");f.href=h,f.download="users.pdf",document.body.appendChild(f),f.click(),document.body.removeChild(f)}catch(s){throw s.response}})()}blockUser(e){return Ft(function*(){const r=Qn_server+"/admin/users/"+e+"/block",s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.post(r,"",s)).data}catch(h){throw h.response}})()}unblockUser(e){return Ft(function*(){const r=Qn_server+"/admin/users/"+e+"/unblock",s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.delete(r,s)).data}catch(h){throw h.response}})()}getLoggedUsers(){return Ft(function*(){const o=Qn_server+"/admin/numberUsersLoggedThisMonth",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}getRegisteredUsers(){return Ft(function*(){const o=Qn_server+"/admin/numberUsersRegisteredThisMonth",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}getActivityPerHour(e){return Ft(function*(){var r=Qn_server+"/admin/activityPerHour";r=r+"?type="+e;const s={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(r,s)).data}catch(l){throw l.response}})()}getUsersRegisteredPerDay(){return Ft(function*(){const o=Qn_server+"/admin/numberUsersRegisteredPerDay",r={headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")}};try{return(yield ui.get(o,r)).data}catch(s){throw s.response}})()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=tn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Xpe(t,n){if(1&t&&(P(0,"div",3)(1,"h1",4),ie(2),N()()),2&t){const e=U();F(2),jn(" ",e.appLayout.currentRoute," ")}}function Ype(t,n){if(1&t&&(P(0,"div")(1,"div",5)(2,"div",6)(3,"div",7)(4,"h3",8),ie(5," Usuarios registrados por d\xeda "),N()(),P(6,"div",9)(7,"h3",8),ie(8," Usuarios logueados este mes "),N()()()(),P(9,"div",10)(10,"div",11)(11,"div",12)(12,"h2",13),ie(13," Usuarios registrados por d\xeda "),N(),P(14,"div",14)(15,"canvas",15),ie(16),N()()(),P(17,"div",16)(18,"div",17)(19,"h2",18),ie(20," Usuarios logueados este mes "),N(),P(21,"div",19)(22,"div",20)(23,"h1",21),ie(24),N(),P(25,"h3",22),ie(26,"Usuarios"),N()()()(),P(27,"h3",23),ie(28," Usuarios registrados este mes "),N(),P(29,"div",24)(30,"h2",18),ie(31," Usuarios registrados este mes "),N(),P(32,"div",19)(33,"div",20)(34,"h1",25),ie(35),N(),P(36,"h3",22),ie(37,"Usuarios"),N()()()()()()(),P(38,"div",26)(39,"div",6)(40,"div",7)(41,"h3",8),ie(42," Actividad por hora en Vibes"),N()()()(),P(43,"div",27)(44,"div",11)(45,"div",28)(46,"h2",13),ie(47," Actividad por hora en Vibes "),N(),P(48,"div",29)(49,"canvas",30),ie(50),N()()()()(),P(51,"div",31)(52,"div",6)(53,"div",7)(54,"h3",8),ie(55," Actividad por hora en Playlists"),N()()()(),P(56,"div",32)(57,"div",11)(58,"div",28)(59,"h2",13),ie(60," Actividad por hora en Playlists "),N(),P(61,"div",29)(62,"canvas",33),ie(63),N()()()()()()),2&t){const e=U();F(16),Ut(e.registeredPerDayChart),F(8),Ut(e.loggedUsersMonth),F(11),Ut(e.registeredUsersMonth),F(15),Ut(e.activityPerHourChart),F(13),Ut(e.activityPerHourChartPlaylists)}}function Qpe(t,n){1&t&&(P(0,"div",34),Ae(1,"app-loader"),N())}let Jpe=(()=>{class t{constructor(e,o,r){this.appLayout=e,this.adminService=o,this.titleService=r,this.pageLoading=!0,this.loggedUsersMonth=0,this.registeredUsersMonth=0,this.titleService.setTitle("Dashboard | Spotivibes")}ngOnInit(){this.getStatics(),this.appLayout.appComponent.changeColorSchemeEvent.subscribe(e=>{e?this.setDarkGrapics():this.setLightGrapics()})}getStatics(){var e=this;return Ft(function*(){try{const o=yield e.adminService.getLoggedUsers();e.loggedUsersMonth=o.numberUsers;const r=yield e.adminService.getRegisteredUsers();e.registeredUsersMonth=r.numberUsers;const l=(yield e.adminService.getUsersRegisteredPerDay()).days,h=l.map(_e=>_e.day.replace(/-/g,"/")),f=l.map(_e=>_e.numberUsers),y=yield e.adminService.getActivityPerHour("vibe"),C=y.hours.map(_e=>_e.hour.replace(/-/g,"/")),D=y.hours.map(_e=>_e.numberLikes),R=y.hours.map(_e=>_e.numberPosts),V=yield e.adminService.getActivityPerHour("playlist"),$=V.hours.map(_e=>_e.hour.replace(/-/g,"/")),X=V.hours.map(_e=>_e.numberLikes),ee=V.hours.map(_e=>_e.numberPosts);e.pageLoading=!1,yield new Promise(_e=>setTimeout(_e,10));const ue=document.querySelector(".counter-registered"),fe=document.querySelector(".counter-logged");QB(ue,{duration:2e3,delay:30}),QB(fe,{duration:2e3,delay:30}),e.registeredPerDayChart=new Hy("registeredPerDayChart",{type:"line",data:{labels:h,datasets:[{label:"Registros por d\xeda",data:f}]},options:{maintainAspectRatio:!1,scales:{y:{min:0},x:{min:0}}}}),e.activityPerHourChart=new Hy("activityPerHourChart",{type:"bar",data:{labels:C,datasets:[{label:"Likes por hora",data:D},{label:"Posts por hora",data:R}]},options:{maintainAspectRatio:!1}}),e.activityPerHourChartPlaylists=new Hy("activityPerHourChartPlaylists",{type:"bar",data:{labels:$,datasets:[{label:"Likes por hora",data:X},{label:"Posts por hora",data:ee}]},options:{maintainAspectRatio:!1}}),"light_mode"!=e.appLayout.appComponent.themeIcon?e.setLightGrapics():e.setDarkGrapics()}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.response.data.status})}})()}setLightGrapics(){const e="rgb(241, 241, 241)",o="rgb(73, 73, 73)";this.registeredPerDayChart.config._config.options.scales.x.grid.color=e,this.registeredPerDayChart.config._config.options.scales.y.grid.color=e,this.activityPerHourChart.config._config.options.scales.x.grid.color=e,this.activityPerHourChart.config._config.options.scales.y.grid.color=e,this.activityPerHourChartPlaylists.config._config.options.scales.x.grid.color=e,this.activityPerHourChartPlaylists.config._config.options.scales.y.grid.color=e,this.registeredPerDayChart.config._config.options.scales.x.ticks.color=o,this.registeredPerDayChart.config._config.options.scales.y.ticks.color=o,this.activityPerHourChart.config._config.options.scales.x.ticks.color=o,this.activityPerHourChart.config._config.options.scales.y.ticks.color=o,this.activityPerHourChartPlaylists.config._config.options.scales.x.ticks.color=o,this.activityPerHourChartPlaylists.config._config.options.scales.y.ticks.color=o,this.registeredPerDayChart.update(),this.activityPerHourChart.update(),this.activityPerHourChartPlaylists.update()}setDarkGrapics(){const e="rgb(39, 57, 82)",o="rgb(91, 139, 204)";this.registeredPerDayChart.config._config.options.scales.x.grid.color=e,this.registeredPerDayChart.config._config.options.scales.y.grid.color=e,this.activityPerHourChart.config._config.options.scales.x.grid.color=e,this.activityPerHourChart.config._config.options.scales.y.grid.color=e,this.activityPerHourChartPlaylists.config._config.options.scales.x.grid.color=e,this.activityPerHourChartPlaylists.config._config.options.scales.y.grid.color=e,this.registeredPerDayChart.config._config.options.scales.x.ticks.color=o,this.registeredPerDayChart.config._config.options.scales.y.ticks.color=o,this.activityPerHourChart.config._config.options.scales.x.ticks.color=o,this.activityPerHourChart.config._config.options.scales.y.ticks.color=o,this.activityPerHourChartPlaylists.config._config.options.scales.x.ticks.color=o,this.activityPerHourChartPlaylists.config._config.options.scales.y.ticks.color=o,this.registeredPerDayChart.update(),this.activityPerHourChart.update(),this.activityPerHourChartPlaylists.update()}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(cM),ce(_c))},t.\u0275cmp=Qt({type:t,selectors:[["app-dashboard"]],decls:3,vars:3,consts:[["class","route-name flex align-items-center",4,"ngIf"],[4,"ngIf"],["class","content",4,"ngIf"],[1,"route-name","flex","align-items-center"],[1,"current-route","w-full"],[1,"content","pb-0","mt-4","titles"],[1,"display-grid","gap-4"],[1,"m-0","flex-grow-1"],[1,"mb-2"],[1,"m-0","right-width"],[1,"content","sm-content","pb-0"],[1,"display-grid"],[1,"containers","m-0","p-5","flex-grow-1"],[1,"mb-2","text-center","card-titles","text-xl"],[1,"chart-container"],["id","registeredPerDayChart"],[1,"flex-column"],[1,"containers","m-0","p-5","right-width","align-items-center","justify-content-center"],[1,"text-center","card-titles","text-xl"],[1,"flex","align-items-center","align-content-center","justify-content-center","w-full","h-full"],[1,"align-items-center","align-content-center","justify-content-center",2,"display","grid","transition","var(--transition)"],[1,"counter-logged","mx-auto","text-gradient","text-8xl","font-bold"],[1,"mx-auto","text-center"],[1,"mb-2","title-number"],[1,"margin-sm","containers","p-5","right-width","align-items-center","justify-content-center"],[1,"counter-registered","mx-auto","text-gradient","text-8xl","font-bold"],[1,"content","py-0","mt-4","titles"],[1,"content","pt-0","margin-card"],[1,"containers","p-5","m-0","flex-grow-1"],[1,"chart-full-container"],["id","activityPerHourChart"],[1,"content","py-0","titles"],[1,"content","pt-0"],["id","activityPerHourChartPlaylists"],[1,"content"]],template:function(e,o){1&e&&(W(0,Xpe,3,1,"div",0),W(1,Ype,64,5,"div",1),W(2,Qpe,2,0,"div",2)),2&e&&(L("ngIf",!o.appLayout.showBar),F(1),L("ngIf",!o.pageLoading),F(1),L("ngIf",o.pageLoading))},dependencies:[Xn,zd],styles:["[_nghost-%COMP%]{width:100%}.display-grid[_ngcontent-%COMP%]{transition:var(--transition);display:flex;gap:3rem}.right-width[_ngcontent-%COMP%]{width:400px;min-width:400px;height:calc(50% - 26px)}.card-titles[_ngcontent-%COMP%]{display:none}.title-number[_ngcontent-%COMP%]{margin-top:20px}.chart-container[_ngcontent-%COMP%]{transition:var(--transition);display:flex;align-items:center;align-content:center;justify-content:center;margin:auto;height:60vh;width:55vw}.sm-content[_ngcontent-%COMP%]{padding-top:0!important}.chart-full-container[_ngcontent-%COMP%]{transition:var(--transition);display:flex;align-items:center;align-content:center;justify-content:center;margin:auto;height:50vh;width:70vw}@media (max-width: 2000px){.chart-container[_ngcontent-%COMP%]{height:50vh;width:50vw}}@media (max-width: 1800px){.chart-container[_ngcontent-%COMP%]{height:50vh;width:44vw}}@media (max-width: 1550px){.chart-container[_ngcontent-%COMP%]{height:45vh;width:36vw}}@media (max-width: 1300px){.display-grid[_ngcontent-%COMP%]{transition:var(--transition);display:grid;gap:1rem}.right-width[_ngcontent-%COMP%]{width:100%;padding:40px}.chart-container[_ngcontent-%COMP%]{height:45vh;width:65vw}.titles[_ngcontent-%COMP%]{display:none}.margin-card[_ngcontent-%COMP%]{margin-top:20px}.card-titles[_ngcontent-%COMP%]{display:block}.title-number[_ngcontent-%COMP%]{display:none}.margin-sm[_ngcontent-%COMP%]{margin-top:20px!important}.right-width[_ngcontent-%COMP%]{height:calc(50% - 10px)}.chart-full-container[_ngcontent-%COMP%]{height:40vh;width:65vw}}@media (max-width: 1050px){.chart-container[_ngcontent-%COMP%], .chart-full-container[_ngcontent-%COMP%]{height:35vh;width:55vw}}@media (max-width: 900px){.chart-container[_ngcontent-%COMP%], .chart-full-container[_ngcontent-%COMP%]{height:30vh;width:50vw}.containers[_ngcontent-%COMP%]{margin-bottom:0!important}}@media (max-width: 850px){.chart-container[_ngcontent-%COMP%], .chart-full-container[_ngcontent-%COMP%]{height:30vh;width:75vw}.right-width[_ngcontent-%COMP%]{width:auto;min-width:300px}.chart-container[_ngcontent-%COMP%]{height:30vh;width:55vw}}@media (max-width: 800px){.chart-container[_ngcontent-%COMP%], .chart-full-container[_ngcontent-%COMP%]{height:30vh;width:45vw}}@media (max-width: 700px){.margin-top-small[_ngcontent-%COMP%]{margin-top:4rem}.sm-content[_ngcontent-%COMP%]{padding-top:1.5rem!important}.chart-container[_ngcontent-%COMP%], .chart-full-container[_ngcontent-%COMP%]{height:30vh;width:75vw}}@media (max-width: 450px){.chart-container[_ngcontent-%COMP%], .chart-full-container[_ngcontent-%COMP%]{height:40vh;width:75vw}}"]}),t})();function efe(t,n){if(1&t){const e=Ye();P(0,"div",7)(1,"h4",8),ie(2," Usuarios encontrados "),N(),P(3,"div",9)(4,"span",10),Ae(5,"i",11),P(6,"input",12),Te("input",function(r){be(e);const s=U();return ve(Un(2).filterGlobal(s.getEventValue(r),"contains"))}),N()(),P(7,"div",13)(8,"button",14),Te("click",function(){return be(e),ve(U().downloadPdf())}),P(9,"span",15),ie(10," Exportar pdf "),N()(),P(11,"button",16),Te("click",function(){return be(e),ve(U().downloadExcel())}),P(12,"span",17),ie(13," Exportar excel "),N()()()()()}}function tfe(t,n){1&t&&(P(0,"tr")(1,"th",18)(2,"div",19),ie(3," Nombre "),Ae(4,"p-sortIcon",20),N()(),P(5,"th",18)(6,"div",19),ie(7," Id de usuario "),Ae(8,"p-sortIcon",20),N()(),P(9,"th",21)(10,"div",19),ie(11," Email "),Ae(12,"p-sortIcon",22),N()(),P(13,"th",23)(14,"div",19),ie(15," Nombre de usuario "),Ae(16,"p-sortIcon",24),N()(),P(17,"th",25)(18,"div",19),ie(19," Id de Spotify "),Ae(20,"p-sortIcon",26),N()(),P(21,"th",25)(22,"div",19),ie(23," Fecha de creaci\xf3n "),Ae(24,"p-sortIcon",26),N()(),P(25,"th",25)(26,"div",19),ie(27," Fecha de \xfaltimo acceso "),Ae(28,"p-sortIcon",26),N()(),P(29,"th",25)(30,"div",19),ie(31," N\xfamero de amigos "),Ae(32,"p-sortIcon",26),N()(),P(33,"th",25)(34,"div",19),ie(35," N\xfamero de vibes "),Ae(36,"p-sortIcon",26),N()(),P(37,"th",25)(38,"div",19),ie(39," N\xfamero de playlists "),Ae(40,"p-sortIcon",26),N()(),P(41,"th",27)(42,"div",28),ie(43," Bloquear cuenta "),N()()())}function nfe(t,n){if(1&t&&Ae(0,"img",38),2&t){const e=U().$implicit;Ai("src",e.profileImage,Ui),L("alt",e.name)}}function ife(t,n){1&t&&Ae(0,"img",39),2&t&&L("alt",U().$implicit.name)}function ofe(t,n){if(1&t){const e=Ye();P(0,"button",40),Te("click",function(){be(e);const r=U().$implicit;return ve(U().showBlockDialog(r.name,r.userId,r.blocked))}),P(1,"span",41),ie(2),N()()}if(2&t){const e=U().$implicit,o=U();L("disabled",o.loading&&o.loadingId==e.userId),F(2),jn("",e.blocked?"Desbloquear cuenta":"Bloquear cuenta"," ")}}function rfe(t,n){if(1&t&&(P(0,"tr")(1,"td",29)(2,"div",30)(3,"div",31),W(4,nfe,1,2,"img",32),W(5,ife,1,1,"img",33),N(),P(6,"div",34),ie(7),N()()(),P(8,"td",35),ie(9),N(),P(10,"td",35),ie(11),N(),P(12,"td",35),ie(13),N(),P(14,"td",35),ie(15),N(),P(16,"td",35),ie(17),wo(18,"date"),wo(19,"date"),N(),P(20,"td",35),ie(21),wo(22,"date"),wo(23,"date"),N(),P(24,"td",35),ie(25),N(),P(26,"td",35),ie(27),N(),P(28,"td",35),ie(29),N(),P(30,"td",29)(31,"div",36),W(32,ofe,3,2,"button",37),N()()()),2&t){const e=n.$implicit,o=U();F(4),L("ngIf",""!=e.profileImage),F(1),L("ngIf",""==e.profileImage),F(2),Ut(e.name),F(2),Ut(e.userId),F(2),Ut(e.email),F(2),Ut(e.nickname),F(2),Ut(e.spotifyId),F(2),vf(" ",zl(18,15,e.creationDate,"dd/MM/yyyy")," ",zl(19,18,e.creationDate,"HH:mm:ss")," "),F(4),vf(" ",zl(22,21,e.lastLoginDate,"dd/MM/yyyy")," ",zl(23,24,e.lastLoginDate,"HH:mm:ss")," "),F(4),Ut(e.numberFriends),F(2),Ut(e.numberVibes),F(2),Ut(e.numberPlaylists),F(3),L("ngIf",e.userId!=o.appLayout.user.userId)}}function sfe(t,n){1&t&&(P(0,"tr")(1,"td",42),ie(2,"No se han encontrado usuarios."),N()())}const afe=function(){return["name","email","userId"]};let lfe=(()=>{class t{constructor(e,o){this.adminService=e,this.appLayout=o,this.myDate=new Date,this.displayBlockDialog=!1,this.loading=!1,this.loadingId=""}getEventValue(e){return e.target.value}showBlockDialog(e,o,r){var y,s=this;this.appLayout.confirmationService.confirm({header:r?"Desbloquear usuario":"Bloquear usuario",message:r?"\xbfSeguro que deseas desbloquear a "+e+"?":"\xbfSeguro que deseas bloquear a "+e+"?",acceptLabel:r?"Desbloquear":"Bloquear",rejectLabel:"Cancelar",accept:(y=Ft(function*(){try{if(s.loading=!0,s.loadingId=o,r){yield s.adminService.unblockUser(o),s.appLayout.messageService.add({severity:"success",summary:"Usuario desbloqueado",detail:"Se ha desbloqueado a "+e});for(let C=0;C<s.users.length;C++)if(s.users[C].userId==o){s.users[C].blocked=!1;break}}else{yield s.adminService.blockUser(o),s.appLayout.messageService.add({severity:"success",summary:"Usuario bloqueado",detail:"Se ha bloqueado a "+e});for(let C=0;C<s.users.length;C++)if(s.users[C].userId==o){s.users[C].blocked=!0;break}}s.loading=!1}catch(C){403==C.status?s.appLayout.handle403Error():s.appLayout.messageService.add({severity:"error",summary:"Error",detail:C.data.status})}}),function(){return y.apply(this,arguments)})})}downloadPdf(){try{this.adminService.getPdf()}catch(e){403==e.status?this.appLayout.handle403Error():this.appLayout.messageService.add({severity:"error",summary:"Error",detail:e.data.status})}}downloadExcel(){try{this.adminService.getExcel()}catch(e){403==e.status?this.appLayout.handle403Error():this.appLayout.messageService.add({severity:"error",summary:"Error",detail:e.data.status})}}}return t.\u0275fac=function(e){return new(e||t)(ce(cM),ce(Zo))},t.\u0275cmp=Qt({type:t,selectors:[["app-admin-users-table"]],inputs:{users:"users"},features:[zi([Ab])],decls:7,vars:7,consts:[[1,"card","w-full","containers"],["data-cy","users-table",3,"value","paginator","rows","rowHover","showCurrentPageReport","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"table-header"],[1,"mb-3","align-text"],[1,"display-buttons"],[1,"p-input-icon-left","flex"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Nombre, email o userId",3,"input"],[1,"flex","center-buttons",2,"text-align","right"],[1,"mr-2","w-6rem","p-button-raised","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient",2,"border","none","height","37px !important",3,"click"],[1,"flex","justify-content-center","align-content-center","align-items-center","vibe-btn-text-white","font-normal","text-xs"],[1,"p-button-raised","w-6rem","p-button-width","p-button-text","border-round-xl","h-2rem","button-gradient",2,"border","none","height","37px !important",3,"click"],[1,"flex","justify-content-center","vibe-btn-text-white","font-normal","text-xs"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center","name-size"],["field","name"],["pSortableColumn","fechaRegistro"],["field","fechaRegistro"],["pSortableColumn","ultimoAcceso"],["field","ultimoAcceso"],["pSortableColumn","playlists"],["field","playlists"],["pSortableColumn","boton"],[1,"flex","justify-content-between","align-items-center","margin-td-right",2,"float","right"],[1,"padding-td"],[2,"display","flex","align-items","flex-start"],[1,"round-images-size"],["class","round-images round-images-size","style","opacity: 1 !important;",3,"src","alt",4,"ngIf"],["src","assets/images/profilePlaceholder.svg","class","round-images round-images-size","style","background: var(--containerBackground); opacity: 1 !important;",3,"alt",4,"ngIf"],[1,"ml-3","name-size",2,"height","40px","text-align","start","display","flex","align-items","center"],[1,"padding-td","name-size"],[1,"margin-td-right",2,"float","right"],["pButton","","pRipple","","type","button","class","border-round-xl h-2rem gradiente w-8rem","style","height: 35px !important;",3,"disabled","click",4,"ngIf"],[1,"round-images","round-images-size",2,"opacity","1 !important",3,"src","alt"],["src","assets/images/profilePlaceholder.svg",1,"round-images","round-images-size",2,"background","var(--containerBackground)","opacity","1 !important",3,"alt"],["pButton","","pRipple","","type","button",1,"border-round-xl","h-2rem","gradiente","w-8rem",2,"height","35px !important",3,"disabled","click"],[1,"vibe-btn-text-white","font-normal","text-xs"],["data-cy","no-users","colspan","8"]],template:function(e,o){1&e&&(P(0,"div",0)(1,"p-table",1,2),W(3,efe,14,0,"ng-template",3),W(4,tfe,44,0,"ng-template",4),W(5,rfe,33,27,"ng-template",5),W(6,sfe,3,0,"ng-template",6),N()()),2&e&&(F(1),L("value",o.users)("paginator",!0)("rows",20)("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",Kn(6,afe)))},dependencies:[Xn,Dr,fo,_l,Nd,E0,FC,Ab],styles:[".gradiente[_ngcontent-%COMP%]{background:black;box-shadow:var(--shadows);color:#fff!important}.display-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.gradiente[_ngcontent-%COMP%]:hover{background-color:gray!important}@media (max-width: 1000px){.display-buttons[_ngcontent-%COMP%]{display:grid!important;justify-content:center;gap:1rem}.center-buttons[_ngcontent-%COMP%]{justify-content:center}.align-text[_ngcontent-%COMP%]{text-align:center}}"]}),t})();function cfe(t,n){if(1&t&&(P(0,"div",2)(1,"h1",3),ie(2),N()()),2&t){const e=U();F(2),jn(" ",e.appLayout.currentRoute," ")}}function ufe(t,n){if(1&t&&(P(0,"div",4),Ae(1,"app-admin-users-table",5),N()),2&t){const e=U();F(1),L("users",e.users)}}function dfe(t,n){1&t&&(P(0,"div",4),Ae(1,"app-loader"),N())}let hfe=(()=>{class t{constructor(e,o,r){this.appLayout=e,this.adminService=o,this.titleService=r,this.pageLoading=!0,this.titleService.setTitle("Usuarios | Spotivibes")}ngOnInit(){this.getUsers()}getUsers(){var e=this;return Ft(function*(){try{const o=yield e.adminService.getUsers();e.users=o.user,e.pageLoading=!1}catch(o){403==o.status?e.appLayout.handle403Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(cM),ce(_c))},t.\u0275cmp=Qt({type:t,selectors:[["app-users"]],decls:3,vars:3,consts:[["class","route-name",4,"ngIf"],["class","content",4,"ngIf"],[1,"route-name"],[1,"current-route"],[1,"content"],[3,"users"]],template:function(e,o){1&e&&(W(0,cfe,3,1,"div",0),W(1,ufe,2,1,"div",1),W(2,dfe,2,0,"div",1)),2&e&&(L("ngIf",!o.appLayout.showBar),F(1),L("ngIf",!o.pageLoading),F(1),L("ngIf",o.pageLoading))},dependencies:[Xn,lfe,zd],styles:[".p-datatable .p-paginator-bottom{border-top-left-radius:0!important;border-top-right-radius:0!important}"]}),t})(),pfe=(()=>{class t{constructor(e){this.titleService=e,this.titleService.setTitle("No encontrado | Spotivibes")}goLanding(){window.location.href="/"}}return t.\u0275fac=function(e){return new(e||t)(ce(_c))},t.\u0275cmp=Qt({type:t,selectors:[["app-not-found"]],decls:11,vars:0,consts:[[2,"height","100vh","width","100%","background-image","var(--gradient45)"],[1,"flex","align-items-center","align-content-center","justify-content-center","w-full","h-full"],[1,"frostedBackground","align-items-center","align-content-center","justify-content-center","border-round-xl","window-width",2,"display","grid","transition","var(--transition)"],["alt","logo",1,"logo","m-auto","w-20rem"],[1,"mx-auto"],[1,"mx-auto","text-center"],["type","button",1,"mt-3","button-width","p-button-text","border-round-xl","h-3rem","vibe-btn",3,"click"],[1,"vibe-btn-text"]],template:function(e,o){1&e&&(P(0,"div",0)(1,"div",1)(2,"div",2),Ae(3,"img",3),P(4,"h1",4),ie(5,"Error 404"),N(),P(6,"p",5),ie(7,"Ooops! La p\xe1gina que est\xe1s buscando no existe"),N(),P(8,"button",6),Te("click",function(){return o.goLanding()}),P(9,"span",7),ie(10,"Ir a inicio"),N()()()()())},styles:[".frostedBackground[_ngcontent-%COMP%]{background:var(--frostedBackground);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:none;box-shadow:var(--shadows)}.window-width[_ngcontent-%COMP%]{width:50rem;padding:5rem}.logo[_ngcontent-%COMP%]{content:var(--logoFooter);background-size:cover;background-repeat:no-repeat;background-position:center;width:13rem}@media (max-width: 993px){.window-width[_ngcontent-%COMP%]{width:30rem!important;padding:2rem!important}}@media (max-height: 993px){.window-width[_ngcontent-%COMP%]{width:30rem!important;padding:2rem!important}}@media (max-width: 530px){.window-width[_ngcontent-%COMP%]{width:25rem!important;padding:1.5rem!important}}@media (max-height: 560px){.window-width[_ngcontent-%COMP%]{width:25rem!important;padding:1.5rem!important}}@media (max-width: 400px){.window-width[_ngcontent-%COMP%]{width:22rem!important;padding:1rem!important}}"]}),t})(),ffe=(()=>{class t{goLanding(){window.location.href="/"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["app-unauthorized"]],decls:11,vars:0,consts:[[2,"height","100vh","width","100%","background-image","var(--gradient45)"],[1,"flex","align-items-center","align-content-center","justify-content-center","w-full","h-full"],[1,"frostedBackground","align-items-center","align-content-center","justify-content-center","border-round-xl","window-width",2,"display","grid","transition","var(--transition)"],["alt","logo",1,"logo","m-auto","w-20rem"],[1,"mx-auto"],[1,"mx-auto","text-center"],["type","button",1,"mt-3","button-width","p-button-text","border-round-xl","h-3rem","vibe-btn",3,"click"],[1,"vibe-btn-text"]],template:function(e,o){1&e&&(P(0,"div",0)(1,"div",1)(2,"div",2),Ae(3,"img",3),P(4,"h1",4),ie(5,"Error 401"),N(),P(6,"p",5),ie(7,"No est\xe1s autorizado para visualizar este contenido"),N(),P(8,"button",6),Te("click",function(){return o.goLanding()}),P(9,"span",7),ie(10,"Ir a inicio"),N()()()()())},styles:[".frostedBackground[_ngcontent-%COMP%]{background:var(--frostedBackground);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:none;box-shadow:var(--shadows)}.window-width[_ngcontent-%COMP%]{width:50rem;padding:5rem}.logo[_ngcontent-%COMP%]{content:var(--logoFooter);background-size:cover;background-repeat:no-repeat;background-position:center;width:13rem}@media (max-width: 993px){.window-width[_ngcontent-%COMP%]{width:30rem!important;padding:2rem!important}}@media (max-height: 993px){.window-width[_ngcontent-%COMP%]{width:30rem!important;padding:2rem!important}}@media (max-width: 530px){.window-width[_ngcontent-%COMP%]{width:25rem!important;padding:1.5rem!important}}@media (max-height: 560px){.window-width[_ngcontent-%COMP%]{width:25rem!important;padding:1.5rem!important}}@media (max-width: 400px){.window-width[_ngcontent-%COMP%]{width:22rem!important;padding:1rem!important}}"]}),t})(),e4=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[Ic.forRoot([{path:"",component:jC},{path:"callback",component:jC},{path:"404",component:pfe},{path:"unauthorized",component:ffe},{path:"",component:Zo,children:[{path:"home",component:loe},{path:"playlists",component:Jre},{path:"playlists/:playlistId",component:kse},{path:"map",component:goe},{path:"friends",component:Ute},{path:"notifications",component:$oe},{path:"profile/:userId",component:YB},{path:"friendProfile/:userId",component:YB},{path:"admin/dashboard",component:Jpe},{path:"admin/users",component:hfe},{path:"**",redirectTo:"/404"}]}],{scrollPositionRestoration:"enabled",anchorScrolling:"enabled",onSameUrlNavigation:"reload"}),Ic]}),t})(),Wfe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Ic,Du,Ic,Du]}),t})(),tme=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Ic,Du,Ic,Du]}),t})(),IT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Ic,ml,Du,Ic,Du]}),t})();const Dme=["sublist"],Mme=function(t){return{"p-hidden":t}};function kme(t,n){if(1&t&&Ae(0,"li",5),2&t){const e=U().$implicit;L("ngClass",Wt(1,Mme,!1===e.visible))}}function Ame(t,n){if(1&t&&Ae(0,"span",17),2&t){const e=U(3).$implicit;L("ngClass",e.icon)("ngStyle",e.iconStyle)}}function Pme(t,n){if(1&t&&(P(0,"span",18),ie(1),N()),2&t){const e=U(3).$implicit;F(1),Ut(e.label)}}function Ome(t,n){1&t&&Ae(0,"span",19),2&t&&L("innerHTML",U(3).$implicit.label,Lh)}function Lme(t,n){if(1&t&&(P(0,"span",20),ie(1),N()),2&t){const e=U(3).$implicit;L("ngClass",e.badgeStyleClass),F(1),Ut(e.badge)}}function Rme(t,n){1&t&&Ae(0,"span",21)}const a4=function(t){return{"p-disabled":t}};function Fme(t,n){if(1&t){const e=Ye();P(0,"a",11),Te("keydown",function(r){return be(e),ve(U(3).onItemKeyDown(r))})("click",function(r){be(e),U();const s=Un(1),l=U().$implicit;return ve(U().itemClick(r,l,s))}),W(1,Ame,1,2,"span",12),W(2,Pme,2,1,"span",13),W(3,Ome,1,1,"ng-template",null,14,Ua),W(5,Lme,2,2,"span",15),W(6,Rme,1,0,"span",16),N()}if(2&t){const e=Un(4),o=U(2).$implicit,r=U();L("target",o.target)("ngClass",Wt(11,a4,o.disabled)),at("href",o.url,Ui)("title",o.title)("id",o.id)("tabindex",o.disabled||!r.isActive?null:"0"),F(1),L("ngIf",o.icon),F(1),L("ngIf",!1!==o.escape)("ngIfElse",e),F(3),L("ngIf",o.badge),F(1),L("ngIf",o.items)}}function Nme(t,n){if(1&t&&Ae(0,"span",17),2&t){const e=U(3).$implicit;L("ngClass",e.icon)("ngStyle",e.iconStyle)}}function zme(t,n){if(1&t&&(P(0,"span",18),ie(1),N()),2&t){const e=U(3).$implicit;F(1),Ut(e.label)}}function Bme(t,n){1&t&&Ae(0,"span",19),2&t&&L("innerHTML",U(3).$implicit.label,Lh)}function Vme(t,n){if(1&t&&(P(0,"span",20),ie(1),N()),2&t){const e=U(3).$implicit;L("ngClass",e.badgeStyleClass),F(1),Ut(e.badge)}}function Ume(t,n){1&t&&Ae(0,"span",24)}const jme=function(){return{exact:!1}};function Hme(t,n){if(1&t){const e=Ye();P(0,"a",22),Te("keydown",function(r){return be(e),ve(U(3).onItemKeyDown(r))})("click",function(r){be(e),U();const s=Un(1),l=U().$implicit;return ve(U().itemClick(r,l,s))}),W(1,Nme,1,2,"span",12),W(2,zme,2,1,"span",13),W(3,Bme,1,1,"ng-template",null,14,Ua),W(5,Vme,2,2,"span",15),W(6,Ume,1,0,"span",23),N()}if(2&t){const e=Un(4),o=U(2).$implicit,r=U();L("routerLink",o.routerLink)("queryParams",o.queryParams)("routerLinkActive","p-menuitem-link-active")("routerLinkActiveOptions",o.routerLinkActiveOptions||Kn(21,jme))("href",o.url,Ui)("target",o.target)("ngClass",Wt(22,a4,o.disabled))("fragment",o.fragment)("queryParamsHandling",o.queryParamsHandling)("preserveFragment",o.preserveFragment)("skipLocationChange",o.skipLocationChange)("replaceUrl",o.replaceUrl)("state",o.state),at("title",o.title)("id",o.id)("tabindex",o.disabled||!r.isActive?null:"0"),F(1),L("ngIf",o.icon),F(1),L("ngIf",!1!==o.escape)("ngIfElse",e),F(3),L("ngIf",o.badge),F(1),L("ngIf",o.items)}}function $me(t,n){if(1&t&&Ae(0,"p-slideMenuSub",25),2&t){const e=U(2).$implicit,o=U();L("item",e)("index",o.index+1)("menuWidth",o.menuWidth)}}const Gme=function(t,n){return{"p-menuitem":!0,"p-menuitem-active":t,"p-hidden":n}};function Wme(t,n){if(1&t&&(P(0,"li",6,7),W(2,Fme,7,13,"a",8),W(3,Hme,7,24,"a",9),W(4,$me,1,3,"p-slideMenuSub",10),N()),2&t){const e=Un(1),o=U().$implicit,r=U();Zn(o.styleClass),L("ngClass",Ji(8,Gme,e==r.activeItem,!1===o.visible))("tooltipOptions",o.tooltipOptions)("ngStyle",o.style),F(2),L("ngIf",!o.routerLink),F(1),L("ngIf",o.routerLink),F(1),L("ngIf",o.items)}}function qme(t,n){if(1&t&&(W(0,kme,1,3,"li",3),W(1,Wme,5,11,"li",4)),2&t){const e=n.$implicit;L("ngIf",e.separator),F(1),L("ngIf",!e.separator)}}const Zme=function(t,n,e){return{"p-slidemenu-rootlist":t,"p-submenu-list":n,"p-active-submenu":e}},Kme=["container"],Xme=["backward"],Yme=["slideMenuContent"],Qme=function(t){return{"p-slidemenu p-component":!0,"p-slidemenu-overlay":t}},Jme=function(t,n){return{showTransitionParams:t,hideTransitionParams:n}},ege=function(t){return{value:"visible",params:t}};function tge(t,n){if(1&t){const e=Ye();P(0,"div",1,2),Te("click",function(r){return be(e),ve(U().onOverlayClick(r))})("@overlayAnimation.start",function(r){return be(e),ve(U().onOverlayAnimationStart(r))})("@overlayAnimation.done",function(r){return be(e),ve(U().onOverlayAnimationEnd(r))}),P(2,"div",3)(3,"div",4,5),Ae(5,"p-slideMenuSub",6),N(),P(6,"a",7,8),Te("keydown.enter",function(r){return be(e),ve(U().onBackwardKeydown(r))})("keydown.space",function(r){return be(e),ve(U().onBackwardKeydown(r))})("click",function(){return be(e),ve(U().goBack())}),Ae(8,"span",9),P(9,"span"),ie(10),N()()()()}if(2&t){const e=U();Zn(e.styleClass),L("ngClass",Wt(18,Qme,e.popup))("ngStyle",e.style)("@overlayAnimation",Wt(23,ege,Ji(20,Jme,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",!0!==e.popup),F(2),za("height",e.left?e.viewportHeight+"px":"auto")("width",e.menuWidth+"px"),F(3),L("item",e.model)("index",0)("menuWidth",e.menuWidth)("effectDuration",e.effectDuration)("easing",e.easing),F(1),za("display",e.left?"block":"none"),F(4),Ut(e.backLabel)}}let nge=(()=>{class t{constructor(e){this.backLabel="Back",this.easing="ease-out",this.slideMenu=e}itemClick(e,o,r){o.disabled?e.preventDefault():(!o.url&&!o.routerLink&&e.preventDefault(),o.command&&o.command({originalEvent:e,item:o}),o.items&&!this.slideMenu.animating&&(this.slideMenu.left-=this.slideMenu.menuWidth,this.activeItem=r,this.slideMenu.animating=!0,setTimeout(()=>this.slideMenu.animating=!1,this.effectDuration)),!o.items&&this.slideMenu.popup&&this.slideMenu.hide())}focusNextList(e){if(!this.slideMenu.animating){let o=Ne.getFocusableElements(e);o&&o.length>0&&o[0].focus(),this.unbindTransitionEndListener()}}onItemKeyDown(e){let o=e.currentTarget.parentElement;switch(e.code){case"Space":case"Enter":o&&!Ne.hasClass(o,"p-disabled")&&(o.children[0].click(),this.transitionEndListener=this.focusNextList.bind(this,o),this.sublistViewChild.nativeElement.addEventListener("transitionend",this.transitionEndListener)),e.preventDefault()}}unbindTransitionEndListener(){this.transitionEndListener&&this.sublistViewChild&&(this.sublistViewChild.nativeElement.removeEventListener("transitionend",this.transitionEndListener),this.transitionEndListener=null)}ngOnDestroy(){this.activeItem=null,this.unbindTransitionEndListener()}get isActive(){return-this.slideMenu.left==this.index*this.menuWidth}}return t.\u0275fac=function(e){return new(e||t)(ce(Ei(()=>l4)))},t.\u0275cmp=Qt({type:t,selectors:[["p-slideMenuSub"]],viewQuery:function(e,o){if(1&e&&pi(Dme,5),2&e){let r;gn(r=_n())&&(o.sublistViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{item:"item",root:"root",backLabel:"backLabel",menuWidth:"menuWidth",effectDuration:"effectDuration",easing:"easing",index:"index"},decls:3,vars:16,consts:[[3,"ngClass"],["sublist",""],["ngFor","",3,"ngForOf"],["class","p-menu-separator",3,"ngClass",4,"ngIf"],["pTooltip","",3,"ngClass","tooltipOptions","class","ngStyle",4,"ngIf"],[1,"p-menu-separator",3,"ngClass"],["pTooltip","",3,"ngClass","tooltipOptions","ngStyle"],["listitem",""],["class","p-menuitem-link",3,"target","ngClass","keydown","click",4,"ngIf"],["class","p-menuitem-link",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","href","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state","keydown","click",4,"ngIf"],["class","p-submenu",3,"item","index","menuWidth",4,"ngIf"],[1,"p-menuitem-link",3,"target","ngClass","keydown","click"],["class","p-menuitem-icon",3,"ngClass","ngStyle",4,"ngIf"],["class","p-menuitem-text",4,"ngIf","ngIfElse"],["htmlRouteLabel",""],["class","p-menuitem-badge",3,"ngClass",4,"ngIf"],["class","p-submenu-icon pi pi-fw pi-angle-right",4,"ngIf"],[1,"p-menuitem-icon",3,"ngClass","ngStyle"],[1,"p-menuitem-text"],[1,"p-menuitem-text",3,"innerHTML"],[1,"p-menuitem-badge",3,"ngClass"],[1,"p-submenu-icon","pi","pi-fw","pi-angle-right"],[1,"p-menuitem-link",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","href","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state","keydown","click"],["class","p-submenu-icon pi pi-fw pi-caret-right",4,"ngIf"],[1,"p-submenu-icon","pi","pi-fw","pi-caret-right"],[1,"p-submenu",3,"item","index","menuWidth"]],template:function(e,o){1&e&&(P(0,"ul",0,1),W(2,qme,2,2,"ng-template",2),N()),2&e&&(za("width",o.menuWidth,"px")("left",o.root?o.slideMenu.left:o.slideMenu.menuWidth,"px")("transition-property",o.root?"left":"none")("transition-duration",o.effectDuration+"ms")("transition-timing-function",o.easing),L("ngClass",Va(12,Zme,o.root,!o.root,o.isActive)),F(2),L("ngForOf",o.root?o.item:o.item.items))},dependencies:[ao,Ns,Xn,ho,Qh,FF,q3,t],encapsulation:2}),t})(),l4=(()=>{class t{constructor(e,o,r,s,l){this.el=e,this.renderer=o,this.cd=r,this.config=s,this.overlayService=l,this.menuWidth=190,this.viewportHeight=180,this.effectDuration=250,this.easing="ease-out",this.backLabel="Back",this.autoZIndex=!0,this.baseZIndex=0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.onShow=new ht,this.onHide=new ht,this.left=0,this.animating=!1}ngAfterViewChecked(){!this.viewportUpdated&&!this.popup&&this.containerViewChild&&(this.updateViewPort(),this.viewportUpdated=!0)}set container(e){this.containerViewChild=e}set backward(e){this.backwardViewChild=e}set slideMenuContent(e){this.slideMenuContentViewChild=e}updateViewPort(){this.slideMenuContentViewChild.nativeElement.style.height=this.viewportHeight-Ne.getHiddenElementOuterHeight(this.backwardViewChild.nativeElement)+"px"}toggle(e){this.visible?this.hide():this.show(e),this.preventDocumentDefault=!0}show(e){this.target=e.currentTarget,this.visible=!0,this.preventDocumentDefault=!0,this.cd.markForCheck()}onOverlayClick(e){this.popup&&this.overlayService.add({originalEvent:e,target:this.el.nativeElement}),this.preventDocumentDefault=!0}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.popup&&(this.updateViewPort(),this.moveOnTop(),this.onShow.emit({}),this.appendOverlay(),Ne.absolutePosition(this.containerViewChild.nativeElement,this.target),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener());break;case"void":this.onOverlayHide(),this.onHide.emit({})}}onOverlayAnimationEnd(e){"void"===e.toState&&Ir.clear(e.element)}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.containerViewChild.nativeElement):Ne.appendChild(this.containerViewChild.nativeElement,this.appendTo))}restoreOverlayAppend(){this.container&&this.appendTo&&this.el.nativeElement.appendChild(this.containerViewChild.nativeElement)}moveOnTop(){this.autoZIndex&&Ir.set("menu",this.containerViewChild.nativeElement,this.baseZIndex+this.config.zIndex.menu)}hide(){this.visible=!1,this.cd.markForCheck()}onWindowResize(){this.visible&&!Ne.isTouchDevice()&&this.hide()}goBack(){this.left+=this.menuWidth}onBackwardKeydown(e){this.goBack(),this.left||setTimeout(()=>{let o=Ne.getFocusableElements(this.el.nativeElement);o&&o.length>0&&o[0].focus()},1),e.preventDefault()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","click",()=>{this.preventDocumentDefault||(this.hide(),this.cd.detectChanges()),this.preventDocumentDefault=!1}))}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new w0(this.target,()=>{this.visible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}onOverlayHide(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.preventDocumentDefault=!1,this.left=0,this.cd.destroyed||(this.target=null)}ngOnDestroy(){this.popup&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.restoreOverlayAppend(),this.onOverlayHide())}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Jr),ce(Fo),ce(fl),ce(y0))},t.\u0275cmp=Qt({type:t,selectors:[["p-slideMenu"]],viewQuery:function(e,o){if(1&e&&(pi(Kme,5),pi(Xme,5),pi(Yme,5)),2&e){let r;gn(r=_n())&&(o.container=r.first),gn(r=_n())&&(o.backward=r.first),gn(r=_n())&&(o.slideMenuContent=r.first)}},hostAttrs:[1,"p-element"],inputs:{model:"model",popup:"popup",style:"style",styleClass:"styleClass",menuWidth:"menuWidth",viewportHeight:"viewportHeight",effectDuration:"effectDuration",easing:"easing",backLabel:"backLabel",appendTo:"appendTo",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onShow:"onShow",onHide:"onHide"},decls:1,vars:1,consts:[[3,"ngClass","class","ngStyle","click",4,"ngIf"],[3,"ngClass","ngStyle","click"],["container",""],[1,"p-slidemenu-wrapper"],[1,"p-slidemenu-content"],["slideMenuContent",""],["root","root",3,"item","index","menuWidth","effectDuration","easing"],["tabindex","0",1,"p-slidemenu-backward","p-menuitem-link",3,"keydown.enter","keydown.space","click"],["backward",""],[1,"p-slidemenu-backward-icon","pi","pi-fw","pi-caret-left"]],template:function(e,o){1&e&&W(0,tge,11,25,"div",0),2&e&&L("ngIf",!o.popup||o.visible)},dependencies:[ao,Xn,ho,nge],styles:[".p-slidemenu{width:12.5rem}.p-slidemenu.p-slidemenu-overlay{position:absolute;top:0;left:0}.p-slidemenu ul{list-style:none;margin:0;padding:0}.p-slidemenu .p-slidemenu-rootlist{position:absolute;top:0}.p-slidemenu .p-submenu-list{display:none;position:absolute;top:0;width:12.5rem}.p-slidemenu .p-menuitem-link{cursor:pointer;display:flex;align-items:center;text-decoration:none;overflow:hidden}.p-slidemenu .p-menuitem-icon,.p-slidemenu .p-menuitem-text{vertical-align:middle}.p-slidemenu .p-menuitem{position:relative}.p-slidemenu .p-menuitem-link .p-submenu-icon{margin-left:auto}.p-slidemenu .p-slidemenu-wrapper{position:relative}.p-slidemenu .p-slidemenu-content{overflow-x:hidden;overflow-y:auto;position:relative}.p-slidemenu-backward{position:absolute;bottom:0;width:100%;cursor:pointer;display:none}.p-slidemenu-backward .p-slidemenu-backward-icon,.p-slidemenu-backward span{vertical-align:middle}.p-slidemenu .p-menuitem-active{position:static}.p-slidemenu .p-menuitem-active>.p-submenu>.p-submenu-list{display:block}.p-slidemenu ul:not(.p-active-submenu)>.p-menuitem:not(.p-menuitem-active),.p-slidemenu .p-active-submenu>.p-menuitem-active>.p-submenu>.p-submenu-list{display:none}.p-slidemenu .p-active-submenu>.p-menuitem-active~.p-menuitem{display:block}\n"],encapsulation:2,data:{animation:[pl("overlayAnimation",[qo(":enter",[po({opacity:0,transform:"scaleY(0.8)"}),$o("{{showTransitionParams}}")]),qo(":leave",[$o("{{hideTransitionParams}}",po({opacity:0}))])])]},changeDetection:0}),t})(),DT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Ic,Du,Ic,Du]}),t})();const ige=["content"];function oge(t,n){1&t&&$t(0)}function rge(t,n){if(1&t&&(P(0,"div",10),W(1,oge,1,0,"ng-container",11),N()),2&t){const e=U(3);F(1),L("ngTemplateOutlet",e.headerTemplate)}}function sge(t,n){if(1&t&&(P(0,"span",15),ie(1),N()),2&t){const e=U(4);F(1),Ut(e.option("header"))}}const age=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function lge(t,n){if(1&t){const e=Ye();P(0,"button",16),Te("click",function(r){return be(e),ve(U(4).close(r))})("keydown.enter",function(r){return be(e),ve(U(4).close(r))}),Ae(1,"span",17),N()}2&t&&L("ngClass",Kn(1,age))}function cge(t,n){if(1&t&&(P(0,"div",10),W(1,sge,2,1,"span",12),P(2,"div",13),W(3,lge,2,2,"button",14),N()()),2&t){const e=U(3);F(1),L("ngIf",e.option("header")),F(2),L("ngIf",e.closable)}}function uge(t,n){1&t&&Ae(0,"i",1),2&t&&(Zn(U(3).option("icon")),L("ngClass","p-confirm-dialog-icon"))}function dge(t,n){1&t&&$t(0)}function hge(t,n){if(1&t&&(P(0,"div",18),ro(1),W(2,dge,1,0,"ng-container",11),N()),2&t){const e=U(3);F(2),L("ngTemplateOutlet",e.footerTemplate)}}function pge(t,n){if(1&t){const e=Ye();P(0,"button",20),Te("click",function(){return be(e),ve(U(4).reject())}),N()}if(2&t){const e=U(4);Zn(e.option("rejectButtonStyleClass")),L("icon",e.option("rejectIcon"))("label",e.rejectButtonLabel)("ngClass","p-confirm-dialog-reject"),at("aria-label",e.rejectAriaLabel)}}function fge(t,n){if(1&t){const e=Ye();P(0,"button",20),Te("click",function(){return be(e),ve(U(4).accept())}),N()}if(2&t){const e=U(4);Zn(e.option("acceptButtonStyleClass")),L("icon",e.option("acceptIcon"))("label",e.acceptButtonLabel)("ngClass","p-confirm-dialog-accept"),at("aria-label",e.acceptAriaLabel)}}function mge(t,n){if(1&t&&(P(0,"div",18),W(1,pge,1,6,"button",19),W(2,fge,1,6,"button",19),N()),2&t){const e=U(3);F(1),L("ngIf",e.option("rejectVisible")),F(1),L("ngIf",e.option("acceptVisible"))}}const gge=function(t){return{"p-dialog p-confirm-dialog p-component":!0,"p-dialog-rtl":t}},_ge=function(t,n){return{transform:t,transition:n}},yge=function(t){return{value:"visible",params:t}};function vge(t,n){if(1&t){const e=Ye();P(0,"div",3),Te("@animation.start",function(r){return be(e),ve(U(2).onAnimationStart(r))})("@animation.done",function(r){return be(e),ve(U(2).onAnimationEnd(r))}),W(1,rge,2,1,"div",4),W(2,cge,4,2,"div",4),P(3,"div",5,6),W(5,uge,1,3,"i",7),Ae(6,"span",8),N(),W(7,hge,3,1,"div",9),W(8,mge,3,2,"div",9),N()}if(2&t){const e=U(2);Zn(e.styleClass),L("ngClass",Wt(11,gge,e.rtl))("ngStyle",e.style)("@animation",Wt(16,yge,Ji(13,_ge,e.transformOptions,e.transitionOptions))),F(1),L("ngIf",e.headerTemplate),F(1),L("ngIf",!e.headerTemplate),F(3),L("ngIf",e.option("icon")),F(1),L("innerHTML",e.option("message"),Lh),F(1),L("ngIf",e.footer||e.footerTemplate),F(1),L("ngIf",!e.footer&&!e.footerTemplate)}}function bge(t,n){if(1&t&&(P(0,"div",1),W(1,vge,9,18,"div",2),N()),2&t){const e=U();Zn(e.maskStyleClass),L("ngClass",e.getMaskClass()),F(1),L("ngIf",e.visible)}}const xge=[[["p-footer"]]],wge=["p-footer"],Cge=If([po({transform:"{{transform}}",opacity:0}),$o("{{transition}}",po({transform:"none",opacity:1}))]),Tge=If([$o("{{transition}}",po({transform:"{{transform}}",opacity:0}))]);let Sge=(()=>{class t{constructor(e,o,r,s,l,h){this.el=e,this.renderer=o,this.confirmationService=r,this.zone=s,this.cd=l,this.config=h,this.acceptIcon="pi pi-check",this.acceptVisible=!0,this.rejectIcon="pi pi-times",this.rejectVisible=!0,this.closeOnEscape=!0,this.blockScroll=!0,this.closable=!0,this.autoZIndex=!0,this.baseZIndex=0,this.transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)",this.focusTrap=!0,this.defaultFocus="accept",this.onHide=new ht,this._position="center",this.transformOptions="scale(0.7)",this.id=Ig(),this.subscription=this.confirmationService.requireConfirmation$.subscribe(f=>{f?f.key===this.key&&(this.confirmation=f,this.confirmationOptions={message:this.confirmation.message||this.message,icon:this.confirmation.icon||this.icon,header:this.confirmation.header||this.header,rejectVisible:null==this.confirmation.rejectVisible?this.rejectVisible:this.confirmation.rejectVisible,acceptVisible:null==this.confirmation.acceptVisible?this.acceptVisible:this.confirmation.acceptVisible,acceptLabel:this.confirmation.acceptLabel||this.acceptLabel,rejectLabel:this.confirmation.rejectLabel||this.rejectLabel,acceptIcon:this.confirmation.acceptIcon||this.acceptIcon,rejectIcon:this.confirmation.rejectIcon||this.rejectIcon,acceptButtonStyleClass:this.confirmation.acceptButtonStyleClass||this.acceptButtonStyleClass,rejectButtonStyleClass:this.confirmation.rejectButtonStyleClass||this.rejectButtonStyleClass,defaultFocus:this.confirmation.defaultFocus||this.defaultFocus,blockScroll:!1===this.confirmation.blockScroll||!0===this.confirmation.blockScroll?this.confirmation.blockScroll:this.blockScroll,closeOnEscape:!1===this.confirmation.closeOnEscape||!0===this.confirmation.closeOnEscape?this.confirmation.closeOnEscape:this.closeOnEscape,dismissableMask:!1===this.confirmation.dismissableMask||!0===this.confirmation.dismissableMask?this.confirmation.dismissableMask:this.dismissableMask},this.confirmation.accept&&(this.confirmation.acceptEvent=new ht,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new ht,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0):this.hide()})}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0),this.cd.markForCheck()}get position(){return this._position}set position(e){switch(this._position=e,e){case"top-left":case"bottom-left":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"top-right":case"bottom-right":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngOnInit(){this.breakpoints&&this.createStyle(),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.visible&&this.cd.markForCheck()})}option(e){const o=this.confirmationOptions||this;if(o.hasOwnProperty(e))return o[e]}onAnimationStart(e){if("visible"===e.toState){this.container=e.element,this.wrapper=this.container.parentElement,this.contentContainer=Ne.findSingle(this.container,".p-dialog-content"),this.container.setAttribute(this.id,""),this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.enableModality();const o=this.getElementToFocus();o&&o.focus()}}onAnimationEnd(e){"void"===e.toState&&this.onOverlayHide()}getElementToFocus(){switch(this.option("defaultFocus")){case"accept":default:return Ne.findSingle(this.container,".p-confirm-dialog-accept");case"reject":return Ne.findSingle(this.container,".p-confirm-dialog-reject");case"close":return Ne.findSingle(this.container,".p-dialog-header-close");case"none":return null}}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.wrapper):Ne.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.wrapper&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}enableModality(){this.option("blockScroll")&&Ne.addClass(document.body,"p-overflow-hidden"),this.option("dismissableMask")&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.close(e)}))}disableModality(){this.maskVisible=!1,this.option("blockScroll")&&Ne.removeClass(document.body,"p-overflow-hidden"),this.dismissableMask&&this.unbindMaskClickListener(),this.container&&!this.cd.destroyed&&this.cd.detectChanges()}createStyle(){if(!this.styleElement){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement);let e="";for(let o in this.breakpoints)e+=`\n                    @media screen and (max-width: ${o}) {\n                        .p-dialog[${this.id}] {\n                            width: ${this.breakpoints[o]} !important;\n                        }\n                    }\n                `;this.styleElement.innerHTML=e}}close(e){this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(Lf.CANCEL),this.hide(Lf.CANCEL),e.preventDefault()}hide(e){this.onHide.emit(e),this.visible=!1,this.confirmation=null,this.confirmationOptions=null}moveOnTop(){this.autoZIndex&&(Ir.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}getMaskClass(){let e={"p-dialog-mask p-component-overlay":!0,"p-dialog-mask-scrollblocker":this.blockScroll};return e[this.getPositionClass().toString()]=!0,e}getPositionClass(){const o=["left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find(r=>r===this.position);return o?`p-dialog-${o}`:""}bindGlobalListeners(){(this.option("closeOnEscape")&&this.closable||this.focusTrap&&!this.documentEscapeListener)&&(this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",o=>{if(27==o.which&&this.option("closeOnEscape")&&this.closable&&parseInt(this.container.style.zIndex)===Ir.get(this.container)&&this.visible&&this.close(o),9===o.which&&this.focusTrap){o.preventDefault();let r=Ne.getFocusableElements(this.container);if(r&&r.length>0)if(r[0].ownerDocument.activeElement){let s=r.indexOf(r[0].ownerDocument.activeElement);o.shiftKey?-1==s||0===s?r[r.length-1].focus():r[s-1].focus():-1==s||s===r.length-1?r[0].focus():r[s+1].focus()}else r[0].focus()}}))}unbindGlobalListeners(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}onOverlayHide(){this.container&&this.autoZIndex&&Ir.clear(this.container),this.disableModality(),this.unbindGlobalListeners(),this.container=null}destroyStyle(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.restoreAppend(),this.onOverlayHide(),this.subscription.unsubscribe(),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.destroyStyle()}accept(){this.confirmation&&this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide(Lf.ACCEPT)}reject(){this.confirmation&&this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(Lf.REJECT),this.hide(Lf.REJECT)}get acceptButtonLabel(){return this.option("acceptLabel")||this.config.getTranslation(zr.ACCEPT)}get rejectButtonLabel(){return this.option("rejectLabel")||this.config.getTranslation(zr.REJECT)}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(Jr),ce(Dg),ce(yi),ce(Fo),ce(fl))},t.\u0275cmp=Qt({type:t,selectors:[["p-confirmDialog"]],contentQueries:function(e,o,r){if(1&e&&(Bo(r,vC,5),Bo(r,fo,4)),2&e){let s;gn(s=_n())&&(o.footer=s.first),gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&pi(ige,5),2&e){let r;gn(r=_n())&&(o.contentViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",icon:"icon",message:"message",style:"style",styleClass:"styleClass",maskStyleClass:"maskStyleClass",acceptIcon:"acceptIcon",acceptLabel:"acceptLabel",acceptAriaLabel:"acceptAriaLabel",acceptVisible:"acceptVisible",rejectIcon:"rejectIcon",rejectLabel:"rejectLabel",rejectAriaLabel:"rejectAriaLabel",rejectVisible:"rejectVisible",acceptButtonStyleClass:"acceptButtonStyleClass",rejectButtonStyleClass:"rejectButtonStyleClass",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",blockScroll:"blockScroll",rtl:"rtl",closable:"closable",appendTo:"appendTo",key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",transitionOptions:"transitionOptions",focusTrap:"focusTrap",defaultFocus:"defaultFocus",breakpoints:"breakpoints",visible:"visible",position:"position"},outputs:{onHide:"onHide"},ngContentSelectors:wge,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],[3,"ngClass","ngStyle","class",4,"ngIf"],[3,"ngClass","ngStyle"],["class","p-dialog-header",4,"ngIf"],[1,"p-dialog-content"],["content",""],[3,"ngClass","class",4,"ngIf"],[1,"p-confirm-dialog-message",3,"innerHTML"],["class","p-dialog-footer",4,"ngIf"],[1,"p-dialog-header"],[4,"ngTemplateOutlet"],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button",3,"ngClass","click","keydown.enter"],[1,"pi","pi-times"],[1,"p-dialog-footer"],["type","button","pRipple","","pButton","",3,"icon","label","ngClass","class","click",4,"ngIf"],["type","button","pRipple","","pButton","",3,"icon","label","ngClass","click"]],template:function(e,o){1&e&&(hr(xge),W(0,bge,2,4,"div",0)),2&e&&L("ngIf",o.maskVisible)},dependencies:[ao,Xn,Cs,ho,Dr,Iu],styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[pl("animation",[qo("void => visible",[yy(Cge)]),qo("visible => void",[yy(Tge)])])]},changeDetection:0}),t})(),MT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,gl,ml,gl,hs]}),t})();const c4=["container"],Ege=function(t,n,e,o){return{"pi-info-circle":t,"pi-exclamation-triangle":n,"pi-times-circle":e,"pi-check":o}};function Ige(t,n){if(1&t&&(wn(0),Ae(1,"span",6),P(2,"div",7)(3,"div",8),ie(4),N(),P(5,"div",9),ie(6),N()(),Pn()),2&t){const e=U();F(1),Zn("p-toast-message-icon pi"+(e.message.icon?" "+e.message.icon:"")),L("ngClass",vu(5,Ege,"info"==e.message.severity,"warn"==e.message.severity,"error"==e.message.severity,"success"==e.message.severity)),F(3),Ut(e.message.summary),F(2),Ut(e.message.detail)}}function Dge(t,n){1&t&&$t(0)}function Mge(t,n){if(1&t){const e=Ye();P(0,"button",10),Te("click",function(r){return be(e),ve(U().onCloseIconClick(r))})("keydown.enter",function(r){return be(e),ve(U().onCloseIconClick(r))}),Ae(1,"span",11),N()}}const kge=function(t){return[t,"p-toast-message"]},Age=function(t,n,e,o){return{showTransformParams:t,hideTransformParams:n,showTransitionParams:e,hideTransitionParams:o}},Pge=function(t){return{value:"visible",params:t}},Oge=function(t){return{$implicit:t}};function Lge(t,n){if(1&t){const e=Ye();P(0,"p-toastItem",3),Te("onClose",function(r){return be(e),ve(U().onMessageClose(r))})("@toastAnimation.start",function(r){return be(e),ve(U().onAnimationStart(r))})("@toastAnimation.done",function(r){return be(e),ve(U().onAnimationEnd(r))}),N()}if(2&t){const e=n.$implicit,o=n.index,r=U();L("message",e)("index",o)("template",r.template)("@toastAnimation",void 0)("showTransformOptions",r.showTransformOptions)("hideTransformOptions",r.hideTransformOptions)("showTransitionOptions",r.showTransitionOptions)("hideTransitionOptions",r.hideTransitionOptions)}}let Rge=(()=>{class t{constructor(e){this.zone=e,this.onClose=new ht}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick(e){this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),e.preventDefault()}ngOnDestroy(){this.clearTimeout()}}return t.\u0275fac=function(e){return new(e||t)(ce(yi))},t.\u0275cmp=Qt({type:t,selectors:[["p-toastItem"]],viewQuery:function(e,o){if(1&e&&pi(c4,5),2&e){let r;gn(r=_n())&&(o.containerViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:"index",template:"template",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},decls:6,vars:21,consts:[[3,"ngClass","mouseenter","mouseleave"],["container",""],["role","alert","aria-live","assertive","aria-atomic","true",1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"ngClass"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[1,"p-toast-icon-close-icon","pi","pi-times"]],template:function(e,o){1&e&&(P(0,"div",0,1),Te("mouseenter",function(){return o.onMouseEnter()})("mouseleave",function(){return o.onMouseLeave()}),P(2,"div",2),W(3,Ige,7,10,"ng-container",3),W(4,Dge,1,0,"ng-container",4),W(5,Mge,2,0,"button",5),N()()),2&e&&(Zn(o.message.styleClass),L("ngClass",Wt(10,kge,"p-toast-message-"+o.message.severity))("@messageState",Wt(17,Pge,vu(12,Age,o.showTransformOptions,o.hideTransformOptions,o.showTransitionOptions,o.hideTransitionOptions))),at("id",o.message.id),F(2),L("ngClass",o.message.contentStyleClass),F(1),L("ngIf",!o.template),F(1),L("ngTemplateOutlet",o.template)("ngTemplateOutletContext",Wt(19,Oge,o.message)),F(1),L("ngIf",!1!==o.message.closable))},dependencies:[ao,Xn,Cs,Iu],encapsulation:2,data:{animation:[pl("messageState",[Mw("visible",po({transform:"translateY(0)",opacity:1})),qo("void => *",[po({transform:"{{showTransformParams}}",opacity:0}),$o("{{showTransitionParams}}")]),qo("* => void",[$o("{{hideTransitionParams}}",po({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0}),t})(),u4=(()=>{class t{constructor(e,o,r){this.messageService=e,this.cd=o,this.config=r,this.autoZIndex=!0,this.baseZIndex=0,this.position="top-right",this.preventOpenDuplicates=!1,this.preventDuplicates=!1,this.showTransformOptions="translateY(100%)",this.hideTransformOptions="translateY(-100%)",this.showTransitionOptions="300ms ease-out",this.hideTransitionOptions="250ms ease-in",this.onClose=new ht,this.id=Ig()}ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(e=>{if(e)if(Array.isArray(e)){const o=e.filter(r=>this.canAdd(r));this.add(o)}else this.canAdd(e)&&this.add([e])}),this.clearSubscription=this.messageService.clearObserver.subscribe(e=>{e?this.key===e&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(e){this.messages=this.messages?[...this.messages,...e]:[...e],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...e]:[...e]),this.cd.markForCheck()}canAdd(e){let o=this.key===e.key;return o&&this.preventOpenDuplicates&&(o=!this.containsMessage(this.messages,e)),o&&this.preventDuplicates&&(o=!this.containsMessage(this.messagesArchieve,e)),o}containsMessage(e,o){return!!e&&null!=e.find(r=>r.summary===o.summary&&r.detail==o.detail&&r.severity===o.severity)}ngAfterContentInit(){this.templates.forEach(e=>{e.getType(),this.template=e.template})}onMessageClose(e){this.messages.splice(e.index,1),this.onClose.emit({message:e.message}),this.cd.detectChanges()}onAnimationStart(e){"void"===e.fromState&&(this.containerViewChild.nativeElement.setAttribute(this.id,""),this.autoZIndex&&""===this.containerViewChild.nativeElement.style.zIndex&&Ir.set("modal",this.containerViewChild.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(e){"void"===e.toState&&this.autoZIndex&&xn.isEmpty(this.messages)&&Ir.clear(this.containerViewChild.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement);let e="";for(let o in this.breakpoints){let r="";for(let s in this.breakpoints[o])r+=s+":"+this.breakpoints[o][s]+" !important;";e+=`\n                    @media screen and (max-width: ${o}) {\n                        .p-toast[${this.id}] {\n                           ${r}\n                        }\n                    }\n                `}this.styleElement.innerHTML=e}}destroyStyle(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&Ir.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}}return t.\u0275fac=function(e){return new(e||t)(ce(Rd),ce(Fo),ce(fl))},t.\u0275cmp=Qt({type:t,selectors:[["p-toast"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,fo,4),2&e){let s;gn(s=_n())&&(o.templates=s)}},viewQuery:function(e,o){if(1&e&&pi(c4,5),2&e){let r;gn(r=_n())&&(o.containerViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:"preventOpenDuplicates",preventDuplicates:"preventDuplicates",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},decls:3,vars:5,consts:[[3,"ngClass","ngStyle"],["container",""],[3,"message","index","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"message","index","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose"]],template:function(e,o){1&e&&(P(0,"div",0,1),W(2,Lge,1,8,"p-toastItem",2),N()),2&e&&(Zn(o.styleClass),L("ngClass","p-toast p-component p-toast-"+o.position)("ngStyle",o.style),F(2),L("ngForOf",o.messages))},dependencies:[ao,Ns,ho,Rge],styles:[".p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-toast-icon-close.p-link{cursor:pointer}\n"],encapsulation:2,data:{animation:[pl("toastAnimation",[qo(":enter, :leave",[K$("@*",Z$())])])]},changeDetection:0}),t})(),kT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,ml,hs]}),t})(),AT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})(),PT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})(),Uge=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})(),OT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi]}),t})();function jge(t,n){if(1&t&&(P(0,"span",1),ie(1),N()),2&t){const e=U();Zn(e.styleClass),L("ngClass",e.containerClass())("ngStyle",e.style),F(1),Ut(e.value)}}let Hge=(()=>{class t{constructor(){this.badgeDisabled=!1}containerClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":null!=this.value&&1===String(this.value).length,"p-badge-lg":"large"===this.size,"p-badge-xl":"xlarge"===this.size,"p-badge-info":"info"===this.severity,"p-badge-success":"success"===this.severity,"p-badge-warning":"warning"===this.severity,"p-badge-danger":"danger"===this.severity}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["p-badge"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",size:"size",severity:"severity",value:"value",badgeDisabled:"badgeDisabled"},decls:1,vars:1,consts:[[3,"ngClass","class","ngStyle",4,"ngIf"],[3,"ngClass","ngStyle"]],template:function(e,o){1&e&&W(0,jge,2,5,"span",0),2&e&&L("ngIf",!o.badgeDisabled)},dependencies:[ao,Xn,ho],styles:[".p-badge{display:inline-block;border-radius:10px;text-align:center;padding:0 .5rem}.p-overlay-badge{position:relative}.p-overlay-badge .p-badge{position:absolute;top:0;right:0;transform:translate(50%,-50%);transform-origin:100% 0;margin:0}.p-badge-dot{width:.5rem;min-width:.5rem;height:.5rem;border-radius:50%;padding:0}.p-badge-no-gutter{padding:0;border-radius:50%}\n"],encapsulation:2,changeDetection:0}),t})(),LT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,hs]}),t})();const $ge=["*",[["mat-toolbar-row"]]],Gge=["*","mat-toolbar-row"],Wge=NI(class{constructor(t){this._elementRef=t}});let qge=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=On({type:t,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),t})(),Zge=(()=>{class t extends Wge{constructor(e,o,r){super(e),this._platform=o,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(bc),ce(uo))},t.\u0275cmp=Qt({type:t,selectors:[["mat-toolbar"]],contentQueries:function(e,o,r){if(1&e&&Bo(r,qge,5),2&e){let s;gn(s=_n())&&(o._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(e,o){2&e&&Ro("mat-toolbar-multiple-rows",o._toolbarRows.length>0)("mat-toolbar-single-row",0===o._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[ji],ngContentSelectors:Gge,decls:2,vars:0,template:function(e,o){1&e&&(hr($ge),ro(0),ro(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),t})(),Kge=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[Cc,Cc]}),t})();const Xge=["mat-button",""],Yge=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Qge=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],e_e=["mat-icon-button",""],t_e=["*"],n_e=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],i_e=NI(o$(r$(class{constructor(t){this._elementRef=t}})));let d4=(()=>{class t extends i_e{constructor(e,o,r,s){super(e),this._platform=o,this._ngZone=r,this._animationMode=s,this._focusMonitor=ai(_L),this._isFab=!1;const l=e.nativeElement.classList;for(const h of n_e)this._hasHostAttributes(h.selector)&&h.mdcClasses.forEach(f=>{l.add(f)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e="program",o){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,o):this._elementRef.nativeElement.focus(o)}_hasHostAttributes(...e){return e.some(o=>this._elementRef.nativeElement.hasAttribute(o))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return t.\u0275fac=function(e){Nh()},t.\u0275dir=On({type:t,viewQuery:function(e,o){if(1&e&&pi(zI,5),2&e){let r;gn(r=_n())&&(o.ripple=r.first)}},features:[ji]}),t})(),r_e=(()=>{class t extends d4{constructor(e,o,r,s){super(e,o,r,s)}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(bc),ce(yi),ce(ly,8))},t.\u0275cmp=Qt({type:t,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(e,o){2&e&&(at("disabled",o.disabled||null),Ro("_mat-animation-noopable","NoopAnimations"===o._animationMode)("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[ji],attrs:Xge,ngContentSelectors:Qge,decls:8,vars:6,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(e,o){1&e&&(hr(Yge),Ae(0,"span",0),ro(1),P(2,"span",1),ro(3,1),N(),ro(4,2),Ae(5,"span",2)(6,"span",3)(7,"span",4)),2&e&&(Ro("mdc-button__ripple",!o._isFab)("mdc-fab__ripple",o._isFab),F(6),L("matRippleDisabled",o._isRippleDisabled())("matRippleTrigger",o._elementRef.nativeElement))},dependencies:[zI],styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),t})(),a_e=(()=>{class t extends d4{constructor(e,o,r,s){super(e,o,r,s)}}return t.\u0275fac=function(e){return new(e||t)(ce(gi),ce(bc),ce(yi),ce(ly,8))},t.\u0275cmp=Qt({type:t,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(e,o){2&e&&(at("disabled",o.disabled||null),Ro("_mat-animation-noopable","NoopAnimations"===o._animationMode)("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[ji],attrs:e_e,ngContentSelectors:t_e,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(e,o){1&e&&(hr(),Ae(0,"span",0),ro(1),Ae(2,"span",1)(3,"span",2)(4,"span",3)),2&e&&(F(3),L("matRippleDisabled",o._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",o._elementRef.nativeElement))},dependencies:[zI],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),t})(),l_e=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[Cc,h$,Cc]}),t})(),c_e=(()=>{class t{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(e){this._vertical=Eu(e)}get inset(){return this._inset}set inset(e){this._inset=Eu(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(e,o){2&e&&(at("aria-orientation",o.vertical?"vertical":"horizontal"),Ro("mat-divider-vertical",o.vertical)("mat-divider-horizontal",!o.vertical)("mat-divider-inset",o.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(e,o){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0}),t})(),u_e=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[Cc,Cc]}),t})(),dM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Ic,ml,Du,Ic,Du]}),t})();If([po({transform:"{{transform}}",opacity:0}),$o("{{transition}}")]),If([$o("{{transition}}",po({transform:"{{transform}}",opacity:0}))]);let hM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,ml]}),t})();class nye{}function iye(t,n){if(1&t){const e=Ye();P(0,"div",5)(1,"button",6),Te("click",function(){return be(e),ve(U(2).onCancel())}),P(2,"div",7)(3,"span",8)(4,"p",9),ie(5,"Aceptar"),N()()()()()}}function oye(t,n){if(1&t){const e=Ye();P(0,"div")(1,"div",8)(2,"button",10),Te("click",function(){return be(e),ve(U(2).logout())}),P(3,"div",7)(4,"span",8)(5,"p",11),ie(6," Ir a inicio "),N()()()()()()}}function rye(t,n){if(1&t&&(W(0,iye,6,0,"div",3),W(1,oye,7,0,"div",4)),2&t){const e=U();L("ngIf",!e.expired&&!e.spotyExpired),F(1),L("ngIf",e.expired||e.spotyExpired)}}const sye=function(){return{width:"500px"}},aye=function(){return{"500px":"95vw"}};let m4=(()=>{class t{constructor(e){this.authService=e,this.expired=!1,this.spotyExpired=!1,this.showDialog=new ht}onCancel(){this.showDialog.emit(!1)}logout(){this.authService.logout()}renovate(){this.authService.logout(),this.showDialog.emit(!1)}}return t.\u0275fac=function(e){return new(e||t)(ce(AC))},t.\u0275cmp=Qt({type:t,selectors:[["app-success-dialog"]],inputs:{display:"display",message:"message",title:"title",expired:"expired",spotyExpired:"spotyExpired"},outputs:{showDialog:"showDialog"},decls:6,vars:10,consts:[[3,"visible","modal","draggable","breakpoints","visibleChange","onHide"],[1,"text-center"],["pTemplate","footer"],["class","p-3",4,"ngIf"],[4,"ngIf"],[1,"p-3"],["pButton","","pRipple","","type","submit",1,"p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"],["pButton","","pRipple","","type","button",1,"mt-2","p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-full",3,"click"],[1,"w-full"]],template:function(e,o){1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s})("onHide",function(){return o.onCancel()}),P(1,"h3",1),ie(2),N(),P(3,"p",1),ie(4),N(),W(5,rye,2,2,"ng-template",2),N()),2&e&&(Io(Kn(8,sye)),L("visible",o.display)("modal",!0)("draggable",!1)("breakpoints",Kn(9,aye)),F(2),jn(" ",o.title," "),F(2),jn(" ",o.message," "))},dependencies:[Xn,Dr,jl,fo]}),t})();function lye(t,n){if(1&t){const e=Ye();P(0,"button",8),Te("click",function(){return be(e),ve(U(2).backClick())}),P(1,"mat-icon",9),ie(2,"arrow_back"),N()()}2&t&&L("disabled",U(2).loadingVibe)}function cye(t,n){if(1&t&&(P(0,"div",5),W(1,lye,3,1,"button",6),P(2,"h2",7),ie(3,"Crear vibe"),N()()),2&t){const e=U();F(1),L("ngIf",e.showSecondPage||e.showThirdPage)}}function uye(t,n){if(1&t){const e=Ye();P(0,"div",31)(1,"div",32)(2,"div",33)(3,"h4",34),ie(4," Canciones encontradas "),N(),P(5,"div",29)(6,"span",35),Ae(7,"i",36),P(8,"input",37),Te("input",function(r){be(e),U();const s=Un(4),l=U(2);return ve(s.filterGlobal(l.getEventValue(r),"contains"))}),N()()()()()()}}function dye(t,n){1&t&&(P(0,"tr")(1,"th",38)(2,"div",39),ie(3," T\xedtulo "),Ae(4,"p-sortIcon",40),N()(),P(5,"th",41)(6,"div",39),ie(7," \xc1lbum "),Ae(8,"p-sortIcon",42),N()(),P(9,"th")(10,"div",43)(11,"mat-icon",44),ie(12,"access_time"),N()()()())}const g4=function(t){return{opacity:t}};function hye(t,n){if(1&t){const e=Ye();P(0,"mat-icon",55),Te("click",function(){be(e);const r=U().$implicit;return ve(U(3).playPreview(r.spotifySongId,r.songPreview))}),ie(1),N()}if(2&t){const e=U().$implicit,o=U(3);L("ngStyle",Wt(2,g4,o.appLayout.playingSong==e.spotifySongId?"1":"0")),F(1),Ut(o.appLayout.playingSong==e.spotifySongId?o.appLayout.previewIcon:"play_arrow")}}const pye=function(t){return{"image-preview":t}};function fye(t,n){if(1&t&&(P(0,"tr",45)(1,"td",46)(2,"div",47)(3,"div",48),Ae(4,"img",49),W(5,hye,2,4,"mat-icon",50),N(),P(6,"div",51),ie(7),wo(8,"slice"),N()()(),P(9,"td",52)(10,"div",53),ie(11),wo(12,"slice"),N()(),P(13,"td",52)(14,"div",54)(15,"div",51),ie(16),N()()()()),2&t){const e=n.$implicit,o=U(3);L("pSelectableRow",e),F(3),L("ngClass",Wt(17,pye,null!=e.songPreview)),F(1),Ai("src",e.songImage,Ui),L("ngStyle",Wt(19,g4,o.appLayout.playingSong==e.spotifySongId?"0.4":"1"))("alt",e.songName),F(1),L("ngIf",""!=e.songPreview),F(2),Ut(e.songName.length>28?Nr(8,9,e.songName,0,28)+"...":e.songName),F(4),Ut(e.songAlbum.length>25?Nr(12,13,e.songAlbum,0,25)+"...":e.songAlbum),F(5),Ut(e.songDuration)}}function mye(t,n){1&t&&(P(0,"tr")(1,"td",56),ie(2,"No se ha encontrado ninguna canci\xf3n"),N()())}function gye(t,n){if(1&t&&(P(0,"div",57),ie(1),N()),2&t){const e=U(3);F(1),jn(" ",e.songs.length," canciones encontradas ")}}const _ye=function(){return["songName","songAlbum"]},yye=function(){return[10,25,50]};function vye(t,n){if(1&t){const e=Ye();P(0,"div")(1,"p",19),ie(2,"Selecciona una canci\xf3n"),N(),P(3,"p-table",20,21),Te("selectionChange",function(r){return be(e),ve(U(2).selectedSong=r)})("onRowSelect",function(r){return be(e),ve(U(2).onRowSelect(r.data))})("onRowUnselect",function(r){return be(e),ve(U(2).onRowUnselect(r.data))}),W(5,uye,9,0,"ng-template",22),W(6,dye,13,0,"ng-template",23),W(7,fye,17,21,"ng-template",24),W(8,mye,3,0,"ng-template",25),W(9,gye,2,1,"ng-template",26),N(),P(10,"button",27),Te("click",function(){be(e);const r=U(2);return r.displayTable=!1,r.showFirstPage=!1,ve(r.showSecondPage=!0)}),P(11,"div",28)(12,"span",29)(13,"p",30),ie(14,"Continuar"),N()()()()()}if(2&t){const e=U(2);F(3),L("value",e.songs)("scrollable",!0)("selection",e.selectedSong)("loading",e.loading)("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",Kn(9,_ye))("rowsPerPageOptions",Kn(10,yye)),F(7),L("disabled",null==e.selectedSong)}}function bye(t,n){if(1&t){const e=Ye();P(0,"div")(1,"div",10)(2,"div",11)(3,"div")(4,"p",12),ie(5,"Busca una canci\xf3n para tu vibe"),N()()()(),P(6,"form",13),Te("ngSubmit",function(){be(e);const r=U();return ve(r.onSubmitSearchSong(r.searchForm))}),P(7,"div",14)(8,"span",15),Ae(9,"i",16),N(),Ae(10,"input",17)(11,"button",18),N()(),W(12,vye,15,11,"div",3),N()}if(2&t){const e=U();F(6),L("formGroup",e.searchForm),F(5),L("disabled",!e.searchForm.valid||e.loading)("icon",e.loading?"pi pi-spin pi-spinner":"pi pi-search"),F(1),L("ngIf",e.displayTable&&e.showFirstPage)}}function xye(t,n){if(1&t){const e=Ye();P(0,"div")(1,"div",58)(2,"div",59)(3,"div",60)(4,"div",61)(5,"p",62),ie(6,"Sit\xfaa tu cancion en el mapa"),N(),P(7,"p",63),ie(8,"Esta ser\xe1 la ubicaci\xf3n de tu vibe"),N()()()(),P(9,"div",64)(10,"div",65)(11,"p",66),ie(12),N(),P(13,"p",67),ie(14),N()(),Ae(15,"img",68),N(),P(16,"div",69),Ae(17,"img",68),P(18,"div",70)(19,"p",71),ie(20),N(),P(21,"p",72),ie(22),N()()()(),P(23,"app-map-vibes",73),Te("vibeLocation",function(r){return be(e),ve(U().vibeLocation(r))}),N(),P(24,"button",27),Te("click",function(){be(e);const r=U();return r.displayTable=!1,r.showThirdPage=!0,ve(r.showSecondPage=!1)}),P(25,"div",28)(26,"span",29)(27,"p",30),ie(28,"Continuar"),N()()()()()}if(2&t){const e=U();L("@fadeInOut",void 0),F(12),Ut(e.selectedSong.songName),F(2),jn(" ",e.selectedSong.songAlbum," "),F(1),Ai("src",e.selectedSong.songImage,Ui),L("alt",e.selectedSong.songName),F(2),Ai("src",e.selectedSong.songImage,Ui),L("alt",e.selectedSong.songName),F(3),Ut(e.selectedSong.songName),F(2),jn(" ",e.selectedSong.songAlbum," "),F(1),L("showSearchBar",!0)("id","mapVibes")("showLocationButton",!1)("newVibe",!0),F(1),L("disabled",!e.canContinue)}}function wye(t,n){1&t&&Ae(0,"p-progressSpinner",86)}function Cye(t,n){if(1&t){const e=Ye();P(0,"div")(1,"div",74)(2,"div",75)(3,"div")(4,"p"),ie(5,"Tu vibe"),N()()()(),P(6,"div",76),Ae(7,"img",77),P(8,"div",78)(9,"p",79),ie(10),N(),P(11,"p",80),ie(12),N()()(),P(13,"div",81),Ae(14,"img",82),P(15,"div",83),ie(16),N()(),P(17,"textarea",84),Te("ngModelChange",function(r){return be(e),ve(U().vibeDescription=r)}),N(),P(18,"button",27),Te("click",function(){return be(e),ve(U().uploadVibe())}),P(19,"div",28)(20,"span",29),W(21,wye,1,0,"p-progressSpinner",85),P(22,"p",30),ie(23),N()()()()()}if(2&t){const e=U();F(7),Ai("src",e.selectedSong.songImage,Ui),L("alt",e.selectedSong.songName),F(3),Ut(e.selectedSong.songName),F(2),jn(" ",e.selectedSong.songAlbum," "),F(4),jn(" ",e.locationName," "),F(1),L("ngModel",e.vibeDescription),F(1),L("disabled",e.loadingVibe),F(3),L("ngIf",e.loadingVibe),F(2),jn(" ",e.creatingVibe,"")}}const Tye=function(){return{width:"750px"}},Sye=function(){return{"750px":"95vw"}},Eye=function(t,n,e,o,r,s,l,h){return{"h-0":t,"h-1":n,"h-2":e,"h-3":o,"h-4":r,"h-5":s,"h-thirdPage":l,"h-secondPage":h}};let Iye=(()=>{class t{constructor(e,o){this.appLayout=e,this.vibesService=o,this.newVibeAdded=new ht,this.searchForm=new Qs({}),this.selected=!1,this.loading=!1,this.newVibe="nuevo-vibe",this.displayTable=!1,this.displayPlace=!1,this.showFirstPage=!0,this.showSecondPage=!1,this.showThirdPage=!1,this.loadingVibe=!1,this.creatingVibe="Crear vibe",this.displaySuccess=!1,this.canContinue=!1,this.selectedSong=new nye,this.songs=new Array,this.createdVive=new class eye{}}ngOnInit(){this.searchForm=new Qs({song:new Sr(this.song,[pr.required])})}getEventValue(e){return e.target.value}onSubmitSearchSong(e){var o=this;return Ft(function*(){o.loading=!0;try{const r=yield o.vibesService.searchSong(e.value.song);o.songs=r.songs,o.displayTable=!0}catch(r){403==r.status?o.appLayout.handle403Error():401==r.status?o.appLayout.handle401Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}o.loading=!1})()}onRowSelect(e){this.selected=!0}onRowUnselect(e){this.selectedSong=e,this.selected=!0}cancel(){this.searchForm.reset(),this.selectedSong=null,this.loading=!1,this.song="",this.showFirstPage=!0,this.displayTable=!1,this.showSecondPage=!1,this.showThirdPage=!1,this.loadingVibe=!1,this.creatingVibe="Crear vibe",this.vibeDescription=""}backClick(){this.showSecondPage?(this.showFirstPage=!0,this.displayTable=!0,this.showSecondPage=!1,this.showThirdPage=!1,this.selectedSong=null):this.showThirdPage&&(this.showSecondPage=!0,this.showThirdPage=!1)}uploadVibe(){var e=this;return Ft(function*(){e.loadingVibe=!0,e.creatingVibe="Creando vibe...",e.createdVive.description=e.vibeDescription,e.createdVive.spotifySongId=e.selectedSong.spotifySongId;try{const o=yield e.vibesService.createVibe(e.createdVive);e.cancel(),e.appLayout.displayNewVibeDialog=!1,e.displaySuccess=!0,e.newVibeAdded.emit(o.vibe)}catch(o){403==o.status?e.appLayout.handle403Error():401==o.status?e.appLayout.handle401Error():e.appLayout.messageService.add({severity:"error",summary:"Error",detail:o.data.status})}})()}onHide(e){this.displaySuccess=e}vibeLocation(e){var o=this;return Ft(function*(){o.createdVive.longitude=e[0],o.createdVive.latitude=e[1];try{const r=yield o.vibesService.getLocationName(e[0],e[1]);o.locationName=r,o.canContinue=!0}catch(r){403==r.status?o.appLayout.handle403Error():o.appLayout.messageService.add({severity:"error",summary:"Error",detail:r.data.status})}})()}playPreview(e,o){this.appLayout.playPreview(e,o)}}return t.\u0275fac=function(e){return new(e||t)(ce(Zo),ce(Oy))},t.\u0275cmp=Qt({type:t,selectors:[["app-new-vibe-dialog"]],outputs:{newVibeAdded:"newVibeAdded"},decls:7,vars:23,consts:[[3,"visible","closable","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header","class","py-0"],[1,"animation","h-song","pt-2",3,"ngClass"],[4,"ngIf"],["title","Vibe creado","message","Tu vibe ha sido creado con \xe9xito, puedes consultarlo en el mapa",3,"display","showDialog"],[1,"flex","align-items-center","justify-content-center","mb-1"],["class","back-buttons flex align-items-center justify-content-center mr-2","type","button",3,"disabled","click",4,"ngIf"],[1,"p-dialog-title"],["type","button",1,"back-buttons","flex","align-items-center","justify-content-center","mr-2",3,"disabled","click"],[1,"flex","justify-content-center"],[1,"flex","justify-content-between","flex-wrap","card-container"],[1,"flex"],[2,"margin-bottom","15px"],[3,"formGroup","ngSubmit"],[1,"p-inputgroup","h-fit"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-volume-up"],["id","song","name","song","formControlName","song","placeholder","Buscar canciones","type","text","pInputText","",1,"form-control","h-3rem"],["type","submit","pButton","","pRipple","","styleClass","p-button-danger",1,"button-gradient-45","w-3rem",2,"border-top-left-radius","0 !important","border-bottom-left-radius","0 !important",3,"disabled","icon"],[1,"mt-4",2,"margin-bottom","15px"],["dataKey","songId","selectionMode","single","styleClass","p-datatable-sm","scrollHeight","330px","currentPageReportTemplate","{first} a {last}",3,"value","scrollable","selection","loading","rowHover","showCurrentPageReport","globalFilterFields","rowsPerPageOptions","selectionChange","onRowSelect","onRowUnselect"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],["pButton","","pRipple","",1,"mt-4","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"disabled","click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"vibe-btn-text-white","w-full"],[1,"table-header"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"md:m-0","mb-3","text-center","md:text-left"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Filtrar",3,"input"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center","name-size"],["field","name"],["pSortableColumn","album"],["field","album"],[1,"flex","justify-content-between","align-items-center","margin-td-right",2,"float","right"],[1,"mr-2"],[3,"pSelectableRow"],[1,"padding-td","flex"],[1,"align-items-center",2,"display","flex","align-items","flex-start","height","60px"],[1,"round-images-size","relative",3,"ngClass"],[1,"round-images-size","border-round-sm",3,"src","ngStyle","alt"],["class","play-icon-preview absolute","style","top:10px; left: 10px",3,"ngStyle","click",4,"ngIf"],[1,"ml-3","name-size",2,"height","60px","text-align","start","display","flex","align-items","center"],[1,"padding-td"],[1,"name-size"],[1,"margin-td-right",2,"float","right"],[1,"play-icon-preview","absolute",2,"top","10px","left","10px",3,"ngStyle","click"],["colspan","8"],[1,"flex","align-items-center","justify-content-between"],[1,"flexbox-lg","justify-content-between","flex-wrap","card-container","mb-3"],[1,"flex","w-fit","h-4rem"],[1,"flex","align-items-center","w-auto","h-4rem"],[1,"mr-3"],[2,"text-overflow","ellipsis"],[1,"text-color-secondary",2,"text-overflow","ellipsis"],[1,"large-title","flex","align-items-center","justify-content-end","w-auto","h-4rem"],[1,"mr-3","text-right",2,"max-width","350px"],[1,"text-lg","text-right","overflow-text"],[1,"text-sm","text-color-secondary","text-right","overflow-text"],[1,"round-images-size","border-round-sm",3,"src","alt"],[1,"small-title","flex","align-items-center","w-auto","h-4rem"],[1,"ml-3",2,"max-width","350px"],[1,"text-lg","overflow-text"],[1,"text-sm","text-color-secondary","overflow-text"],["mapHeight","400px !important",3,"showSearchBar","id","showLocationButton","newVibe","vibeLocation"],[1,"flex","justify-content-between","flex-wrap","card-container","mb-4"],[1,"flex","w-fit"],[1,"flex","align-items-center","justify-content-start","w-auto","h-auto"],[1,"h-5rem","w-5rem","border-round-sm","mr-3",3,"src","alt"],[1,"text-left"],[1,"text-xl","mb-1"],[1,"text-base","text-color-secondary","mb-1"],[1,"mt-3","mb-3","flex","align-items-center"],["src","assets/images/spotivibesLogo.svg",1,"h-2rem","w-2rem","mr-1"],[1,"text-gradient","font-bold"],["placeholder","A\xf1adir descripci\xf3n",1,"outline","w-full","h-10rem","border-none","p-3","text-base",2,"resize","none","border-radius","10px !important","font-family","Lato","color","var(--fontColor)","background","var(--frostedBackground)",3,"ngModel","ngModelChange"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"]],template:function(e,o){1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.appLayout.displayNewVibeDialog=s})("onHide",function(){return o.cancel()}),W(1,cye,4,1,"ng-template",1),P(2,"div",2),W(3,bye,13,4,"div",3),W(4,xye,29,14,"div",3),W(5,Cye,24,9,"div",3),N()(),P(6,"app-success-dialog",4),Te("showDialog",function(s){return o.onHide(s)}),N()),2&e&&(Io(Kn(12,Tye)),L("visible",o.appLayout.displayNewVibeDialog)("closable",!o.loadingVibe)("modal",!0)("draggable",!1)("breakpoints",Kn(13,Sye)),F(2),L("ngClass",dE(14,Eye,o.displayTable&&0==o.songs.length,o.displayTable&&1==o.songs.length,o.displayTable&&2==o.songs.length,o.displayTable&&3==o.songs.length,o.displayTable&&4==o.songs.length,o.displayTable&&o.songs.length>=5,o.showThirdPage,o.showSecondPage)),F(1),L("ngIf",o.showFirstPage),F(1),L("ngIf",o.showSecondPage),F(1),L("ngIf",o.showThirdPage),F(1),L("display",o.displaySuccess))},dependencies:[ao,Xn,ho,Dd,yc,$a,Ed,Id,vc,Md,Dr,_l,jl,fo,Nd,E0,sN,FC,_a,Mu,VC,m4,Su],styles:["p[_ngcontent-%COMP%]{margin:0}.vibe-container[_ngcontent-%COMP%]{width:100%;display:flex}.image-column[_ngcontent-%COMP%]{width:50px;height:100%;align-items:start;right:0;top:7px}.text-column[_ngcontent-%COMP%]{margin-left:1rem;flex-grow:1;width:100%;height:100%;justify-content:center;align-items:start}  .p-progress-spinner-circle{stroke:#fff!important}  .p-dialog .p-dialog-header{padding-bottom:0}  .p-datatable.p-datatable-sm .p-datatable-footer{border-bottom-left-radius:10px!important;border-bottom-right-radius:10px}  .p-datatable .p-datatable-tbody>tr:focus{outline:.15rem solid #93cbf9;outline-offset:-.15rem;background:var(--selectedItemTable)!important}  .p-datatable .p-datatable-tbody>tr{background:var(--frostedTable)!important}  .p-datatable .p-datatable-tbody>tr:hover{background:var(--selectedItemTable)!important}  tr:hover .play-icon-preview{transition:var(--transition);opacity:1!important}  tr:hover img{transition:var(--transition);opacity:.3!important}  .p-datatable .p-datatable-header{background:var(--selectedItem)!important}  .p-datatable .p-datatable-footer{background:var(--selectedItem)!important;border-width:0px 1px 1px 1px}  .p-datatable.p-datatable-scrollable>.p-datatable-wrapper>.p-datatable-table>.p-datatable-thead{background:var(--selectedItem)!important}  .p-datatable .p-datatable-thead>tr>th{background:var(--frostedTable)!important}.animation[_ngcontent-%COMP%]{transition:var(--transition)}.h-song[_ngcontent-%COMP%]{height:90px}.h-0[_ngcontent-%COMP%]{height:385px!important}.h-1[_ngcontent-%COMP%]{height:410px!important}.h-2[_ngcontent-%COMP%]{height:465px!important}.h-3[_ngcontent-%COMP%]{height:530px!important}.h-4[_ngcontent-%COMP%]{height:590px!important}.h-5[_ngcontent-%COMP%]{height:640px!important}.h-6[_ngcontent-%COMP%]{height:695px!important}.h-secondPage[_ngcontent-%COMP%]{height:560px!important}.h-thirdPage[_ngcontent-%COMP%]{height:426px!important}.small-title[_ngcontent-%COMP%]{display:none!important}.flexbox-lg[_ngcontent-%COMP%]{display:flex}.outline[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 2px #93cbf9}@media (max-width: 768px){.name-size[_ngcontent-%COMP%]{font-size:.8rem!important;display:flex}.h-0[_ngcontent-%COMP%]{height:415px!important}.h-1[_ngcontent-%COMP%]{height:440px!important}.h-2[_ngcontent-%COMP%]{height:495px!important}.h-3[_ngcontent-%COMP%]{height:560px!important}.h-4[_ngcontent-%COMP%]{height:620px!important}.h-5[_ngcontent-%COMP%]{height:670px!important}.h-6[_ngcontent-%COMP%]{height:725px!important}.large-title[_ngcontent-%COMP%]{display:none!important}.small-title[_ngcontent-%COMP%]{display:flex!important}.h-secondPage[_ngcontent-%COMP%]{height:620px!important}.flexbox-lg[_ngcontent-%COMP%]{display:grid}}"],data:{animation:[pl("fadeInOut",[qo(":enter",[po({opacity:0}),$o("500ms",po({opacity:1}))]),qo(":leave",[$o("500ms",po({opacity:0}))])])]}}),t})();const Dye=function(){return{width:"800px"}},Mye=function(){return{"500px":"95vw"}};let kye=(()=>{class t{constructor(e){this.pushNotificationsService=e,this.showDialog=new ht}onCancel(){this.showDialog.emit(!1)}subscribeToPushNotifications(){this.pushNotificationsService.registerPushNotifications(),this.showDialog.emit(!1)}}return t.\u0275fac=function(e){return new(e||t)(ce(WB))},t.\u0275cmp=Qt({type:t,selectors:[["app-push-notifications-dialog"]],inputs:{display:"display"},outputs:{showDialog:"showDialog"},decls:19,vars:9,consts:[["header","Habilitar notificaciones",3,"visible","position","closable","draggable","breakpoints","visibleChange","onHide"],[1,"display-items","gap-3"],[1,"buttons"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-9rem","al",3,"click"],[1,"flex","align-items-center","justify-content-center","w-full"],[1,"flex","align-items-center","justify-content-center"],[1,"text-green-500","w-3rem"],[1,"text-green-500","w-full"],["pButton","","pRipple","","type","button",1,"p-button-raised","p-button-width","p-button-text","h-3rem","vibe-btn","w-9rem",3,"click"],[1,"text-pink-500","w-3rem"],[1,"text-pink-500","w-full"]],template:function(e,o){1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.display=s})("onHide",function(){return o.onCancel()}),P(1,"div",1)(2,"p"),ie(3," Habilita las notificaciones de escritorio para Spotivibes. "),N(),P(4,"div",2)(5,"button",3),Te("click",function(){return o.subscribeToPushNotifications()}),P(6,"div",4)(7,"span",5)(8,"mat-icon",6),ie(9,"check"),N(),P(10,"p",7),ie(11," Aceptar "),N()()()(),P(12,"button",8),Te("click",function(){return o.onCancel()}),P(13,"div",4)(14,"span",5)(15,"mat-icon",9),ie(16,"close"),N(),P(17,"p",10),ie(18," No, gracias "),N()()()()()()()),2&e&&(Io(Kn(7,Dye)),L("visible",o.display)("position","bottom-left")("closable",!1)("draggable",!1)("breakpoints",Kn(8,Mye)))},dependencies:[Dr,jl,_a],styles:[".display-items[_ngcontent-%COMP%]{display:flex}.buttons[_ngcontent-%COMP%]{display:flex;gap:15px}@media (max-width: 800px){.display-items[_ngcontent-%COMP%]{display:block;text-align:center!important;align-items:center}.buttons[_ngcontent-%COMP%]{justify-content:center}}"]}),t})(),pM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,zf,Ly,Gh,gl,I0]}),t})(),fM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Nf,Gh,gl]}),t})(),mM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Ly,fM]}),t})(),gM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Gh,pw,gl,Nf,Ly,zC,NC,DT,IT,dM,hM,Dw,MT,kT,ET,CT,AT,ST,I0,zf,T0,OT,LT,Gy,PT]}),t})(),Aye=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,Gh,pw,gl,Nf,Ly,zC,NC,DT,IT,dM,hM,Dw,MT,kT,ET,CT,AT,ST,I0,zf,T0,OT,LT,Gy,PT]}),t})(),_4=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({imports:[bi,pM,mM,gM,Aye]}),t})(),Pye=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t}),t.\u0275inj=yn({providers:[Rd],imports:[bi,HP,e4,LR,Gh,R$,pw,gl,Nf,Ly,zC,NC,DT,IT,dM,hM,Kge,Qq,l_e,Dw,u_e,MT,kT,ET,CT,AT,ST,I0,zf,T0,OT,LT,Gy,PT,_4,pM,mM,fM,gM]}),t})();vp(Zo,[Ns,Xn,ho,rC,l4,Zge,X2,e3,K2,r_e,a_e,_a,c_e,Sge,u4,Hge,Iye,m4,kye],[Su]);let Oye=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Qt({type:t,selectors:[["app-footer"]],decls:7,vars:0,consts:[[1,"footer","m-auto","w-full"],[1,"card","h-full"],[1,"flex","flex-wrap","card-container","blue-container","h-full"],[1,"flex","align-items-center","justify-content-center","w-full"],["alt","logo",1,"logo","m-auto"],["data-cy","copyrigth",1,"flex","align-items-center","justify-content-center","w-full"]],template:function(e,o){1&e&&(P(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Ae(4,"img",4),N(),P(5,"div",5),ie(6," \xa9 Spotivibes 2023. All rights reserved. "),N()()()())},styles:[".footer[_ngcontent-%COMP%]{background:var(--containerBackground);height:18rem}.logo[_ngcontent-%COMP%]{content:var(--logoFooter);background-size:cover;background-repeat:no-repeat;background-position:center;width:13rem}"]}),t})();function Lye(t,n){if(1&t){const e=Ye();P(0,"button",9),Te("click",function(){return be(e),ve(U(2).backClick())}),P(1,"mat-icon"),ie(2,"arrow_back"),N()()}2&t&&L("disabled",U(2).loadingSignUp)}function Rye(t,n){if(1&t&&(P(0,"div",7),W(1,Lye,3,1,"button",8),N()),2&t){const e=U();F(1),L("ngIf",e.displayRegister)}}function Fye(t,n){if(1&t){const e=Ye();P(0,"div",10)(1,"div",11)(2,"h3"),ie(3,"Un momento"),N(),P(4,"p"),ie(5," Antes de empezar vamos a configurar tu cuenta "),N()(),P(6,"button",12),Te("click",function(){return be(e),ve(U().showRegister())}),P(7,"div",2)(8,"span",13),ie(9,"Continuar"),N()()()()}2&t&&L("@onEnterDisolve",void 0)}function Nye(t,n){1&t&&(P(0,"div")(1,"span",35),ie(2,"Introduzca un correo v\xe1lido"),N()())}function zye(t,n){1&t&&(P(0,"div",36)(1,"span",35),ie(2,"Introduzca un correo"),N()())}function Bye(t,n){1&t&&(P(0,"div",36)(1,"span",35),ie(2,"El nombre no puede tener m\xe1s de 20 caracteres"),N()())}function Vye(t,n){1&t&&(P(0,"div",36)(1,"span",35),ie(2,"Introduzca un nombre"),N()())}function Uye(t,n){1&t&&(P(0,"div",36)(1,"span",35),ie(2,"El nombre de usuario no puede tener m\xe1s de 10 caracteres"),N()())}function jye(t,n){1&t&&(P(0,"div",36)(1,"span",35),ie(2,"Introduzca un nombre de usuario"),N()())}function Hye(t,n){1&t&&(Ae(0,"i",39),P(1,"span",40),ie(2,"El email indicado ya est\xe1 registrado."),N())}function $ye(t,n){1&t&&(P(0,"p-messages",37),W(1,Hye,3,0,"ng-template",38),N())}function Gye(t,n){1&t&&Ae(0,"p-progressSpinner",41)}function Wye(t,n){if(1&t){const e=Ye();P(0,"form",14),Te("ngSubmit",function(){be(e);const r=U();return ve(r.onSubmitSignUp(r.signUpForm))}),P(1,"div",15)(2,"div",16)(3,"h3"),ie(4,"Informaci\xf3n de tu cuenta"),N(),P(5,"p"),ie(6," Danos algunos detalles m\xe1s para configurar tu cuenta "),N()(),P(7,"div",17)(8,"label",18),ie(9,"email"),N(),P(10,"div",19)(11,"span",20),Ae(12,"i",21),N(),Ae(13,"input",22),N(),W(14,Nye,3,0,"div",23),W(15,zye,3,0,"div",24),N(),P(16,"div",17)(17,"label",25),ie(18,"Nombre"),N(),P(19,"div",19)(20,"span",20),Ae(21,"i",26),N(),Ae(22,"input",27),N(),W(23,Bye,3,0,"div",24),W(24,Vye,3,0,"div",24),N(),P(25,"div",17)(26,"label",28),ie(27,"Nombre de usuario"),N(),P(28,"div",19)(29,"span",20),Ae(30,"i",29),N(),Ae(31,"input",30),N(),W(32,Uye,3,0,"div",24),W(33,jye,3,0,"div",24),N(),W(34,$ye,2,0,"p-messages",31),P(35,"button",32)(36,"div",2)(37,"span",13),W(38,Gye,1,0,"p-progressSpinner",33),P(39,"p",34),ie(40),N()()()()()()}if(2&t){const e=U();let o,r,s,l,h,f;L("@onEnterDisolve",void 0)("formGroup",e.signUpForm),F(14),L("ngIf",e.signUpForm.controls.signUpEmail.invalid&&!(null!=(o=e.signUpForm.get("signUpEmail"))&&o.hasError("required"))&&(e.signUpForm.controls.signUpEmail.dirty||e.signUpForm.controls.signUpEmail.touched)),F(1),L("ngIf",(null==(r=e.signUpForm.get("signUpEmail"))?null:r.hasError("required"))&&(e.signUpForm.controls.signUpEmail.dirty||e.signUpForm.controls.signUpEmail.touched)),F(8),L("ngIf",(null==(s=e.signUpForm.get("signUpName"))?null:s.hasError("maxlength"))&&(e.signUpForm.controls.signUpName.dirty||e.signUpForm.controls.signUpName.touched)),F(1),L("ngIf",(null==(l=e.signUpForm.get("signUpName"))?null:l.hasError("required"))&&(e.signUpForm.controls.signUpName.dirty||e.signUpForm.controls.signUpName.touched)),F(8),L("ngIf",(null==(h=e.signUpForm.get("signUpNickname"))?null:h.hasError("maxlength"))&&(e.signUpForm.controls.signUpNickname.dirty||e.signUpForm.controls.signUpNickname.touched)),F(1),L("ngIf",(null==(f=e.signUpForm.get("signUpNickname"))?null:f.hasError("required"))&&(e.signUpForm.controls.signUpNickname.dirty||e.signUpForm.controls.signUpNickname.touched)),F(1),L("ngIf",e.emailError),F(1),L("disabled",!e.signUpForm.valid||e.loadingSignUp),F(3),L("ngIf",e.loadingSignUp),F(2),Ut(e.signUpBtnText)}}const qye=function(){return["/home"]};function Zye(t,n){1&t&&(P(0,"div",10)(1,"div",11)(2,"h3"),ie(3,"\xa1Todo listo!"),N(),P(4,"p"),ie(5," Ya puedes empezar a usar Spotivibes "),N()(),P(6,"button",42)(7,"div",2)(8,"span",13),ie(9,"Finalizar"),N()()()()),2&t&&(L("@onEnterDisolve",void 0),F(6),L("routerLink",Kn(2,qye)))}const Kye=function(){return{width:"600px",transition:"all 500ms"}},Xye=function(){return{"650px":"95vw"}},Yye=function(t,n){return{"h-380":t,"h-460":n}};let Qye=(()=>{class t{constructor(e,o,r){this.landingPage=e,this.usersService=o,this.messageService=r,this.errorMessage=new ht,this.loginDialog=!1,this.displayRegister=!1,this.displayCreated=!1,this.loadingSignUp=!1,this.signUpBtnText="Crear cuenta",this.emailError=!1,this.signUpForm=new Qs({})}ngOnInit(){this.signUpForm=new Qs({signUpEmail:new Sr(this.signUpEmail,[pr.required,pr.email]),signUpName:new Sr(this.signUpName,[pr.required,pr.maxLength(20)]),signUpNickname:new Sr(this.signUpNickname,[pr.required,pr.maxLength(10)])})}onSubmitSignUp(e){var o=this;return Ft(function*(){if(e.valid){o.loadingSignUp=!0,o.signUpBtnText="Creando cuenta...";try{const r=yield o.usersService.doCreateUser(e.value.signUpName,e.value.signUpEmail,e.value.signUpNickname);sessionStorage.setItem("accessToken",r.accessToken),o.loadingSignUp=!1,o.signUpBtnText="Crear cuenta",o.displayRegister=!1,o.displayCreated=!0}catch(r){o.errorMessage.emit(r.response.data.status),o.loadingSignUp=!1,o.displayRegister=!1,o.signUpBtnText="Crear cuenta"}}})()}cancel(){this.signUpForm.reset(),this.loadingSignUp=!1,this.displayRegister=!1,this.displayCreated=!1,this.signUpBtnText="Crear cuenta"}showRegister(){this.displayRegister=!0}backClick(){this.signUpForm.reset(),this.displayRegister=!1,this.loadingSignUp=!1,this.signUpBtnText="Crear cuenta"}}return t.\u0275fac=function(e){return new(e||t)(ce(jC),ce(Mg),ce(Rd))},t.\u0275cmp=Qt({type:t,selectors:[["app-login-dialog"]],outputs:{errorMessage:"errorMessage"},features:[zi([Rd])],decls:8,vars:16,consts:[[3,"visible","closable","modal","draggable","breakpoints","visibleChange","onHide"],["pTemplate","header"],[1,"flex","align-items-center","justify-content-center","w-full"],["alt","logo",1,"logo","m-auto"],[1,"animation","h-180",3,"ngClass"],["class","text-center md:px-3 py-3",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"flex","align-items-start"],["class","back-buttons flex align-items-center justify-content-center","type","button",3,"disabled","click",4,"ngIf"],["type","button",1,"back-buttons","flex","align-items-center","justify-content-center",3,"disabled","click"],[1,"text-center","md:px-3","py-3"],[1,"py-2"],["pButton","","pRipple","","type","submit",1,"mt-2","mb-2","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"click"],[1,"flex","align-items-center","justify-content-center"],[3,"formGroup","ngSubmit"],[1,"md:px-3"],[1,"py-2","text-center"],[1,"form-label-container"],["for","signUpEmail",1,"block","mb-2"],[1,"p-inputgroup"],[1,"p-inputgroup-addon","w-3rem"],[1,"pi","pi-envelope"],["id","signUpEmail","name","signUpEmail","formControlName","signUpEmail","placeholder","correo@email.com","type","text","pInputText","",1,"form-control","w-full","h-3rem"],[4,"ngIf"],["class","mb-2",4,"ngIf"],["for","signUpName",1,"block","mb-2"],[1,"pi","pi-user"],["id","signUpName","name","signUpName","formControlName","signUpName","placeholder","Nombre Apellido","type","text","pInputText","",1,"form-control","w-full","h-3rem"],["for","signUpNickname",1,"block","mb-2"],[1,"pi","pi-at"],["id","signUpNickname","name","signUpNickname","formControlName","signUpNickname","placeholder","Nombre de usuario","type","text","pInputText","",1,"form-control","w-full","h-3rem"],["severity","error",4,"ngIf"],["pButton","","pRipple","","type","submit",1,"mt-2","mb-2","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"disabled"],["styleClass","w-2rem h-2rem","strokeWidth","5","class","flex align-items-center mr-2",4,"ngIf"],[1,"vibe-btn-text-white","w-full"],[1,"text-xs",2,"color","var(--validationErrors)"],[1,"mb-2"],["severity","error"],["pTemplate",""],[1,"pi","pi-exclamation-triangle","mr-2"],[1,"custom-message"],["styleClass","w-2rem h-2rem","strokeWidth","5",1,"flex","align-items-center","mr-2"],["pButton","","pRipple","",1,"mt-2","mb-2","p-button-raised","p-button-width","p-button-text","h-3rem","button-gradient","w-full",3,"routerLink"]],template:function(e,o){1&e&&(P(0,"p-dialog",0),Te("visibleChange",function(s){return o.landingPage.displayFirstLogin=s})("onHide",function(){return o.cancel()}),W(1,Rye,2,1,"ng-template",1),P(2,"div",2),Ae(3,"img",3),N(),P(4,"div",4),W(5,Fye,10,1,"div",5),W(6,Wye,41,12,"form",6),W(7,Zye,10,3,"div",5),N()()),2&e&&(Io(Kn(11,Kye)),L("visible",o.landingPage.displayFirstLogin)("closable",!o.displayCreated&&!o.displayRegister)("modal",!0)("draggable",!1)("breakpoints",Kn(12,Xye)),F(4),L("ngClass",Ji(13,Yye,o.displayRegister&&!o.emailError,o.displayRegister&&o.emailError)),F(1),L("ngIf",!o.displayRegister&&!o.displayCreated),F(1),L("ngIf",o.displayRegister),F(1),L("ngIf",o.displayCreated))},dependencies:[Qh,ao,Xn,Dd,yc,$a,Ed,vc,Md,Dr,fo,_l,jl,_a,TT,Mu],styles:[".logo[_ngcontent-%COMP%]{content:var(--logoFooter);background-size:cover;background-repeat:no-repeat;background-position:center;width:13rem}[_nghost-%COMP%]     .p-inputtext{width:100%!important;height:3rem!important;border-top-left-radius:0;border-bottom-left-radius:0}[_nghost-%COMP%]     .p-password{width:100%!important}[_nghost-%COMP%]     .p-progress-spinner-circle{stroke:#fff!important}.animation[_ngcontent-%COMP%]{transition:var(--transition)}.h-180[_ngcontent-%COMP%]{height:175px}.h-380[_ngcontent-%COMP%]{height:465px!important}.h-460[_ngcontent-%COMP%]{height:555px!important}"],data:{animation:[pl("onEnterDisolve",[qo(":enter",[po({opacity:0,animation:"disolve 0.8s"}),$o(800)])])]}}),t})(),Jye=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=pn({type:t,bootstrap:[pD]}),t.\u0275inj=yn({providers:[Rd],imports:[Pye,e4,bi,pw,LR,gl,zC,Nf,NC,Ly,Dw,Gh,tme,Wfe,IT,DT,MT,kT,CT,ET,ST,AT,I0,Gy,PT,T0,Uge,OT,LT,zf,Nre,_4,pM,mM,fM,gM]}),t})();vp(jC,[Xn,Dr,u4,Mu,Oye,Qye],[]),Yj().bootstrapModule(Jye).catch(t=>console.error(t))},49:function(an,rn,pt){var vt;an=pt.nmd(an),function(_t){"object"==typeof global&&global;var Je=function(qt){this.message=qt};(Je.prototype=new Error).name="InvalidCharacterError";var Ke=function(qt){throw new Je(qt)},Ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xe=/[\t\n\f\r ]/g,en={encode:function(qt){qt=String(qt),/[^\0-\xFF]/.test(qt)&&Ke("The string to be encoded contains characters outside of the Latin1 range.");for(var Ue,st,He,wt,jt=qt.length%3,Me="",ft=-1,Lt=qt.length-jt;++ft<Lt;)Ue=qt.charCodeAt(ft)<<16,st=qt.charCodeAt(++ft)<<8,He=qt.charCodeAt(++ft),Me+=Ve.charAt((wt=Ue+st+He)>>18&63)+Ve.charAt(wt>>12&63)+Ve.charAt(wt>>6&63)+Ve.charAt(63&wt);return 2==jt?(Ue=qt.charCodeAt(ft)<<8,st=qt.charCodeAt(++ft),Me+=Ve.charAt((wt=Ue+st)>>10)+Ve.charAt(wt>>4&63)+Ve.charAt(wt<<2&63)+"="):1==jt&&(wt=qt.charCodeAt(ft),Me+=Ve.charAt(wt>>2)+Ve.charAt(wt<<4&63)+"=="),Me},decode:function(qt){var jt=(qt=String(qt).replace(Xe,"")).length;jt%4==0&&(jt=(qt=qt.replace(/==?$/,"")).length),(jt%4==1||/[^+a-zA-Z0-9/]/.test(qt))&&Ke("Invalid character: the string to be decoded is not correctly encoded.");for(var ft,Ue,Me=0,st="",He=-1;++He<jt;)Ue=Ve.indexOf(qt.charAt(He)),ft=Me%4?64*ft+Ue:Ue,Me++%4&&(st+=String.fromCharCode(255&ft>>(-2*Me&6)));return st},version:"0.1.0"};void 0!==(vt=function(){return en}.call(rn,pt,rn,an))&&(an.exports=vt)}()},69:an=>{"use strict";var vt,rn="object"==typeof Reflect?Reflect:null,pt=rn&&"function"==typeof rn.apply?rn.apply:function(He,St,wt){return Function.prototype.apply.call(He,St,wt)};vt=rn&&"function"==typeof rn.ownKeys?rn.ownKeys:Object.getOwnPropertySymbols?function(He){return Object.getOwnPropertyNames(He).concat(Object.getOwnPropertySymbols(He))}:function(He){return Object.getOwnPropertyNames(He)};var Ge=Number.isNaN||function(He){return He!=He};function g(){g.init.call(this)}an.exports=g,an.exports.once=function Me(st,He){return new Promise(function(St,wt){function Lt(Bn){st.removeListener(He,ln),wt(Bn)}function ln(){"function"==typeof st.removeListener&&st.removeListener("error",Lt),St([].slice.call(arguments))}Ue(st,He,ln,{once:!0}),"error"!==He&&function ft(st,He,St){"function"==typeof st.on&&Ue(st,"error",He,St)}(st,Lt,{once:!0})})},g.EventEmitter=g,g.prototype._events=void 0,g.prototype._eventsCount=0,g.prototype._maxListeners=void 0;var se=10;function Je(st){if("function"!=typeof st)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof st)}function Ke(st){return void 0===st._maxListeners?g.defaultMaxListeners:st._maxListeners}function Ve(st,He,St,wt){var Lt,ln,Bn;if(Je(St),void 0===(ln=st._events)?(ln=st._events=Object.create(null),st._eventsCount=0):(void 0!==ln.newListener&&(st.emit("newListener",He,St.listener?St.listener:St),ln=st._events),Bn=ln[He]),void 0===Bn)Bn=ln[He]=St,++st._eventsCount;else if("function"==typeof Bn?Bn=ln[He]=wt?[St,Bn]:[Bn,St]:wt?Bn.unshift(St):Bn.push(St),(Lt=Ke(st))>0&&Bn.length>Lt&&!Bn.warned){Bn.warned=!0;var Co=new Error("Possible EventEmitter memory leak detected. "+Bn.length+" "+String(He)+" listeners added. Use emitter.setMaxListeners() to increase limit");Co.name="MaxListenersExceededWarning",Co.emitter=st,Co.type=He,Co.count=Bn.length,function _t(st){console&&console.warn&&console.warn(st)}(Co)}return st}function Xe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Bt(st,He,St){var wt={fired:!1,wrapFn:void 0,target:st,type:He,listener:St},Lt=Xe.bind(wt);return Lt.listener=St,wt.wrapFn=Lt,Lt}function bn(st,He,St){var wt=st._events;if(void 0===wt)return[];var Lt=wt[He];return void 0===Lt?[]:"function"==typeof Lt?St?[Lt.listener||Lt]:[Lt]:St?function jt(st){for(var He=new Array(st.length),St=0;St<He.length;++St)He[St]=st[St].listener||st[St];return He}(Lt):un(Lt,Lt.length)}function en(st){var He=this._events;if(void 0!==He){var St=He[st];if("function"==typeof St)return 1;if(void 0!==St)return St.length}return 0}function un(st,He){for(var St=new Array(He),wt=0;wt<He;++wt)St[wt]=st[wt];return St}function Ue(st,He,St,wt){if("function"==typeof st.on)wt.once?st.once(He,St):st.on(He,St);else{if("function"!=typeof st.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof st);st.addEventListener(He,function Lt(ln){wt.once&&st.removeEventListener(He,Lt),St(ln)})}}Object.defineProperty(g,"defaultMaxListeners",{enumerable:!0,get:function(){return se},set:function(st){if("number"!=typeof st||st<0||Ge(st))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+st+".");se=st}}),g.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},g.prototype.setMaxListeners=function(He){if("number"!=typeof He||He<0||Ge(He))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+He+".");return this._maxListeners=He,this},g.prototype.getMaxListeners=function(){return Ke(this)},g.prototype.emit=function(He){for(var St=[],wt=1;wt<arguments.length;wt++)St.push(arguments[wt]);var Lt="error"===He,ln=this._events;if(void 0!==ln)Lt=Lt&&void 0===ln.error;else if(!Lt)return!1;if(Lt){var Bn;if(St.length>0&&(Bn=St[0]),Bn instanceof Error)throw Bn;var Co=new Error("Unhandled error."+(Bn?" ("+Bn.message+")":""));throw Co.context=Bn,Co}var Ao=ln[He];if(void 0===Ao)return!1;if("function"==typeof Ao)pt(Ao,this,St);else{var Hn=Ao.length,Mr=un(Ao,Hn);for(wt=0;wt<Hn;++wt)pt(Mr[wt],this,St)}return!0},g.prototype.on=g.prototype.addListener=function(He,St){return Ve(this,He,St,!1)},g.prototype.prependListener=function(He,St){return Ve(this,He,St,!0)},g.prototype.once=function(He,St){return Je(St),this.on(He,Bt(this,He,St)),this},g.prototype.prependOnceListener=function(He,St){return Je(St),this.prependListener(He,Bt(this,He,St)),this},g.prototype.off=g.prototype.removeListener=function(He,St){var wt,Lt,ln,Bn,Co;if(Je(St),void 0===(Lt=this._events))return this;if(void 0===(wt=Lt[He]))return this;if(wt===St||wt.listener===St)0==--this._eventsCount?this._events=Object.create(null):(delete Lt[He],Lt.removeListener&&this.emit("removeListener",He,wt.listener||St));else if("function"!=typeof wt){for(ln=-1,Bn=wt.length-1;Bn>=0;Bn--)if(wt[Bn]===St||wt[Bn].listener===St){Co=wt[Bn].listener,ln=Bn;break}if(ln<0)return this;0===ln?wt.shift():function qt(st,He){for(;He+1<st.length;He++)st[He]=st[He+1];st.pop()}(wt,ln),1===wt.length&&(Lt[He]=wt[0]),void 0!==Lt.removeListener&&this.emit("removeListener",He,Co||St)}return this},g.prototype.removeAllListeners=function(He){var St,wt,Lt;if(void 0===(wt=this._events))return this;if(void 0===wt.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==wt[He]&&(0==--this._eventsCount?this._events=Object.create(null):delete wt[He]),this;if(0===arguments.length){var Bn,ln=Object.keys(wt);for(Lt=0;Lt<ln.length;++Lt)"removeListener"!==(Bn=ln[Lt])&&this.removeAllListeners(Bn);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(St=wt[He]))this.removeListener(He,St);else if(void 0!==St)for(Lt=St.length-1;Lt>=0;Lt--)this.removeListener(He,St[Lt]);return this},g.prototype.listeners=function(He){return bn(this,He,!0)},g.prototype.rawListeners=function(He){return bn(this,He,!1)},g.listenerCount=function(st,He){return"function"==typeof st.listenerCount?st.listenerCount(He):en.call(st,He)},g.prototype.listenerCount=en,g.prototype.eventNames=function(){return this._eventsCount>0?vt(this._events):[]}},780:an=>{var pt;an.exports=pt={},pt.simpleFilter=function(vt,_t){return _t.filter(function(Ge){return pt.test(vt,Ge)})},pt.test=function(vt,_t){return null!==pt.match(vt,_t)},pt.match=function(vt,_t,Ge){var en,g=0,se=[],Je=_t.length,Ke=0,Ve=0,Xe=(Ge=Ge||{}).pre||"",Bt=Ge.post||"",bn=Ge.caseSensitive&&_t||_t.toLowerCase();vt=Ge.caseSensitive&&vt||vt.toLowerCase();for(var un=0;un<Je;un++)en=_t[un],bn[un]===vt[g]?(en=Xe+en+Bt,g+=1,Ve+=1+Ve):Ve=0,Ke+=Ve,se[se.length]=en;return g===vt.length?(Ke=bn===vt?1/0:Ke,{rendered:se.join(""),score:Ke}):null},pt.filter=function(vt,_t,Ge){return _t&&0!==_t.length?"string"!=typeof vt?_t:(Ge=Ge||{},_t.reduce(function(g,se,Je,Ke){var Ve=se;Ge.extract&&(Ve=Ge.extract(se));var Xe=pt.match(vt,Ve,Ge);return null!=Xe&&(g[g.length]={string:Xe.rendered,score:Xe.score,index:Je,original:se}),g},[]).sort(function(g,se){return se.score-g.score||g.index-se.index})):[]}},82:an=>{var pt=NaN,vt="[object Symbol]",_t=/^\s+|\s+$/g,Ge=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,se=/^0o[0-7]+$/i,Je=parseInt,Ke="object"==typeof global&&global&&global.Object===Object&&global,Ve="object"==typeof self&&self&&self.Object===Object&&self,Xe=Ke||Ve||Function("return this")(),bn=Object.prototype.toString,en=Math.max,un=Math.min,qt=function(){return Xe.Date.now()};function Me(He){var St=typeof He;return!!He&&("object"==St||"function"==St)}function st(He){if("number"==typeof He)return He;if(function Ue(He){return"symbol"==typeof He||function ft(He){return!!He&&"object"==typeof He}(He)&&bn.call(He)==vt}(He))return pt;if(Me(He)){var St="function"==typeof He.valueOf?He.valueOf():He;He=Me(St)?St+"":St}if("string"!=typeof He)return 0===He?He:+He;He=He.replace(_t,"");var wt=g.test(He);return wt||se.test(He)?Je(He.slice(2),wt?2:8):Ge.test(He)?pt:+He}an.exports=function jt(He,St,wt){var Lt,ln,Bn,Co,Ao,Hn,Mr=0,mr=!1,na=!1,Vs=!0;if("function"!=typeof He)throw new TypeError("Expected a function");function ri(ii){var Ko=Lt,Vn=ln;return Lt=ln=void 0,Mr=ii,Co=He.apply(Vn,Ko)}function Us(ii){var Ko=ii-Hn;return void 0===Hn||Ko>=St||Ko<0||na&&ii-Mr>=Bn}function fs(){var ii=qt();if(Us(ii))return si(ii);Ao=setTimeout(fs,function Gl(ii){var Mo=St-(ii-Hn);return na?un(Mo,Bn-(ii-Mr)):Mo}(ii))}function si(ii){return Ao=void 0,Vs&&Lt?ri(ii):(Lt=ln=void 0,Co)}function Ki(){var ii=qt(),Ko=Us(ii);if(Lt=arguments,ln=this,Hn=ii,Ko){if(void 0===Ao)return function Ca(ii){return Mr=ii,Ao=setTimeout(fs,St),mr?ri(ii):Co}(Hn);if(na)return Ao=setTimeout(fs,St),ri(Hn)}return void 0===Ao&&(Ao=setTimeout(fs,St)),Co}return St=st(St)||0,Me(wt)&&(mr=!!wt.leading,Bn=(na="maxWait"in wt)?en(st(wt.maxWait)||0,St):Bn,Vs="trailing"in wt?!!wt.trailing:Vs),Ki.cancel=function Ta(){void 0!==Ao&&clearTimeout(Ao),Mr=0,Lt=Hn=ln=Ao=void 0},Ki.flush=function js(){return void 0===Ao?Co:si(qt())},Ki}},898:function(an){an.exports=function(){"use strict";var rn,pt,vt;function _t(g,se){if(rn)if(pt){var Je="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+rn+")(sharedChunk); ("+pt+")(sharedChunk); self.onerror = null;",Ke={};rn(Ke),vt=se(Ke),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(vt.workerUrl=window.URL.createObjectURL(new Blob([Je],{type:"text/javascript"})))}else pt=se;else rn=se}return _t(0,function(g){var se=typeof self<"u"?self:{},Je="2.13.0";let Ke;const Ve={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Ke){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Ke=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):c}catch{Ke=c}}return Ke},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Xe={supported:!1,testSupport:function(c){!en&&bn&&(un?qt(c):Bt=c)}};let Bt,bn,en=!1,un=!1;function qt(c){const a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,bn),c.isContextLost())return;Xe.supported=!0}catch{}c.deleteTexture(a),en=!0}se.document&&(bn=se.document.createElement("img"),bn.onload=function(){Bt&&qt(Bt),Bt=null,un=!0},bn.onerror=function(){en=!0,Bt=null},bn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const jt="01";var Me=ft;function ft(c,a,u,p){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=a,this.p2x=u,this.p2y=p}ft.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,a){if(void 0===a&&(a=1e-6),c<0)return 0;if(c>1)return 1;for(var u=c,p=0;p<8;p++){var _=this.sampleCurveX(u)-c;if(Math.abs(_)<a)return u;var b=this.sampleCurveDerivativeX(u);if(Math.abs(b)<1e-6)break;u-=_/b}var w=0,S=1;for(u=c,p=0;p<20&&(_=this.sampleCurveX(u),!(Math.abs(_-c)<a));p++)c>_?w=u:S=u,u=.5*(S-w)+w;return u},solve:function(c,a){return this.sampleCurveY(this.solveCurveX(c,a))}};var Ue=st;function st(c,a){this.x=c,this.y=a}st.prototype={clone:function(){return new st(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,a){return this.clone()._rotateAround(c,a)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var a=c.x-this.x,u=c.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,a){return Math.atan2(this.x*a-this.y*c,this.x*c+this.y*a)},_matMult:function(c){var a=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=a,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var a=Math.cos(c),u=Math.sin(c),p=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=p,this},_rotateAround:function(c,a){var u=Math.cos(c),p=Math.sin(c),_=a.y+p*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-p*(this.y-a.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},st.convert=function(c){return c instanceof st?c:Array.isArray(c)?new st(c[0],c[1]):c};const He=Math.PI/180,St=180/Math.PI;function wt(c){return c*He}function Lt(c){return c*St}const ln=[[0,0],[1,0],[1,1],[0,1]];function Bn(c){if(c<=0)return 0;if(c>=1)return 1;const a=c*c,u=a*c;return 4*(c<.5?u:3*(c-a)+u-.75)}function Co(c,a,u,p){const _=new Me(c,a,u,p);return function(b){return _.solve(b)}}const Ao=Co(.25,.1,.25,1);function Hn(c,a,u){return Math.min(u,Math.max(a,c))}function Mr(c,a,u){return(u=Hn((u-c)/(a-c),0,1))*u*(3-2*u)}function mr(c,a,u){const p=u-a,_=((c-a)%p+p)%p+a;return _===a?u:_}function na(c,a,u){if(!c.length)return u(null,[]);let p=c.length;const _=new Array(c.length);let b=null;c.forEach((w,S)=>{a(w,(I,M)=>{I&&(b=I),_[S]=M,0==--p&&u(b,_)})})}function Vs(c){const a=[];for(const u in c)a.push(c[u]);return a}function ri(c,...a){for(const u of a)for(const p in u)c[p]=u[p];return c}let Ca=1;function Gl(){return Ca++}function Us(){return function c(a){return a?(a^Math.random()*(16>>a/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function fs(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function si(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function Ta(c,a){c.forEach(u=>{a[u]&&(a[u]=a[u].bind(a))})}function js(c,a){return-1!==c.indexOf(a,c.length-a.length)}function Ki(c,a,u){const p={};for(const _ in c)p[_]=a.call(u||this,c[_],_,c);return p}function ii(c,a,u){const p={};for(const _ in c)a.call(u||this,c[_],_,c)&&(p[_]=c[_]);return p}function Ko(c){return Array.isArray(c)?c.map(Ko):"object"==typeof c&&c?Ki(c,Ko):c}const Vn={};function Mo(c){Vn[c]||(typeof console<"u"&&console.warn(c),Vn[c]=!0)}function Wa(c,a,u){return(u.y-c.y)*(a.x-c.x)>(a.y-c.y)*(u.x-c.x)}function $i(c){let a=0;for(let u,p,_=0,b=c.length,w=b-1;_<b;w=_++)u=c[_],p=c[w],a+=(p.x-u.x)*(u.y+p.y);return a}function qa(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ac(c){const a={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,p,_,b)=>{const w=_||b;return a[p]=!w||w.toLowerCase(),""}),a["max-age"]){const u=parseInt(a["max-age"],10);isNaN(u)?delete a["max-age"]:a["max-age"]=u}return a}let cp=null;function Wl(c){if(null==cp){const a=c.navigator?c.navigator.userAgent:null;cp=!!c.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return cp}function up(c){try{const a=se[c];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ou(c,a){return[c[4*a],c[4*a+1],c[4*a+2],c[4*a+3]]}const Hd="mapbox-tiles";let Za,Ka,$d=500,Pc=50;function dp(){try{return se.caches}catch{}}function xl(){dp()&&!Za&&(Za=se.caches.open(Hd))}function Lu(c){const a=c.indexOf("?");if(a<0)return c;const p=function(_){const b=_.indexOf("?");return b>0?_.slice(b+1).split("&"):[]}(c).filter(_=>{const b=_.split("=");return"language"===b[0]||"worldview"===b[0]});return p.length?`${c.slice(0,a)}?${p.join("&")}`:c.slice(0,a)}let Gd=1/0;const Wd={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Wd);class ia extends Error{constructor(a,u,p){401===u&&Bu(p)&&(a+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(a),this.status=u,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Sa=qa()?()=>self.worker&&self.worker.referrer:()=>("blob:"===se.location.protocol?se.parent:se).location.href,ql=function(c,a){if(!(/^file:/.test(u=c.url)||/^file:/.test(Sa())&&!/^\w+:/.test(u))){if(se.fetch&&se.Request&&se.AbortController&&se.Request.prototype.hasOwnProperty("signal"))return function(p,_){const b=new se.AbortController,w=new se.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:Sa(),signal:b.signal});let S=!1,I=!1;const M=(z=w.url).indexOf("sku=")>0&&Bu(z);var z;"json"===p.type&&w.headers.set("Accept","application/json");const j=(K,Y,te)=>{if(I)return;if(K&&"SecurityError"!==K.message&&Mo(K),Y&&te)return H(Y);const ae=Date.now();se.fetch(w).then(we=>{if(we.ok){const ke=M?we.clone():null;return H(we,ke,ae)}return _(new ia(we.statusText,we.status,p.url))}).catch(we=>{"AbortError"!==we.name&&_(new Error(`${we.message} ${p.url}`))})},H=(K,Y,te)=>{("arrayBuffer"===p.type?K.arrayBuffer():"json"===p.type?K.json():K.text()).then(ae=>{I||(Y&&te&&function(we,ke,me){if(xl(),!Za)return;const Se={status:ke.status,statusText:ke.statusText,headers:new se.Headers};ke.headers.forEach((tt,Qe)=>Se.headers.set(Qe,tt));const Oe=Ac(ke.headers.get("Cache-Control")||"");if(Oe["no-store"])return;Oe["max-age"]&&Se.headers.set("Expires",new Date(me+1e3*Oe["max-age"]).toUTCString());const De=Se.headers.get("Expires");De&&(new Date(De).getTime()-me<42e4||function(tt,Qe){if(void 0===Ka)try{new Response(new ReadableStream),Ka=!0}catch{Ka=!1}Ka?Qe(tt.body):tt.blob().then(Qe)}(ke,tt=>{const Qe=new se.Response(tt,Se);xl(),Za&&Za.then(mt=>mt.put(Lu(we.url),Qe)).catch(mt=>Mo(mt.message))}))}(w,Y,te),S=!0,_(null,ae,K.headers.get("Cache-Control"),K.headers.get("Expires")))}).catch(ae=>{I||_(new Error(ae.message))})};return M?function(K,Y){if(xl(),!Za)return Y(null);const te=Lu(K.url);Za.then(ae=>{ae.match(te).then(we=>{const ke=function(me){if(!me)return!1;const Se=new Date(me.headers.get("Expires")||0),Oe=Ac(me.headers.get("Cache-Control")||"");return Se>Date.now()&&!Oe["no-cache"]}(we);ae.delete(te),ke&&ae.put(te,we.clone()),Y(null,we,ke)}).catch(Y)}).catch(Y)}(w,j):j(null,null),{cancel:()=>{I=!0,S||b.abort()}}}(c,a);if(qa()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,a,void 0,!0)}var u;return function(p,_){const b=new se.XMLHttpRequest;b.open(p.method||"GET",p.url,!0),"arrayBuffer"===p.type&&(b.responseType="arraybuffer");for(const w in p.headers)b.setRequestHeader(w,p.headers[w]);return"json"===p.type&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials="include"===p.credentials,b.onerror=()=>{_(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||0===b.status)&&null!==b.response){let w=b.response;if("json"===p.type)try{w=JSON.parse(b.response)}catch(S){return _(S)}_(null,w,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else _(new ia(b.statusText,b.status,p.url))},b.send(p.body),{cancel:()=>b.abort()}}(c,a)},Ru=function(c,a){return ql(ri(c,{type:"arrayBuffer"}),a)};function qd(c){const a=se.document.createElement("a");return a.href=c,a.protocol===se.document.location.protocol&&a.host===se.document.location.host}const Zd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Fu,Nu;Fu=[],Nu=0;const hp=function(c,a){if(Xe.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Nu>=Ve.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:c,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return Fu.push(b),b}Nu++;let u=!1;const p=()=>{if(!u)for(u=!0,Nu--;Fu.length&&Nu<Ve.MAX_PARALLEL_IMAGE_REQUESTS;){const b=Fu.shift(),{requestParameters:w,callback:S,cancelled:I}=b;I||(b.cancel=hp(w,S).cancel)}},_=Ru(c,(b,w,S,I)=>{p(),b?a(b):w&&(se.createImageBitmap?function(M,z){const j=new se.Blob([new Uint8Array(M)],{type:"image/png"});se.createImageBitmap(j).then(H=>{z(null,H)}).catch(H=>{z(new Error(`Could not load image because of ${H.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(w,(M,z)=>a(M,z,S,I)):function(M,z){const j=new se.Image,H=se.URL;j.onload=()=>{z(null,j),H.revokeObjectURL(j.src),j.onload=null,se.requestAnimationFrame(()=>{j.src=Zd})},j.onerror=()=>z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const K=new se.Blob([new Uint8Array(M)],{type:"image/png"});j.src=M.byteLength?H.createObjectURL(K):Zd}(w,(M,z)=>a(M,z,S,I)))});return{cancel:()=>{_.cancel(),p()}}},zu="NO_ACCESS_TOKEN";function Xa(c){return 0===c.indexOf("mapbox:")}function Bu(c){return Ve.API_URL_REGEX.test(c)}function Vu(c){return Ve.API_CDN_URL_REGEX.test(c)}function Kd(c){return Ve.API_STYLE_REGEX.test(c)&&!Oc(c)}function Oc(c){return Ve.API_SPRITE_REGEX.test(c)}const Zl=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ds(c){const a=c.match(Zl);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Kl(c){const a=c.params.length?`?${c.params.join("&")}`:"";return`${c.protocol}://${c.authority}${c.path}${a}`}function Xd(c){if(!c)return null;const a=c.split(".");if(!a||3!==a.length)return null;try{return JSON.parse(decodeURIComponent(se.atob(a[1]).split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Xl{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const u=Xd(Ve.ACCESS_TOKEN);let p="";return p=u&&u.u?se.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,(_,b)=>String.fromCharCode(Number("0x"+b)))):Ve.ACCESS_TOKEN||"",a?`mapbox.eventData.${a}:${p}`:`mapbox.eventData:${p}`}fetchEventData(){const a=up("localStorage"),u=this.getStorageKey(),p=this.getStorageKey("uuid");if(a)try{const _=se.localStorage.getItem(u);_&&(this.eventData=JSON.parse(_));const b=se.localStorage.getItem(p);b&&(this.anonId=b)}catch{Mo("Unable to read from LocalStorage")}}saveEventData(){const a=up("localStorage"),u=this.getStorageKey(),p=this.getStorageKey("uuid");if(a)try{se.localStorage.setItem(p,this.anonId),Object.keys(this.eventData).length>=1&&se.localStorage.setItem(u,JSON.stringify(this.eventData))}catch{Mo("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,u,p,_){if(!Ve.EVENTS_URL)return;const b=Ds(Ve.EVENTS_URL);b.params.push(`access_token=${_||Ve.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(a).toISOString()},S=u?ri(w,u):w,I={url:Kl(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};var z;this.pendingRequest=(z=M=>{this.pendingRequest=null,p(M),this.saveEventData(),this.processRequests(_)},ql(ri(I,{method:"POST"}),z))}queueRequest(a,u){this.queue.push(a),this.processRequests(u)}}const ye=new class extends Xl{constructor(c){super("appUserTurnstile"),this._customAccessToken=c}postTurnstileEvent(c,a){Ve.EVENTS_URL&&Ve.ACCESS_TOKEN&&Array.isArray(c)&&c.some(u=>Xa(u)||Bu(u))&&this.queueRequest(Date.now(),a)}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=Xd(Ve.ACCESS_TOKEN),u=a?a.u:Ve.ACCESS_TOKEN;let p=u!==this.eventData.tokenU;si(this.anonId)||(this.anonId=Us(),p=!0);const _=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),w=new Date(_),S=(_-this.eventData.lastSuccess)/864e5;p=p||S>=1||S<-1||b.getDate()!==w.getDate()}else p=!0;p?this.postEvent(_,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Je,skuId:jt,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=_,this.eventData.tokenU=u)},c):this.processRequests()}},Q=ye.postTurnstileEvent.bind(ye),ne=new class extends Xl{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(c,a,u,p){this.skuToken=a,this.errorCb=p,Ve.EVENTS_URL&&(u||Ve.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(zu)))}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),si(this.anonId)||(this.anonId=Us()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Je,skuId:jt,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):a&&(this.success[a]=!0)},c))}},ge=ne.postMapLoadEvent.bind(ne),Ie=new class extends Xl{constructor(){super("gljs.performance")}postPerformanceEvent(c,a){Ve.EVENTS_URL&&(c||Ve.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},c)}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:a,performanceData:u}=this.queue.shift(),p=function(_){const b=se.performance.getEntriesByType("resource"),w=se.performance.getEntriesByType("mark"),S=function(H){const K={};if(H)for(const Y in H)if("other"!==Y)for(const te of H[Y]){const ae=`${Y}ResolveRangeMin`,we=`${Y}ResolveRangeMax`,ke=`${Y}RequestCount`,me=`${Y}RequestCachedCount`;K[ae]=Math.min(K[ae]||1/0,te.startTime),K[we]=Math.max(K[we]||-1/0,te.responseEnd);const Se=Oe=>{void 0===K[Oe]&&(K[Oe]=0),++K[Oe]};void 0!==te.transferSize&&0===te.transferSize&&Se(me),Se(ke)}return K}(function(H,K){const Y={};if(H)for(const te of H){const ae=K(te);void 0===Y[ae]&&(Y[ae]=[]),Y[ae].push(te)}return Y}(b,nn)),I=se.devicePixelRatio,M=se.navigator.connection||se.navigator.mozConnection||se.navigator.webkitConnection,z={counters:[],metadata:[],attributes:[]},j=(H,K,Y)=>{null!=Y&&H.push({name:K,value:Y.toString()})};for(const H in S)j(z.counters,H,S[H]);if(_.interactionRange[0]!==1/0&&_.interactionRange[1]!==-1/0&&(j(z.counters,"interactionRangeMin",_.interactionRange[0]),j(z.counters,"interactionRangeMax",_.interactionRange[1])),w)for(const H of Object.keys(nt)){const K=nt[H],Y=w.find(te=>te.name===K);Y&&j(z.counters,K,Y.startTime)}return j(z.counters,"visibilityHidden",_.visibilityHidden),j(z.attributes,"style",function(H){if(H)for(const K of H){const Y=K.name.split("?")[0];if(Kd(Y)){const te=Y.split("/").slice(-2);if(2===te.length)return`mapbox://styles/${te[0]}/${te[1]}`}}}(b)),j(z.attributes,"terrainEnabled",_.terrainEnabled?"true":"false"),j(z.attributes,"fogEnabled",_.fogEnabled?"true":"false"),j(z.attributes,"projection",_.projection),j(z.attributes,"zoom",_.zoom),j(z.metadata,"devicePixelRatio",I),j(z.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),j(z.metadata,"navigatorUserAgent",se.navigator.userAgent),j(z.metadata,"screenWidth",se.screen.width),j(z.metadata,"screenHeight",se.screen.height),j(z.metadata,"windowWidth",se.innerWidth),j(z.metadata,"windowHeight",se.innerHeight),j(z.metadata,"mapWidth",_.width/I),j(z.metadata,"mapHeight",_.height/I),j(z.metadata,"webglRenderer",_.renderer),j(z.metadata,"webglVendor",_.vendor),j(z.metadata,"sdkVersion",Je),j(z.metadata,"sdkIdentifier","mapbox-gl-js"),z}(u);for(const _ of p.metadata);for(const _ of p.counters);for(const _ of p.attributes);this.postEvent(a,p,()=>{},c)}},Re=Ie.postPerformanceEvent.bind(Ie),qe=new class extends Xl{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(c,a,u,p){if(!Ve.API_URL||!Ve.SESSION_PATH)return;const _=Ds(Ve.API_URL+Ve.SESSION_PATH);_.params.push(`sku=${a||""}`),_.params.push(`access_token=${p||Ve.ACCESS_TOKEN||""}`);const b={url:Kl(_),headers:{"Content-Type":"text/plain"}};var S;this.pendingRequest=(S=w=>{this.pendingRequest=null,u(w),this.saveEventData(),this.processRequests(p)},ql(ri(b,{method:"GET"}),S))}getSessionAPI(c,a,u,p){this.skuToken=a,this.errorCb=p,Ve.SESSION_PATH&&Ve.API_URL&&(u||Ve.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(zu)))}processRequests(c){if(this.pendingRequest||0===this.queue.length)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||this.getSession(u,this.skuToken,p=>{p?this.errorCb(p):a&&(this.success[a]=!0)},c)}},We=qe.getSessionAPI.bind(qe),ze=new Set,nt={create:"create",load:"load",fullLoad:"fullLoad"},Ct={mark(c){se.performance.mark(c)},measure(c,a,u){se.performance.measure(c,a,u)}};function nn(c){const a=c.name.split("?")[0];return Vu(a)&&a.includes("mapbox-gl.js")?"javascript":Vu(a)&&a.includes("mapbox-gl.css")?"css":Ve.API_FONTS_REGEX.test(a)?"fontRange":Oc(a)?"sprite":Kd(a)?"style":Ve.API_TILEJSON_REGEX.test(a)?"tilejson":"other"}const Et=se.performance;function Mn(c){const a=c?c.url.toString():void 0;return Et.getEntriesByName(a)}let mn,An,$n,di;const Vi={now:()=>void 0!==$n?$n:se.performance.now(),setNow(c){$n=c},restoreNow(){$n=void 0},frame(c){const a=se.requestAnimationFrame(c);return{cancel:()=>se.cancelAnimationFrame(a)}},getImageData(c,a=0){const{width:u,height:p}=c;di||(di=se.document.createElement("canvas"));const _=di.getContext("2d",{willReadFrequently:!0});if(!_)throw new Error("failed to create canvas 2d context");return(u>di.width||p>di.height)&&(di.width=u,di.height=p),_.clearRect(-a,-a,u+2*a,p+2*a),_.drawImage(c,0,0,u,p),_.getImageData(-a,-a,u+2*a,p+2*a)},resolveURL:c=>(mn||(mn=se.document.createElement("a")),mn.href=c,mn.href),get devicePixelRatio(){return se.devicePixelRatio},get prefersReducedMotion(){return!!se.matchMedia&&(null==An&&(An=se.matchMedia("(prefers-reduced-motion: reduce)")),An.matches)}};function Rn(c,a,u){u[c]&&-1!==u[c].indexOf(a)||(u[c]=u[c]||[],u[c].push(a))}function qi(c,a,u){if(u&&u[c]){const p=u[c].indexOf(a);-1!==p&&u[c].splice(p,1)}}class go{constructor(a,u={}){ri(this,u),this.type=a}}class wl extends go{constructor(a,u={}){super("error",ri({error:a},u))}}class Ya{on(a,u){return this._listeners=this._listeners||{},Rn(a,u,this._listeners),this}off(a,u){return qi(a,u,this._listeners),qi(a,u,this._oneTimeListeners),this}once(a,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},Rn(a,u,this._oneTimeListeners),this):new Promise(p=>this.once(a,p))}fire(a,u){"string"==typeof a&&(a=new go(a,u||{}));const p=a.type;if(this.listens(p)){a.target=this;const _=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const S of _)S.call(this,a);const b=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const S of b)qi(p,S,this._oneTimeListeners),S.call(this,a);const w=this._eventedParent;w&&(ri(a,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),w.fire(a))}else a instanceof wl&&console.error(a.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,u){return this._eventedParent=a,this._eventedParentData=u,this}}var yt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Cl(c,...a){for(const u of a)for(const p in u)c[p]=u[p];return c}function Jo(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Yl(c){if(Array.isArray(c))return c.map(Yl);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const a={};for(const u in c)a[u]=Yl(c[u]);return a}return Jo(c)}class qf extends Error{constructor(a,u){super(u),this.message=u,this.key=a}}var Qa=qf;class Uu{constructor(a,u=[]){this.parent=a,this.bindings={};for(const[p,_]of u)this.bindings[p]=_}concat(a){return new Uu(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}var er=Uu;const Lc={kind:"null"},Zt={kind:"number"},wi={kind:"string"},En={kind:"boolean"},oa={kind:"color"},lo={kind:"object"},mi={kind:"value"},Yd={kind:"collator"},Ei={kind:"formatted"},qn={kind:"resolvedImage"};function Ur(c,a){return{kind:"array",itemType:c,N:a}}function _o(c){if("array"===c.kind){const a=_o(c.itemType);return"number"==typeof c.N?`array<${a}, ${c.N}>`:"value"===c.itemType.kind?"array":`array<${a}>`}return c.kind}const Wy=[Lc,Zt,wi,En,oa,Ei,lo,Ur(mi),qn];function jr(c,a){if("error"===a.kind)return null;if("array"===c.kind){if("array"===a.kind&&(0===a.N&&"value"===a.itemType.kind||!jr(c.itemType,a.itemType))&&("number"!=typeof c.N||c.N===a.N))return null}else{if(c.kind===a.kind)return null;if("value"===c.kind)for(const u of Wy)if(!jr(u,a))return null}return`Expected ${_o(c)} but found ${_o(a)} instead.`}function It(c,a){return a.some(u=>u.kind===c.kind)}function Ja(c,a){return a.some(u=>"null"===u?null===c:"array"===u?Array.isArray(c):"object"===u?c&&!Array.isArray(c)&&"object"==typeof c:u===typeof c)}var hi,to={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Qd(c){return(c=Math.round(c))<0?0:c>255?255:c}function ju(c){return Qd("%"===c[c.length-1]?parseFloat(c)/100*255:parseInt(c))}function Hu(c){return(a="%"===c[c.length-1]?parseFloat(c)/100:parseFloat(c))<0?0:a>1?1:a;var a}function $u(c,a,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?c+(a-c)*u*6:2*u<1?a:3*u<2?c+(a-c)*(2/3-u)*6:c}try{hi={}.parseCSSColor=function(c){var a,u=c.replace(/ /g,"").toLowerCase();if(u in to)return to[u].slice();if("#"===u[0])return 4===u.length?(a=parseInt(u.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:7===u.length&&(a=parseInt(u.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var p=u.indexOf("("),_=u.indexOf(")");if(-1!==p&&_+1===u.length){var b=u.substr(0,p),w=u.substr(p+1,_-(p+1)).split(","),S=1;switch(b){case"rgba":if(4!==w.length)return null;S=Hu(w.pop());case"rgb":return 3!==w.length?null:[ju(w[0]),ju(w[1]),ju(w[2]),S];case"hsla":if(4!==w.length)return null;S=Hu(w.pop());case"hsl":if(3!==w.length)return null;var I=(parseFloat(w[0])%360+360)%360/360,M=Hu(w[1]),z=Hu(w[2]),j=z<=.5?z*(M+1):z+M-z*M,H=2*z-j;return[Qd(255*$u(H,j,I+1/3)),Qd(255*$u(H,j,I)),Qd(255*$u(H,j,I-1/3)),S];default:return null}}return null}}catch{}class Lo{constructor(a,u,p,_=1){this.r=a,this.g=u,this.b=p,this.a=_}static parse(a){if(!a)return;if(a instanceof Lo)return a;if("string"!=typeof a)return;const u=hi(a);return u?new Lo(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[a,u,p,_]=this.toArray();return`rgba(${Math.round(a)},${Math.round(u)},${Math.round(p)},${_})`}toArray(){const{r:a,g:u,b:p,a:_}=this;return 0===_?[0,0,0,0]:[255*a/_,255*u/_,255*p/_,_]}toArray01(){const{r:a,g:u,b:p,a:_}=this;return 0===_?[0,0,0,0]:[a/_,u/_,p/_,_]}toArray01PremultipliedAlpha(){const{r:a,g:u,b:p,a:_}=this;return[a,u,p,_]}}Lo.black=new Lo(0,0,0,1),Lo.white=new Lo(1,1,1,1),Lo.transparent=new Lo(0,0,0,0),Lo.red=new Lo(1,0,0,1),Lo.blue=new Lo(0,0,1,1);var tr=Lo;class pp{constructor(a,u,p){this.sensitivity=a?u?"variant":"case":u?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,u){return this.collator.compare(a,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class fp{constructor(a,u,p,_,b){this.text=a.normalize?a.normalize():a,this.image=u,this.scale=p,this.fontStack=_,this.textColor=b}}class nr{constructor(a){this.sections=a}static fromString(a){return new nr([new fp(a,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(a=>0!==a.text.length||a.image&&0!==a.image.name.length)}static factory(a){return a instanceof nr?a:nr.fromString(a)}toString(){return 0===this.sections.length?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const u of this.sections){if(u.image){a.push(["image",u.image.name]);continue}a.push(u.text);const p={};u.fontStack&&(p["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(p["font-scale"]=u.scale),u.textColor&&(p["text-color"]=["rgba"].concat(u.textColor.toArray())),a.push(p)}return a}}class Ms{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Ms({name:a,available:!1}):null}serialize(){return["image",this.name]}}function qy(c,a,u,p){return"number"==typeof c&&c>=0&&c<=255&&"number"==typeof a&&a>=0&&a<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===p||"number"==typeof p&&p>=0&&p<=1?null:`Invalid rgba value [${[c,a,u,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof p?[c,a,u,p]:[c,a,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Zf(c){if(null===c||"string"==typeof c||"boolean"==typeof c||"number"==typeof c||c instanceof tr||c instanceof pp||c instanceof nr||c instanceof Ms)return!0;if(Array.isArray(c)){for(const a of c)if(!Zf(a))return!1;return!0}if("object"==typeof c){for(const a in c)if(!Zf(c[a]))return!1;return!0}return!1}function gr(c){if(null===c)return Lc;if("string"==typeof c)return wi;if("boolean"==typeof c)return En;if("number"==typeof c)return Zt;if(c instanceof tr)return oa;if(c instanceof pp)return Yd;if(c instanceof nr)return Ei;if(c instanceof Ms)return qn;if(Array.isArray(c)){const a=c.length;let u;for(const p of c){const _=gr(p);if(u){if(u===_)continue;u=mi;break}u=_}return Ur(u||mi,a)}return lo}function Jd(c){const a=typeof c;return null===c?"":"string"===a||"number"===a||"boolean"===a?String(c):c instanceof tr||c instanceof nr||c instanceof Ms?c.toString():JSON.stringify(c)}class $g{constructor(a,u){this.type=a,this.value=u}static parse(a,u){if(2!==a.length)return u.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Zf(a[1]))return u.error("invalid value");const p=a[1];let _=gr(p);const b=u.expectedType;return"array"!==_.kind||0!==_.N||!b||"array"!==b.kind||"number"==typeof b.N&&0!==b.N||(_=b),new $g(_,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof tr?["rgba"].concat(this.value.toArray()):this.value instanceof nr?this.value.serialize():this.value}}var eh=$g,rs=class{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}};const ms={string:wi,number:Zt,boolean:En,object:lo};class Zi{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");let p,_=1;const b=a[0];if("array"===b){let S,I;if(a.length>2){const M=a[1];if("string"!=typeof M||!(M in ms)||"object"===M)return u.error('The item type argument of "array" must be one of string, number, boolean',1);S=ms[M],_++}else S=mi;if(a.length>3){if(null!==a[2]&&("number"!=typeof a[2]||a[2]<0||a[2]!==Math.floor(a[2])))return u.error('The length argument to "array" must be a positive integer literal',2);I=a[2],_++}p=Ur(S,I)}else p=ms[b];const w=[];for(;_<a.length;_++){const S=u.parse(a[_],_,mi);if(!S)return null;w.push(S)}return new Zi(p,w)}evaluate(a){for(let u=0;u<this.args.length;u++){const p=this.args[u].evaluate(a);if(!jr(this.type,gr(p)))return p;if(u===this.args.length-1)throw new rs(`Expected value to be of type ${_o(this.type)}, but found ${_o(gr(p))} instead.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,u=[a.kind];if("array"===a.kind){const p=a.itemType;if("string"===p.kind||"number"===p.kind||"boolean"===p.kind){u.push(p.kind);const _=a.N;("number"==typeof _||this.args.length>1)&&u.push(_)}}return u.concat(this.args.map(p=>p.serialize()))}}var Ql=Zi;class mp{constructor(a){this.type=Ei,this.sections=a}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const p=a[1];if(!Array.isArray(p)&&"object"==typeof p)return u.error("First argument must be an image or text section.");const _=[];let b=!1;for(let w=1;w<=a.length-1;++w){const S=a[w];if(b&&"object"==typeof S&&!Array.isArray(S)){b=!1;let I=null;if(S["font-scale"]&&(I=u.parse(S["font-scale"],1,Zt),!I))return null;let M=null;if(S["text-font"]&&(M=u.parse(S["text-font"],1,Ur(wi)),!M))return null;let z=null;if(S["text-color"]&&(z=u.parse(S["text-color"],1,oa),!z))return null;const j=_[_.length-1];j.scale=I,j.font=M,j.textColor=z}else{const I=u.parse(a[w],1,mi);if(!I)return null;const M=I.type.kind;if("string"!==M&&"value"!==M&&"null"!==M&&"resolvedImage"!==M)return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,_.push({content:I,scale:null,font:null,textColor:null})}}return new mp(_)}evaluate(a){return new nr(this.sections.map(u=>{const p=u.content.evaluate(a);return gr(p)===qn?new fp("",p,null,null,null):new fp(Jd(p),null,u.scale?u.scale.evaluate(a):null,u.font?u.font.evaluate(a).join(","):null,u.textColor?u.textColor.evaluate(a):null)}))}eachChild(a){for(const u of this.sections)a(u.content),u.scale&&a(u.scale),u.font&&a(u.font),u.textColor&&a(u.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const u of this.sections){a.push(u.content.serialize());const p={};u.scale&&(p["font-scale"]=u.scale.serialize()),u.font&&(p["text-font"]=u.font.serialize()),u.textColor&&(p["text-color"]=u.textColor.serialize()),a.push(p)}return a}}class Kf{constructor(a){this.type=qn,this.input=a}static parse(a,u){if(2!==a.length)return u.error("Expected two arguments.");const p=u.parse(a[1],1,wi);return p?new Kf(p):u.error("No image name provided.")}evaluate(a){const u=this.input.evaluate(a),p=Ms.fromString(u);return p&&a.availableImages&&(p.available=a.availableImages.indexOf(u)>-1),p}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const tn={"to-boolean":En,"to-color":oa,"to-number":Zt,"to-string":wi};class Gg{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const p=a[0];if(("to-boolean"===p||"to-string"===p)&&2!==a.length)return u.error("Expected one argument.");const _=tn[p],b=[];for(let w=1;w<a.length;w++){const S=u.parse(a[w],w,mi);if(!S)return null;b.push(S)}return new Gg(_,b)}evaluate(a){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(a));if("color"===this.type.kind){let u,p;for(const _ of this.args){if(u=_.evaluate(a),p=null,u instanceof tr)return u;if("string"==typeof u){const b=a.parseColor(u);if(b)return b}else if(Array.isArray(u)&&(p=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:qy(u[0],u[1],u[2],u[3]),!p))return new tr(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new rs(p||`Could not parse color from value '${"string"==typeof u?u:String(JSON.stringify(u))}'`)}if("number"===this.type.kind){let u=null;for(const p of this.args){if(u=p.evaluate(a),null===u)return 0;const _=Number(u);if(!isNaN(_))return _}throw new rs(`Could not convert ${JSON.stringify(u)} to number.`)}return"formatted"===this.type.kind?nr.fromString(Jd(this.args[0].evaluate(a))):"resolvedImage"===this.type.kind?Ms.fromString(Jd(this.args[0].evaluate(a))):Jd(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if("formatted"===this.type.kind)return new mp([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Kf(this.args[0]).serialize();const a=[`to-${this.type.kind}`];return this.eachChild(u=>{a.push(u.serialize())}),a}}var yn=Gg;const th=["Unknown","Point","LineString","Polygon"];var nh=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?th[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:u,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*a-c[0])+this.featureDistanceData.bearing[1]*(p*a-c[1])}return 0}parseColor(c){let a=this._parseColorCache[c];return a||(a=this._parseColorCache[c]=tr.parse(c)),a}};class Rc{constructor(a,u,p,_){this.name=a,this.type=u,this._evaluate=p,this.args=_}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,u){const p=a[0],_=Rc.definitions[p];if(!_)return u.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(_)?_[0]:_.type,w=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,S=w.filter(([M])=>!Array.isArray(M)||M.length===a.length-1);let I=null;for(const[M,z]of S){I=new Jf(u.registry,u.path,null,u.scope);const j=[];let H=!1;for(let K=1;K<a.length;K++){const Y=a[K],te=Array.isArray(M)?M[K-1]:M.type,ae=I.parse(Y,1+j.length,te);if(!ae){H=!0;break}j.push(ae)}if(!H)if(Array.isArray(M)&&M.length!==j.length)I.error(`Expected ${M.length} arguments, but found ${j.length} instead.`);else{for(let K=0;K<j.length;K++){const Y=Array.isArray(M)?M[K]:M.type,te=j[K];I.concat(K+1).checkSubtype(Y,te.type)}if(0===I.errors.length)return new Rc(p,b,z,j)}}if(1===S.length)u.errors.push(...I.errors);else{const M=(S.length?S:w).map(([j])=>{return H=j,Array.isArray(H)?`(${H.map(_o).join(", ")})`:`(${_o(H.type)}...)`;var H}).join(" | "),z=[];for(let j=1;j<a.length;j++){const H=u.parse(a[j],1+z.length);if(!H)return null;z.push(_o(H.type))}u.error(`Expected arguments of type ${M}, but found (${z.join(", ")}) instead.`)}return null}static register(a,u){Rc.definitions=u;for(const p in u)a[p]=Rc}}var Jl=Rc;class gp{constructor(a,u,p){this.type=Yd,this.locale=p,this.caseSensitive=a,this.diacriticSensitive=u}static parse(a,u){if(2!==a.length)return u.error("Expected one argument.");const p=a[1];if("object"!=typeof p||Array.isArray(p))return u.error("Collator options argument must be an object.");const _=u.parse(void 0!==p["case-sensitive"]&&p["case-sensitive"],1,En);if(!_)return null;const b=u.parse(void 0!==p["diacritic-sensitive"]&&p["diacritic-sensitive"],1,En);if(!b)return null;let w=null;return p.locale&&(w=u.parse(p.locale,1,wi),!w)?null:new gp(_,b,w)}evaluate(a){return new pp(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}const Tl=8192;function gs(c,a){c[0]=Math.min(c[0],a[0]),c[1]=Math.min(c[1],a[1]),c[2]=Math.max(c[2],a[0]),c[3]=Math.max(c[3],a[1])}function Fc(c,a){return!(c[0]<=a[0]||c[2]>=a[2]||c[1]<=a[1]||c[3]>=a[3])}function Xf(c,a){const u=(180+c[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,_=Math.pow(2,a.z);return[Math.round(u*_*Tl),Math.round(p*_*Tl)]}function Wg(c,a,u){const p=c[0]-a[0],_=c[1]-a[1],b=c[0]-u[0],w=c[1]-u[1];return p*w-b*_==0&&p*b<=0&&_*w<=0}function Jn(c,a){let u=!1;for(let w=0,S=a.length;w<S;w++){const I=a[w];for(let M=0,z=I.length;M<z-1;M++){if(Wg(c,I[M],I[M+1]))return!1;(_=I[M])[1]>(p=c)[1]!=(b=I[M+1])[1]>p[1]&&p[0]<(b[0]-_[0])*(p[1]-_[1])/(b[1]-_[1])+_[0]&&(u=!u)}}var p,_,b;return u}function _p(c,a){for(let u=0;u<a.length;u++)if(Jn(c,a[u]))return!0;return!1}function Yf(c,a,u,p){const _=p[0]-u[0],b=p[1]-u[1],w=(c[0]-u[0])*b-_*(c[1]-u[1]),S=(a[0]-u[0])*b-_*(a[1]-u[1]);return w>0&&S<0||w<0&&S>0}function ks(c,a,u){for(const M of u)for(let z=0;z<M.length-1;++z)if((S=[(w=M[z+1])[0]-(b=M[z])[0],w[1]-b[1]])[0]*(I=[(_=a)[0]-(p=c)[0],_[1]-p[1]])[1]-S[1]*I[0]!=0&&Yf(p,_,b,w)&&Yf(b,w,p,_))return!0;var p,_,b,w,S,I;return!1}function Nc(c,a){for(let u=0;u<c.length;++u)if(!Jn(c[u],a))return!1;for(let u=0;u<c.length-1;++u)if(ks(c[u],c[u+1],a))return!1;return!0}function Zy(c,a){for(let u=0;u<a.length;u++)if(Nc(c,a[u]))return!0;return!1}function ko(c,a,u){const p=[];for(let _=0;_<c.length;_++){const b=[];for(let w=0;w<c[_].length;w++){const S=Xf(c[_][w],u);gs(a,S),b.push(S)}p.push(b)}return p}function Qf(c,a,u){const p=[];for(let _=0;_<c.length;_++){const b=ko(c[_],a,u);p.push(b)}return p}function qg(c,a,u,p){if(c[0]<u[0]||c[0]>u[2]){const _=.5*p;let b=c[0]-u[0]>_?-p:u[0]-c[0]>_?p:0;0===b&&(b=c[0]-u[2]>_?-p:u[2]-c[0]>_?p:0),c[0]+=b}gs(a,c)}function Gu(c,a,u,p){const _=Math.pow(2,p.z)*Tl,b=[p.x*Tl,p.y*Tl],w=[];if(!c)return w;for(const S of c)for(const I of S){const M=[I.x+b[0],I.y+b[1]];qg(M,a,u,_),w.push(M)}return w}function Fi(c,a,u,p){const _=Math.pow(2,p.z)*Tl,b=[p.x*Tl,p.y*Tl],w=[];if(!c)return w;for(const I of c){const M=[];for(const z of I){const j=[z.x+b[0],z.y+b[1]];gs(a,j),M.push(j)}w.push(M)}if(a[2]-a[0]<=_/2){(S=a)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const I of w)for(const M of I)qg(M,a,u,_)}var S;return w}class zc{constructor(a,u){this.type=En,this.geojson=a,this.geometries=u}static parse(a,u){if(2!==a.length)return u.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Zf(a[1])){const p=a[1];if("FeatureCollection"===p.type)for(let _=0;_<p.features.length;++_){const b=p.features[_].geometry.type;if("Polygon"===b||"MultiPolygon"===b)return new zc(p,p.features[_].geometry)}else if("Feature"===p.type){const _=p.geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new zc(p,p.geometry)}else if("Polygon"===p.type||"MultiPolygon"===p.type)return new zc(p,p)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(null!=a.geometry()&&null!=a.canonicalID()){if("Point"===a.geometryType())return function(u,p){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(!w)return!1;if("Polygon"===p.type){const S=ko(p.coordinates,b,w),I=Gu(u.geometry(),_,b,w);if(!Fc(_,b))return!1;for(const M of I)if(!Jn(M,S))return!1}if("MultiPolygon"===p.type){const S=Qf(p.coordinates,b,w),I=Gu(u.geometry(),_,b,w);if(!Fc(_,b))return!1;for(const M of I)if(!_p(M,S))return!1}return!0}(a,this.geometries);if("LineString"===a.geometryType())return function(u,p){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(!w)return!1;if("Polygon"===p.type){const S=ko(p.coordinates,b,w),I=Fi(u.geometry(),_,b,w);if(!Fc(_,b))return!1;for(const M of I)if(!Nc(M,S))return!1}if("MultiPolygon"===p.type){const S=Qf(p.coordinates,b,w),I=Fi(u.geometry(),_,b,w);if(!Fc(_,b))return!1;for(const M of I)if(!Zy(M,S))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Wu=zc;function ih(c){if(c instanceof Jl&&("get"===c.name&&1===c.args.length||"feature-state"===c.name||"has"===c.name&&1===c.args.length||"properties"===c.name||"geometry-type"===c.name||"id"===c.name||/^filter-/.test(c.name))||c instanceof Wu)return!1;let a=!0;return c.eachChild(u=>{a&&!ih(u)&&(a=!1)}),a}function oh(c){if(c instanceof Jl&&"feature-state"===c.name)return!1;let a=!0;return c.eachChild(u=>{a&&!oh(u)&&(a=!1)}),a}function yp(c,a){if(c instanceof Jl&&a.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(p=>{u&&!yp(p,a)&&(u=!1)}),u}class rh{constructor(a,u){this.type=u.type,this.name=a,this.boundExpression=u}static parse(a,u){if(2!==a.length||"string"!=typeof a[1])return u.error("'var' expression requires exactly one string literal argument.");const p=a[1];return u.scope.has(p)?new rh(p,u.scope.get(p)):u.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Bc=rh;class Sl{constructor(a,u=[],p,_=new er,b=[]){this.registry=a,this.path=u,this.key=u.map(w=>`[${w}]`).join(""),this.scope=_,this.errors=b,this.expectedType=p}parse(a,u,p,_,b={}){return u?this.concat(u,p,_)._parse(a,b):this._parse(a,b)}_parse(a,u){function p(_,b,w){return"assert"===w?new Ql(b,[_]):"coerce"===w?new yn(b,[_]):_}if(null!==a&&"string"!=typeof a&&"boolean"!=typeof a&&"number"!=typeof a||(a=["literal",a]),Array.isArray(a)){if(0===a.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=a[0];if("string"!=typeof _)return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[_];if(b){let w=b.parse(a,this);if(!w)return null;if(this.expectedType){const S=this.expectedType,I=w.type;if("string"!==S.kind&&"number"!==S.kind&&"boolean"!==S.kind&&"object"!==S.kind&&"array"!==S.kind||"value"!==I.kind)if("color"!==S.kind&&"formatted"!==S.kind&&"resolvedImage"!==S.kind||"value"!==I.kind&&"string"!==I.kind){if(this.checkSubtype(S,I))return null}else w=p(w,S,u.typeAnnotation||"coerce");else w=p(w,S,u.typeAnnotation||"assert")}if(!(w instanceof eh)&&"resolvedImage"!==w.type.kind&&Rt(w)){const S=new nh;try{w=new eh(w.type,w.evaluate(S))}catch(I){return this.error(I.message),null}}return w}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===a?"'undefined' value invalid. Use null instead.":"object"==typeof a?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,u,p){const _="number"==typeof a?this.path.concat(a):this.path,b=p?this.scope.concat(p):this.scope;return new Sl(this.registry,_,u||null,b,this.errors)}error(a,...u){const p=`${this.key}${u.map(_=>`[${_}]`).join("")}`;this.errors.push(new Qa(p,a))}checkSubtype(a,u){const p=jr(a,u);return p&&this.error(p),p}}var Jf=Sl;function Rt(c){if(c instanceof Bc)return Rt(c.boundExpression);if(c instanceof Jl&&"error"===c.name||c instanceof gp||c instanceof Wu)return!1;const a=c instanceof yn||c instanceof Ql;let u=!0;return c.eachChild(p=>{u=a?u&&Rt(p):u&&p instanceof eh}),!!u&&ih(c)&&yp(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ec(c,a){const u=c.length-1;let p,_,b=0,w=u,S=0;for(;b<=w;)if(S=Math.floor((b+w)/2),p=c[S],_=c[S+1],p<=a){if(S===u||a<_)return S;b=S+1}else{if(!(p>a))throw new rs("Input is not a number.");w=S-1}return 0}class ai{constructor(a,u,p){this.type=a,this.input=u,this.labels=[],this.outputs=[];for(const[_,b]of p)this.labels.push(_),this.outputs.push(b)}static parse(a,u){if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");const p=u.parse(a[1],1,Zt);if(!p)return null;const _=[];let b=null;u.expectedType&&"value"!==u.expectedType.kind&&(b=u.expectedType);for(let w=1;w<a.length;w+=2){const S=1===w?-1/0:a[w],I=a[w+1],M=w,z=w+1;if("number"!=typeof S)return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(_.length&&_[_.length-1][0]>=S)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const j=u.parse(I,z,b);if(!j)return null;b=b||j.type,_.push([S,j])}return new ai(b,p,_)}evaluate(a){const u=this.labels,p=this.outputs;if(1===u.length)return p[0].evaluate(a);const _=this.input.evaluate(a);if(_<=u[0])return p[0].evaluate(a);const b=u.length;return _>=u[b-1]?p[b-1].evaluate(a):p[ec(u,_)].evaluate(a)}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&a.push(this.labels[u]),a.push(this.outputs[u].serialize());return a}}var qu=ai;function ki(c,a,u){return c*(1-u)+a*u}var El=Object.freeze({__proto__:null,number:ki,color:function(c,a,u){return new tr(ki(c.r,a.r,u),ki(c.g,a.g,u),ki(c.b,a.b,u),ki(c.a,a.a,u))},array:function(c,a,u){return c.map((p,_)=>ki(p,a[_],u))}});const Zg=.95047,Kg=1.08883,em=4/29,el=6/29,ra=3*el*el,sa=Math.PI/180,Il=180/Math.PI;function Xi(c){return c>.008856451679035631?Math.pow(c,1/3):c/ra+em}function Zu(c){return c>el?c*c*c:ra*(c-em)}function Ku(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Xu(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function tm(c){const a=Xu(c.r),u=Xu(c.g),p=Xu(c.b),_=Xi((.4124564*a+.3575761*u+.1804375*p)/Zg),b=Xi((.2126729*a+.7151522*u+.072175*p)/1);return{l:116*b-16,a:500*(_-b),b:200*(b-Xi((.0193339*a+.119192*u+.9503041*p)/Kg)),alpha:c.a}}function tl(c){let a=(c.l+16)/116,u=isNaN(c.a)?a:a+c.a/500,p=isNaN(c.b)?a:a-c.b/200;return a=1*Zu(a),u=Zg*Zu(u),p=Kg*Zu(p),new tr(Ku(3.2404542*u-1.5371385*a-.4985314*p),Ku(-.969266*u+1.8760108*a+.041556*p),Ku(.0556434*u-.2040259*a+1.0572252*p),c.alpha)}function sh(c,a,u){const p=a-c;return c+u*(p>180||p<-180?p-360*Math.round(p/360):p)}const ah={forward:tm,reverse:tl,interpolate:function(c,a,u){return{l:ki(c.l,a.l,u),a:ki(c.a,a.a,u),b:ki(c.b,a.b,u),alpha:ki(c.alpha,a.alpha,u)}}},Qt={forward:function(c){const{l:a,a:u,b:p}=tm(c),_=Math.atan2(p,u)*Il;return{h:_<0?_+360:_,c:Math.sqrt(u*u+p*p),l:a,alpha:c.a}},reverse:function(c){const a=c.h*sa,u=c.c;return tl({l:c.l,a:Math.cos(a)*u,b:Math.sin(a)*u,alpha:c.alpha})},interpolate:function(c,a,u){return{h:sh(c.h,a.h,u),c:ki(c.c,a.c,u),l:ki(c.l,a.l,u),alpha:ki(c.alpha,a.alpha,u)}}};var vp=Object.freeze({__proto__:null,lab:ah,hcl:Qt});class Yu{constructor(a,u,p,_,b){this.type=a,this.operator=u,this.interpolation=p,this.input=_,this.labels=[],this.outputs=[];for(const[w,S]of b)this.labels.push(w),this.outputs.push(S)}static interpolationFactor(a,u,p,_){let b=0;if("exponential"===a.name)b=bp(u,a.base,p,_);else if("linear"===a.name)b=bp(u,1,p,_);else if("cubic-bezier"===a.name){const w=a.controlPoints;b=new Me(w[0],w[1],w[2],w[3]).solve(bp(u,1,p,_))}return b}static parse(a,u){let[p,_,b,...w]=a;if(!Array.isArray(_)||0===_.length)return u.error("Expected an interpolation type expression.",1);if("linear"===_[0])_={name:"linear"};else if("exponential"===_[0]){const M=_[1];if("number"!=typeof M)return u.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:M}}else{if("cubic-bezier"!==_[0])return u.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const M=_.slice(1);if(4!==M.length||M.some(z=>"number"!=typeof z||z<0||z>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:M}}}if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(b=u.parse(b,2,Zt),!b)return null;const S=[];let I=null;"interpolate-hcl"===p||"interpolate-lab"===p?I=oa:u.expectedType&&"value"!==u.expectedType.kind&&(I=u.expectedType);for(let M=0;M<w.length;M+=2){const z=w[M],j=w[M+1],H=M+3,K=M+4;if("number"!=typeof z)return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(S.length&&S[S.length-1][0]>=z)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const Y=u.parse(j,K,I);if(!Y)return null;I=I||Y.type,S.push([z,Y])}return"number"===I.kind||"color"===I.kind||"array"===I.kind&&"number"===I.itemType.kind&&"number"==typeof I.N?new Yu(I,p,_,b,S):u.error(`Type ${_o(I)} is not interpolatable.`)}evaluate(a){const u=this.labels,p=this.outputs;if(1===u.length)return p[0].evaluate(a);const _=this.input.evaluate(a);if(_<=u[0])return p[0].evaluate(a);const b=u.length;if(_>=u[b-1])return p[b-1].evaluate(a);const w=ec(u,_),S=Yu.interpolationFactor(this.interpolation,_,u[w],u[w+1]),I=p[w].evaluate(a),M=p[w+1].evaluate(a);return"interpolate"===this.operator?El[this.type.kind.toLowerCase()](I,M,S):"interpolate-hcl"===this.operator?Qt.reverse(Qt.interpolate(Qt.forward(I),Qt.forward(M),S)):ah.reverse(ah.interpolate(ah.forward(I),ah.forward(M),S))}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,a,this.input.serialize()];for(let p=0;p<this.labels.length;p++)u.push(this.labels[p],this.outputs[p].serialize());return u}}function bp(c,a,u,p){const _=p-u,b=c-u;return 0===_?0:1===a?b/_:(Math.pow(a,b)-1)/(Math.pow(a,_)-1)}var pn=Yu;class nm{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expectected at least one argument.");let p=null;const _=u.expectedType;_&&"value"!==_.kind&&(p=_);const b=[];for(const S of a.slice(1)){const I=u.parse(S,1+b.length,p,void 0,{typeAnnotation:"omit"});if(!I)return null;p=p||I.type,b.push(I)}const w=_&&b.some(S=>jr(_,S.type));return new nm(w?mi:p,b)}evaluate(a){let u,p=null,_=0;for(const b of this.args){if(_++,p=b.evaluate(a),p&&p instanceof Ms&&!p.available&&(u||(u=p),p=null,_===this.args.length))return u;if(null!==p)break}return p}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var im=nm;class On{constructor(a,u){this.type=u.type,this.bindings=[].concat(a),this.result=u}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const u of this.bindings)a(u[1]);a(this.result)}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const p=[];for(let b=1;b<a.length-1;b+=2){const w=a[b];if("string"!=typeof w)return u.error(`Expected string, but found ${typeof w} instead.`,b);if(/[^a-zA-Z0-9_]/.test(w))return u.error("Variable names must contain only alphanumeric characters or '_'.",b);const S=u.parse(a[b+1],b+1);if(!S)return null;p.push([w,S])}const _=u.parse(a[a.length-1],a.length-1,u.expectedType,p);return _?new On(p,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[u,p]of this.bindings)a.push(u,p.serialize());return a.push(this.result.serialize()),a}}var Hr=On;class no{constructor(a,u,p){this.type=a,this.index=u,this.input=p}static parse(a,u){if(3!==a.length)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=u.parse(a[1],1,Zt),_=u.parse(a[2],2,Ur(u.expectedType||mi));return p&&_?new no(_.type.itemType,p,_):null}evaluate(a){const u=this.index.evaluate(a),p=this.input.evaluate(a);if(u<0)throw new rs(`Array index out of bounds: ${u} < 0.`);if(u>=p.length)throw new rs(`Array index out of bounds: ${u} > ${p.length-1}.`);if(u!==Math.floor(u))throw new rs(`Array index must be an integer, but found ${u} instead.`);return p[u]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ss=no;class $r{constructor(a,u){this.type=En,this.needle=a,this.haystack=u}static parse(a,u){if(3!==a.length)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=u.parse(a[1],1,mi),_=u.parse(a[2],2,mi);return p&&_?It(p.type,[En,wi,Zt,Lc,mi])?new $r(p,_):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${_o(p.type)} instead`):null}evaluate(a){const u=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(null==p)return!1;if(!Ja(u,["boolean","string","number","null"]))throw new rs(`Expected first argument to be of type boolean, string, number or null, but found ${_o(gr(u))} instead.`);if(!Ja(p,["string","array"]))throw new rs(`Expected second argument to be of type array or string, but found ${_o(gr(p))} instead.`);return p.indexOf(u)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Vc=$r;class Gr{constructor(a,u,p){this.type=Zt,this.needle=a,this.haystack=u,this.fromIndex=p}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=u.parse(a[1],1,mi),_=u.parse(a[2],2,mi);if(!p||!_)return null;if(!It(p.type,[En,wi,Zt,Lc,mi]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${_o(p.type)} instead`);if(4===a.length){const b=u.parse(a[3],3,Zt);return b?new Gr(p,_,b):null}return new Gr(p,_)}evaluate(a){const u=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!Ja(u,["boolean","string","number","null"]))throw new rs(`Expected first argument to be of type boolean, string, number or null, but found ${_o(gr(u))} instead.`);if(!Ja(p,["string","array"]))throw new rs(`Expected second argument to be of type array or string, but found ${_o(gr(p))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(a);return p.indexOf(u,_)}return p.indexOf(u)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var nl=Gr;class Tn{constructor(a,u,p,_,b,w){this.inputType=a,this.type=u,this.input=p,this.cases=_,this.outputs=b,this.otherwise=w}static parse(a,u){if(a.length<5)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return u.error("Expected an even number of arguments.");let p,_;u.expectedType&&"value"!==u.expectedType.kind&&(_=u.expectedType);const b={},w=[];for(let M=2;M<a.length-1;M+=2){let z=a[M];const j=a[M+1];Array.isArray(z)||(z=[z]);const H=u.concat(M);if(0===z.length)return H.error("Expected at least one branch label.");for(const Y of z){if("number"!=typeof Y&&"string"!=typeof Y)return H.error("Branch labels must be numbers or strings.");if("number"==typeof Y&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Y&&Math.floor(Y)!==Y)return H.error("Numeric branch labels must be integer values.");if(p){if(H.checkSubtype(p,gr(Y)))return null}else p=gr(Y);if(void 0!==b[String(Y)])return H.error("Branch labels must be unique.");b[String(Y)]=w.length}const K=u.parse(j,M,_);if(!K)return null;_=_||K.type,w.push(K)}const S=u.parse(a[1],1,mi);if(!S)return null;const I=u.parse(a[a.length-1],a.length-1,_);return I?"value"!==S.type.kind&&u.concat(1).checkSubtype(p,S.type)?null:new Tn(p,_,S,b,w,I):null}evaluate(a){const u=this.input.evaluate(a);return(gr(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),p=[],_={};for(const w of u){const S=_[this.cases[w]];void 0===S?(_[this.cases[w]]=p.length,p.push([this.cases[w],[w]])):p[S][1].push(w)}const b=w=>"number"===this.inputType.kind?Number(w):w;for(const[w,S]of p)a.push(1===S.length?b(S[0]):S.map(b)),a.push(this.outputs[w].serialize());return a.push(this.otherwise.serialize()),a}}var Di=Tn;class jo{constructor(a,u,p){this.type=a,this.branches=u,this.otherwise=p}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return u.error("Expected an odd number of arguments.");let p;u.expectedType&&"value"!==u.expectedType.kind&&(p=u.expectedType);const _=[];for(let w=1;w<a.length-1;w+=2){const S=u.parse(a[w],w,En);if(!S)return null;const I=u.parse(a[w+1],w+1,p);if(!I)return null;_.push([S,I]),p=p||I.type}const b=u.parse(a[a.length-1],a.length-1,p);return b?new jo(p,_,b):null}evaluate(a){for(const[u,p]of this.branches)if(u.evaluate(a))return p.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[u,p]of this.branches)a(u),a(p);a(this.otherwise)}outputDefined(){return this.branches.every(([a,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var Ea=jo;class Hs{constructor(a,u,p,_){this.type=a,this.input=u,this.beginIndex=p,this.endIndex=_}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=u.parse(a[1],1,mi),_=u.parse(a[2],2,Zt);if(!p||!_)return null;if(!It(p.type,[Ur(mi),wi,mi]))return u.error(`Expected first argument to be of type array or string, but found ${_o(p.type)} instead`);if(4===a.length){const b=u.parse(a[3],3,Zt);return b?new Hs(p.type,p,_,b):null}return new Hs(p.type,p,_)}evaluate(a){const u=this.input.evaluate(a),p=this.beginIndex.evaluate(a);if(!Ja(u,["string","array"]))throw new rs(`Expected first argument to be of type array or string, but found ${_o(gr(u))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(a);return u.slice(p,_)}return u.slice(p)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Wr=Hs;function tc(c,a){return"=="===c||"!="===c?"boolean"===a.kind||"string"===a.kind||"number"===a.kind||"null"===a.kind||"value"===a.kind:"string"===a.kind||"number"===a.kind||"value"===a.kind}function Xo(c,a,u,p){return 0===p.compare(a,u)}function Dl(c,a,u){const p="=="!==c&&"!="!==c;return class y4{constructor(b,w,S){this.type=En,this.lhs=b,this.rhs=w,this.collator=S,this.hasUntypedArgument="value"===b.type.kind||"value"===w.type.kind}static parse(b,w){if(3!==b.length&&4!==b.length)return w.error("Expected two or three arguments.");const S=b[0];let I=w.parse(b[1],1,mi);if(!I)return null;if(!tc(S,I.type))return w.concat(1).error(`"${S}" comparisons are not supported for type '${_o(I.type)}'.`);let M=w.parse(b[2],2,mi);if(!M)return null;if(!tc(S,M.type))return w.concat(2).error(`"${S}" comparisons are not supported for type '${_o(M.type)}'.`);if(I.type.kind!==M.type.kind&&"value"!==I.type.kind&&"value"!==M.type.kind)return w.error(`Cannot compare types '${_o(I.type)}' and '${_o(M.type)}'.`);p&&("value"===I.type.kind&&"value"!==M.type.kind?I=new Ql(M.type,[I]):"value"!==I.type.kind&&"value"===M.type.kind&&(M=new Ql(I.type,[M])));let z=null;if(4===b.length){if("string"!==I.type.kind&&"string"!==M.type.kind&&"value"!==I.type.kind&&"value"!==M.type.kind)return w.error("Cannot use collator to compare non-string types.");if(z=w.parse(b[3],3,Yd),!z)return null}return new y4(I,M,z)}evaluate(b){const w=this.lhs.evaluate(b),S=this.rhs.evaluate(b);if(p&&this.hasUntypedArgument){const I=gr(w),M=gr(S);if(I.kind!==M.kind||"string"!==I.kind&&"number"!==I.kind)throw new rs(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${I.kind}, ${M.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const I=gr(w),M=gr(S);if("string"!==I.kind||"string"!==M.kind)return a(b,w,S)}return this.collator?u(b,w,S,this.collator.evaluate(b)):a(b,w,S)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[c];return this.eachChild(w=>{b.push(w.serialize())}),b}}}const xp=Dl("==",function(c,a,u){return a===u},Xo),Mi=Dl("!=",function(c,a,u){return a!==u},function(c,a,u,p){return!Xo(0,a,u,p)}),wp=Dl("<",function(c,a,u){return a<u},function(c,a,u,p){return p.compare(a,u)<0}),Qu=Dl(">",function(c,a,u){return a>u},function(c,a,u,p){return p.compare(a,u)>0}),Cp=Dl("<=",function(c,a,u){return a<=u},function(c,a,u,p){return p.compare(a,u)<=0}),Ju=Dl(">=",function(c,a,u){return a>=u},function(c,a,u,p){return p.compare(a,u)>=0});class kr{constructor(a,u,p,_,b,w){this.type=wi,this.number=a,this.locale=u,this.currency=p,this.unit=_,this.minFractionDigits=b,this.maxFractionDigits=w}static parse(a,u){if(3!==a.length)return u.error("Expected two arguments.");const p=u.parse(a[1],1,Zt);if(!p)return null;const _=a[2];if("object"!=typeof _||Array.isArray(_))return u.error("NumberFormat options argument must be an object.");let b=null;if(_.locale&&(b=u.parse(_.locale,1,wi),!b))return null;let w=null;if(_.currency&&(w=u.parse(_.currency,1,wi),!w))return null;let S=null;if(_.unit&&(S=u.parse(_.unit,1,wi),!S))return null;let I=null;if(_["min-fraction-digits"]&&(I=u.parse(_["min-fraction-digits"],1,Zt),!I))return null;let M=null;return _["max-fraction-digits"]&&(M=u.parse(_["max-fraction-digits"],1,Zt),!M)?null:new kr(p,b,w,S,I,M)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(a):void 0,unit:this.unit?this.unit.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.unit&&a(this.unit),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.unit&&(a.unit=this.unit.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class Uc{constructor(a){this.type=Zt,this.input=a}static parse(a,u){if(2!==a.length)return u.error(`Expected 1 argument, but found ${a.length-1} instead.`);const p=u.parse(a[1],1);return p?"array"!==p.type.kind&&"string"!==p.type.kind&&"value"!==p.type.kind?u.error(`Expected argument of type string or array, but found ${_o(p.type)} instead.`):new Uc(p):null}evaluate(a){const u=this.input.evaluate(a);if("string"==typeof u||Array.isArray(u))return u.length;throw new rs(`Expected value to be of type string or array, but found ${_o(gr(u))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(u=>{a.push(u.serialize())}),a}}const jc={"==":xp,"!=":Mi,">":Qu,"<":wp,">=":Ju,"<=":Cp,array:Ql,at:ss,boolean:Ql,case:Ea,coalesce:im,collator:gp,format:mp,image:Kf,in:Vc,"index-of":nl,interpolate:pn,"interpolate-hcl":pn,"interpolate-lab":pn,length:Uc,let:Hr,literal:eh,match:Di,number:Ql,"number-format":kr,object:Ql,slice:Wr,step:qu,string:Ql,"to-boolean":yn,"to-color":yn,"to-number":yn,"to-string":yn,var:Bc,within:Wu};function Ia(c,[a,u,p,_]){a=a.evaluate(c),u=u.evaluate(c),p=p.evaluate(c);const b=_?_.evaluate(c):1,w=qy(a,u,p,b);if(w)throw new rs(w);return new tr(a/255*b,u/255*b,p/255*b,b)}function ed(c,a){return c in a}function Tp(c,a){const u=a[c];return void 0===u?null:u}function co(c){return{type:c}}Jl.register(jc,{error:[{kind:"error"},[wi],(c,[a])=>{throw new rs(a.evaluate(c))}],typeof:[wi,[mi],(c,[a])=>_o(gr(a.evaluate(c)))],"to-rgba":[Ur(Zt,4),[oa],(c,[a])=>a.evaluate(c).toArray()],rgb:[oa,[Zt,Zt,Zt],Ia],rgba:[oa,[Zt,Zt,Zt,Zt],Ia],has:{type:En,overloads:[[[wi],(c,[a])=>ed(a.evaluate(c),c.properties())],[[wi,lo],(c,[a,u])=>ed(a.evaluate(c),u.evaluate(c))]]},get:{type:mi,overloads:[[[wi],(c,[a])=>Tp(a.evaluate(c),c.properties())],[[wi,lo],(c,[a,u])=>Tp(a.evaluate(c),u.evaluate(c))]]},"feature-state":[mi,[wi],(c,[a])=>Tp(a.evaluate(c),c.featureState||{})],properties:[lo,[],c=>c.properties()],"geometry-type":[wi,[],c=>c.geometryType()],id:[mi,[],c=>c.id()],zoom:[Zt,[],c=>c.globals.zoom],pitch:[Zt,[],c=>c.globals.pitch||0],"distance-from-center":[Zt,[],c=>c.distanceFromCenter()],"heatmap-density":[Zt,[],c=>c.globals.heatmapDensity||0],"line-progress":[Zt,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[Zt,[],c=>c.globals.skyRadialProgress||0],accumulated:[mi,[],c=>void 0===c.globals.accumulated?null:c.globals.accumulated],"+":[Zt,co(Zt),(c,a)=>{let u=0;for(const p of a)u+=p.evaluate(c);return u}],"*":[Zt,co(Zt),(c,a)=>{let u=1;for(const p of a)u*=p.evaluate(c);return u}],"-":{type:Zt,overloads:[[[Zt,Zt],(c,[a,u])=>a.evaluate(c)-u.evaluate(c)],[[Zt],(c,[a])=>-a.evaluate(c)]]},"/":[Zt,[Zt,Zt],(c,[a,u])=>a.evaluate(c)/u.evaluate(c)],"%":[Zt,[Zt,Zt],(c,[a,u])=>a.evaluate(c)%u.evaluate(c)],ln2:[Zt,[],()=>Math.LN2],pi:[Zt,[],()=>Math.PI],e:[Zt,[],()=>Math.E],"^":[Zt,[Zt,Zt],(c,[a,u])=>Math.pow(a.evaluate(c),u.evaluate(c))],sqrt:[Zt,[Zt],(c,[a])=>Math.sqrt(a.evaluate(c))],log10:[Zt,[Zt],(c,[a])=>Math.log(a.evaluate(c))/Math.LN10],ln:[Zt,[Zt],(c,[a])=>Math.log(a.evaluate(c))],log2:[Zt,[Zt],(c,[a])=>Math.log(a.evaluate(c))/Math.LN2],sin:[Zt,[Zt],(c,[a])=>Math.sin(a.evaluate(c))],cos:[Zt,[Zt],(c,[a])=>Math.cos(a.evaluate(c))],tan:[Zt,[Zt],(c,[a])=>Math.tan(a.evaluate(c))],asin:[Zt,[Zt],(c,[a])=>Math.asin(a.evaluate(c))],acos:[Zt,[Zt],(c,[a])=>Math.acos(a.evaluate(c))],atan:[Zt,[Zt],(c,[a])=>Math.atan(a.evaluate(c))],min:[Zt,co(Zt),(c,a)=>Math.min(...a.map(u=>u.evaluate(c)))],max:[Zt,co(Zt),(c,a)=>Math.max(...a.map(u=>u.evaluate(c)))],abs:[Zt,[Zt],(c,[a])=>Math.abs(a.evaluate(c))],round:[Zt,[Zt],(c,[a])=>{const u=a.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[Zt,[Zt],(c,[a])=>Math.floor(a.evaluate(c))],ceil:[Zt,[Zt],(c,[a])=>Math.ceil(a.evaluate(c))],"filter-==":[En,[wi,mi],(c,[a,u])=>c.properties()[a.value]===u.value],"filter-id-==":[En,[mi],(c,[a])=>c.id()===a.value],"filter-type-==":[En,[wi],(c,[a])=>c.geometryType()===a.value],"filter-<":[En,[wi,mi],(c,[a,u])=>{const p=c.properties()[a.value],_=u.value;return typeof p==typeof _&&p<_}],"filter-id-<":[En,[mi],(c,[a])=>{const u=c.id(),p=a.value;return typeof u==typeof p&&u<p}],"filter->":[En,[wi,mi],(c,[a,u])=>{const p=c.properties()[a.value],_=u.value;return typeof p==typeof _&&p>_}],"filter-id->":[En,[mi],(c,[a])=>{const u=c.id(),p=a.value;return typeof u==typeof p&&u>p}],"filter-<=":[En,[wi,mi],(c,[a,u])=>{const p=c.properties()[a.value],_=u.value;return typeof p==typeof _&&p<=_}],"filter-id-<=":[En,[mi],(c,[a])=>{const u=c.id(),p=a.value;return typeof u==typeof p&&u<=p}],"filter->=":[En,[wi,mi],(c,[a,u])=>{const p=c.properties()[a.value],_=u.value;return typeof p==typeof _&&p>=_}],"filter-id->=":[En,[mi],(c,[a])=>{const u=c.id(),p=a.value;return typeof u==typeof p&&u>=p}],"filter-has":[En,[mi],(c,[a])=>a.value in c.properties()],"filter-has-id":[En,[],c=>null!==c.id()&&void 0!==c.id()],"filter-type-in":[En,[Ur(wi)],(c,[a])=>a.value.indexOf(c.geometryType())>=0],"filter-id-in":[En,[Ur(mi)],(c,[a])=>a.value.indexOf(c.id())>=0],"filter-in-small":[En,[wi,Ur(mi)],(c,[a,u])=>u.value.indexOf(c.properties()[a.value])>=0],"filter-in-large":[En,[wi,Ur(mi)],(c,[a,u])=>function(p,_,b,w){for(;b<=w;){const S=b+w>>1;if(_[S]===p)return!0;_[S]>p?w=S-1:b=S+1}return!1}(c.properties()[a.value],u.value,0,u.value.length-1)],all:{type:En,overloads:[[[En,En],(c,[a,u])=>a.evaluate(c)&&u.evaluate(c)],[co(En),(c,a)=>{for(const u of a)if(!u.evaluate(c))return!1;return!0}]]},any:{type:En,overloads:[[[En,En],(c,[a,u])=>a.evaluate(c)||u.evaluate(c)],[co(En),(c,a)=>{for(const u of a)if(u.evaluate(c))return!0;return!1}]]},"!":[En,[En],(c,[a])=>!a.evaluate(c)],"is-supported-script":[En,[wi],(c,[a])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(a.evaluate(c))}],upcase:[wi,[wi],(c,[a])=>a.evaluate(c).toUpperCase()],downcase:[wi,[wi],(c,[a])=>a.evaluate(c).toLowerCase()],concat:[wi,co(mi),(c,a)=>a.map(u=>Jd(u.evaluate(c))).join("")],"resolved-locale":[wi,[Yd],(c,[a])=>a.evaluate(c).resolvedLocale()]});var lh=jc;function Hc(c){return{result:"success",value:c}}function $c(c){return{result:"error",value:c}}function Ml(c){return"data-driven"===c["property-type"]}function aa(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function kl(c){return!!c.expression&&c.expression.interpolated}function ei(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":null===c?"null":typeof c}function om(c){return"object"==typeof c&&null!==c&&!Array.isArray(c)}function $s(c){return c}function Gs(c,a){const u="color"===a.type,p=c.stops&&"object"==typeof c.stops[0][0],_=p||!(p||void 0!==c.property),b=c.type||(kl(a)?"exponential":"interval");if(u&&((c=Cl({},c)).stops&&(c.stops=c.stops.map(M=>[M[0],tr.parse(M[1])])),c.default=tr.parse(c.default?c.default:a.default)),c.colorSpace&&"rgb"!==c.colorSpace&&!vp[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let w,S,I;if("exponential"===b)w=As;else if("interval"===b)w=ch;else if("categorical"===b){w=Wc,S=Object.create(null);for(const M of c.stops)S[M[0]]=M[1];I=typeof c.stops[0][0]}else{if("identity"!==b)throw new Error(`Unknown function type "${b}"`);w=Xg}if(p){const M={},z=[];for(let K=0;K<c.stops.length;K++){const Y=c.stops[K],te=Y[0].zoom;void 0===M[te]&&(M[te]={zoom:te,type:c.type,property:c.property,default:c.default,stops:[]},z.push(te)),M[te].stops.push([Y[0].value,Y[1]])}const j=[];for(const K of z)j.push([M[K].zoom,Gs(M[K],a)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:pn.interpolationFactor.bind(void 0,H),zoomStops:j.map(K=>K[0]),evaluate:({zoom:K},Y)=>As({stops:j,base:c.base},a,K).evaluate(K,Y)}}if(_){const M="exponential"===b?{name:"exponential",base:void 0!==c.base?c.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:pn.interpolationFactor.bind(void 0,M),zoomStops:c.stops.map(z=>z[0]),evaluate:({zoom:z})=>w(c,a,z,S,I)}}return{kind:"source",evaluate(M,z){const j=z&&z.properties?z.properties[c.property]:void 0;return void 0===j?Gc(c.default,a.default):w(c,a,j,S,I)}}}function Gc(c,a,u){return void 0!==c?c:void 0!==a?a:void 0!==u?u:void 0}function Wc(c,a,u,p,_){return Gc(typeof u===_?p[u]:void 0,c.default,a.default)}function ch(c,a,u){if("number"!==ei(u))return Gc(c.default,a.default);const p=c.stops.length;if(1===p||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[p-1][0])return c.stops[p-1][1];const _=ec(c.stops.map(b=>b[0]),u);return c.stops[_][1]}function As(c,a,u){const p=void 0!==c.base?c.base:1;if("number"!==ei(u))return Gc(c.default,a.default);const _=c.stops.length;if(1===_||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[_-1][0])return c.stops[_-1][1];const b=ec(c.stops.map(z=>z[0]),u),w=function(z,j,H,K){const Y=K-H,te=z-H;return 0===Y?0:1===j?te/Y:(Math.pow(j,te)-1)/(Math.pow(j,Y)-1)}(u,p,c.stops[b][0],c.stops[b+1][0]),S=c.stops[b][1],I=c.stops[b+1][1];let M=El[a.type]||$s;if(c.colorSpace&&"rgb"!==c.colorSpace){const z=vp[c.colorSpace];M=(j,H)=>z.reverse(z.interpolate(z.forward(j),z.forward(H),w))}return"function"==typeof S.evaluate?{evaluate(...z){const j=S.evaluate.apply(void 0,z),H=I.evaluate.apply(void 0,z);if(void 0!==j&&void 0!==H)return M(j,H,w)}}:M(S,I,w)}function Xg(c,a,u){return"color"===a.type?u=tr.parse(u):"formatted"===a.type?u=nr.fromString(u.toString()):"resolvedImage"===a.type?u=Ms.fromString(u.toString()):ei(u)===a.type||"enum"===a.type&&a.values[u]||(u=void 0),Gc(u,c.default,a.default)}class rm{constructor(a,u){var p;this.expression=a,this._warningHistory={},this._evaluator=new nh,this._defaultValue=u?"color"===(p=u).type&&(om(p.default)||Array.isArray(p.default))?new tr(0,0,0,0):"color"===p.type?tr.parse(p.default)||null:void 0===p.default?null:p.default:null,this._enumValues=u&&"enum"===u.type?u.values:null}evaluateWithoutErrorHandling(a,u,p,_,b,w,S,I){return this._evaluator.globals=a,this._evaluator.feature=u,this._evaluator.featureState=p,this._evaluator.canonical=_||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=I||null,this.expression.evaluate(this._evaluator)}evaluate(a,u,p,_,b,w,S,I){this._evaluator.globals=a,this._evaluator.feature=u||null,this._evaluator.featureState=p||null,this._evaluator.canonical=_||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=I||null;try{const M=this.expression.evaluate(this._evaluator);if(null==M||"number"==typeof M&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new rs(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function td(c){return Array.isArray(c)&&c.length>0&&"string"==typeof c[0]&&c[0]in lh}function nd(c,a){const u=new Jf(lh,[],a?function(_){const b={color:oa,string:wi,number:Zt,enum:wi,boolean:En,formatted:Ei,resolvedImage:qn};return"array"===_.type?Ur(b[_.value]||mi,_.length):b[_.type]}(a):void 0),p=u.parse(c,void 0,void 0,void 0,a&&"string"===a.type?{typeAnnotation:"coerce"}:void 0);return p?Hc(new rm(p,a)):$c(u.errors)}class sm{constructor(a,u){this.kind=a,this._styleExpression=u,this.isStateDependent="constant"!==a&&!oh(u.expression)}evaluateWithoutErrorHandling(a,u,p,_,b,w){return this._styleExpression.evaluateWithoutErrorHandling(a,u,p,_,b,w)}evaluate(a,u,p,_,b,w){return this._styleExpression.evaluate(a,u,p,_,b,w)}}class id{constructor(a,u,p,_){this.kind=a,this.zoomStops=p,this._styleExpression=u,this.isStateDependent="camera"!==a&&!oh(u.expression),this.interpolationType=_}evaluateWithoutErrorHandling(a,u,p,_,b,w){return this._styleExpression.evaluateWithoutErrorHandling(a,u,p,_,b,w)}evaluate(a,u,p,_,b,w){return this._styleExpression.evaluate(a,u,p,_,b,w)}interpolationFactor(a,u,p){return this.interpolationType?pn.interpolationFactor(this.interpolationType,a,u,p):0}}function od(c,a){if("error"===(c=nd(c,a)).result)return c;const u=c.value.expression,p=ih(u);if(!p&&!Ml(a))return $c([new Qa("","data expressions not supported")]);const _=yp(u,["zoom","pitch","distance-from-center"]);if(!_&&!aa(a))return $c([new Qa("","zoom expressions not supported")]);const b=Ep(u);return b||_?b instanceof Qa?$c([b]):b instanceof pn&&!kl(a)?$c([new Qa("",'"interpolate" expressions cannot be used with this property')]):Hc(b?new id(p?"camera":"composite",c.value,b.labels,b instanceof pn?b.interpolation:void 0):new sm(p?"constant":"source",c.value)):$c([new Qa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Sp{constructor(a,u){this._parameters=a,this._specification=u,Cl(this,Gs(this._parameters,this._specification))}static deserialize(a){return new Sp(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Ep(c){let a=null;if(c instanceof Hr)a=Ep(c.result);else if(c instanceof im){for(const u of c.args)if(a=Ep(u),a)break}else(c instanceof qu||c instanceof pn)&&c.input instanceof Jl&&"zoom"===c.input.name&&(a=c);return a instanceof Qa||c.eachChild(u=>{const p=Ep(u);p instanceof Qa?a=p:!a&&p?a=new Qa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&p&&a!==p&&(a=new Qa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}class on{constructor(a,u,p,_){this.message=(a?`${a}: `:"")+p,_&&(this.identifier=_),null!=u&&u.__line__&&(this.line=u.__line__)}}function Da(c){const a=c.key,u=c.value,p=c.valueSpec||{},_=c.objectElementValidators||{},b=c.style,w=c.styleSpec;let S=[];const I=ei(u);if("object"!==I)return[new on(a,u,`object expected, ${I} found`)];for(const M in u){const z=M.split(".")[0];let H;_[z]?H=_[z]:p[z]?H=vr:_["*"]?H=_["*"]:p["*"]&&(H=vr),H?S=S.concat(H({key:(a&&`${a}.`)+M,value:u[M],valueSpec:p[z]||p["*"],style:b,styleSpec:w,object:u,objectKey:M},u)):S.push(new on(a,u[M],`unknown property "${M}"`))}for(const M in p)_[M]||p[M].required&&void 0===p[M].default&&void 0===u[M]&&S.push(new on(a,u,`missing required property "${M}"`));return S}function Ky(c){const a=c.value,u=c.valueSpec,p=c.style,_=c.styleSpec,b=c.key,w=c.arrayElementValidator||vr;if("array"!==ei(a))return[new on(b,a,`array expected, ${ei(a)} found`)];if(u.length&&a.length!==u.length)return[new on(b,a,`array length ${u.length} expected, length ${a.length} found`)];if(u["min-length"]&&a.length<u["min-length"])return[new on(b,a,`array length at least ${u["min-length"]} expected, length ${a.length} found`)];let S={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};_.$version<7&&(S.function=u.function),"object"===ei(u.value)&&(S=u.value);let I=[];for(let M=0;M<a.length;M++)I=I.concat(w({array:a,arrayIndex:M,value:a[M],valueSpec:S,style:p,styleSpec:_,key:`${b}[${M}]`}));return I}function Yg(c){const a=c.key,u=c.value,p=c.valueSpec;let _=ei(u);if("number"===_&&u!=u&&(_="NaN"),"number"!==_)return[new on(a,u,`number expected, ${_} found`)];if("minimum"in p){let b=p.minimum;if("array"===ei(p.minimum)&&(b=p.minimum[c.arrayIndex]),u<b)return[new on(a,u,`${u} is less than the minimum value ${b}`)]}if("maximum"in p){let b=p.maximum;if("array"===ei(p.maximum)&&(b=p.maximum[c.arrayIndex]),u>b)return[new on(a,u,`${u} is greater than the maximum value ${b}`)]}return[]}function Ip(c){const a=c.valueSpec,u=Jo(c.value.type);let p,_,b,w={};const S="categorical"!==u&&void 0===c.value.property,I=!S,M="array"===ei(c.value.stops)&&"array"===ei(c.value.stops[0])&&"object"===ei(c.value.stops[0][0]),z=Da({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(K){if("identity"===u)return[new on(K.key,K.value,'identity function may not have a "stops" property')];let Y=[];const te=K.value;return Y=Y.concat(Ky({key:K.key,value:te,valueSpec:K.valueSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:j})),"array"===ei(te)&&0===te.length&&Y.push(new on(K.key,te,"array must have at least one stop")),Y},default:function(K){return vr({key:K.key,value:K.value,valueSpec:a,style:K.style,styleSpec:K.styleSpec})}}});return"identity"===u&&S&&z.push(new on(c.key,c.value,'missing required property "property"')),"identity"===u||c.value.stops||z.push(new on(c.key,c.value,'missing required property "stops"')),"exponential"===u&&c.valueSpec.expression&&!kl(c.valueSpec)&&z.push(new on(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(I&&!Ml(c.valueSpec)?z.push(new on(c.key,c.value,"property functions not supported")):S&&!aa(c.valueSpec)&&z.push(new on(c.key,c.value,"zoom functions not supported"))),"categorical"!==u&&!M||void 0!==c.value.property||z.push(new on(c.key,c.value,'"property" property is required')),z;function j(K){let Y=[];const te=K.value,ae=K.key;if("array"!==ei(te))return[new on(ae,te,`array expected, ${ei(te)} found`)];if(2!==te.length)return[new on(ae,te,`array length 2 expected, length ${te.length} found`)];if(M){if("object"!==ei(te[0]))return[new on(ae,te,`object expected, ${ei(te[0])} found`)];if(void 0===te[0].zoom)return[new on(ae,te,"object stop key must have zoom")];if(void 0===te[0].value)return[new on(ae,te,"object stop key must have value")];const we=Jo(te[0].zoom);if("number"!=typeof we)return[new on(ae,te[0].zoom,"stop zoom values must be numbers")];if(b&&b>we)return[new on(ae,te[0].zoom,"stop zoom values must appear in ascending order")];we!==b&&(b=we,_=void 0,w={}),Y=Y.concat(Da({key:`${ae}[0]`,value:te[0],valueSpec:{zoom:{}},style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:Yg,value:H}}))}else Y=Y.concat(H({key:`${ae}[0]`,value:te[0],valueSpec:{},style:K.style,styleSpec:K.styleSpec},te));return td(Yl(te[1]))?Y.concat([new on(`${ae}[1]`,te[1],"expressions are not allowed in function stops.")]):Y.concat(vr({key:`${ae}[1]`,value:te[1],valueSpec:a,style:K.style,styleSpec:K.styleSpec}))}function H(K,Y){const te=ei(K.value),ae=Jo(K.value),we=null!==K.value?K.value:Y;if(p){if(te!==p)return[new on(K.key,we,`${te} stop domain type must match previous stop domain type ${p}`)]}else p=te;if("number"!==te&&"string"!==te&&"boolean"!==te&&"number"!=typeof ae&&"string"!=typeof ae&&"boolean"!=typeof ae)return[new on(K.key,we,"stop domain value must be a number, string, or boolean")];if("number"!==te&&"categorical"!==u){let ke=`number expected, ${te} found`;return Ml(a)&&void 0===u&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new on(K.key,we,ke)]}return"categorical"!==u||"number"!==te||"number"==typeof ae&&isFinite(ae)&&Math.floor(ae)===ae?"categorical"!==u&&"number"===te&&"number"==typeof ae&&"number"==typeof _&&void 0!==_&&ae<_?[new on(K.key,we,"stop domain values must appear in ascending order")]:(_=ae,"categorical"===u&&ae in w?[new on(K.key,we,"stop domain values must be unique")]:(w[ae]=!0,[])):[new on(K.key,we,`integer expected, found ${String(ae)}`)]}}function uh(c){const a=("property"===c.expressionContext?od:nd)(Yl(c.value),c.valueSpec);if("error"===a.result)return a.value.map(p=>new on(`${c.key}${p.key}`,c.value,p.message));const u=a.value.expression||a.value._styleExpression.expression;if("property"===c.expressionContext&&"text-font"===c.propertyKey&&!u.outputDefined())return[new on(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===c.expressionContext&&"layout"===c.propertyType&&!oh(u))return[new on(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===c.expressionContext)return Xy(u,c);if(c.expressionContext&&0===c.expressionContext.indexOf("cluster")){if(!yp(u,["zoom","feature-state"]))return[new on(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===c.expressionContext&&!ih(u))return[new on(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xy(c,a){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const _ of a.valueSpec.expression.parameters)u.delete(_);if(0===u.size)return[];const p=[];return c instanceof Jl&&u.has(c.name)?[new on(a.key,a.value,`["${c.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(c.eachChild(_=>{p.push(...Xy(_,a))}),p)}function dh(c){const a=c.key,u=c.value,p=c.valueSpec,_=[];return Array.isArray(p.values)?-1===p.values.indexOf(Jo(u))&&_.push(new on(a,u,`expected one of [${p.values.join(", ")}], ${JSON.stringify(u)} found`)):-1===Object.keys(p.values).indexOf(Jo(u))&&_.push(new on(a,u,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(u)} found`)),_}function Dp(c){if(!0===c||!1===c)return!0;if(!Array.isArray(c)||0===c.length)return!1;switch(c[0]){case"has":return c.length>=2&&"$id"!==c[1]&&"$type"!==c[1];case"in":return c.length>=3&&("string"!=typeof c[1]||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==c.length||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const a of c.slice(1))if(!Dp(a)&&"boolean"!=typeof a)return!1;return!0;default:return!0}}function am(c,a="fill"){if(null==c)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Dp(c)||(c=Pp(c));const u=c;let p=!0;try{p=function(M){if(!Ho(M))return M;let z=Yl(M);return kp(z),z=Mp(z),z}(u)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(u,null,2)}\n        `)}const _=yt[`filter_${a}`],b=nd(p,_);let w=null;if("error"===b.result)throw new Error(b.value.map(M=>`${M.key}: ${M.message}`).join(", "));w=(M,z,j)=>b.value.evaluate(M,z,{},j);let S=null,I=null;if(p!==u){const M=nd(u,_);if("error"===M.result)throw new Error(M.value.map(z=>`${z.key}: ${z.message}`).join(", "));S=(z,j,H,K,Y)=>M.value.evaluate(z,j,{},H,void 0,void 0,K,Y),I=!ih(M.value.expression)}return{filter:w,dynamicFilter:S||void 0,needGeometry:lm(p),needFeature:!!I}}function Mp(c){if(!Array.isArray(c))return c;const a=function(u){if(Ap.has(u[0]))for(let p=1;p<u.length;p++)if(Ho(u[p]))return!0;return u}(c);return!0===a?a:a.map(u=>Mp(u))}function kp(c){let a=!1;const u=[];if("case"===c[0]){for(let p=1;p<c.length-1;p+=2)a=a||Ho(c[p]),u.push(c[p+1]);u.push(c[c.length-1])}else if("match"===c[0]){a=a||Ho(c[1]);for(let p=2;p<c.length-1;p+=2)u.push(c[p+1]);u.push(c[c.length-1])}else if("step"===c[0]){a=a||Ho(c[1]);for(let p=1;p<c.length-1;p+=2)u.push(c[p+1])}a&&(c.length=0,c.push("any",...u));for(let p=1;p<c.length;p++)kp(c[p])}function Ho(c){if(!Array.isArray(c))return!1;if("pitch"===(a=c[0])||"distance-from-center"===a)return!0;var a;for(let u=1;u<c.length;u++)if(Ho(c[u]))return!0;return!1}const Ap=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function _r(c,a){return c<a?-1:c>a?1:0}function lm(c){if(!Array.isArray(c))return!1;if("within"===c[0])return!0;for(let a=1;a<c.length;a++)if(lm(c[a]))return!0;return!1}function Pp(c){if(!c)return!0;const a=c[0];return c.length<=1?"any"!==a:"=="===a?cm(c[1],c[2],"=="):"!="===a?rd(cm(c[1],c[2],"==")):"<"===a||">"===a||"<="===a||">="===a?cm(c[1],c[2],a):"any"===a?(u=c.slice(1),["any"].concat(u.map(Pp))):"all"===a?["all"].concat(c.slice(1).map(Pp)):"none"===a?["all"].concat(c.slice(1).map(Pp).map(rd)):"in"===a?hh(c[1],c.slice(2)):"!in"===a?rd(hh(c[1],c.slice(2))):"has"===a?um(c[1]):"!has"===a?rd(um(c[1])):"within"!==a||c;var u}function cm(c,a,u){switch(c){case"$type":return[`filter-type-${u}`,a];case"$id":return[`filter-id-${u}`,a];default:return[`filter-${u}`,c,a]}}function hh(c,a){if(0===a.length)return!1;switch(c){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(u=>typeof u!=typeof a[0])?["filter-in-large",c,["literal",a.sort(_r)]]:["filter-in-small",c,["literal",a]]}}function um(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function rd(c){return["!",c]}function ph(c){return Dp(Yl(c.value))?uh(Cl({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${c.layerType||"fill"}`]})):Qg(c)}function Qg(c){const a=c.value,u=c.key;if("array"!==ei(a))return[new on(u,a,`array expected, ${ei(a)} found`)];const p=c.styleSpec;let _,b=[];if(a.length<1)return[new on(u,a,"filter array must have at least 1 element")];switch(b=b.concat(dh({key:`${u}[0]`,value:a[0],valueSpec:p.filter_operator,style:c.style,styleSpec:c.styleSpec})),Jo(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&"$type"===Jo(a[1])&&b.push(new on(u,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":3!==a.length&&b.push(new on(u,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(_=ei(a[1]),"string"!==_&&b.push(new on(`${u}[1]`,a[1],`string expected, ${_} found`)));for(let w=2;w<a.length;w++)_=ei(a[w]),"$type"===Jo(a[1])?b=b.concat(dh({key:`${u}[${w}]`,value:a[w],valueSpec:p.geometry_type,style:c.style,styleSpec:c.styleSpec})):"string"!==_&&"number"!==_&&"boolean"!==_&&b.push(new on(`${u}[${w}]`,a[w],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let w=1;w<a.length;w++)b=b.concat(Qg({key:`${u}[${w}]`,value:a[w],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":_=ei(a[1]),2!==a.length?b.push(new on(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):"string"!==_&&b.push(new on(`${u}[1]`,a[1],`string expected, ${_} found`));break;case"within":_=ei(a[1]),2!==a.length?b.push(new on(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):"object"!==_&&b.push(new on(`${u}[1]`,a[1],`object expected, ${_} found`))}return b}function _s(c,a){const u=c.key,p=c.style,_=c.styleSpec,b=c.value,w=c.objectKey,S=_[`${a}_${c.layerType}`];if(!S)return[];const I=w.match(/^(.*)-transition$/);if("paint"===a&&I&&S[I[1]]&&S[I[1]].transition)return vr({key:u,value:b,valueSpec:_.transition,style:p,styleSpec:_});const M=c.valueSpec||S[w];if(!M)return[new on(u,b,`unknown property "${w}"`)];let z;if("string"===ei(b)&&Ml(M)&&!M.tokens&&(z=/^{([^}]+)}$/.exec(b)))return[new on(u,b,`"${w}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(z[1])} }\`.`)];const j=[];return"symbol"===c.layerType&&("text-field"===w&&p&&!p.glyphs&&j.push(new on(u,b,'use of "text-field" requires a style "glyphs" property')),"text-font"===w&&om(Yl(b))&&"identity"===Jo(b.type)&&j.push(new on(u,b,'"text-font" does not support identity functions'))),j.concat(vr({key:c.key,value:b,valueSpec:M,style:p,styleSpec:_,expressionContext:"property",propertyType:a,propertyKey:w}))}function dm(c){return _s(c,"paint")}function Op(c){return _s(c,"layout")}function yr(c){let a=[];const u=c.value,p=c.key,_=c.style,b=c.styleSpec;u.type||u.ref||a.push(new on(p,u,'either "type" or "ref" is required'));let w=Jo(u.type);const S=Jo(u.ref);if(u.id){const I=Jo(u.id);for(let M=0;M<c.arrayIndex;M++){const z=_.layers[M];Jo(z.id)===I&&a.push(new on(p,u.id,`duplicate layer id "${u.id}", previously used at line ${z.id.__line__}`))}}if("ref"in u){let I;["type","source","source-layer","filter","layout"].forEach(M=>{M in u&&a.push(new on(p,u[M],`"${M}" is prohibited for ref layers`))}),_.layers.forEach(M=>{Jo(M.id)===S&&(I=M)}),I?I.ref?a.push(new on(p,u.ref,"ref cannot reference another ref layer")):w=Jo(I.type):"string"==typeof S&&a.push(new on(p,u.ref,`ref layer "${S}" not found`))}else if("background"!==w&&"sky"!==w)if(u.source){const I=_.sources&&_.sources[u.source],M=I&&Jo(I.type);I?"vector"===M&&"raster"===w?a.push(new on(p,u.source,`layer "${u.id}" requires a raster source`)):"raster"===M&&"raster"!==w?a.push(new on(p,u.source,`layer "${u.id}" requires a vector source`)):"vector"!==M||u["source-layer"]?"raster-dem"===M&&"hillshade"!==w?a.push(new on(p,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==w||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||"geojson"===M&&I.lineMetrics||a.push(new on(p,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new on(p,u,`layer "${u.id}" must specify a "source-layer"`)):a.push(new on(p,u.source,`source "${u.source}" not found`))}else a.push(new on(p,u,'missing required property "source"'));return a=a.concat(Da({key:p,value:u,valueSpec:b.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>vr({key:`${p}.type`,value:u.type,valueSpec:b.layer.type,style:c.style,styleSpec:c.styleSpec,object:u,objectKey:"type"}),filter:I=>ph(Cl({layerType:w},I)),layout:I=>Da({layer:u,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":M=>Op(Cl({layerType:w},M))}}),paint:I=>Da({layer:u,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":M=>dm(Cl({layerType:w},M))}})}})),a}function sd(c){const a=c.value,u=c.key,p=ei(a);return"string"!==p?[new on(u,a,`string expected, ${p} found`)]:[]}const qc={promoteId:function({key:c,value:a}){if("string"===ei(a))return sd({key:c,value:a});{const u=[];for(const p in a)u.push(...sd({key:`${c}.${p}`,value:a[p]}));return u}}};function qr(c){const a=c.value,u=c.key,p=c.styleSpec,_=c.style;if(!a.type)return[new on(u,a,'"type" is required')];const b=Jo(a.type);let w;switch(b){case"vector":case"raster":case"raster-dem":return w=Da({key:u,value:a,valueSpec:p[`source_${b.replace("-","_")}`],style:c.style,styleSpec:p,objectElementValidators:qc}),w;case"geojson":if(w=Da({key:u,value:a,valueSpec:p.source_geojson,style:_,styleSpec:p,objectElementValidators:qc}),a.cluster)for(const S in a.clusterProperties){const[I,M]=a.clusterProperties[S],z="string"==typeof I?[I,["accumulated"],["get",S]]:I;w.push(...uh({key:`${u}.${S}.map`,value:M,expressionContext:"cluster-map"})),w.push(...uh({key:`${u}.${S}.reduce`,value:z,expressionContext:"cluster-reduce"}))}return w;case"video":return Da({key:u,value:a,valueSpec:p.source_video,style:_,styleSpec:p});case"image":return Da({key:u,value:a,valueSpec:p.source_image,style:_,styleSpec:p});case"canvas":return[new on(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return dh({key:`${u}.type`,value:a.type,valueSpec:{values:Jg(p)},style:_,styleSpec:p})}}function Jg(c){return c.source.reduce((a,u)=>{const p=c[u];return"enum"===p.type.type&&(a=a.concat(Object.keys(p.type.values))),a},[])}function hm(c){const a=c.value,u=c.styleSpec,p=u.light,_=c.style;let b=[];const w=ei(a);if(void 0===a)return b;if("object"!==w)return b=b.concat([new on("light",a,`object expected, ${w} found`)]),b;for(const S in a){const I=S.match(/^(.*)-transition$/);b=b.concat(I&&p[I[1]]&&p[I[1]].transition?vr({key:S,value:a[S],valueSpec:u.transition,style:_,styleSpec:u}):p[S]?vr({key:S,value:a[S],valueSpec:p[S],style:_,styleSpec:u}):[new on(S,a[S],`unknown property "${S}"`)])}return b}function nc(c){const a=c.value,u=c.key,p=c.style,_=c.styleSpec,b=_.terrain;let w=[];const S=ei(a);if(void 0===a)return w;if("object"!==S)return w=w.concat([new on("terrain",a,`object expected, ${S} found`)]),w;for(const I in a){const M=I.match(/^(.*)-transition$/);w=w.concat(M&&b[M[1]]&&b[M[1]].transition?vr({key:I,value:a[I],valueSpec:_.transition,style:p,styleSpec:_}):b[I]?vr({key:I,value:a[I],valueSpec:b[I],style:p,styleSpec:_}):[new on(I,a[I],`unknown property "${I}"`)])}if(a.source){const I=p.sources&&p.sources[a.source],M=I&&Jo(I.type);I?"raster-dem"!==M&&w.push(new on(u,a.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):w.push(new on(u,a.source,`source "${a.source}" not found`))}else w.push(new on(u,a,'terrain is missing required property "source"'));return w}function Ps(c){const a=c.value,u=c.style,p=c.styleSpec,_=p.fog;let b=[];const w=ei(a);if(void 0===a)return b;if("object"!==w)return b=b.concat([new on("fog",a,`object expected, ${w} found`)]),b;for(const S in a){const I=S.match(/^(.*)-transition$/);b=b.concat(I&&_[I[1]]&&_[I[1]].transition?vr({key:S,value:a[S],valueSpec:p.transition,style:u,styleSpec:p}):_[S]?vr({key:S,value:a[S],valueSpec:_[S],style:u,styleSpec:p}):[new on(S,a[S],`unknown property "${S}"`)])}return b}const Lp={"*":()=>[],array:Ky,boolean:function(c){const a=c.value,u=c.key,p=ei(a);return"boolean"!==p?[new on(u,a,`boolean expected, ${p} found`)]:[]},number:Yg,color:function(c){const a=c.key,u=c.value,p=ei(u);return"string"!==p?[new on(a,u,`color expected, ${p} found`)]:null===hi(u)?[new on(a,u,`color expected, "${u}" found`)]:[]},enum:dh,filter:ph,function:Ip,layer:yr,object:Da,source:qr,light:hm,terrain:nc,fog:Ps,string:sd,formatted:function(c){return 0===sd(c).length?[]:uh(c)},resolvedImage:function(c){return 0===sd(c).length?[]:uh(c)},projection:function(c){const a=c.value,u=c.styleSpec,p=u.projection,_=c.style;let b=[];const w=ei(a);if("object"===w)for(const S in a)b=b.concat(vr({key:S,value:a[S],valueSpec:p[S],style:_,styleSpec:u}));else"string"!==w&&(b=b.concat([new on("projection",a,`object or string expected, ${w} found`)]));return b}};function vr(c){const a=c.value,u=c.valueSpec,p=c.styleSpec;return u.expression&&om(Jo(a))?Ip(c):u.expression&&td(Yl(a))?uh(c):u.type&&Lp[u.type]?Lp[u.type](c):Da(Cl({},c,{valueSpec:u.type?p[u.type]:u}))}function Yy(c){const a=c.value,u=c.key,p=sd(c);return p.length||(-1===a.indexOf("{fontstack}")&&p.push(new on(u,a,'"glyphs" url must include a "{fontstack}" token')),-1===a.indexOf("{range}")&&p.push(new on(u,a,'"glyphs" url must include a "{range}" token'))),p}function Al(c,a=yt){return ni(vr({key:"",value:c,valueSpec:a.$root,styleSpec:a,style:c,objectElementValidators:{glyphs:Yy,"*":()=>[]}}))}const e_=c=>ni(dm(c)),Rp=c=>ni(Op(c));function ni(c){return c.slice().sort((a,u)=>a.line&&u.line?a.line-u.line:0)}function pm(c,a){let u=!1;if(a&&a.length)for(const p of a)c.fire(new wl(new Error(p.message))),u=!0;return u}var fh=il;function il(c,a,u){var p=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var _=new Int32Array(this.arrayBuffer);c=_[0],this.d=(a=_[1])+2*(u=_[2]);for(var b=0;b<this.d*this.d;b++){var w=_[3+b],S=_[3+b+1];p.push(w===S?null:_.subarray(w,S))}var I=_[3+p.length+1];this.keys=_.subarray(_[3+p.length],I),this.bboxes=_.subarray(I),this.insert=this._insertReadonly}else{this.d=a+2*u;for(var M=0;M<this.d*this.d;M++)p.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=c,this.padding=u,this.scale=a/c,this.uid=0;var z=u/a*c;this.min=-z,this.max=c+z}il.prototype.insert=function(c,a,u,p,_){this._forEachCell(a,u,p,_,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(_)},il.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},il.prototype._insertCell=function(c,a,u,p,_,b){this.cells[_].push(b)},il.prototype.query=function(c,a,u,p,_){var b=this.min,w=this.max;if(c<=b&&a<=b&&w<=u&&w<=p&&!_)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(c,a,u,p,this._queryCell,S,{},_),S},il.prototype._queryCell=function(c,a,u,p,_,b,w,S){var I=this.cells[_];if(null!==I)for(var M=this.keys,z=this.bboxes,j=0;j<I.length;j++){var H=I[j];if(void 0===w[H]){var K=4*H;(S?S(z[K+0],z[K+1],z[K+2],z[K+3]):c<=z[K+2]&&a<=z[K+3]&&u>=z[K+0]&&p>=z[K+1])?(w[H]=!0,b.push(M[H])):w[H]=!1}}},il.prototype._forEachCell=function(c,a,u,p,_,b,w,S){for(var I=this._convertToCellCoord(c),M=this._convertToCellCoord(a),z=this._convertToCellCoord(u),j=this._convertToCellCoord(p),H=I;H<=z;H++)for(var K=M;K<=j;K++){var Y=this.d*K+H;if((!S||S(this._convertFromCellCoord(H),this._convertFromCellCoord(K),this._convertFromCellCoord(H+1),this._convertFromCellCoord(K+1)))&&_.call(this,c,a,u,p,Y,b,w,S))return}},il.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},il.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},il.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,a=3+this.cells.length+1+1,u=0,p=0;p<this.cells.length;p++)u+=this.cells[p].length;var _=new Int32Array(a+u+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var b=a,w=0;w<c.length;w++){var S=c[w];_[3+w]=b,_.set(S,b),b+=S.length}return _[3+c.length]=b,_.set(this.keys,b),_[3+c.length+1]=b+=this.keys.length,_.set(this.bboxes,b),b+=this.bboxes.length,_.buffer};const Fp={};function dn(c,a,u={}){Object.defineProperty(c,"_classRegistryKey",{value:a,writeable:!1}),Fp[a]={klass:c,omit:u.omit||[]}}dn(Object,"Object"),fh.serialize=function(c,a){const u=c.toArrayBuffer();return a&&a.push(u),{buffer:u}},fh.deserialize=function(c){return new fh(c.buffer)},Object.defineProperty(fh,"name",{value:"Grid"}),dn(fh,"Grid"),dn(tr,"Color"),dn(Error,"Error"),dn(ia,"AJAXError"),dn(Ms,"ResolvedImage"),dn(Sp,"StylePropertyFunction"),dn(rm,"StyleExpression",{omit:["_evaluator"]}),dn(id,"ZoomDependentExpression"),dn(sm,"ZoomConstantExpression"),dn(Jl,"CompoundExpression",{omit:["_evaluate"]});for(const c in lh)Fp[lh[c]._classRegistryKey]||dn(lh[c],`Expression${c}`);function fm(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&"ArrayBuffer"===c.constructor.name)}function mh(c){return se.ImageBitmap&&c instanceof se.ImageBitmap}function gh(c,a){if(null==c||"boolean"==typeof c||"number"==typeof c||"string"==typeof c||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(fm(c)||mh(c))return a&&a.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return a&&a.push(u.buffer),u}if(c instanceof se.ImageData)return a&&a.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const p of c)u.push(gh(p,a));return u}if("object"==typeof c){const u=c.constructor,p=u._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${p}`);const _=u.serialize?u.serialize(c,a):{};if(!u.serialize){for(const b in c)c.hasOwnProperty(b)&&(Fp[p].omit.indexOf(b)>=0||(_[b]=gh(c[b],a)));c instanceof Error&&(_.message=c.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==p&&(_.$name=p),_}throw new Error("can't serialize object of type "+typeof c)}function zt(c){if(null==c||"boolean"==typeof c||"number"==typeof c||"string"==typeof c||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||fm(c)||mh(c)||ArrayBuffer.isView(c)||c instanceof se.ImageData)return c;if(Array.isArray(c))return c.map(zt);if("object"==typeof c){const a=c.$name||"Object",{klass:u}=Fp[a];if(!u)throw new Error(`can't deserialize unregistered class ${a}`);if(u.deserialize)return u.deserialize(c);const p=Object.create(u.prototype);for(const _ of Object.keys(c))"$name"!==_&&(p[_]=zt(c[_]));return p}throw new Error("can't deserialize object of type "+typeof c)}const Ni=c=>c>=1536&&c<=1791,be=c=>c>=1872&&c<=1919,ve=c=>c>=2208&&c<=2303,Ar=c=>c>=11904&&c<=12031,Np=c=>c>=12032&&c<=12255,Zc=c=>c>=12272&&c<=12287,Os=c=>c>=12288&&c<=12351,ad=c=>c>=12352&&c<=12447,ic=c=>c>=12448&&c<=12543,zp=c=>c>=12544&&c<=12591,Qy=c=>c>=12704&&c<=12735,mm=c=>c>=12736&&c<=12783,Zr=c=>c>=12784&&c<=12799,ol=c=>c>=12800&&c<=13055,gm=c=>c>=13056&&c<=13311,Kc=c=>c>=13312&&c<=19903,Ma=c=>c>=19968&&c<=40959,t_=c=>c>=40960&&c<=42127,_m=c=>c>=42128&&c<=42191,n_=c=>c>=44032&&c<=55215,i_=c=>c>=63744&&c<=64255,ld=c=>c>=64336&&c<=65023,Xc=c=>c>=65040&&c<=65055,v=c=>c>=65072&&c<=65103,d=c=>c>=65104&&c<=65135,m=c=>c>=65136&&c<=65279,x=c=>c>=65280&&c<=65519;function T(c){for(const a of c)if(O(a.charCodeAt(0)))return!0;return!1}function E(c){for(const a of c)if(!k(a.charCodeAt(0)))return!1;return!0}function k(c){return!(Ni(c)||be(c)||ve(c)||ld(c)||m(c))}function O(c){return!(746!==c&&747!==c&&(c<4352||!(Qy(c)||zp(c)||v(c)&&!(c>=65097&&c<=65103)||i_(c)||gm(c)||Ar(c)||mm(c)||!(!Os(c)||c>=12296&&c<=12305||c>=12308&&c<=12319||12336===c)||Kc(c)||Ma(c)||ol(c)||(a=c,a>=12592&&a<=12687)||(a=>a>=43360&&a<=43391)(c)||(a=>a>=55216&&a<=55295)(c)||(a=>a>=4352&&a<=4607)(c)||n_(c)||ad(c)||Zc(c)||(a=>a>=12688&&a<=12703)(c)||Np(c)||Zr(c)||ic(c)&&12540!==c||!(!x(c)||65288===c||65289===c||65293===c||c>=65306&&c<=65310||65339===c||65341===c||65343===c||c>=65371&&c<=65503||65507===c||c>=65512&&c<=65519)||!(!d(c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||(a=>a>=5120&&a<=5759)(c)||(a=>a>=6320&&a<=6399)(c)||Xc(c)||(a=>a>=19904&&a<=19967)(c)||t_(c)||_m(c))));var a}function B(c){return!(O(c)||(a=c,(u=a)>=128&&u<=255&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||(u=>u>=8192&&u<=8303)(a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||(u=>u>=8448&&u<=8527)(a)||(u=>u>=8528&&u<=8591)(a)||(u=>u>=8960&&u<=9215)(a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||9003===a||a>=9085&&a<=9114||a>=9150&&a<=9165||9167===a||a>=9169&&a<=9179||a>=9186&&a<=9215)||(u=>u>=9216&&u<=9279)(a)&&9251!==a||(u=>u>=9280&&u<=9311)(a)||(u=>u>=9312&&u<=9471)(a)||(u=>u>=9632&&u<=9727)(a)||(u=>u>=9728&&u<=9983)(a)&&!(a>=9754&&a<=9759)||(u=>u>=11008&&u<=11263)(a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Os(a)||ic(a)||(u=>u>=57344&&u<=63743)(a)||v(a)||d(a)||x(a)||8734===a||8756===a||8757===a||a>=9984&&a<=10087||a>=10102&&a<=10131||65532===a||65533===a));var a,u}function G(c){return c>=1424&&c<=2303||ld(c)||m(c)}function q(c,a){return!(!a&&G(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||(u=c,u>=6016&&u<=6143));var u}function J(c){for(const a of c)if(G(a.charCodeAt(0)))return!0;return!1}const re="deferred",de="loading",le="loaded";let he=null,pe="unavailable",oe=null;const Ce=function(c){c&&"string"==typeof c&&c.indexOf("NetworkError")>-1&&(pe="error"),he&&he(c)};function xe(){Ee.fire(new go("pluginStateChange",{pluginStatus:pe,pluginURL:oe}))}const Ee=new Ya,Le=function(){return pe},Pe=function(){if(pe!==re||!oe)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");pe=de,xe(),oe&&Ru({url:oe},c=>{c?Ce(c):(pe=le,xe())})},Fe={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>pe===le||null!=Fe.applyArabicShaping,isLoading:()=>pe===de,setState(c){pe=c.pluginStatus,oe=c.pluginURL},isParsed:()=>null!=Fe.applyArabicShaping&&null!=Fe.processBidirectionalText&&null!=Fe.processStyledBidirectionalText,getPluginURL:()=>oe};class $e{constructor(a,u){this.zoom=a,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(a){return function(u,p){for(const _ of u)if(!q(_.charCodeAt(0),p))return!1;return!0}(a,Fe.isLoaded())}}class it{constructor(a,u){this.property=a,this.value=u,this.expression=function(p,_){if(om(p))return new Sp(p,_);if(td(p)){const b=od(p,_);if("error"===b.result)throw new Error(b.value.map(w=>`${w.key}: ${w.message}`).join(", "));return b.value}{let b=p;return"string"==typeof p&&"color"===_.type&&(b=tr.parse(p)),{kind:"constant",evaluate:()=>b}}}(void 0===u?a.specification.default:u,a.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(a,u,p){return this.property.possiblyEvaluate(this,a,u,p)}}class rt{constructor(a){this.property=a,this.value=new it(a,void 0)}transitioned(a,u){return new Ze(this.property,this.value,u,ri({},a.transition,this.transition),a.now)}untransitioned(){return new Ze(this.property,this.value,null,{},0)}}class Vt{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return Ko(this._values[a].value.value)}setValue(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new rt(this._values[a].property)),this._values[a].value=new it(this._values[a].property,null===u?void 0:Ko(u))}getTransition(a){return Ko(this._values[a].transition)}setTransition(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new rt(this._values[a].property)),this._values[a].transition=Ko(u)||void 0}serialize(){const a={};for(const u of Object.keys(this._values)){const p=this.getValue(u);void 0!==p&&(a[u]=p);const _=this.getTransition(u);void 0!==_&&(a[`${u}-transition`]=_)}return a}transitioned(a,u){const p=new Tt(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].transitioned(a,u._values[_]);return p}untransitioned(){const a=new Tt(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].untransitioned();return a}}class Ze{constructor(a,u,p,_,b){const w=_.delay||0,S=_.duration||0;b=b||0,this.property=a,this.value=u,this.begin=b+w,this.end=this.begin+S,a.specification.transition&&(_.delay||_.duration)&&(this.prior=p)}possiblyEvaluate(a,u,p){const _=a.now||0,b=this.value.possiblyEvaluate(a,u,p),w=this.prior;if(w){if(_>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(_<this.begin)return w.possiblyEvaluate(a,u,p);{const S=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(a,u,p),b,Bn(S))}}return b}}class Tt{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,u,p){const _=new ot(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(a,u,p);return _}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class dt{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return Ko(this._values[a].value)}setValue(a,u){this._values[a]=new it(this._values[a].property,null===u?void 0:Ko(u))}serialize(){const a={};for(const u of Object.keys(this._values)){const p=this.getValue(u);void 0!==p&&(a[u]=p)}return a}possiblyEvaluate(a,u,p){const _=new ot(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(a,u,p);return _}}class At{constructor(a,u,p){this.property=a,this.value=u,this.parameters=p}isConstant(){return"constant"===this.value.kind}constantOr(a){return"constant"===this.value.kind?this.value.value:a}evaluate(a,u,p,_){return this.property.evaluate(this.value,this.parameters,a,u,p,_)}}class ot{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class je{constructor(a){this.specification=a}possiblyEvaluate(a,u){return a.expression.evaluate(u)}interpolate(a,u,p){const _=El[this.specification.type];return _?_(a,u,p):a}}class ct{constructor(a,u){this.specification=a,this.overrides=u}possiblyEvaluate(a,u,p,_){return new At(this,"constant"===a.expression.kind||"camera"===a.expression.kind?{kind:"constant",value:a.expression.evaluate(u,null,{},p,_)}:a.expression,u)}interpolate(a,u,p){if("constant"!==a.value.kind||"constant"!==u.value.kind)return a;if(void 0===a.value.value||void 0===u.value.value)return new At(this,{kind:"constant",value:void 0},a.parameters);const _=El[this.specification.type];return _?new At(this,{kind:"constant",value:_(a.value.value,u.value.value,p)},a.parameters):a}evaluate(a,u,p,_,b,w){return"constant"===a.kind?a.value:a.evaluate(u,p,_,b,w)}}class Dt{constructor(a){this.specification=a}possiblyEvaluate(a,u,p,_){return!!a.expression.evaluate(u,null,{},p,_)}interpolate(){return!1}}class Ot{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new $e(0,{});for(const p in a){const _=a[p];_.specification.overridable&&this.overridableProperties.push(p);const b=this.defaultPropertyValues[p]=new it(_,void 0),w=this.defaultTransitionablePropertyValues[p]=new rt(_);this.defaultTransitioningPropertyValues[p]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=b.possiblyEvaluate(u)}}}function vn(c,a){return 256*(c=Hn(Math.floor(c),0,255))+Hn(Math.floor(a),0,255)}dn(ct,"DataDrivenProperty"),dn(je,"DataConstantProperty"),dn(Dt,"ColorRampProperty");const li={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class hn{constructor(a,u){this._structArray=a,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Jt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,u){return a._trim(),u&&(a.isTransferred=!0,u.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const u=Object.create(this.prototype);return u.arrayBuffer=a.arrayBuffer,u.length=a.length,u.capacity=a.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Sn(c,a=1){let u=0,p=0;return{members:c.map(_=>{const b=li[_.type].BYTES_PER_ELEMENT,w=u=Ci(u,Math.max(a,b)),S=_.components||1;return p=Math.max(p,b),u+=b*S,{name:_.name,type:_.type,components:S,offset:w}}),size:Ci(u,Math.max(p,a)),alignment:a}}function Ci(c,a){return Math.ceil(c/a)*a}class In extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u){const p=this.length;return this.resize(p+1),this.emplace(p,a,u)}emplace(a,u,p){const _=2*a;return this.int16[_+0]=u,this.int16[_+1]=p,a}}In.prototype.bytesPerElement=4,dn(In,"StructArrayLayout2i4");class Yi extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,u,p)}emplace(a,u,p,_){const b=3*a;return this.int16[b+0]=u,this.int16[b+1]=p,this.int16[b+2]=_,a}}Yi.prototype.bytesPerElement=6,dn(Yi,"StructArrayLayout3i6");class Qi extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,p,_)}emplace(a,u,p,_,b){const w=4*a;return this.int16[w+0]=u,this.int16[w+1]=p,this.int16[w+2]=_,this.int16[w+3]=b,a}}Qi.prototype.bytesPerElement=8,dn(Qi,"StructArrayLayout4i8");class yo extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b,w,S){const I=this.length;return this.resize(I+1),this.emplace(I,a,u,p,_,b,w,S)}emplace(a,u,p,_,b,w,S,I){const M=6*a,z=12*a,j=3*a;return this.int16[M+0]=u,this.int16[M+1]=p,this.uint8[z+4]=_,this.uint8[z+5]=b,this.uint8[z+6]=w,this.uint8[z+7]=S,this.float32[j+2]=I,a}}yo.prototype.bytesPerElement=12,dn(yo,"StructArrayLayout2i4ub1f12");class io extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,p,_)}emplace(a,u,p,_,b){const w=4*a;return this.float32[w+0]=u,this.float32[w+1]=p,this.float32[w+2]=_,this.float32[w+3]=b,a}}io.prototype.bytesPerElement=16,dn(io,"StructArrayLayout4f16");class cr extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b){const w=this.length;return this.resize(w+1),this.emplace(w,a,u,p,_,b)}emplace(a,u,p,_,b,w){const S=6*a,I=3*a;return this.uint16[S+0]=u,this.uint16[S+1]=p,this.uint16[S+2]=_,this.uint16[S+3]=b,this.float32[I+2]=w,a}}cr.prototype.bytesPerElement=12,dn(cr,"StructArrayLayout4ui1f12");class ys extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,p,_)}emplace(a,u,p,_,b){const w=4*a;return this.uint16[w+0]=u,this.uint16[w+1]=p,this.uint16[w+2]=_,this.uint16[w+3]=b,a}}ys.prototype.bytesPerElement=8,dn(ys,"StructArrayLayout4ui8");class la extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b,w){const S=this.length;return this.resize(S+1),this.emplace(S,a,u,p,_,b,w)}emplace(a,u,p,_,b,w,S){const I=6*a;return this.int16[I+0]=u,this.int16[I+1]=p,this.int16[I+2]=_,this.int16[I+3]=b,this.int16[I+4]=w,this.int16[I+5]=S,a}}la.prototype.bytesPerElement=12,dn(la,"StructArrayLayout6i12");class Pl extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b,w,S,I,M,z,j,H){const K=this.length;return this.resize(K+1),this.emplace(K,a,u,p,_,b,w,S,I,M,z,j,H)}emplace(a,u,p,_,b,w,S,I,M,z,j,H,K){const Y=12*a;return this.int16[Y+0]=u,this.int16[Y+1]=p,this.int16[Y+2]=_,this.int16[Y+3]=b,this.uint16[Y+4]=w,this.uint16[Y+5]=S,this.uint16[Y+6]=I,this.uint16[Y+7]=M,this.int16[Y+8]=z,this.int16[Y+9]=j,this.int16[Y+10]=H,this.int16[Y+11]=K,a}}Pl.prototype.bytesPerElement=24,dn(Pl,"StructArrayLayout4i4ui4i24");class Gi extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b,w){const S=this.length;return this.resize(S+1),this.emplace(S,a,u,p,_,b,w)}emplace(a,u,p,_,b,w,S){const I=10*a,M=5*a;return this.int16[I+0]=u,this.int16[I+1]=p,this.int16[I+2]=_,this.float32[M+2]=b,this.float32[M+3]=w,this.float32[M+4]=S,a}}Gi.prototype.bytesPerElement=20,dn(Gi,"StructArrayLayout3i3f20");class bo extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint32[1*a+0]=u,a}}bo.prototype.bytesPerElement=4,dn(bo,"StructArrayLayout1ul4");class Pi extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b,w,S,I,M,z,j,H,K){const Y=this.length;return this.resize(Y+1),this.emplace(Y,a,u,p,_,b,w,S,I,M,z,j,H,K)}emplace(a,u,p,_,b,w,S,I,M,z,j,H,K,Y){const te=20*a,ae=10*a;return this.int16[te+0]=u,this.int16[te+1]=p,this.int16[te+2]=_,this.int16[te+3]=b,this.int16[te+4]=w,this.float32[ae+3]=S,this.float32[ae+4]=I,this.float32[ae+5]=M,this.float32[ae+6]=z,this.int16[te+14]=j,this.uint32[ae+8]=H,this.uint16[te+18]=K,this.uint16[te+19]=Y,a}}Pi.prototype.bytesPerElement=40,dn(Pi,"StructArrayLayout5i4f1i1ul2ui40");class No extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b,w,S){const I=this.length;return this.resize(I+1),this.emplace(I,a,u,p,_,b,w,S)}emplace(a,u,p,_,b,w,S,I){const M=8*a;return this.int16[M+0]=u,this.int16[M+1]=p,this.int16[M+2]=_,this.int16[M+4]=b,this.int16[M+5]=w,this.int16[M+6]=S,this.int16[M+7]=I,a}}No.prototype.bytesPerElement=16,dn(No,"StructArrayLayout3i2i2i16");class Kr extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b){const w=this.length;return this.resize(w+1),this.emplace(w,a,u,p,_,b)}emplace(a,u,p,_,b,w){const S=4*a,I=8*a;return this.float32[S+0]=u,this.float32[S+1]=p,this.float32[S+2]=_,this.int16[I+6]=b,this.int16[I+7]=w,a}}Kr.prototype.bytesPerElement=16,dn(Kr,"StructArrayLayout2f1f2i16");class xo extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,p,_)}emplace(a,u,p,_,b){const w=12*a,S=3*a;return this.uint8[w+0]=u,this.uint8[w+1]=p,this.float32[S+1]=_,this.float32[S+2]=b,a}}xo.prototype.bytesPerElement=12,dn(xo,"StructArrayLayout2ub2f12");class Pr extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,u,p)}emplace(a,u,p,_){const b=3*a;return this.float32[b+0]=u,this.float32[b+1]=p,this.float32[b+2]=_,a}}Pr.prototype.bytesPerElement=12,dn(Pr,"StructArrayLayout3f12");class as extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,u,p)}emplace(a,u,p,_){const b=3*a;return this.uint16[b+0]=u,this.uint16[b+1]=p,this.uint16[b+2]=_,a}}as.prototype.bytesPerElement=6,dn(as,"StructArrayLayout3ui6");class Ol extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b,w,S,I,M,z,j,H,K,Y,te,ae,we,ke,me,Se,Oe){const De=this.length;return this.resize(De+1),this.emplace(De,a,u,p,_,b,w,S,I,M,z,j,H,K,Y,te,ae,we,ke,me,Se,Oe)}emplace(a,u,p,_,b,w,S,I,M,z,j,H,K,Y,te,ae,we,ke,me,Se,Oe,De){const tt=30*a,Qe=15*a,mt=60*a;return this.int16[tt+0]=u,this.int16[tt+1]=p,this.int16[tt+2]=_,this.float32[Qe+2]=b,this.float32[Qe+3]=w,this.uint16[tt+8]=S,this.uint16[tt+9]=I,this.uint32[Qe+5]=M,this.uint32[Qe+6]=z,this.uint32[Qe+7]=j,this.uint16[tt+16]=H,this.uint16[tt+17]=K,this.uint16[tt+18]=Y,this.float32[Qe+10]=te,this.float32[Qe+11]=ae,this.uint8[mt+48]=we,this.uint8[mt+49]=ke,this.uint8[mt+50]=me,this.uint32[Qe+13]=Se,this.int16[tt+28]=Oe,this.uint8[mt+58]=De,a}}Ol.prototype.bytesPerElement=60,dn(Ol,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Yc extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b,w,S,I,M,z,j,H,K,Y,te,ae,we,ke,me,Se,Oe,De,tt,Qe,mt,at,lt,bt,xt,Mt){const Pt=this.length;return this.resize(Pt+1),this.emplace(Pt,a,u,p,_,b,w,S,I,M,z,j,H,K,Y,te,ae,we,ke,me,Se,Oe,De,tt,Qe,mt,at,lt,bt,xt,Mt)}emplace(a,u,p,_,b,w,S,I,M,z,j,H,K,Y,te,ae,we,ke,me,Se,Oe,De,tt,Qe,mt,at,lt,bt,xt,Mt,Pt){const ut=38*a,Gt=19*a;return this.int16[ut+0]=u,this.int16[ut+1]=p,this.int16[ut+2]=_,this.float32[Gt+2]=b,this.float32[Gt+3]=w,this.int16[ut+8]=S,this.int16[ut+9]=I,this.int16[ut+10]=M,this.int16[ut+11]=z,this.int16[ut+12]=j,this.int16[ut+13]=H,this.uint16[ut+14]=K,this.uint16[ut+15]=Y,this.uint16[ut+16]=te,this.uint16[ut+17]=ae,this.uint16[ut+18]=we,this.uint16[ut+19]=ke,this.uint16[ut+20]=me,this.uint16[ut+21]=Se,this.uint16[ut+22]=Oe,this.uint16[ut+23]=De,this.uint16[ut+24]=tt,this.uint16[ut+25]=Qe,this.uint16[ut+26]=mt,this.uint16[ut+27]=at,this.uint16[ut+28]=lt,this.uint32[Gt+15]=bt,this.float32[Gt+16]=xt,this.float32[Gt+17]=Mt,this.float32[Gt+18]=Pt,a}}Yc.prototype.bytesPerElement=76,dn(Yc,"StructArrayLayout3i2f6i15ui1ul3f76");class Ls extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.float32[1*a+0]=u,a}}Ls.prototype.bytesPerElement=4,dn(Ls,"StructArrayLayout1f4");class Ws extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,p,_,b){const w=this.length;return this.resize(w+1),this.emplace(w,a,u,p,_,b)}emplace(a,u,p,_,b,w){const S=5*a;return this.float32[S+0]=u,this.float32[S+1]=p,this.float32[S+2]=_,this.float32[S+3]=b,this.float32[S+4]=w,a}}Ws.prototype.bytesPerElement=20,dn(Ws,"StructArrayLayout5f20");class Ll extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,p,_)}emplace(a,u,p,_,b){const w=6*a;return this.uint32[3*a+0]=u,this.uint16[w+2]=p,this.uint16[w+3]=_,this.uint16[w+4]=b,a}}Ll.prototype.bytesPerElement=12,dn(Ll,"StructArrayLayout1ul3ui12");class ka extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u){const p=this.length;return this.resize(p+1),this.emplace(p,a,u)}emplace(a,u,p){const _=2*a;return this.uint16[_+0]=u,this.uint16[_+1]=p,a}}ka.prototype.bytesPerElement=4,dn(ka,"StructArrayLayout2ui4");class Rs extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint16[1*a+0]=u,a}}Rs.prototype.bytesPerElement=2,dn(Rs,"StructArrayLayout1ui2");class cd extends Jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u){const p=this.length;return this.resize(p+1),this.emplace(p,a,u)}emplace(a,u,p){const _=2*a;return this.float32[_+0]=u,this.float32[_+1]=p,a}}cd.prototype.bytesPerElement=8,dn(cd,"StructArrayLayout2f8");class Jy extends hn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Jy.prototype.size=40;class o_ extends Pi{get(a){return new Jy(this,a)}}dn(o_,"CollisionBoxArray");class _h extends hn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(a){this._structArray.uint8[this._pos1+49]=a}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(a){this._structArray.uint8[this._pos1+50]=a}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(a){this._structArray.uint8[this._pos1+58]=a}}_h.prototype.size=60;class Q0 extends Ol{get(a){return new _h(this,a)}}dn(Q0,"PlacedSymbolArray");class Or extends hn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(a){this._structArray.uint32[this._pos4+15]=a}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Or.prototype.size=76;class r_ extends Yc{get(a){return new Or(this,a)}}dn(r_,"SymbolInstanceArray");class J0 extends Ls{getoffsetX(a){return this.float32[1*a+0]}}dn(J0,"GlyphOffsetArray");class ev extends In{getx(a){return this.int16[2*a+0]}gety(a){return this.int16[2*a+1]}}dn(ev,"SymbolLineVertexArray");class Bp extends hn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Bp.prototype.size=12;class yh extends Ll{get(a){return new Bp(this,a)}}dn(yh,"FeatureIndexArray");class vh extends ka{geta_centroid_pos0(a){return this.uint16[2*a+0]}geta_centroid_pos1(a){return this.uint16[2*a+1]}}dn(vh,"FillExtrusionCentroidArray");const Vp=Sn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),ex=Sn([{name:"a_dash",components:4,type:"Uint16"}]);var Qc={},Up={get exports(){return Qc},set exports(c){Qc=c}},tx={};({get exports(){return tx},set exports(c){tx=c}}).exports=function(c,a){var u,p,_,b,w,S,I,M;for(p=c.length-(u=3&c.length),_=a,w=3432918353,S=461845907,M=0;M<p;)I=255&c.charCodeAt(M)|(255&c.charCodeAt(++M))<<8|(255&c.charCodeAt(++M))<<16|(255&c.charCodeAt(++M))<<24,++M,_=27492+(65535&(b=5*(65535&(_=(_^=I=(65535&(I=(I=(65535&I)*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*S+(((I>>>16)*S&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(I=0,u){case 3:I^=(255&c.charCodeAt(M+2))<<16;case 2:I^=(255&c.charCodeAt(M+1))<<8;case 1:_^=I=(65535&(I=(I=(65535&(I^=255&c.charCodeAt(M)))*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*S+(((I>>>16)*S&65535)<<16)&4294967295}return _^=c.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0};var tv={};({get exports(){return tv},set exports(c){tv=c}}).exports=function(c,a){for(var u,p=c.length,_=a^p,b=0;p>=4;)u=1540483477*(65535&(u=255&c.charCodeAt(b)|(255&c.charCodeAt(++b))<<8|(255&c.charCodeAt(++b))<<16|(255&c.charCodeAt(++b))<<24))+((1540483477*(u>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),p-=4,++b;switch(p){case 3:_^=(255&c.charCodeAt(b+2))<<16;case 2:_^=(255&c.charCodeAt(b+1))<<8;case 1:_=1540483477*(65535&(_^=255&c.charCodeAt(b)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};var cn=tx,yM=tv;Up.exports=cn,Qc.murmur3=cn,Qc.murmur2=yM;class nv{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,u,p,_){this.ids.push(FT(a)),this.positions.push(u,p,_)}getPositions(a){const u=FT(a);let p=0,_=this.ids.length-1;for(;p<_;){const w=p+_>>1;this.ids[w]>=u?_=w:p=w+1}const b=[];for(;this.ids[p]===u;)b.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return b}static serialize(a,u){const p=new Float64Array(a.ids),_=new Uint32Array(a.positions);return nx(p,_,0,p.length-1),u&&u.push(p.buffer,_.buffer),{ids:p,positions:_}}static deserialize(a){const u=new nv;return u.ids=a.ids,u.positions=a.positions,u.indexed=!0,u}}function FT(c){const a=+c;return!isNaN(a)&&Number.MIN_SAFE_INTEGER<=a&&a<=Number.MAX_SAFE_INTEGER?a:Qc(String(c))}function nx(c,a,u,p){for(;u<p;){const _=c[u+p>>1];let b=u-1,w=p+1;for(;;){do{b++}while(c[b]<_);do{w--}while(c[w]>_);if(b>=w)break;iv(c,b,w),iv(a,3*b,3*w),iv(a,3*b+1,3*w+1),iv(a,3*b+2,3*w+2)}w-u<p-w?(nx(c,a,u,w),u=w+1):(nx(c,a,w+1,p),p=w)}}function iv(c,a,u){const p=c[a];c[a]=c[u],c[u]=p}dn(nv,"FeaturePositionMap");class ud{constructor(a){this.gl=a.gl,this.initialized=!1}fetchUniformLocation(a,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(a,u),this.initialized=!0),!!this.location}}class ov extends ud{constructor(a){super(a),this.current=0}set(a,u,p){this.fetchUniformLocation(a,u)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class jp extends ud{constructor(a){super(a),this.current=[0,0,0,0]}set(a,u,p){this.fetchUniformLocation(a,u)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class NT extends ud{constructor(a){super(a),this.current=tr.transparent}set(a,u,p){this.fetchUniformLocation(a,u)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const vM=new Float32Array(16),Xr=new Float32Array(9),rv=new Float32Array(4);function bh(c){return[vn(255*c.r,255*c.g),vn(255*c.b,255*c.a)]}class ym{constructor(a,u,p){this.value=a,this.uniformNames=u.map(_=>`u_${_}`),this.type=p}setUniform(a,u,p,_,b){u.set(a,b,_.constantOr(this.value))}getBinding(a,u){return"color"===this.type?new NT(a):new ov(a)}}class vs{constructor(a,u){this.uniformNames=u.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(a){this.pixelRatio=a.pixelRatio||1,this.pattern=a.tl.concat(a.br)}setUniform(a,u,p,_,b){const w="u_pattern"===b||"u_dash"===b?this.pattern:"u_pixel_ratio"===b?this.pixelRatio:null;w&&u.set(a,b,w)}getBinding(a,u){return"u_pattern"===u||"u_dash"===u?new jp(a):new ov(a)}}class qs{constructor(a,u,p,_){this.expression=a,this.type=p,this.maxValue=0,this.paintVertexAttributes=u.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===p?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(a,u,p,_,b,w){const S=this.paintVertexArray.length,I=this.expression.evaluate(new $e(0),u,{},b,_,w);this.paintVertexArray.resize(a),this._setPaintValue(S,a,I)}updatePaintArray(a,u,p,_,b){const w=this.expression.evaluate({zoom:0},p,_,void 0,b);this._setPaintValue(a,u,w)}_setPaintValue(a,u,p){if("color"===this.type){const _=bh(p);for(let b=a;b<u;b++)this.paintVertexArray.emplace(b,_[0],_[1])}else{for(let _=a;_<u;_++)this.paintVertexArray.emplace(_,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class rl{constructor(a,u,p,_,b,w){this.expression=a,this.uniformNames=u.map(S=>`u_${S}_t`),this.type=p,this.useIntegerZoom=_,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=u.map(S=>({name:`a_${S}`,type:"Float32",components:"color"===p?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(a,u,p,_,b,w){const S=this.expression.evaluate(new $e(this.zoom),u,{},b,_,w),I=this.expression.evaluate(new $e(this.zoom+1),u,{},b,_,w),M=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(M,a,S,I)}updatePaintArray(a,u,p,_,b){const w=this.expression.evaluate({zoom:this.zoom},p,_,void 0,b),S=this.expression.evaluate({zoom:this.zoom+1},p,_,void 0,b);this._setPaintValue(a,u,w,S)}_setPaintValue(a,u,p,_){if("color"===this.type){const b=bh(p),w=bh(_);for(let S=a;S<u;S++)this.paintVertexArray.emplace(S,b[0],b[1],w[0],w[1])}else{for(let b=a;b<u;b++)this.paintVertexArray.emplace(b,p,_);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(_))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,u,p,_,b){const w=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,S=Hn(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);u.set(a,b,S)}getBinding(a,u){return new ov(a)}}class Rl{constructor(a,u,p,_,b){this.expression=a,this.layerId=b,this.paintVertexAttributes=("array"===p?ex:Vp).members;for(let w=0;w<u.length;++w);this.paintVertexArray=new _}populatePaintArray(a,u,p){const _=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValues(_,a,u.patterns&&u.patterns[this.layerId],p)}updatePaintArray(a,u,p,_,b,w){this._setPaintValues(a,u,p.patterns&&p.patterns[this.layerId],w)}_setPaintValues(a,u,p,_){if(!_||!p)return;const b=_[p];if(!b)return;const{tl:w,br:S,pixelRatio:I}=b;for(let M=a;M<u;M++)this.paintVertexArray.emplace(M,w[0],w[1],S[0],S[1],I)}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class sl{constructor(a,u,p=(()=>!0)){this.binders={},this._buffers=[];const _=[];for(const b in a.paint._values){if(!p(b))continue;const w=a.paint.get(b);if(!(w instanceof At&&Ml(w.property.specification)))continue;const S=zT(b,a.type),I=w.value,M=w.property.specification.type,z=w.property.useIntegerZoom,j="line-dasharray"===b||b.endsWith("pattern"),H="line-dasharray"===b&&"constant"!==a.layout.get("line-cap").value.kind;if("constant"!==I.kind||H)if("source"===I.kind||H||j){const K=s_(b,M,"source");this.binders[b]=j?new Rl(I,S,M,K,a.id):new qs(I,S,M,K),_.push(`/a_${b}`)}else{const K=s_(b,M,"composite");this.binders[b]=new rl(I,S,M,z,u,K),_.push(`/z_${b}`)}else this.binders[b]=j?new vs(I.value,S):new ym(I.value,S,M),_.push(`/u_${b}`)}this.cacheKey=_.sort().join("")}getMaxValue(a){const u=this.binders[a];return u instanceof qs||u instanceof rl?u.maxValue:0}populatePaintArrays(a,u,p,_,b,w){for(const S in this.binders){const I=this.binders[S];(I instanceof qs||I instanceof rl||I instanceof Rl)&&I.populatePaintArray(a,u,p,_,b,w)}}setConstantPatternPositions(a){for(const u in this.binders){const p=this.binders[u];p instanceof vs&&p.setConstantPatternPositions(a)}}updatePaintArrays(a,u,p,_,b,w){let S=!1;for(const I in a){const M=u.getPositions(I);for(const z of M){const j=p.feature(z.index);for(const H in this.binders){const K=this.binders[H];if((K instanceof qs||K instanceof rl||K instanceof Rl)&&!0===K.expression.isStateDependent){const Y=_.paint.get(H);K.expression=Y.value,K.updatePaintArray(z.start,z.end,j,a[I],b,w),S=!0}}}}return S}defines(){const a=[];for(const u in this.binders){const p=this.binders[u];(p instanceof ym||p instanceof vs)&&a.push(...p.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return a}getBinderAttributes(){const a=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof qs||p instanceof rl||p instanceof Rl)for(let _=0;_<p.paintVertexAttributes.length;_++)a.push(p.paintVertexAttributes[_].name)}return a}getBinderUniforms(){const a=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof ym||p instanceof vs||p instanceof rl)for(const _ of p.uniformNames)a.push(_)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a){const u=[];for(const p in this.binders){const _=this.binders[p];if(_ instanceof ym||_ instanceof vs||_ instanceof rl)for(const b of _.uniformNames)u.push({name:b,property:p,binding:_.getBinding(a,b)})}return u}setUniforms(a,u,p,_,b){for(const{name:w,property:S,binding:I}of p)this.binders[S].setUniform(a,I,b,_.get(S),w)}updatePaintBuffers(){this._buffers=[];for(const a in this.binders){const u=this.binders[a];(u instanceof qs||u instanceof rl||u instanceof Rl)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(a){for(const u in this.binders){const p=this.binders[u];(p instanceof qs||p instanceof rl||p instanceof Rl)&&p.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const u=this.binders[a];(u instanceof qs||u instanceof rl||u instanceof Rl)&&u.destroy()}}}class xh{constructor(a,u,p=(()=>!0)){this.programConfigurations={};for(const _ of a)this.programConfigurations[_.id]=new sl(_,u,p);this.needsUpload=!1,this._featureMap=new nv,this._bufferOffset=0}populatePaintArrays(a,u,p,_,b,w,S){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(a,u,_,b,w,S);void 0!==u.id&&this._featureMap.add(u.id,p,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,u,p,_,b){for(const w of p)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(a,this._featureMap,u,w,_,b)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}const bM={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function zT(c,a){return bM[c]||[c.replace(`${a}-`,"").replace(/-/g,"_")]}const xM={"line-pattern":{source:cr,composite:cr},"fill-pattern":{source:cr,composite:cr},"fill-extrusion-pattern":{source:cr,composite:cr},"line-dasharray":{source:ys,composite:ys}},Aa={color:{source:cd,composite:io},number:{source:Ls,composite:cd}};function s_(c,a,u){const p=xM[c];return p&&p[u]||Aa[a][u]}dn(ym,"ConstantBinder"),dn(vs,"PatternConstantBinder"),dn(qs,"SourceExpressionBinder"),dn(Rl,"PatternCompositeBinder"),dn(rl,"CompositeExpressionBinder"),dn(sl,"ProgramConfiguration",{omit:["_buffers"]}),dn(xh,"ProgramConfigurationSet");const Jc="-transition";class oc extends Ya{constructor(a,u){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==a.type&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,"background"!==a.type&&"sky"!==a.type&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),u.layout&&(this._unevaluatedLayout=new dt(u.layout)),u.paint)){this._transitionablePaint=new Vt(u.paint);for(const p in a.paint)this.setPaintProperty(p,a.paint[p],{validate:!1});for(const p in a.layout)this.setLayoutProperty(p,a.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ot(u.paint)}}getLayoutProperty(a){return"visibility"===a?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,u,p={}){null!=u&&this._validate(Rp,`layers.${this.id}.layout.${a}`,a,u,p)||("visibility"!==a?this._unevaluatedLayout.setValue(a,u):this.visibility=u)}getPaintProperty(a){return js(a,Jc)?this._transitionablePaint.getTransition(a.slice(0,-Jc.length)):this._transitionablePaint.getValue(a)}setPaintProperty(a,u,p={}){if(null!=u&&this._validate(e_,`layers.${this.id}.paint.${a}`,a,u,p))return!1;if(js(a,Jc))return this._transitionablePaint.setTransition(a.slice(0,-Jc.length),u||void 0),!1;{const _=this._transitionablePaint._values[a],b=_.value.isDataDriven(),w=_.value;this._transitionablePaint.setValue(a,u),this._handleSpecialPaintPropertyUpdate(a);const S=this._transitionablePaint._values[a].value,I=S.isDataDriven(),M=js(a,"pattern")||"line-dasharray"===a;return I||b||M||this._handleOverridablePaintPropertyUpdate(a,w,S)}}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getProgramConfiguration(a){return null}_handleOverridablePaintPropertyUpdate(a,u,p){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||"none"===this.visibility}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,u)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),ii(a,(u,p)=>!(void 0===u||"layout"===p&&!Object.keys(u).length||"paint"===p&&!Object.keys(u).length))}_validate(a,u,p,_,b={}){return(!b||!1!==b.validate)&&pm(this,a.call(Al,{key:u,layerType:this.type,objectKey:p,value:_,styleSpec:yt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const u=this.paint.get(a);if(u instanceof At&&Ml(u.property.specification)&&("source"===u.value.kind||"composite"===u.value.kind)&&u.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=am(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const ix=Sn([{name:"a_pos",components:2,type:"Int16"}],4),BT=Sn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ir{constructor(a=[]){this.segments=a}prepareSegment(a,u,p,_){let b=this.segments[this.segments.length-1];return a>ir.MAX_VERTEX_ARRAY_LENGTH&&Mo(`Max vertices per segment is ${ir.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!b||b.vertexLength+a>ir.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==_)&&(b={vertexOffset:u.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},void 0!==_&&(b.sortKey=_),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const a of this.segments)for(const u in a.vaos)a.vaos[u].destroy()}static simpleSegment(a,u,p,_){return new ir([{vertexOffset:a,primitiveOffset:u,vertexLength:p,primitiveLength:_,vaos:{},sortKey:0}])}}ir.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn(ir,"SegmentVector");var Gn=8192;class dd{constructor(a,u){a&&(u?this.setSouthWest(a).setNorthEast(u):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof Oi?new Oi(a.lng,a.lat):Oi.convert(a),this}setSouthWest(a){return this._sw=a instanceof Oi?new Oi(a.lng,a.lat):Oi.convert(a),this}extend(a){const u=this._sw,p=this._ne;let _,b;if(a instanceof Oi)_=a,b=a;else{if(!(a instanceof dd))return Array.isArray(a)?4===a.length||a.every(Array.isArray)?this.extend(dd.convert(a)):this.extend(Oi.convert(a)):"object"==typeof a&&null!==a&&a.hasOwnProperty("lat")&&a.hasOwnProperty("lon")?this.extend(Oi.convert(a)):this;if(_=a._sw,b=a._ne,!_||!b)return this}return u||p?(u.lng=Math.min(_.lng,u.lng),u.lat=Math.min(_.lat,u.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new Oi(_.lng,_.lat),this._ne=new Oi(b.lng,b.lat)),this}getCenter(){return new Oi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Oi(this.getWest(),this.getNorth())}getSouthEast(){return new Oi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:u,lat:p}=Oi.convert(a);let _=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(a){return!a||a instanceof dd?a:new dd(a)}}var a_=1e-6,ca=typeof Float32Array<"u"?Float32Array:Array;function l_(){var c=new ca(9);return ca!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function vm(c,a,u){var p=a[0],_=a[1],b=a[2],w=a[3],S=a[4],I=a[5],M=a[6],z=a[7],j=a[8],H=u[0],K=u[1],Y=u[2],te=u[3],ae=u[4],we=u[5],ke=u[6],me=u[7],Se=u[8];return c[0]=H*p+K*w+Y*M,c[1]=H*_+K*S+Y*z,c[2]=H*b+K*I+Y*j,c[3]=te*p+ae*w+we*M,c[4]=te*_+ae*S+we*z,c[5]=te*b+ae*I+we*j,c[6]=ke*p+me*w+Se*M,c[7]=ke*_+me*S+Se*z,c[8]=ke*b+me*I+Se*j,c}function Pa(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function rc(c,a){var u=a[0],p=a[1],_=a[2],b=a[3],w=a[4],S=a[5],I=a[6],M=a[7],z=a[8],j=a[9],H=a[10],K=a[11],Y=a[12],te=a[13],ae=a[14],we=a[15],ke=u*S-p*w,me=u*I-_*w,Se=u*M-b*w,Oe=p*I-_*S,De=p*M-b*S,tt=_*M-b*I,Qe=z*te-j*Y,mt=z*ae-H*Y,at=z*we-K*Y,lt=j*ae-H*te,bt=j*we-K*te,xt=H*we-K*ae,Mt=ke*xt-me*bt+Se*lt+Oe*at-De*mt+tt*Qe;return Mt?(c[0]=(S*xt-I*bt+M*lt)*(Mt=1/Mt),c[1]=(_*bt-p*xt-b*lt)*Mt,c[2]=(te*tt-ae*De+we*Oe)*Mt,c[3]=(H*De-j*tt-K*Oe)*Mt,c[4]=(I*at-w*xt-M*mt)*Mt,c[5]=(u*xt-_*at+b*mt)*Mt,c[6]=(ae*Se-Y*tt-we*me)*Mt,c[7]=(z*tt-H*Se+K*me)*Mt,c[8]=(w*bt-S*at+M*Qe)*Mt,c[9]=(p*at-u*bt-b*Qe)*Mt,c[10]=(Y*De-te*Se+we*ke)*Mt,c[11]=(j*Se-z*De-K*ke)*Mt,c[12]=(S*mt-w*lt-I*Qe)*Mt,c[13]=(u*lt-p*mt+_*Qe)*Mt,c[14]=(te*me-Y*Oe-ae*ke)*Mt,c[15]=(z*Oe-j*me+H*ke)*Mt,c):null}function hd(c,a,u){var p=a[0],_=a[1],b=a[2],w=a[3],S=a[4],I=a[5],M=a[6],z=a[7],j=a[8],H=a[9],K=a[10],Y=a[11],te=a[12],ae=a[13],we=a[14],ke=a[15],me=u[0],Se=u[1],Oe=u[2],De=u[3];return c[0]=me*p+Se*S+Oe*j+De*te,c[1]=me*_+Se*I+Oe*H+De*ae,c[2]=me*b+Se*M+Oe*K+De*we,c[3]=me*w+Se*z+Oe*Y+De*ke,c[4]=(me=u[4])*p+(Se=u[5])*S+(Oe=u[6])*j+(De=u[7])*te,c[5]=me*_+Se*I+Oe*H+De*ae,c[6]=me*b+Se*M+Oe*K+De*we,c[7]=me*w+Se*z+Oe*Y+De*ke,c[8]=(me=u[8])*p+(Se=u[9])*S+(Oe=u[10])*j+(De=u[11])*te,c[9]=me*_+Se*I+Oe*H+De*ae,c[10]=me*b+Se*M+Oe*K+De*we,c[11]=me*w+Se*z+Oe*Y+De*ke,c[12]=(me=u[12])*p+(Se=u[13])*S+(Oe=u[14])*j+(De=u[15])*te,c[13]=me*_+Se*I+Oe*H+De*ae,c[14]=me*b+Se*M+Oe*K+De*we,c[15]=me*w+Se*z+Oe*Y+De*ke,c}function sc(c,a,u){var p,_,b,w,S,I,M,z,j,H,K,Y,te=u[0],ae=u[1],we=u[2];return a===c?(c[12]=a[0]*te+a[4]*ae+a[8]*we+a[12],c[13]=a[1]*te+a[5]*ae+a[9]*we+a[13],c[14]=a[2]*te+a[6]*ae+a[10]*we+a[14],c[15]=a[3]*te+a[7]*ae+a[11]*we+a[15]):(_=a[1],b=a[2],w=a[3],S=a[4],I=a[5],M=a[6],z=a[7],j=a[8],H=a[9],K=a[10],Y=a[11],c[0]=p=a[0],c[1]=_,c[2]=b,c[3]=w,c[4]=S,c[5]=I,c[6]=M,c[7]=z,c[8]=j,c[9]=H,c[10]=K,c[11]=Y,c[12]=p*te+S*ae+j*we+a[12],c[13]=_*te+I*ae+H*we+a[13],c[14]=b*te+M*ae+K*we+a[14],c[15]=w*te+z*ae+Y*we+a[15]),c}function wh(c,a,u){var p=u[0],_=u[1],b=u[2];return c[0]=a[0]*p,c[1]=a[1]*p,c[2]=a[2]*p,c[3]=a[3]*p,c[4]=a[4]*_,c[5]=a[5]*_,c[6]=a[6]*_,c[7]=a[7]*_,c[8]=a[8]*b,c[9]=a[9]*b,c[10]=a[10]*b,c[11]=a[11]*b,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c}function c_(c,a,u){var p=Math.sin(u),_=Math.cos(u),b=a[4],w=a[5],S=a[6],I=a[7],M=a[8],z=a[9],j=a[10],H=a[11];return a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[4]=b*_+M*p,c[5]=w*_+z*p,c[6]=S*_+j*p,c[7]=I*_+H*p,c[8]=M*_-b*p,c[9]=z*_-w*p,c[10]=j*_-S*p,c[11]=H*_-I*p,c}function pd(c,a,u){var p=Math.sin(u),_=Math.cos(u),b=a[0],w=a[1],S=a[2],I=a[3],M=a[8],z=a[9],j=a[10],H=a[11];return a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=b*_-M*p,c[1]=w*_-z*p,c[2]=S*_-j*p,c[3]=I*_-H*p,c[8]=b*p+M*_,c[9]=w*p+z*_,c[10]=S*p+j*_,c[11]=I*p+H*_,c}function bm(c,a){return c[0]=a[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=a[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function sv(c,a,u){var p,_,b,w=u[0],S=u[1],I=u[2],M=Math.hypot(w,S,I);return M<a_?null:(w*=M=1/M,S*=M,I*=M,p=Math.sin(a),_=Math.cos(a),c[0]=w*w*(b=1-_)+_,c[1]=S*w*b+I*p,c[2]=I*w*b-S*p,c[3]=0,c[4]=w*S*b-I*p,c[5]=S*S*b+_,c[6]=I*S*b+w*p,c[7]=0,c[8]=w*I*b+S*p,c[9]=S*I*b-w*p,c[10]=I*I*b+_,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}Math.hypot||(Math.hypot=function(){for(var c=0,a=arguments.length;a--;)c+=arguments[a]*arguments[a];return Math.sqrt(c)});var VT=hd;function av(){var c=new ca(3);return ca!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function Ch(c){var a=new ca(3);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a}function eu(c){return Math.hypot(c[0],c[1],c[2])}function Hp(c,a,u){var p=new ca(3);return p[0]=c,p[1]=a,p[2]=u,p}function fd(c,a,u){return c[0]=a[0]+u[0],c[1]=a[1]+u[1],c[2]=a[2]+u[2],c}function u_(c,a,u){return c[0]=a[0]-u[0],c[1]=a[1]-u[1],c[2]=a[2]-u[2],c}function ox(c,a,u){return c[0]=a[0]*u[0],c[1]=a[1]*u[1],c[2]=a[2]*u[2],c}function d_(c,a,u){return c[0]=Math.min(a[0],u[0]),c[1]=Math.min(a[1],u[1]),c[2]=Math.min(a[2],u[2]),c}function xm(c,a,u){return c[0]=Math.max(a[0],u[0]),c[1]=Math.max(a[1],u[1]),c[2]=Math.max(a[2],u[2]),c}function Oa(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c}function wm(c,a,u,p){return c[0]=a[0]+u[0]*p,c[1]=a[1]+u[1]*p,c[2]=a[2]+u[2]*p,c}function Yr(c,a){var u=a[0],p=a[1],_=a[2],b=u*u+p*p+_*_;return b>0&&(b=1/Math.sqrt(b)),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c}function La(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]}function lv(c,a,u){var p=a[0],_=a[1],b=a[2],w=u[0],S=u[1],I=u[2];return c[0]=_*I-b*S,c[1]=b*w-p*I,c[2]=p*S-_*w,c}function Wo(c,a,u){var p=a[0],_=a[1],b=a[2],w=u[3]*p+u[7]*_+u[11]*b+u[15];return c[0]=(u[0]*p+u[4]*_+u[8]*b+u[12])/(w=w||1),c[1]=(u[1]*p+u[5]*_+u[9]*b+u[13])/w,c[2]=(u[2]*p+u[6]*_+u[10]*b+u[14])/w,c}function UT(c,a,u){var p=u[0],_=u[1],b=u[2],w=a[0],S=a[1],I=a[2],M=_*I-b*S,z=b*w-p*I,j=p*S-_*w,H=_*j-b*z,K=b*M-p*j,Y=p*z-_*M,te=2*u[3];return z*=te,j*=te,K*=2,Y*=2,c[0]=w+(M*=te)+(H*=2),c[1]=S+z+K,c[2]=I+j+Y,c}var $p,ac=u_,jT=ox,HT=eu;function h_(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c[3]=a[3]*u,c}function $T(c,a){var u=a[0],p=a[1],_=a[2],b=a[3],w=u*u+p*p+_*_+b*b;return w>0&&(w=1/Math.sqrt(w)),c[0]=u*w,c[1]=p*w,c[2]=_*w,c[3]=b*w,c}function Gp(c,a,u){var p=a[0],_=a[1],b=a[2],w=a[3];return c[0]=u[0]*p+u[4]*_+u[8]*b+u[12]*w,c[1]=u[1]*p+u[5]*_+u[9]*b+u[13]*w,c[2]=u[2]*p+u[6]*_+u[10]*b+u[14]*w,c[3]=u[3]*p+u[7]*_+u[11]*b+u[15]*w,c}function p_(){var c=new ca(4);return ca!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function GT(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function WT(c,a,u){u*=.5;var p=a[0],_=a[1],b=a[2],w=a[3],S=Math.sin(u),I=Math.cos(u);return c[0]=p*I+w*S,c[1]=_*I+b*S,c[2]=b*I-_*S,c[3]=w*I-p*S,c}function qT(c,a,u){u*=.5;var p=a[0],_=a[1],b=a[2],w=a[3],S=Math.sin(u),I=Math.cos(u);return c[0]=p*I-b*S,c[1]=_*I+w*S,c[2]=b*I+p*S,c[3]=w*I-_*S,c}av(),$p=new ca(4),ca!=Float32Array&&($p[0]=0,$p[1]=0,$p[2]=0,$p[3]=0);var wM=$T;av(),Hp(1,0,0),Hp(0,1,0),p_(),p_(),l_();const CM=Sn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:rx}=CM,cv=Sn([{name:"a_pos_3",components:3,type:"Int16"}]);var Th=Sn([{name:"a_pos",type:"Int16",components:2}]);class f_{constructor(a,u){this.pos=a,this.dir=u}intersectsPlane(a,u,p){const _=La(u,this.dir);if(Math.abs(_)<1e-6)return!1;const b=((a[0]-this.pos[0])*u[0]+(a[1]-this.pos[1])*u[1]+(a[2]-this.pos[2])*u[2])/_;return p[0]=this.pos[0]+this.dir[0]*b,p[1]=this.pos[1]+this.dir[1]*b,p[2]=this.pos[2]+this.dir[2]*b,!0}closestPointOnSphere(a,u,p){if(te=(K=this.pos)[0],ae=K[1],we=K[2],ke=(Y=a)[0],me=Y[1],Se=Y[2],Math.abs(te-ke)<=a_*Math.max(1,Math.abs(te),Math.abs(ke))&&Math.abs(ae-me)<=a_*Math.max(1,Math.abs(ae),Math.abs(me))&&Math.abs(we-Se)<=a_*Math.max(1,Math.abs(we),Math.abs(Se))||0===u)return p[0]=p[1]=p[2]=0,!1;var K,Y,te,ae,we,ke,me,Se;const[_,b,w]=this.dir,S=this.pos[0]-a[0],I=this.pos[1]-a[1],M=this.pos[2]-a[2],z=_*_+b*b+w*w,j=2*(S*_+I*b+M*w),H=j*j-4*z*(S*S+I*I+M*M-u*u);if(H<0){const K=Math.max(-j/2,0),Y=S+_*K,te=I+b*K,ae=M+w*K,we=Math.hypot(Y,te,ae);return p[0]=Y*u/we,p[1]=te*u/we,p[2]=ae*u/we,!1}{const K=(-j-Math.sqrt(H))/(2*z);if(K<0){const Y=Math.hypot(S,I,M);return p[0]=S*u/Y,p[1]=I*u/Y,p[2]=M*u/Y,!1}return p[0]=S+_*K,p[1]=I+b*K,p[2]=M+w*K,!0}}}class m_{constructor(a,u,p,_,b){this.TL=a,this.TR=u,this.BR=p,this.BL=_,this.horizon=b}static fromInvProjectionMatrix(a,u,p){const _=[-1,1,1],b=[1,1,1],w=[1,-1,1],S=[-1,-1,1],I=Wo(_,_,a),M=Wo(b,b,a),z=Wo(w,w,a),j=Wo(S,S,a);return new m_(I,M,z,j,u/p)}}class g_{constructor(a,u){this.points=a,this.planes=u}static fromInvProjectionMatrix(a,u,p,_){const b=Math.pow(2,p),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const M=Gp([],I,a),z=1/M[3]/u*b;return(j=M)[0]=(H=M)[0]*(K=[z,z,_?1/M[3]:z,z])[0],j[1]=H[1]*K[1],j[2]=H[2]*K[2],j[3]=H[3]*K[3],j;var j,H,K}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const M=Yr([],lv([],ac([],w[I[0]],w[I[1]]),ac([],w[I[2]],w[I[1]]))),z=-La(M,w[I[1]]);return M.concat(z)});return new g_(w,S)}}class Po{static fromPoints(a){const u=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const _ of a)d_(u,u,_),xm(p,p,_);return new Po(u,p)}static applyTransform(a,u){const p=a.getCorners();for(let _=0;_<p.length;++_)Wo(p[_],p[_],u);return Po.fromPoints(p)}constructor(a,u){this.min=a,this.max=u,this.center=Oa([],fd([],this.min,this.max),.5)}quadrant(a){const u=[a%2==0,a<2],p=Ch(this.min),_=Ch(this.max);for(let b=0;b<u.length;b++)p[b]=u[b]?this.min[b]:this.center[b],_[b]=u[b]?this.center[b]:this.max[b];return _[2]=this.max[2],new Po(p,_)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}distanceZ(a){return Math.max(Math.min(this.max[2],a[2]),this.min[2])-a[2]}getCorners(){const a=this.min,u=this.max;return[[a[0],a[1],a[2]],[u[0],a[1],a[2]],[u[0],u[1],a[2]],[a[0],u[1],a[2]],[a[0],a[1],u[2]],[u[0],a[1],u[2]],[u[0],u[1],u[2]],[a[0],u[1],u[2]]]}intersects(a){const u=this.getCorners();let p=!0;for(let _=0;_<a.planes.length;_++){const b=a.planes[_];let w=0;for(let S=0;S<u.length;S++)w+=La(b,u[S])+b[3]>=0;if(0===w)return 0;w!==u.length&&(p=!1)}if(p)return 2;for(let _=0;_<3;_++){let b=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let S=0;S<a.points.length;S++){const I=a.points[S][_]-this.min[_];b=Math.min(b,I),w=Math.max(w,I)}if(w<0||b>this.max[_]-this.min[_])return 0}return 1}}const lc=Gn/Math.PI/2,Cm=[64,32,16],Ra=-lc,ua=lc,ZT=[new Po([Ra,Ra,Ra],[ua,ua,ua]),new Po([Ra,Ra,Ra],[0,0,ua]),new Po([0,Ra,Ra],[ua,0,ua]),new Po([Ra,0,Ra],[0,ua,ua]),new Po([0,0,Ra],[ua,ua,ua])];function __(c){return c*lc/Dm}function sx(c,a,u,p=!0){const _=Oa([],c._camera.position,c.worldSize),b=[a,u,1,1];Gp(b,b,c.pixelMatrixInverse),h_(b,b,1/b[3]);const w=Yr([],ac([],b,_)),S=c.globeMatrix,I=[S[12],S[13],S[14]],M=ac([],I,_),z=eu(M),j=Yr([],M),H=c.worldSize/(2*Math.PI),K=La(j,w),Y=Math.asin(H/z);if(Y<Math.acos(K)){if(!p)return null;const at=[],lt=[];Oa(at,w,z/K),Yr(lt,ac(lt,at,M)),Yr(w,fd(w,M,Oa(w,lt,Math.tan(Y)*z)))}const te=[];new f_(_,w).closestPointOnSphere(I,H,te);const ae=Yr([],Ou(S,0)),we=Yr([],Ou(S,1)),ke=Yr([],Ou(S,2)),me=La(ae,te),Se=La(we,te),Oe=La(ke,te),De=Lt(Math.asin(-Se/H));let tt=Lt(Math.atan2(me,Oe));tt=c.center.lng+function(at,lt){const bt=(lt-at+180)%360-180;return bt<-180?bt+360:bt}(c.center.lng,tt);const Qe=Fl(tt),mt=Hn(Zs(De),0,1);return new Zp(Qe,mt)}class ax{constructor(a,u,p){this.a=ac([],a,p),this.b=ac([],u,p),this.center=p;const _=Yr([],this.a),b=Yr([],this.b);this.angle=Math.acos(La(_,b))}}function uv(c,a){if(0===c.angle)return null;let u;return u=0===c.a[a]?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[a]/c.a[a]/Math.sin(c.angle)-1/Math.tan(c.angle)),u<0||u>1?null:function(p,_,b,w){const S=Math.sin(b);return p*(Math.sin((1-w)*b)/S)+_*(Math.sin(w*b)/S)}(c.a[a],c.b[a],c.angle,Hn(u,0,1))+c.center[a]}function cc(c){if(c.z<=1)return ZT[c.z+2*c.y+c.x];const a=Eh(Qr(c));return Po.fromPoints(a)}function Lr(c,a,u){return Oa(c,c,1-u),wm(c,c,a,u)}function y_(c,a){const u=qp(a.zoom);if(0===u)return cc(c);const p=Qr(c),_=Eh(p),b=Fl(p.getWest())*a.worldSize,w=Fl(p.getEast())*a.worldSize,S=Zs(p.getNorth())*a.worldSize,I=Zs(p.getSouth())*a.worldSize,M=[b,S,0],z=[w,S,0],j=[b,I,0],H=[w,I,0],K=rc([],a.globeMatrix);return Wo(M,M,K),Wo(z,z,K),Wo(j,j,K),Wo(H,H,K),_[0]=Lr(_[0],j,u),_[1]=Lr(_[1],H,u),_[2]=Lr(_[2],z,u),_[3]=Lr(_[3],M,u),Po.fromPoints(_)}function dv(c,a,u){for(const p of c)Wo(p,p,a),Oa(p,p,u)}function Qr({x:c,y:a,z:u}){const p=1/(1<<u),_=new Oi(da(c*p),ls((a+1)*p)),b=new Oi(da((c+1)*p),ls(a*p));return new dd(_,b)}function Eh(c){const a=wt(c.getNorth()),u=wt(c.getSouth()),p=Math.cos(a),_=Math.cos(u),b=Math.sin(a),w=Math.sin(u),S=c.getWest(),I=c.getEast();return[Ih(_,w,S),Ih(_,w,I),Ih(p,b,I),Ih(p,b,S)]}function Ih(c,a,u,p=lc){return u=wt(u),[c*Math.sin(u)*p,-a*p,c*Math.cos(u)*p]}function Dh(c,a,u){return Ih(Math.cos(wt(c)),Math.sin(wt(c)),a,u)}function Tm(c,a,u,p){const _=1<<u.z,b=(c/Gn+u.x)/_;return Dh(ls((a/Gn+u.y)/_),da(b),p)}function Sm({min:c,max:a}){return 16383/Math.max(a[0]-c[0],a[1]-c[1],a[2]-c[2])}const lx=new Float64Array(16);function Wp(c){const a=Sm(c),u=bm(lx,[a,a,a]);return sc(u,u,((p=[])[0]=-(_=c.min)[0],p[1]=-_[1],p[2]=-_[2],p));var p,_}function pv(c){const a=(p=c.min,(u=lx)[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=p[0],u[13]=p[1],u[14]=p[2],u[15]=1,u);var u,p;const _=1/Sm(c);return wh(a,a,[_,_,_])}function fv(c,a,u,p,_){const b=function(I){const M=Gn/(2*Math.PI);return I/(2*Math.PI)/M}(u),w=[c,a,-u/(2*Math.PI)],S=Pa(new Float64Array(16));return sc(S,S,w),wh(S,S,[b,b,b]),c_(S,S,wt(-_)),pd(S,S,wt(-p)),S}function qp(c){return Mr(5,6,c)}function cx(c,a){const u=Dh(a.lat,a.lng);return w=(_=u_([],function(Y){const te=Dh(Y._center.lat,Y._center.lng);let ae=lv([],Hp(0,1,0),te);const we=sv([],-Y.angle,te);ae=Wo(ae,ae,we),sv(we,-Y._pitch,ae);const ke=Yr([],te);return Oa(ke,ke,__(Y.cameraToCenterDistance/Y.pixelsPerMeter)),Wo(ke,ke,we),fd([],te,ke)}(c),u))[0],S=_[1],I=_[2],M=(b=u)[0],z=b[1],j=b[2],K=(H=Math.sqrt(w*w+S*S+I*I)*Math.sqrt(M*M+z*z+j*j))&&La(_,b)/H,Math.acos(Math.min(Math.max(K,-1),1));var _,b,w,S,I,M,z,j,H,K}function Em(c,a){return cx(c,a)>Math.PI/2*1.01}const v_=wt(85),KT=Math.cos(v_),Im=Math.sin(v_),Dm=6371008.8,ux=2*Math.PI*Dm;class Oi{constructor(a,u){if(isNaN(a)||isNaN(u))throw new Error(`Invalid LngLat object: (${a}, ${u})`);if(this.lng=+a,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Oi(mr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const u=Math.PI/180,p=this.lat*u,_=a.lat*u,b=Math.sin(p)*Math.sin(_)+Math.cos(p)*Math.cos(_)*Math.cos((a.lng-this.lng)*u);return Dm*Math.acos(Math.min(b,1))}toBounds(a=0){const u=360*a/40075017,p=u/Math.cos(Math.PI/180*this.lat);return new dd(new Oi(this.lng-p,this.lat-u),new Oi(this.lng+p,this.lat+u))}toEcef(a){const u=__(a);return Dh(this.lat,this.lng,lc+u)}static convert(a){if(a instanceof Oi)return a;if(Array.isArray(a)&&(2===a.length||3===a.length))return new Oi(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"==typeof a&&null!==a)return new Oi(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Mm(c){return ux*Math.cos(c*Math.PI/180)}function Fl(c){return(180+c)/360}function Zs(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Fa(c,a){return c/Mm(a)}function da(c){return 360*c-180}function ls(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function b_(c,a){return c*Mm(ls(a))}const cs=85.051129;function dx(c){return 1/Math.cos(c*Math.PI/180)}class Zp{constructor(a,u,p=0){this.x=+a,this.y=+u,this.z=+p}static fromLngLat(a,u=0){const p=Oi.convert(a);return new Zp(Fl(p.lng),Zs(p.lat),Fa(u,p.lat))}toLngLat(){return new Oi(da(this.x),ls(this.y))}toAltitude(){return b_(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ux*dx(ls(this.y))}}function mv(c,a,u,p,_,b,w,S,I){const M=(a+p)/2,z=(u+_)/2,j=new Ue(M,z);S(j),function(H,K,Y,te,ae,we){const ke=Y-ae,me=te-we;return Math.abs((te-K)*ke-(Y-H)*me)/Math.hypot(ke,me)}(j.x,j.y,b.x,b.y,w.x,w.y)>=I?(mv(c,a,u,M,z,b,j,S,I),mv(c,M,z,p,_,j,w,S,I)):c.push(w)}function hx(c,a,u){let p=c[0],_=p.x,b=p.y;a(p);const w=[p];for(let S=1;S<c.length;S++){const I=c[S],{x:M,y:z}=I;a(I),mv(w,_,b,M,z,p,I,a,u),_=M,b=z,p=I}return w}function gv(c,a,u,p){if(p(a,u)){const _=a.add(u)._mult(.5);gv(c,a,_,p),gv(c,_,u,p)}else c.push(u)}function px(c,a){let u=c[0];const p=[u];for(let _=1;_<c.length;_++){const b=c[_];gv(p,u,b,a),u=b}return p}const km=Math.pow(2,14)-1,_v=-km-1;function yv(c,a){const u=Math.round(c.x*a),p=Math.round(c.y*a);return c.x=Hn(u,_v,km),c.y=Hn(p,_v,km),(u<c.x||u>c.x+1||p<c.y||p>c.y+1)&&Mo("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function tu(c,a,u){const p=c.loadGeometry(),_=c.extent,b=Gn/_;if(a&&u&&u.projection.isReprojectedInTileSpace){const w=1<<a.z,{scale:S,x:I,y:M,projection:z}=u,j=H=>{const K=da((a.x+H.x/_)/w),Y=ls((a.y+H.y/_)/w),te=z.project(K,Y);H.x=(te.x*S-I)*_,H.y=(te.y*S-M)*_};for(let H=0;H<p.length;H++)if(1!==c.type)p[H]=hx(p[H],j,1);else{const K=[];for(const Y of p[H])Y.x<0||Y.x>=_||Y.y<0||Y.y>=_||(j(Y),K.push(Y));p[H]=K}}for(const w of p)for(const S of w)yv(S,b);return p}function Mh(c,a){return{type:c.type,id:c.id,properties:c.properties,geometry:a?tu(c):[]}}function Am(c,a,u,p,_){c.emplaceBack(2*a+(p+1)/2,2*u+(_+1)/2)}function Pm(c,a,u){c.emplaceBack(a.x,a.y,a.z,16384*u[0],16384*u[1],16384*u[2])}class nu{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.projection=a.projection,this.layoutVertexArray=new In,this.indexArray=new as,this.segments=new ir,this.programConfigurations=new xh(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,p,_){const b=this.layers[0],w=[];let S=null;"circle"===b.type&&(S=b.layout.get("circle-sort-key"));for(const{feature:M,id:z,index:j,sourceLayerIndex:H}of a){const K=this.layers[0]._featureFilter.needGeometry,Y=Mh(M,K);if(!this.layers[0]._featureFilter.filter(new $e(this.zoom),Y,p))continue;const te=S?S.evaluate(Y,{},p):void 0,ae={id:z,properties:M.properties,type:M.type,sourceLayerIndex:H,index:j,geometry:K?Y.geometry:tu(M,p,_),patterns:{},sortKey:te};w.push(ae)}S&&w.sort((M,z)=>M.sortKey-z.sortKey);let I=null;"globe"===_.projection.name&&(this.globeExtVertexArray=new la,I=_.projection);for(const M of w){const{geometry:z,index:j,sourceLayerIndex:H}=M,K=a[j].feature;this.addFeature(M,z,j,u.availableImages,p,I),u.featureIndex.insert(K,z,j,H,this.index)}}update(a,u,p,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,p,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ix.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,BT.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(a,u,p,_,b,w){for(const S of u)for(const I of S){const M=I.x,z=I.y;if(M<0||M>=Gn||z<0||z>=Gn)continue;if(w){const K=w.projectTilePoint(M,z,b),Y=w.upVector(b,M,z),te=this.globeExtVertexArray;Pm(te,K,Y),Pm(te,K,Y),Pm(te,K,Y),Pm(te,K,Y)}const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),H=j.vertexLength;Am(this.layoutVertexArray,M,z,-1,-1),Am(this.layoutVertexArray,M,z,1,-1),Am(this.layoutVertexArray,M,z,1,1),Am(this.layoutVertexArray,M,z,-1,1),this.indexArray.emplaceBack(H,H+1,H+2),this.indexArray.emplaceBack(H,H+2,H+3),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,{},_,b)}}function vv(c,a){for(let u=0;u<c.length;u++)if(iu(a,c[u]))return!0;for(let u=0;u<a.length;u++)if(iu(c,a[u]))return!0;return!!Kp(c,a)}function fx(c,a,u){return!!iu(c,a)||!!x_(a,c,u)}function mx(c,a){if(1===c.length)return xv(a,c[0]);for(let u=0;u<a.length;u++){const p=a[u];for(let _=0;_<p.length;_++)if(iu(c,p[_]))return!0}for(let u=0;u<c.length;u++)if(xv(a,c[u]))return!0;for(let u=0;u<a.length;u++)if(Kp(c,a[u]))return!0;return!1}function TM(c,a,u){if(c.length>1){if(Kp(c,a))return!0;for(let p=0;p<a.length;p++)if(x_(a[p],c,u))return!0}for(let p=0;p<c.length;p++)if(x_(c[p],a,u))return!0;return!1}function Kp(c,a){if(0===c.length||0===a.length)return!1;for(let u=0;u<c.length-1;u++){const p=c[u],_=c[u+1];for(let b=0;b<a.length-1;b++)if(XT(p,_,a[b],a[b+1]))return!0}return!1}function XT(c,a,u,p){return Wa(c,u,p)!==Wa(a,u,p)&&Wa(c,a,u)!==Wa(c,a,p)}function x_(c,a,u){const p=u*u;if(1===a.length)return c.distSqr(a[0])<p;for(let _=1;_<a.length;_++)if(bv(c,a[_-1],a[_])<p)return!0;return!1}function bv(c,a,u){const p=a.distSqr(u);if(0===p)return c.distSqr(a);const _=((c.x-a.x)*(u.x-a.x)+(c.y-a.y)*(u.y-a.y))/p;return c.distSqr(_<0?a:_>1?u:u.sub(a)._mult(_)._add(a))}function xv(c,a){let u,p,_,b=!1;for(let w=0;w<c.length;w++){u=c[w];for(let S=0,I=u.length-1;S<u.length;I=S++)p=u[S],_=u[I],p.y>a.y!=_.y>a.y&&a.x<(_.x-p.x)*(a.y-p.y)/(_.y-p.y)+p.x&&(b=!b)}return b}function iu(c,a){let u=!1;for(let p=0,_=c.length-1;p<c.length;_=p++){const b=c[p],w=c[_];b.y>a.y!=w.y>a.y&&a.x<(w.x-b.x)*(a.y-b.y)/(w.y-b.y)+b.x&&(u=!u)}return u}function wv(c,a,u,p,_){for(const w of c)if(a<=w.x&&u<=w.y&&p>=w.x&&_>=w.y)return!0;const b=[new Ue(a,u),new Ue(a,_),new Ue(p,_),new Ue(p,u)];if(c.length>2)for(const w of b)if(iu(c,w))return!0;for(let w=0;w<c.length-1;w++)if(w_(c[w],c[w+1],b))return!0;return!1}function w_(c,a,u){const p=u[0],_=u[2];if(c.x<p.x&&a.x<p.x||c.x>_.x&&a.x>_.x||c.y<p.y&&a.y<p.y||c.y>_.y&&a.y>_.y)return!1;const b=Wa(c,a,u[0]);return b!==Wa(c,a,u[1])||b!==Wa(c,a,u[2])||b!==Wa(c,a,u[3])}function ou(c,a,u){const p=a.paint.get(c).value;return"constant"===p.kind?p.value:u.programConfigurations.get(a.id).getMaxValue(c)}function Om(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function C_(c,a,u,p,_){if(!a[0]&&!a[1])return c;const b=Ue.convert(a)._mult(_);"viewport"===u&&b._rotate(-p);const w=[];for(let S=0;S<c.length;S++)w.push(c[S].sub(b));return w}function T_(c,a,u,p){const _=Ue.convert(c)._mult(p);return"viewport"===a&&_._rotate(-u),_}dn(nu,"CircleBucket",{omit:["layers"]});const Cv=new Ot({"circle-sort-key":new ct(yt.layout_circle["circle-sort-key"])});var Lm={paint:new Ot({"circle-radius":new ct(yt.paint_circle["circle-radius"]),"circle-color":new ct(yt.paint_circle["circle-color"]),"circle-blur":new ct(yt.paint_circle["circle-blur"]),"circle-opacity":new ct(yt.paint_circle["circle-opacity"]),"circle-translate":new je(yt.paint_circle["circle-translate"]),"circle-translate-anchor":new je(yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new je(yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new je(yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ct(yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ct(yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ct(yt.paint_circle["circle-stroke-opacity"])}),layout:Cv};function gx(c,a,u,p,_,b,w,S,I){if(b&&c.queryGeometry.isAboveHorizon)return!1;b&&(I*=c.pixelToTileUnitsFactor);const M=c.tileID.canonical,z=u.projection.upVectorScale(M,u.center.lat,u.worldSize).metersToTile;for(const j of a)for(const H of j){const K=H.add(S),Y=_&&u.elevation?u.elevation.exaggeration()*_.getElevationAt(K.x,K.y,!0):0,te=u.projection.projectTilePoint(K.x,K.y,M);if(Y>0){const me=u.projection.upVector(M,K.x,K.y);te.x+=me[0]*z*Y,te.y+=me[1]*z*Y,te.z+=me[2]*z*Y}const ae=b?K:_x(te.x,te.y,te.z,p),we=b?c.tilespaceRays.map(me=>QT(me,Y)):c.queryGeometry.screenGeometry,ke=Gp([],[te.x,te.y,te.z,1],p);if(!w&&b?I*=ke[3]/u.cameraToCenterDistance:w&&!b&&(I*=u.cameraToCenterDistance/ke[3]),b){const me=ls((H.y/Gn+M.y)/(1<<M.z));I/=u.projection.pixelsPerMeter(me,1)/Fa(1,me)}if(fx(we,ae,I))return!0}return!1}function _x(c,a,u,p){const _=Gp([],[c,a,u,1],p);return new Ue(_[0]/_[3],_[1]/_[3])}const yx=Hp(0,0,0),YT=Hp(0,0,1);function QT(c,a){const u=av();return yx[2]=a,c.intersectsPlane(yx,YT,u),new Ue(u[0],u[1])}class Tv extends nu{}function Sv(c,{width:a,height:u},p,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==a*u*p)throw new RangeError("mismatched image size")}else _=new Uint8Array(a*u*p);return c.width=a,c.height=u,c.data=_,c}function Rm(c,a,u){const{width:p,height:_}=a;p===c.width&&_===c.height||(Fm(c,a,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,p),height:Math.min(c.height,_)},u),c.width=p,c.height=_,c.data=a.data)}function Fm(c,a,u,p,_,b){if(0===_.width||0===_.height)return a;if(_.width>c.width||_.height>c.height||u.x>c.width-_.width||u.y>c.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>a.width||_.height>a.height||p.x>a.width-_.width||p.y>a.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const w=c.data,S=a.data;for(let I=0;I<_.height;I++){const M=((u.y+I)*c.width+u.x)*b,z=((p.y+I)*a.width+p.x)*b;for(let j=0;j<_.width*b;j++)S[z+j]=w[M+j]}return a}dn(Tv,"HeatmapBucket",{omit:["layers"]});class ha{constructor(a,u){Sv(this,a,1,u)}resize(a){Rm(this,new ha(a),1)}clone(){return new ha({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,p,_,b){Fm(a,u,p,_,b,1)}}class pa{constructor(a,u){Sv(this,a,4,u)}resize(a){Rm(this,new pa(a),4)}replace(a,u){u?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new pa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,p,_,b){Fm(a,u,p,_,b,4)}}dn(ha,"AlphaImage"),dn(pa,"RGBAImage");var JT={paint:new Ot({"heatmap-radius":new ct(yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ct(yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new je(yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Dt(yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new je(yt.paint_heatmap["heatmap-opacity"])})};function vx(c){const a={},u=c.resolution||256,p=c.clips?c.clips.length:1,_=c.image||new pa({width:u,height:p}),b=(w,S,I)=>{a[c.evaluationKey]=I;const M=c.expression.evaluate(a);_.data[w+S+0]=Math.floor(255*M.r/M.a),_.data[w+S+1]=Math.floor(255*M.g/M.a),_.data[w+S+2]=Math.floor(255*M.b/M.a),_.data[w+S+3]=Math.floor(255*M.a)};if(c.clips)for(let w=0,S=0;w<p;++w,S+=4*u)for(let I=0,M=0;I<u;I++,M+=4){const z=I/(u-1),{start:j,end:H}=c.clips[w];b(S,M,j*(1-z)+H*z)}else for(let w=0,S=0;w<u;w++,S+=4)b(0,S,w/(u-1));return _}var eS={paint:new Ot({"hillshade-illumination-direction":new je(yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new je(yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new je(yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new je(yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new je(yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new je(yt.paint_hillshade["hillshade-accent-color"])})};const Ev=Sn([{name:"a_pos",components:2,type:"Int16"}],4),{members:tS}=Ev;var kh={};function Ah(c,a,u){u=u||2;var p,_,b,w,S,I,M,z=a&&a.length,j=z?a[0]*u:c.length,H=S_(c,0,j,u,!0),K=[];if(!H||H.next===H.prev)return K;if(z&&(H=function(te,ae,we,ke){var me,Se,Oe,De=[];for(me=0,Se=ae.length;me<Se;me++)(Oe=S_(te,ae[me]*ke,me<Se-1?ae[me+1]*ke:te.length,ke,!1))===Oe.next&&(Oe.steiner=!0),De.push(uc(Oe));for(De.sort(oS),me=0;me<De.length;me++)we=rS(De[me],we);return we}(c,a,H,u)),c.length>80*u){p=b=c[0],_=w=c[1];for(var Y=u;Y<j;Y+=u)(S=c[Y])<p&&(p=S),(I=c[Y+1])<_&&(_=I),S>b&&(b=S),I>w&&(w=I);M=0!==(M=Math.max(b-p,w-_))?32767/M:0}return Xp(H,K,u,p,_,M,0),K}function S_(c,a,u,p,_){var b,w;if(_===Nl(c,a,u,p)>0)for(b=a;b<u;b+=p)w=Cx(b,c[b],c[b+1],w);else for(b=u-p;b>=a;b-=p)w=Cx(b,c[b],c[b+1],w);return w&&E_(w,w.next)&&(Bm(w),w=w.next),w}function md(c,a){if(!c)return c;a||(a=c);var u,p=c;do{if(u=!1,p.steiner||!E_(p,p.next)&&0!==or(p.prev,p,p.next))p=p.next;else{if(Bm(p),(p=a=p.prev)===p.next)break;u=!0}}while(u||p!==a);return a}function Xp(c,a,u,p,_,b,w){if(c){!w&&b&&function(z,j,H,K){var Y=z;do{0===Y.z&&(Y.z=Ks(Y.x,Y.y,j,H,K)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next}while(Y!==z);Y.prevZ.nextZ=null,Y.prevZ=null,function(te){var ae,we,ke,me,Se,Oe,De,tt,Qe=1;do{for(we=te,te=null,Se=null,Oe=0;we;){for(Oe++,ke=we,De=0,ae=0;ae<Qe&&(De++,ke=ke.nextZ);ae++);for(tt=Qe;De>0||tt>0&&ke;)0!==De&&(0===tt||!ke||we.z<=ke.z)?(me=we,we=we.nextZ,De--):(me=ke,ke=ke.nextZ,tt--),Se?Se.nextZ=me:te=me,me.prevZ=Se,Se=me;we=ke}Se.nextZ=null,Qe*=2}while(Oe>1)}(Y)}(c,p,_,b);for(var S,I,M=c;c.prev!==c.next;)if(S=c.prev,I=c.next,b?Ph(c,p,_,b):bx(c))a.push(S.i/u|0),a.push(c.i/u|0),a.push(I.i/u|0),Bm(c),c=I.next,M=I.next;else if((c=I)===M){w?1===w?Xp(c=nS(md(c),a,u),a,u,p,_,b,2):2===w&&iS(c,a,u,p,_,b):Xp(md(c),a,u,p,_,b,1);break}}}function bx(c){var a=c.prev,u=c,p=c.next;if(or(a,u,p)>=0)return!1;for(var _=a.x,b=u.x,w=p.x,S=a.y,I=u.y,M=p.y,z=_<b?_<w?_:w:b<w?b:w,j=S<I?S<M?S:M:I<M?I:M,H=_>b?_>w?_:w:b>w?b:w,K=S>I?S>M?S:M:I>M?I:M,Y=p.next;Y!==a;){if(Y.x>=z&&Y.x<=H&&Y.y>=j&&Y.y<=K&&Yp(_,S,b,I,w,M,Y.x,Y.y)&&or(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function Ph(c,a,u,p){var _=c.prev,b=c,w=c.next;if(or(_,b,w)>=0)return!1;for(var S=_.x,I=b.x,M=w.x,z=_.y,j=b.y,H=w.y,K=S<I?S<M?S:M:I<M?I:M,Y=z<j?z<H?z:H:j<H?j:H,te=S>I?S>M?S:M:I>M?I:M,ae=z>j?z>H?z:H:j>H?j:H,we=Ks(K,Y,a,u,p),ke=Ks(te,ae,a,u,p),me=c.prevZ,Se=c.nextZ;me&&me.z>=we&&Se&&Se.z<=ke;){if(me.x>=K&&me.x<=te&&me.y>=Y&&me.y<=ae&&me!==_&&me!==w&&Yp(S,z,I,j,M,H,me.x,me.y)&&or(me.prev,me,me.next)>=0||(me=me.prevZ,Se.x>=K&&Se.x<=te&&Se.y>=Y&&Se.y<=ae&&Se!==_&&Se!==w&&Yp(S,z,I,j,M,H,Se.x,Se.y)&&or(Se.prev,Se,Se.next)>=0))return!1;Se=Se.nextZ}for(;me&&me.z>=we;){if(me.x>=K&&me.x<=te&&me.y>=Y&&me.y<=ae&&me!==_&&me!==w&&Yp(S,z,I,j,M,H,me.x,me.y)&&or(me.prev,me,me.next)>=0)return!1;me=me.prevZ}for(;Se&&Se.z<=ke;){if(Se.x>=K&&Se.x<=te&&Se.y>=Y&&Se.y<=ae&&Se!==_&&Se!==w&&Yp(S,z,I,j,M,H,Se.x,Se.y)&&or(Se.prev,Se,Se.next)>=0)return!1;Se=Se.nextZ}return!0}function nS(c,a,u){var p=c;do{var _=p.prev,b=p.next.next;!E_(_,b)&&xx(_,p,p.next,b)&&zm(_,b)&&zm(b,_)&&(a.push(_.i/u|0),a.push(p.i/u|0),a.push(b.i/u|0),Bm(p),Bm(p.next),p=c=b),p=p.next}while(p!==c);return md(p)}function iS(c,a,u,p,_,b){var w=c;do{for(var S=w.next.next;S!==w.prev;){if(w.i!==S.i&&aS(w,S)){var I=wx(w,S);return w=md(w,w.next),I=md(I,I.next),Xp(w,a,u,p,_,b,0),void Xp(I,a,u,p,_,b,0)}S=S.next}w=w.next}while(w!==c)}function oS(c,a){return c.x-a.x}function rS(c,a){var u=function(_,b){var w,S=b,I=_.x,M=_.y,z=-1/0;do{if(M<=S.y&&M>=S.next.y&&S.next.y!==S.y){var j=S.x+(M-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(j<=I&&j>z&&(z=j,w=S.x<S.next.x?S:S.next,j===I))return w}S=S.next}while(S!==b);if(!w)return null;var H,K=w,Y=w.x,te=w.y,ae=1/0;S=w;do{I>=S.x&&S.x>=Y&&I!==S.x&&Yp(M<te?I:z,M,Y,te,M<te?z:I,M,S.x,S.y)&&(H=Math.abs(M-S.y)/(I-S.x),zm(S,_)&&(H<ae||H===ae&&(S.x>w.x||S.x===w.x&&sS(w,S)))&&(w=S,ae=H)),S=S.next}while(S!==K);return w}(c,a);if(!u)return a;var p=wx(u,c);return md(p,p.next),md(u,u.next)}function sS(c,a){return or(c.prev,c,a.prev)<0&&or(a.next,c,c.next)<0}function Ks(c,a,u,p,_){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-u)*_|0)|c<<8))|c<<4))|c<<2))|c<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-p)*_|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function uc(c){var a=c,u=c;do{(a.x<u.x||a.x===u.x&&a.y<u.y)&&(u=a),a=a.next}while(a!==c);return u}function Yp(c,a,u,p,_,b,w,S){return(_-w)*(a-S)>=(c-w)*(b-S)&&(c-w)*(p-S)>=(u-w)*(a-S)&&(u-w)*(b-S)>=(_-w)*(p-S)}function aS(c,a){return c.next.i!==a.i&&c.prev.i!==a.i&&!function(u,p){var _=u;do{if(_.i!==u.i&&_.next.i!==u.i&&_.i!==p.i&&_.next.i!==p.i&&xx(_,_.next,u,p))return!0;_=_.next}while(_!==u);return!1}(c,a)&&(zm(c,a)&&zm(a,c)&&function(u,p){var _=u,b=!1,w=(u.x+p.x)/2,S=(u.y+p.y)/2;do{_.y>S!=_.next.y>S&&_.next.y!==_.y&&w<(_.next.x-_.x)*(S-_.y)/(_.next.y-_.y)+_.x&&(b=!b),_=_.next}while(_!==u);return b}(c,a)&&(or(c.prev,c,a.prev)||or(c,a.prev,a))||E_(c,a)&&or(c.prev,c,c.next)>0&&or(a.prev,a,a.next)>0)}function or(c,a,u){return(a.y-c.y)*(u.x-a.x)-(a.x-c.x)*(u.y-a.y)}function E_(c,a){return c.x===a.x&&c.y===a.y}function xx(c,a,u,p){var _=Nm(or(c,a,u)),b=Nm(or(c,a,p)),w=Nm(or(u,p,c)),S=Nm(or(u,p,a));return _!==b&&w!==S||!(0!==_||!I_(c,u,a))||!(0!==b||!I_(c,p,a))||!(0!==w||!I_(u,c,p))||!(0!==S||!I_(u,a,p))}function I_(c,a,u){return a.x<=Math.max(c.x,u.x)&&a.x>=Math.min(c.x,u.x)&&a.y<=Math.max(c.y,u.y)&&a.y>=Math.min(c.y,u.y)}function Nm(c){return c>0?1:c<0?-1:0}function zm(c,a){return or(c.prev,c,c.next)<0?or(c,a,c.next)>=0&&or(c,c.prev,a)>=0:or(c,a,c.prev)<0||or(c,c.next,a)<0}function wx(c,a){var u=new Qp(c.i,c.x,c.y),p=new Qp(a.i,a.x,a.y),_=c.next,b=a.prev;return c.next=a,a.prev=c,u.next=_,_.prev=u,p.next=u,u.prev=p,b.next=p,p.prev=b,p}function Cx(c,a,u,p){var _=new Qp(c,a,u);return p?(_.next=p.next,_.prev=p,p.next.prev=_,p.next=_):(_.prev=_,_.next=_),_}function Bm(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Qp(c,a,u){this.i=c,this.x=a,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Nl(c,a,u,p){for(var _=0,b=a,w=u-p;b<u;b+=p)_+=(c[w]-c[b])*(c[b+1]+c[w+1]),w=b;return _}function Vm(c,a,u,p,_){Iv(c,a,u||0,p||c.length-1,_||Tx)}function Iv(c,a,u,p,_){for(;p>u;){if(p-u>600){var b=p-u+1,w=a-u+1,S=Math.log(b),I=.5*Math.exp(2*S/3),M=.5*Math.sqrt(S*I*(b-I)/b)*(w-b/2<0?-1:1);Iv(c,a,Math.max(u,Math.floor(a-w*I/b+M)),Math.min(p,Math.floor(a+(b-w)*I/b+M)),_)}var z=c[a],j=u,H=p;for(Jp(c,u,a),_(c[p],z)>0&&Jp(c,u,p);j<H;){for(Jp(c,j,H),j++,H--;_(c[j],z)<0;)j++;for(;_(c[H],z)>0;)H--}0===_(c[u],z)?Jp(c,u,H):Jp(c,++H,p),H<=a&&(u=H+1),a<=H&&(p=H-1)}}function Jp(c,a,u){var p=c[a];c[a]=c[u],c[u]=p}function Tx(c,a){return c<a?-1:c>a?1:0}function Sx(c,a){const u=c.length;if(u<=1)return[c];const p=[];let _,b;for(let w=0;w<u;w++){const S=$i(c[w]);0!==S&&(c[w].area=Math.abs(S),void 0===b&&(b=S<0),b===S<0?(_&&p.push(_),_=[c[w]]):_.push(c[w]))}if(_&&p.push(_),a>1)for(let w=0;w<p.length;w++)p[w].length<=a||(Vm(p[w],a,1,p[w].length-1,SM),p[w]=p[w].slice(0,a));return p}function SM(c,a){return a.area-c.area}function Ex(c,a,u){const p=u.patternDependencies;let _=!1;for(const b of a){const w=b.paint.get(`${c}-pattern`);w.isConstant()||(_=!0);const S=w.constantOr(null);S&&(_=!0,p[S]=!0)}return _}function Um(c,a,u,p,_){const b=_.patternDependencies;for(const w of a){const S=w.paint.get(`${c}-pattern`).value;if("constant"!==S.kind){let I=S.evaluate({zoom:p},u,{},_.availableImages);I=I&&I.name?I.name:I,b[I]=!0,u.patterns[w.id]=I}}return u}({get exports(){return kh},set exports(c){kh=c}}).exports=Ah,kh.default=Ah,Ah.deviation=function(c,a,u,p){var _=a&&a.length,b=Math.abs(Nl(c,0,_?a[0]*u:c.length,u));if(_)for(var w=0,S=a.length;w<S;w++)b-=Math.abs(Nl(c,a[w]*u,w<S-1?a[w+1]*u:c.length,u));var I=0;for(w=0;w<p.length;w+=3){var M=p[w]*u,z=p[w+1]*u,j=p[w+2]*u;I+=Math.abs((c[M]-c[j])*(c[z+1]-c[M+1])-(c[M]-c[z])*(c[j+1]-c[M+1]))}return 0===b&&0===I?0:Math.abs((I-b)/b)},Ah.flatten=function(c){for(var a=c[0][0].length,u={vertices:[],holes:[],dimensions:a},p=0,_=0;_<c.length;_++){for(var b=0;b<c[_].length;b++)for(var w=0;w<a;w++)u.vertices.push(c[_][b][w]);_>0&&u.holes.push(p+=c[_-1].length)}return u};class ef{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new In,this.indexArray=new as,this.indexArray2=new ka,this.programConfigurations=new xh(a.layers,a.zoom),this.segments=new ir,this.segments2=new ir,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=a.projection}populate(a,u,p,_){this.hasPattern=Ex("fill",this.layers,u);const b=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:S,id:I,index:M,sourceLayerIndex:z}of a){const j=this.layers[0]._featureFilter.needGeometry,H=Mh(S,j);if(!this.layers[0]._featureFilter.filter(new $e(this.zoom),H,p))continue;const K=b?b.evaluate(H,{},p,u.availableImages):void 0,Y={id:I,properties:S.properties,type:S.type,sourceLayerIndex:z,index:M,geometry:j?H.geometry:tu(S,p,_),patterns:{},sortKey:K};w.push(Y)}b&&w.sort((S,I)=>S.sortKey-I.sortKey);for(const S of w){const{geometry:I,index:M,sourceLayerIndex:z}=S;if(this.hasPattern){const j=Um("fill",this.layers,S,this.zoom,u);this.patternFeatures.push(j)}else this.addFeature(S,I,M,p,{},u.availableImages);u.featureIndex.insert(a[M].feature,I,M,z,this.index)}}update(a,u,p,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,p,_)}addFeatures(a,u,p,_,b){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,u,p,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,tS),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,u,p,_,b,w=[]){for(const S of Sx(u,500)){let I=0;for(const Y of S)I+=Y.length;const M=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),z=M.vertexLength,j=[],H=[];for(const Y of S){if(0===Y.length)continue;Y!==S[0]&&H.push(j.length/2);const te=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),ae=te.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(ae+Y.length-1,ae),j.push(Y[0].x),j.push(Y[0].y);for(let we=1;we<Y.length;we++)this.layoutVertexArray.emplaceBack(Y[we].x,Y[we].y),this.indexArray2.emplaceBack(ae+we-1,ae+we),j.push(Y[we].x),j.push(Y[we].y);te.vertexLength+=Y.length,te.primitiveLength+=Y.length}const K=kh(j,H);for(let Y=0;Y<K.length;Y+=3)this.indexArray.emplaceBack(z+K[Y],z+K[Y+1],z+K[Y+2]);M.vertexLength+=I,M.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,b,w,_)}}dn(ef,"FillBucket",{omit:["layers","patternFeatures"]});const EM=new Ot({"fill-sort-key":new ct(yt.layout_fill["fill-sort-key"])});var IM={paint:new Ot({"fill-antialias":new je(yt.paint_fill["fill-antialias"]),"fill-opacity":new ct(yt.paint_fill["fill-opacity"]),"fill-color":new ct(yt.paint_fill["fill-color"]),"fill-outline-color":new ct(yt.paint_fill["fill-outline-color"]),"fill-translate":new je(yt.paint_fill["fill-translate"]),"fill-translate-anchor":new je(yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ct(yt.paint_fill["fill-pattern"])}),layout:EM};const Ix=Sn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),lS=Sn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),cS=Sn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:uS}=Ix;var D_={},Dx=Ue,jm=Oh;function Oh(c,a,u,p,_){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=p,this._values=_,c.readFields(Dv,this,a)}function Dv(c,a,u){1==c?a.id=u.readVarint():2==c?function(p,_){for(var b=p.readVarint()+p.pos;p.pos<b;){var w=_._keys[p.readVarint()],S=_._values[p.readVarint()];_.properties[w]=S}}(u,a):3==c?a.type=u.readVarint():4==c&&(a._geometry=u.pos)}function dS(c){for(var a,u,p=0,_=0,b=c.length,w=b-1;_<b;w=_++)p+=((u=c[w]).x-(a=c[_]).x)*(a.y+u.y);return p}Oh.types=["Unknown","Point","LineString","Polygon"],Oh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var a,u=c.readVarint()+c.pos,p=1,_=0,b=0,w=0,S=[];c.pos<u;){if(_<=0){var I=c.readVarint();p=7&I,_=I>>3}if(_--,1===p||2===p)b+=c.readSVarint(),w+=c.readSVarint(),1===p&&(a&&S.push(a),a=[]),a.push(new Dx(b,w));else{if(7!==p)throw new Error("unknown command "+p);a&&a.push(a[0].clone())}}return a&&S.push(a),S},Oh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var a=c.readVarint()+c.pos,u=1,p=0,_=0,b=0,w=1/0,S=-1/0,I=1/0,M=-1/0;c.pos<a;){if(p<=0){var z=c.readVarint();u=7&z,p=z>>3}if(p--,1===u||2===u)(_+=c.readSVarint())<w&&(w=_),_>S&&(S=_),(b+=c.readSVarint())<I&&(I=b),b>M&&(M=b);else if(7!==u)throw new Error("unknown command "+u)}return[w,I,S,M]},Oh.prototype.toGeoJSON=function(c,a,u){var p,_,b=this.extent*Math.pow(2,u),w=this.extent*c,S=this.extent*a,I=this.loadGeometry(),M=Oh.types[this.type];function z(K){for(var Y=0;Y<K.length;Y++){var te=K[Y];K[Y]=[360*(te.x+w)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+S)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var j=[];for(p=0;p<I.length;p++)j[p]=I[p][0];z(I=j);break;case 2:for(p=0;p<I.length;p++)z(I[p]);break;case 3:for(I=function(K){var Y=K.length;if(Y<=1)return[K];for(var te,ae,we=[],ke=0;ke<Y;ke++){var me=dS(K[ke]);0!==me&&(void 0===ae&&(ae=me<0),ae===me<0?(te&&we.push(te),te=[K[ke]]):te.push(K[ke]))}return te&&we.push(te),we}(I),p=0;p<I.length;p++)for(_=0;_<I[p].length;_++)z(I[p][_])}1===I.length?I=I[0]:M="Multi"+M;var H={type:"Feature",geometry:{type:M,coordinates:I},properties:this.properties};return"id"in this&&(H.id=this.id),H};var To=jm,Lh=Mx;function Mx(c,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(Ui,this,a),this.length=this._features.length}function Ui(c,a,u){15===c?a.version=u.readVarint():1===c?a.name=u.readString():5===c?a.extent=u.readVarint():2===c?a._features.push(u.pos):3===c?a._keys.push(u.readString()):4===c&&a._values.push(function(p){for(var _=null,b=p.readVarint()+p.pos;p.pos<b;){var w=p.readVarint()>>3;_=1===w?p.readString():2===w?p.readFloat():3===w?p.readDouble():4===w?p.readVarint64():5===w?p.readVarint():6===w?p.readSVarint():7===w?p.readBoolean():null}return _}(u))}Mx.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var a=this._pbf.readVarint()+this._pbf.pos;return new To(this._pbf,a,this.extent,this._keys,this._values)};var kx=Lh;function hS(c,a,u){if(3===c){var p=new kx(u,u.readVarint()+u.pos);p.length&&(a[p.name]=p)}}var Mv=D_.VectorTile=function(c,a){this.layers=c.readFields(hS,{},a)},M_=D_.VectorTileFeature=jm;function k_(c,a,u,p){const _=[],b=0===p?(w,S,I,M,z,j)=>{w.push(new Ue(j,I+(j-S)/(M-S)*(z-I)))}:(w,S,I,M,z,j)=>{w.push(new Ue(S+(j-I)/(z-I)*(M-S),j))};for(const w of c){const S=[];for(const I of w){if(I.length<=2)continue;const M=[];for(let H=0;H<I.length-1;H++){const K=I[H].x,Y=I[H].y,te=I[H+1].x,ae=I[H+1].y,we=0===p?K:Y,ke=0===p?te:ae;we<a?ke>a&&b(M,K,Y,te,ae,a):we>u?ke<u&&b(M,K,Y,te,ae,u):M.push(I[H]),ke<a&&we>=a&&b(M,K,Y,te,ae,a),ke>u&&we<=u&&b(M,K,Y,te,ae,u)}let z=I[I.length-1];const j=0===p?z.x:z.y;j>=a&&j<=u&&M.push(z),M.length&&(z=M[M.length-1],M[0].x===z.x&&M[0].y===z.y||M.push(M[0]),S.push(M))}S.length&&_.push(S)}return _}D_.VectorTileLayer=Lh;const Ax=M_.types,DM=Math.pow(2,13);function A_(c,a,u,p,_,b,w,S){c.emplaceBack((a<<1)+w,(u<<1)+b,(Math.floor(p*DM)<<1)+_,Math.round(S))}function ru(c,a,u){c.emplaceBack(a.x,a.y,a.z,16384*u[0],16384*u[1],16384*u[2])}class Hm{constructor(){this.acc=new Ue(0,0),this.polyCount=[]}startRing(a){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ue(a.x,a.y),this.max=new Ue(a.x,a.y))}append(a,u){this.currentPolyCount.edges++,this.acc._add(a);const p=this.min,_=this.max;a.x<p.x?p.x=a.x:a.x>_.x&&(_.x=a.x),a.y<p.y?p.y=a.y:a.y>_.y&&(_.y=a.y),((0===a.x||a.x===Gn)&&a.x===u.x)!=((0===a.y||a.y===Gn)&&a.y===u.y)&&this.processBorderOverlap(a,u),u.x<0!=a.x<0&&this.addBorderIntersection(0,ki(u.y,a.y,(0-u.x)/(a.x-u.x))),u.x>Gn!=a.x>Gn&&this.addBorderIntersection(1,ki(u.y,a.y,(Gn-u.x)/(a.x-u.x))),u.y<0!=a.y<0&&this.addBorderIntersection(2,ki(u.x,a.x,(0-u.y)/(a.y-u.y))),u.y>Gn!=a.y>Gn&&this.addBorderIntersection(3,ki(u.x,a.x,(Gn-u.y)/(a.y-u.y)))}addBorderIntersection(a,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[a];u<p[0]&&(p[0]=u),u>p[1]&&(p[1]=u)}processBorderOverlap(a,u){if(a.x===u.x){if(a.y===u.y)return;const p=0===a.x?0:1;this.addBorderIntersection(p,u.y),this.addBorderIntersection(p,a.y)}else{const p=0===a.y?2:3;this.addBorderIntersection(p,u.x),this.addBorderIntersection(p,a.x)}}centroid(){const a=this.polyCount.reduce((u,p)=>u+p.edges,0);return 0!==a?this.acc.div(a)._round():new Ue(0,0)}span(){return new Ue(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((a,u)=>a+ +(u[0]!==Number.MAX_VALUE),0)}}class tf{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=a.projection,this.layoutVertexArray=new Qi,this.centroidVertexArray=new vh,this.indexArray=new as,this.programConfigurations=new xh(a.layers,a.zoom),this.segments=new ir,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.enableTerrain=a.enableTerrain}populate(a,u,p,_){this.features=[],this.hasPattern=Ex("fill-extrusion",this.layers,u),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(b){const w=Math.exp(Math.PI*(1-b.y/(1<<b.z)*2));return 80150034*w/(w*w+1)/Gn/(1<<b.z)}(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:b,id:w,index:S,sourceLayerIndex:I}of a){const M=this.layers[0]._featureFilter.needGeometry,z=Mh(b,M);if(!this.layers[0]._featureFilter.filter(new $e(this.zoom),z,p))continue;const j={id:w,sourceLayerIndex:I,index:S,geometry:M?z.geometry:tu(b,p,_),properties:b.properties,type:b.type,patterns:{}},H=this.layoutVertexArray.length;this.hasPattern?this.features.push(Um("fill-extrusion",this.layers,j,this.zoom,u)):this.addFeature(j,j.geometry,S,p,{},u.availableImages,_),u.featureIndex.insert(b,j.geometry,S,I,this.index,H)}this.sortBorders()}addFeatures(a,u,p,_,b){for(const w of this.features){const{geometry:S}=w;this.addFeature(w,S,w.index,u,p,_,b)}this.sortBorders()}update(a,u,p,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,p,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,uS),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=a.createVertexBuffer(this.layoutVertexExtArray,cS.members,!0))),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,lS.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,u,p,_,b,w,S){const I=[new Ue(0,0),new Ue(Gn,Gn)],M=S.projection,z="globe"===M.name,j=this.enableTerrain&&!z?new Hm:null,H="Polygon"===Ax[a.type];z&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new la);const K=Sx(u,500);for(let we=K.length-1;we>=0;we--){const ke=K[we];(0===ke.length||(Y=ke[0]).every(me=>me.x<=0)||Y.every(me=>me.x>=Gn)||Y.every(me=>me.y<=0)||Y.every(me=>me.y>=Gn))&&K.splice(we,1)}var Y;let te;if(z)te=pS(K,I,_);else{te=[];for(const we of K)te.push({polygon:we,bounds:I})}const ae=H?this.edgeRadius:0;for(const{polygon:we,bounds:ke}of te){let me=0,Se=0;for(const De of we)H&&!De[0].equals(De[De.length-1])&&De.push(De[0]),Se+=H?De.length-1:De.length;const Oe=this.segments.prepareSegment((H?5:4)*Se,this.layoutVertexArray,this.indexArray);if(H){const De=[],tt=[];me=Oe.vertexLength;for(const mt of we){let at,lt;mt.length&&mt!==we[0]&&tt.push(De.length/2),at=mt[1].sub(mt[0])._perp()._unit();for(let bt=1;bt<mt.length;bt++){const xt=mt[bt],Mt=mt[bt===mt.length-1?1:bt+1];let{x:Pt,y:ut}=xt;if(ae){lt=Mt.sub(xt)._perp()._unit();const Gt=at.add(lt)._unit(),kn=ae*Math.min(4,1/(at.x*Gt.x+at.y*Gt.y));Pt+=kn*Gt.x,ut+=kn*Gt.y,at=lt}A_(this.layoutVertexArray,Pt,ut,0,0,1,1,0),Oe.vertexLength++,De.push(xt.x,xt.y),z&&ru(this.layoutVertexExtArray,M.projectTilePoint(Pt,ut,_),M.upVector(_,Pt,ut))}}const Qe=kh(De,tt);for(let mt=0;mt<Qe.length;mt+=3)this.indexArray.emplaceBack(me+Qe[mt],me+Qe[mt+2],me+Qe[mt+1]),Oe.primitiveLength++}for(const De of we){j&&De.length&&j.startRing(De[0]);let tt,Qe,mt,at=De.length>4&&Av(De[De.length-2],De[0],De[1]),lt=ae?Px(De[De.length-2],De[0],De[1],ae):0;Qe=De[1].sub(De[0])._perp()._unit();let bt=!0;for(let xt=1,Mt=0;xt<De.length;xt++){let Pt=De[xt-1],ut=De[xt];const Gt=De[xt===De.length-1?1:xt+1];if(j&&H&&j.currentPolyCount.top++,Lx(ut,Pt,ke)){ae&&(Qe=Gt.sub(ut)._perp()._unit(),bt=!bt);continue}j&&j.append(ut,Pt);const kn=ut.sub(Pt)._perp(),Yt=kn.x/(Math.abs(kn.x)+Math.abs(kn.y)),fn=kn.y>0?1:0,Xt=Pt.dist(ut);if(Mt+Xt>32768&&(Mt=0),ae){mt=Gt.sub(ut)._perp()._unit();let _i=Ox(Pt,ut,Gt,kv(Qe,mt),ae);isNaN(_i)&&(_i=0);const zn=ut.sub(Pt)._unit();Pt=Pt.add(zn.mult(lt))._round(),ut=ut.add(zn.mult(-_i))._round(),lt=_i,Qe=mt}const Fn=Oe.vertexLength,Si=De.length>4&&Av(Pt,ut,Gt);let xi=Pv(Mt,at,bt);if(A_(this.layoutVertexArray,Pt.x,Pt.y,Yt,fn,0,0,xi),A_(this.layoutVertexArray,Pt.x,Pt.y,Yt,fn,0,1,xi),Mt+=Xt,xi=Pv(Mt,Si,!bt),at=Si,A_(this.layoutVertexArray,ut.x,ut.y,Yt,fn,0,0,xi),A_(this.layoutVertexArray,ut.x,ut.y,Yt,fn,0,1,xi),Oe.vertexLength+=4,this.indexArray.emplaceBack(Fn+0,Fn+1,Fn+2),this.indexArray.emplaceBack(Fn+1,Fn+3,Fn+2),Oe.primitiveLength+=2,ae){const _i=me+(1===xt?De.length-2:xt-2),zn=1===xt?me:_i+1;if(this.indexArray.emplaceBack(Fn+1,_i,Fn+3),this.indexArray.emplaceBack(_i,zn,Fn+3),Oe.primitiveLength+=2,void 0===tt&&(tt=Fn),!Lx(Gt,De[xt],ke)){const oo=xt===De.length-1?tt:Oe.vertexLength;this.indexArray.emplaceBack(Fn+2,Fn+3,oo),this.indexArray.emplaceBack(Fn+3,oo+1,oo),this.indexArray.emplaceBack(Fn+3,zn,oo+1),Oe.primitiveLength+=3}bt=!bt}if(z){const _i=this.layoutVertexExtArray,zn=M.projectTilePoint(Pt.x,Pt.y,_),oo=M.projectTilePoint(ut.x,ut.y,_),ti=M.upVector(_,Pt.x,Pt.y),Ii=M.upVector(_,ut.x,ut.y);ru(_i,zn,ti),ru(_i,zn,ti),ru(_i,oo,Ii),ru(_i,oo,Ii)}}H&&(me+=De.length-1)}}if(j&&j.polyCount.length>0){if(j.borders){j.vertexArrayOffset=this.centroidVertexArray.length;const we=j.borders,ke=this.featuresOnBorder.push(j)-1;for(let me=0;me<4;me++)we[me][0]!==Number.MAX_VALUE&&this.borders[me].push(ke)}this.encodeCentroid(j.borders?void 0:j.centroid(),j)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,b,w,_)}sortBorders(){for(let a=0;a<4;a++)this.borders[a].sort((u,p)=>this.featuresOnBorder[u].borders[a][0]-this.featuresOnBorder[p].borders[a][0])}encodeCentroid(a,u,p=!0){let _,b;if(a)if(0!==a.y){const S=u.span()._mult(this.tileToMeter);_=(Math.max(a.x,1)<<3)+Math.min(7,Math.round(S.x/10)),b=(Math.max(a.y,1)<<3)+Math.min(7,Math.round(S.y/10))}else _=Math.ceil(7*(a.x+450)),b=0;else _=0,b=+p;let w=p?this.centroidVertexArray.length:u.vertexArrayOffset;for(const S of u.polyCount){p&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*S.edges+S.top);for(let I=0;I<S.top;I++)this.centroidVertexArray.emplace(w++,_,b);for(let I=0;I<2*S.edges;I++)this.centroidVertexArray.emplace(w++,0,b),this.centroidVertexArray.emplace(w++,_,b)}}}function kv(c,a){const u=c.add(a)._unit();return c.x*u.x+c.y*u.y}function Px(c,a,u,p){const _=a.sub(c)._perp()._unit(),b=u.sub(a)._perp()._unit();return Ox(c,a,u,kv(_,b),p)}function Ox(c,a,u,p,_){const b=Math.sqrt(1-p*p);return Math.min(c.dist(a)/3,a.dist(u)/3,_*b/p)}function Lx(c,a,u){return c.x<u[0].x&&a.x<u[0].x||c.x>u[1].x&&a.x>u[1].x||c.y<u[0].y&&a.y<u[0].y||c.y>u[1].y&&a.y>u[1].y}function Av(c,a,u){if(c.x<0||c.x>=Gn||a.x<0||a.x>=Gn||u.x<0||u.x>=Gn)return!1;const p=u.sub(a),_=p.perp(),b=c.sub(a);return(p.x*b.x+p.y*b.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(b.x*b.x+b.y*b.y))>-.866&&_.x*b.x+_.y*b.y<0}function Pv(c,a,u){const p=a?2|c:-3&c;return u?1|p:-2&p}function P_(){const c=Math.PI/32,a=Math.tan(c),u=Dm;return u*Math.sqrt(1+2*a*a)-u}function pS(c,a,u){const p=1<<u.z,_=da(u.x/p),b=da((u.x+1)/p),w=ls(u.y/p),S=ls((u.y+1)/p);return function(I,M,z,j,H=0,K){const Y=[];if(!I.length||!z||!j)return Y;const te=(De,tt)=>{for(const Qe of De)Y.push({polygon:Qe,bounds:tt})},ae=Math.ceil(Math.log2(z)),we=Math.ceil(Math.log2(j)),ke=ae-we,me=[];for(let De=0;De<Math.abs(ke);De++)me.push(ke>0?0:1);for(let De=0;De<Math.min(ae,we);De++)me.push(0),me.push(1);let Se=I;if(Se=k_(Se,M[0].y-H,M[1].y+H,1),Se=k_(Se,M[0].x-H,M[1].x+H,0),!Se.length)return Y;const Oe=[];for(me.length?Oe.push({polygons:Se,bounds:M,depth:0}):te(Se,M);Oe.length;){const De=Oe.pop(),tt=De.depth,Qe=me[tt],mt=De.bounds[0],at=De.bounds[1],lt=0===Qe?mt.x:mt.y,bt=0===Qe?at.x:at.y,xt=K?K(Qe,lt,bt):.5*(lt+bt),Mt=k_(De.polygons,lt-H,xt+H,Qe),Pt=k_(De.polygons,xt-H,bt+H,Qe);if(Mt.length){const ut=[mt,new Ue(0===Qe?xt:at.x,1===Qe?xt:at.y)];me.length>tt+1?Oe.push({polygons:Mt,bounds:ut,depth:tt+1}):te(Mt,ut)}if(Pt.length){const ut=[new Ue(0===Qe?xt:mt.x,1===Qe?xt:mt.y),at];me.length>tt+1?Oe.push({polygons:Pt,bounds:ut,depth:tt+1}):te(Pt,ut)}}return Y}(c,a,Math.ceil((b-_)/11.25),Math.ceil((w-S)/11.25),1,(I,M,z)=>{if(0===I)return.5*(M+z);{const j=ls((u.y+M/Gn)/p);return(Zs(.5*(ls((u.y+z/Gn)/p)+j))*p-u.y)*Gn}})}dn(tf,"FillExtrusionBucket",{omit:["layers","features"]}),dn(Hm,"PartMetadata");const Ov=new Ot({"fill-extrusion-edge-radius":new je(yt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var fS={paint:new Ot({"fill-extrusion-opacity":new je(yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ct(yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new je(yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new je(yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ct(yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ct(yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ct(yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new je(yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new je(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new je(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:Ov};function O_(c,a,u){var p=2*Math.PI*6378137/256/Math.pow(2,u);return[c*p-2*Math.PI*6378137/2,a*p-2*Math.PI*6378137/2]}class $m{constructor(a,u,p){this.z=a,this.x=u,this.y=p,this.key=Gm(0,a,a,u,p)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,u){const p=(w=this.y,S=this.z,I=O_(256*(b=this.x),256*(w=Math.pow(2,S)-w-1),S),M=O_(256*(b+1),256*(w+1),S),I[0]+","+I[1]+","+M[0]+","+M[1]),_=function(b,w,S){let I,M="";for(let z=b;z>0;z--)I=1<<z-1,M+=(w&I?1:0)+(S&I?2:0);return M}(this.z,this.x,this.y);var b,w,S,I,M;return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===u?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",_).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Lv{constructor(a,u){this.wrap=a,this.canonical=u,this.key=Gm(a,u.z,u.z,u.x,u.y)}}class ur{constructor(a,u,p,_,b){this.overscaledZ=a,this.wrap=u,this.canonical=new $m(p,+_,+b),this.key=0===u&&a===p?this.canonical.key:Gm(u,a,p,_,b)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){const u=this.canonical.z-a;return a>this.canonical.z?new ur(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ur(a,this.wrap,a,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(a,u=!0){if(this.overscaledZ===a&&u)return this.key;if(a>this.canonical.z)return Gm(this.wrap*+u,a,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-a;return Gm(this.wrap*+u,a,a,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;const u=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>u&&a.canonical.y===this.canonical.y>>u}children(a){if(this.overscaledZ>=a)return[new ur(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,p=2*this.canonical.x,_=2*this.canonical.y;return[new ur(u,this.wrap,u,p,_),new ur(u,this.wrap,u,p+1,_),new ur(u,this.wrap,u,p,_+1),new ur(u,this.wrap,u,p+1,_+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new ur(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new ur(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Lv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Gm(c,a,u,p,_){const b=1<<Math.min(u,22);let w=b*(_%b)+p%b;return c&&u<22&&(w+=b*b*((c<0?-2*c-1:2*c)%(1<<2*(22-u)))),16*(32*w+u)+(a-u)}dn($m,"CanonicalTileID"),dn(ur,"OverscaledTileID",{omit:["projMatrix"]});class gd extends Ue{constructor(a,u,p){super(a,u),this.z=p}}function _d(c,a){return c.x*a.x+c.y*a.y}function Rx(c,a){if(1===c.length){let u=0;const p=a[u++];let _;for(;!_||p.equals(_);)if(_=a[u++],!_)return 1/0;for(;u<a.length;u++){const b=a[u],w=c[0],S=_.sub(p),I=b.sub(p),M=w.sub(p),z=_d(S,S),j=_d(S,I),H=_d(I,I),K=_d(M,S),Y=_d(M,I),te=z*H-j*j,ae=(H*K-j*Y)/te,we=(z*Y-j*K)/te,ke=p.z*(1-ae-we)+_.z*ae+b.z*we;if(isFinite(ke))return ke}return 1/0}{let u=1/0;for(const p of a)u=Math.min(u,p.z);return u}}function L_(c,a,u,p,_,b,w,S){const I=w*_.getElevationAt(c,a,!0,!0),M=0!==b[0],z=M?0===b[1]?w*(b[0]/7-450):w*function(j,H,K){const Y=Math.floor(H[0]/8),te=Math.floor(H[1]/8),ae=10*(H[0]-8*Y),we=10*(H[1]-8*te),ke=j.getElevationAt(Y,te,!0,!0),me=j.getMeterToDEM(K),Se=Math.floor(.5*(ae*me-1)),Oe=Math.floor(.5*(we*me-1)),De=j.tileCoordToPixel(Y,te),tt=2*Se+1,Qe=2*Oe+1,mt=(kn=tt,Yt=Qe,[(Pt=j).getElevationAtPixel(ut=De.x-Se,Gt=De.y-Oe,!0),Pt.getElevationAtPixel(ut+Yt,Gt,!0),Pt.getElevationAtPixel(ut,Gt+Yt,!0),Pt.getElevationAtPixel(ut+kn,Gt+Yt,!0)]),at=Math.abs(mt[0]-mt[1]),lt=Math.abs(mt[2]-mt[3]),bt=Math.abs(mt[0]-mt[2])+Math.abs(mt[1]-mt[3]),xt=Math.min(.25,.5*me*(at+lt)/tt),Mt=Math.min(.25,.5*me*bt/Qe);var Pt,ut,Gt,kn,Yt;return ke+Math.max(xt*ae,Mt*we)}(_,b,S):I;return{base:I+(0===u)?-1:u,top:M?Math.max(z+p,I+u+2):I+p}}const R_=Sn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:dc}=R_,Fx=Sn([{name:"a_packed",components:4,type:"Float32"}]),{members:Rv}=Fx,mS=M_.types,gS=Math.cos(Math.PI/180*37.5);class Wm{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.projection=a.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new yo,this.layoutVertexArray2=new io,this.indexArray=new as,this.programConfigurations=new xh(a.layers,a.zoom),this.segments=new ir,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,p,_){this.hasPattern=Ex("line",this.layers,u);const b=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:z,id:j,index:H,sourceLayerIndex:K}of a){const Y=this.layers[0]._featureFilter.needGeometry,te=Mh(z,Y);if(!this.layers[0]._featureFilter.filter(new $e(this.zoom),te,p))continue;const ae=b?b.evaluate(te,{},p):void 0,we={id:j,properties:z.properties,type:z.type,sourceLayerIndex:K,index:H,geometry:Y?te.geometry:tu(z,p,_),patterns:{},sortKey:ae};w.push(we)}b&&w.sort((z,j)=>z.sortKey-j.sortKey);const{lineAtlas:S,featureIndex:I}=u,M=this.addConstantDashes(S);for(const z of w){const{geometry:j,index:H,sourceLayerIndex:K}=z;if(M&&this.addFeatureDashes(z,S),this.hasPattern){const Y=Um("line",this.layers,z,this.zoom,u);this.patternFeatures.push(Y)}else this.addFeature(z,j,H,p,S.positions,u.availableImages);I.insert(a[H].feature,j,H,K,this.index)}}addConstantDashes(a){let u=!1;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,b=p.layout.get("line-cap").value;if("constant"!==_.kind||"constant"!==b.kind)u=!0;else{const w=b.value,S=_.value;if(!S)continue;a.addDash(S,w)}}return u}addFeatureDashes(a,u){const p=this.zoom;for(const _ of this.layers){const b=_.paint.get("line-dasharray").value,w=_.layout.get("line-cap").value;if("constant"===b.kind&&"constant"===w.kind)continue;let S,I;if("constant"===b.kind){if(S=b.value,!S)continue}else S=b.evaluate({zoom:p},a);I="constant"===w.kind?w.value:w.evaluate({zoom:p},a),u.addDash(S,I),a.patterns[_.id]=u.getKey(S,I)}}update(a,u,p,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,p,_)}addFeatures(a,u,p,_,b){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,u,p,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Rv)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,dc),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,u,p,_,b,w){const S=this.layers[0].layout,I=S.get("line-join").evaluate(a,{}),M=S.get("line-cap").evaluate(a,{}),z=S.get("line-miter-limit"),j=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const H of u)this.addLine(H,a,I,M,z,j);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,b,w,_)}addLine(a,u,p,_,b,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let we=0;we<a.length-1;we++)this.totalDistance+=a[we].dist(a[we+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S="Polygon"===mS[u.type];let I=a.length;for(;I>=2&&a[I-1].equals(a[I-2]);)I--;let M=0;for(;M<I-1&&a[M].equals(a[M+1]);)M++;if(I<(S?3:2))return;"bevel"===p&&(b=1.05);const z=this.overscaling<=16?122880/(512*this.overscaling):0,j=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let H,K,Y,te,ae;this.e1=this.e2=-1,S&&(H=a[I-2],ae=a[M].sub(H)._unit()._perp());for(let we=M;we<I;we++){if(Y=we===I-1?S?a[M+1]:void 0:a[we+1],Y&&a[we].equals(Y))continue;ae&&(te=ae),H&&(K=H),H=a[we],ae=Y?Y.sub(H)._unit()._perp():te,te=te||ae;let ke=te.add(ae);0===ke.x&&0===ke.y||ke._unit();const me=te.x*ae.x+te.y*ae.y,Se=ke.x*ae.x+ke.y*ae.y,Oe=0!==Se?1/Se:1/0,De=2*Math.sqrt(2-2*Se),tt=Se<gS&&K&&Y,Qe=te.x*ae.y-te.y*ae.x>0;if(tt&&we>M){const lt=H.dist(K);if(lt>2*z){const bt=H.sub(H.sub(K)._mult(z/lt)._round());this.updateDistance(K,bt),this.addCurrentVertex(bt,te,0,0,j),K=bt}}const mt=K&&Y;let at=mt?p:S?"butt":_;if(mt&&"round"===at&&(Oe<w?at="miter":Oe<=2&&(at="fakeround")),"miter"===at&&Oe>b&&(at="bevel"),"bevel"===at&&(Oe>2&&(at="flipbevel"),Oe<b&&(at="miter")),K&&this.updateDistance(K,H),"miter"===at)ke._mult(Oe),this.addCurrentVertex(H,ke,0,0,j);else if("flipbevel"===at){if(Oe>100)ke=ae.mult(-1);else{const lt=Oe*te.add(ae).mag()/te.sub(ae).mag();ke._perp()._mult(lt*(Qe?-1:1))}this.addCurrentVertex(H,ke,0,0,j),this.addCurrentVertex(H,ke.mult(-1),0,0,j)}else if("bevel"===at||"fakeround"===at){const lt=-Math.sqrt(Oe*Oe-1),bt=Qe?lt:0,xt=Qe?0:lt;if(K&&this.addCurrentVertex(H,te,bt,xt,j),"fakeround"===at){const Mt=Math.round(180*De/Math.PI/20);for(let Pt=1;Pt<Mt;Pt++){let ut=Pt/Mt;if(.5!==ut){const kn=ut-.5;ut+=ut*kn*(ut-1)*((1.0904+me*(me*(3.55645-1.43519*me)-3.2452))*kn*kn+(.848013+me*(.215638*me-1.06021)))}const Gt=ae.sub(te)._mult(ut)._add(te)._unit()._mult(Qe?-1:1);this.addHalfVertex(H,Gt.x,Gt.y,!1,Qe,0,j)}}Y&&this.addCurrentVertex(H,ae,-bt,-xt,j)}else if("butt"===at)this.addCurrentVertex(H,ke,0,0,j);else if("square"===at){const lt=K?1:-1;K||this.addCurrentVertex(H,ke,lt,lt,j),this.addCurrentVertex(H,ke,0,0,j),K&&this.addCurrentVertex(H,ke,lt,lt,j)}else"round"===at&&(K&&(this.addCurrentVertex(H,te,0,0,j),this.addCurrentVertex(H,te,1,1,j,!0)),Y&&(this.addCurrentVertex(H,ae,-1,-1,j,!0),this.addCurrentVertex(H,ae,0,0,j)));if(tt&&we<I-1){const lt=H.dist(Y);if(lt>2*z){const bt=H.add(Y.sub(H)._mult(z/lt)._round());this.updateDistance(H,bt),this.addCurrentVertex(bt,ae,0,0,j),H=bt}}}}addCurrentVertex(a,u,p,_,b,w=!1){const S=u.y*_-u.x,I=-u.y-u.x*_;this.addHalfVertex(a,u.x+u.y*p,u.y-u.x*p,w,!1,p,b),this.addHalfVertex(a,S,I,w,!0,-_,b)}addHalfVertex({x:a,y:u},p,_,b,w,S,I){this.layoutVertexArray.emplaceBack((a<<1)+(b?1:0),(u<<1)+(w?1:0),Math.round(63*p)+128,Math.round(63*_)+128,1+(0===S?0:S<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),I.primitiveLength++),w?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const a=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=a*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(a,u){this.distance+=a.dist(u),this.updateScaledDistance()}}dn(Wm,"LineBucket",{omit:["layers","patternFeatures"]});const nf=new Ot({"line-cap":new ct(yt.layout_line["line-cap"]),"line-join":new ct(yt.layout_line["line-join"]),"line-miter-limit":new je(yt.layout_line["line-miter-limit"]),"line-round-limit":new je(yt.layout_line["line-round-limit"]),"line-sort-key":new ct(yt.layout_line["line-sort-key"])});var Nx={paint:new Ot({"line-opacity":new ct(yt.paint_line["line-opacity"]),"line-color":new ct(yt.paint_line["line-color"]),"line-translate":new je(yt.paint_line["line-translate"]),"line-translate-anchor":new je(yt.paint_line["line-translate-anchor"]),"line-width":new ct(yt.paint_line["line-width"]),"line-gap-width":new ct(yt.paint_line["line-gap-width"]),"line-offset":new ct(yt.paint_line["line-offset"]),"line-blur":new ct(yt.paint_line["line-blur"]),"line-dasharray":new ct(yt.paint_line["line-dasharray"]),"line-pattern":new ct(yt.paint_line["line-pattern"]),"line-gradient":new Dt(yt.paint_line["line-gradient"]),"line-trim-offset":new je(yt.paint_line["line-trim-offset"])}),layout:nf};const zx=new class extends ct{possiblyEvaluate(c,a){return a=new $e(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(c,a)}evaluate(c,a,u,p){return a=ri({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(c,a,u,p)}}(Nx.paint.properties["line-width"].specification);function Bx(c,a){return a>0?a+2*c:c}zx.useIntegerZoom=!0;const Fv=Sn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_S=Sn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Vx=Sn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Sn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const yS=Sn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Ux=Sn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Sn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const vS=Sn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),bS=Sn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Sn([{name:"triangle",components:3,type:"Uint16"}]),Sn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Sn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Sn([{type:"Float32",name:"offsetX"}]),Sn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var dr=24;const hc=128;function yd(c,a){const{expression:u}=a;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new $e(c+1))};if("source"===u.kind)return{kind:"source"};{const{zoomStops:p,interpolationType:_}=u;let b=0;for(;b<p.length&&p[b]<=c;)b++;b=Math.max(0,b-1);let w=b;for(;w<p.length&&p[w]<c+1;)w++;w=Math.min(p.length-1,w);const S=p[b],I=p[w];return"composite"===u.kind?{kind:"composite",minZoom:S,maxZoom:I,interpolationType:_}:{kind:"camera",minZoom:S,maxZoom:I,minSize:u.evaluate(new $e(S)),maxSize:u.evaluate(new $e(I)),interpolationType:_}}}function gi(c,{uSize:a,uSizeT:u},{lowerSize:p,upperSize:_}){return"source"===c.kind?p/hc:"composite"===c.kind?ki(p/hc,_/hc,u):a}function rf(c,a){let u=0,p=0;if("constant"===c.kind)p=c.layoutSize;else if("source"!==c.kind){const{interpolationType:_,minZoom:b,maxZoom:w}=c,S=_?Hn(pn.interpolationFactor(_,a,b,w),0,1):0;"camera"===c.kind?p=ki(c.minSize,c.maxSize,S):u=S}return{uSizeT:u,uSize:p}}var qm=Object.freeze({__proto__:null,getSizeData:yd,evaluateSizeForFeature:gi,evaluateSizeForZoom:rf,SIZE_PACK_FACTOR:hc});function Jr(c,a,u){return c.sections.forEach(p=>{p.text=function(_,b,w){const S=b.layout.get("text-transform").evaluate(w,{});return"uppercase"===S?_=_.toLocaleUpperCase():"lowercase"===S&&(_=_.toLocaleLowerCase()),Fe.applyArabicShaping&&(_=Fe.applyArabicShaping(_)),_}(p.text,a,u)}),c}const Zm={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function xS(c){return"\ufe36"===c||"\ufe48"===c||"\ufe38"===c||"\ufe44"===c||"\ufe42"===c||"\ufe3e"===c||"\ufe3c"===c||"\ufe3a"===c||"\ufe18"===c||"\ufe40"===c||"\ufe10"===c||"\ufe13"===c||"\ufe14"===c||"\uff40"===c||"\uffe3"===c||"\ufe11"===c||"\ufe12"===c}function Rh(c){return"\ufe35"===c||"\ufe47"===c||"\ufe37"===c||"\ufe43"===c||"\ufe41"===c||"\ufe3d"===c||"\ufe3b"===c||"\ufe39"===c||"\ufe17"===c||"\ufe3f"===c}var Km=So,F_=function(c,a,u,p,_){var b,w,S=8*_-p-1,I=(1<<S)-1,M=I>>1,z=-7,j=u?_-1:0,H=u?-1:1,K=c[a+j];for(j+=H,b=K&(1<<-z)-1,K>>=-z,z+=S;z>0;b=256*b+c[a+j],j+=H,z-=8);for(w=b&(1<<-z)-1,b>>=-z,z+=p;z>0;w=256*w+c[a+j],j+=H,z-=8);if(0===b)b=1-M;else{if(b===I)return w?NaN:1/0*(K?-1:1);w+=Math.pow(2,p),b-=M}return(K?-1:1)*w*Math.pow(2,b-p)},N_=function(c,a,u,p,_,b){var w,S,I,M=8*b-_-1,z=(1<<M)-1,j=z>>1,H=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,K=p?0:b-1,Y=p?1:-1,te=a<0||0===a&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(S=isNaN(a)?1:0,w=z):(w=Math.floor(Math.log(a)/Math.LN2),a*(I=Math.pow(2,-w))<1&&(w--,I*=2),(a+=w+j>=1?H/I:H*Math.pow(2,1-j))*I>=2&&(w++,I/=2),w+j>=z?(S=0,w=z):w+j>=1?(S=(a*I-1)*Math.pow(2,_),w+=j):(S=a*Math.pow(2,j-1)*Math.pow(2,_),w=0));_>=8;c[u+K]=255&S,K+=Y,S/=256,_-=8);for(w=w<<_|S,M+=_;M>0;c[u+K]=255&w,K+=Y,w/=256,M-=8);c[u+K-Y]|=128*te};function So(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}So.Varint=0,So.Fixed64=1,So.Bytes=2,So.Fixed32=5;var Xm=4294967296,pc=1/Xm,jx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function su(c){return c.type===So.Bytes?c.readVarint()+c.pos:c.pos+1}function Hx(c,a,u){var p=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));u.realloc(p);for(var _=u.pos-1;_>=c;_--)u.buf[_+p]=u.buf[_]}function $x(c,a){for(var u=0;u<c.length;u++)a.writeVarint(c[u])}function wS(c,a){for(var u=0;u<c.length;u++)a.writeSVarint(c[u])}function CS(c,a){for(var u=0;u<c.length;u++)a.writeFloat(c[u])}function af(c,a){for(var u=0;u<c.length;u++)a.writeDouble(c[u])}function au(c,a){for(var u=0;u<c.length;u++)a.writeBoolean(c[u])}function TS(c,a){for(var u=0;u<c.length;u++)a.writeFixed32(c[u])}function SS(c,a){for(var u=0;u<c.length;u++)a.writeSFixed32(c[u])}function MM(c,a){for(var u=0;u<c.length;u++)a.writeFixed64(c[u])}function kM(c,a){for(var u=0;u<c.length;u++)a.writeSFixed64(c[u])}function Ym(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+16777216*c[a+3]}function Qm(c,a,u){c[u]=a,c[u+1]=a>>>8,c[u+2]=a>>>16,c[u+3]=a>>>24}function Nv(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+(c[a+3]<<24)}function Gx(c,a,u){a.glyphs=[],1===c&&u.readMessage(ES,a)}function ES(c,a,u){if(3===c){const{id:p,bitmap:_,width:b,height:w,left:S,top:I,advance:M}=u.readMessage(Wx,{});a.glyphs.push({id:p,bitmap:new ha({width:b+6,height:w+6},_),metrics:{width:b,height:w,left:S,top:I,advance:M}})}else 4===c?a.ascender=u.readSVarint():5===c&&(a.descender=u.readSVarint())}function Wx(c,a,u){1===c?a.id=u.readVarint():2===c?a.bitmap=u.readBytes():3===c?a.width=u.readVarint():4===c?a.height=u.readVarint():5===c?a.left=u.readSVarint():6===c?a.top=u.readSVarint():7===c&&(a.advance=u.readVarint())}function zv(c){let a=0,u=0;for(const w of c)a+=w.w*w.h,u=Math.max(u,w.w);c.sort((w,S)=>S.h-w.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),u),h:1/0}];let _=0,b=0;for(const w of c)for(let S=p.length-1;S>=0;S--){const I=p[S];if(!(w.w>I.w||w.h>I.h)){if(w.x=I.x,w.y=I.y,b=Math.max(b,w.y+w.h),_=Math.max(_,w.x+w.w),w.w===I.w&&w.h===I.h){const M=p.pop();S<p.length&&(p[S]=M)}else w.h===I.h?(I.x+=w.w,I.w-=w.w):w.w===I.w?(I.y+=w.h,I.h-=w.h):(p.push({x:I.x+w.w,y:I.y,w:I.w-w.w,h:w.h}),I.y+=w.h,I.h-=w.h);break}}return{w:_,h:b,fill:a/(_*b)||0}}So.prototype={destroy:function(){this.buf=null},readFields:function(c,a,u){for(u=u||this.length;this.pos<u;){var p=this.readVarint(),_=p>>3,b=this.pos;this.type=7&p,c(_,a,this),this.pos===b&&this.skip(p)}return a},readMessage:function(c,a){return this.readFields(c,a,this.readVarint()+this.pos)},readFixed32:function(){var c=Ym(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=Nv(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=Ym(this.buf,this.pos)+Ym(this.buf,this.pos+4)*Xm;return this.pos+=8,c},readSFixed64:function(){var c=Ym(this.buf,this.pos)+Nv(this.buf,this.pos+4)*Xm;return this.pos+=8,c},readFloat:function(){var c=F_(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=F_(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var a,u,p=this.buf;return a=127&(u=p[this.pos++]),u<128?a:(a|=(127&(u=p[this.pos++]))<<7,u<128?a:(a|=(127&(u=p[this.pos++]))<<14,u<128?a:(a|=(127&(u=p[this.pos++]))<<21,u<128?a:function(_,b,w){var S,I,M=w.buf;if(S=(112&(I=M[w.pos++]))>>4,I<128||(S|=(127&(I=M[w.pos++]))<<3,I<128)||(S|=(127&(I=M[w.pos++]))<<10,I<128)||(S|=(127&(I=M[w.pos++]))<<17,I<128)||(S|=(127&(I=M[w.pos++]))<<24,I<128)||(S|=(1&(I=M[w.pos++]))<<31,I<128))return function sf(c,a,u){return u?4294967296*a+(c>>>0):4294967296*(a>>>0)+(c>>>0)}(_,S,b);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(u=p[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var c=this.readVarint()+this.pos,a=this.pos;return this.pos=c,c-a>=12&&jx?jx.decode(this.buf.subarray(a,c)):function(u,p,_){for(var b="",w=p;w<_;){var S,I,M,z=u[w],j=null,H=z>239?4:z>223?3:z>191?2:1;if(w+H>_)break;1===H?z<128&&(j=z):2===H?128==(192&(S=u[w+1]))&&(j=(31&z)<<6|63&S)<=127&&(j=null):3===H?(I=u[w+2],128==(192&(S=u[w+1]))&&128==(192&I)&&((j=(15&z)<<12|(63&S)<<6|63&I)<=2047||j>=55296&&j<=57343)&&(j=null)):4===H&&(I=u[w+2],M=u[w+3],128==(192&(S=u[w+1]))&&128==(192&I)&&128==(192&M)&&((j=(15&z)<<18|(63&S)<<12|(63&I)<<6|63&M)<=65535||j>=1114112)&&(j=null)),null===j?(j=65533,H=1):j>65535&&(j-=65536,b+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),b+=String.fromCharCode(j),w+=H}return b}(this.buf,a,c)},readBytes:function(){var c=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,c);return this.pos=c,a},readPackedVarint:function(c,a){if(this.type!==So.Bytes)return c.push(this.readVarint(a));var u=su(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(a));return c},readPackedSVarint:function(c){if(this.type!==So.Bytes)return c.push(this.readSVarint());var a=su(this);for(c=c||[];this.pos<a;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==So.Bytes)return c.push(this.readBoolean());var a=su(this);for(c=c||[];this.pos<a;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==So.Bytes)return c.push(this.readFloat());var a=su(this);for(c=c||[];this.pos<a;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==So.Bytes)return c.push(this.readDouble());var a=su(this);for(c=c||[];this.pos<a;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==So.Bytes)return c.push(this.readFixed32());var a=su(this);for(c=c||[];this.pos<a;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==So.Bytes)return c.push(this.readSFixed32());var a=su(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==So.Bytes)return c.push(this.readFixed64());var a=su(this);for(c=c||[];this.pos<a;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==So.Bytes)return c.push(this.readSFixed64());var a=su(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed64());return c},skip:function(c){var a=7&c;if(a===So.Varint)for(;this.buf[this.pos++]>127;);else if(a===So.Bytes)this.pos=this.readVarint()+this.pos;else if(a===So.Fixed32)this.pos+=4;else{if(a!==So.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(c,a){this.writeVarint(c<<3|a)},realloc:function(c){for(var a=this.length||16;a<this.pos+c;)a*=2;if(a!==this.length){var u=new Uint8Array(a);u.set(this.buf),this.buf=u,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),Qm(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),Qm(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),Qm(this.buf,-1&c,this.pos),Qm(this.buf,Math.floor(c*pc),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),Qm(this.buf,-1&c,this.pos),Qm(this.buf,Math.floor(c*pc),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(a,u){var p,_,b,S;if(a>=0?(p=a%4294967296|0,_=a/4294967296|0):(_=~(-a/4294967296),4294967295^(p=~(-a%4294967296))?p=p+1|0:(p=0,_=_+1|0)),a>=0x10000000000000000||a<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),b=p,(S=u).buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,S.buf[S.pos]=127&(b>>>=7),function(b,w){var S=(7&b)<<4;w.buf[w.pos++]|=S|((b>>>=3)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b)))))}(_,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(Boolean(c))},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var a=this.pos;this.pos=function(p,_,b){for(var w,S,I=0;I<_.length;I++){if((w=_.charCodeAt(I))>55295&&w<57344){if(!S){w>56319||I+1===_.length?(p[b++]=239,p[b++]=191,p[b++]=189):S=w;continue}if(w<56320){p[b++]=239,p[b++]=191,p[b++]=189,S=w;continue}w=S-55296<<10|w-56320|65536,S=null}else S&&(p[b++]=239,p[b++]=191,p[b++]=189,S=null);w<128?p[b++]=w:(w<2048?p[b++]=w>>6|192:(w<65536?p[b++]=w>>12|224:(p[b++]=w>>18|240,p[b++]=w>>12&63|128),p[b++]=w>>6&63|128),p[b++]=63&w|128)}return b}(this.buf,c,this.pos);var u=this.pos-a;u>=128&&Hx(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),N_(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),N_(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var a=c.length;this.writeVarint(a),this.realloc(a);for(var u=0;u<a;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,a){this.pos++;var u=this.pos;c(a,this);var p=this.pos-u;p>=128&&Hx(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeMessage:function(c,a,u){this.writeTag(c,So.Bytes),this.writeRawMessage(a,u)},writePackedVarint:function(c,a){a.length&&this.writeMessage(c,$x,a)},writePackedSVarint:function(c,a){a.length&&this.writeMessage(c,wS,a)},writePackedBoolean:function(c,a){a.length&&this.writeMessage(c,au,a)},writePackedFloat:function(c,a){a.length&&this.writeMessage(c,CS,a)},writePackedDouble:function(c,a){a.length&&this.writeMessage(c,af,a)},writePackedFixed32:function(c,a){a.length&&this.writeMessage(c,TS,a)},writePackedSFixed32:function(c,a){a.length&&this.writeMessage(c,SS,a)},writePackedFixed64:function(c,a){a.length&&this.writeMessage(c,MM,a)},writePackedSFixed64:function(c,a){a.length&&this.writeMessage(c,kM,a)},writeBytesField:function(c,a){this.writeTag(c,So.Bytes),this.writeBytes(a)},writeFixed32Field:function(c,a){this.writeTag(c,So.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(c,a){this.writeTag(c,So.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(c,a){this.writeTag(c,So.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(c,a){this.writeTag(c,So.Fixed64),this.writeSFixed64(a)},writeVarintField:function(c,a){this.writeTag(c,So.Varint),this.writeVarint(a)},writeSVarintField:function(c,a){this.writeTag(c,So.Varint),this.writeSVarint(a)},writeStringField:function(c,a){this.writeTag(c,So.Bytes),this.writeString(a)},writeFloatField:function(c,a){this.writeTag(c,So.Fixed32),this.writeFloat(a)},writeDoubleField:function(c,a){this.writeTag(c,So.Fixed64),this.writeDouble(a)},writeBooleanField:function(c,a){this.writeVarintField(c,Boolean(a))}};class Bv{constructor(a,{pixelRatio:u,version:p,stretchX:_,stretchY:b,content:w}){this.paddedRect=a,this.pixelRatio=u,this.stretchX=_,this.stretchY=b,this.content=w,this.version=p}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class al{constructor(a,u){const p={},_={};this.haveRenderCallbacks=[];const b=[];this.addImages(a,p,b),this.addImages(u,_,b);const{w,h:S}=zv(b),I=new pa({width:w||1,height:S||1});for(const M in a){const z=a[M],j=p[M].paddedRect;pa.copy(z.data,I,{x:0,y:0},{x:j.x+1,y:j.y+1},z.data)}for(const M in u){const z=u[M],j=_[M].paddedRect,H=j.x+1,K=j.y+1,Y=z.data.width,te=z.data.height;pa.copy(z.data,I,{x:0,y:0},{x:H,y:K},z.data),pa.copy(z.data,I,{x:0,y:te-1},{x:H,y:K-1},{width:Y,height:1}),pa.copy(z.data,I,{x:0,y:0},{x:H,y:K+te},{width:Y,height:1}),pa.copy(z.data,I,{x:Y-1,y:0},{x:H-1,y:K},{width:1,height:te}),pa.copy(z.data,I,{x:0,y:0},{x:H+Y,y:K},{width:1,height:te})}this.image=I,this.iconPositions=p,this.patternPositions=_}addImages(a,u,p){for(const _ in a){const b=a[_],w={x:0,y:0,w:b.data.width+2,h:b.data.height+2};p.push(w),u[_]=new Bv(w,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>a.hasImage(p)),a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in a.updatedImages)this.patchUpdatedImage(this.iconPositions[p],a.getImage(p),u),this.patchUpdatedImage(this.patternPositions[p],a.getImage(p),u)}patchUpdatedImage(a,u,p){if(!a||!u||a.version===u.version)return;a.version=u.version;const[_,b]=a.tl;p.update(u.data,void 0,{x:_,y:b})}}dn(Bv,"ImagePosition"),dn(al,"ImageAtlas");const Na={horizontal:1,vertical:2,horizontalOnly:3};class lf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,u){const p=new lf;return p.scale=a||1,p.fontStack=u,p}static forImage(a){const u=new lf;return u.imageName=a,u}}class cf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,u){const p=new cf;for(let _=0;_<a.sections.length;_++){const b=a.sections[_];b.image?p.addImageSection(b):p.addTextSection(b,u)}return p}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(a){this.text=function(u,p){let _="";for(let b=0;b<u.length;b++){const w=u.charCodeAt(b+1)||null,S=u.charCodeAt(b-1)||null;_+=!p&&(w&&B(w)&&!Zm[u[b+1]]||S&&B(S)&&!Zm[u[b-1]])||!Zm[u[b]]?u[b]:Zm[u[b]]}return _}(this.text,a)}trim(){let a=0;for(let p=0;p<this.text.length&&z_[this.text.charCodeAt(p)];p++)a++;let u=this.text.length;for(let p=this.text.length-1;p>=0&&p>=a&&z_[this.text.charCodeAt(p)];p--)u--;this.text=this.text.substring(a,u),this.sectionIndex=this.sectionIndex.slice(a,u)}substring(a,u){const p=new cf;return p.text=this.text.substring(a,u),p.sectionIndex=this.sectionIndex.slice(a,u),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,u)=>Math.max(a,this.sections[u].scale),0)}addTextSection(a,u){this.text+=a.text,this.sections.push(lf.forText(a.scale,a.fontStack||u));const p=this.sections.length-1;for(let _=0;_<a.text.length;++_)this.sectionIndex.push(p)}addImageSection(a){const u=a.image?a.image.name:"";if(0===u.length)return void Mo("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(lf.forImage(u)),this.sectionIndex.push(this.sections.length-1)):Mo("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Vv(c,a,u,p,_,b,w,S,I,M,z,j,H,K,Y){const te=cf.fromFeature(c,_);j===Na.vertical&&te.verticalizePunctuation(H);let ae=[];const we=function(De,tt,Qe,mt,at,lt){if(!De)return[];const bt=[],xt=function(Gt,kn,Yt,fn,Xt,Fn){let Si=0;for(let xi=0;xi<Gt.length();xi++){const _i=Gt.getSection(xi);Si+=Uv(Gt.getCharCode(xi),_i,fn,Xt,kn,Fn)}return Si/Math.max(1,Math.ceil(Si/Yt))}(De,tt,Qe,mt,at,lt),Mt=De.text.indexOf("\u200b")>=0;let Pt=0;for(let Gt=0;Gt<De.length();Gt++){const kn=De.getSection(Gt),Yt=De.getCharCode(Gt);if(z_[Yt]||(Pt+=Uv(Yt,kn,mt,at,tt,lt)),Gt<De.length()-1){const fn=!((ut=Yt)<11904||!(Qy(ut)||zp(ut)||v(ut)||i_(ut)||gm(ut)||Ar(ut)||mm(ut)||Os(ut)||Kc(ut)||Ma(ut)||ol(ut)||x(ut)||ad(ut)||Zc(ut)||Np(ut)||Zr(ut)||ic(ut)||Xc(ut)||_m(ut)||t_(ut)));(IS[Yt]||fn||kn.imageName)&&bt.push(Zx(Gt+1,Pt,xt,bt,DS(Yt,De.getCharCode(Gt+1),fn&&Mt),!1))}}var ut;return Ti(Zx(De.length(),Pt,xt,bt,0,!0))}(te,M,b,a,p,K),{processBidirectionalText:ke,processStyledBidirectionalText:me}=Fe;if(ke&&1===te.sections.length){const De=ke(te.toString(),we);for(const tt of De){const Qe=new cf;Qe.text=tt,Qe.sections=te.sections;for(let mt=0;mt<tt.length;mt++)Qe.sectionIndex.push(0);ae.push(Qe)}}else if(me){const De=me(te.text,te.sectionIndex,we);for(const tt of De){const Qe=new cf;Qe.text=tt[0],Qe.sectionIndex=tt[1],Qe.sections=te.sections,ae.push(Qe)}}else ae=function(De,tt){const Qe=[],mt=De.text;let at=0;for(const lt of tt)Qe.push(De.substring(at,lt)),at=lt;return at<mt.length&&Qe.push(De.substring(at,mt.length)),Qe}(te,we);const Se=[],Oe={positionedLines:Se,text:te.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:j,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(De,tt,Qe,mt,at,lt,bt,xt,Mt,Pt,ut,Gt){let kn=0,Yt=0,fn=0;const Xt="right"===xt?1:"left"===xt?0:.5;let Fn=!1;for(const ti of at){const Ii=ti.getSections();for(const vo of Ii){if(vo.imageName)continue;const W=tt[vo.fontStack];if(W&&(Fn=void 0!==W.ascender&&void 0!==W.descender,!Fn))break}if(!Fn)break}let Si=0;for(const ti of at){ti.trim();const Ii=ti.getMaxScale(),vo=(Ii-1)*dr,W={positionedGlyphs:[],lineOffset:0};De.positionedLines[Si]=W;const Eo=W.positionedGlyphs;let Un=0;if(!ti.length()){Yt+=lt,++Si;continue}let L=0,zo=0;for(let P=0;P<ti.length();P++){const N=ti.getSection(P),Ae=ti.getSectionIndex(P),Wi=ti.getCharCode(P);let wn=N.scale,Pn=null,$t=null,Ye=null,xr=dr,Rr=0;const wr=!(Mt===Na.horizontal||!ut&&!O(Wi)||ut&&(z_[Wi]||(xi=Wi,Ni(xi)||be(xi)||ve(xi)||ld(xi)||m(xi))));if(N.imageName){const Te=mt[N.imageName];if(!Te)continue;Ye=N.imageName,De.iconsInText=De.iconsInText||!0,$t=Te.paddedRect;const Cr=Te.displaySize;wn=wn*dr/Gt,Pn={width:Cr[0],height:Cr[1],left:1,top:-3,advance:wr?Cr[1]:Cr[0],localGlyph:!1},Rr=Fn?-Pn.height*wn:Ii*dr-17-Cr[1]*wn,xr=Pn.advance;const fu=(wr?Cr[0]:Cr[1])*wn-dr*Ii;fu>0&&fu>Un&&(Un=fu)}else{const Te=Qe[N.fontStack];if(!Te)continue;Te[Wi]&&($t=Te[Wi]);const Cr=tt[N.fontStack];if(!Cr)continue;const fu=Cr.glyphs[Wi];if(!fu)continue;if(Pn=fu.metrics,xr=8203!==Wi?dr:0,Fn){const Vh=void 0!==Cr.ascender?Math.abs(Cr.ascender):0,_f=void 0!==Cr.descender?Math.abs(Cr.descender):0,yf=(Vh+_f)*wn;L<yf&&(L=yf,zo=(Vh-_f)/2*wn),Rr=-Vh*wn}else Rr=(Ii-wn)*dr-17}wr?(De.verticalizable=!0,Eo.push({glyph:Wi,imageName:Ye,x:kn,y:Yt+Rr,vertical:wr,scale:wn,localGlyph:Pn.localGlyph,fontStack:N.fontStack,sectionIndex:Ae,metrics:Pn,rect:$t}),kn+=xr*wn+Pt):(Eo.push({glyph:Wi,imageName:Ye,x:kn,y:Yt+Rr,vertical:wr,scale:wn,localGlyph:Pn.localGlyph,fontStack:N.fontStack,sectionIndex:Ae,metrics:Pn,rect:$t}),kn+=Pn.advance*wn+Pt)}0!==Eo.length&&(fn=Math.max(kn-Pt,fn),Fn?jv(Eo,Xt,Un,zo,lt*Ii/2):jv(Eo,Xt,Un,0,lt/2)),kn=0;const es=lt*Ii+Un;W.lineOffset=Math.max(Un,vo),Yt+=es,++Si}var xi;const _i=Yt,{horizontalAlign:zn,verticalAlign:oo}=F(bt);(function(ti,Ii,vo,W,Eo,Un){const L=(Ii-vo)*Eo,zo=-Un*W;for(const es of ti)for(const P of es.positionedGlyphs)P.x+=L,P.y+=zo})(De.positionedLines,Xt,zn,oo,fn,_i),De.top+=-oo*_i,De.bottom=De.top+_i,De.left+=-zn*fn,De.right=De.left+fn,De.hasBaseline=Fn}(Oe,a,u,p,ae,w,S,I,j,M,H,Y),!function(De){for(const tt of De)if(0!==tt.positionedGlyphs.length)return!1;return!0}(Se)&&Oe}const z_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},IS={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Uv(c,a,u,p,_,b){if(a.imageName){const w=p[a.imageName];return w?w.displaySize[0]*a.scale*dr/b+_:0}{const w=u[a.fontStack],S=w&&w.glyphs[c];return S?S.metrics.advance*a.scale+_:0}}function qx(c,a,u,p){const _=Math.pow(c-a,2);return p?c<a?_/2:2*_:_+Math.abs(u)*u}function DS(c,a,u){let p=0;return 10===c&&(p-=1e4),u&&(p+=150),40!==c&&65288!==c||(p+=50),41!==a&&65289!==a||(p+=50),p}function Zx(c,a,u,p,_,b){let w=null,S=qx(a,u,_,b);for(const I of p){const M=qx(a-I.x,u,_,b)+I.badness;M<=S&&(w=I,S=M)}return{index:c,x:a,priorBreak:w,badness:S}}function Ti(c){return c?Ti(c.priorBreak).concat(c.index):[]}function F(c){let a=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:a,verticalAlign:u}}function jv(c,a,u,p,_){if(!(a||u||p||_))return;const b=c.length-1,w=c[b],S=(w.x+w.metrics.advance*w.scale)*a;for(let I=0;I<=b;I++)c[I].x-=S,c[I].y+=u+p+_}function Kx(c,a,u){const{horizontalAlign:p,verticalAlign:_}=F(u),b=a[0]-c.displaySize[0]*p,w=a[1]-c.displaySize[1]*_;return{image:c,top:w,bottom:w+c.displaySize[1],left:b,right:b+c.displaySize[0]}}function Xx(c,a,u,p,_,b){const w=c.image;let S;if(w.content){const ae=w.content,we=w.pixelRatio||1;S=[ae[0]/we,ae[1]/we,w.displaySize[0]-ae[2]/we,w.displaySize[1]-ae[3]/we]}const I=a.left*b,M=a.right*b;let z,j,H,K;"width"===u||"both"===u?(K=_[0]+I-p[3],j=_[0]+M+p[1]):(K=_[0]+(I+M-w.displaySize[0])/2,j=K+w.displaySize[0]);const Y=a.top*b,te=a.bottom*b;return"height"===u||"both"===u?(z=_[1]+Y-p[0],H=_[1]+te+p[2]):(z=_[1]+(Y+te-w.displaySize[1])/2,H=z+w.displaySize[1]),{image:w,top:z,right:j,bottom:H,left:K,collisionPadding:S}}class lu extends Ue{constructor(a,u,p,_,b){super(a,u),this.angle=_,this.z=p,void 0!==b&&(this.segment=b)}clone(){return new lu(this.x,this.y,this.z,this.angle,this.segment)}}function Hv(c,a,u,p,_){if(void 0===a.segment)return!0;let b=a,w=a.segment+1,S=0;for(;S>-u/2;){if(w--,w<0)return!1;S-=c[w].dist(b),b=c[w]}S+=c[w].dist(c[w+1]),w++;const I=[];let M=0;for(;S<u/2;){const z=c[w],j=c[w+1];if(!j)return!1;let H=c[w-1].angleTo(z)-z.angleTo(j);for(H=Math.abs((H+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:S,angleDelta:H}),M+=H;S-I[0].distance>p;)M-=I.shift().angleDelta;if(M>_)return!1;w++,S+=z.dist(j)}return!0}function Yx(c){let a=0;for(let u=0;u<c.length-1;u++)a+=c[u].dist(c[u+1]);return a}function $v(c,a,u){return c?.6*a*u:0}function Qx(c,a){return Math.max(c?c.right-c.left:0,a?a.right-a.left:0)}function MS(c,a,u,p,_,b){const w=$v(u,_,b),S=Qx(u,p)*b;let I=0;const M=Yx(c)/2;for(let z=0;z<c.length-1;z++){const j=c[z],H=c[z+1],K=j.dist(H);if(I+K>M){const Y=(M-I)/K,te=ki(j.x,H.x,Y),ae=ki(j.y,H.y,Y),we=new lu(te,ae,0,H.angleTo(j),z);return!w||Hv(c,we,S,w,a)?we:void 0}I+=K}}function AM(c,a,u,p,_,b,w,S,I){const M=$v(p,b,w),z=Qx(p,_),j=z*w,H=0===c[0].x||c[0].x===I||0===c[0].y||c[0].y===I;return a-j<a/4&&(a=j+a/4),Gv(c,H?a/2*S%a:(z/2+2*b)*w*S%a,a,M,u,j,H,!1,I)}function Gv(c,a,u,p,_,b,w,S,I){const M=b/2,z=Yx(c);let j=0,H=a-u,K=[];for(let Y=0;Y<c.length-1;Y++){const te=c[Y],ae=c[Y+1],we=te.dist(ae),ke=ae.angleTo(te);for(;H+u<j+we;){H+=u;const me=(H-j)/we,Se=ki(te.x,ae.x,me),Oe=ki(te.y,ae.y,me);if(Se>=0&&Se<I&&Oe>=0&&Oe<I&&H-M>=0&&H+M<=z){const De=new lu(Se,Oe,0,ke,Y);De._round(),p&&!Hv(c,De,b,p,_)||K.push(De)}}j+=we}return S||K.length||w||(K=Gv(c,j/2,u,p,_,b,w,!0,I)),K}function Wv(c,a,u,p,_){const b=[];for(let w=0;w<c.length;w++){const S=c[w];let I;for(let M=0;M<S.length-1;M++){let z=S[M],j=S[M+1];z.x<a&&j.x<a||(z.x<a?z=new Ue(a,z.y+(a-z.x)/(j.x-z.x)*(j.y-z.y))._round():j.x<a&&(j=new Ue(a,z.y+(a-z.x)/(j.x-z.x)*(j.y-z.y))._round()),z.y<u&&j.y<u||(z.y<u?z=new Ue(z.x+(u-z.y)/(j.y-z.y)*(j.x-z.x),u)._round():j.y<u&&(j=new Ue(z.x+(u-z.y)/(j.y-z.y)*(j.x-z.x),u)._round()),z.x>=p&&j.x>=p||(z.x>=p?z=new Ue(p,z.y+(p-z.x)/(j.x-z.x)*(j.y-z.y))._round():j.x>=p&&(j=new Ue(p,z.y+(p-z.x)/(j.x-z.x)*(j.y-z.y))._round()),z.y>=_&&j.y>=_||(z.y>=_?z=new Ue(z.x+(_-z.y)/(j.y-z.y)*(j.x-z.x),_)._round():j.y>=_&&(j=new Ue(z.x+(_-z.y)/(j.y-z.y)*(j.x-z.x),_)._round()),I&&z.equals(I[I.length-1])||(I=[z],b.push(I)),I.push(j)))))}}return b}dn(lu,"Anchor");const Fs=1e20;function Jx(c,a,u,p,_,b,w,S,I){for(let M=a;M<a+p;M++)B_(c,u*b+M,b,_,w,S,I);for(let M=u;M<u+_;M++)B_(c,M*b+a,1,p,w,S,I)}function B_(c,a,u,p,_,b,w){b[0]=0,w[0]=-Fs,w[1]=Fs,_[0]=c[a];for(let S=1,I=0,M=0;S<p;S++){_[S]=c[a+S*u];const z=S*S;do{const j=b[I];M=(_[S]-_[j]+z-j*j)/(S-j)/2}while(M<=w[I]&&--I>-1);I++,b[I]=S,w[I]=M,w[I+1]=Fs}for(let S=0,I=0;S<p;S++){for(;w[I+1]<S;)I++;const M=b[I],z=S-M;c[a+S*u]=_[M]+z*z}}const Jm={none:0,ideographs:1,all:2};class uf{constructor(a,u,p){this.requestManager=a,this.localGlyphMode=u,this.localFontFamily=p,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a){this.url=a}getGlyphs(a,u){const p=[];for(const _ in a)for(const b of a[_])p.push({stack:_,id:b});na(p,({stack:_,id:b},w)=>{let S=this.entries[_];S||(S=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let I=S.glyphs[b];if(void 0!==I)return void w(null,{stack:_,id:b,glyph:I});if(I=this._tinySDF(S,_,b),I)return S.glyphs[b]=I,void w(null,{stack:_,id:b,glyph:I});const M=Math.floor(b/256);if(256*M>65535)return void w(new Error("glyphs > 65535 not supported"));if(S.ranges[M])return void w(null,{stack:_,id:b,glyph:I});let z=S.requests[M];z||(z=S.requests[M]=[],uf.loadGlyphRange(_,M,this.url,this.requestManager,(j,H)=>{if(H){S.ascender=H.ascender,S.descender=H.descender;for(const K in H.glyphs)this._doesCharSupportLocalGlyph(+K)||(S.glyphs[+K]=H.glyphs[+K]);S.ranges[M]=!0}for(const K of z)K(j,H);delete S.requests[M]})),z.push((j,H)=>{j?w(j):H&&w(null,{stack:_,id:b,glyph:H.glyphs[b]||null})})},(_,b)=>{if(_)u(_);else if(b){const w={};for(const{stack:S,id:I,glyph:M}of b)void 0===w[S]&&(w[S]={}),void 0===w[S].glyphs&&(w[S].glyphs={}),w[S].glyphs[I]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},w[S].ascender=this.entries[S].ascender,w[S].descender=this.entries[S].descender;u(null,w)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==Jm.none&&(this.localGlyphMode===Jm.all?!!this.localFontFamily:!!this.localFontFamily&&(Ma(a)||n_(a)||ad(a)||ic(a)||Os(a)))}_tinySDF(a,u,p){const _=this.localFontFamily;if(!_||!this._doesCharSupportLocalGlyph(p))return;let b=a.tinySDF;if(!b){let te="400";/bold/i.test(u)?te="900":/medium/i.test(u)?te="500":/light/i.test(u)&&(te="200"),b=a.tinySDF=new uf.TinySDF({fontFamily:_,fontWeight:te,fontSize:48,buffer:6,radius:16}),b.fontWeight=te}if(this.localGlyphs[b.fontWeight][p])return this.localGlyphs[b.fontWeight][p];const w=String.fromCharCode(p),{data:S,width:I,height:M,glyphWidth:z,glyphHeight:j,glyphLeft:H,glyphTop:K,glyphAdvance:Y}=b.draw(w);return this.localGlyphs[b.fontWeight][p]={id:p,bitmap:new ha({width:I,height:M},S),metrics:{width:z/2,height:j/2,left:H/2,top:K/2-27,advance:Y/2,localGlyph:!0}}}}function kS(c,a,u,p){const _=[],b=c.image,w=b.pixelRatio,S=b.paddedRect.w-2,I=b.paddedRect.h-2,M=c.right-c.left,z=c.bottom-c.top,j=b.stretchX||[[0,S]],H=b.stretchY||[[0,I]],K=(lt,bt)=>lt+bt[1]-bt[0],Y=j.reduce(K,0),te=H.reduce(K,0),ae=S-Y,we=I-te;let ke=0,me=Y,Se=0,Oe=te,De=0,tt=ae,Qe=0,mt=we;if(b.content&&p){const lt=b.content;ke=qv(j,0,lt[0]),Se=qv(H,0,lt[1]),me=qv(j,lt[0],lt[2]),Oe=qv(H,lt[1],lt[3]),De=lt[0]-ke,Qe=lt[1]-Se,tt=lt[2]-lt[0]-me,mt=lt[3]-lt[1]-Oe}const at=(lt,bt,xt,Mt)=>{const Pt=V_(lt.stretch-ke,me,M,c.left),ut=eg(lt.fixed-De,tt,lt.stretch,Y),Gt=V_(bt.stretch-Se,Oe,z,c.top),kn=eg(bt.fixed-Qe,mt,bt.stretch,te),Yt=V_(xt.stretch-ke,me,M,c.left),fn=eg(xt.fixed-De,tt,xt.stretch,Y),Xt=V_(Mt.stretch-Se,Oe,z,c.top),Fn=eg(Mt.fixed-Qe,mt,Mt.stretch,te),Si=new Ue(Pt,Gt),xi=new Ue(Yt,Gt),_i=new Ue(Yt,Xt),zn=new Ue(Pt,Xt),oo=new Ue(ut/w,kn/w),ti=new Ue(fn/w,Fn/w),Ii=a*Math.PI/180;if(Ii){const Eo=Math.sin(Ii),Un=Math.cos(Ii),L=[Un,-Eo,Eo,Un];Si._matMult(L),xi._matMult(L),zn._matMult(L),_i._matMult(L)}const vo=lt.stretch+lt.fixed,W=bt.stretch+bt.fixed;return{tl:Si,tr:xi,bl:zn,br:_i,tex:{x:b.paddedRect.x+1+vo,y:b.paddedRect.y+1+W,w:xt.stretch+xt.fixed-vo,h:Mt.stretch+Mt.fixed-W},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:oo,pixelOffsetBR:ti,minFontScaleX:tt/w/M,minFontScaleY:mt/w/z,isSDF:u}};if(p&&(b.stretchX||b.stretchY)){const lt=AS(j,ae,Y),bt=AS(H,we,te);for(let xt=0;xt<lt.length-1;xt++){const Mt=lt[xt],Pt=lt[xt+1];for(let ut=0;ut<bt.length-1;ut++)_.push(at(Mt,bt[ut],Pt,bt[ut+1]))}}else _.push(at({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:I+1}));return _}function qv(c,a,u){let p=0;for(const _ of c)p+=Math.max(a,Math.min(u,_[1]))-Math.max(a,Math.min(u,_[0]));return p}function AS(c,a,u){const p=[{fixed:-1,stretch:0}];for(const[_,b]of c){const w=p[p.length-1];p.push({fixed:_-w.stretch,stretch:w.stretch}),p.push({fixed:_-w.stretch,stretch:w.stretch+(b-_)})}return p.push({fixed:a+1,stretch:u}),p}function V_(c,a,u,p){return c/a*u+p}function eg(c,a,u,p){return c-a*u/p}function PM(c,a,u,p){const _=a+c.positionedLines[p].lineOffset;return 0===p?u+_/2:u+(_+(a+c.positionedLines[p-1].lineOffset))/2}uf.loadGlyphRange=function(c,a,u,p,_){const b=256*a,w=b+255,S=p.transformRequest(p.normalizeGlyphsURL(u).replace("{fontstack}",c).replace("{range}",`${b}-${w}`),Wd.Glyphs);Ru(S,(I,M)=>{if(I)_(I);else if(M){const z={},j=new Km(M).readFields(Gx,{});for(const H of j.glyphs)z[H.id]=H;_(null,{glyphs:z,ascender:j.ascender,descender:j.descender})}})},uf.TinySDF=class{constructor({fontSize:c=24,buffer:a=3,radius:u=8,cutoff:p=.25,fontFamily:_="sans-serif",fontWeight:b="normal",fontStyle:w="normal"}={}){this.buffer=a,this.cutoff=p,this.radius=u;const S=this.size=c+4*a,I=this._createCanvas(S),M=this.ctx=I.getContext("2d",{willReadFrequently:!0});M.font=`${w} ${b} ${c}px ${_}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(c){const a=document.createElement("canvas");return a.width=a.height=c,a}draw(c){const{width:a,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:_,actualBoundingBoxRight:b}=this.ctx.measureText(c),w=Math.ceil(u),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-_))),I=Math.min(this.size-this.buffer,w+Math.ceil(p)),M=S+2*this.buffer,z=I+2*this.buffer,j=Math.max(M*z,0),H=new Uint8ClampedArray(j),K={data:H,width:M,height:z,glyphWidth:S,glyphHeight:I,glyphTop:w,glyphLeft:0,glyphAdvance:a};if(0===S||0===I)return K;const{ctx:Y,buffer:te,gridInner:ae,gridOuter:we}=this;Y.clearRect(te,te,S,I),Y.fillText(c,te,te+w);const ke=Y.getImageData(te,te,S,I);we.fill(Fs,0,j),ae.fill(0,0,j);for(let me=0;me<I;me++)for(let Se=0;Se<S;Se++){const Oe=ke.data[4*(me*S+Se)+3]/255;if(0===Oe)continue;const De=(me+te)*M+Se+te;if(1===Oe)we[De]=0,ae[De]=Fs;else{const tt=.5-Oe;we[De]=tt>0?tt*tt:0,ae[De]=tt<0?tt*tt:0}}Jx(we,0,0,M,z,M,this.f,this.v,this.z),Jx(ae,te,te,S,I,M,this.f,this.v,this.z);for(let me=0;me<j;me++){const Se=Math.sqrt(we[me])-Math.sqrt(ae[me]);H[me]=Math.round(255-255*(Se/this.radius+this.cutoff))}return K}};class PS{constructor(a=[],u=df){if(this.data=a,this.length=this.data.length,this.compare=u,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const a=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:u,compare:p}=this,_=u[a];for(;a>0;){const b=a-1>>1,w=u[b];if(p(_,w)>=0)break;u[a]=w,a=b}u[a]=_}_down(a){const{data:u,compare:p}=this,_=this.length>>1,b=u[a];for(;a<_;){let w=1+(a<<1),S=u[w];const I=w+1;if(I<this.length&&p(u[I],S)<0&&(w=I,S=u[I]),p(S,b)>=0)break;u[a]=S,a=w}u[a]=b}}function df(c,a){return c<a?-1:c>a?1:0}function OS(c,a=1,u=!1){let p=1/0,_=1/0,b=-1/0,w=-1/0;const S=c[0];for(let K=0;K<S.length;K++){const Y=S[K];(!K||Y.x<p)&&(p=Y.x),(!K||Y.y<_)&&(_=Y.y),(!K||Y.x>b)&&(b=Y.x),(!K||Y.y>w)&&(w=Y.y)}const I=Math.min(b-p,w-_);let M=I/2;const z=new PS([],e1);if(0===I)return new Ue(p,_);for(let K=p;K<b;K+=I)for(let Y=_;Y<w;Y+=I)z.push(new cu(K+M,Y+M,M,c));let j=function(K){let Y=0,te=0,ae=0;const we=K[0];for(let ke=0,me=we.length,Se=me-1;ke<me;Se=ke++){const Oe=we[ke],De=we[Se],tt=Oe.x*De.y-De.x*Oe.y;te+=(Oe.x+De.x)*tt,ae+=(Oe.y+De.y)*tt,Y+=3*tt}return new cu(te/Y,ae/Y,0,K)}(c),H=z.length;for(;z.length;){const K=z.pop();(K.d>j.d||!j.d)&&(j=K,u&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,H)),K.max-j.d<=a||(M=K.h/2,z.push(new cu(K.p.x-M,K.p.y-M,M,c)),z.push(new cu(K.p.x+M,K.p.y-M,M,c)),z.push(new cu(K.p.x-M,K.p.y+M,M,c)),z.push(new cu(K.p.x+M,K.p.y+M,M,c)),H+=4)}return u&&(console.log(`num probes: ${H}`),console.log(`best distance: ${j.d}`)),j.p}function e1(c,a){return a.max-c.max}function cu(c,a,u,p){this.p=new Ue(c,a),this.h=u,this.d=function(_,b){let w=!1,S=1/0;for(let I=0;I<b.length;I++){const M=b[I];for(let z=0,j=M.length,H=j-1;z<j;H=z++){const K=M[z],Y=M[H];K.y>_.y!=Y.y>_.y&&_.x<(Y.x-K.x)*(_.y-K.y)/(Y.y-K.y)+K.x&&(w=!w),S=Math.min(S,bv(_,K,Y))}}return(w?1:-1)*Math.sqrt(S)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}const Zv=Number.POSITIVE_INFINITY,t1=Math.sqrt(2);function n1(c,[a,u]){let p=0,_=0;if(u===Zv){a<0&&(a=0);const b=a/t1;switch(c){case"top-right":case"top-left":_=b-7;break;case"bottom-right":case"bottom-left":_=7-b;break;case"bottom":_=7-a;break;case"top":_=a-7}switch(c){case"top-right":case"bottom-right":p=-b;break;case"top-left":case"bottom-left":p=b;break;case"left":p=a;break;case"right":p=-a}}else{switch(a=Math.abs(a),u=Math.abs(u),c){case"top-right":case"top-left":case"top":_=u-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-u}switch(c){case"top-right":case"bottom-right":case"right":p=-a;break;case"top-left":case"bottom-left":case"left":p=a}}return[p,_]}function LS(c,a,u,p,_,b,w,S,I,M){c.createArrays(),c.tilePixelRatio=Gn/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const z=c.layers[0].layout,j=c.layers[0]._unevaluatedLayout._values,H={};if("composite"===c.textSizeData.kind){const{minZoom:te,maxZoom:ae}=c.textSizeData;H.compositeTextSizes=[j["text-size"].possiblyEvaluate(new $e(te),S),j["text-size"].possiblyEvaluate(new $e(ae),S)]}if("composite"===c.iconSizeData.kind){const{minZoom:te,maxZoom:ae}=c.iconSizeData;H.compositeIconSizes=[j["icon-size"].possiblyEvaluate(new $e(te),S),j["icon-size"].possiblyEvaluate(new $e(ae),S)]}H.layoutTextSize=j["text-size"].possiblyEvaluate(new $e(I+1),S),H.layoutIconSize=j["icon-size"].possiblyEvaluate(new $e(I+1),S),H.textMaxSize=j["text-size"].possiblyEvaluate(new $e(18),S);const K="map"===z.get("text-rotation-alignment")&&"point"!==z.get("symbol-placement"),Y=z.get("text-size");for(const te of c.features){const ae=z.get("text-font").evaluate(te,{},S).join(","),we=Y.evaluate(te,{},S),ke=H.layoutTextSize.evaluate(te,{},S),me=(H.layoutIconSize.evaluate(te,{},S),{horizontal:{},vertical:void 0}),Se=te.text;let Oe,De=[0,0];if(Se){const mt=Se.toString(),at=z.get("text-letter-spacing").evaluate(te,{},S)*dr,lt=z.get("text-line-height").evaluate(te,{},S)*dr,bt=E(mt)?at:0,xt=z.get("text-anchor").evaluate(te,{},S),Mt=z.get("text-variable-anchor");if(!Mt){const Yt=z.get("text-radial-offset").evaluate(te,{},S);De=Yt?n1(xt,[Yt*dr,Zv]):z.get("text-offset").evaluate(te,{},S).map(fn=>fn*dr)}let Pt=K?"center":z.get("text-justify").evaluate(te,{},S);const ut="point"===z.get("symbol-placement"),Gt=ut?z.get("text-max-width").evaluate(te,{},S)*dr:1/0,kn=Yt=>{c.allowVerticalPlacement&&T(mt)&&(me.vertical=Vv(Se,a,u,_,ae,Gt,lt,xt,Yt,bt,De,Na.vertical,!0,ke,we))};if(!K&&Mt){const Yt="auto"===Pt?Mt.map(Xt=>Kv(Xt)):[Pt];let fn=!1;for(let Xt=0;Xt<Yt.length;Xt++){const Fn=Yt[Xt];if(!me.horizontal[Fn])if(fn)me.horizontal[Fn]=me.horizontal[0];else{const Si=Vv(Se,a,u,_,ae,Gt,lt,"center",Fn,bt,De,Na.horizontal,!1,ke,we);Si&&(me.horizontal[Fn]=Si,fn=1===Si.positionedLines.length)}}kn("left")}else{if("auto"===Pt&&(Pt=Kv(xt)),ut||z.get("text-writing-mode").indexOf("horizontal")>=0||!T(mt)){const Yt=Vv(Se,a,u,_,ae,Gt,lt,xt,Pt,bt,De,Na.horizontal,!1,ke,we);Yt&&(me.horizontal[Pt]=Yt)}kn(ut?"left":Pt)}}let tt=!1;if(te.icon&&te.icon.name){const mt=p[te.icon.name];mt&&(Oe=Kx(_[te.icon.name],z.get("icon-offset").evaluate(te,{},S),z.get("icon-anchor").evaluate(te,{},S)),tt=mt.sdf,void 0===c.sdfIcons?c.sdfIcons=mt.sdf:c.sdfIcons!==mt.sdf&&Mo("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mt.pixelRatio!==c.pixelRatio||0!==z.get("icon-rotate").constantOr(1))&&(c.iconsNeedLinear=!0))}const Qe=o1(me.horizontal)||me.vertical;c.iconsInText||(c.iconsInText=!!Qe&&Qe.iconsInText),(Qe||Oe)&&RS(c,te,me,Oe,p,H,ke,0,De,tt,w,S,M)}b&&c.generateCollisionDebugBuffers(I,c.collisionBoxArray)}function Kv(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function RS(c,a,u,p,_,b,w,S,I,M,z,j,H){let K=b.textMaxSize.evaluate(a,{},j);void 0===K&&(K=w);const Y=c.layers[0].layout,te=Y.get("icon-offset").evaluate(a,{},j),ae=o1(u.horizontal)||u.vertical,we="globe"===H.name,ke=w/24,me=c.tilePixelRatio*K/24,Se=(bt=c.overscaling,c.zoom>18&&bt>2&&(bt>>=1),Math.max(Gn/(512*bt),1)*Y.get("symbol-spacing")),Oe=Y.get("text-padding")*c.tilePixelRatio,De=Y.get("icon-padding")*c.tilePixelRatio,tt=wt(Y.get("text-max-angle")),Qe="map"===Y.get("text-rotation-alignment")&&"point"!==Y.get("symbol-placement"),mt="map"===Y.get("icon-rotation-alignment")&&"point"!==Y.get("symbol-placement"),at=Y.get("symbol-placement"),lt=Se/2;var bt;const xt=Y.get("icon-text-fit");let Mt;p&&"none"!==xt&&(c.allowVerticalPlacement&&u.vertical&&(Mt=Xx(p,u.vertical,xt,Y.get("icon-text-fit-padding"),te,ke)),ae&&(p=Xx(p,ae,xt,Y.get("icon-text-fit-padding"),te,ke)));const Pt=(ut,Gt,kn)=>{if(Gt.x<0||Gt.x>=Gn||Gt.y<0||Gt.y>=Gn)return;let Yt=null;if(we){const{x:fn,y:Xt,z:Fn}=H.projectTilePoint(Gt.x,Gt.y,kn);Yt={anchor:new lu(fn,Xt,Fn,0,void 0),up:H.upVector(kn,Gt.x,Gt.y)}}!function(fn,Xt,Fn,Si,xi,_i,zn,oo,ti,Ii,vo,W,Eo,Un,L,zo,es,P,N,Ae,Wi,wn,Pn,$t,Ye){const xr=fn.addToLineVertexArray(Xt,Si);let Rr,wr,Te,Cr,fu,Vh,_f,yf=0,U=0,y1=0,hr=0,ro=-1,Ai=-1;const ul={};let fb=Qc("");const Cd=Fn?Fn.anchor:Xt;let Q_=0,J_=0;if(void 0===ti._unevaluatedLayout.getValue("text-radial-offset")?[Q_,J_]=ti.layout.get("text-offset").evaluate(Wi,{},Ye).map(Ys=>Ys*dr):(Q_=ti.layout.get("text-radial-offset").evaluate(Wi,{},Ye)*dr,J_=Zv),fn.allowVerticalPlacement&&xi.vertical){const Ys=xi.vertical;if(L)Vh=U_(Ys),oo&&(_f=U_(oo));else{const bs=ti.layout.get("text-rotate").evaluate(Wi,{},Ye)+90;Te=tg(Ii,Cd,Xt,vo,W,Eo,Ys,Un,bs,zo),oo&&(Cr=tg(Ii,Cd,Xt,vo,W,Eo,oo,P,bs))}}if(_i){const Ys=ti.layout.get("icon-rotate").evaluate(Wi,{},Ye),bs="none"!==ti.layout.get("icon-text-fit"),dl=kS(_i,Ys,Pn,bs),mb=oo?kS(oo,Ys,Pn,bs):void 0;wr=tg(Ii,Cd,Xt,vo,W,Eo,_i,P,Ys),yf=4*dl.length;const b1=fn.iconSizeData;let gu=null;"source"===b1.kind?(gu=[hc*ti.layout.get("icon-size").evaluate(Wi,{},Ye)],gu[0]>vd&&Mo(`${fn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===b1.kind&&(gu=[hc*wn.compositeIconSizes[0].evaluate(Wi,{},Ye),hc*wn.compositeIconSizes[1].evaluate(Wi,{},Ye)],(gu[0]>vd||gu[1]>vd)&&Mo(`${fn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),fn.addSymbols(fn.icon,dl,gu,Ae,N,Wi,!1,Fn,Xt,xr.lineStartIndex,xr.lineLength,-1,$t,Ye),ro=fn.icon.placedSymbolArray.length-1,mb&&(U=4*mb.length,fn.addSymbols(fn.icon,mb,gu,Ae,N,Wi,Na.vertical,Fn,Xt,xr.lineStartIndex,xr.lineLength,-1,$t,Ye),Ai=fn.icon.placedSymbolArray.length-1)}for(const Ys in xi.horizontal){const bs=xi.horizontal[Ys];Rr||(fb=Qc(bs.text),L?fu=U_(bs):Rr=tg(Ii,Cd,Xt,vo,W,Eo,bs,Un,ti.layout.get("text-rotate").evaluate(Wi,{},Ye),zo));const dl=1===bs.positionedLines.length;if(y1+=Xv(fn,Fn,Xt,bs,zn,ti,L,Wi,zo,xr,xi.vertical?Na.horizontal:Na.horizontalOnly,dl?Object.keys(xi.horizontal):[Ys],ul,ro,wn,$t,Ye),dl)break}xi.vertical&&(hr+=Xv(fn,Fn,Xt,xi.vertical,zn,ti,L,Wi,zo,xr,Na.vertical,["vertical"],ul,Ai,wn,$t,Ye));let mu=-1;const ey=(Ys,bs)=>Ys?Math.max(Ys,bs):bs;mu=ey(fu,mu),mu=ey(Vh,mu),mu=ey(_f,mu);const v1=mu>-1?1:0;fn.glyphOffsetArray.length>=du.MAX_GLYPHS&&Mo("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Wi.sortKey&&fn.addToSortKeyRanges(fn.symbolInstances.length,Wi.sortKey),fn.symbolInstances.emplaceBack(Cd.x,Cd.y,Cd.z,Xt.x,Xt.y,ul.right>=0?ul.right:-1,ul.center>=0?ul.center:-1,ul.left>=0?ul.left:-1,ul.vertical>=0?ul.vertical:-1,ro,Ai,fb,void 0!==Rr?Rr:fn.collisionBoxArray.length,void 0!==Rr?Rr+1:fn.collisionBoxArray.length,void 0!==Te?Te:fn.collisionBoxArray.length,void 0!==Te?Te+1:fn.collisionBoxArray.length,void 0!==wr?wr:fn.collisionBoxArray.length,void 0!==wr?wr+1:fn.collisionBoxArray.length,Cr||fn.collisionBoxArray.length,Cr?Cr+1:fn.collisionBoxArray.length,vo,y1,hr,yf,U,v1,0,Q_,J_,mu)}(c,Gt,Yt,ut,u,p,_,Mt,c.layers[0],c.collisionBoxArray,a.index,a.sourceLayerIndex,c.index,Oe,Qe,I,0,De,mt,te,a,b,M,z,j)};if("line"===at)for(const ut of Wv(a.geometry,0,0,Gn,Gn)){const Gt=AM(ut,Se,tt,u.vertical||ae,p,24,me,c.overscaling,Gn);for(const kn of Gt)ae&&Yv(c,ae.text,lt,kn)||Pt(ut,kn,j)}else if("line-center"===at){for(const ut of a.geometry)if(ut.length>1){const Gt=MS(ut,tt,u.vertical||ae,p,24,me);Gt&&Pt(ut,Gt,j)}}else if("Polygon"===a.type)for(const ut of Sx(a.geometry,0)){const Gt=OS(ut,16);Pt(ut[0],new lu(Gt.x,Gt.y,0,0,void 0),j)}else if("LineString"===a.type)for(const ut of a.geometry)Pt(ut,new lu(ut[0].x,ut[0].y,0,0,void 0),j);else if("Point"===a.type)for(const ut of a.geometry)for(const Gt of ut)Pt([Gt],new lu(Gt.x,Gt.y,0,0,void 0),j)}const vd=32640;function Xv(c,a,u,p,_,b,w,S,I,M,z,j,H,K,Y,te,ae){const we=function(Se,Oe,De,tt,Qe,mt,at,lt){const bt=[];if(0===Oe.positionedLines.length)return bt;const xt=tt.layout.get("text-rotate").evaluate(mt,{})*Math.PI/180,Mt=function(Yt){const fn=Yt[0],Xt=Yt[1],Fn=fn*Xt;return Fn>0?[fn,-Xt]:Fn<0?[-fn,Xt]:0===fn?[Xt,fn]:[Xt,-fn]}(De);let Pt=Math.abs(Oe.top-Oe.bottom);for(const Yt of Oe.positionedLines)Pt-=Yt.lineOffset;const ut=Oe.positionedLines.length,Gt=Pt/ut;let kn=Oe.top-De[1];for(let Yt=0;Yt<ut;++Yt){const fn=Oe.positionedLines[Yt];kn=PM(Oe,Gt,kn,Yt);for(const Xt of fn.positionedGlyphs){if(!Xt.rect)continue;const Fn=Xt.rect||{};let Si=4,xi=!0,_i=1,zn=0;if(Xt.imageName){const $t=at[Xt.imageName];if(!$t)continue;if($t.sdf){Mo("SDF images are not supported in formatted text and will be ignored.");continue}xi=!1,_i=$t.pixelRatio,Si=1/_i}const oo=(Qe||lt)&&Xt.vertical,ti=Xt.metrics.advance*Xt.scale/2,Ii=Xt.metrics,vo=Xt.rect;if(null===vo)continue;lt&&Oe.verticalizable&&(zn=Xt.imageName?ti-Xt.metrics.width*Xt.scale/2:0);const W=Qe?[Xt.x+ti,Xt.y]:[0,0];let Eo=[0,0],Un=[0,0],L=!1;Qe||(oo?(Un=[Xt.x+ti+Mt[0],Xt.y+Mt[1]-zn],L=!0):Eo=[Xt.x+ti+De[0],Xt.y+De[1]-zn]);const zo=vo.w*Xt.scale/(_i*(Xt.localGlyph?2:1)),es=vo.h*Xt.scale/(_i*(Xt.localGlyph?2:1));let P,N,Ae,Wi;if(oo){const $t=Xt.y-kn,Ye=new Ue(-ti,ti-$t),xr=-Math.PI/2,Rr=new Ue(...Un);P=new Ue(-ti+Eo[0],Eo[1]),P._rotateAround(xr,Ye)._add(Rr),P.x+=-$t+ti,P.y-=(Ii.left-Si)*Xt.scale;const wr=Xt.imageName?Ii.advance*Xt.scale:dr*Xt.scale,Te=String.fromCharCode(Xt.glyph);xS(Te)?P.x+=(1-Si)*Xt.scale:Rh(Te)?P.x+=wr-Ii.height*Xt.scale+(-Si-1)*Xt.scale:P.x+=Xt.imageName||Ii.width+2*Si===vo.w&&Ii.height+2*Si===vo.h?(wr-es)/2:(wr-(Ii.height+2*Si)*Xt.scale)/2,N=new Ue(P.x,P.y-zo),Ae=new Ue(P.x+es,P.y),Wi=new Ue(P.x+es,P.y-zo)}else{const $t=(Ii.left-Si)*Xt.scale-ti+Eo[0],Ye=(-Ii.top-Si)*Xt.scale+Eo[1],xr=$t+zo,Rr=Ye+es;P=new Ue($t,Ye),N=new Ue(xr,Ye),Ae=new Ue($t,Rr),Wi=new Ue(xr,Rr)}if(xt){let $t;$t=Qe?new Ue(0,0):L?new Ue(Mt[0],Mt[1]):new Ue(De[0],De[1]),P._rotateAround(xt,$t),N._rotateAround(xt,$t),Ae._rotateAround(xt,$t),Wi._rotateAround(xt,$t)}const wn=new Ue(0,0),Pn=new Ue(0,0);bt.push({tl:P,tr:N,bl:Ae,br:Wi,tex:Fn,writingMode:Oe.writingMode,glyphOffset:W,sectionIndex:Xt.sectionIndex,isSDF:xi,pixelOffsetTL:wn,pixelOffsetBR:Pn,minFontScaleX:0,minFontScaleY:0})}}return bt}(0,p,I,b,w,S,_,c.allowVerticalPlacement),ke=c.textSizeData;let me=null;"source"===ke.kind?(me=[hc*b.layout.get("text-size").evaluate(S,{},ae)],me[0]>vd&&Mo(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===ke.kind&&(me=[hc*Y.compositeTextSizes[0].evaluate(S,{},ae),hc*Y.compositeTextSizes[1].evaluate(S,{},ae)],(me[0]>vd||me[1]>vd)&&Mo(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,we,me,I,w,S,z,a,u,M.lineStartIndex,M.lineLength,K,te,ae);for(const Se of j)H[Se]=c.text.placedSymbolArray.length-1;return 4*we.length}function o1(c){for(const a in c)return c[a];return null}function tg(c,a,u,p,_,b,w,S,I,M){let z=w.top,j=w.bottom,H=w.left,K=w.right;const Y=w.collisionPadding;if(Y&&(H-=Y[0],z-=Y[1],K+=Y[2],j+=Y[3]),I){const te=new Ue(H,z),ae=new Ue(K,z),we=new Ue(H,j),ke=new Ue(K,j),me=wt(I);let Se=new Ue(0,0);M&&(Se=new Ue(M[0],M[1])),te._rotateAround(me,Se),ae._rotateAround(me,Se),we._rotateAround(me,Se),ke._rotateAround(me,Se),H=Math.min(te.x,ae.x,we.x,ke.x),K=Math.max(te.x,ae.x,we.x,ke.x),z=Math.min(te.y,ae.y,we.y,ke.y),j=Math.max(te.y,ae.y,we.y,ke.y)}return c.emplaceBack(a.x,a.y,a.z,u.x,u.y,H,z,K,j,S,p,_,b),c.length-1}function U_(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const a=c.bottom-c.top;return a>0?Math.max(10,a):null}function Yv(c,a,u,p){const _=c.compareText;if(a in _){const b=_[a];for(let w=b.length-1;w>=0;w--)if(p.dist(b[w])<u)return!0}else _[a]=[];return _[a].push(p),!1}function FS(c,a){const u=c.fovAboveCenter,p=c.elevation?c.elevation.getMinElevationBelowMSL()*a:0,_=(c._camera.position[2]*c.worldSize-p)/Math.cos(c._pitch),b=Math.sin(u)*_/Math.sin(Math.max(Math.PI/2-c._pitch-u,.01)),w=Math.sin(c._pitch)*b+_;return Math.min(1.01*w,_*(1/c._horizonShift))}function uu(c,a){if(!a.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:a};const u=Math.pow(2,-c.z),p=c.x*u,_=(c.x+1)*u,b=c.y*u,w=(c.y+1)*u,S=da(p),I=da(_),M=ls(b),z=ls(w),j=a.project(S,M),H=a.project(I,M),K=a.project(I,z),Y=a.project(S,z);let te=Math.min(j.x,H.x,K.x,Y.x),ae=Math.min(j.y,H.y,K.y,Y.y),we=Math.max(j.x,H.x,K.x,Y.x),ke=Math.max(j.y,H.y,K.y,Y.y);const me=u/16;function Se(De,tt,Qe,mt,at,lt){const bt=(Qe+at)/2,xt=(mt+lt)/2,Mt=a.project(da(bt),ls(xt)),Pt=Math.max(0,te-Mt.x,ae-Mt.y,Mt.x-we,Mt.y-ke);te=Math.min(te,Mt.x),we=Math.max(we,Mt.x),ae=Math.min(ae,Mt.y),ke=Math.max(ke,Mt.y),Pt>me&&(Se(De,Mt,Qe,mt,bt,xt),Se(Mt,tt,bt,xt,at,lt))}Se(j,H,p,b,_,b),Se(H,K,_,b,_,w),Se(K,Y,_,w,p,w),Se(Y,j,p,w,p,b),te-=me,ae-=me,we+=me,ke+=me;const Oe=1/Math.max(we-te,ke-ae);return{scale:Oe,x:te*Oe,y:ae*Oe,x2:we*Oe,y2:ke*Oe,projection:a}}const NS=Pa(new Float32Array(16));class Fh{constructor(a){this.spec=a,this.name=a.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(a,u){return{x:0,y:0,z:0}}unproject(a,u){return new Oi(0,0)}projectTilePoint(a,u,p){return{x:a,y:u,z:0}}locationPoint(a,u,p=!0){return a._coordinatePoint(a.locationCoordinate(u),p)}pixelsPerMeter(a,u){return Fa(1,a)*u}pixelSpaceConversion(a,u,p){return 1}farthestPixelDistance(a){return FS(a,a.pixelsPerMeter)}pointCoordinate(a,u,p,_){const b=a.horizonLineFromTop(!1),w=new Ue(u,Math.max(b,p));return a.rayIntersectionCoordinate(a.pointRayIntersection(w,_))}pointCoordinate3D(a,u,p){const _=new Ue(u,p);if(a.elevation)return a.elevation.pointCoordinate(_);{const b=this.pointCoordinate(a,_.x,_.y,0);return[b.x,b.y,b.z]}}isPointAboveHorizon(a,u){if(a.elevation)return!this.pointCoordinate3D(a,u.x,u.y);const p=a.horizonLineFromTop();return u.y<p}createInversionMatrix(a,u){return NS}createTileMatrix(a,u,p){let _,b,w;const S=p.canonical,I=Pa(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=uu(S,this);_=1,b=M.x+p.wrap*M.scale,w=M.y,wh(I,I,[_/M.scale,_/M.scale,a.pixelsPerMeter/u])}else _=u/a.zoomScale(S.z),b=(S.x+Math.pow(2,S.z)*p.wrap)*_,w=S.y*_;return sc(I,I,[b,w,0]),wh(I,I,[_/Gn,_/Gn,1]),I}upVector(a,u,p){return[0,0,1]}upVectorScale(a,u,p){return{metersToTile:1}}}class ce extends Fh{constructor(a){super(a),this.range=[4,7],this.center=a.center||[-96,37.5];const[u,p]=this.parallels=a.parallels||[29.5,45.5],_=Math.sin(wt(u));this.n=(_+Math.sin(wt(p)))/2,this.c=1+_*(2*this.n-_),this.r0=Math.sqrt(this.c)/this.n}project(a,u){const{n:p,c:_,r0:b}=this,w=wt(a-this.center[0]),S=wt(u),I=Math.sqrt(_-2*p*Math.sin(S))/p;return{x:I*Math.sin(w*p),y:I*Math.cos(w*p)-b,z:0}}unproject(a,u){const{n:p,c:_,r0:b}=this,w=b+u;let S=Math.atan2(a,Math.abs(w))*Math.sign(w);w*p<0&&(S-=Math.PI*Math.sign(a)*Math.sign(w));const I=wt(this.center[0])*p;S=mr(S,-Math.PI-I,Math.PI-I);const M=Hn(Lt(S/p)+this.center[0],-180,180),z=Math.asin(Hn((_-(a*a+w*w)*p*p)/(2*p),-1,1)),j=Hn(Lt(z),-cs,cs);return new Oi(M,j)}}const Nh=1.340264,ng=-.081106,hf=893e-6,ig=.003796,j_=Math.sqrt(3)/2;class H_ extends Fh{project(a,u){u=u/180*Math.PI,a=a/180*Math.PI;const p=Math.asin(j_*Math.sin(u)),_=p*p,b=_*_*_;return{x:.5*(a*Math.cos(p)/(j_*(Nh+3*ng*_+b*(7*hf+9*ig*_)))/Math.PI+.5),y:1-.5*(p*(Nh+ng*_+b*(hf+ig*_))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let p=u=(2*(1-u)-1)*Math.PI,_=p*p,b=_*_*_;for(let z,j,H,K=0;K<12&&(j=p*(Nh+ng*_+b*(hf+ig*_))-u,H=Nh+3*ng*_+b*(7*hf+9*ig*_),z=j/H,p=Hn(p-z,-Math.PI/3,Math.PI/3),_=p*p,b=_*_*_,!(Math.abs(z)<1e-12));++K);const w=j_*a*(Nh+3*ng*_+b*(7*hf+9*ig*_))/Math.cos(p),S=Math.asin(Math.sin(p)/j_),I=Hn(180*w/Math.PI,-180,180),M=Hn(180*S/Math.PI,-cs,cs);return new Oi(I,M)}}class pf extends Fh{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){return{x:.5+a/360,y:.5-u/360,z:0}}unproject(a,u){const p=360*(a-.5),_=Hn(360*(.5-u),-cs,cs);return new Oi(p,_)}}const bd=Math.PI/2;function xd(c){return Math.tan((bd+c)/2)}class Qv extends Fh{constructor(a){super(a),this.center=a.center||[0,30];const[u,p]=this.parallels=a.parallels||[30,30];let _=wt(u),b=wt(p);this.southernCenter=_+b<0,this.southernCenter&&(_=-_,b=-b);const w=Math.cos(_),S=xd(_);this.n=_===b?Math.sin(_):Math.log(w/Math.cos(b))/Math.log(xd(b)/S),this.f=w*Math.pow(xd(_),this.n)/this.n}project(a,u){u=wt(u),this.southernCenter&&(u=-u),a=wt(a-this.center[0]);const p=1e-6,{n:_,f:b}=this;b>0?u<-bd+p&&(u=-bd+p):u>bd-p&&(u=bd-p);const w=b/Math.pow(xd(u),_);let S=w*Math.sin(_*a),I=b-w*Math.cos(_*a);return S=.5*(S/Math.PI+.5),I=.5*(I/Math.PI+.5),{x:S,y:this.southernCenter?I:1-I,z:0}}unproject(a,u){a=(2*a-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:p,f:_}=this,b=_-u,w=Math.sign(b),S=Math.sign(p)*Math.sqrt(a*a+b*b);let I=Math.atan2(a,Math.abs(b))*w;b*p<0&&(I-=Math.PI*Math.sign(a)*w);const M=Hn(Lt(I/p)+this.center[0],-180,180),z=Hn(Lt(2*Math.atan(Math.pow(_/S,1/p))-bd),-cs,cs);return new Oi(M,this.southernCenter?-z:z)}}class og extends Fh{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(a,u){return{x:Fl(a),y:Zs(u),z:0}}unproject(a,u){const p=da(a),_=ls(u);return new Oi(p,_)}}const Jv=wt(cs);class eb extends Fh{project(a,u){const p=(u=wt(u))*u,_=p*p;return{x:.5*((a=wt(a))*(.8707-.131979*p+_*(_*(.003971*p-.001529*_)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+p*(.015085+_*(.028874*p-.044475-.005916*_)))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let p=u=(2*(1-u)-1)*Math.PI,_=25,b=0,w=p*p;do{w=p*p;const M=w*w;b=(p*(1.007226+w*(.015085+M*(.028874*w-.044475-.005916*M)))-u)/(1.007226+w*(.045255+M*(.259866*w-.311325-.005916*11*M))),p=Hn(p-b,-Jv,Jv)}while(Math.abs(b)>1e-6&&--_>0);w=p*p;const S=Hn(Lt(a/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),I=Lt(p);return new Oi(S,I)}}const $_=wt(cs);class tb extends Fh{project(a,u){u=wt(u),a=wt(a);const p=Math.cos(u),_=2/Math.PI,b=Math.acos(p*Math.cos(a/2)),w=Math.sin(b)/b,S=.5*(a*_+2*p*Math.sin(a/2)/w)||0,I=.5*(u+Math.sin(u)/w)||0;return{x:.5*(S/Math.PI+.5),y:1-.5*(I/Math.PI+1),z:0}}unproject(a,u){let p=a=(2*a-.5)*Math.PI,_=u=(2*(1-u)-1)*Math.PI,b=25;const w=1e-6;let S=0,I=0;do{const M=Math.cos(_),z=Math.sin(_),j=2*z*M,H=z*z,K=M*M,Y=Math.cos(p/2),te=Math.sin(p/2),ae=2*Y*te,we=te*te,ke=1-K*Y*Y,me=ke?1/ke:0,Se=ke?Math.acos(M*Y)*Math.sqrt(1/ke):0,Oe=.5*(2*Se*M*te+2*p/Math.PI)-a,De=.5*(Se*z+_)-u,tt=.5*me*(K*we+Se*M*Y*H)+1/Math.PI,Qe=me*(ae*j/4-Se*z*te),mt=.125*me*(j*te-Se*z*K*ae),at=.5*me*(H*Y+Se*we*M)+.5,lt=Qe*mt-at*tt;S=(De*Qe-Oe*at)/lt,I=(Oe*mt-De*tt)/lt,p=Hn(p-S,-Math.PI,Math.PI),_=Hn(_-I,-$_,$_)}while((Math.abs(S)>w||Math.abs(I)>w)&&--b>0);return new Oi(Lt(p),Lt(_))}}class nb extends Fh{constructor(a){super(a),this.center=a.center||[0,0],this.parallels=a.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(wt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){const{scale:p,cosPhi:_}=this;return{x:wt(a)*_*p+.5,y:-Math.sin(wt(u))/_*p+.5,z:0}}unproject(a,u){const{scale:p,cosPhi:_}=this,b=-(u-.5)/p,w=Hn(Lt((a-.5)/p)/_,-180,180),S=Math.asin(Hn(b*_,-1,1)),I=Hn(Lt(S),-cs,cs);return new Oi(w,I)}}class ib extends og{constructor(a){super(a),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(a,u,p){const _=Tm(a,u,p);return Wo(_,_,Wp(cc(p))),{x:_[0],y:_[1],z:_[2]}}locationPoint(a,u){const p=Dh(u.lat,u.lng),_=Yr([],p),b=a.elevation?a.elevation.getAtPointOrZero(a.locationCoordinate(u),a._centerAltitude):a._centerAltitude;wm(p,p,_,Fa(1,0)*Gn*b);const w=Pa(new Float64Array(16));return hd(w,a.pixelMatrix,a.globeMatrix),Wo(p,p,w),new Ue(p[0],p[1])}pixelsPerMeter(a,u){return Fa(1,0)*u}pixelSpaceConversion(a,u,p){const _=Fa(1,a)*u,b=ki(Fa(1,45)*u,_,p);return this.pixelsPerMeter(a,u)/b}createTileMatrix(a,u,p){const _=pv(cc(p.canonical));return hd(new Float64Array(16),a.globeMatrix,_)}createInversionMatrix(a,u){const{center:p}=a,_=Wp(cc(u));return pd(_,_,wt(p.lng)),c_(_,_,wt(p.lat)),wh(_,_,[a._pixelsPerMercatorPixel,a._pixelsPerMercatorPixel,1]),Float32Array.from(_)}pointCoordinate(a,u,p,_){return sx(a,u,p,!0)||new Zp(0,0)}pointCoordinate3D(a,u,p){const _=this.pointCoordinate(a,u,p,0);return[_.x,_.y,_.z]}isPointAboveHorizon(a,u){return!sx(a,u.x,u.y,!1)}farthestPixelDistance(a){const u=function(_,b){const w=_.cameraToCenterDistance,S=_._centerAltitude*b,I=_._camera,M=_._camera.forward(),z=fd([],Oa([],M,-w),[0,0,S]),j=_.worldSize/(2*Math.PI),H=[0,0,-j],K=_.width/_.height,Y=Math.tan(_.fovAboveCenter),te=Oa([],I.up(),Y),ae=Oa([],I.right(),Y*K),we=Yr([],fd([],fd([],M,te),ae)),ke=[];let me;if(new f_(z,we).closestPointOnSphere(H,j,ke)){const Se=fd([],ke,H),Oe=ac([],Se,z);me=Math.cos(_.fovAboveCenter)*eu(Oe)}else{const Se=ac([],z,H),Oe=ac([],H,z);Yr(Oe,Oe);const De=eu(Se)-j;me=Math.sqrt(De*(De+2*j));const tt=Math.acos(me/(j+De))-Math.acos(La(M,Oe));me*=Math.cos(tt)}return 1.01*me}(a,this.pixelsPerMeter(a.center.lat,a.worldSize)),p=qp(a.zoom);if(p>0){const _=FS(a,Fa(1,a.center.lat)*a.worldSize),b=a.worldSize/(2*Math.PI),w=Math.max(a.width,a.height)/a.worldSize*Math.PI;return ki(u,_+b*(1-Math.cos(w)),Math.pow(p,10))}return u}upVector(a,u,p){return Tm(u,p,a,1)}upVectorScale(a){return{metersToTile:__(Sm(cc(a)))}}}function r1(c){const a=c.parallels,u=!!a&&Math.abs(a[0]+a[1])<.01;switch(c.name){case"mercator":return new og(c);case"equirectangular":return new pf(c);case"naturalEarth":return new eb(c);case"equalEarth":return new H_(c);case"winkelTripel":return new tb(c);case"albers":return u?new nb(c):new ce(c);case"lambertConformalConic":return u?new nb(c):new Qv(c);case"globe":return new ib(c)}throw new Error(`Invalid projection name: ${c.name}`)}const zS=M_.types,s1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function G_(c,a,u,p,_,b,w,S,I,M,z,j,H){const K=S?Math.min(vd,Math.round(S[0])):0,Y=S?Math.min(vd,Math.round(S[1])):0;c.emplaceBack(a,u,Math.round(32*p),Math.round(32*_),b,w,(K<<1)+(I?1:0),Y,16*M,16*z,256*j,256*H)}function rg(c,a,u,p,_,b,w){c.emplaceBack(a,u,p,_,b,w)}function sg(c,a,u,p,_){c.emplaceBack(a,u,p,_),c.emplaceBack(a,u,p,_),c.emplaceBack(a,u,p,_),c.emplaceBack(a,u,p,_)}function BS(c){for(const a of c.sections)if(J(a.text))return!0;return!1}class ob{constructor(a){this.layoutVertexArray=new Pl,this.indexArray=new as,this.programConfigurations=a,this.segments=new ir,this.dynamicLayoutVertexArray=new io,this.opacityVertexArray=new bo,this.placedSymbolArray=new Q0,this.globeExtVertexArray=new Gi}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(a,u,p,_){this.isEmpty()||(p&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Fv.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Vx.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,s1,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,_S.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||_)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}dn(ob,"SymbolBuffers");class Xs{constructor(a,u,p){this.layoutVertexArray=new a,this.layoutAttributes=u,this.indexArray=new p,this.segments=new ir,this.collisionVertexArray=new xo,this.collisionVertexArrayExt=new Pr}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,yS.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,Ux.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}dn(Xs,"CollisionBuffers");class du{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(w=>w.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Pa([]),this.placementViewportMatrix=Pa([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=yd(this.zoom,u["text-size"]),this.iconSizeData=yd(this.zoom,u["icon-size"]);const p=this.layers[0].layout,_=p.get("symbol-sort-key"),b=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==b&&void 0!==_.constantOr(1),this.sortFeaturesByY=("viewport-y"===b||"auto"===b&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(w=>Na[w]),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=a.sourceID,this.projection=a.projection}createArrays(){this.text=new ob(new xh(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new ob(new xh(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new J0,this.lineVertexArray=new ev,this.symbolInstances=new r_}calculateGlyphDependencies(a,u,p,_,b){for(let w=0;w<a.length;w++)if(u[a.charCodeAt(w)]=!0,_&&b){const S=Zm[a.charAt(w)];S&&(u[S.charCodeAt(0)]=!0)}}populate(a,u,p,_){const b=this.layers[0],w=b.layout,S="globe"===this.projection.name,I=w.get("text-font"),M=w.get("text-field"),z=w.get("icon-image"),j=("constant"!==M.value.kind||M.value.value instanceof nr&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&("constant"!==I.value.kind||I.value.value.length>0),H="constant"!==z.value.kind||!!z.value.value||Object.keys(z.parameters).length>0,K=w.get("symbol-sort-key");if(this.features=[],!j&&!H)return;const Y=u.iconDependencies,te=u.glyphDependencies,ae=u.availableImages,we=new $e(this.zoom);for(const{feature:ke,id:me,index:Se,sourceLayerIndex:Oe}of a){const De=b._featureFilter.needGeometry,tt=Mh(ke,De);if(!b._featureFilter.filter(we,tt,p))continue;if(De||(tt.geometry=tu(ke,p,_)),S&&1!==ke.type&&p.z<=5){const lt=tt.geometry,bt=.98078528056,xt=(Mt,Pt)=>La(Tm(Mt.x,Mt.y,p,1),Tm(Pt.x,Pt.y,p,1))<bt;for(let Mt=0;Mt<lt.length;Mt++)lt[Mt]=px(lt[Mt],xt)}let Qe,mt;if(j){const lt=b.getValueAndResolveTokens("text-field",tt,p,ae),bt=nr.factory(lt);BS(bt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Le()||this.hasRTLText&&Fe.isParsed())&&(Qe=Jr(bt,b,tt))}if(H){const lt=b.getValueAndResolveTokens("icon-image",tt,p,ae);mt=lt instanceof Ms?lt:Ms.fromString(lt)}if(!Qe&&!mt)continue;const at=this.sortFeaturesByKey?K.evaluate(tt,{},p):void 0;if(this.features.push({id:me,text:Qe,icon:mt,index:Se,sourceLayerIndex:Oe,geometry:tt.geometry,properties:ke.properties,type:zS[ke.type],sortKey:at}),mt&&(Y[mt.name]=!0),Qe){const lt=I.evaluate(tt,{},p).join(","),bt="map"===w.get("text-rotation-alignment")&&"point"!==w.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Na.vertical)>=0;for(const xt of Qe.sections)if(xt.image)Y[xt.image.name]=!0;else{const Mt=T(Qe.toString()),Pt=xt.fontStack||lt,ut=te[Pt]=te[Pt]||{};this.calculateGlyphDependencies(xt.text,ut,bt,this.allowVerticalPlacement,Mt)}}}"line"===w.get("symbol-placement")&&(this.features=function(ke){const me={},Se={},Oe=[];let De=0;function tt(lt){Oe.push(ke[lt]),De++}function Qe(lt,bt,xt){const Mt=Se[lt];return delete Se[lt],Se[bt]=Mt,Oe[Mt].geometry[0].pop(),Oe[Mt].geometry[0]=Oe[Mt].geometry[0].concat(xt[0]),Mt}function mt(lt,bt,xt){const Mt=me[bt];return delete me[bt],me[lt]=Mt,Oe[Mt].geometry[0].shift(),Oe[Mt].geometry[0]=xt[0].concat(Oe[Mt].geometry[0]),Mt}function at(lt,bt,xt){const Mt=xt?bt[0][bt[0].length-1]:bt[0][0];return`${lt}:${Mt.x}:${Mt.y}`}for(let lt=0;lt<ke.length;lt++){const bt=ke[lt],xt=bt.geometry,Mt=bt.text?bt.text.toString():null;if(!Mt){tt(lt);continue}const Pt=at(Mt,xt),ut=at(Mt,xt,!0);if(Pt in Se&&ut in me&&Se[Pt]!==me[ut]){const Gt=mt(Pt,ut,xt),kn=Qe(Pt,ut,Oe[Gt].geometry);delete me[Pt],delete Se[ut],Se[at(Mt,Oe[kn].geometry,!0)]=kn,Oe[Gt].geometry=null}else Pt in Se?Qe(Pt,ut,xt):ut in me?mt(Pt,ut,xt):(tt(lt),me[Pt]=De-1,Se[ut]=De-1)}return Oe.filter(lt=>lt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ke,me)=>ke.sortKey-me.sortKey)}update(a,u,p,_){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,u,this.layers,p,_),this.icon.programConfigurations.updatePaintArrays(a,u,this.layers,p,_))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=r1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,u){const p=this.lineVertexArray.length;if(void 0!==a.segment)for(const{x:_,y:b}of u)this.lineVertexArray.emplaceBack(_,b);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(a,u,p,_,b,w,S,I,M,z,j,H,K,Y){const te=a.indexArray,ae=a.layoutVertexArray,we=a.globeExtVertexArray,ke=a.segments.prepareSegment(4*u.length,ae,te,this.canOverlap?w.sortKey:void 0),me=this.glyphOffsetArray.length,Se=ke.vertexLength,Oe=this.allowVerticalPlacement&&S===Na.vertical?Math.PI/2:0,De=w.text&&w.text.sections;for(let Qe=0;Qe<u.length;Qe++){const{tl:mt,tr:at,bl:lt,br:bt,tex:xt,pixelOffsetTL:Mt,pixelOffsetBR:Pt,minFontScaleX:ut,minFontScaleY:Gt,glyphOffset:kn,isSDF:Yt,sectionIndex:fn}=u[Qe],Xt=ke.vertexLength,Fn=kn[1];if(G_(ae,M.x,M.y,mt.x,Fn+mt.y,xt.x,xt.y,p,Yt,Mt.x,Mt.y,ut,Gt),G_(ae,M.x,M.y,at.x,Fn+at.y,xt.x+xt.w,xt.y,p,Yt,Pt.x,Mt.y,ut,Gt),G_(ae,M.x,M.y,lt.x,Fn+lt.y,xt.x,xt.y+xt.h,p,Yt,Mt.x,Pt.y,ut,Gt),G_(ae,M.x,M.y,bt.x,Fn+bt.y,xt.x+xt.w,xt.y+xt.h,p,Yt,Pt.x,Pt.y,ut,Gt),I){const{x:Si,y:xi,z:_i}=I.anchor,[zn,oo,ti]=I.up;rg(we,Si,xi,_i,zn,oo,ti),rg(we,Si,xi,_i,zn,oo,ti),rg(we,Si,xi,_i,zn,oo,ti),rg(we,Si,xi,_i,zn,oo,ti),sg(a.dynamicLayoutVertexArray,Si,xi,_i,Oe)}else sg(a.dynamicLayoutVertexArray,M.x,M.y,M.z,Oe);te.emplaceBack(Xt,Xt+1,Xt+2),te.emplaceBack(Xt+1,Xt+2,Xt+3),ke.vertexLength+=4,ke.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(kn[0]),Qe!==u.length-1&&fn===u[Qe+1].sectionIndex||a.programConfigurations.populatePaintArrays(ae.length,w,w.index,{},K,Y,De&&De[fn])}const tt=I?I.anchor:M;a.placedSymbolArray.emplaceBack(tt.x,tt.y,tt.z,M.x,M.y,me,this.glyphOffsetArray.length-me,Se,z,j,M.segment,p?p[0]:0,p?p[1]:0,_[0],_[1],S,0,!1,0,H,0)}_commitLayoutVertex(a,u,p,_,b,w,S){a.emplaceBack(u,p,_,b,w,Math.round(S.x),Math.round(S.y))}_addCollisionDebugVertices(a,u,p,_,b,w,S){const I=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),M=I.vertexLength,z=S.tileAnchorX,j=S.tileAnchorY;for(let K=0;K<4;K++)p.collisionVertexArray.emplaceBack(0,0,0,0);p.collisionVertexArrayExt.emplaceBack(u,-a.padding,-a.padding),p.collisionVertexArrayExt.emplaceBack(u,a.padding,-a.padding),p.collisionVertexArrayExt.emplaceBack(u,a.padding,a.padding),p.collisionVertexArrayExt.emplaceBack(u,-a.padding,a.padding),this._commitLayoutVertex(p.layoutVertexArray,_,b,w,z,j,new Ue(a.x1,a.y1)),this._commitLayoutVertex(p.layoutVertexArray,_,b,w,z,j,new Ue(a.x2,a.y1)),this._commitLayoutVertex(p.layoutVertexArray,_,b,w,z,j,new Ue(a.x2,a.y2)),this._commitLayoutVertex(p.layoutVertexArray,_,b,w,z,j,new Ue(a.x1,a.y2)),I.vertexLength+=4;const H=p.indexArray;H.emplaceBack(M,M+1),H.emplaceBack(M+1,M+2),H.emplaceBack(M+2,M+3),H.emplaceBack(M+3,M),I.primitiveLength+=4}_addTextDebugCollisionBoxes(a,u,p,_,b,w){for(let S=_;S<b;S++){const I=p.get(S),M=this.getSymbolInstanceTextSize(a,w,u,S);this._addCollisionDebugVertices(I,M,this.textCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(a,u,p,_,b,w){for(let S=_;S<b;S++){const I=p.get(S),M=this.getSymbolInstanceIconSize(a,u,w.placedIconSymbolIndex);this._addCollisionDebugVertices(I,M,this.iconCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,w)}}generateCollisionDebugBuffers(a,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xs(No,vS.members,ka),this.iconCollisionBox=new Xs(No,vS.members,ka);const p=rf(this.iconSizeData,a),_=rf(this.textSizeData,a);for(let b=0;b<this.symbolInstances.length;b++){const w=this.symbolInstances.get(b);this._addTextDebugCollisionBoxes(_,a,u,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(_,a,u,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(p,a,u,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(p,a,u,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(a,u,p,_){const b=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:_),w=gi(this.textSizeData,a,b)/dr;return this.tilePixelRatio*w}getSymbolInstanceIconSize(a,u,p){const _=this.icon.placedSymbolArray.get(p),b=gi(this.iconSizeData,a,_);return this.tilePixelRatio*b}_commitDebugCollisionVertexUpdate(a,u,p){a.emplaceBack(u,-p,-p),a.emplaceBack(u,p,-p),a.emplaceBack(u,p,p),a.emplaceBack(u,-p,p)}_updateTextDebugCollisionBoxes(a,u,p,_,b,w){for(let S=_;S<b;S++){const I=p.get(S),M=this.getSymbolInstanceTextSize(a,w,u,S);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,I.padding)}}_updateIconDebugCollisionBoxes(a,u,p,_,b,w){for(let S=_;S<b;S++){const I=p.get(S),M=this.getSymbolInstanceIconSize(a,u,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,I.padding)}}updateCollisionDebugBuffers(a,u){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=rf(this.iconSizeData,a),_=rf(this.textSizeData,a);for(let b=0;b<this.symbolInstances.length;b++){const w=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(_,a,u,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(_,a,u,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(p,a,u,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(p,a,u,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,u,p,_,b,w,S,I,M){const z={};if(u<p){const{x1:j,y1:H,x2:K,y2:Y,padding:te,projectedAnchorX:ae,projectedAnchorY:we,projectedAnchorZ:ke,tileAnchorX:me,tileAnchorY:Se,featureIndex:Oe}=a.get(u);z.textBox={x1:j,y1:H,x2:K,y2:Y,padding:te,projectedAnchorX:ae,projectedAnchorY:we,projectedAnchorZ:ke,tileAnchorX:me,tileAnchorY:Se},z.textFeatureIndex=Oe}if(_<b){const{x1:j,y1:H,x2:K,y2:Y,padding:te,projectedAnchorX:ae,projectedAnchorY:we,projectedAnchorZ:ke,tileAnchorX:me,tileAnchorY:Se,featureIndex:Oe}=a.get(_);z.verticalTextBox={x1:j,y1:H,x2:K,y2:Y,padding:te,projectedAnchorX:ae,projectedAnchorY:we,projectedAnchorZ:ke,tileAnchorX:me,tileAnchorY:Se},z.verticalTextFeatureIndex=Oe}if(w<S){const{x1:j,y1:H,x2:K,y2:Y,padding:te,projectedAnchorX:ae,projectedAnchorY:we,projectedAnchorZ:ke,tileAnchorX:me,tileAnchorY:Se,featureIndex:Oe}=a.get(w);z.iconBox={x1:j,y1:H,x2:K,y2:Y,padding:te,projectedAnchorX:ae,projectedAnchorY:we,projectedAnchorZ:ke,tileAnchorX:me,tileAnchorY:Se},z.iconFeatureIndex=Oe}if(I<M){const{x1:j,y1:H,x2:K,y2:Y,padding:te,projectedAnchorX:ae,projectedAnchorY:we,projectedAnchorZ:ke,tileAnchorX:me,tileAnchorY:Se,featureIndex:Oe}=a.get(I);z.verticalIconBox={x1:j,y1:H,x2:K,y2:Y,padding:te,projectedAnchorX:ae,projectedAnchorY:we,projectedAnchorZ:ke,tileAnchorX:me,tileAnchorY:Se},z.verticalIconFeatureIndex=Oe}return z}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,u){const p=a.placedSymbolArray.get(u),_=p.vertexStartIndex+4*p.numGlyphs;for(let b=p.vertexStartIndex;b<_;b+=4)a.indexArray.emplaceBack(b,b+1,b+2),a.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const u=Math.sin(a),p=Math.cos(a),_=[],b=[],w=[];for(let S=0;S<this.symbolInstances.length;++S){w.push(S);const I=this.symbolInstances.get(S);_.push(0|Math.round(u*I.tileAnchorX+p*I.tileAnchorY)),b.push(I.featureIndex)}return w.sort((S,I)=>_[S]-_[I]||b[I]-b[S]),w}addToSortKeyRanges(a,u){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===u?p.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const p=this.symbolInstances.get(u);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:_,centerJustifiedTextSymbolIndex:b,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:S,placedIconSymbolIndex:I,verticalPlacedIconSymbolIndex:M}=p;_>=0&&this.addIndicesForPlacedSymbol(this.text,_),b>=0&&b!==_&&this.addIndicesForPlacedSymbol(this.text,b),w>=0&&w!==b&&w!==_&&this.addIndicesForPlacedSymbol(this.text,w),S>=0&&this.addIndicesForPlacedSymbol(this.text,S),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}dn(du,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),du.MAX_GLYPHS=65535,du.addDynamicAttributes=sg;const VS=new Ot({"symbol-placement":new je(yt.layout_symbol["symbol-placement"]),"symbol-spacing":new je(yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new je(yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ct(yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new je(yt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new je(yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new je(yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new je(yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new je(yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ct(yt.layout_symbol["icon-size"]),"icon-text-fit":new je(yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new je(yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ct(yt.layout_symbol["icon-image"]),"icon-rotate":new ct(yt.layout_symbol["icon-rotate"]),"icon-padding":new je(yt.layout_symbol["icon-padding"]),"icon-keep-upright":new je(yt.layout_symbol["icon-keep-upright"]),"icon-offset":new ct(yt.layout_symbol["icon-offset"]),"icon-anchor":new ct(yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new je(yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new je(yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new je(yt.layout_symbol["text-rotation-alignment"]),"text-field":new ct(yt.layout_symbol["text-field"]),"text-font":new ct(yt.layout_symbol["text-font"]),"text-size":new ct(yt.layout_symbol["text-size"]),"text-max-width":new ct(yt.layout_symbol["text-max-width"]),"text-line-height":new ct(yt.layout_symbol["text-line-height"]),"text-letter-spacing":new ct(yt.layout_symbol["text-letter-spacing"]),"text-justify":new ct(yt.layout_symbol["text-justify"]),"text-radial-offset":new ct(yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new je(yt.layout_symbol["text-variable-anchor"]),"text-anchor":new ct(yt.layout_symbol["text-anchor"]),"text-max-angle":new je(yt.layout_symbol["text-max-angle"]),"text-writing-mode":new je(yt.layout_symbol["text-writing-mode"]),"text-rotate":new ct(yt.layout_symbol["text-rotate"]),"text-padding":new je(yt.layout_symbol["text-padding"]),"text-keep-upright":new je(yt.layout_symbol["text-keep-upright"]),"text-transform":new ct(yt.layout_symbol["text-transform"]),"text-offset":new ct(yt.layout_symbol["text-offset"]),"text-allow-overlap":new je(yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new je(yt.layout_symbol["text-ignore-placement"]),"text-optional":new je(yt.layout_symbol["text-optional"])});var a1={paint:new Ot({"icon-opacity":new ct(yt.paint_symbol["icon-opacity"]),"icon-color":new ct(yt.paint_symbol["icon-color"]),"icon-halo-color":new ct(yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ct(yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ct(yt.paint_symbol["icon-halo-blur"]),"icon-translate":new je(yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new je(yt.paint_symbol["icon-translate-anchor"]),"text-opacity":new ct(yt.paint_symbol["text-opacity"]),"text-color":new ct(yt.paint_symbol["text-color"],{runtimeType:oa,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new ct(yt.paint_symbol["text-halo-color"]),"text-halo-width":new ct(yt.paint_symbol["text-halo-width"]),"text-halo-blur":new ct(yt.paint_symbol["text-halo-blur"]),"text-translate":new je(yt.paint_symbol["text-translate"]),"text-translate-anchor":new je(yt.paint_symbol["text-translate-anchor"])}),layout:VS};class W_{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:Lc,this.defaultValue=a}evaluate(a){if(a.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(a.formattedSection))return u.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dn(W_,"FormatSectionOverride",{omit:["defaultValue"]});class ag extends oc{constructor(a){super(a,a1)}recalculate(a,u){super.recalculate(a,u),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const _=[];for(const b of p)_.indexOf(b)<0&&_.push(b);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(a,u,p,_){const b=this.layout.get(a).evaluate(u,{},p,_),w=this._unevaluatedLayout._values[a];return w.isDataDriven()||td(w.value)||!b?b:(S=u.properties,b.replace(/{([^{}]+)}/g,(M,z)=>z in S?String(S[z]):""));var S}createBucket(a){return new du(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const a of a1.paint.overridableProperties){if(!ag.hasPaintOverride(this.layout,a))continue;const u=this.paint.get(a),p=new W_(u),_=new rm(p,u.property.specification);let b=null;b="constant"===u.value.kind||"source"===u.value.kind?new sm("source",_):new id("composite",_,u.value.zoomStops,u.value._interpolationType),this.paint._values[a]=new At(u.property,b,u.parameters)}}_handleOverridablePaintPropertyUpdate(a,u,p){return!(!this.layout||u.isDataDriven()||p.isDataDriven())&&ag.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,u){const p=a.get("text-field"),_=a1.paint.properties[u];let b=!1;const w=S=>{for(const I of S)if(_.overrides&&_.overrides.hasOverride(I))return void(b=!0)};if("constant"===p.value.kind&&p.value.value instanceof nr)w(p.value.value.sections);else if("source"===p.value.kind){const S=M=>{b||(M instanceof eh&&gr(M.value)===Ei?w(M.value.sections):M instanceof mp?w(M.sections):M.eachChild(S))},I=p.value;I._styleExpression&&S(I._styleExpression.expression)}return b}getProgramConfiguration(a){return new sl(this,a)}}var US={paint:new Ot({"background-color":new je(yt.paint_background["background-color"]),"background-pattern":new je(yt.paint_background["background-pattern"]),"background-opacity":new je(yt.paint_background["background-opacity"])})},jS={paint:new Ot({"raster-opacity":new je(yt.paint_raster["raster-opacity"]),"raster-hue-rotate":new je(yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new je(yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new je(yt.paint_raster["raster-brightness-max"]),"raster-saturation":new je(yt.paint_raster["raster-saturation"]),"raster-contrast":new je(yt.paint_raster["raster-contrast"]),"raster-resampling":new je(yt.paint_raster["raster-resampling"]),"raster-fade-duration":new je(yt.paint_raster["raster-fade-duration"])})};class HS extends oc{constructor(a){super(a,{}),this.implementation=a}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}var l1={paint:new Ot({"sky-type":new je(yt.paint_sky["sky-type"]),"sky-atmosphere-sun":new je(yt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new je(yt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new je(yt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new je(yt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Dt(yt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new je(yt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new je(yt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new je(yt.paint_sky["sky-opacity"])})};function rb(c,a,u){const p=[0,0,1],_=GT([]);return qT(_,_,u?-wt(c)+Math.PI:wt(c)),WT(_,_,-wt(a)),UT(p,p,_),Yr(p,p)}const $S={circle:class extends oc{constructor(c){super(c,Lm)}createBucket(c){return new nu(c)}queryRadius(c){const a=c;return ou("circle-radius",this,a)+ou("circle-stroke-width",this,a)+Om(this.paint.get("circle-translate"))}queryIntersectsFeature(c,a,u,p,_,b,w,S){const I=T_(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(a,u)+this.paint.get("circle-stroke-width").evaluate(a,u);return gx(c,p,b,w,S,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),I,M)}getProgramIds(){return["circle"]}getProgramConfiguration(c){return new sl(this,c)}},heatmap:class extends oc{createBucket(c){return new Tv(c)}constructor(c){super(c,JT),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){"heatmap-color"===c&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=vx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return ou("heatmap-radius",this,c)}queryIntersectsFeature(c,a,u,p,_,b,w,S){const I=this.paint.get("heatmap-radius").evaluate(a,u);return gx(c,p,b,w,S,!0,!0,new Ue(0,0),I)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(c){return new sl(this,c)}},hillshade:class extends oc{constructor(c){super(c,eS)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends oc{constructor(c){super(c,IM)}getProgramIds(){const c=this.paint.get("fill-pattern"),a=c&&c.constantOr(1),u=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getProgramConfiguration(c){return new sl(this,c)}recalculate(c,a){super.recalculate(c,a);const u=this.paint._values["fill-outline-color"];"constant"===u.value.kind&&void 0===u.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new ef(c)}queryRadius(){return Om(this.paint.get("fill-translate"))}queryIntersectsFeature(c,a,u,p,_,b){return!c.queryGeometry.isAboveHorizon&&mx(C_(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}},"fill-extrusion":class extends oc{constructor(c){super(c,fS)}createBucket(c){return new tf(c)}queryRadius(){return Om(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(c){return new sl(this,c)}queryIntersectsFeature(c,a,u,p,_,b,w,S,I){const M=T_(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),z=this.paint.get("fill-extrusion-height").evaluate(a,u),j=this.paint.get("fill-extrusion-base").evaluate(a,u),H=[0,0],K=S&&b.elevation,Y=b.elevation?b.elevation.exaggeration():1,te=c.tile.getBucket(this);if(K&&te instanceof tf){const Se=te.centroidVertexArray,Oe=I+1;Oe<Se.length&&(H[0]=Se.geta_centroid_pos0(Oe),H[1]=Se.geta_centroid_pos1(Oe))}if(0===H[0]&&1===H[1])return!1;"globe"===b.projection.name&&(p=pS([p],[new Ue(0,0),new Ue(Gn,Gn)],c.tileID.canonical).map(Se=>Se.polygon).flat());const ae=K?S:null,[we,ke]=(Oe=p,De=j,tt=z,Qe=M,mt=w,at=ae,lt=H,bt=Y,xt=b.center.lat,"globe"===(Se=b).projection.name?function(Pt,ut,Gt,kn,Yt,fn,Xt,Fn,Si,xi,_i){const zn=[],oo=[],ti=Pt.projection.upVectorScale(_i,Pt.center.lat,Pt.worldSize).metersToTile,Ii=[0,0,0,1],vo=[0,0,0,1],W=(Un,L,zo,es)=>{Un[0]=L,Un[1]=zo,Un[2]=es,Un[3]=1},Eo=P_();Gt>0&&(Gt+=Eo),kn+=Eo;for(const Un of ut){const L=[],zo=[];for(const es of Un){const P=es.x+Yt.x,N=es.y+Yt.y,Ae=Pt.projection.projectTilePoint(P,N,_i),Wi=Pt.projection.upVector(_i,es.x,es.y);let wn=Gt,Pn=kn;if(Xt){const $t=L_(P,N,Gt,kn,Xt,Fn,Si,xi);wn+=$t.base,Pn+=$t.top}0!==Gt?W(Ii,Ae.x+Wi[0]*ti*wn,Ae.y+Wi[1]*ti*wn,Ae.z+Wi[2]*ti*wn):W(Ii,Ae.x,Ae.y,Ae.z),W(vo,Ae.x+Wi[0]*ti*Pn,Ae.y+Wi[1]*ti*Pn,Ae.z+Wi[2]*ti*Pn),Wo(Ii,Ii,fn),Wo(vo,vo,fn),L.push(new gd(Ii[0],Ii[1],Ii[2])),zo.push(new gd(vo[0],vo[1],vo[2]))}zn.push(L),oo.push(zo)}return[zn,oo]}(Se,Oe,De,tt,Qe,mt,at,lt,bt,xt,c.tileID.canonical):at?function(Pt,ut,Gt,kn,Yt,fn,Xt,Fn,Si){const xi=[],_i=[],zn=[0,0,0,1];for(const oo of Pt){const ti=[],Ii=[];for(const vo of oo){const W=vo.x+kn.x,Eo=vo.y+kn.y,Un=L_(W,Eo,ut,Gt,fn,Xt,Fn,Si);zn[0]=W,zn[1]=Eo,zn[2]=Un.base,zn[3]=1,Gp(zn,zn,Yt),zn[3]=Math.max(zn[3],1e-5);const L=new gd(zn[0]/zn[3],zn[1]/zn[3],zn[2]/zn[3]);zn[0]=W,zn[1]=Eo,zn[2]=Un.top,zn[3]=1,Gp(zn,zn,Yt),zn[3]=Math.max(zn[3],1e-5);const zo=new gd(zn[0]/zn[3],zn[1]/zn[3],zn[2]/zn[3]);ti.push(L),Ii.push(zo)}xi.push(ti),_i.push(Ii)}return[xi,_i]}(Oe,De,tt,Qe,mt,at,lt,bt,xt):function(Pt,ut,Gt,kn,Yt){const fn=[],Xt=[],Fn=Yt[8]*ut,Si=Yt[9]*ut,xi=Yt[10]*ut,_i=Yt[11]*ut,zn=Yt[8]*Gt,oo=Yt[9]*Gt,ti=Yt[10]*Gt,Ii=Yt[11]*Gt;for(const vo of Pt){const W=[],Eo=[];for(const Un of vo){const L=Un.x+kn.x,zo=Un.y+kn.y,es=Yt[0]*L+Yt[4]*zo+Yt[12],P=Yt[1]*L+Yt[5]*zo+Yt[13],N=Yt[2]*L+Yt[6]*zo+Yt[14],Ae=Yt[3]*L+Yt[7]*zo+Yt[15],Wi=es+Fn,wn=P+Si,Pn=N+xi,$t=Math.max(Ae+_i,1e-5),Ye=es+zn,xr=P+oo,Rr=N+ti,wr=Math.max(Ae+Ii,1e-5);W.push(new gd(Wi/$t,wn/$t,Pn/$t)),Eo.push(new gd(Ye/wr,xr/wr,Rr/wr))}fn.push(W),Xt.push(Eo)}return[fn,Xt]}(Oe,De,tt,Qe,mt)),me=c.queryGeometry;var Se,Oe,De,tt,Qe,mt,at,lt,bt,xt;return function(Se,Oe,De){let tt=1/0;mx(De,Oe)&&(tt=Rx(De,Oe[0]));for(let Qe=0;Qe<Oe.length;Qe++){const mt=Oe[Qe],at=Se[Qe];for(let lt=0;lt<mt.length-1;lt++){const bt=mt[lt],xt=[bt,mt[lt+1],at[lt+1],at[lt],bt];vv(De,xt)&&(tt=Math.min(tt,Rx(De,xt)))}}return tt!==1/0&&tt}(we,ke,me.isPointQuery()?me.screenBounds:me.screenGeometry)}},line:class extends oc{constructor(c){super(c,Nx),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if("line-gradient"===c){const a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof qu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,a){super.recalculate(c,a),this.paint._values["line-floorwidth"]=zx.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new Wm(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(c){return new sl(this,c)}queryRadius(c){const a=c,u=Bx(ou("line-width",this,a),ou("line-gap-width",this,a)),p=ou("line-offset",this,a);return u/2+Math.abs(p)+Om(this.paint.get("line-translate"))}queryIntersectsFeature(c,a,u,p,_,b){if(c.queryGeometry.isAboveHorizon)return!1;const w=C_(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),S=c.pixelToTileUnitsFactor/2*Bx(this.paint.get("line-width").evaluate(a,u),this.paint.get("line-gap-width").evaluate(a,u)),I=this.paint.get("line-offset").evaluate(a,u);return I&&(p=function(M,z){const j=[],H=new Ue(0,0);for(let K=0;K<M.length;K++){const Y=M[K],te=[];for(let ae=0;ae<Y.length;ae++){const ke=Y[ae],me=Y[ae+1],Se=0===ae?H:ke.sub(Y[ae-1])._unit()._perp(),Oe=ae===Y.length-1?H:me.sub(ke)._unit()._perp(),De=Se._add(Oe)._unit();De._mult(1/(De.x*Oe.x+De.y*Oe.y)),te.push(De._mult(z)._add(ke))}j.push(te)}return j}(p,I*c.pixelToTileUnitsFactor)),function(M,z,j){for(let H=0;H<z.length;H++){const K=z[H];if(M.length>=3)for(let Y=0;Y<K.length;Y++)if(iu(M,K[Y]))return!0;if(TM(M,K,j))return!0}return!1}(w,p,S)}isTileClipped(){return!0}},symbol:ag,background:class extends oc{constructor(c){super(c,US)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends oc{constructor(c){super(c,jS)}getProgramIds(){return["raster"]}},sky:class extends oc{constructor(c){super(c,l1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){"sky-gradient"===c?this._updateColorRamp():"sky-atmosphere-sun"!==c&&"sky-atmosphere-halo-color"!==c&&"sky-atmosphere-color"!==c&&"sky-atmosphere-sun-intensity"!==c||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=vx({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const a=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}return!1}getCenter(c,a){if("atmosphere"===this.paint.get("sky-type")){const p=this.paint.get("sky-atmosphere-sun"),_=!p,b=c.style.light,w=b.properties.get("position");return _&&"viewport"===b.properties.get("anchor")&&Mo("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),_?rb(w.azimuthal,90-w.polar,a):rb(p[0],90-p[1],a)}const u=this.paint.get("sky-gradient-center");return rb(u[0],90-u[1],a)}is3D(){return!1}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return"atmosphere"===c?["skyboxCapture","skybox"]:"gradient"===c?["skyboxGradient"]:null}}};class zh{constructor(a,u,p,_){this.context=a,this.format=p,this.texture=a.gl.createTexture(),this.update(u,_)}update(a,u,p){const{width:_,height:b}=a,{context:w}=this,{gl:S}=w,{HTMLImageElement:I,HTMLCanvasElement:M,HTMLVideoElement:z,ImageData:j,ImageBitmap:H}=se;if(S.bindTexture(S.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!u||!1!==u.premultiply)),p||this.size&&this.size[0]===_&&this.size[1]===b){const{x:K,y:Y}=p||{x:0,y:0};a instanceof I||a instanceof M||a instanceof z||a instanceof j||H&&a instanceof H?S.texSubImage2D(S.TEXTURE_2D,0,K,Y,S.RGBA,S.UNSIGNED_BYTE,a):S.texSubImage2D(S.TEXTURE_2D,0,K,Y,_,b,S.RGBA,S.UNSIGNED_BYTE,a.data)}else this.size=[_,b],a instanceof I||a instanceof M||a instanceof z||a instanceof j||H&&a instanceof H?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,a):S.texImage2D(S.TEXTURE_2D,0,this.format,_,b,0,this.format,S.UNSIGNED_BYTE,a.data);this.useMipmap=Boolean(u&&u.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&S.generateMipmap(S.TEXTURE_2D)}bind(a,u){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),a!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,a),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?a===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_NEAREST:a),this.filter=a),u!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,u),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class GS{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class WS{constructor(){this.tasks={},this.taskQueue=[],Ta(["process"],this),this.invoker=new GS(this.process),this.nextId=0}add(a,u){const p=this.nextId++,_=function({type:b,isSymbolTile:w,zoom:S}){return S=S||0,"message"===b?0:"maybePrepare"!==b||w?"parseTile"!==b||w?"parseTile"===b&&w?300-S:"maybePrepare"===b&&w?400-S:500:200-S:100-S}(u);if(0===_){qa();try{a()}finally{}return{cancel:()=>{}}}return this.tasks[p]={fn:a,metadata:u,priority:_,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){qa();try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const a=this.pick();if(null===a)return;const u=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let a=null,u=1/0;for(let _=0;_<this.taskQueue.length;_++){const b=this.tasks[this.taskQueue[_]];b.priority<u&&(u=b.priority,a=_)}if(null===a)return null;const p=this.taskQueue[a];return this.taskQueue.splice(a,1),p}remove(){this.invoker.remove()}}class c1{constructor(a){this._stringToNumber={},this._numberToString=[];for(let u=0;u<a.length;u++){const p=a[u];this._stringToNumber[p]=u,this._numberToString[u]=p}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}const qS=["tile","layer","source","sourceLayer","state"];class u1{constructor(a,u,p,_,b){this.type="Feature",this._vectorTileFeature=a,this._z=u,this._x=p,this._y=_,this.properties=a.properties,this.id=b}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(a.id=this.id);for(const u of qS)void 0!==this[u]&&(a[u]=this[u]);return a}}const br=32,ll=33,wd=new Uint16Array(8184);for(let c=0;c<2046;c++){let a=c+2,u=0,p=0,_=0,b=0,w=0,S=0;for(1&a?_=b=w=br:u=p=S=br;(a>>=1)>1;){const M=u+_>>1,z=p+b>>1;1&a?(_=u,b=p,u=w,p=S):(u=_,p=b,_=w,b=S),w=M,S=z}const I=4*c;wd[I+0]=u,wd[I+1]=p,wd[I+2]=_,wd[I+3]=b}const fc=new Uint16Array(2178),hu=new Uint8Array(1089),q_=new Uint16Array(1089);function d1(c){return 0===c?-.03125:32===c?.03125:0}var h1=Sn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Z_={type:2,extent:Gn,loadGeometry:()=>[[new Ue(0,0),new Ue(8193,0),new Ue(8193,8193),new Ue(0,8193),new Ue(0,0)]]};class sb{constructor(a,u,p,_,b){this.tileID=a,this.uid=Gl(),this.uses=0,this.tileSize=u,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,this.expiredRequestCount=0,this.state="loading",_&&_.transform&&(this.projection=_.transform.projection)}registerFadeDuration(a){const u=a+this.timeAdded;u<Vi.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=uu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,u,p){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(_,b){const w={};if(!b)return w;for(const S of _){const I=S.layerIds.map(M=>b.getLayer(M)).filter(Boolean);if(0!==I.length){S.layers=I,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(M=>I.filter(z=>z.id===M)[0]));for(const M of I)w[M.id]=S}}return w}(a.buckets,u.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const b=this.buckets[_];if(b instanceof du){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const b=this.buckets[_];if(b instanceof du&&b.hasRTLText){this.hasRTLText=!0,Fe.isLoading()||Fe.isLoaded()||"deferred"!==Le()||Pe();break}}this.queryPadding=0;for(const _ in this.buckets){const b=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(_).queryRadius(b))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas)}else this.collisionBoxArray=new o_}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(a){return this.buckets[a.id]}upload(a){for(const p in this.buckets){const _=this.buckets[p];_.uploadPending()&&_.upload(a)}const u=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new zh(a,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new zh(a,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new zh(a,this.lineAtlas.image,u.ALPHA),this.lineAtlas.uploaded=!0)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,u,p,_,b,w,S,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:_,pixelPosMatrix:S,transform:w,params:b,tileTransform:this.tileTransform},a,u,p):{}}querySourceFeatures(a,u){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const _=p.loadVTLayers(),b=u?u.sourceLayer:"",w=_._geojsonTileLayer||_[b];if(!w)return;const S=am(u&&u.filter),{z:I,x:M,y:z}=this.tileID.canonical,j={z:I,x:M,y:z};for(let H=0;H<w.length;H++){const K=w.feature(H);if(S.needGeometry){const ae=Mh(K,!0);if(!S.filter(new $e(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!S.filter(new $e(this.tileID.overscaledZ),K))continue;const Y=p.getId(K,b),te=new u1(K,I,M,z,Y);te.tile=j,a.push(te)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const u=this.expirationTime;if(a.cacheControl){const p=Ac(a.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const p=Date.now();let _=!1;if(this.expirationTime>p)_=!1;else if(u)if(this.expirationTime<u)_=!0;else{const b=this.expirationTime-u;b?this.expirationTime=p+Math.max(b,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(a,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(a).length||!u)return;const p=this.latestFeatureIndex.loadVTLayers(),_=u.style.listImages();for(const b in this.buckets){if(!u.style.hasLayer(b))continue;const w=this.buckets[b],S=w.layers[0].sourceLayer||"_geojsonTileLayer",I=p[S],M=a[S];if(!I||!M||0===Object.keys(M).length)continue;if(w.update(M,I,_,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof Wm||w instanceof ef){const j=u.style._getSourceCache(w.layers[0].source);u._terrain&&u._terrain.enabled&&j&&w.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(j.id,this.tileID)}const z=u&&u.style&&u.style.getLayer(b);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(w)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Vi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=Vi.now()+a}setTexture(a,u){const p=u.context,_=p.gl;this.texture=this.texture||u.getTileTexture(a.width),this.texture?this.texture.update(a,{useMipmap:!0}):(this.texture=new zh(p,a,_.RGBA,{useMipmap:!0}),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE),p.extTextureFilterAnisotropic&&_.texParameterf(_.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax))}setDependencies(a,u){const p={};for(const _ of u)p[_]=!0;this.dependencies[a]=p}hasDependency(a,u){for(const p of a){const _=this.dependencies[p];if(_)for(const b of u)if(_[b])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,u){if(!u||"mercator"===u.name||this._tileDebugBuffer)return;const p=tu(Z_,this.tileID.canonical,this.tileTransform)[0],_=new In,b=new Rs;for(let w=0;w<p.length;w++){const{x:S,y:I}=p[w];_.emplaceBack(S,I),b.emplaceBack(w)}b.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(b),this._tileDebugBuffer=a.createVertexBuffer(_,Th.members),this._tileDebugSegments=ir.simpleSegment(0,0,_.length,b.length)}_makeTileBoundsBuffers(a,u){if(this._tileBoundsBuffer||!u||"mercator"===u.name)return;const p=tu(Z_,this.tileID.canonical,this.tileTransform)[0];let _,b;if(this.isRaster){const w=function(S,I){const M=uu(S,I),z=Math.pow(2,S.z);for(let ae=0;ae<ll;ae++)for(let we=0;we<ll;we++){const ke=da((S.x+(we+d1(we))/br)/z),me=ls((S.y+(ae+d1(ae))/br)/z),Se=I.project(ke,me),Oe=ae*ll+we;fc[2*Oe+0]=Math.round((Se.x*M.scale-M.x)*Gn),fc[2*Oe+1]=Math.round((Se.y*M.scale-M.y)*Gn)}hu.fill(0),q_.fill(0);for(let ae=2045;ae>=0;ae--){const we=4*ae,ke=wd[we+0],me=wd[we+1],Se=wd[we+2],Oe=wd[we+3],De=ke+Se>>1,tt=me+Oe>>1,Qe=De+tt-me,mt=tt+ke-De,at=me*ll+ke,lt=Oe*ll+Se,bt=tt*ll+De,xt=Math.hypot((fc[2*at+0]+fc[2*lt+0])/2-fc[2*bt+0],(fc[2*at+1]+fc[2*lt+1])/2-fc[2*bt+1])>=16;hu[bt]=hu[bt]||(xt?1:0),ae<1022&&(hu[bt]=hu[bt]||hu[(me+mt>>1)*ll+(ke+Qe>>1)]||hu[(Oe+mt>>1)*ll+(Se+Qe>>1)])}const j=new Qi,H=new as;let K=0;function Y(ae,we){const ke=we*ll+ae;return 0===q_[ke]&&(j.emplaceBack(fc[2*ke+0],fc[2*ke+1],ae*Gn/br,we*Gn/br),q_[ke]=++K),q_[ke]-1}function te(ae,we,ke,me,Se,Oe){const De=ae+ke>>1,tt=we+me>>1;if(Math.abs(ae-Se)+Math.abs(we-Oe)>1&&hu[tt*ll+De])te(Se,Oe,ae,we,De,tt),te(ke,me,Se,Oe,De,tt);else{const Qe=Y(ae,we),mt=Y(ke,me),at=Y(Se,Oe);H.emplaceBack(Qe,mt,at)}}return te(0,0,br,br,br,0),te(br,br,0,0,0,br),{vertices:j,indices:H}}(this.tileID.canonical,u);_=w.vertices,b=w.indices}else{_=new Qi,b=new as;for(const{x:S,y:I}of p)_.emplaceBack(S,I,0,0);const w=kh(_.int16,void 0,4);for(let S=0;S<w.length;S+=3)b.emplaceBack(w[S],w[S+1],w[S+2])}this._tileBoundsBuffer=a.createVertexBuffer(_,h1.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(b),this._tileBoundsSegments=ir.simpleSegment(0,0,_.length,b.length)}_makeGlobeTileDebugBuffers(a,u){const p=u.projection;if(!p||"globe"!==p.name||u.freezeTileCoverage)return;const _=this.tileID.canonical,b=Wp(y_(_,u)),w=qp(u.zoom);let S;w>0&&(S=rc(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,_,u,b,S,w),this._makeGlobeTileDebugTextBuffer(a,_,u,b,S,w)}_globePoint(a,u,p,_,b,w,S){let I=Tm(a,u,p);if(w){const M=1<<p.z,z=Fl(_.center.lng),j=Zs(_.center.lat),H=(p.x+.5)/M-z;let K=0;H>.5?K=-1:H<-.5&&(K=1);let Y=(a/Gn+p.x)/M+K,te=(u/Gn+p.y)/M;Y=(Y-z)*_._pixelsPerMercatorPixel+z,te=(te-j)*_._pixelsPerMercatorPixel+j;const ae=[Y*_.worldSize,te*_.worldSize,0];Wo(ae,ae,w),I=Lr(I,ae,S)}return Wo(I,I,b)}_makeGlobeTileDebugBorderBuffer(a,u,p,_,b,w){const S=new In,I=new Rs,M=new Yi,z=(H,K,Y,te,ae)=>{const we=(Y-H)/(ae-1),ke=(te-K)/(ae-1),me=S.length;for(let Se=0;Se<ae;Se++){const Oe=H+Se*we,De=K+Se*ke;S.emplaceBack(Oe,De);const tt=this._globePoint(Oe,De,u,p,_,b,w);M.emplaceBack(tt[0],tt[1],tt[2]),I.emplaceBack(me+Se)}},j=Gn;z(0,0,j,0,16),z(j,0,j,j,16),z(j,j,0,j,16),z(0,j,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(I),this._tileDebugBuffer=a.createVertexBuffer(S,Th.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(M,cv.members),this._tileDebugSegments=ir.simpleSegment(0,0,S.length,I.length)}_makeGlobeTileDebugTextBuffer(a,u,p,_,b,w){const S=new In,I=new as,M=new Yi,z=25;I.reserve(32),S.reserve(z),M.reserve(z);const j=(H,K)=>z*H+K;for(let H=0;H<z;H++){const K=2048*H;for(let Y=0;Y<z;Y++){const te=2048*Y;S.emplaceBack(te,K);const ae=this._globePoint(te,K,u,p,_,b,w);M.emplaceBack(ae[0],ae[1],ae[2])}}for(let H=0;H<4;H++)for(let K=0;K<4;K++){const Y=j(H,K),te=j(H,K+1),ae=j(H+1,K),we=j(H+1,K+1);I.emplaceBack(Y,te,ae),I.emplaceBack(ae,te,we)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(I),this._tileDebugTextBuffer=a.createVertexBuffer(S,Th.members),this._globeTileDebugTextBuffer=a.createVertexBuffer(M,cv.members),this._tileDebugTextSegments=ir.simpleSegment(0,0,z,32)}}class ZS{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,u,p){const _=String(u);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][_]=this.stateChanges[a][_]||{},ri(this.stateChanges[a][_],p),null===this.deletedStates[a]){this.deletedStates[a]={};for(const b in this.state[a])b!==_&&(this.deletedStates[a][b]=null)}else if(this.deletedStates[a]&&null===this.deletedStates[a][_]){this.deletedStates[a][_]={};for(const b in this.state[a][_])p[b]||(this.deletedStates[a][_][b]=null)}else for(const b in p)this.deletedStates[a]&&this.deletedStates[a][_]&&null===this.deletedStates[a][_][b]&&delete this.deletedStates[a][_][b]}removeFeatureState(a,u,p){if(null===this.deletedStates[a])return;const _=String(u);if(this.deletedStates[a]=this.deletedStates[a]||{},p&&void 0!==u)null!==this.deletedStates[a][_]&&(this.deletedStates[a][_]=this.deletedStates[a][_]||{},this.deletedStates[a][_][p]=null);else if(void 0!==u)if(this.stateChanges[a]&&this.stateChanges[a][_])for(p in this.deletedStates[a][_]={},this.stateChanges[a][_])this.deletedStates[a][_][p]=null;else this.deletedStates[a][_]=null;else this.deletedStates[a]=null}getState(a,u){const p=String(u),_=ri({},(this.state[a]||{})[p],(this.stateChanges[a]||{})[p]);if(null===this.deletedStates[a])return{};if(this.deletedStates[a]){const b=this.deletedStates[a][u];if(null===b)return{};for(const w in b)delete _[w]}return _}initializeTileState(a,u){a.setFeatureState(this.state,u)}coalesceChanges(a,u){const p={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const b={};for(const w in this.stateChanges[_])this.state[_][w]||(this.state[_][w]={}),ri(this.state[_][w],this.stateChanges[_][w]),b[w]=this.state[_][w];p[_]=b}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const b={};if(null===this.deletedStates[_])for(const w in this.state[_])b[w]={},this.state[_][w]={};else for(const w in this.deletedStates[_]){if(null===this.deletedStates[_][w])this.state[_][w]={};else if(this.state[_][w])for(const S of Object.keys(this.deletedStates[_][w]))delete this.state[_][w][S];b[w]=this.state[_][w]}p[_]=p[_]||{},ri(p[_],b)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(p).length)for(const _ in a)a[_].setFeatureState(p,u)}}class lg{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,u){const p=this.toIdx(a,u);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(a,u){return this.leaves[this.toIdx(a,u)]}toIdx(a,u){return u*this.size+a}}function K_(c,a,u,p){let _=0,b=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(p[w])<1e-15){if(u[w]<c[w]||u[w]>a[w])return null}else{const S=1/p[w];let I=(c[w]-u[w])*S,M=(a[w]-u[w])*S;if(I>M){const z=I;I=M,M=z}if(I>_&&(_=I),M<b&&(b=M),_>b)return null}return _}function cg(c,a,u,p,_,b,w,S,I,M,z){const j=p-c,H=_-a,K=b-u,Y=w-c,te=S-a,ae=I-u,we=z[1]*ae-z[2]*te,ke=z[2]*Y-z[0]*ae,me=z[0]*te-z[1]*Y,Se=j*we+H*ke+K*me;if(Math.abs(Se)<1e-15)return null;const Oe=1/Se,De=M[0]-c,tt=M[1]-a,Qe=M[2]-u,mt=(De*we+tt*ke+Qe*me)*Oe;if(mt<0||mt>1)return null;const at=tt*K-Qe*H,lt=Qe*j-De*K,bt=De*H-tt*j,xt=(z[0]*at+z[1]*lt+z[2]*bt)*Oe;return xt<0||mt+xt>1?null:(Y*at+te*lt+ae*bt)*Oe}function KS(c,a,u){return(c-a)/(u-a)}function X_(c,a,u,p,_,b,w,S,I){const M=1<<u,z=b-p,j=w-_,H=(c+1)/M*z+p,K=(a+0)/M*j+_,Y=(a+1)/M*j+_;S[0]=(c+0)/M*z+p,S[1]=K,I[0]=H,I[1]=Y}class XS{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(b){const w=Math.ceil(Math.log2(b.dim/8)),S=[];let I=Math.ceil(Math.pow(2,w));const M=1/I,z=(K,Y,te,ae,we)=>{const ke=ae?1:0,me=(K+1)*te-ke,Se=Y*te,Oe=(Y+1)*te-ke;we[0]=K*te,we[1]=Se,we[2]=me,we[3]=Oe};let j=new lg(I);const H=[];for(let K=0;K<I*I;K++){z(K%I,Math.floor(K/I),M,!1,H);const Y=pu(H[0],H[1],b),te=pu(H[2],H[1],b),ae=pu(H[2],H[3],b),we=pu(H[0],H[3],b);j.minimums.push(Math.min(Y,te,ae,we)),j.maximums.push(Math.max(Y,te,ae,we)),j.leaves.push(1)}for(S.push(j),I/=2;I>=1;I/=2){const K=S[S.length-1];j=new lg(I);for(let Y=0;Y<I*I;Y++){z(Y%I,Math.floor(Y/I),2,!0,H);const te=K.getElevation(H[0],H[1]),ae=K.getElevation(H[2],H[1]),we=K.getElevation(H[2],H[3]),ke=K.getElevation(H[0],H[3]),me=K.isLeaf(H[0],H[1]),Se=K.isLeaf(H[2],H[1]),Oe=K.isLeaf(H[2],H[3]),De=K.isLeaf(H[0],H[3]),tt=Math.min(te.min,ae.min,we.min,ke.min),Qe=Math.max(te.max,ae.max,we.max,ke.max),mt=me&&Se&&Oe&&De;j.maximums.push(Qe),j.minimums.push(tt),j.leaves.push(Qe-tt<=5&&mt?1:0)}S.push(j)}return S}(this.dem),p=u.length-1,_=u[p];this._addNode(_.minimums[0],_.maximums[0],_.leaves[0]),this._construct(u,0,0,p,0)}raycastRoot(a,u,p,_,b,w,S=1){return K_([a,u,-100],[p,_,this.maximums[0]*S],b,w)}raycast(a,u,p,_,b,w,S=1){if(!this.nodeCount)return null;const I=this.raycastRoot(a,u,p,_,b,w,S);if(null==I)return null;const M=[],z=[],j=[],H=[],K=[{idx:0,t:I,nodex:0,nodey:0,depth:0}];for(;K.length>0;){const{idx:Y,t:te,nodex:ae,nodey:we,depth:ke}=K.pop();if(this.leaves[Y]){X_(ae,we,ke,a,u,p,_,j,H);const Se=1<<ke,Oe=(ae+0)/Se,De=(ae+1)/Se,tt=(we+0)/Se,Qe=(we+1)/Se,mt=pu(Oe,tt,this.dem)*S,at=pu(De,tt,this.dem)*S,lt=pu(De,Qe,this.dem)*S,bt=pu(Oe,Qe,this.dem)*S,xt=cg(j[0],j[1],mt,H[0],j[1],at,H[0],H[1],lt,b,w),Mt=cg(H[0],H[1],lt,j[0],H[1],bt,j[0],j[1],mt,b,w),Pt=Math.min(null!==xt?xt:Number.MAX_VALUE,null!==Mt?Mt:Number.MAX_VALUE);if(Pt!==Number.MAX_VALUE)return Pt;{const ut=wm([],b,w,te);if(ab(mt,at,bt,lt,KS(ut[0],j[0],H[0]),KS(ut[1],j[1],H[1]))>=ut[2])return te}continue}let me=0;for(let Se=0;Se<this._siblingOffset.length;Se++){X_((ae<<1)+this._siblingOffset[Se][0],(we<<1)+this._siblingOffset[Se][1],ke+1,a,u,p,_,j,H),j[2]=-100,H[2]=this.maximums[this.childOffsets[Y]+Se]*S;const Oe=K_(j,H,b,w);if(null!=Oe){const De=Oe;M[Se]=De;let tt=!1;for(let Qe=0;Qe<me&&!tt;Qe++)De>=M[z[Qe]]&&(z.splice(Qe,0,Se),tt=!0);tt||(z[me]=Se),me++}}for(let Se=0;Se<me;Se++){const Oe=z[Se];K.push({idx:this.childOffsets[Y]+Oe,t:M[Oe],nodex:(ae<<1)+this._siblingOffset[Oe][0],nodey:(we<<1)+this._siblingOffset[Oe][1],depth:ke+1})}}return null}_addNode(a,u,p){return this.minimums.push(a),this.maximums.push(u),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(a,u,p,_,b){if(1===a[_].isLeaf(u,p))return;this.childOffsets[b]||(this.childOffsets[b]=this.nodeCount);const w=_-1,S=a[w];let I=0,M=0;for(let z=0;z<this._siblingOffset.length;z++){const j=2*u+this._siblingOffset[z][0],H=2*p+this._siblingOffset[z][1],K=S.getElevation(j,H),Y=S.isLeaf(j,H),te=this._addNode(K.min,K.max,Y);Y&&(I|=1<<z),M||(M=te)}for(let z=0;z<this._siblingOffset.length;z++)I&1<<z||this._construct(a,2*u+this._siblingOffset[z][0],2*p+this._siblingOffset[z][1],w,M+z)}}function ab(c,a,u,p,_,b){return ki(ki(c,u,b),ki(a,p,b),_)}function pu(c,a,u){const p=u.dim,_=Hn(c*p-.5,0,p-1),b=Hn(a*p-.5,0,p-1),w=Math.floor(_),S=Math.floor(b),I=Math.min(w+1,p-1),M=Math.min(S+1,p-1);return ab(u.get(w,S),u.get(I,S),u.get(w,M),u.get(I,M),_-w,b-S)}const lb={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class ug{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,u,p,_=!1,b=!1){if(this.uid=a,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(p&&"mapbox"!==p&&"terrarium"!==p)return Mo(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const w=this.dim=u.height-2,S=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.encoding=p||"mapbox",this.borderReady=_,!_){for(let I=0;I<w;I++)S[this._idx(-1,I)]=S[this._idx(0,I)],S[this._idx(w,I)]=S[this._idx(w-1,I)],S[this._idx(I,-1)]=S[this._idx(I,0)],S[this._idx(I,w)]=S[this._idx(I,w-1)];S[this._idx(-1,-1)]=S[this._idx(0,0)],S[this._idx(w,-1)]=S[this._idx(w-1,0)],S[this._idx(-1,w)]=S[this._idx(0,w-1)],S[this._idx(w,w)]=S[this._idx(w-1,w-1)],b&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new XS(this)}get(a,u,p=!1){p&&(a=Hn(a,-1,this.dim),u=Hn(u,-1,this.dim));const _=4*this._idx(a,u);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[_],this.pixels[_+1],this.pixels[_+2])}static getUnpackVector(a){return lb[a]}get unpackVector(){return lb[this.encoding]}_idx(a,u){if(a<-1||a>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(a+1)}_unpackMapbox(a,u,p){return(256*a*256+256*u+p)/10-1e4}_unpackTerrarium(a,u,p){return 256*a+u+p/256-32768}static pack(a,u){const p=[0,0,0,0],_=ug.getUnpackVector(u);let b=Math.floor((a+_[3])/_[2]);return p[2]=b%256,b=Math.floor(b/256),p[1]=b%256,b=Math.floor(b/256),p[0]=b,p}getPixels(){return new pa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(a,u,p){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let _=u*this.dim,b=u*this.dim+this.dim,w=p*this.dim,S=p*this.dim+this.dim;switch(u){case-1:_=b-1;break;case 1:b=_+1}switch(p){case-1:w=S-1;break;case 1:S=w+1}const I=-u*this.dim,M=-p*this.dim;for(let z=w;z<S;z++)for(let j=_;j<b;j++){const H=4*this._idx(j,z),K=4*this._idx(j+I,z+M);this.pixels[H+0]=a.pixels[K+0],this.pixels[H+1]=a.pixels[K+1],this.pixels[H+2]=a.pixels[K+2],this.pixels[H+3]=a.pixels[K+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}dn(ug,"DEMData"),dn(XS,"DemMinMaxQuadTree",{omit:["dem"]});class cb{constructor(a,u){this.max=a,this.onRemove=u,this.reset()}reset(){for(const a in this.data)for(const u of this.data[a])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(a,u,p){const _=a.wrapped().key;void 0===this.data[_]&&(this.data[_]=[]);const b={value:u,timeout:void 0};if(void 0!==p&&(b.timeout=setTimeout(()=>{this.remove(a,b)},p)),this.data[_].push(b),this.order.push(_),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const u=this.data[a].shift();return u.timeout&&clearTimeout(u.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),u.value}getByKey(a){const u=this.data[a];return u?u[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,u){if(!this.has(a))return this;const p=a.wrapped().key,_=void 0===u?0:this.data[p].indexOf(u),b=this.data[p][_];return this.data[p].splice(_,1),b.timeout&&clearTimeout(b.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(a){const u=[];for(const p in this.data)for(const _ of this.data[p])a(_.value)||u.push(_);for(const p of u)this.remove(p.value.tileID,p)}}class fa{constructor(a,u,p){this.func=a,this.mask=u,this.range=p}}fa.ReadOnly=!1,fa.ReadWrite=!0,fa.disabled=new fa(519,fa.ReadOnly,[0,1]);class mf{constructor(a,u,p,_,b,w){this.test=a,this.ref=u,this.mask=p,this.fail=_,this.depthFail=b,this.pass=w}}mf.disabled=new mf({func:519,mask:0},0,0,7680,7680,7680);class ma{constructor(a,u,p){this.blendFunction=a,this.blendColor=u,this.mask=p}}ma.Replace=[1,0],ma.disabled=new ma(ma.Replace,tr.transparent,[!1,!1,!1,!1]),ma.unblended=new ma(ma.Replace,tr.transparent,[!0,!0,!0,!0]),ma.alphaBlended=new ma([1,771],tr.transparent,[!0,!0,!0,!0]);class cl{constructor(a,u,p){this.enable=a,this.mode=u,this.frontFace=p}}cl.disabled=new cl(!1,1029,2305),cl.backCCW=new cl(!0,1029,2305),cl.backCW=new cl(!0,1029,2304),cl.frontCW=new cl(!0,1028,2304),cl.frontCCW=new cl(!0,1028,2305);class Bh extends Ya{constructor(a,u,p){super(),this.id=a,this._onlySymbols=p,u.on("data",_=>{"source"===_.dataType&&"metadata"===_.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===_.dataType&&"content"===_.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new cb(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new ZS,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(a){this.map=a,this._minTileCacheSize=void 0===this._minTileCacheSize&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const u=this._tiles[a];if("loaded"!==u.state&&"errored"!==u.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,u){return a.isSymbolTile=this._onlySymbols,this._source.loadTile(a,u)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a,()=>{})}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const p=this._tiles[u];p.upload(a),p.prepare(this.map.style.imageManager)}}getIds(){return Vs(this._tiles).map(a=>a.tileID).sort(p1).map(a=>a.key)}getRenderableIds(a){const u=[];for(const p in this._tiles)this._isIdRenderable(+p,a)&&u.push(this._tiles[p]);return a?u.sort((p,_)=>{const b=p.tileID,w=_.tileID,S=new Ue(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),I=new Ue(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-w.overscaledZ||I.y-S.y||I.x-S.x}).map(p=>p.tileID.key):u.map(p=>p.tileID).sort(p1).map(p=>p.key)}hasRenderableParent(a){const u=this.findLoadedParent(a,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(a,u){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(u||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)"errored"!==this._tiles[a].state&&this._reloadTile(+a,"reloading")}}_reloadTile(a,u){const p=this._tiles[a];p&&("loading"!==p.state&&(p.state=u),this._loadTile(p,this._tileLoaded.bind(this,p,a,u)))}_tileLoaded(a,u,p,_){if(_)if(a.state="errored",404!==_.status)this._source.fire(new wl(_,{tile:a}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform);else a.timeAdded=Vi.now(),"expired"===p&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(u,a),"raster-dem"===this._source.type&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new go("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const u=this.getRenderableIds();for(let _=0;_<u.length;_++){const b=u[_];if(a.neighboringTiles&&a.neighboringTiles[b]){const w=this.getTileByID(b);p(a,w),p(w,a)}}function p(_,b){if(!_.dem||_.dem.borderReady)return;_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0;let w=b.tileID.canonical.x-_.tileID.canonical.x;const S=b.tileID.canonical.y-_.tileID.canonical.y,I=Math.pow(2,_.tileID.canonical.z),M=b.tileID.key;0===w&&0===S||Math.abs(S)>1||(Math.abs(w)>1&&(1===Math.abs(w+I)?w+=I:1===Math.abs(w-I)&&(w-=I)),b.dem&&_.dem&&(_.dem.backfillBorder(b.dem,w,S),_.neighboringTiles&&_.neighboringTiles[M]&&(_.neighboringTiles[M].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,u,p,_){for(const b in this._tiles){let w=this._tiles[b];if(_[b]||!w.hasData()||w.tileID.overscaledZ<=u||w.tileID.overscaledZ>p)continue;let S=w.tileID;for(;w&&w.tileID.overscaledZ>u+1;){const M=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[M.key],w&&w.hasData()&&(S=M)}let I=S;for(;I.overscaledZ>u;)if(I=I.scaledTo(I.overscaledZ-1),a[I.key]){_[S.key]=S;break}}}findLoadedParent(a,u){if(a.key in this._loadedParentTiles){const p=this._loadedParentTiles[a.key];return p&&p.tileID.overscaledZ>=u?p:null}for(let p=a.overscaledZ-1;p>=u;p--){const _=a.scaledTo(p),b=this._getLoadedTile(_);if(b)return b}}_getLoadedTile(a){const u=this._tiles[a.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,u){u=u||this._source.tileSize;const p=Math.ceil(a.width/u)+1,_=Math.ceil(a.height/u)+1,b=Math.floor(p*_*5),w="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,b):b,S="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)}handleWrapJump(a){const u=Math.round((a-(void 0===this._prevLng?a:this._prevLng))/360);if(this._prevLng=a,u){const p={};for(const _ in this._tiles){const b=this._tiles[_];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+u),p[b.tileID.key]=b}this._tiles=p;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(+_,this._tiles[_])}}update(a,u,p){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;let _;this.updateCacheSize(a,u),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?_=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(S=>new ur(S.canonical.z,S.wrap,S.canonical.z,S.canonical.x,S.canonical.y)):(_=a.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(_=_.filter(S=>this._source.hasTile(S)))):_=[];const b=this._updateRetainedTiles(_);if(gf(this._source.type)&&0!==_.length){const S={},I={},M=Object.keys(b);for(const j of M){const H=b[j],K=this._tiles[j];if(!K||K.fadeEndTime&&K.fadeEndTime<=Vi.now())continue;const Y=this.findLoadedParent(H,Math.max(H.overscaledZ-Bh.maxOverzooming,this._source.minzoom));Y&&(this._addTile(Y.tileID),S[Y.tileID.key]=Y.tileID),I[j]=H}const z=_[_.length-1].overscaledZ;for(const j in this._tiles){const H=this._tiles[j];if(b[j]||!H.hasData())continue;let K=H.tileID;for(;K.overscaledZ>z;){K=K.scaledTo(K.overscaledZ-1);const Y=this._tiles[K.key];if(Y&&Y.hasData()&&I[K.key]){b[j]=H.tileID;break}}}for(const j in S)b[j]||(this._coveredTiles[j]=!0,b[j]=S[j])}for(const S in b)this._tiles[S].clearFadeHold();const w=function(S,I){const M=[];for(const z in S)z in I||M.push(z);return M}(this._tiles,b);for(const S of w){const I=this._tiles[S];I.hasSymbolBuckets&&!I.holdingForFade()?I.setHoldDuration(this.map._fadeDuration):I.hasSymbolBuckets&&!I.symbolFadeFinished()||this._removeTile(+S)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const u={};if(0===a.length)return u;const p={},_=a.reduce((M,z)=>Math.min(M,z.overscaledZ),1/0),b=a[0].overscaledZ,w=Math.max(b-Bh.maxOverzooming,this._source.minzoom),S=Math.max(b+Bh.maxUnderzooming,this._source.minzoom),I={};for(const M of a){const z=this._addTile(M);u[M.key]=M,z.hasData()||_<this._source.maxzoom&&(I[M.key]=M)}this._retainLoadedChildren(I,_,S,u);for(const M of a){let z=this._tiles[M.key];if(z.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const H=M.children(this._source.maxzoom)[0],K=this.getTile(H);if(K&&K.hasData()){u[H.key]=H;continue}}else{const H=M.children(this._source.maxzoom);if(u[H[0].key]&&u[H[1].key]&&u[H[2].key]&&u[H[3].key])continue}let j=z.wasRequested();for(let H=M.overscaledZ-1;H>=w;--H){const K=M.scaledTo(H);if(p[K.key]||(p[K.key]=!0,z=this.getTile(K),!z&&j&&(z=this._addTile(K)),z&&(u[K.key]=K,j=z.wasRequested(),z.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const u=[];let p,_=this._tiles[a].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){p=this._loadedParentTiles[_.key];break}u.push(_.key);const b=_.scaledTo(_.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;_=b}for(const b of u)this._loadedParentTiles[b]=p}}_addTile(a){let u=this._tiles[a.key];if(u)return u;u=this._cache.getAndRemove(a),u&&(this._setTileReloadTimer(a.key,u),u.tileID=a,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,u)));const p=Boolean(u);if(!p){const _=this.map?this.map.painter:null;u=new sb(a,this._source.tileSize*a.overscaleFactor(),this.transform.tileZoom,_,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,a.key,u.state))}return u?(u.uses++,this._tiles[a.key]=u,p||this._source.fire(new go("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(a,u){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const p=u.getExpiryTimeout();p&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},p))}_removeTile(a){const u=this._tiles[a];u&&(u.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),u.uses>0||(u.hasData()&&"reloading"!==u.state?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,u,p){const _=[],b=this.transform;if(!b)return _;const w="globe"===b.projection.name,S=Fl(b.center.lng);for(const I in this._tiles){const M=this._tiles[I];if(p&&M.clearQueryDebugViz(),M.holdingForFade())continue;let z;if(w){const j=M.tileID.canonical;if(0===j.z){const H=[Math.abs(Hn(S,...dg(j,-1))-S),Math.abs(Hn(S,...dg(j,1))-S)];z=[0,2*H.indexOf(Math.min(...H))-1]}else{const H=[Math.abs(Hn(S,...dg(j,-1))-S),Math.abs(Hn(S,...dg(j,0))-S),Math.abs(Hn(S,...dg(j,1))-S)];z=[H.indexOf(Math.min(...H))-1]}}else z=[0];for(const j of z){const H=a.containsTile(M,b,u,j);H&&_.push(H)}}return _}getVisibleCoordinates(a){const u=this.getRenderableIds(a).map(p=>this._tiles[p].tileID);for(const p of u)p.projMatrix=this.transform.calculateProjMatrix(p.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(gf(this._source.type))for(const a in this._tiles){const u=this._tiles[a];if(void 0!==u.fadeEndTime&&u.fadeEndTime>=Vi.now())return!0}return!1}setFeatureState(a,u,p){this._state.updateState(a=a||"_geojsonTileLayer",u,p)}removeFeatureState(a,u,p){this._state.removeFeatureState(a=a||"_geojsonTileLayer",u,p)}getFeatureState(a,u){return this._state.getState(a=a||"_geojsonTileLayer",u)}setDependencies(a,u,p){const _=this._tiles[a];_&&_.setDependencies(u,p)}reloadTilesForDependencies(a,u){for(const p in this._tiles)this._tiles[p].hasDependency(a,u)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(a,u))}_preloadTiles(a,u){const p=new Map,_=Array.isArray(a)?a:[a],b=this.map.painter.terrain,w=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(const S of _){const I=S.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of I)p.set(M.key,M);this.usedForTerrain&&S.updateElevation(!1)}na(Array.from(p.values()),(S,I)=>{const M=new sb(S,this._source.tileSize*S.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,z=>{"raster-dem"===this._source.type&&M.dem&&this._backfillDEM(M),I(z,M)})},u)}}function p1(c,a){const u=Math.abs(2*c.wrap)-+(c.wrap<0),p=Math.abs(2*a.wrap)-+(a.wrap<0);return c.overscaledZ-a.overscaledZ||p-u||a.canonical.y-c.canonical.y||a.canonical.x-c.canonical.x}function gf(c){return"raster"===c||"image"===c||"video"===c||"custom"===c}function dg(c,a){const u=1<<c.z;return[c.x/u+a,(c.x+1)/u+a]}Bh.maxOverzooming=10,Bh.maxUnderzooming=3;class db{constructor(a,u,p){this._demTile=a,this._dem=this._demTile.dem,this._scale=u,this._offset=p}static create(a,u,p){const _=p||a.findDEMTileFor(u);if(!_||!_.dem)return;const b=_.dem,w=_.tileID,S=1<<u.canonical.z-w.canonical.z;return new db(_,_.tileSize/Gn/S,[(u.canonical.x/S-w.canonical.x)*b.dim,(u.canonical.y/S-w.canonical.y)*b.dim])}tileCoordToPixel(a,u){const p=u*this._scale+this._offset[1],_=Math.floor(a*this._scale+this._offset[0]),b=Math.floor(p);return new Ue(_,b)}getElevationAt(a,u,p,_){const b=a*this._scale+this._offset[0],w=u*this._scale+this._offset[1],S=Math.floor(b),I=Math.floor(w),M=this._dem;return _=!!_,p?ki(ki(M.get(S,I,_),M.get(S,I+1,_),w-I),ki(M.get(S+1,I,_),M.get(S+1,I+1,_),w-I),b-S):M.get(S,I,_)}getElevationAtPixel(a,u,p){return this._dem.get(a,u,!!p)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*Fa(1,a)*this._dem.stride}}class f1{constructor(a,u){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new fh(Gn,16,0),this.featureIndexArray=new yh,this.promoteId=u}insert(a,u,p,_,b,w=0){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,_,b,w);const I=this.grid;for(let M=0;M<u.length;M++){const z=u[M],j=[1/0,1/0,-1/0,-1/0];for(let H=0;H<z.length;H++){const K=z[H];j[0]=Math.min(j[0],K.x),j[1]=Math.min(j[1],K.y),j[2]=Math.max(j[2],K.x),j[3]=Math.max(j[3],K.y)}j[0]<Gn&&j[1]<Gn&&j[2]>=0&&j[3]>=0&&I.insert(S,j[0],j[1],j[2],j[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Mv(new Km(this.rawTileData)).layers,this.sourceLayerCoder=new c1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const a in this.vtLayers)this.vtFeatures[a]=[]}return this.vtLayers}query(a,u,p,_){this.loadVTLayers();const b=a.params||{},w=am(b.filter),S=a.tileResult,I=a.transform,M=S.bufferedTilespaceBounds,z=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(Y,te,ae,we)=>wv(S.bufferedTilespaceGeometry,Y,te,ae,we));z.sort(YS);let j=null;I.elevation&&z.length>0&&(j=db.create(I.elevation,this.tileID));const H={};let K;for(let Y=0;Y<z.length;Y++){const te=z[Y];if(te===K)continue;K=te;const ae=this.featureIndexArray.get(te);let we=null;this.loadMatchingFeature(H,ae,w,b.layers,b.availableImages,u,p,_,(ke,me,Se,Oe=0)=>(we||(we=tu(ke,this.tileID.canonical,a.tileTransform)),me.queryIntersectsFeature(S,ke,Se,we,this.z,a.transform,a.pixelPosMatrix,j,Oe)))}return H}loadMatchingFeature(a,u,p,_,b,w,S,I,M){const{featureIndex:z,bucketIndex:j,sourceLayerIndex:H,layoutVertexArrayOffset:K}=u,Y=this.bucketLayerIDs[j];if(_&&!function(ke,me){for(let Se=0;Se<ke.length;Se++)if(me.indexOf(ke[Se])>=0)return!0;return!1}(_,Y))return;const te=this.sourceLayerCoder.decode(H),ae=this.vtLayers[te].feature(z);if(p.needGeometry){const ke=Mh(ae,!0);if(!p.filter(new $e(this.tileID.overscaledZ),ke,this.tileID.canonical))return}else if(!p.filter(new $e(this.tileID.overscaledZ),ae))return;const we=this.getId(ae,te);for(let ke=0;ke<Y.length;ke++){const me=Y[ke];if(_&&_.indexOf(me)<0)continue;const Se=w[me];if(!Se)continue;let Oe={};void 0!==we&&I&&(Oe=I.getState(Se.sourceLayer||"_geojsonTileLayer",we));const De=ri({},S[me]);De.paint=m1(De.paint,Se.paint,ae,Oe,b),De.layout=m1(De.layout,Se.layout,ae,Oe,b);const tt=!M||M(ae,Se,Oe,K);if(!tt)continue;const Qe=new u1(ae,this.z,this.x,this.y,we);Qe.layer=De;let mt=a[me];void 0===mt&&(mt=a[me]=[]),mt.push({featureIndex:z,feature:Qe,intersectionZ:tt})}}lookupSymbolFeatures(a,u,p,_,b,w,S,I){const M={};this.loadVTLayers();const z=am(b);for(const j of a)this.loadMatchingFeature(M,{bucketIndex:p,sourceLayerIndex:_,featureIndex:j,layoutVertexArrayOffset:0},z,w,S,I,u);return M}loadFeature(a){const{featureIndex:u,sourceLayerIndex:p}=a;this.loadVTLayers();const _=this.sourceLayerCoder.decode(p),b=this.vtFeatures[_];if(b[u])return b[u];const w=this.vtLayers[_].feature(u);return b[u]=w,w}hasLayer(a){for(const u of this.bucketLayerIDs)for(const p of u)if(a===p)return!0;return!1}getId(a,u){let p=a.id;if(this.promoteId){const _="string"==typeof this.promoteId?this.promoteId:this.promoteId[u];null!=_&&(p=a.properties[_]),"boolean"==typeof p&&(p=Number(p))}return p}}function m1(c,a,u,p,_){return Ki(c,(b,w)=>{const S=a instanceof ot?a.get(w):null;return S&&S.evaluate?S.evaluate(u,p,_):S})}function YS(c,a){return a-c}dn(f1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class g1{constructor(a,u){this.width=a,this.height=u,this.nextRow=0,this.image=new ha({width:a,height:u}),this.positions={},this.uploaded=!1}getDash(a,u){const p=this.getKey(a,u);return this.positions[p]}trim(){const a=this.width,u=this.height=fs(this.nextRow);this.image.resize({width:a,height:u})}getKey(a,u){return a.join(",")+u}getDashRanges(a,u,p){const _=[];let b=a.length%2==1?-a[a.length-1]*p:0,w=a[0]*p,S=!0;_.push({left:b,right:w,isDash:S,zeroLength:0===a[0]});let I=a[0];for(let M=1;M<a.length;M++){S=!S;const z=a[M];b=I*p,I+=z,w=I*p,_.push({left:b,right:w,isDash:S,zeroLength:0===z})}return _}addRoundDash(a,u,p){const _=u/2;for(let b=-p;b<=p;b++){const w=this.width*(this.nextRow+p+b);let S=0,I=a[S];for(let M=0;M<this.width;M++){M/I.right>1&&(I=a[++S]);const z=Math.abs(M-I.left),j=Math.abs(M-I.right),H=Math.min(z,j);let K;const Y=b/p*(_+1);if(I.isDash){const te=_-Math.abs(Y);K=Math.sqrt(H*H+te*te)}else K=_-Math.sqrt(H*H+Y*Y);this.image.data[w+M]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(a,u){for(let I=a.length-1;I>=0;--I){const M=a[I],z=a[I+1];M.zeroLength?a.splice(I,1):z&&z.isDash===M.isDash&&(z.left=M.left,a.splice(I,1))}const p=a[0],_=a[a.length-1];p.isDash===_.isDash&&(p.left=_.left-this.width,_.right=p.right+this.width);const b=this.width*this.nextRow;let w=0,S=a[w];for(let I=0;I<this.width;I++){I/S.right>1&&(S=a[++w]);const M=Math.abs(I-S.left),z=Math.abs(I-S.right),j=Math.min(M,z);this.image.data[b+I]=Math.max(0,Math.min(255,(S.isDash?j:-j)+u+128))}}addDash(a,u){const p=this.getKey(a,u);if(this.positions[p])return this.positions[p];const _="round"===u,b=_?7:0,w=2*b+1;if(this.nextRow+w>this.height)return Mo("LineAtlas out of space"),null;0===a.length&&a.push(1);let S=0;for(let z=0;z<a.length;z++)a[z]<0&&(Mo("Negative value is found in line dasharray, replacing values with 0"),a[z]=0),S+=a[z];if(0!==S){const z=this.width/S,j=this.getDashRanges(a,this.width,z);_?this.addRoundDash(j,z,b):this.addRegularDash(j,"square"===u?.5*z:0)}const I=this.nextRow+b;this.nextRow+=w;const M={tl:[I,b],br:[S,0]};return this.positions[p]=M,M}}dn(g1,"LineAtlas");class _1{constructor(a){const u={},p=[];for(const S in a){const I=a[S],M=u[S]={};for(const z in I.glyphs){const j=I.glyphs[+z];if(!j||0===j.bitmap.width||0===j.bitmap.height)continue;const H=j.metrics.localGlyph?2:1,K={x:0,y:0,w:j.bitmap.width+2*H,h:j.bitmap.height+2*H};p.push(K),M[z]=K}}const{w:_,h:b}=zv(p),w=new ha({width:_||1,height:b||1});for(const S in a){const I=a[S];for(const M in I.glyphs){const z=I.glyphs[+M];if(!z||0===z.bitmap.width||0===z.bitmap.height)continue;const j=u[S][M],H=z.metrics.localGlyph?2:1;ha.copy(z.bitmap,w,{x:0,y:0},{x:j.x+H,y:j.y+H},z.bitmap)}}this.image=w,this.positions=u}}dn(_1,"GlyphAtlas");class QS{constructor(a){this.tileID=new ur(a.tileID.overscaledZ,a.tileID.wrap,a.tileID.canonical.z,a.tileID.canonical.x,a.tileID.canonical.y),this.tileZoom=a.tileZoom,this.uid=a.uid,this.zoom=a.zoom,this.canonical=a.tileID.canonical,this.pixelRatio=a.pixelRatio,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=a.showCollisionBoxes,this.collectResourceTiming=!!a.collectResourceTiming,this.returnDependencies=!!a.returnDependencies,this.promoteId=a.promoteId,this.enableTerrain=!!a.enableTerrain,this.isSymbolTile=a.isSymbolTile,this.tileTransform=uu(a.tileID.canonical,a.projection),this.projection=a.projection}parse(a,u,p,_,b){this.status="parsing",this.data=a,this.collisionBoxArray=new o_;const w=new c1(Object.keys(a.layers).sort()),S=new f1(this.tileID,this.promoteId);S.bucketLayerIDs=[];const I={},M=new g1(256,256),z={featureIndex:S,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:p},j=u.familiesBySource[this.source];for(const Oe in j){const De=a.layers[Oe];if(!De)continue;let tt=!1,Qe=!1;for(const lt of j[Oe])"symbol"===lt[0].type?tt=!0:Qe=!0;if(!0===this.isSymbolTile&&!tt||!1===this.isSymbolTile&&!Qe)continue;1===De.version&&Mo(`Vector tile source "${this.source}" layer "${Oe}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const mt=w.encode(Oe),at=[];for(let lt=0;lt<De.length;lt++){const bt=De.feature(lt),xt=S.getId(bt,Oe);at.push({feature:bt,id:xt,index:lt,sourceLayerIndex:mt})}for(const lt of j[Oe]){const bt=lt[0];void 0!==this.isSymbolTile&&"symbol"===bt.type!==this.isSymbolTile||bt.minzoom&&this.zoom<Math.floor(bt.minzoom)||bt.maxzoom&&this.zoom>=bt.maxzoom||"none"!==bt.visibility&&(hb(lt,this.zoom,p),(I[bt.id]=bt.createBucket({index:S.bucketLayerIDs.length,layers:lt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:mt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:p})).populate(at,z,this.tileID.canonical,this.tileTransform),S.bucketLayerIDs.push(lt.map(xt=>xt.id)))}}let H,K,Y,te;M.trim();const ae={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},we=Ki(z.glyphDependencies,Oe=>Object.keys(Oe).map(Number));Object.keys(we).length?_.send("getGlyphs",{uid:this.uid,stacks:we},(Oe,De)=>{H||(H=Oe,K=De,Se.call(this))},void 0,!1,ae):K={};const ke=Object.keys(z.iconDependencies);ke.length?_.send("getImages",{icons:ke,source:this.source,tileID:this.tileID,type:"icons"},(Oe,De)=>{H||(H=Oe,Y=De,Se.call(this))},void 0,!1,ae):Y={};const me=Object.keys(z.patternDependencies);function Se(){if(H)return b(H);if(K&&Y&&te){const Oe=new _1(K),De=new al(Y,te);for(const tt in I){const Qe=I[tt];Qe instanceof du?(hb(Qe.layers,this.zoom,p),LS(Qe,K,Oe.positions,Y,De.iconPositions,this.showCollisionBoxes,p,this.tileID.canonical,this.tileZoom,this.projection)):Qe.hasPattern&&(Qe instanceof Wm||Qe instanceof ef||Qe instanceof tf)&&(hb(Qe.layers,this.zoom,p),Qe.addFeatures(z,this.tileID.canonical,De.patternPositions,p,this.tileTransform))}this.status="done",b(null,{buckets:Vs(I).filter(tt=>!tt.isEmpty()),featureIndex:S,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Oe.image,lineAtlas:M,imageAtlas:De,glyphMap:this.returnDependencies?K:null,iconMap:this.returnDependencies?Y:null,glyphPositions:this.returnDependencies?Oe.positions:null})}}me.length?_.send("getImages",{icons:me,source:this.source,tileID:this.tileID,type:"patterns"},(Oe,De)=>{H||(H=Oe,te=De,Se.call(this))},void 0,!1,ae):te={},Se.call(this)}}function hb(c,a,u){const p=new $e(a);for(const _ of c)_.recalculate(p,u)}class pb{constructor(a){this.entries={},this.scheduler=a}request(a,u,p,_){const b=this.entries[a]=this.entries[a]||{callbacks:[]};if(b.result){const[w,S]=b.result;return this.scheduler?this.scheduler.add(()=>{_(w,S)},u):_(w,S),()=>{}}return b.callbacks.push(_),b.cancel||(b.cancel=p((w,S)=>{b.result=[w,S];for(const I of b.callbacks)this.scheduler?this.scheduler.add(()=>{I(w,S)},u):I(w,S);setTimeout(()=>delete this.entries[a],3e3)})),()=>{b.result||(b.callbacks=b.callbacks.filter(w=>w!==_),b.callbacks.length||(b.cancel(),delete this.entries[a]))}}}function ji(c,a,u){const p=JSON.stringify(c.request);return c.data&&(this.deduped.entries[p]={result:[null,c.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},_=>{const b=Ru(c.request,(w,S,I,M)=>{w?_(w):S&&_(null,{vectorTile:u?void 0:new Mv(new Km(S)),rawData:S,cacheControl:I,expires:M})});return()=>{b.cancel(),_()}},a)}g.ARRAY_TYPE=ca,g.AUTH_ERR_MSG=zu,g.Aabb=Po,g.Actor=class{constructor(c,a,u){this.target=c,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Ta(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=qa()?c:se,this.scheduler=new WS}send(c,a,u,p,_=!1,b){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=b,this.callbacks[w]=u);const S=Wl(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:c,hasCallback:!!u,targetMapId:p,mustQueue:_,sourceMapId:this.mapId,data:gh(a,S)},S),{cancel:()=>{u&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(c){const a=c.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if("<cancel>"===a.type){const p=this.cancelCallbacks[u];delete this.cancelCallbacks[u],p&&p.cancel()}else if(a.mustQueue||qa()){const p=this.callbacks[u];this.cancelCallbacks[u]=this.scheduler.add(()=>this.processTask(u,a),p&&p.metadata||{type:"message"})}else this.processTask(u,a)}processTask(c,a){if("<response>"===a.type){const u=this.callbacks[c];delete this.callbacks[c],u&&(a.error?u(zt(a.error)):u(null,zt(a.data)))}else{const u=Wl(this.globalScope)?void 0:[],p=a.hasCallback?(b,w)=>{delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:b?gh(b):null,data:gh(w,u)},u)}:b=>{},_=zt(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,_,p);else if(this.parent.getWorkerSource){const b=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,b[0],_.source)[b[1]](_,p)}else p(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},g.CanonicalTileID=$m,g.Color=tr,g.ColorMode=ma,g.CullFaceMode=cl,g.DEMData=ug,g.DataConstantProperty=je,g.DedupedRequest=pb,g.DepthMode=fa,g.EXTENT=Gn,g.Elevation=class{isDataAvailableAtPoint(c){const a=this._source();if(this.isUsingMockSource()||!a||c.y<0||c.y>1)return!1;const u=a.getSource().maxzoom,p=1<<u,_=Math.floor(c.x),b=Math.floor((c.x-_)*p),w=Math.floor(c.y*p),S=this.findDEMTileFor(new ur(u,_,u,b,w));return!(!S||!S.dem)}getAtPointOrZero(c,a=0){return this.getAtPoint(c,a)||0}getAtPoint(c,a,u=!0){if(this.isUsingMockSource())return null;null==a&&(a=null);const p=this._source();if(!p||c.y<0||c.y>1)return a;const _=p.getSource().maxzoom,b=1<<_,w=Math.floor(c.x),S=c.x-w,I=new ur(_,w,_,Math.floor(S*b),Math.floor(c.y*b)),M=this.findDEMTileFor(I);if(!M||!M.dem)return a;const z=M.dem,j=1<<M.tileID.canonical.z,H=(S*j-M.tileID.canonical.x)*z.dim,K=(c.y*j-M.tileID.canonical.y)*z.dim,Y=Math.floor(H),te=Math.floor(K);return(u?this.exaggeration():1)*ki(ki(z.get(Y,te),z.get(Y,te+1),K-te),ki(z.get(Y+1,te),z.get(Y+1,te+1),K-te),H-Y)}getAtTileOffset(c,a,u){const p=1<<c.canonical.z;return this.getAtPointOrZero(new Zp(c.wrap+(c.canonical.x+a/Gn)/p,(c.canonical.y+u/Gn)/p))}getAtTileOffsetFunc(c,a,u,p){return _=>{const b=this.getAtTileOffset(c,_.x,_.y),w=p.upVector(c.canonical,_.x,_.y);return Oa(w,w,b*p.upVectorScale(c.canonical,a,u).metersToTile),w}}getForTilePoints(c,a,u,p){if(this.isUsingMockSource())return!1;const _=db.create(this,c,p);return!!_&&(a.forEach(b=>{b[2]=this.exaggeration()*_.getElevationAt(b[0],b[1],u)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const a=this.findDEMTileFor(c);if(!a||!a.dem)return null;const u=a.dem.tree,p=a.tileID,_=1<<c.canonical.z-p.canonical.z;let b=c.canonical.x/_-p.canonical.x,w=c.canonical.y/_-p.canonical.y,S=0;for(let I=0;I<c.canonical.z-p.canonical.z&&!u.leaves[S];I++){b*=2,w*=2;const M=2*Math.floor(w)+Math.floor(b);S=u.childOffsets[S]+M,b%=1,w%=1}return{min:this.exaggeration()*u.minimums[S],max:this.exaggeration()*u.maximums[S]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,a,u){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},g.ErrorEvent=wl,g.EvaluationParameters=$e,g.Event=go,g.Evented=Ya,g.FillExtrusionBucket=tf,g.Frustum=g_,g.FrustumCorners=m_,g.GLOBE_RADIUS=lc,g.GLOBE_SCALE_MATCH_LATITUDE=45,g.GLOBE_ZOOM_THRESHOLD_MAX=6,g.GLOBE_ZOOM_THRESHOLD_MIN=5,g.GlobeSharedBuffers=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const c of this._wireframeSegments)c.destroy()}}_fillGridMeshWithLods(c,a){const u=new In,p=new as,_=[],b=c+1+2,w=a[0]+1,S=a[0]+1+(1+a.length),I=(M,z,j)=>{let H=M===b-1?M-2:0===M?M:M-1;return H+=j?24575:0,[H,z]};for(let M=0;M<b;++M)u.emplaceBack(...I(M,0,!0));for(let M=0;M<w;++M)for(let z=0;z<b;++z)u.emplaceBack(...I(z,M,(0===z||z===b-1)&&!0));for(let M=0;M<a.length;++M){const z=a[M];for(let j=0;j<b;++j)u.emplaceBack(...I(j,z,!0))}for(let M=0;M<a.length;++M){const z=p.length,j=a[M]+1+2,H=new as;for(let te=0;te<j-1;te++){const ae=te===j-2,we=ae?b*(S-a.length+M-te):b;for(let ke=0;ke<b-1;ke++){const me=te*b+ke;0===te||ae||0===ke||ke===b-2?(H.emplaceBack(me+1,me,me+we),H.emplaceBack(me+we,me+we+1,me+1)):(p.emplaceBack(me+1,me,me+we),p.emplaceBack(me+we,me+we+1,me+1))}}const K=ir.simpleSegment(0,z,u.length,p.length-z);for(let te=0;te<H.uint16.length;te+=3)p.emplaceBack(H.uint16[te],H.uint16[te+1],H.uint16[te+2]);const Y=ir.simpleSegment(0,z,u.length,p.length-z);_.push({withoutSkirts:K,withSkirts:Y})}return{vertices:u,indices:p,segments:_}}_createGrid(c){const a=this._fillGridMeshWithLods(64,Cm);this._gridSegments=a.segments,this._gridBuffer=c.createVertexBuffer(a.vertices,Th.members),this._gridIndexBuffer=c.createIndexBuffer(a.indices,!0)}_createPoles(c){const a=new as;for(let _=0;_<=64;_++)a.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=c.createIndexBuffer(a,!0);const u=new Ws,p=new Ws;this._poleSegments=[];for(let _=0,b=0;_<5;_++){const w=360/(1<<_);u.emplaceBack(0,-lc,0,.5,0),p.emplaceBack(0,-lc,0,.5,1);for(let S=0;S<=64;S++){const I=S/64,M=ki(0,w,I),[z,j,H]=Ih(KT,Im,M,lc);u.emplaceBack(z,j,H,I,0),p.emplaceBack(z,j,H,I,1)}this._poleSegments.push(ir.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(u,rx,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(p,rx,!1)}getGridBuffers(c,a){return[this._gridBuffer,this._gridIndexBuffer,a?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}getWirefameBuffers(c,a){if(!this._wireframeSegments){const u=new ka,p=64,_=p+1+2,b=1;this._wireframeSegments=[];for(let w=0,S=0;w<Cm.length;w++){const I=Cm[w];for(let z=b;z<I+b;z++)for(let j=b;j<p+b;j++){const H=z*_+j;u.emplaceBack(H,H+1),u.emplaceBack(H,H+_),u.emplaceBack(H,H+_+1)}const M=I*p*3;this._wireframeSegments.push(ir.simpleSegment(0,S,(I+1)*_,M)),S+=M}this._wireframeIndexBuffer=c.createIndexBuffer(u)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[a]]}},g.GlyphManager=uf,g.ImagePosition=Bv,g.LivePerformanceUtils=Ct,g.LngLat=Oi,g.LngLatBounds=dd,g.LocalGlyphMode=Jm,g.MAX_MERCATOR_LATITUDE=cs,g.MercatorCoordinate=Zp,g.ONE_EM=dr,g.OverscaledTileID=ur,g.PerformanceMarkers=nt,g.Properties=Ot,g.RGBAImage=pa,g.Ray=f_,g.RequestManager=class{constructor(c,a,u){this._transformRequestFn=c,this._customAccessToken=a,this._silenceAuthErrors=!!u,this._createSkuToken()}_createSkuToken(){const c=function(){let a="";for(let u=0;u<10;u++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",jt,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,a){return this._transformRequestFn&&this._transformRequestFn(c,a)||{url:c}}normalizeStyleURL(c,a){if(!Xa(c))return c;const u=Ds(c);return u.path=`/styles/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeGlyphsURL(c,a){if(!Xa(c))return c;const u=Ds(c);return u.path=`/fonts/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeSourceURL(c,a,u,p){if(!Xa(c))return c;const _=Ds(c);return _.path=`/v4/${_.authority}.json`,_.params.push("secure"),u&&_.params.push(`language=${u}`),p&&_.params.push(`worldview=${p}`),this._makeAPIURL(_,this._customAccessToken||a)}normalizeSpriteURL(c,a,u,p){const _=Ds(c);return Xa(c)?(_.path=`/styles/v1${_.path}/sprite${a}${u}`,this._makeAPIURL(_,this._customAccessToken||p)):(_.path+=`${a}${u}`,Kl(_))}normalizeTileURL(c,a,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!Xa(c))return c;const p=Ds(c);p.path=p.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${a||u&&"raster"!==p.authority&&512===u?"@2x":""}${Xe.supported?".webp":"$1"}`),"raster"===p.authority?p.path=`/${Ve.RASTER_URL_PREFIX}${p.path}`:(p.path=p.path.replace(/^.+\/v4\//,"/"),p.path=`/${Ve.TILE_URL_VERSION}${p.path}`);const _=this._customAccessToken||function(b){for(const w of b){const S=w.match(/^access_token=(.*)$/);if(S)return S[1]}return null}(p.params)||Ve.ACCESS_TOKEN;return Ve.REQUIRE_ACCESS_TOKEN&&_&&this._skuToken&&p.params.push(`sku=${this._skuToken}`),this._makeAPIURL(p,_)}canonicalizeTileURL(c,a){const u=Ds(c);if(!u.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!u.path.match(/\.[\w]+$/))return c;let p="mapbox://";u.path.match(/^\/raster\/v1\//)?p+=`raster/${u.path.replace(`/${Ve.RASTER_URL_PREFIX}/`,"")}`:p+=`tiles/${u.path.replace(`/${Ve.TILE_URL_VERSION}/`,"")}`;let _=u.params;return a&&(_=_.filter(b=>!b.match(/^access_token=/))),_.length&&(p+=`?${_.join("&")}`),p}canonicalizeTileset(c,a){const u=!!a&&Xa(a),p=[];for(const _ of c.tiles||[])Bu(_)?p.push(this.canonicalizeTileURL(_,u)):p.push(_);return p}_makeAPIURL(c,a){const u="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",p=Ds(Ve.API_URL);if(c.protocol=p.protocol,c.authority=p.authority,"http"===c.protocol){const _=c.params.indexOf("secure");_>=0&&c.params.splice(_,1)}if("/"!==p.path&&(c.path=`${p.path}${c.path}`),!Ve.REQUIRE_ACCESS_TOKEN)return Kl(c);if(a=a||Ve.ACCESS_TOKEN,!this._silenceAuthErrors){if(!a)throw new Error(`An API access token is required to use Mapbox GL. ${u}`);if("s"===a[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${u}`)}return c.params=c.params.filter(_=>-1===_.indexOf("access_token")),c.params.push(`access_token=${a||""}`),Kl(c)}},g.ResourceType=Wd,g.SegmentVector=ir,g.SourceCache=Bh,g.StencilMode=mf,g.StructArrayLayout1ui2=Rs,g.StructArrayLayout2f1f2i16=Kr,g.StructArrayLayout2i4=In,g.StructArrayLayout2ui4=ka,g.StructArrayLayout3f12=Pr,g.StructArrayLayout3ui6=as,g.StructArrayLayout4i8=Qi,g.StructArrayLayout5f20=Ws,g.Texture=zh,g.Tile=sb,g.Transitionable=Vt,g.Uniform1f=ov,g.Uniform1i=class extends ud{constructor(c){super(c),this.current=0}set(c,a,u){this.fetchUniformLocation(c,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},g.Uniform2f=class extends ud{constructor(c){super(c),this.current=[0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}},g.Uniform3f=class extends ud{constructor(c){super(c),this.current=[0,0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}},g.Uniform4f=jp,g.UniformColor=NT,g.UniformMatrix2f=class extends ud{constructor(c){super(c),this.current=rv}set(c,a,u){if(this.fetchUniformLocation(c,a))for(let p=0;p<4;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}},g.UniformMatrix3f=class extends ud{constructor(c){super(c),this.current=Xr}set(c,a,u){if(this.fetchUniformLocation(c,a))for(let p=0;p<9;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}},g.UniformMatrix4f=class extends ud{constructor(c){super(c),this.current=vM}set(c,a,u){if(this.fetchUniformLocation(c,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let p=1;p<16;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}},g.UnwrappedTileID=Lv,g.ValidationError=on,g.VectorTileFeature=M_,g.VectorTileWorkerSource=class extends Ya{constructor(c,a,u,p,_){super(),this.actor=c,this.layerIndex=a,this.availableImages=u,this.loadVectorData=_||ji,this.loading={},this.loaded={},this.deduped=new pb(c.scheduler),this.isSpriteLoaded=p,this.scheduler=c.scheduler}loadTile(c,a){const u=c.uid,p=c&&c.request,_=p&&p.collectResourceTiming,b=this.loading[u]=new QS(c);b.abort=this.loadVectorData(c,(w,S)=>{const I=!this.loading[u];if(delete this.loading[u],I||w||!S)return b.status="done",I||(this.loaded[u]=b),a(w);const M=S.rawData,z={};S.expires&&(z.expires=S.expires),S.cacheControl&&(z.cacheControl=S.cacheControl),b.vectorTile=S.vectorTile||new Mv(new Km(M));const j=()=>{b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,(H,K)=>{if(H||!K)return a(H);const Y={};if(_){const te=Mn(p);te.length>0&&(Y.resourceTiming=JSON.parse(JSON.stringify(te)))}a(null,ri({rawTileData:M.slice(0)},K,z,Y))})};this.isSpriteLoaded?j():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(j,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom}):j()}),this.loaded=this.loaded||{},this.loaded[u]=b})}reloadTile(c,a){const u=this.loaded,p=c.uid,_=this;if(u&&u[p]){const b=u[p];b.showCollisionBoxes=c.showCollisionBoxes,b.enableTerrain=!!c.enableTerrain,b.projection=c.projection,b.tileTransform=uu(c.tileID.canonical,c.projection);const w=(S,I)=>{const M=b.reloadCallback;M&&(delete b.reloadCallback,b.parse(b.vectorTile,_.layerIndex,this.availableImages,_.actor,M)),a(S,I)};"parsing"===b.status?b.reloadCallback=w:"done"===b.status&&(b.vectorTile?b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(c,a){const u=c.uid,p=this.loading[u];p&&(p.abort&&p.abort(),delete this.loading[u]),a()}removeTile(c,a){const u=this.loaded,p=c.uid;u&&u[p]&&delete u[p],a()}},g.WritingMode=Na,g.ZoomDependentExpression=id,g.add=fd,g.addDynamicAttributes=sg,g.adjoint=function(c,a){var u=a[0],p=a[1],_=a[2],b=a[3],w=a[4],S=a[5],I=a[6],M=a[7],z=a[8];return c[0]=w*z-S*M,c[1]=_*M-p*z,c[2]=p*S-_*w,c[3]=S*I-b*z,c[4]=u*z-_*I,c[5]=_*b-u*S,c[6]=b*M-w*I,c[7]=p*I-u*M,c[8]=u*w-p*b,c},g.asyncAll=na,g.bezier=Co,g.bindAll=Ta,g.boundsAttributes=h1,g.bufferConvexPolygon=function(c,a){const u=[];for(let p=0;p<c.length;p++){const _=mr(p-1,-1,c.length-1),b=mr(p+1,-1,c.length-1),w=c[p],S=c[b],I=c[_].sub(w).unit(),M=S.sub(w).unit(),z=M.angleWithSep(I.x,I.y),j=I.add(M).unit().mult(-1*a/Math.sin(z/2));u.push(w.add(j))}return u},g.cacheEntryPossiblyAdded=function(c){Gd++,Gd>Pc&&(c.getActor().send("enforceCacheSizeLimit",$d),Gd=0)},g.calculateGlobeLabelMatrix=function(c,a){const{x:u,y:p}=c.point,_=fv(u,p,c.worldSize/c._pixelsPerMercatorPixel,0,0);return hd(_,_,pv(cc(a)))},g.calculateGlobeMatrix=function(c){const{x:a,y:u}=c.point,{lng:p,lat:_}=c._center;return fv(a,u,c.worldSize,p,_)},g.calculateGlobeMercatorMatrix=function(c){const a=c.pixelsPerMeter,u=a/Fa(1,c.center.lat),p=Pa(new Float64Array(16));return sc(p,p,[c.point.x,c.point.y,0]),wh(p,p,[u,u,a]),Float32Array.from(p)},g.circumferenceAtLatitude=Mm,g.clamp=Hn,g.clearTileCache=function(c){if(!dp())return;const a=se.caches.delete(Hd);c&&a.catch(c).then(()=>c())},g.clipLine=Wv,g.clone=function(c){var a=new ca(16);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},g.clone$1=Ko,g.collisionCircleLayout=bS,g.config=Ve,g.conjugate=function(c,a){return c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c[3]=a[3],c},g.create=function(){var c=new ca(16);return ca!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},g.create$1=l_,g.createExpression=nd,g.createLayout=Sn,g.createStyleLayer=function(c){return"custom"===c.type?new HS(c):new $S[c.type](c)},g.cross=lv,g.degToRad=wt,g.distance=function(c,a){return Math.hypot(a[0]-c[0],a[1]-c[1],a[2]-c[2])},g.div=function(c,a,u){return c[0]=a[0]/u[0],c[1]=a[1]/u[1],c[2]=a[2]/u[2],c},g.dot=La,g.earthRadius=Dm,g.ease=Ao,g.easeCubicInOut=Bn,g.ecefToLatLng=function([c,a,u]){const p=Math.hypot(c,a,u),_=Math.atan2(c,u),b=.5*Math.PI-Math.acos(-a/p);return new Oi(Lt(_),Lt(b))},g.emitValidationErrors=pm,g.endsWith=js,g.enforceCacheSizeLimit=function(c){xl(),Za&&Za.then(a=>{a.keys().then(u=>{for(let p=0;p<u.length-c;p++)a.delete(u[p])})})},g.evaluateSizeForFeature=gi,g.evaluateSizeForZoom=rf,g.evaluateVariableOffset=n1,g.evented=Ee,g.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]},g.exactEquals$1=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]},g.exported=Vi,g.exported$1=Xe,g.extend=ri,g.extend$1=Cl,g.fillExtrusionHeightLift=P_,g.filterObject=ii,g.fromMat4=function(c,a){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[4],c[4]=a[5],c[5]=a[6],c[6]=a[8],c[7]=a[9],c[8]=a[10],c},g.fromQuat=function(c,a){var u=a[0],p=a[1],_=a[2],b=a[3],w=u+u,S=p+p,I=_+_,M=u*w,z=p*w,j=p*S,H=_*w,K=_*S,Y=_*I,te=b*w,ae=b*S,we=b*I;return c[0]=1-j-Y,c[1]=z+we,c[2]=H-ae,c[3]=0,c[4]=z-we,c[5]=1-M-Y,c[6]=K+te,c[7]=0,c[8]=H+ae,c[9]=K-te,c[10]=1-M-j,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},g.fromRotation=function(c,a){var u=Math.sin(a),p=Math.cos(a);return c[0]=p,c[1]=u,c[2]=0,c[3]=-u,c[4]=p,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},g.fromScaling=bm,g.furthestTileCorner=function(c){const a=Math.round((c+45+360)%360/90)%4;return ln[a]},g.getAABBPointSquareDist=function(c,a,u){let p=0;for(let _=0;_<2;++_){const b=u?u[_]:0;c[_]>b&&(p+=(c[_]-b)*(c[_]-b)),a[_]<b&&(p+=(b-a[_])*(b-a[_]))}return p},g.getAnchorAlignment=F,g.getAnchorJustification=Kv,g.getBounds=function(c){let a=1/0,u=1/0,p=-1/0,_=-1/0;for(const b of c)a=Math.min(a,b.x),u=Math.min(u,b.y),p=Math.max(p,b.x),_=Math.max(_,b.y);return{min:new Ue(a,u),max:new Ue(p,_)}},g.getColumn=Ou,g.getGridMatrix=function(c,a,u,p){const _=a.getNorth(),b=a.getSouth(),w=a.getWest(),S=a.getEast(),I=1<<c.z,M=S-w,z=_-b,j=M/64,H=-z/Cm[u],K=[0,j,0,H,0,0,_,w,0];if(c.z>0){const Y=180/p;vm(K,K,[Y/M+1,0,0,0,Y/z+1,0,-.5*Y/j,.5*Y/H,1])}return K[2]=I,K[5]=c.x,K[8]=c.y,K},g.getImage=hp,g.getJSON=function(c,a){return ql(ri(c,{type:"json"}),a)},g.getLatitudinalLod=function(c){const a=cs-5;c=Hn(c,-a,a)/a*90;const u=Math.pow(Math.abs(Math.sin(wt(c))),3);return Math.round(u*(Cm.length-1))},g.getMapSessionAPI=We,g.getPerformanceMeasurement=Mn,g.getProjection=r1,g.getRTLTextPluginStatus=Le,g.getReferrer=Sa,g.getTilePoint=function(c,{x:a,y:u},p=0){return new Ue(((a-p)*c.scale-c.x)*Gn,(u*c.scale-c.y)*Gn)},g.getTileVec3=function(c,a,u=0){return Hp(((a.x-u)*c.scale-c.x)*Gn,(a.y*c.scale-c.y)*Gn,b_(a.z,a.y))},g.getVideo=function(c,a){const u=se.document.createElement("video");u.muted=!0,u.onloadstart=function(){a(null,u)};for(let p=0;p<c.length;p++){const _=se.document.createElement("source");qd(c[p])||(u.crossOrigin="Anonymous"),_.src=c[p],u.appendChild(_)}return{cancel:()=>{}}},g.globeCenterToScreenPoint=function(c){const a=[0,0,0],u=Pa(new Float64Array(16));return hd(u,c.pixelMatrix,c.globeMatrix),Wo(a,a,u),new Ue(a[0],a[1])},g.globeDenormalizeECEF=pv,g.globeECEFOrigin=function(c,a){const u=[0,0,0];return Wo(u,u,Wp(cc(a.canonical))),Wo(u,u,c),u},g.globeMetersToEcef=__,g.globeNormalizeECEF=Wp,g.globePixelsToTileUnits=function(c,a){return Gn/(512*Math.pow(2,c))*Sm(cc(a))},g.globePoleMatrixForTile=function(c,a,u){const p=Pa(new Float64Array(16)),_=(a/(1<<c)-.5)*Math.PI*2;return pd(p,u.globeMatrix,_),Float32Array.from(p)},g.globeTileBounds=cc,g.globeTiltAtLngLat=cx,g.globeToMercatorTransition=qp,g.globeUseCustomAntiAliasing=function(c,a,u){const p=qp(u.zoom),_=c.style.map._antialias,b=!!a.extStandardDerivatives,w=a.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return 0===p&&!_&&!w&&b},g.identity=Pa,g.identity$1=GT,g.invert=rc,g.isFullscreen=function(){return!!se.document.fullscreenElement||!!se.document.webkitFullscreenElement},g.isLngLatBehindGlobe=Em,g.isMapAuthenticated=function(c){return ze.has(c)},g.isMapboxURL=Xa,g.isSafariWithAntialiasingBug=function(c){const a=c.navigator?c.navigator.userAgent:null;return!!Wl(c)&&a&&(a.match("Version/15.4")||a.match("Version/15.5")||a.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},g.latFromMercatorY=ls,g.latLngToECEF=Dh,g.len=HT,g.length=eu,g.length$1=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},g.lngFromMercatorX=da,g.loadVectorTile=ji,g.makeRequest=ql,g.mapValue=function(c,a,u,p,_){return Hn((c-a)/(u-a)*(_-p)+p,p,_)},g.mercatorScale=dx,g.mercatorXfromLng=Fl,g.mercatorYfromLat=Zs,g.mercatorZfromAltitude=Fa,g.mul=VT,g.mul$1=jT,g.multiply=hd,g.multiply$1=vm,g.multiply$2=ox,g.nextPowerOfTwo=fs,g.normalize=Yr,g.normalize$1=wM,g.normalize$2=$T,g.number=ki,g.ortho=function(c,a,u,p,_,b,w){var S=1/(a-u),I=1/(p-_),M=1/(b-w);return c[0]=-2*S,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*I,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*M,c[11]=0,c[12]=(a+u)*S,c[13]=(_+p)*I,c[14]=(w+b)*M,c[15]=1,c},g.pbf=Km,g.perspective=function(c,a,u,p,_){var b,w=1/Math.tan(a/2);return c[0]=w/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=w,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,null!=_&&_!==1/0?(c[10]=(_+p)*(b=1/(p-_)),c[14]=2*_*p*b):(c[10]=-1,c[14]=-2*p),c},g.pick=function(c,a){const u={};for(let p=0;p<a.length;p++){const _=a[p];_ in c&&(u[_]=c[_])}return u},g.plugin=Fe,g.pointGeometry=Ue,g.polesInViewport=function(c){const a=Pa(new Float64Array(16));hd(a,c.pixelMatrix,c.globeMatrix);const u=[0,Ra,0],p=[0,ua,0];return Wo(u,u,a),Wo(p,p,a),[u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!Em(c,new Oi(c.center.lat,90)),p[0]>0&&p[0]<=c.width&&p[1]>0&&p[1]<=c.height&&!Em(c,new Oi(c.center.lat,-90))]},g.polygonContainsPoint=iu,g.polygonIntersectsBox=wv,g.polygonIntersectsPolygon=vv,g.polygonizeBounds=function(c,a,u=0,p=!0){const _=new Ue(u,u),b=c.sub(_),w=a.add(_),S=[b,new Ue(w.x,b.y),w,new Ue(b.x,w.y)];return p&&S.push(b.clone()),S},g.posAttributes=Th,g.postMapLoadEvent=ge,g.postPerformanceEvent=Re,g.postTurnstileEvent=Q,g.potpack=zv,g.prevPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},g.radToDeg=Lt,g.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],g.registerForPluginStateChange=function(c){return c({pluginStatus:pe,pluginURL:oe}),Ee.on("pluginStateChange",c),c},g.removeAuthState=function(c){ze.delete(c)},g.renderColorRamp=vx,g.resample=hx,g.rotateX=c_,g.rotateX$1=WT,g.rotateY=pd,g.rotateY$1=qT,g.rotateZ=function(c,a,u){var p=Math.sin(u),_=Math.cos(u),b=a[0],w=a[1],S=a[2],I=a[3],M=a[4],z=a[5],j=a[6],H=a[7];return a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=b*_+M*p,c[1]=w*_+z*p,c[2]=S*_+j*p,c[3]=I*_+H*p,c[4]=M*_-b*p,c[5]=z*_-w*p,c[6]=j*_-S*p,c[7]=H*_-I*p,c},g.rotateZ$1=function(c,a,u){u*=.5;var p=a[0],_=a[1],b=a[2],w=a[3],S=Math.sin(u),I=Math.cos(u);return c[0]=p*I+_*S,c[1]=_*I-p*S,c[2]=b*I+w*S,c[3]=w*I-b*S,c},g.scale=wh,g.scale$1=h_,g.scale$2=Oa,g.scaleAndAdd=wm,g.set=function(c,a,u,p){return c[0]=a,c[1]=u,c[2]=p,c},g.setCacheLimits=function(c,a){$d=c,Pc=a},g.setColumn=function(c,a,u){c[4*a+0]=u[0],c[4*a+1]=u[1],c[4*a+2]=u[2],c[4*a+3]=u[3]},g.setRTLTextPlugin=function(c,a,u=!1){if(pe===re||pe===de||pe===le)throw new Error("setRTLTextPlugin cannot be called multiple times.");oe=Vi.resolveURL(c),pe=re,he=a,xe(),u||Pe()},g.smoothstep=Mr,g.spec=yt,g.squaredLength=function(c){var a=c[0],u=c[1],p=c[2];return a*a+u*u+p*p},g.storeAuthState=function(c,a){a?ze.add(c):ze.delete(c)},g.sub=ac,g.subtract=u_,g.symbolSize=qm,g.tileAABB=function(c,a,u,p,_,b,w,S,I){if("globe"===I.name)return function hv(c,a,u){const p=a/c.worldSize,_=c.globeMatrix;if(u.z<=1){const Qe=cc(u).getCorners();return dv(Qe,_,p),Po.fromPoints(Qe)}const b=Qr(u),w=Eh(b);dv(w,_,p);const S=Number.MAX_VALUE,I=[-S,-S,-S],M=[S,S,S];if(b.contains(c.center)){for(const at of w)d_(M,M,at),xm(I,I,at);I[2]=0;const Qe=c.point,mt=[Qe.x*p,Qe.y*p,0];return d_(M,M,mt),xm(I,I,mt),new Po(M,I)}const z=[_[12]*p,_[13]*p,_[14]*p],j=b.getCenter(),H=Hn(c.center.lat,-cs,cs),K=Hn(j.lat,-cs,cs),Y=Fl(c.center.lng),te=Zs(H);let ae=Y-Fl(j.lng);const we=te-Zs(K);ae>.5?ae-=1:ae<-.5&&(ae+=1);let ke=0;Math.abs(ae)>Math.abs(we)?ke=ae>=0?1:3:(ke=we>=0?0:2,wm(z,z,[_[4]*p,_[5]*p,_[6]*p],-Math.sin(wt(we>=0?b.getSouth():b.getNorth()))*lc));const me=w[ke],Se=w[(ke+1)%4],Oe=new ax(me,Se,z),De=[uv(Oe,0)||me[0],uv(Oe,1)||me[1],uv(Oe,2)||me[2]],tt=qp(c.zoom);if(tt>0){const Qe=function({x:at,y:lt,z:bt},xt,Mt,Pt,ut){const Gt=1/(1<<bt);let kn=at*Gt,Yt=kn+Gt,fn=lt*Gt,Xt=fn+Gt,Fn=0;const Si=(kn+Yt)/2-Pt;return Si>.5?Fn=-1:Si<-.5&&(Fn=1),kn=((kn+Fn)*xt-(Pt*=xt))*Mt+Pt,Yt=((Yt+Fn)*xt-Pt)*Mt+Pt,fn=(fn*xt-(ut*=xt))*Mt+ut,Xt=(Xt*xt-ut)*Mt+ut,[[kn,Xt,0],[Yt,Xt,0],[Yt,fn,0],[kn,fn,0]]}(u,a,c._pixelsPerMercatorPixel,Y,te);for(let at=0;at<w.length;at++)Lr(w[at],Qe[at],tt);const mt=fd([],Qe[ke],Qe[(ke+1)%4]);Oa(mt,mt,.5),Lr(De,mt,tt)}for(const Qe of w)d_(M,M,Qe),xm(I,I,Qe);return M[2]=Math.min(me[2],Se[2]),d_(M,M,De),xm(I,I,De),new Po(M,I)}(c,a,new $m(u,p,_));const M=uu({z:u,x:p,y:_},I);return new Po([(b+M.x/M.scale)*a,a*(M.y/M.scale),w],[(b+M.x2/M.scale)*a,a*(M.y2/M.scale),S])},g.tileCornersToBounds=Qr,g.tileTransform=uu,g.transformMat3=function(c,a,u){var p=a[0],_=a[1],b=a[2];return c[0]=p*u[0]+_*u[3]+b*u[6],c[1]=p*u[1]+_*u[4]+b*u[7],c[2]=p*u[2]+_*u[5]+b*u[8],c},g.transformMat4=Wo,g.transformMat4$1=Gp,g.transformQuat=UT,g.transitionTileAABBinECEF=y_,g.translate=sc,g.transpose=function(c,a){if(c===a){var u=a[1],p=a[2],_=a[5];c[1]=a[3],c[2]=a[6],c[3]=u,c[5]=a[7],c[6]=p,c[7]=_}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c},g.triggerPluginCompletionEvent=Ce,g.uniqueId=Gl,g.updateGlobeVertexNormal=function(c,a,u,p,_){const b=5*a+2;c.float32[b+0]=u,c.float32[b+1]=p,c.float32[b+2]=_},g.validateCustomStyleLayer=function(c){const a=[],u=c.id;return void 0===u&&a.push({message:`layers.${u}: missing required property "id"`}),void 0===c.render&&a.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&"2d"!==c.renderingMode&&"3d"!==c.renderingMode&&a.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),a},g.validateFilter=c=>ni(ph(c)),g.validateFog=c=>ni(Ps(c)),g.validateLayer=c=>ni(yr(c)),g.validateLight=c=>ni(hm(c)),g.validateSource=c=>ni(qr(c)),g.validateStyle=Al,g.validateTerrain=c=>ni(nc(c)),g.values=Vs,g.vectorTile=D_,g.version=Je,g.warnOnce=Mo,g.window=se,g.wrap=mr}),_t(0,function(g){function se(ye){if("number"==typeof ye||"boolean"==typeof ye||"string"==typeof ye||null==ye)return JSON.stringify(ye);if(Array.isArray(ye)){let ne="[";for(const ge of ye)ne+=`${se(ge)},`;return`${ne}]`}let Q="{";for(const ne of Object.keys(ye).sort())Q+=`${ne}:${se(ye[ne])},`;return`${Q}}`}function Je(ye){let Q="";for(const ne of g.refProperties)Q+=`/${se(ye[ne])}`;return Q}class Ke{constructor(Q){this.keyCache={},Q&&this.replace(Q)}replace(Q){this._layerConfigs={},this._layers={},this.update(Q,[])}update(Q,ne){for(const Ie of Q)this._layerConfigs[Ie.id]=Ie,(this._layers[Ie.id]=g.createStyleLayer(Ie)).compileFilter(),this.keyCache[Ie.id]&&delete this.keyCache[Ie.id];for(const Ie of ne)delete this.keyCache[Ie],delete this._layerConfigs[Ie],delete this._layers[Ie];this.familiesBySource={};const ge=function(Ie,Re){const qe={};for(let ze=0;ze<Ie.length;ze++){const nt=Re&&Re[Ie[ze].id]||Je(Ie[ze]);Re&&(Re[Ie[ze].id]=nt);let Ct=qe[nt];Ct||(Ct=qe[nt]=[]),Ct.push(Ie[ze])}const We=[];for(const ze in qe)We.push(qe[ze]);return We}(g.values(this._layerConfigs),this.keyCache);for(const Ie of ge){const Re=Ie.map(nn=>this._layers[nn.id]),qe=Re[0];if("none"===qe.visibility)continue;const We=qe.source||"";let ze=this.familiesBySource[We];ze||(ze=this.familiesBySource[We]={});const nt=qe.sourceLayer||"_geojsonTileLayer";let Ct=ze[nt];Ct||(Ct=ze[nt]=[]),Ct.push(Re)}}}class Ve{loadTile(Q,ne){const{uid:ge,encoding:Ie,rawImageData:Re,padding:qe,buildQuadTree:We}=Q,ze=g.window.ImageBitmap&&Re instanceof g.window.ImageBitmap?this.getImageData(Re,qe):Re;ne(null,new g.DEMData(ge,ze,Ie,qe<1,We))}getImageData(Q,ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);const ge=this.offscreenCanvasContext.getImageData(-ne,-ne,Q.width+2*ne,Q.height+2*ne);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ge}}var Xe=function ye(Q,ne){var ge,Ie=Q&&Q.type;if("FeatureCollection"===Ie)for(ge=0;ge<Q.features.length;ge++)ye(Q.features[ge],ne);else if("GeometryCollection"===Ie)for(ge=0;ge<Q.geometries.length;ge++)ye(Q.geometries[ge],ne);else if("Feature"===Ie)ye(Q.geometry,ne);else if("Polygon"===Ie)Bt(Q.coordinates,ne);else if("MultiPolygon"===Ie)for(ge=0;ge<Q.coordinates.length;ge++)Bt(Q.coordinates[ge],ne);return Q};function Bt(ye,Q){if(0!==ye.length){bn(ye[0],Q);for(var ne=1;ne<ye.length;ne++)bn(ye[ne],!Q)}}function bn(ye,Q){for(var ne=0,ge=0,Ie=0,Re=ye.length,qe=Re-1;Ie<Re;qe=Ie++){var We=(ye[Ie][0]-ye[qe][0])*(ye[qe][1]+ye[Ie][1]),ze=ne+We;ge+=Math.abs(ne)>=Math.abs(We)?ne-ze+We:We-ze+ne,ne=ze}ne+ge>=0!=!!Q&&ye.reverse()}const en=g.VectorTileFeature.prototype.toGeoJSON;class un{constructor(Q){this._feature=Q,this.extent=g.EXTENT,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(1===this._feature.type){const Q=[];for(const ne of this._feature.geometry)Q.push([new g.pointGeometry(ne[0],ne[1])]);return Q}{const Q=[];for(const ne of this._feature.geometry){const ge=[];for(const Ie of ne)ge.push(new g.pointGeometry(Ie[0],Ie[1]));Q.push(ge)}return Q}}toGeoJSON(Q,ne,ge){return en.call(this,Q,ne,ge)}}class qt{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=g.EXTENT,this.length=Q.length,this._features=Q}feature(Q){return new un(this._features[Q])}}var jt={},Me={get exports(){return jt},set exports(ye){jt=ye}},ft=g.pointGeometry,Ue=g.vectorTile.VectorTileFeature,st=He;function He(ye,Q){this.options=Q||{},this.features=ye,this.length=ye.length}function St(ye,Q){this.id="number"==typeof ye.id?ye.id:void 0,this.type=ye.type,this.rawGeometry=1===ye.type?[ye.geometry]:ye.geometry,this.properties=ye.tags,this.extent=Q||4096}He.prototype.feature=function(ye){return new St(this.features[ye],this.options.extent)},St.prototype.loadGeometry=function(){var ye=this.rawGeometry;this.geometry=[];for(var Q=0;Q<ye.length;Q++){for(var ne=ye[Q],ge=[],Ie=0;Ie<ne.length;Ie++)ge.push(new ft(ne[Ie][0],ne[Ie][1]));this.geometry.push(ge)}return this.geometry},St.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ye=this.geometry,Q=1/0,ne=-1/0,ge=1/0,Ie=-1/0,Re=0;Re<ye.length;Re++)for(var qe=ye[Re],We=0;We<qe.length;We++){var ze=qe[We];Q=Math.min(Q,ze.x),ne=Math.max(ne,ze.x),ge=Math.min(ge,ze.y),Ie=Math.max(Ie,ze.y)}return[Q,ge,ne,Ie]},St.prototype.toGeoJSON=Ue.prototype.toGeoJSON;var wt=g.pbf,Lt=st;function ln(ye){var Q=new wt;return function(ne,ge){for(var Ie in ne.layers)ge.writeMessage(3,Bn,ne.layers[Ie])}(ye,Q),Q.finish()}function Bn(ye,Q){var ne;Q.writeVarintField(15,ye.version||1),Q.writeStringField(1,ye.name||""),Q.writeVarintField(5,ye.extent||4096);var ge={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<ye.length;ne++)ge.feature=ye.feature(ne),Q.writeMessage(2,Co,ge);var Ie=ge.keys;for(ne=0;ne<Ie.length;ne++)Q.writeStringField(3,Ie[ne]);var Re=ge.values;for(ne=0;ne<Re.length;ne++)Q.writeMessage(4,na,Re[ne])}function Co(ye,Q){var ne=ye.feature;void 0!==ne.id&&Q.writeVarintField(1,ne.id),Q.writeMessage(2,Ao,ye),Q.writeVarintField(3,ne.type),Q.writeMessage(4,mr,ne)}function Ao(ye,Q){var ne=ye.feature,ge=ye.keys,Ie=ye.values,Re=ye.keycache,qe=ye.valuecache;for(var We in ne.properties){var ze=ne.properties[We],nt=Re[We];if(null!==ze){void 0===nt&&(ge.push(We),Re[We]=nt=ge.length-1),Q.writeVarint(nt);var Ct=typeof ze;"string"!==Ct&&"boolean"!==Ct&&"number"!==Ct&&(ze=JSON.stringify(ze));var nn=Ct+":"+ze,Et=qe[nn];void 0===Et&&(Ie.push(ze),qe[nn]=Et=Ie.length-1),Q.writeVarint(Et)}}}function Hn(ye,Q){return(Q<<3)+(7&ye)}function Mr(ye){return ye<<1^ye>>31}function mr(ye,Q){for(var ne=ye.loadGeometry(),ge=ye.type,Ie=0,Re=0,qe=ne.length,We=0;We<qe;We++){var ze=ne[We],nt=1;1===ge&&(nt=ze.length),Q.writeVarint(Hn(1,nt));for(var Ct=3===ge?ze.length-1:ze.length,nn=0;nn<Ct;nn++){1===nn&&1!==ge&&Q.writeVarint(Hn(2,Ct-1));var Et=ze[nn].x-Ie,Mn=ze[nn].y-Re;Q.writeVarint(Mr(Et)),Q.writeVarint(Mr(Mn)),Ie+=Et,Re+=Mn}3===ge&&Q.writeVarint(Hn(7,1))}}function na(ye,Q){var ne=typeof ye;"string"===ne?Q.writeStringField(1,ye):"boolean"===ne?Q.writeBooleanField(7,ye):"number"===ne&&(ye%1!=0?Q.writeDoubleField(3,ye):ye<0?Q.writeSVarintField(6,ye):Q.writeVarintField(5,ye))}function Vs(ye,Q,ne,ge,Ie,Re){if(Ie-ge<=ne)return;const qe=ge+Ie>>1;ri(ye,Q,qe,ge,Ie,Re%2),Vs(ye,Q,ne,ge,qe-1,Re+1),Vs(ye,Q,ne,qe+1,Ie,Re+1)}function ri(ye,Q,ne,ge,Ie,Re){for(;Ie>ge;){if(Ie-ge>600){const nt=Ie-ge+1,Ct=ne-ge+1,nn=Math.log(nt),Et=.5*Math.exp(2*nn/3),Mn=.5*Math.sqrt(nn*Et*(nt-Et)/nt)*(Ct-nt/2<0?-1:1);ri(ye,Q,ne,Math.max(ge,Math.floor(ne-Ct*Et/nt+Mn)),Math.min(Ie,Math.floor(ne+(nt-Ct)*Et/nt+Mn)),Re)}const qe=Q[2*ne+Re];let We=ge,ze=Ie;for(Ca(ye,Q,ge,ne),Q[2*Ie+Re]>qe&&Ca(ye,Q,ge,Ie);We<ze;){for(Ca(ye,Q,We,ze),We++,ze--;Q[2*We+Re]<qe;)We++;for(;Q[2*ze+Re]>qe;)ze--}Q[2*ge+Re]===qe?Ca(ye,Q,ge,ze):(ze++,Ca(ye,Q,ze,Ie)),ze<=ne&&(ge=ze+1),ne<=ze&&(Ie=ze-1)}}function Ca(ye,Q,ne,ge){Gl(ye,ne,ge),Gl(Q,2*ne,2*ge),Gl(Q,2*ne+1,2*ge+1)}function Gl(ye,Q,ne){const ge=ye[Q];ye[Q]=ye[ne],ye[ne]=ge}function Us(ye,Q,ne,ge){const Ie=ye-ne,Re=Q-ge;return Ie*Ie+Re*Re}Me.exports=ln,jt.fromVectorTileJs=ln,jt.fromGeojsonVt=function(ye,Q){Q=Q||{};var ne={};for(var ge in ye)ne[ge]=new Lt(ye[ge].features,Q),ne[ge].name=ge,ne[ge].version=Q.version,ne[ge].extent=Q.extent;return ln({layers:ne})},jt.GeoJSONWrapper=Lt;const fs=ye=>ye[0],si=ye=>ye[1];class Ta{constructor(Q,ne=fs,ge=si,Ie=64,Re=Float64Array){this.nodeSize=Ie,this.points=Q;const qe=Q.length<65536?Uint16Array:Uint32Array,We=this.ids=new qe(Q.length),ze=this.coords=new Re(2*Q.length);for(let nt=0;nt<Q.length;nt++)We[nt]=nt,ze[2*nt]=ne(Q[nt]),ze[2*nt+1]=ge(Q[nt]);Vs(We,ze,Ie,0,We.length-1,0)}range(Q,ne,ge,Ie){return function(Re,qe,We,ze,nt,Ct,nn){const Et=[0,Re.length-1,0],Mn=[];let mn,An;for(;Et.length;){const $n=Et.pop(),di=Et.pop(),Vi=Et.pop();if(di-Vi<=nn){for(let go=Vi;go<=di;go++)mn=qe[2*go],An=qe[2*go+1],mn>=We&&mn<=nt&&An>=ze&&An<=Ct&&Mn.push(Re[go]);continue}const Rn=Math.floor((Vi+di)/2);mn=qe[2*Rn],An=qe[2*Rn+1],mn>=We&&mn<=nt&&An>=ze&&An<=Ct&&Mn.push(Re[Rn]);const qi=($n+1)%2;(0===$n?We<=mn:ze<=An)&&(Et.push(Vi),Et.push(Rn-1),Et.push(qi)),(0===$n?nt>=mn:Ct>=An)&&(Et.push(Rn+1),Et.push(di),Et.push(qi))}return Mn}(this.ids,this.coords,Q,ne,ge,Ie,this.nodeSize)}within(Q,ne,ge){return function(Ie,Re,qe,We,ze,nt){const Ct=[0,Ie.length-1,0],nn=[],Et=ze*ze;for(;Ct.length;){const Mn=Ct.pop(),mn=Ct.pop(),An=Ct.pop();if(mn-An<=nt){for(let qi=An;qi<=mn;qi++)Us(Re[2*qi],Re[2*qi+1],qe,We)<=Et&&nn.push(Ie[qi]);continue}const $n=Math.floor((An+mn)/2),di=Re[2*$n],Vi=Re[2*$n+1];Us(di,Vi,qe,We)<=Et&&nn.push(Ie[$n]);const Rn=(Mn+1)%2;(0===Mn?qe-ze<=di:We-ze<=Vi)&&(Ct.push(An),Ct.push($n-1),Ct.push(Rn)),(0===Mn?qe+ze>=di:We+ze>=Vi)&&(Ct.push($n+1),Ct.push(mn),Ct.push(Rn))}return nn}(this.ids,this.coords,Q,ne,ge,this.nodeSize)}}const js={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ye=>ye},Ki=Math.fround||(ii=new Float32Array(1),ye=>(ii[0]=+ye,ii[0]));var ii;class Ko{constructor(Q){this.options=Wl(Object.create(js),Q),this.trees=new Array(this.options.maxZoom+1)}load(Q){const{log:ne,minZoom:ge,maxZoom:Ie,nodeSize:Re}=this.options;ne&&console.time("total time");const qe=`prepare ${Q.length} points`;ne&&console.time(qe),this.points=Q;let We=[];for(let ze=0;ze<Q.length;ze++)Q[ze].geometry&&We.push(Mo(Q[ze],ze));this.trees[Ie+1]=new Ta(We,up,Ou,Re,Float32Array),ne&&console.timeEnd(qe);for(let ze=Ie;ze>=ge;ze--){const nt=+Date.now();We=this._cluster(We,ze),this.trees[ze]=new Ta(We,up,Ou,Re,Float32Array),ne&&console.log("z%d: %d clusters in %dms",ze,We.length,+Date.now()-nt)}return ne&&console.timeEnd("total time"),this}getClusters(Q,ne){let ge=((Q[0]+180)%360+360)%360-180;const Ie=Math.max(-90,Math.min(90,Q[1]));let Re=180===Q[2]?180:((Q[2]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)ge=-180,Re=180;else if(ge>Re){const Ct=this.getClusters([ge,Ie,180,qe],ne),nn=this.getClusters([-180,Ie,Re,qe],ne);return Ct.concat(nn)}const We=this.trees[this._limitZoom(ne)],ze=We.range(qa(ge),Ac(qe),qa(Re),Ac(Ie)),nt=[];for(const Ct of ze){const nn=We.points[Ct];nt.push(nn.numPoints?Wa(nn):this.points[nn.index])}return nt}getChildren(Q){const ne=this._getOriginId(Q),ge=this._getOriginZoom(Q),Ie="No cluster with the specified id.",Re=this.trees[ge];if(!Re)throw new Error(Ie);const qe=Re.points[ne];if(!qe)throw new Error(Ie);const We=this.options.radius/(this.options.extent*Math.pow(2,ge-1)),ze=Re.within(qe.x,qe.y,We),nt=[];for(const Ct of ze){const nn=Re.points[Ct];nn.parentId===Q&&nt.push(nn.numPoints?Wa(nn):this.points[nn.index])}if(0===nt.length)throw new Error(Ie);return nt}getLeaves(Q,ne,ge){const Ie=[];return this._appendLeaves(Ie,Q,ne=ne||10,ge=ge||0,0),Ie}getTile(Q,ne,ge){const Ie=this.trees[this._limitZoom(Q)],Re=Math.pow(2,Q),{extent:qe,radius:We}=this.options,ze=We/qe,nt=(ge-ze)/Re,Ct=(ge+1+ze)/Re,nn={features:[]};return this._addTileFeatures(Ie.range((ne-ze)/Re,nt,(ne+1+ze)/Re,Ct),Ie.points,ne,ge,Re,nn),0===ne&&this._addTileFeatures(Ie.range(1-ze/Re,nt,1,Ct),Ie.points,Re,ge,Re,nn),ne===Re-1&&this._addTileFeatures(Ie.range(0,nt,ze/Re,Ct),Ie.points,-1,ge,Re,nn),nn.features.length?nn:null}getClusterExpansionZoom(Q){let ne=this._getOriginZoom(Q)-1;for(;ne<=this.options.maxZoom;){const ge=this.getChildren(Q);if(ne++,1!==ge.length)break;Q=ge[0].properties.cluster_id}return ne}_appendLeaves(Q,ne,ge,Ie,Re){const qe=this.getChildren(ne);for(const We of qe){const ze=We.properties;if(ze&&ze.cluster?Re+ze.point_count<=Ie?Re+=ze.point_count:Re=this._appendLeaves(Q,ze.cluster_id,ge,Ie,Re):Re<Ie?Re++:Q.push(We),Q.length===ge)break}return Re}_addTileFeatures(Q,ne,ge,Ie,Re,qe){for(const We of Q){const ze=ne[We],nt=ze.numPoints;let Ct,nn,Et;if(nt)Ct=$i(ze),nn=ze.x,Et=ze.y;else{const An=this.points[ze.index];Ct=An.properties,nn=qa(An.geometry.coordinates[0]),Et=Ac(An.geometry.coordinates[1])}const Mn={type:1,geometry:[[Math.round(this.options.extent*(nn*Re-ge)),Math.round(this.options.extent*(Et*Re-Ie))]],tags:Ct};let mn;nt?mn=ze.id:this.options.generateId?mn=ze.index:this.points[ze.index].id&&(mn=this.points[ze.index].id),void 0!==mn&&(Mn.id=mn),qe.features.push(Mn)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,ne){const ge=[],{radius:Ie,extent:Re,reduce:qe,minPoints:We}=this.options,ze=Ie/(Re*Math.pow(2,ne));for(let nt=0;nt<Q.length;nt++){const Ct=Q[nt];if(Ct.zoom<=ne)continue;Ct.zoom=ne;const nn=this.trees[ne+1],Et=nn.within(Ct.x,Ct.y,ze),Mn=Ct.numPoints||1;let mn=Mn;for(const An of Et){const $n=nn.points[An];$n.zoom>ne&&(mn+=$n.numPoints||1)}if(mn>Mn&&mn>=We){let An=Ct.x*Mn,$n=Ct.y*Mn,di=qe&&Mn>1?this._map(Ct,!0):null;const Vi=(nt<<5)+(ne+1)+this.points.length;for(const Rn of Et){const qi=nn.points[Rn];if(qi.zoom<=ne)continue;qi.zoom=ne;const go=qi.numPoints||1;An+=qi.x*go,$n+=qi.y*go,qi.parentId=Vi,qe&&(di||(di=this._map(Ct,!0)),qe(di,this._map(qi)))}Ct.parentId=Vi,ge.push(Vn(An/mn,$n/mn,Vi,mn,di))}else if(ge.push(Ct),mn>1)for(const An of Et){const $n=nn.points[An];$n.zoom<=ne||($n.zoom=ne,ge.push($n))}}return ge}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,ne){if(Q.numPoints)return ne?Wl({},Q.properties):Q.properties;const ge=this.points[Q.index].properties,Ie=this.options.map(ge);return ne&&Ie===ge?Wl({},Ie):Ie}}function Vn(ye,Q,ne,ge,Ie){return{x:Ki(ye),y:Ki(Q),zoom:1/0,id:ne,parentId:-1,numPoints:ge,properties:Ie}}function Mo(ye,Q){const[ne,ge]=ye.geometry.coordinates;return{x:Ki(qa(ne)),y:Ki(Ac(ge)),zoom:1/0,index:Q,parentId:-1}}function Wa(ye){return{type:"Feature",id:ye.id,properties:$i(ye),geometry:{type:"Point",coordinates:[(Q=ye.x,360*(Q-.5)),cp(ye.y)]}};var Q}function $i(ye){const Q=ye.numPoints,ne=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q;return Wl(Wl({},ye.properties),{cluster:!0,cluster_id:ye.id,point_count:Q,point_count_abbreviated:ne})}function qa(ye){return ye/360+.5}function Ac(ye){const Q=Math.sin(ye*Math.PI/180),ne=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return ne<0?0:ne>1?1:ne}function cp(ye){const Q=(180-360*ye)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function Wl(ye,Q){for(const ne in Q)ye[ne]=Q[ne];return ye}function up(ye){return ye.x}function Ou(ye){return ye.y}function Hd(ye,Q,ne,ge){for(var Ie,Re=ge,qe=ne-Q>>1,We=ne-Q,ze=ye[Q],nt=ye[Q+1],Ct=ye[ne],nn=ye[ne+1],Et=Q+3;Et<ne;Et+=3){var Mn=Za(ye[Et],ye[Et+1],ze,nt,Ct,nn);if(Mn>Re)Ie=Et,Re=Mn;else if(Mn===Re){var mn=Math.abs(Et-qe);mn<We&&(Ie=Et,We=mn)}}Re>ge&&(Ie-Q>3&&Hd(ye,Q,Ie,ge),ye[Ie+2]=Re,ne-Ie>3&&Hd(ye,Ie,ne,ge))}function Za(ye,Q,ne,ge,Ie,Re){var qe=Ie-ne,We=Re-ge;if(0!==qe||0!==We){var ze=((ye-ne)*qe+(Q-ge)*We)/(qe*qe+We*We);ze>1?(ne=Ie,ge=Re):ze>0&&(ne+=qe*ze,ge+=We*ze)}return(qe=ye-ne)*qe+(We=Q-ge)*We}function Ka(ye,Q,ne,ge){var Ie={id:void 0===ye?null:ye,type:Q,geometry:ne,tags:ge,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Re){var qe=Re.geometry,We=Re.type;if("Point"===We||"MultiPoint"===We||"LineString"===We)$d(Re,qe);else if("Polygon"===We||"MultiLineString"===We)for(var ze=0;ze<qe.length;ze++)$d(Re,qe[ze]);else if("MultiPolygon"===We)for(ze=0;ze<qe.length;ze++)for(var nt=0;nt<qe[ze].length;nt++)$d(Re,qe[ze][nt])}(Ie),Ie}function $d(ye,Q){for(var ne=0;ne<Q.length;ne+=3)ye.minX=Math.min(ye.minX,Q[ne]),ye.minY=Math.min(ye.minY,Q[ne+1]),ye.maxX=Math.max(ye.maxX,Q[ne]),ye.maxY=Math.max(ye.maxY,Q[ne+1])}function Pc(ye,Q,ne,ge){if(Q.geometry){var Ie=Q.geometry.coordinates,Re=Q.geometry.type,qe=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2),We=[],ze=Q.id;if(ne.promoteId?ze=Q.properties[ne.promoteId]:ne.generateId&&(ze=ge||0),"Point"===Re)dp(Ie,We);else if("MultiPoint"===Re)for(var nt=0;nt<Ie.length;nt++)dp(Ie[nt],We);else if("LineString"===Re)xl(Ie,We,qe,!1);else if("MultiLineString"===Re){if(ne.lineMetrics){for(nt=0;nt<Ie.length;nt++)xl(Ie[nt],We=[],qe,!1),ye.push(Ka(ze,"LineString",We,Q.properties));return}Lu(Ie,We,qe,!1)}else if("Polygon"===Re)Lu(Ie,We,qe,!0);else{if("MultiPolygon"!==Re){if("GeometryCollection"===Re){for(nt=0;nt<Q.geometry.geometries.length;nt++)Pc(ye,{id:ze,geometry:Q.geometry.geometries[nt],properties:Q.properties},ne,ge);return}throw new Error("Input data is not a valid GeoJSON object.")}for(nt=0;nt<Ie.length;nt++){var Ct=[];Lu(Ie[nt],Ct,qe,!0),We.push(Ct)}}ye.push(Ka(ze,Re,We,Q.properties))}}function dp(ye,Q){Q.push(Gd(ye[0])),Q.push(Wd(ye[1])),Q.push(0)}function xl(ye,Q,ne,ge){for(var Ie,Re,qe=0,We=0;We<ye.length;We++){var ze=Gd(ye[We][0]),nt=Wd(ye[We][1]);Q.push(ze),Q.push(nt),Q.push(0),We>0&&(qe+=ge?(Ie*nt-ze*Re)/2:Math.sqrt(Math.pow(ze-Ie,2)+Math.pow(nt-Re,2))),Ie=ze,Re=nt}var Ct=Q.length-3;Q[2]=1,Hd(Q,0,Ct,ne),Q[Ct+2]=1,Q.size=Math.abs(qe),Q.start=0,Q.end=Q.size}function Lu(ye,Q,ne,ge){for(var Ie=0;Ie<ye.length;Ie++){var Re=[];xl(ye[Ie],Re,ne,ge),Q.push(Re)}}function Gd(ye){return ye/360+.5}function Wd(ye){var Q=Math.sin(ye*Math.PI/180),ne=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return ne<0?0:ne>1?1:ne}function ia(ye,Q,ne,ge,Ie,Re,qe,We){if(ge/=Q,Re>=(ne/=Q)&&qe<ge)return ye;if(qe<ne||Re>=ge)return null;for(var ze=[],nt=0;nt<ye.length;nt++){var Ct=ye[nt],nn=Ct.geometry,Et=Ct.type,Mn=0===Ie?Ct.minX:Ct.minY,mn=0===Ie?Ct.maxX:Ct.maxY;if(Mn>=ne&&mn<ge)ze.push(Ct);else if(!(mn<ne||Mn>=ge)){var An=[];if("Point"===Et||"MultiPoint"===Et)Sa(nn,An,ne,ge,Ie);else if("LineString"===Et)ql(nn,An,ne,ge,Ie,!1,We.lineMetrics);else if("MultiLineString"===Et)qd(nn,An,ne,ge,Ie,!1);else if("Polygon"===Et)qd(nn,An,ne,ge,Ie,!0);else if("MultiPolygon"===Et)for(var $n=0;$n<nn.length;$n++){var di=[];qd(nn[$n],di,ne,ge,Ie,!0),di.length&&An.push(di)}if(An.length){if(We.lineMetrics&&"LineString"===Et){for($n=0;$n<An.length;$n++)ze.push(Ka(Ct.id,Et,An[$n],Ct.tags));continue}"LineString"!==Et&&"MultiLineString"!==Et||(1===An.length?(Et="LineString",An=An[0]):Et="MultiLineString"),"Point"!==Et&&"MultiPoint"!==Et||(Et=3===An.length?"Point":"MultiPoint"),ze.push(Ka(Ct.id,Et,An,Ct.tags))}}}return ze.length?ze:null}function Sa(ye,Q,ne,ge,Ie){for(var Re=0;Re<ye.length;Re+=3){var qe=ye[Re+Ie];qe>=ne&&qe<=ge&&(Q.push(ye[Re]),Q.push(ye[Re+1]),Q.push(ye[Re+2]))}}function ql(ye,Q,ne,ge,Ie,Re,qe){for(var We,ze,nt=Ru(ye),Ct=0===Ie?Fu:Nu,nn=ye.start,Et=0;Et<ye.length-3;Et+=3){var Mn=ye[Et],mn=ye[Et+1],An=ye[Et+2],$n=ye[Et+3],di=ye[Et+4],Vi=0===Ie?Mn:mn,Rn=0===Ie?$n:di,qi=!1;qe&&(We=Math.sqrt(Math.pow(Mn-$n,2)+Math.pow(mn-di,2))),Vi<ne?Rn>ne&&(ze=Ct(nt,Mn,mn,$n,di,ne),qe&&(nt.start=nn+We*ze)):Vi>ge?Rn<ge&&(ze=Ct(nt,Mn,mn,$n,di,ge),qe&&(nt.start=nn+We*ze)):Zd(nt,Mn,mn,An),Rn<ne&&Vi>=ne&&(ze=Ct(nt,Mn,mn,$n,di,ne),qi=!0),Rn>ge&&Vi<=ge&&(ze=Ct(nt,Mn,mn,$n,di,ge),qi=!0),!Re&&qi&&(qe&&(nt.end=nn+We*ze),Q.push(nt),nt=Ru(ye)),qe&&(nn+=We)}var go=ye.length-3;Mn=ye[go],mn=ye[go+1],An=ye[go+2],(Vi=0===Ie?Mn:mn)>=ne&&Vi<=ge&&Zd(nt,Mn,mn,An),go=nt.length-3,Re&&go>=3&&(nt[go]!==nt[0]||nt[go+1]!==nt[1])&&Zd(nt,nt[0],nt[1],nt[2]),nt.length&&Q.push(nt)}function Ru(ye){var Q=[];return Q.size=ye.size,Q.start=ye.start,Q.end=ye.end,Q}function qd(ye,Q,ne,ge,Ie,Re){for(var qe=0;qe<ye.length;qe++)ql(ye[qe],Q,ne,ge,Ie,Re,!1)}function Zd(ye,Q,ne,ge){ye.push(Q),ye.push(ne),ye.push(ge)}function Fu(ye,Q,ne,ge,Ie,Re){var qe=(Re-Q)/(ge-Q);return ye.push(Re),ye.push(ne+(Ie-ne)*qe),ye.push(1),qe}function Nu(ye,Q,ne,ge,Ie,Re){var qe=(Re-ne)/(Ie-ne);return ye.push(Q+(ge-Q)*qe),ye.push(Re),ye.push(1),qe}function hp(ye,Q){for(var ne=[],ge=0;ge<ye.length;ge++){var Ie,Re=ye[ge],qe=Re.type;if("Point"===qe||"MultiPoint"===qe||"LineString"===qe)Ie=zu(Re.geometry,Q);else if("MultiLineString"===qe||"Polygon"===qe){Ie=[];for(var We=0;We<Re.geometry.length;We++)Ie.push(zu(Re.geometry[We],Q))}else if("MultiPolygon"===qe)for(Ie=[],We=0;We<Re.geometry.length;We++){for(var ze=[],nt=0;nt<Re.geometry[We].length;nt++)ze.push(zu(Re.geometry[We][nt],Q));Ie.push(ze)}ne.push(Ka(Re.id,qe,Ie,Re.tags))}return ne}function zu(ye,Q){var ne=[];ne.size=ye.size,void 0!==ye.start&&(ne.start=ye.start,ne.end=ye.end);for(var ge=0;ge<ye.length;ge+=3)ne.push(ye[ge]+Q,ye[ge+1],ye[ge+2]);return ne}function Xa(ye,Q){if(ye.transformed)return ye;var ne,ge,Ie,Re=1<<ye.z,qe=ye.x,We=ye.y;for(ne=0;ne<ye.features.length;ne++){var ze=ye.features[ne],nt=ze.geometry,Ct=ze.type;if(ze.geometry=[],1===Ct)for(ge=0;ge<nt.length;ge+=2)ze.geometry.push(Bu(nt[ge],nt[ge+1],Q,Re,qe,We));else for(ge=0;ge<nt.length;ge++){var nn=[];for(Ie=0;Ie<nt[ge].length;Ie+=2)nn.push(Bu(nt[ge][Ie],nt[ge][Ie+1],Q,Re,qe,We));ze.geometry.push(nn)}}return ye.transformed=!0,ye}function Bu(ye,Q,ne,ge,Ie,Re){return[Math.round(ne*(ye*ge-Ie)),Math.round(ne*(Q*ge-Re))]}function Vu(ye,Q,ne,ge,Ie){for(var Re=Q===Ie.maxZoom?0:Ie.tolerance/((1<<Q)*Ie.extent),qe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ne,y:ge,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},We=0;We<ye.length;We++){qe.numFeatures++,Kd(qe,ye[We],Re,Ie);var ze=ye[We].minX,nt=ye[We].minY,Ct=ye[We].maxX,nn=ye[We].maxY;ze<qe.minX&&(qe.minX=ze),nt<qe.minY&&(qe.minY=nt),Ct>qe.maxX&&(qe.maxX=Ct),nn>qe.maxY&&(qe.maxY=nn)}return qe}function Kd(ye,Q,ne,ge){var Ie=Q.geometry,Re=Q.type,qe=[];if("Point"===Re||"MultiPoint"===Re)for(var We=0;We<Ie.length;We+=3)qe.push(Ie[We]),qe.push(Ie[We+1]),ye.numPoints++,ye.numSimplified++;else if("LineString"===Re)Oc(qe,Ie,ye,ne,!1,!1);else if("MultiLineString"===Re||"Polygon"===Re)for(We=0;We<Ie.length;We++)Oc(qe,Ie[We],ye,ne,"Polygon"===Re,0===We);else if("MultiPolygon"===Re)for(var ze=0;ze<Ie.length;ze++){var nt=Ie[ze];for(We=0;We<nt.length;We++)Oc(qe,nt[We],ye,ne,!0,0===We)}if(qe.length){var Ct=Q.tags||null;if("LineString"===Re&&ge.lineMetrics){for(var nn in Ct={},Q.tags)Ct[nn]=Q.tags[nn];Ct.mapbox_clip_start=Ie.start/Ie.size,Ct.mapbox_clip_end=Ie.end/Ie.size}var Et={geometry:qe,type:"Polygon"===Re||"MultiPolygon"===Re?3:"LineString"===Re||"MultiLineString"===Re?2:1,tags:Ct};null!==Q.id&&(Et.id=Q.id),ye.features.push(Et)}}function Oc(ye,Q,ne,ge,Ie,Re){var qe=ge*ge;if(ge>0&&Q.size<(Ie?qe:ge))ne.numPoints+=Q.length/3;else{for(var We=[],ze=0;ze<Q.length;ze+=3)(0===ge||Q[ze+2]>qe)&&(ne.numSimplified++,We.push(Q[ze]),We.push(Q[ze+1])),ne.numPoints++;Ie&&function(nt,Ct){for(var nn=0,Et=0,Mn=nt.length,mn=Mn-2;Et<Mn;mn=Et,Et+=2)nn+=(nt[Et]-nt[mn])*(nt[Et+1]+nt[mn+1]);if(nn>0===Ct)for(Et=0,Mn=nt.length;Et<Mn/2;Et+=2){var An=nt[Et],$n=nt[Et+1];nt[Et]=nt[Mn-2-Et],nt[Et+1]=nt[Mn-1-Et],nt[Mn-2-Et]=An,nt[Mn-1-Et]=$n}}(We,Re),ye.push(We)}}function Zl(ye,Q){var ne=(Q=this.options=function(Ie,Re){for(var qe in Re)Ie[qe]=Re[qe];return Ie}(Object.create(this.options),Q)).debug;if(ne&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ie,Re,qe,We,ze,nt,ge=function(Ie,Re){var qe=[];if("FeatureCollection"===Ie.type)for(var We=0;We<Ie.features.length;We++)Pc(qe,Ie.features[We],Re,We);else Pc(qe,"Feature"===Ie.type?Ie:{geometry:Ie},Re);return qe}(ye,Q);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),We=Ie=ge,ze=ia(Ie,1,-1-(qe=(Re=Q).buffer/Re.extent),qe,0,-1,2,Re),nt=ia(Ie,1,1-qe,2+qe,0,-1,2,Re),(ze||nt)&&(We=ia(Ie,1,-qe,1+qe,0,-1,2,Re)||[],ze&&(We=hp(ze,1).concat(We)),nt&&(We=We.concat(hp(nt,-1)))),(ge=We).length&&this.splitTile(ge,0,0,0),ne&&(ge.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ds(ye,Q,ne){return 32*((1<<ye)*ne+Q)+ye}function Kl(ye,Q){const ne=ye.tileID.canonical;if(!this._geoJSONIndex)return Q(null,null);const ge=this._geoJSONIndex.getTile(ne.z,ne.x,ne.y);if(!ge)return Q(null,null);const Ie=new qt(ge.features);let Re=jt(Ie);0===Re.byteOffset&&Re.byteLength===Re.buffer.byteLength||(Re=new Uint8Array(Re)),Q(null,{vectorTile:Ie,rawData:Re.buffer})}Zl.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Zl.prototype.splitTile=function(ye,Q,ne,ge,Ie,Re,qe){for(var We=[ye,Q,ne,ge],ze=this.options,nt=ze.debug;We.length;){ge=We.pop(),ne=We.pop(),Q=We.pop(),ye=We.pop();var Ct=1<<Q,nn=Ds(Q,ne,ge),Et=this.tiles[nn];if(!Et&&(nt>1&&console.time("creation"),Et=this.tiles[nn]=Vu(ye,Q,ne,ge,ze),this.tileCoords.push({z:Q,x:ne,y:ge}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,ne,ge,Et.numFeatures,Et.numPoints,Et.numSimplified),console.timeEnd("creation"));var Mn="z"+Q;this.stats[Mn]=(this.stats[Mn]||0)+1,this.total++}if(Et.source=ye,Ie){if(Q===ze.maxZoom||Q===Ie)continue;var mn=1<<Ie-Q;if(ne!==Math.floor(Re/mn)||ge!==Math.floor(qe/mn))continue}else if(Q===ze.indexMaxZoom||Et.numPoints<=ze.indexMaxPoints)continue;if(Et.source=null,0!==ye.length){nt>1&&console.time("clipping");var An,$n,di,Vi,Rn,qi,go=.5*ze.buffer/ze.extent,wl=.5-go,Ya=.5+go,yt=1+go;An=$n=di=Vi=null,Rn=ia(ye,Ct,ne-go,ne+Ya,0,Et.minX,Et.maxX,ze),qi=ia(ye,Ct,ne+wl,ne+yt,0,Et.minX,Et.maxX,ze),ye=null,Rn&&(An=ia(Rn,Ct,ge-go,ge+Ya,1,Et.minY,Et.maxY,ze),$n=ia(Rn,Ct,ge+wl,ge+yt,1,Et.minY,Et.maxY,ze),Rn=null),qi&&(di=ia(qi,Ct,ge-go,ge+Ya,1,Et.minY,Et.maxY,ze),Vi=ia(qi,Ct,ge+wl,ge+yt,1,Et.minY,Et.maxY,ze),qi=null),nt>1&&console.timeEnd("clipping"),We.push(An||[],Q+1,2*ne,2*ge),We.push($n||[],Q+1,2*ne,2*ge+1),We.push(di||[],Q+1,2*ne+1,2*ge),We.push(Vi||[],Q+1,2*ne+1,2*ge+1)}}},Zl.prototype.getTile=function(ye,Q,ne){var ge=this.options,Ie=ge.extent,Re=ge.debug;if(ye<0||ye>24)return null;var qe=1<<ye,We=Ds(ye,Q=(Q%qe+qe)%qe,ne);if(this.tiles[We])return Xa(this.tiles[We],Ie);Re>1&&console.log("drilling down to z%d-%d-%d",ye,Q,ne);for(var ze,nt=ye,Ct=Q,nn=ne;!ze&&nt>0;)nt--,Ct=Math.floor(Ct/2),nn=Math.floor(nn/2),ze=this.tiles[Ds(nt,Ct,nn)];return ze&&ze.source?(Re>1&&console.log("found parent tile z%d-%d-%d",nt,Ct,nn),Re>1&&console.time("drilling down"),this.splitTile(ze.source,nt,Ct,nn,ye,Q,ne),Re>1&&console.timeEnd("drilling down"),this.tiles[We]?Xa(this.tiles[We],Ie):null):null};class Xd extends g.VectorTileWorkerSource{constructor(Q,ne,ge,Ie,Re){super(Q,ne,ge,Ie,Kl),Re&&(this.loadGeoJSON=Re)}loadData(Q,ne){const ge=Q&&Q.request,Ie=ge&&ge.collectResourceTiming;this.loadGeoJSON(Q,(Re,qe)=>{if(Re||!qe)return ne(Re);if("object"!=typeof qe)return ne(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));{Xe(qe,!0);try{if(Q.filter){const ze=g.createExpression(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ze.result)throw new Error(ze.value.map(Ct=>`${Ct.key}: ${Ct.message}`).join(", "));qe={type:"FeatureCollection",features:qe.features.filter(Ct=>ze.value.evaluate({zoom:0},Ct))}}this._geoJSONIndex=Q.cluster?new Ko(function({superclusterOptions:ze,clusterProperties:nt}){if(!nt||!ze)return ze;const Ct={},nn={},Et={accumulated:null,zoom:0},Mn={properties:null},mn=Object.keys(nt);for(const An of mn){const[$n,di]=nt[An],Vi=g.createExpression(di),Rn=g.createExpression("string"==typeof $n?[$n,["accumulated"],["get",An]]:$n);Ct[An]=Vi.value,nn[An]=Rn.value}return ze.map=An=>{Mn.properties=An;const $n={};for(const di of mn)$n[di]=Ct[di].evaluate(Et,Mn);return $n},ze.reduce=(An,$n)=>{Mn.properties=$n;for(const di of mn)Et.accumulated=An[di],An[di]=nn[di].evaluate(Et,Mn)},ze}(Q)).load(qe.features):new Zl(ze=qe,Q.geojsonVtOptions)}catch(ze){return ne(ze)}this.loaded={};const We={};if(Ie){const ze=g.getPerformanceMeasurement(ge);ze&&(We.resourceTiming={},We.resourceTiming[Q.source]=JSON.parse(JSON.stringify(ze)))}ne(null,We)}var ze})}reloadTile(Q,ne){const ge=this.loaded;return ge&&ge[Q.uid]?super.reloadTile(Q,ne):this.loadTile(Q,ne)}loadGeoJSON(Q,ne){if(Q.request)g.getJSON(Q.request,ne);else{if("string"!=typeof Q.data)return ne(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));try{return ne(null,JSON.parse(Q.data))}catch{return ne(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Q,ne){try{ne(null,this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId))}catch(ge){ne(ge)}}getClusterChildren(Q,ne){try{ne(null,this._geoJSONIndex.getChildren(Q.clusterId))}catch(ge){ne(ge)}}getClusterLeaves(Q,ne){try{ne(null,this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset))}catch(ge){ne(ge)}}}class Xl{constructor(Q){this.self=Q,this.actor=new g.Actor(Q,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=g.getProjection({name:"mercator"}),this.workerSourceTypes={vector:g.VectorTileWorkerSource,geojson:Xd},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ne,ge)=>{if(this.workerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.workerSourceTypes[ne]=ge},this.self.registerRTLTextPlugin=ne=>{if(g.plugin.isParsed())throw new Error("RTL text plugin already registered.");g.plugin.applyArabicShaping=ne.applyArabicShaping,g.plugin.processBidirectionalText=ne.processBidirectionalText,g.plugin.processStyledBidirectionalText=ne.processStyledBidirectionalText}}clearCaches(Q,ne,ge){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.workerSources[Q],delete this.demWorkerSources[Q],ge()}checkIfReady(Q,ne,ge){ge()}setReferrer(Q,ne){this.referrer=ne}spriteLoaded(Q,ne){this.isSpriteLoaded[Q]=ne;for(const ge in this.workerSources[Q]){const Ie=this.workerSources[Q][ge];for(const Re in Ie)Ie[Re]instanceof g.VectorTileWorkerSource&&(Ie[Re].isSpriteLoaded=ne,Ie[Re].fire(new g.Event("isSpriteLoaded")))}}setImages(Q,ne,ge){this.availableImages[Q]=ne;for(const Ie in this.workerSources[Q]){const Re=this.workerSources[Q][Ie];for(const qe in Re)Re[qe].availableImages=ne}ge()}enableTerrain(Q,ne,ge){this.terrain=ne,ge()}setProjection(Q,ne){this.projections[Q]=g.getProjection(ne)}setLayers(Q,ne,ge){this.getLayerIndex(Q).replace(ne),ge()}updateLayers(Q,ne,ge){this.getLayerIndex(Q).update(ne.layers,ne.removedIds),ge()}loadTile(Q,ne,ge){const Ie=this.enableTerrain?g.extend({enableTerrain:this.terrain},ne):ne;Ie.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,ne.type,ne.source).loadTile(Ie,ge)}loadDEMTile(Q,ne,ge){const Ie=this.enableTerrain?g.extend({buildQuadTree:this.terrain},ne):ne;this.getDEMWorkerSource(Q,ne.source).loadTile(Ie,ge)}reloadTile(Q,ne,ge){const Ie=this.enableTerrain?g.extend({enableTerrain:this.terrain},ne):ne;Ie.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,ne.type,ne.source).reloadTile(Ie,ge)}abortTile(Q,ne,ge){this.getWorkerSource(Q,ne.type,ne.source).abortTile(ne,ge)}removeTile(Q,ne,ge){this.getWorkerSource(Q,ne.type,ne.source).removeTile(ne,ge)}removeSource(Q,ne,ge){if(!this.workerSources[Q]||!this.workerSources[Q][ne.type]||!this.workerSources[Q][ne.type][ne.source])return;const Ie=this.workerSources[Q][ne.type][ne.source];delete this.workerSources[Q][ne.type][ne.source],void 0!==Ie.removeSource?Ie.removeSource(ne,ge):ge()}loadWorkerSource(Q,ne,ge){try{this.self.importScripts(ne.url),ge()}catch(Ie){ge(Ie.toString())}}syncRTLPluginState(Q,ne,ge){try{g.plugin.setState(ne);const Ie=g.plugin.getPluginURL();if(g.plugin.isLoaded()&&!g.plugin.isParsed()&&null!=Ie){this.self.importScripts(Ie);const Re=g.plugin.isParsed();ge(Re?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ie}`),Re)}}catch(Ie){ge(Ie.toString())}}getAvailableImages(Q){let ne=this.availableImages[Q];return ne||(ne=[]),ne}getLayerIndex(Q){let ne=this.layerIndexes[Q];return ne||(ne=this.layerIndexes[Q]=new Ke),ne}getWorkerSource(Q,ne,ge){return this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][ne]||(this.workerSources[Q][ne]={}),this.workerSources[Q][ne][ge]||(this.workerSources[Q][ne][ge]=new this.workerSourceTypes[ne]({send:(Re,qe,We,ze,nt,Ct)=>{this.actor.send(Re,qe,We,Q,nt,Ct)},scheduler:this.actor.scheduler},this.getLayerIndex(Q),this.getAvailableImages(Q),this.isSpriteLoaded[Q])),this.workerSources[Q][ne][ge]}getDEMWorkerSource(Q,ne){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][ne]||(this.demWorkerSources[Q][ne]=new Ve),this.demWorkerSources[Q][ne]}enforceCacheSizeLimit(Q,ne){g.enforceCacheSizeLimit(ne)}getWorkerPerformanceMetrics(Q,ne,ge){ge(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Xl(self)),Xl}),_t(0,function(g){function se(v,d){if(Array.isArray(v)){if(!Array.isArray(d)||v.length!==d.length)return!1;for(let m=0;m<v.length;m++)if(!se(v[m],d[m]))return!1;return!0}if("object"==typeof v&&null!==v&&null!==d){if("object"!=typeof d||Object.keys(v).length!==Object.keys(d).length)return!1;for(const m in v)if(!se(v[m],d[m]))return!1;return!0}return v===d}var Je=Ke;function Ke(v){return d=v,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,T,E=new Blob([""],{type:"text/javascript"}),k=URL.createObjectURL(E);try{T=new Worker(k),x=!0}catch{x=!1}return T&&T.terminate(),URL.revokeObjectURL(k),x}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var x=document.createElement("canvas");x.width=x.height=1;var T=x.getContext("2d");if(!T)return!1;var E=T.getImageData(0,0,1,1);return E&&E.width===x.width}()||(void 0===Ve[m=d&&d.failIfMajorPerformanceCaveat]&&(Ve[m]=function(x){var T,k,O,B,E=(k=x,O=document.createElement("canvas"),(B=Object.create(Ke.webGLContextAttributes)).failIfMajorPerformanceCaveat=k,O.getContext("webgl",B)||O.getContext("experimental-webgl",B));if(!E)return!1;try{T=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!T||E.isContextLost())&&(E.shaderSource(T,"void main() {}"),E.compileShader(T),!0===E.getShaderParameter(T,E.COMPILE_STATUS))}(m)),!Ve[m]||document.documentMode));var d,m}var Ve={};function Xe(v,d,m){const x=g.window.document.createElement(v);return void 0!==d&&(x.className=d),m&&m.appendChild(x),x}function Bt(v,d,m){const x=g.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const T of Object.keys(d))x.setAttributeNS(null,T,d[T]);return m&&m.appendChild(x),x}Ke.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const bn=g.window.document&&g.window.document.documentElement.style,en=bn&&void 0!==bn.userSelect?"userSelect":"WebkitUserSelect";let un;function qt(){bn&&en&&(un=bn[en],bn[en]="none")}function jt(){bn&&en&&(bn[en]=un)}function Me(v){v.preventDefault(),v.stopPropagation(),g.window.removeEventListener("click",Me,!0)}function ft(){g.window.addEventListener("click",Me,!0),g.window.setTimeout(()=>{g.window.removeEventListener("click",Me,!0)},0)}function Ue(v,d){const m=v.getBoundingClientRect();return St(v,m,d)}function st(v,d){const m=v.getBoundingClientRect(),x=[];for(let T=0;T<d.length;T++)x.push(St(v,m,d[T]));return x}function He(v){return void 0!==g.window.InstallTrigger&&2===v.button&&v.ctrlKey&&g.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function St(v,d,m){const x=v.offsetWidth===d.width?1:v.offsetWidth/d.width;return new g.pointGeometry((m.clientX-d.left)*x,(m.clientY-d.top)*x)}function wt(v,d){var m=d[0],x=d[1],T=d[2],E=d[3],k=m*E-T*x;return k?(v[0]=E*(k=1/k),v[1]=-x*k,v[2]=-T*k,v[3]=m*k,v):null}function Lt(v){const{userImage:d}=v;return!!(d&&d.render&&d.render())&&(v.data.replace(new Uint8Array(d.data.buffer)),!0)}class ln extends g.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new g.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(d){if(this.loaded!==d&&(this.loaded=d,d)){for(const{ids:m,callback:x}of this.requestors)this._notify(m,x);this.requestors=[]}}hasImage(d){return!!this.getImage(d)}getImage(d){return this.images[d]}addImage(d,m){this._validate(d,m)&&(this.images[d]=m)}_validate(d,m){let x=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new g.ErrorEvent(new Error(`Image "${d}" has invalid "stretchX" value`))),x=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new g.ErrorEvent(new Error(`Image "${d}" has invalid "stretchY" value`))),x=!1),this._validateContent(m.content,m)||(this.fire(new g.ErrorEvent(new Error(`Image "${d}" has invalid "content" value`))),x=!1),x}_validateStretch(d,m){if(!d)return!0;let x=0;for(const T of d){if(T[0]<x||T[1]<T[0]||m<T[1])return!1;x=T[1]}return!0}_validateContent(d,m){return!(d&&(4!==d.length||d[0]<0||m.data.width<d[0]||d[1]<0||m.data.height<d[1]||d[2]<0||m.data.width<d[2]||d[3]<0||m.data.height<d[3]||d[2]<d[0]||d[3]<d[1]))}updateImage(d,m){m.version=this.images[d].version+1,this.images[d]=m,this.updatedImages[d]=!0}removeImage(d){const m=this.images[d];delete this.images[d],delete this.patterns[d],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(d,m){let x=!0;if(!this.isLoaded())for(const T of d)this.images[T]||(x=!1);this.isLoaded()||x?this._notify(d,m):this.requestors.push({ids:d,callback:m})}_notify(d,m){const x={};for(const T of d){this.images[T]||this.fire(new g.Event("styleimagemissing",{id:T}));const E=this.images[T];E?x[T]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:Boolean(E.userImage&&E.userImage.render)}:g.warnOnce(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,x)}getPixelSize(){const{width:d,height:m}=this.atlasImage;return{width:d,height:m}}getPattern(d){const m=this.patterns[d],x=this.getImage(d);if(!x)return null;if(m&&m.position.version===x.version)return m.position;if(m)m.position.version=x.version;else{const T={w:x.data.width+2,h:x.data.height+2,x:0,y:0},E=new g.ImagePosition(T,x);this.patterns[d]={bin:T,position:E}}return this._updatePatternAtlas(),this.patterns[d].position}bind(d){const m=d.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new g.Texture(d,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const d=[];for(const E in this.patterns)d.push(this.patterns[E].bin);const{w:m,h:x}=g.potpack(d),T=this.atlasImage;T.resize({width:m||1,height:x||1});for(const E in this.patterns){const{bin:k}=this.patterns[E],O=k.x+1,B=k.y+1,G=this.images[E].data,q=G.width,J=G.height;g.RGBAImage.copy(G,T,{x:0,y:0},{x:O,y:B},{width:q,height:J}),g.RGBAImage.copy(G,T,{x:0,y:J-1},{x:O,y:B-1},{width:q,height:1}),g.RGBAImage.copy(G,T,{x:0,y:0},{x:O,y:B+J},{width:q,height:1}),g.RGBAImage.copy(G,T,{x:q-1,y:0},{x:O-1,y:B},{width:1,height:J}),g.RGBAImage.copy(G,T,{x:0,y:0},{x:O+q,y:B},{width:1,height:J})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(d){for(const m of d){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const x=this.images[m];Lt(x)&&this.updateImage(m,x)}}}const Bn=new g.Properties({anchor:new g.DataConstantProperty(g.spec.light.anchor),position:new class{constructor(){this.specification=g.spec.light.position}possiblyEvaluate(v,d){return function([m,x,T]){const E=g.degToRad(x+90),k=g.degToRad(T);return{x:m*Math.cos(E)*Math.sin(k),y:m*Math.sin(E)*Math.sin(k),z:m*Math.cos(k),azimuthal:x,polar:T}}(v.expression.evaluate(d))}interpolate(v,d,m){return{x:g.number(v.x,d.x,m),y:g.number(v.y,d.y,m),z:g.number(v.z,d.z,m),azimuthal:g.number(v.azimuthal,d.azimuthal,m),polar:g.number(v.polar,d.polar,m)}}},color:new g.DataConstantProperty(g.spec.light.color),intensity:new g.DataConstantProperty(g.spec.light.intensity)}),Co="-transition";class Ao extends g.Evented{constructor(d){super(),this._transitionable=new g.Transitionable(Bn),this.setLight(d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(d,m={}){if(!this._validate(g.validateLight,d,m))for(const x in d){const T=d[x];g.endsWith(x,Co)?this._transitionable.setTransition(x.slice(0,-Co.length),T):this._transitionable.setValue(x,T)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,m,x){return(!x||!1!==x.validate)&&g.emitValidationErrors(this,d.call(g.validateStyle,g.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:g.spec})))}}const Hn=new g.Properties({source:new g.DataConstantProperty(g.spec.terrain.source),exaggeration:new g.DataConstantProperty(g.spec.terrain.exaggeration)}),Mr="-transition";class mr extends g.Evented{constructor(d,m){super(),this._transitionable=new g.Transitionable(Hn),this.set(d),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=m}get(){return this._transitionable.serialize()}set(d){for(const m in d){const x=d[m];g.endsWith(m,Mr)?this._transitionable.setTransition(m.slice(0,-Mr.length),x):this._transitionable.setValue(m,x)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}}function na(v,d,m,x){const T=g.smoothstep(45,65,m),[E,k]=Vs(v,x),O=g.length(d);let B=1-Math.min(1,Math.exp((O-E)/(k-E)*-6));return B*=B*B,B=Math.min(1,1.00747*B),B*T*v.alpha}function Vs(v,d){const m=.5/Math.tan(.5*d);return[v.range[0]+m,v.range[1]+m]}const ri=new g.Properties({range:new g.DataConstantProperty(g.spec.fog.range),color:new g.DataConstantProperty(g.spec.fog.color),"high-color":new g.DataConstantProperty(g.spec.fog["high-color"]),"space-color":new g.DataConstantProperty(g.spec.fog["space-color"]),"horizon-blend":new g.DataConstantProperty(g.spec.fog["horizon-blend"]),"star-intensity":new g.DataConstantProperty(g.spec.fog["star-intensity"])}),Ca="-transition";class Gl extends g.Evented{constructor(d,m){super(),this._transitionable=new g.Transitionable(ri),this.set(d),this._transitioning=this._transitionable.untransitioned(),this._transform=m}get state(){const d=this._transform,m="globe"===d.projection.name,x=g.globeToMercatorTransition(d.zoom),T=this.properties.get("range"),E=[.5,3];return{range:m?[g.number(E[0],T[0],x),g.number(E[1],T[1],x)]:T,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(d,m={}){if(!this._validate(g.validateFog,d,m)){for(const x of Object.keys(g.spec.fog))d&&void 0===d[x]&&(d[x]=g.spec.fog[x].default);for(const x in d){const T=d[x];g.endsWith(x,Ca)?this._transitionable.setTransition(x.slice(0,-Ca.length),T):this._transitionable.setValue(x,T)}}}getOpacity(d){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:g.smoothstep(45,65,d))*m.a}getOpacityAtLatLng(d,m){return this._transform.projection.supportsFog?function(x,T,E){const k=g.MercatorCoordinate.fromLngLat(T),O=E.elevation?E.elevation.getAtPointOrZero(k):0,B=[k.x,k.y,O];return g.transformMat4(B,B,E.mercatorFogMatrix),na(x,B,E.pitch,E._fov)}(this.state,d,m):0}getFovAdjustedRange(d){return this._transform.projection.supportsFog?Vs(this.state,d):[0,1]}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,m,x){return(!x||!1!==x.validate)&&g.emitValidationErrors(this,d.call(g.validateStyle,g.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:g.spec})))}}class Us{constructor(d,m){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=g.uniqueId();const x=this.workerPool.acquire(this.id);for(let T=0;T<x.length;T++){const E=new Us.Actor(x[T],m,this.id);E.name=`Worker ${T}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(d,m,x){g.asyncAll(this.actors,(T,E)=>{T.send(d,m,E)},x=x||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(d=>{d.remove()}),this.actors=[],this.workerPool.release(this.id)}}function fs(v,d,m){return d*(g.EXTENT/(v.tileSize*Math.pow(2,m-v.tileID.overscaledZ)))}Us.Actor=g.Actor;class si{constructor(d,m,x,T){this.screenBounds=d,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=x,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,T)}static createFromScreenPoints(d,m){let x,T;if(d instanceof g.pointGeometry||"number"==typeof d[0]){const E=g.pointGeometry.convert(d);x=[E],T=m.isPointAboveHorizon(E)}else{const E=g.pointGeometry.convert(d[0]),k=g.pointGeometry.convert(d[1]);x=[E,k],T=g.polygonizeBounds(E,k).every(O=>m.isPointAboveHorizon(O))}return new si(x,m.getCameraPoint(),T,m)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(d){return g.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],d)}bufferedCameraGeometry(d){const m=this.screenBounds[0],x=1===this.screenBounds.length?this.screenBounds[0].add(new g.pointGeometry(1,1)):this.screenBounds[1],T=g.polygonizeBounds(m,x,0,!1);return this.cameraPoint.y>x.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<x.x?T.splice(3,0,this.cameraPoint):this.cameraPoint.x>=x.x?T[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(T[3]=this.cameraPoint)),g.bufferConvexPolygon(T,d)}bufferedCameraGeometryGlobe(d){const m=this.screenBounds[0],x=1===this.screenBounds.length?this.screenBounds[0].add(new g.pointGeometry(1,1)):this.screenBounds[1],T=g.polygonizeBounds(m,x,d),E=this.cameraPoint.clone();switch(3*((E.y>m.y)+(E.y>x.y))+((E.x>m.x)+(E.x>x.x))){case 0:T[0]=E,T[4]=E.clone();break;case 1:T.splice(1,0,E);break;case 2:T[1]=E;break;case 3:T.splice(4,0,E);break;case 5:T.splice(2,0,E);break;case 6:T[3]=E;break;case 7:T.splice(3,0,E);break;case 8:T[2]=E}return T}containsTile(d,m,x,T=0){const E=d.queryPadding/m._pixelsPerMercatorPixel+1,k=x?this._bufferedCameraMercator(E,m):this._bufferedScreenMercator(E,m);let O=d.tileID.wrap+(k.unwrapped?T:0);const B=k.polygon.map(pe=>g.getTilePoint(d.tileTransform,pe,O));if(!g.polygonIntersectsBox(B,0,0,g.EXTENT,g.EXTENT))return;O=d.tileID.wrap+(this.screenGeometryMercator.unwrapped?T:0);const G=this.screenGeometryMercator.polygon.map(pe=>g.getTileVec3(d.tileTransform,pe,O)),q=G.map(pe=>new g.pointGeometry(pe[0],pe[1])),J=m.getFreeCameraOptions().position||new g.MercatorCoordinate(0,0,0),re=g.getTileVec3(d.tileTransform,J,O),de=G.map(pe=>{const oe=g.sub(pe,pe,re);return g.normalize(oe,oe),new g.Ray(re,oe)}),le=fs(d,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:q,tilespaceRays:de,bufferedTilespaceGeometry:B,bufferedTilespaceBounds:(he=g.getBounds(B),he.min.x=g.clamp(he.min.x,0,g.EXTENT),he.min.y=g.clamp(he.min.y,0,g.EXTENT),he.max.x=g.clamp(he.max.x,0,g.EXTENT),he.max.y=g.clamp(he.max.y,0,g.EXTENT),he),tile:d,tileID:d.tileID,pixelToTileUnitsFactor:le};var he}_bufferedScreenMercator(d,m){const x=Ki(d);if(this._screenRaycastCache[x])return this._screenRaycastCache[x];{let T;return T="globe"===m.projection.name?this._projectAndResample(this.bufferedScreenGeometry(d),m):{polygon:this.bufferedScreenGeometry(d).map(E=>m.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[x]=T,T}}_bufferedCameraMercator(d,m){const x=Ki(d);if(this._cameraRaycastCache[x])return this._cameraRaycastCache[x];{let T;return T="globe"===m.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(d),m):{polygon:this.bufferedCameraGeometry(d).map(E=>m.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[x]=T,T}}_projectAndResample(d,m){const x=function(E,k){const O=g.multiply([],k.pixelMatrix,k.globeMatrix),B=[0,-g.GLOBE_RADIUS,0,1],G=[0,g.GLOBE_RADIUS,0,1],q=[0,0,0,1];g.transformMat4$1(B,B,O),g.transformMat4$1(G,G,O),g.transformMat4$1(q,q,O);const J=new g.pointGeometry(B[0]/B[3],B[1]/B[3]),re=new g.pointGeometry(G[0]/G[3],G[1]/G[3]),de=g.polygonContainsPoint(E,J)&&B[3]<q[3],le=g.polygonContainsPoint(E,re)&&G[3]<q[3];if(!de&&!le)return null;const he=function(Fe,$e,it){for(let rt=1;rt<Fe.length;rt++){const Vt=js($e.pointCoordinate3D(Fe[rt-1]).x),Ze=js($e.pointCoordinate3D(Fe[rt]).x);if(it<0){if(Vt<Ze)return{idx:rt,t:-Vt/(Ze-1-Vt)}}else if(Ze<Vt)return{idx:rt,t:(1-Vt)/(Ze+1-Vt)}}return null}(E,k,de?-1:1);if(!he)return null;const{idx:pe,t:oe}=he;let Ce=pe>1?Ta(E.slice(0,pe),k):[],xe=pe<E.length?Ta(E.slice(pe),k):[];Ce=Ce.map(Fe=>new g.pointGeometry(js(Fe.x),Fe.y)),xe=xe.map(Fe=>new g.pointGeometry(js(Fe.x),Fe.y));const Ee=[...Ce];0===Ee.length&&Ee.push(xe[xe.length-1]);const Le=g.number(Ee[Ee.length-1].y,(0===xe.length?Ce[0]:xe[0]).y,oe);let Pe;return Pe=de?[new g.pointGeometry(0,Le),new g.pointGeometry(0,0),new g.pointGeometry(1,0),new g.pointGeometry(1,Le)]:[new g.pointGeometry(1,Le),new g.pointGeometry(1,1),new g.pointGeometry(0,1),new g.pointGeometry(0,Le)],Ee.push(...Pe),0===xe.length?Ee.push(Ce[0]):Ee.push(...xe),{polygon:Ee.map(Fe=>new g.MercatorCoordinate(Fe.x,Fe.y)),unwrapped:!1}}(d,m);if(x)return x;const T=function(E,k){let O=!1,B=-1/0,G=0;for(let J=0;J<E.length-1;J++)E[J].x>B&&(B=E[J].x,G=J);for(let J=0;J<E.length-1;J++){const re=(G+J)%(E.length-1),de=E[re],le=E[re+1];Math.abs(de.x-le.x)>.5&&(de.x<le.x?(de.x+=1,0===re&&(E[E.length-1].x+=1)):(le.x+=1,re+1===E.length-1&&(E[0].x+=1)),O=!0)}const q=g.mercatorXfromLng(k.center.lng);return O&&q<Math.abs(q-1)&&E.forEach(J=>{J.x-=1}),{polygon:E,unwrapped:O}}(Ta(d,m).map(E=>new g.pointGeometry(js(E.x),E.y)),m);return{polygon:T.polygon.map(E=>new g.MercatorCoordinate(E.x,E.y)),unwrapped:T.unwrapped}}}function Ta(v,d){return g.resample(v,m=>{const x=d.pointCoordinate3D(m);m.x=x.x,m.y=x.y},1/256)}function js(v){return v<0?1+v%1:v%1}function Ki(v){return 100*v|0}function ii(v,d,m,x,T){const E=function(k,O){if(k)return T(k);if(O){v.url&&O.tiles&&v.tiles&&delete v.tiles;const B=g.pick(g.extend(O,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(B.vectorLayers=O.vector_layers,B.vectorLayerIds=B.vectorLayers.map(G=>G.id)),B.tiles=d.canonicalizeTileset(B,v.url),T(null,B)}};return v.url?g.getJSON(d.transformRequest(d.normalizeSourceURL(v.url,null,m,x),g.ResourceType.Source),E):g.exported.frame(()=>E(null,v))}class Ko{constructor(d,m,x){this.bounds=g.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=m||0,this.maxzoom=x||24}validateBounds(d){return Array.isArray(d)&&4===d.length?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]}contains(d){const m=Math.pow(2,d.z),x=Math.floor(g.mercatorXfromLng(this.bounds.getWest())*m),T=Math.floor(g.mercatorYfromLat(this.bounds.getNorth())*m),E=Math.ceil(g.mercatorXfromLng(this.bounds.getEast())*m),k=Math.ceil(g.mercatorYfromLat(this.bounds.getSouth())*m);return d.x>=x&&d.x<E&&d.y>=T&&d.y<k}}class Vn{constructor(d,m,x){this.context=d;const T=d.gl;this.buffer=T.createBuffer(),this.dynamicDraw=Boolean(x),this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(d){const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Mo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wa{constructor(d,m,x,T){this.length=m.length,this.attributes=x,this.itemSize=m.bytesPerElement,this.dynamicDraw=T,this.context=d;const E=d.gl;this.buffer=E.createBuffer(),d.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(d){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,d.arrayBuffer)}enableAttributes(d,m){for(let x=0;x<this.attributes.length;x++){const T=m.attributes[this.attributes[x].name];void 0!==T&&d.enableVertexAttribArray(T)}}setVertexAttribPointers(d,m,x){for(let T=0;T<this.attributes.length;T++){const E=this.attributes[T],k=m.attributes[E.name];void 0!==k&&d.vertexAttribPointer(k,E.components,d[Mo[E.type]],!1,this.itemSize,E.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class $i{constructor(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(d){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qa extends $i{getDefault(){return g.Color.transparent}set(d){const m=this.current;(d.r!==m.r||d.g!==m.g||d.b!==m.b||d.a!==m.a||this.dirty)&&(this.gl.clearColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class Ac extends $i{getDefault(){return 1}set(d){(d!==this.current||this.dirty)&&(this.gl.clearDepth(d),this.current=d,this.dirty=!1)}}class cp extends $i{getDefault(){return 0}set(d){(d!==this.current||this.dirty)&&(this.gl.clearStencil(d),this.current=d,this.dirty=!1)}}class Wl extends $i{getDefault(){return[!0,!0,!0,!0]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||d[2]!==m[2]||d[3]!==m[3]||this.dirty)&&(this.gl.colorMask(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class up extends $i{getDefault(){return!0}set(d){(d!==this.current||this.dirty)&&(this.gl.depthMask(d),this.current=d,this.dirty=!1)}}class Ou extends $i{getDefault(){return 255}set(d){(d!==this.current||this.dirty)&&(this.gl.stencilMask(d),this.current=d,this.dirty=!1)}}class Hd extends $i{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(d){const m=this.current;(d.func!==m.func||d.ref!==m.ref||d.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(d.func,d.ref,d.mask),this.current=d,this.dirty=!1)}}class Za extends $i{getDefault(){const d=this.gl;return[d.KEEP,d.KEEP,d.KEEP]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||d[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(d[0],d[1],d[2]),this.current=d,this.dirty=!1)}}class Ka extends $i{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=d,this.dirty=!1}}class $d extends $i{getDefault(){return[0,1]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||this.dirty)&&(this.gl.depthRange(d[0],d[1]),this.current=d,this.dirty=!1)}}class Pc extends $i{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=d,this.dirty=!1}}class dp extends $i{getDefault(){return this.gl.LESS}set(d){(d!==this.current||this.dirty)&&(this.gl.depthFunc(d),this.current=d,this.dirty=!1)}}class xl extends $i{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.BLEND):m.disable(m.BLEND),this.current=d,this.dirty=!1}}class Lu extends $i{getDefault(){const d=this.gl;return[d.ONE,d.ZERO]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(d[0],d[1]),this.current=d,this.dirty=!1)}}class Gd extends $i{getDefault(){return g.Color.transparent}set(d){const m=this.current;(d.r!==m.r||d.g!==m.g||d.b!==m.b||d.a!==m.a||this.dirty)&&(this.gl.blendColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class Wd extends $i{getDefault(){return this.gl.FUNC_ADD}set(d){(d!==this.current||this.dirty)&&(this.gl.blendEquation(d),this.current=d,this.dirty=!1)}}class ia extends $i{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;d?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=d,this.dirty=!1}}class Sa extends $i{getDefault(){return this.gl.BACK}set(d){(d!==this.current||this.dirty)&&(this.gl.cullFace(d),this.current=d,this.dirty=!1)}}class ql extends $i{getDefault(){return this.gl.CCW}set(d){(d!==this.current||this.dirty)&&(this.gl.frontFace(d),this.current=d,this.dirty=!1)}}class Ru extends $i{getDefault(){return null}set(d){(d!==this.current||this.dirty)&&(this.gl.useProgram(d),this.current=d,this.dirty=!1)}}class qd extends $i{getDefault(){return this.gl.TEXTURE0}set(d){(d!==this.current||this.dirty)&&(this.gl.activeTexture(d),this.current=d,this.dirty=!1)}}class Zd extends $i{getDefault(){const d=this.gl;return[0,0,d.drawingBufferWidth,d.drawingBufferHeight]}set(d){const m=this.current;(d[0]!==m[0]||d[1]!==m[1]||d[2]!==m[2]||d[3]!==m[3]||this.dirty)&&(this.gl.viewport(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class Fu extends $i{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,d),this.current=d,this.dirty=!1}}class Nu extends $i{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class hp extends $i{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,d),this.current=d,this.dirty=!1}}class zu extends $i{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class Xa extends $i{getDefault(){return null}set(d){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class Bu extends $i{constructor(d){super(d),this.vao=d.extVertexArrayObject}getDefault(){return null}set(d){this.vao&&(d!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(d),this.current=d,this.dirty=!1)}}class Vu extends $i{getDefault(){return 4}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,d),this.current=d,this.dirty=!1}}class Kd extends $i{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),this.current=d,this.dirty=!1}}class Oc extends $i{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,d),this.current=d,this.dirty=!1}}class Zl extends $i{constructor(d,m){super(d),this.context=d,this.parent=m}getDefault(){return null}}class Ds extends Zl{setDirty(){this.dirty=!0}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,d,0),this.current=d,this.dirty=!1}}class Kl extends Zl{attachment(){return this.gl.DEPTH_ATTACHMENT}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class Xd extends Kl{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Xl{constructor(d,m,x,T){this.context=d,this.width=m,this.height=x;const E=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new Ds(d,E),T&&(this.depthAttachment=new Kl(d,E))}destroy(){const d=this.context.gl,m=this.colorAttachment.get();if(m&&d.deleteTexture(m),this.depthAttachment){const x=this.depthAttachment.get();x&&d.deleteRenderbuffer(x)}d.deleteFramebuffer(this.framebuffer)}}class ye{constructor(d,m=!1){if(this.gl=d,this.isWebGL2=m,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),m){const x=d;this.extVertexArrayObject={createVertexArrayOES:x.createVertexArray.bind(d),deleteVertexArrayOES:x.deleteVertexArray.bind(d),bindVertexArrayOES:x.bindVertexArray.bind(d)}}this.clearColor=new qa(this),this.clearDepth=new Ac(this),this.clearStencil=new cp(this),this.colorMask=new Wl(this),this.depthMask=new up(this),this.stencilMask=new Ou(this),this.stencilFunc=new Hd(this),this.stencilOp=new Za(this),this.stencilTest=new Ka(this),this.depthRange=new $d(this),this.depthTest=new Pc(this),this.depthFunc=new dp(this),this.blend=new xl(this),this.blendFunc=new Lu(this),this.blendColor=new Gd(this),this.blendEquation=new Wd(this),this.cullFace=new ia(this),this.cullFaceSide=new Sa(this),this.frontFace=new ql(this),this.program=new Ru(this),this.activeTexture=new qd(this),this.viewport=new Zd(this),this.bindFramebuffer=new Fu(this),this.bindRenderbuffer=new Nu(this),this.bindTexture=new hp(this),this.bindVertexBuffer=new zu(this),this.bindElementBuffer=new Xa(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Bu(this),this.pixelStoreUnpack=new Vu(this),this.pixelStoreUnpackPremultiplyAlpha=new Kd(this),this.pixelStoreUnpackFlipY=new Oc(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=d.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=d.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=d.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),m||(this.extTextureHalfFloat=d.getExtension("OES_texture_half_float")),(m||this.extTextureHalfFloat&&d.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=m||d.getExtension("OES_standard_derivatives"),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(d,m){return new Vn(this,d,m)}createVertexBuffer(d,m,x){return new Wa(this,d,m,x)}createRenderbuffer(d,m,x){const T=this.gl,E=T.createRenderbuffer();return this.bindRenderbuffer.set(E),T.renderbufferStorage(T.RENDERBUFFER,d,m,x),this.bindRenderbuffer.set(null),E}createFramebuffer(d,m,x){return new Xl(this,d,m,x)}clear({color:d,depth:m,stencil:x}){const T=this.gl;let E=0;d&&(E|=T.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),void 0!==m&&(E|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),void 0!==x&&(E|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),T.clear(E)}setCullFace(d){!1===d.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))}setDepthMode(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)}setStencilMode(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)}setColorMode(d){se(d.blendFunction,g.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Q extends g.Evented{constructor(d,m,x,T){if(super(),this.id=d,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,g.extend(this,g.pick(m,["url","scheme","tileSize","promoteId"])),this._options=g.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T),this._tileWorkers={},this._deduped=new g.DedupedRequest}load(d){this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"}));const m=Array.isArray(this.map._language)?this.map._language.join():this.map._language,x=this.map._worldview;this._tileJSONRequest=ii(this._options,this.map._requestManager,m,x,(T,E)=>{this._tileJSONRequest=null,this._loaded=!0,T?(m&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${m}`),x&&2!==x.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${x}`),this.fire(new g.ErrorEvent(T))):E&&(g.extend(this,E),E.bounds&&(this.tileBounds=new Ko(E.bounds,this.minzoom,this.maxzoom)),g.postTurnstileEvent(E.tiles,this.map._requestManager._customAccessToken),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(T)})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return g.extend({},this._options)}loadTile(d,m){const x=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),T={request:this.map._requestManager.transformRequest(x,g.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:g.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(T.request.collectResourceTiming=this._collectResourceTiming,d.actor&&"expired"!==d.state)"loading"===d.state?d.reloadCallback=m:d.request=d.actor.send("reloadTile",T,E.bind(this));else if(d.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",T,E.bind(this),void 0,!0);else{const k=g.loadVectorTile.call({deduped:this._deduped},T,(O,B)=>{O||!B?E.call(this,O):(T.data={cacheControl:B.cacheControl,expires:B.expires,rawData:B.rawData.slice(0)},d.actor&&d.actor.send("loadTile",T,E.bind(this),void 0,!0))},!0);d.request={cancel:k}}function E(k,O){return delete d.request,d.aborted?m(null):k&&404!==k.status?m(k):(O&&O.resourceTiming&&(d.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&d.setExpiryData(O),d.loadVectorData(O,this.map.painter),g.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ne extends g.Evented{constructor(d,m,x,T){super(),this.id=d,this.dispatcher=x,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=g.extend({type:"raster"},m),g.extend(this,g.pick(m,["url","scheme","tileSize"]))}load(d){this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ii(this._options,this.map._requestManager,null,null,(m,x)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new g.ErrorEvent(m)):x&&(g.extend(this,x),x.bounds&&(this.tileBounds=new Ko(x.bounds,this.minzoom,this.maxzoom)),g.postTurnstileEvent(x.tiles),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(m)})}loaded(){return this._loaded}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return g.extend({},this._options)}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,m){const x=g.exported.devicePixelRatio>=2,T=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),x,this.tileSize);d.request=g.getImage(this.map._requestManager.transformRequest(T,g.ResourceType.Tile),(E,k,O,B)=>(delete d.request,d.aborted?(d.state="unloaded",m(null)):E?(d.state="errored",m(E)):k?(this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:O,expires:B}),d.setTexture(k,this.map.painter),d.state="loaded",g.cacheEntryPossiblyAdded(this.dispatcher),void m(null)):m(null)))}static loadTileData(d,m,x){d.setTexture(m,x)}static unloadTileData(d,m){d.texture&&m.saveTileTexture(d.texture)}abortTile(d,m){d.request&&(d.request.cancel(),delete d.request),m()}unloadTile(d,m){d.texture&&this.map.painter.saveTileTexture(d.texture),m()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let ge;function Ie(v,d,m,x,T,E,k,O){const B=[v,m,T,d,x,E,1,1,1],G=[k,O,1],q=g.adjoint([],B),[J,re,de]=g.transformMat3(G,G,g.transpose(q,q));return g.multiply$1(B,[J,0,0,0,re,0,0,0,de],B)}class Re extends g.Evented{constructor(d,m,x,T){super(),this.id=d,this.dispatcher=x,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=m,this._dirty=!1}load(d,m){this._loaded=m||!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=g.getImage(this.map._requestManager.transformRequest(this.url,g.ResourceType.Image),(x,T)=>{if(this._imageRequest=null,this._loaded=!0,x)this.fire(new g.ErrorEvent(x));else if(T){const{HTMLImageElement:E}=g.window;this.image=T instanceof E?g.exported.getImageData(T):T,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,d&&(this.coordinates=d),this._finishLoading()}})}loaded(){return this._loaded}updateImage(d){return this.image&&d.url?(this._imageRequest&&d.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=d.url,this.load(d.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(d){this.map=d,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(d){this.coordinates=d,this._boundsArray=void 0;const m=d.map(g.MercatorCoordinate.fromLngLat);return this.tileID=function(x){let T=1/0,E=1/0,k=-1/0,O=-1/0;for(const J of x)T=Math.min(T,J.x),E=Math.min(E,J.y),k=Math.max(k,J.x),O=Math.max(O,J.y);const B=Math.max(k-T,O-E),G=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),q=Math.pow(2,G);return new g.CanonicalTileID(G,Math.floor((T+k)/2*q),Math.floor((E+O)/2*q))}(m),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(d){for(const B in this.tiles){const G=this.tiles[B];"loaded"!==G.state&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;const m=g.tileTransform(this.tileID,this.map.transform.projection),[x,T,E,k]=this.coordinates.map(B=>{const G=m.projection.project(B[0],B[1]);return g.getTilePoint(m,G)._round()});this.perspectiveTransform=function(B,G,q,J,re,de,le,he,pe,oe){const Ce=Ie(0,0,B,0,0,G,B,G),xe=Ie(q,J,re,de,le,he,pe,oe);return g.multiply$1(xe,g.adjoint(Ce,Ce),xe),[xe[6]/xe[8]*B/g.EXTENT,xe[7]/xe[8]*G/g.EXTENT]}(this.width,this.height,x.x,x.y,T.x,T.y,k.x,k.y,E.x,E.y);const O=this._boundsArray=new g.StructArrayLayout4i8;O.emplaceBack(x.x,x.y,0,0),O.emplaceBack(T.x,T.y,g.EXTENT,0),O.emplaceBack(k.x,k.y,0,g.EXTENT),O.emplaceBack(E.x,E.y,g.EXTENT,g.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=d.createVertexBuffer(O,g.boundsAttributes.members),this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const d=this.map.painter.context,m=d.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new g.Texture(d,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(d)}loadTile(d,m){this.tileID&&this.tileID.equals(d.tileID.canonical)?(this.tiles[String(d.tileID.wrap)]=d,d.buckets={},m(null)):(d.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const qe={vector:Q,raster:ne,"raster-dem":class extends ne{constructor(v,d,m,x){super(v,d,m,x),this.type="raster-dem",this.maxzoom=22,this._options=g.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}loadTile(v,d){const m=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function x(T,E){T&&(v.state="errored",d(T)),E&&(v.dem=E,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",d(null))}v.request=g.getImage(this.map._requestManager.transformRequest(m,g.ResourceType.Tile),function(T,E,k,O){if(delete v.request,v.aborted)v.state="unloaded",d(null);else if(T)v.state="errored",d(T);else if(E){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:k,expires:O});const B=g.window.ImageBitmap&&E instanceof g.window.ImageBitmap&&(null==ge&&(ge=g.window.OffscreenCanvas&&new g.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof g.window.createImageBitmap),ge),G=1-(E.width-g.prevPowerOfTwo(E.width))/2;G<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const q=B?E:g.exported.getImageData(E,G),J={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:q,encoding:this.encoding,padding:G};v.actor&&"expired"!==v.state||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",J,x.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(v){const d=v.canonical,m=Math.pow(2,d.z),x=(d.x-1+m)%m,T=0===d.x?v.wrap-1:v.wrap,E=(d.x+1+m)%m,k=d.x+1===m?v.wrap+1:v.wrap,O={};return O[new g.OverscaledTileID(v.overscaledZ,T,d.z,x,d.y).key]={backfilled:!1},O[new g.OverscaledTileID(v.overscaledZ,k,d.z,E,d.y).key]={backfilled:!1},d.y>0&&(O[new g.OverscaledTileID(v.overscaledZ,T,d.z,x,d.y-1).key]={backfilled:!1},O[new g.OverscaledTileID(v.overscaledZ,v.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},O[new g.OverscaledTileID(v.overscaledZ,k,d.z,E,d.y-1).key]={backfilled:!1}),d.y+1<m&&(O[new g.OverscaledTileID(v.overscaledZ,T,d.z,x,d.y+1).key]={backfilled:!1},O[new g.OverscaledTileID(v.overscaledZ,v.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},O[new g.OverscaledTileID(v.overscaledZ,k,d.z,E,d.y+1).key]={backfilled:!1}),O}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends g.Evented{constructor(v,d,m,x){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(x),this._data=d.data,this._options=g.extend({},d),this._collectResourceTiming=d.collectResourceTiming,void 0!==d.maxzoom&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const T=g.EXTENT/this.tileSize;this.workerOptions=g.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(void 0!==d.buffer?d.buffer:128)*T,tolerance:(void 0!==d.tolerance?d.tolerance:.375)*T,extent:g.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:void 0!==d.clusterMaxZoom?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:g.EXTENT,radius:(void 0!==d.clusterRadius?d.clusterRadius:50)*T,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},d),this}getClusterChildren(v,d){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},d),this}getClusterLeaves(v,d,m,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:d,offset:m},x),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new g.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=g.extend({},this.workerOptions),d=this._data;"string"==typeof d?(v.request=this.map._requestManager.transformRequest(g.exported.resolveURL(d),g.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(m,x)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new g.ErrorEvent(m));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(T.resourceTiming=x.resourceTiming[this.id]),this.fire(new g.Event("data",T)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,d){const m=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(m,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:g.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(x,T)=>(delete v.request,v.unloadVectorData(),v.aborted?d(null):x?d(x):(v.loadVectorData(T,this.map.painter,"reloadTile"===m),d(null))),void 0,"loadTile"===m)}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return g.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Re{constructor(v,d,m,x){super(v,d,m,x),this.roundZoom=!0,this.type="video",this.options=d}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const d of v.urls)this.urls.push(this.map._requestManager.transformRequest(d,g.ResourceType.Source).url);g.getVideo(this.urls,(d,m)=>{this._loaded=!0,d?this.fire(new g.ErrorEvent(d)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const d=this.video.seekable;v<d.start(0)||v>d.end(0)?this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const v=this.map.painter.context,d=v.gl;this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new g.Texture(v,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Re,canvas:class extends Re{constructor(v,d,m,x){super(v,d,m,x),d.coordinates?Array.isArray(d.coordinates)&&4===d.coordinates.length&&!d.coordinates.some(T=>!Array.isArray(T)||2!==T.length||T.some(E=>"number"!=typeof E))||this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),d.animate&&"boolean"!=typeof d.animate&&this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),d.canvas?"string"==typeof d.canvas||d.canvas instanceof g.window.HTMLCanvasElement||this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=d,this.animate=void 0===d.animate||d.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof g.window.HTMLCanvasElement?this.options.canvas:g.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new g.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const d=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new g.Texture(d,this.canvas,d.gl.RGBA,{premultiply:!0}),this._prepareData(d)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends g.Evented{constructor(v,d,m,x){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=d,this.setEventedParent(x),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new g.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new g.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ko(this._implementation.bounds,this.minzoom,this.maxzoom)),d.update=this._update.bind(this),d.clearTiles=this._clearTiles.bind(this),d.coveringTiles=this._coveringTiles.bind(this),g.extend(this,g.pick(d,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return g.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:d,y:m,z:x}=v.canonical;return this._implementation.hasTile({x:d,y:m,z:x})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,d){const{x:m,y:x,z:T}=v.tileID.canonical,E=new g.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:m,y:x,z:T},{signal:E.signal})).then(function(k){return delete v.request,v.aborted?(v.state="unloaded",d(null)):void 0===k?(v.state="errored",d(null)):null===k?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",d(null)):(O=k)instanceof g.window.ImageData||O instanceof g.window.HTMLCanvasElement||O instanceof g.window.ImageBitmap||O instanceof g.window.HTMLImageElement?(this.loadTileData(v,k),v.state="loaded",void d(null)):(v.state="errored",d(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var O}.bind(this)).catch(k=>{20!==k.code&&(v.state="errored",d(k))}),v.request.cancel=()=>E.abort()}loadTileData(v,d){ne.loadTileData(v,d,this._map.painter)}unloadTileData(v){ne.unloadTileData(v,this._map.painter)}unloadTile(v,d){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:m,y:x,z:T}=v.tileID.canonical;this._implementation.unloadTile({x:m,y:x,z:T})}d()}abortTile(v,d){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),d()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"}))}}},We=function(v,d,m,x){const T=new qe[d.type](v,d,m,x);if(T.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${T.id}`);return g.bindAll(["load","abort","unload","serialize","prepare"],T),T};function ze(v,d){const m=g.identity([]);return g.scale(m,m,[.5*v.width,.5*-v.height,1]),g.translate(m,m,[1,-1,0]),g.multiply(m,m,v.calculateProjMatrix(d.toUnwrapped())),Float32Array.from(m)}function nt(v,d,m,x,T,E,k,O=!1){const B=v.tilesIn(x,k,O);B.sort(nn);const G=[];for(const J of B)G.push({wrappedTileID:J.tile.tileID.wrapped().key,queryResults:J.tile.queryRenderedFeatures(d,m,v._state,J,T,E,ze(v.transform,J.tile.tileID),O)});const q=function(J){const re={},de={};for(const le of J){const he=le.queryResults,pe=le.wrappedTileID,oe=de[pe]=de[pe]||{};for(const Ce in he){const xe=he[Ce],Ee=oe[Ce]=oe[Ce]||{},Le=re[Ce]=re[Ce]||[];for(const Pe of xe)Ee[Pe.featureIndex]||(Ee[Pe.featureIndex]=!0,Le.push(Pe))}}return re}(G);for(const J in q)q[J].forEach(re=>{const de=re.feature,le=de.layer;le&&"background"!==le.type&&"sky"!==le.type&&(de.source=le.source,le["source-layer"]&&(de.sourceLayer=le["source-layer"]),de.state=void 0!==de.id?v.getFeatureState(le["source-layer"],de.id):{})});return q}function Ct(v,d){const m=v.getRenderableIds().map(E=>v.getTileByID(E)),x=[],T={};for(let E=0;E<m.length;E++){const k=m[E],O=k.tileID.canonical.key;T[O]||(T[O]=!0,k.querySourceFeatures(x,d))}return x}function nn(v,d){const m=v.tileID,x=d.tileID;return m.overscaledZ-x.overscaledZ||m.canonical.y-x.canonical.y||m.wrap-x.wrap||m.canonical.x-x.canonical.x}function Et(){return null!=Xc.workerClass?new Xc.workerClass:new g.window.Worker(Xc.workerUrl)}const Mn="mapboxgl_preloaded_worker_pool";class mn{constructor(){this.active={}}acquire(d){if(!this.workers)for(this.workers=[];this.workers.length<mn.workerCount;)this.workers.push(new Et);return this.active[d]=!0,this.workers.slice()}release(d){delete this.active[d],0===this.numActive()&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Mn]}numActive(){return Object.keys(this.active).length}}let An;function $n(){return An||(An=new mn),An}function di(v,d){const m={};for(const x in v)"ref"!==x&&(m[x]=v[x]);return g.refProperties.forEach(x=>{x in d&&(m[x]=d[x])}),m}function Vi(v){v=v.slice();const d=Object.create(null);for(let m=0;m<v.length;m++)d[v[m].id]=v[m];for(let m=0;m<v.length;m++)"ref"in v[m]&&(v[m]=di(v[m],d[v[m].ref]));return v}mn.workerCount=2;const Rn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function qi(v,d,m){m.push({command:Rn.addSource,args:[v,d[v]]})}function go(v,d,m){d.push({command:Rn.removeSource,args:[v]}),m[v]=!0}function wl(v,d,m,x){go(v,m,x),qi(v,d,m)}function Ya(v,d,m){let x;for(x in v[m])if(v[m].hasOwnProperty(x)&&"data"!==x&&!se(v[m][x],d[m][x]))return!1;for(x in d[m])if(d[m].hasOwnProperty(x)&&"data"!==x&&!se(v[m][x],d[m][x]))return!1;return!0}function yt(v,d,m,x,T,E){let k;for(k in d=d||{},v=v||{})v.hasOwnProperty(k)&&(se(v[k],d[k])||m.push({command:E,args:[x,k,d[k],T]}));for(k in d)d.hasOwnProperty(k)&&!v.hasOwnProperty(k)&&(se(v[k],d[k])||m.push({command:E,args:[x,k,d[k],T]}))}function Cl(v){return v.id}function Jo(v,d){return v[d.id]=d,v}class Yl{constructor(d,m){this.reset(d,m)}reset(d,m){this.points=d||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(d){if(1===this.points.length)return this.points[0];d=g.clamp(d,0,1);let m=1,x=this._distances[m];const T=d*this.paddedLength+this.padding;for(;x<T&&m<this._distances.length;)x=this._distances[++m];const E=m-1,k=this._distances[E],O=x-k,B=O>0?(T-k)/O:0;return this.points[E].mult(1-B).add(this.points[m].mult(B))}}class qf{constructor(d,m,x){const T=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(d/x),this.yCellCount=Math.ceil(m/x);for(let k=0;k<this.xCellCount*this.yCellCount;k++)T.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=m,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(d,m,x,T,E){this._forEachCell(m,x,T,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(T),this.bboxes.push(E)}insertCircle(d,m,x,T){this._forEachCell(m-T,x-T,m+T,x+T,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(m),this.circles.push(x),this.circles.push(T)}_insertBoxCell(d,m,x,T,E,k){this.boxCells[E].push(k)}_insertCircleCell(d,m,x,T,E,k){this.circleCells[E].push(k)}_query(d,m,x,T,E,k){if(x<0||d>this.width||T<0||m>this.height)return!E&&[];const O=[];if(d<=0&&m<=0&&this.width<=x&&this.height<=T){if(E)return!0;for(let B=0;B<this.boxKeys.length;B++)O.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const G=this.circles[3*B],q=this.circles[3*B+1],J=this.circles[3*B+2];O.push({key:this.circleKeys[B],x1:G-J,y1:q-J,x2:G+J,y2:q+J})}return k?O.filter(k):O}return this._forEachCell(d,m,x,T,this._queryCell,O,{hitTest:E,seenUids:{box:{},circle:{}}},k),E?O.length>0:O}_queryCircle(d,m,x,T,E){const k=d-x,O=d+x,B=m-x,G=m+x;if(O<0||k>this.width||G<0||B>this.height)return!T&&[];const q=[];return this._forEachCell(k,B,O,G,this._queryCellCircle,q,{hitTest:T,circle:{x:d,y:m,radius:x},seenUids:{box:{},circle:{}}},E),T?q.length>0:q}query(d,m,x,T,E){return this._query(d,m,x,T,!1,E)}hitTest(d,m,x,T,E){return this._query(d,m,x,T,!0,E)}hitTestCircle(d,m,x,T){return this._queryCircle(d,m,x,!0,T)}_queryCell(d,m,x,T,E,k,O,B){const G=O.seenUids,q=this.boxCells[E];if(null!==q){const re=this.bboxes;for(const de of q)if(!G.box[de]){G.box[de]=!0;const le=4*de;if(d<=re[le+2]&&m<=re[le+3]&&x>=re[le+0]&&T>=re[le+1]&&(!B||B(this.boxKeys[de]))){if(O.hitTest)return k.push(!0),!0;k.push({key:this.boxKeys[de],x1:re[le],y1:re[le+1],x2:re[le+2],y2:re[le+3]})}}}const J=this.circleCells[E];if(null!==J){const re=this.circles;for(const de of J)if(!G.circle[de]){G.circle[de]=!0;const le=3*de;if(this._circleAndRectCollide(re[le],re[le+1],re[le+2],d,m,x,T)&&(!B||B(this.circleKeys[de]))){if(O.hitTest)return k.push(!0),!0;{const he=re[le],pe=re[le+1],oe=re[le+2];k.push({key:this.circleKeys[de],x1:he-oe,y1:pe-oe,x2:he+oe,y2:pe+oe})}}}}}_queryCellCircle(d,m,x,T,E,k,O,B){const G=O.circle,q=O.seenUids,J=this.boxCells[E];if(null!==J){const de=this.bboxes;for(const le of J)if(!q.box[le]){q.box[le]=!0;const he=4*le;if(this._circleAndRectCollide(G.x,G.y,G.radius,de[he+0],de[he+1],de[he+2],de[he+3])&&(!B||B(this.boxKeys[le])))return k.push(!0),!0}}const re=this.circleCells[E];if(null!==re){const de=this.circles;for(const le of re)if(!q.circle[le]){q.circle[le]=!0;const he=3*le;if(this._circlesCollide(de[he],de[he+1],de[he+2],G.x,G.y,G.radius)&&(!B||B(this.circleKeys[le])))return k.push(!0),!0}}}_forEachCell(d,m,x,T,E,k,O,B){const G=this._convertToXCellCoord(d),q=this._convertToYCellCoord(m),J=this._convertToXCellCoord(x),re=this._convertToYCellCoord(T);for(let de=G;de<=J;de++)for(let le=q;le<=re;le++)if(E.call(this,d,m,x,T,this.xCellCount*le+de,k,O,B))return}_convertToXCellCoord(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))}_convertToYCellCoord(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))}_circlesCollide(d,m,x,T,E,k){const O=T-d,B=E-m,G=x+k;return G*G>O*O+B*B}_circleAndRectCollide(d,m,x,T,E,k,O){const B=(k-T)/2,G=Math.abs(d-(T+B));if(G>B+x)return!1;const q=(O-E)/2,J=Math.abs(m-(E+q));if(J>q+x)return!1;if(G<=B||J<=q)return!0;const re=G-B,de=J-q;return re*re+de*de<=x*x}}const Qa=Math.tan(85*Math.PI/180);function Uu(v,d,m,x,T,E,k){const O=g.create();if(m)if("globe"===E.name){const B=g.calculateGlobeLabelMatrix(T,d);g.multiply(O,O,B)}else{const B=wt([],k);O[0]=B[0],O[1]=B[1],O[4]=B[2],O[5]=B[3],x||g.rotateZ(O,O,T.angle)}else g.multiply(O,T.labelPlaneMatrix,v);return O}function er(v,d,m,x,T,E,k){const O=Uu(v,d,m,x,T,E,k);return"globe"===E.name&&m||(O[2]=O[6]=O[10]=O[14]=0),O}function Lc(v,d,m,x,T,E,k){if(m){if("globe"===E.name){const O=Uu(v,d,m,x,T,E,k);return g.invert(O,O),g.multiply(O,v,O),O}{const O=g.clone(v),B=g.identity([]);return B[0]=k[0],B[1]=k[1],B[4]=k[2],B[5]=k[3],g.multiply(O,O,B),x||g.rotateZ(O,O,-T.angle),O}}return T.glCoordMatrix}function Zt(v,d,m,x){const T=[v,d,m,1];m?g.transformMat4$1(T,T,x):Wy(T,T,x);const E=T[3];return T[0]/=E,T[1]/=E,T[2]/=E,T}function wi(v,d){return Math.min(.5+v/d*.5,1.5)}function En(v,d){const m=v[0]/v[3],x=v[1]/v[3];return m>=-d[0]&&m<=d[0]&&x>=-d[1]&&x<=d[1]}function oa(v,d,m,x,T,E,k,O,B,G){const q=m.transform,J=x?v.textSizeData:v.iconSizeData,re=g.evaluateSizeForZoom(J,m.transform.zoom),de="globe"===q.projection.name,le=[256/m.width*2+1,256/m.height*2+1],he=x?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;he.clear();let pe=null;de&&(pe=x?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const oe=v.lineVertexArray,Ce=x?v.text.placedSymbolArray:v.icon.placedSymbolArray,xe=m.transform.width/m.transform.height;let Ee,Le=!1;for(let Pe=0;Pe<Ce.length;Pe++){const Fe=Ce.get(Pe),{numGlyphs:$e,writingMode:it}=Fe;if(it!==g.WritingMode.vertical||Le||Ee===g.WritingMode.horizontal||(Le=!0),Ee=it,(Fe.hidden||it===g.WritingMode.vertical)&&!Le){_o($e,he);continue}Le=!1;const rt=new g.pointGeometry(Fe.tileAnchorX,Fe.tileAnchorY);let{x:Vt,y:Ze,z:Tt}=q.projection.projectTilePoint(rt.x,rt.y,G.canonical);if(B){const[li,hn,Jt]=B(rt);Vt+=li,Ze+=hn,Tt+=Jt}const dt=[Vt,Ze,Tt,1];if(g.transformMat4$1(dt,dt,d),!En(dt,le)){_o($e,he);continue}const At=wi(m.transform.cameraToCenterDistance,dt[3]),ot=g.evaluateSizeForFeature(J,re,Fe),je=k?ot/At:ot*At,ct=Zt(Vt,Ze,Tt,T);if(ct[3]<=0){_o($e,he);continue}let Dt={};const Ot=k?null:B,vn=Yd(Fe,je,!1,O,d,T,E,v.glyphOffsetArray,oe,he,pe,ct,rt,Dt,xe,Ot,q.projection,G,k);Le=vn.useVertical,Ot&&vn.needsFlipping&&(Dt={}),(vn.notEnoughRoom||Le||vn.needsFlipping&&Yd(Fe,je,!0,O,d,T,E,v.glyphOffsetArray,oe,he,pe,ct,rt,Dt,xe,Ot,q.projection,G,k).notEnoughRoom)&&_o($e,he)}x?(v.text.dynamicLayoutVertexBuffer.updateData(he),pe&&v.text.globeExtVertexBuffer.updateData(pe)):(v.icon.dynamicLayoutVertexBuffer.updateData(he),pe&&v.icon.globeExtVertexBuffer.updateData(pe))}function lo(v,d,m,x,T,E,k,O,B,G,q,J,re,de,le,he){const{lineStartIndex:pe,glyphStartIndex:oe,segment:Ce}=O,xe=oe+O.numGlyphs,Ee=pe+O.lineLength,Le=d.getoffsetX(oe),Pe=d.getoffsetX(xe-1),Fe=Ur(v*Le,m,x,T,E,k,Ce,pe,Ee,B,G,q,J,re,!0,de,le,he);if(!Fe)return null;const $e=Ur(v*Pe,m,x,T,E,k,Ce,pe,Ee,B,G,q,J,re,!0,de,le,he);return $e?{first:Fe,last:$e}:null}function mi(v,d,m,x){return v===g.WritingMode.horizontal&&Math.abs(x)>Math.abs(m)?{useVertical:!0}:v===g.WritingMode.vertical?x>0?{needsFlipping:!0}:null:0!==d&&(0===(T=m)||Math.abs(x/T)>Qa)?1===d?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null;var T}function Yd(v,d,m,x,T,E,k,O,B,G,q,J,re,de,le,he,pe,oe,Ce){const xe=d/24,Ee=v.lineOffsetX*xe,Le=v.lineOffsetY*xe,{lineStartIndex:Pe,glyphStartIndex:Fe,numGlyphs:$e,segment:it,writingMode:rt,flipState:Vt}=v,Ze=Pe+v.lineLength,Tt=dt=>{if(q){const[ct,Dt,Ot]=dt.up,vn=G.length;g.updateGlobeVertexNormal(q,vn+0,ct,Dt,Ot),g.updateGlobeVertexNormal(q,vn+1,ct,Dt,Ot),g.updateGlobeVertexNormal(q,vn+2,ct,Dt,Ot),g.updateGlobeVertexNormal(q,vn+3,ct,Dt,Ot)}const[At,ot,je]=dt.point;g.addDynamicAttributes(G,At,ot,je,dt.angle)};if($e>1){const dt=lo(xe,O,Ee,Le,m,J,re,v,B,E,de,he,!1,pe,oe,Ce);if(!dt)return{notEnoughRoom:!0};if(x&&!m){let[At,ot,je]=dt.first.point,[ct,Dt,Ot]=dt.last.point;[At,ot]=Zt(At,ot,je,k),[ct,Dt]=Zt(ct,Dt,Ot,k);const vn=mi(rt,Vt,(ct-At)*le,Dt-ot);if(v.flipState=vn&&vn.needsFlipping?1:2,vn)return vn}Tt(dt.first);for(let At=Fe+1;At<Fe+$e-1;At++){const ot=Ur(xe*O.getoffsetX(At),Ee,Le,m,J,re,it,Pe,Ze,B,E,de,he,!1,!1,pe,oe,Ce);if(!ot)return G.length-=4*(At-Fe),{notEnoughRoom:!0};Tt(ot)}Tt(dt.last)}else{if(x&&!m){const At=Zt(re.x,re.y,0,T),ot=Pe+it+1,je=new g.pointGeometry(B.getx(ot),B.gety(ot)),ct=Zt(je.x,je.y,0,T),Dt=ct[3]>0?ct:qn(re,je,At,1,T,void 0,pe,oe.canonical),Ot=mi(rt,Vt,(Dt[0]-At[0])*le,Dt[1]-At[1]);if(v.flipState=Ot&&Ot.needsFlipping?1:2,Ot)return Ot}const dt=Ur(xe*O.getoffsetX(Fe),Ee,Le,m,J,re,it,Pe,Ze,B,E,de,he,!1,!1,pe,oe,Ce);if(!dt)return{notEnoughRoom:!0};Tt(dt)}return{}}function Ei(v,d,m,x,T){const{x:E,y:k,z:O}=x.projectTilePoint(v.x,v.y,d);if(!T)return Zt(E,k,O,m);const[B,G,q]=T(v);return Zt(E+B,k+G,O+q,m)}function qn(v,d,m,x,T,E,k,O){const B=Ei(v.sub(d)._unit()._add(v),O,T,k,E);return g.sub(B,m,B),g.normalize(B,B),g.scaleAndAdd(B,m,B,x)}function Ur(v,d,m,x,T,E,k,O,B,G,q,J,re,de,le,he,pe,oe){const Ce=x?v-d:v+d;let xe=Ce>0?1:-1,Ee=0;x&&(xe*=-1,Ee=Math.PI),xe<0&&(Ee+=Math.PI);let Le=O+k+(xe>0?0:1)|0,Pe=T,Fe=T,$e=0,it=0;const rt=Math.abs(Ce),Vt=[],Ze=[];let Tt=E,dt=Tt;const At=()=>qn(dt,Tt,Fe,rt-$e+1,q,re,he,pe.canonical);for(;$e+it<=rt;){if(Le+=xe,Le<O||Le>=B)return null;if(Fe=Pe,dt=Tt,Vt.push(Fe),de&&Ze.push(dt),Tt=new g.pointGeometry(G.getx(Le),G.gety(Le)),Pe=J[Le],!Pe){const Jt=Ei(Tt,pe.canonical,q,he,re);Pe=Jt[3]>0?J[Le]=Jt:At()}$e+=it,it=g.distance(Fe,Pe)}le&&re&&(J[Le]&&(Pe=At(),it=g.distance(Fe,Pe)),J[Le]=Pe);const ot=(rt-$e)/it,je=Tt.sub(dt)._mult(ot)._add(dt),ct=g.sub([],Pe,Fe),Dt=g.scaleAndAdd([],Fe,ct,ot);let Ot=[0,0,1],vn=ct[0],li=ct[1];if(oe&&(Ot=he.upVector(pe.canonical,je.x,je.y),0!==Ot[0]||0!==Ot[1]||1!==Ot[2])){const Jt=[Ot[2],0,-Ot[0]],Sn=g.cross([],Ot,Jt);g.normalize(Jt,Jt),g.normalize(Sn,Sn),vn=g.dot(ct,Jt),li=g.dot(ct,Sn)}if(m){const Jt=g.cross([],Ot,ct);g.normalize(Jt,Jt),g.scaleAndAdd(Dt,Dt,Jt,m*xe)}const hn=Ee+Math.atan2(li,vn);return Vt.push(Dt),de&&Ze.push(je),{point:Dt,angle:hn,path:Vt,tilePath:Ze,up:Ot}}function _o(v,d){const m=d.length,x=m+4*v;d.resize(x),d.float32.fill(-1/0,4*m,4*x)}function Wy(v,d,m){const x=d[0],T=d[1];return v[0]=m[0]*x+m[4]*T+m[12],v[1]=m[1]*x+m[5]*T+m[13],v[3]=m[3]*x+m[7]*T+m[15],v}const jr=100;class It{constructor(d,m,x=new qf(d.width+200,d.height+200,25),T=new qf(d.width+200,d.height+200,25)){this.transform=d,this.grid=x,this.ignoredGrid=T,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+jr,this.screenBottomBoundary=d.height+jr,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200,this.fogState=m}placeCollisionBox(d,m,x,T,E,k,O,B){let G=x.projectedAnchorX,q=x.projectedAnchorY,J=x.projectedAnchorZ;const re=x.elevation,de=x.tileID,le=d.getProjection();if(re&&de){const[Pe,Fe,$e]=le.upVector(de.canonical,x.tileAnchorX,x.tileAnchorY),it=le.upVectorScale(de.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=Pe*re*it,q+=Fe*re*it,J+=$e*re*it}const he=this.projectAndGetPerspectiveRatio(O,G,q,J,x.tileID,"globe"===le.name||!!re||this.transform.pitch>0,le),pe=k*he.perspectiveRatio,oe=(x.x1*m+T.x-x.padding)*pe+he.point.x,Ce=(x.y1*m+T.y-x.padding)*pe+he.point.y,xe=(x.x2*m+T.x+x.padding)*pe+he.point.x,Ee=(x.y2*m+T.y+x.padding)*pe+he.point.y,Le=he.perspectiveRatio<=.55||he.occluded;return!this.isInsideGrid(oe,Ce,xe,Ee)||!E&&this.grid.hitTest(oe,Ce,xe,Ee,B)||Le?{box:[],offscreen:!1,occluded:he.occluded}:{box:[oe,Ce,xe,Ee],offscreen:this.isOffscreen(oe,Ce,xe,Ee),occluded:!1}}placeCollisionCircles(d,m,x,T,E,k,O,B,G,q,J,re,de,le,he){const pe=[],oe=this.transform.elevation,Ce=d.getProjection(),xe=oe?oe.getAtTileOffsetFunc(he,this.transform.center.lat,this.transform.worldSize,Ce):null,Ee=new g.pointGeometry(x.tileAnchorX,x.tileAnchorY);let{x:Le,y:Pe,z:Fe}=Ce.projectTilePoint(Ee.x,Ee.y,he.canonical);if(xe){const[je,ct,Dt]=xe(Ee);Le+=je,Pe+=ct,Fe+=Dt}const $e="globe"===Ce.name,it=this.projectAndGetPerspectiveRatio(O,Le,Pe,Fe,he,$e||!!oe||this.transform.pitch>0,Ce),{perspectiveRatio:rt}=it,Vt=(J?k/rt:k*rt)/g.ONE_EM,Ze=Zt(Le,Pe,Fe,B),Tt=it.signedDistanceFromCamera>0?lo(Vt,E,x.lineOffsetX*Vt,x.lineOffsetY*Vt,!1,Ze,Ee,x,T,B,{},oe&&!J?xe:null,J&&!!oe,Ce,he,J):null;let dt=!1,At=!1,ot=!0;if(Tt&&!it.occluded){const je=.5*de*rt+le,ct=new g.pointGeometry(-100,-100),Dt=new g.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Ot=new Yl,{first:vn,last:li}=Tt,hn=vn.path.length;let Jt=[];for(let In=hn-1;In>=1;In--)Jt.push(vn.path[In]);for(let In=1;In<li.path.length;In++)Jt.push(li.path[In]);const Sn=2.5*je;G&&(Jt=Jt.map(([In,Yi,Qi],yo)=>(xe&&!$e&&(Qi=xe(yo<hn-1?vn.tilePath[hn-1-yo]:li.tilePath[yo-hn+2])[2]),Zt(In,Yi,Qi,G))),Jt.some(In=>In[3]<=0)&&(Jt=[]));let Ci=[];if(Jt.length>0){let In=1/0,Yi=-1/0,Qi=1/0,yo=-1/0;for(const io of Jt)In=Math.min(In,io[0]),Qi=Math.min(Qi,io[1]),Yi=Math.max(Yi,io[0]),yo=Math.max(yo,io[1]);Yi>=ct.x&&In<=Dt.x&&yo>=ct.y&&Qi<=Dt.y&&(Ci=[Jt.map(io=>new g.pointGeometry(io[0],io[1]))],(In<ct.x||Yi>Dt.x||Qi<ct.y||yo>Dt.y)&&(Ci=g.clipLine(Ci,ct.x,ct.y,Dt.x,Dt.y)))}for(const In of Ci){Ot.reset(In,.25*je);let Yi=0;Yi=Ot.length<=.5*je?1:Math.ceil(Ot.paddedLength/Sn)+1;for(let Qi=0;Qi<Yi;Qi++){const yo=Qi/Math.max(Yi-1,1),io=Ot.lerp(yo),cr=io.x+jr,ys=io.y+jr;pe.push(cr,ys,je,0);const la=cr-je,Pl=ys-je,Gi=cr+je,bo=ys+je;if(ot=ot&&this.isOffscreen(la,Pl,Gi,bo),At=At||this.isInsideGrid(la,Pl,Gi,bo),!m&&this.grid.hitTestCircle(cr,ys,je,re)&&(dt=!0,!q))return{circles:[],offscreen:!1,collisionDetected:dt,occluded:!1}}}}return{circles:!q&&dt||!At?[]:pe,offscreen:ot,collisionDetected:dt,occluded:it.occluded}}queryRenderedSymbols(d){if(0===d.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const m=[];let x=1/0,T=1/0,E=-1/0,k=-1/0;for(const q of d){const J=new g.pointGeometry(q.x+jr,q.y+jr);x=Math.min(x,J.x),T=Math.min(T,J.y),E=Math.max(E,J.x),k=Math.max(k,J.y),m.push(J)}const O=this.grid.query(x,T,E,k).concat(this.ignoredGrid.query(x,T,E,k)),B={},G={};for(const q of O){const J=q.key;if(void 0===B[J.bucketInstanceId]&&(B[J.bucketInstanceId]={}),B[J.bucketInstanceId][J.featureIndex])continue;const re=[new g.pointGeometry(q.x1,q.y1),new g.pointGeometry(q.x2,q.y1),new g.pointGeometry(q.x2,q.y2),new g.pointGeometry(q.x1,q.y2)];g.polygonIntersectsPolygon(m,re)&&(B[J.bucketInstanceId][J.featureIndex]=!0,void 0===G[J.bucketInstanceId]&&(G[J.bucketInstanceId]=[]),G[J.bucketInstanceId].push(J.featureIndex))}return G}insertCollisionBox(d,m,x,T,E){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:T,collisionGroupID:E},d[0],d[1],d[2],d[3])}insertCollisionCircles(d,m,x,T,E){const k=m?this.ignoredGrid:this.grid,O={bucketInstanceId:x,featureIndex:T,collisionGroupID:E};for(let B=0;B<d.length;B+=4)k.insertCircle(O,d[B],d[B+1],d[B+2])}projectAndGetPerspectiveRatio(d,m,x,T,E,k,O){const B=[m,x,T,1];let G=!1;T||this.transform.pitch>0?(g.transformMat4$1(B,B,d),this.fogState&&E&&"globe"!==O.name&&(G=function(de,le,he,pe,oe,Ce){const xe=Ce.calculateFogTileMatrix(oe),Ee=[le,he,pe];return g.transformMat4(Ee,Ee,xe),na(de,Ee,Ce.pitch,Ce._fov)}(this.fogState,m,x,T,E.toUnwrapped(),this.transform)>.9)):Wy(B,B,d);const q=B[3];return{point:new g.pointGeometry((B[0]/q+1)/2*this.transform.width+jr,(-B[1]/q+1)/2*this.transform.height+jr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/q*.5,1.5),signedDistanceFromCamera:q,occluded:k&&B[2]>q||G}}isOffscreen(d,m,x,T){return x<jr||d>=this.screenRightBoundary||T<jr||m>this.screenBottomBoundary}isInsideGrid(d,m,x,T){return x>=0&&d<this.gridRightBoundary&&T>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const d=g.identity([]);return g.translate(d,d,[-100,-100,0]),d}}function Ja(v,d,m){const x=d.createTileMatrix(v,v.worldSize,m.toUnwrapped());return g.multiply(new Float32Array(16),v.projMatrix,x)}function hi(v,d,m){if(d.projection.name===m.projection.name)return v.projMatrix;const x=m.clone();return x.setProjection(d.projection),Ja(x,d.getProjection(),v)}function to(v,d,m){return d.name===m.projection.name?v.projMatrix:Ja(m,d,v)}class Qd{constructor(d,m,x,T){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?m:-m))):T&&x?1:0,this.placed=x}isHidden(){return 0===this.opacity&&!this.placed}}class ju{constructor(d,m,x,T,E,k=!1){this.text=new Qd(d?d.text:null,m,x,E),this.icon=new Qd(d?d.icon:null,m,T,E),this.clipped=k}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Hu{constructor(d,m,x,T=!1){this.text=d,this.icon=m,this.skipFade=x,this.clipped=T}}class $u{constructor(){this.invProjMatrix=g.create(),this.viewportMatrix=g.create(),this.circles=[]}}class Lo{constructor(d,m,x,T,E){this.bucketInstanceId=d,this.featureIndex=m,this.sourceLayerIndex=x,this.bucketIndex=T,this.tileID=E}}class tr{constructor(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}}get(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){const m=++this.maxGroupID;this.collisionGroups[d]={ID:m,predicate:x=>x.collisionGroupID===m}}return this.collisionGroups[d]}}function pp(v,d,m,x,T){const{horizontalAlign:E,verticalAlign:k}=g.getAnchorAlignment(v),O=-(E-.5)*d,B=-(k-.5)*m,G=g.evaluateVariableOffset(v,x);return new g.pointGeometry(O+G[0]*T,B+G[1]*T)}function fp(v,d,m,x,T){const E=new g.pointGeometry(v,d);return m&&E._rotate(x?T:-T),E}class nr{constructor(d,m,x,T,E){this.transform=d.clone(),this.projection=d.projection.name,this.collisionIndex=new It(this.transform,E),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new tr(x),this.collisionCircleArrays={},this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(d,m,x,T){const E=x.getBucket(m),k=x.latestFeatureIndex;if(!E||!k||m.id!==E.layerIds[0])return;const O=E.layers[0].layout,B=x.collisionBoxArray,G=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),q=x.tileSize/g.EXTENT,J=x.tileID.toUnwrapped();this.transform.setProjection(E.projection);const re=(de=x.tileID,le=E.getProjection(),he=this.transform,le.name===this.projection?he.calculateProjMatrix(de.toUnwrapped()):Ja(he,le,de));var de,le,he;const pe="map"===O.get("text-pitch-alignment"),oe="map"===O.get("text-rotation-alignment");m.compileFilter();const Ce=m.dynamicFilter(),xe=m.dynamicFilterNeedsFeature(),Ee=this.transform.calculatePixelsToTileUnitsMatrix(x),Le=er(re,x.tileID.canonical,pe,oe,this.transform,E.getProjection(),Ee);let Pe=null;if(pe){const it=Lc(re,x.tileID.canonical,pe,oe,this.transform,E.getProjection(),Ee);Pe=g.multiply([],this.transform.labelPlaneMatrix,it)}let Fe=null;Ce&&x.latestFeatureIndex&&(Fe={unwrappedTileID:J,dynamicFilter:Ce,dynamicFilterNeedsFeature:xe,featureIndex:x.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new Lo(E.bucketInstanceId,k,E.sourceLayerIndex,E.index,x.tileID);const $e={bucket:E,layout:O,posMatrix:re,textLabelPlaneMatrix:Le,labelToScreenMatrix:Pe,clippingData:Fe,scale:G,textPixelRatio:q,holdingForFade:x.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:g.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:g.evaluateSizeForZoom(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(T)for(const it of E.sortKeyRanges){const{sortKey:rt,symbolInstanceStart:Vt,symbolInstanceEnd:Ze}=it;d.push({sortKey:rt,symbolInstanceStart:Vt,symbolInstanceEnd:Ze,parameters:$e})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:$e})}attemptAnchorPlacement(d,m,x,T,E,k,O,B,G,q,J,re,de,le,he,pe,oe,Ce){const{textOffset0:xe,textOffset1:Ee,crossTileID:Le}=re,Pe=[xe,Ee],Fe=pp(d,x,T,Pe,E),$e=this.collisionIndex.placeCollisionBox(le,E,m,fp(Fe.x,Fe.y,k,O,this.transform.angle),J,B,G,q.predicate);if(pe){const it=le.getSymbolInstanceIconSize(Ce,this.transform.zoom,re.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(le,it,pe,fp(Fe.x,Fe.y,k,O,this.transform.angle),J,B,G,q.predicate).box.length)return}if($e.box.length>0){let it;return this.prevPlacement&&this.prevPlacement.variableOffsets[Le]&&this.prevPlacement.placements[Le]&&this.prevPlacement.placements[Le].text&&(it=this.prevPlacement.variableOffsets[Le].anchor),this.variableOffsets[Le]={textOffset:Pe,width:x,height:T,anchor:d,textScale:E,prevAnchor:it},this.markUsedJustification(le,d,re,he),le.allowVerticalPlacement&&(this.markUsedOrientation(le,he,re),this.placedOrientations[Le]=he),{shift:Fe,placedGlyphBoxes:$e}}}placeLayerBucketPart(d,m,x,T){const{bucket:E,layout:k,posMatrix:O,textLabelPlaneMatrix:B,labelToScreenMatrix:G,clippingData:q,textPixelRatio:J,holdingForFade:re,collisionBoxArray:de,partiallyEvaluatedTextSize:le,partiallyEvaluatedIconSize:he,collisionGroup:pe}=d.parameters,oe=k.get("text-optional"),Ce=k.get("icon-optional"),xe=k.get("text-allow-overlap"),Ee=k.get("icon-allow-overlap"),Le="map"===k.get("text-rotation-alignment"),Pe="map"===k.get("text-pitch-alignment"),Fe="none"!==k.get("icon-text-fit"),$e="viewport-y"===k.get("symbol-z-order");this.transform.setProjection(E.projection);let it=xe&&(Ee||!E.hasIconData()||Ce),rt=Ee&&(xe||!E.hasTextData()||oe);!E.collisionArrays&&de&&E.deserializeCollisionBoxes(de),x&&T&&E.updateCollisionDebugBuffers(this.transform.zoom,de);const Vt=(Ze,Tt,dt)=>{const{crossTileID:At,numVerticalGlyphVertices:ot}=Ze;if(q){const Gi={zoom:this.transform.zoom,pitch:this.transform.pitch};let bo=null;if(q.dynamicFilterNeedsFeature){const Pi=this.retainedQueryData[E.bucketInstanceId];bo=q.featureIndex.loadFeature({featureIndex:Ze.featureIndex,bucketIndex:Pi.bucketIndex,sourceLayerIndex:Pi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,q.dynamicFilter)(Gi,bo,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new g.pointGeometry(Ze.tileAnchorX,Ze.tileAnchorY),this.transform.calculateDistanceTileData(q.unwrappedTileID)))return this.placements[At]=new Hu(!1,!1,!1,!0),void(m[At]=!0)}if(m[At])return;if(re)return void(this.placements[At]=new Hu(!1,!1,!1));let je=!1,ct=!1,Dt=!0,Ot=!1,vn=!1,li=null,hn={box:null,offscreen:null,occluded:null},Jt={box:null,offscreen:null,occluded:null},Sn=null,Ci=null,In=null,Yi=0,Qi=0,yo=0;dt.textFeatureIndex?Yi=dt.textFeatureIndex:Ze.useRuntimeCollisionCircles&&(Yi=Ze.featureIndex),dt.verticalTextFeatureIndex&&(Qi=dt.verticalTextFeatureIndex);const io=Gi=>{Gi.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const bo=this.transform.elevation;(bo||Gi.elevation)&&(Gi.elevation=bo?bo.getAtTileOffset(Gi.tileID,Gi.tileAnchorX,Gi.tileAnchorY):0)},cr=dt.textBox;if(cr){io(cr);const Gi=Pi=>{let No=g.WritingMode.horizontal;if(E.allowVerticalPlacement&&!Pi&&this.prevPlacement){const Kr=this.prevPlacement.placedOrientations[At];Kr&&(this.placedOrientations[At]=Kr,No=Kr,this.markUsedOrientation(E,No,Ze))}return No},bo=(Pi,No)=>{if(E.allowVerticalPlacement&&ot>0&&dt.verticalTextBox){for(const Kr of E.writingModes)if(Kr===g.WritingMode.vertical?(hn=No(),Jt=hn):hn=Pi(),hn&&hn.box&&hn.box.length)break}else hn=Pi()};if(k.get("text-variable-anchor")){let Pi=k.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[At]){const xo=this.prevPlacement.variableOffsets[At];Pi.indexOf(xo.anchor)>0&&(Pi=Pi.filter(Pr=>Pr!==xo.anchor),Pi.unshift(xo.anchor))}const No=(xo,Pr,as)=>{const Ol=E.getSymbolInstanceTextSize(le,Ze,this.transform.zoom,Tt),Yc=(xo.x2-xo.x1)*Ol+2*xo.padding,Ls=(xo.y2-xo.y1)*Ol+2*xo.padding,Ws=Fe&&!Ee?Pr:null;Ws&&io(Ws);let Ll={box:[],offscreen:!1,occluded:!1};const ka=xe?2*Pi.length:Pi.length;for(let Rs=0;Rs<ka;++Rs){const cd=this.attemptAnchorPlacement(Pi[Rs%Pi.length],xo,Yc,Ls,Ol,Le,Pe,J,O,pe,Rs>=Pi.length,Ze,Tt,E,as,Ws,le,he);if(cd&&(Ll=cd.placedGlyphBoxes,Ll&&Ll.box&&Ll.box.length)){je=!0,li=cd.shift;break}}return Ll};bo(()=>No(cr,dt.iconBox,g.WritingMode.horizontal),()=>{const xo=dt.verticalTextBox;return xo&&io(xo),E.allowVerticalPlacement&&!(hn&&hn.box&&hn.box.length)&&ot>0&&xo?No(xo,dt.verticalIconBox,g.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),hn&&(je=hn.box,Dt=hn.offscreen,Ot=hn.occluded);const Kr=Gi(hn&&hn.box);if(!je&&this.prevPlacement){const xo=this.prevPlacement.variableOffsets[At];xo&&(this.variableOffsets[At]=xo,this.markUsedJustification(E,xo.anchor,Ze,Kr))}}else{const Pi=(No,Kr)=>{const xo=E.getSymbolInstanceTextSize(le,Ze,this.transform.zoom,Tt),Pr=this.collisionIndex.placeCollisionBox(E,xo,No,new g.pointGeometry(0,0),xe,J,O,pe.predicate);return Pr&&Pr.box&&Pr.box.length&&(this.markUsedOrientation(E,Kr,Ze),this.placedOrientations[At]=Kr),Pr};bo(()=>Pi(cr,g.WritingMode.horizontal),()=>{const No=dt.verticalTextBox;return E.allowVerticalPlacement&&ot>0&&No?(io(No),Pi(No,g.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Gi(hn&&hn.box&&hn.box.length)}}if(Sn=hn,je=Sn&&Sn.box&&Sn.box.length>0,Dt=Sn&&Sn.offscreen,Ot=Sn&&Sn.occluded,Ze.useRuntimeCollisionCircles){const Gi=E.text.placedSymbolArray.get(Ze.centerJustifiedTextSymbolIndex>=0?Ze.centerJustifiedTextSymbolIndex:Ze.verticalPlacedTextSymbolIndex),bo=g.evaluateSizeForFeature(E.textSizeData,le,Gi),Pi=k.get("text-padding");Ci=this.collisionIndex.placeCollisionCircles(E,xe,Gi,E.lineVertexArray,E.glyphOffsetArray,bo,O,B,G,x,Pe,pe.predicate,Ze.collisionCircleDiameter*bo/g.ONE_EM,Pi,this.retainedQueryData[E.bucketInstanceId].tileID),je=xe||Ci.circles.length>0&&!Ci.collisionDetected,Dt=Dt&&Ci.offscreen,Ot=Ci.occluded}if(dt.iconFeatureIndex&&(yo=dt.iconFeatureIndex),dt.iconBox){const Gi=bo=>{io(bo);const Pi=Fe&&li?fp(li.x,li.y,Le,Pe,this.transform.angle):new g.pointGeometry(0,0),No=E.getSymbolInstanceIconSize(he,this.transform.zoom,Ze.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,No,bo,Pi,Ee,J,O,pe.predicate)};Jt&&Jt.box&&Jt.box.length&&dt.verticalIconBox?(In=Gi(dt.verticalIconBox),ct=In.box.length>0):(In=Gi(dt.iconBox),ct=In.box.length>0),Dt=Dt&&In.offscreen,vn=In.occluded}const ys=oe||0===Ze.numHorizontalGlyphVertices&&0===ot,la=Ce||0===Ze.numIconVertices;if(ys||la?la?ys||(ct=ct&&je):je=ct&&je:ct=je=ct&&je,je&&Sn&&Sn.box&&this.collisionIndex.insertCollisionBox(Sn.box,k.get("text-ignore-placement"),E.bucketInstanceId,Jt&&Jt.box&&Qi?Qi:Yi,pe.ID),ct&&In&&this.collisionIndex.insertCollisionBox(In.box,k.get("icon-ignore-placement"),E.bucketInstanceId,yo,pe.ID),Ci&&(je&&this.collisionIndex.insertCollisionCircles(Ci.circles,k.get("text-ignore-placement"),E.bucketInstanceId,Yi,pe.ID),x)){const Gi=E.bucketInstanceId;let bo=this.collisionCircleArrays[Gi];void 0===bo&&(bo=this.collisionCircleArrays[Gi]=new $u);for(let Pi=0;Pi<Ci.circles.length;Pi+=4)bo.circles.push(Ci.circles[Pi+0]),bo.circles.push(Ci.circles[Pi+1]),bo.circles.push(Ci.circles[Pi+2]),bo.circles.push(Ci.collisionDetected?1:0)}const Pl="globe"!==E.projection.name;it=it&&(Pl||!Ot),rt=rt&&(Pl||!vn),this.placements[At]=new Hu(je||it,ct||rt,Dt||E.justReloaded),m[At]=!0};if($e){const Ze=E.getSortedSymbolIndexes(this.transform.angle);for(let Tt=Ze.length-1;Tt>=0;--Tt){const dt=Ze[Tt];Vt(E.symbolInstances.get(dt),dt,E.collisionArrays[dt])}}else for(let Ze=d.symbolInstanceStart;Ze<d.symbolInstanceEnd;Ze++)Vt(E.symbolInstances.get(Ze),Ze,E.collisionArrays[Ze]);if(x&&E.bucketInstanceId in this.collisionCircleArrays){const Ze=this.collisionCircleArrays[E.bucketInstanceId];g.invert(Ze.invProjMatrix,O),Ze.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(d,m,x,T){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:B,crossTileID:G}=x,q=g.getAnchorJustification(m),J=T===g.WritingMode.vertical?B:"left"===q?E:"center"===q?k:"right"===q?O:-1;E>=0&&(d.text.placedSymbolArray.get(E).crossTileID=J>=0&&E!==J?0:G),k>=0&&(d.text.placedSymbolArray.get(k).crossTileID=J>=0&&k!==J?0:G),O>=0&&(d.text.placedSymbolArray.get(O).crossTileID=J>=0&&O!==J?0:G),B>=0&&(d.text.placedSymbolArray.get(B).crossTileID=J>=0&&B!==J?0:G)}markUsedOrientation(d,m,x){const T=m===g.WritingMode.horizontal||m===g.WritingMode.horizontalOnly?m:0,E=m===g.WritingMode.vertical?m:0,{leftJustifiedTextSymbolIndex:k,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:B,verticalPlacedTextSymbolIndex:G}=x,q=d.text.placedSymbolArray;k>=0&&(q.get(k).placedOrientation=T),O>=0&&(q.get(O).placedOrientation=T),B>=0&&(q.get(B).placedOrientation=T),G>=0&&(q.get(G).placedOrientation=E)}commit(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let x=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const T=m?m.symbolFadeChange(d):1,E=m?m.opacities:{},k=m?m.variableOffsets:{},O=m?m.placedOrientations:{};for(const B in this.placements){const G=this.placements[B],q=E[B];q?(this.opacities[B]=new ju(q,T,G.text,G.icon,null,G.clipped),x=x||G.text!==q.text.placed||G.icon!==q.icon.placed):(this.opacities[B]=new ju(null,T,G.text,G.icon,G.skipFade,G.clipped),x=x||G.text||G.icon)}for(const B in E){const G=E[B];if(!this.opacities[B]){const q=new ju(G,T,!1,!1);q.isHidden()||(this.opacities[B]=q,x=x||G.text.placed||G.icon.placed)}}for(const B in k)this.variableOffsets[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.variableOffsets[B]=k[B]);for(const B in O)this.placedOrientations[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.placedOrientations[B]=O[B]);x?this.lastPlacementChangeTime=d:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:d)}updateLayerOpacities(d,m){const x={};for(const T of m){const E=T.getBucket(d);E&&T.latestFeatureIndex&&d.id===E.layerIds[0]&&this.updateBucketOpacities(E,x,T.collisionBoxArray)}}updateBucketOpacities(d,m,x){d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();const T=d.layers[0].layout,E=!!d.layers[0].dynamicFilter(),k=new ju(null,0,!1,!1,!0),O=T.get("text-allow-overlap"),B=T.get("icon-allow-overlap"),G=T.get("text-variable-anchor"),q="map"===T.get("text-rotation-alignment"),J="map"===T.get("text-pitch-alignment"),re="none"!==T.get("icon-text-fit"),de=new ju(null,0,O&&(B||!d.hasIconData()||T.get("icon-optional")),B&&(O||!d.hasTextData()||T.get("text-optional")),!0);!d.collisionArrays&&x&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(x);const le=(pe,oe,Ce)=>{for(let xe=0;xe<oe/4;xe++)pe.opacityVertexArray.emplaceBack(Ce)};let he=0;for(let pe=0;pe<d.symbolInstances.length;pe++){const oe=d.symbolInstances.get(pe),{numHorizontalGlyphVertices:Ce,numVerticalGlyphVertices:xe,crossTileID:Ee,numIconVertices:Le}=oe;let Pe=this.opacities[Ee];m[Ee]?Pe=k:Pe||(Pe=de,this.opacities[Ee]=Pe),m[Ee]=!0;const Fe=Ce>0||xe>0,$e=Le>0,it=this.placedOrientations[Ee],rt=it===g.WritingMode.vertical,Vt=it===g.WritingMode.horizontal||it===g.WritingMode.horizontalOnly;if(!Fe&&!$e||Pe.isHidden()||he++,Fe){const Ze=ms(Pe.text);le(d.text,Ce,rt?Zi:Ze),le(d.text,xe,Vt?Zi:Ze);const Tt=Pe.text.isHidden(),{leftJustifiedTextSymbolIndex:dt,centerJustifiedTextSymbolIndex:At,rightJustifiedTextSymbolIndex:ot,verticalPlacedTextSymbolIndex:je}=oe,ct=d.text.placedSymbolArray,Dt=Tt||rt?1:0;dt>=0&&(ct.get(dt).hidden=Dt),At>=0&&(ct.get(At).hidden=Dt),ot>=0&&(ct.get(ot).hidden=Dt),je>=0&&(ct.get(je).hidden=Tt||Vt?1:0);const Ot=this.variableOffsets[Ee];Ot&&this.markUsedJustification(d,Ot.anchor,oe,it);const vn=this.placedOrientations[Ee];vn&&(this.markUsedJustification(d,"left",oe,vn),this.markUsedOrientation(d,vn,oe))}if($e){const Ze=ms(Pe.icon),{placedIconSymbolIndex:Tt,verticalPlacedIconSymbolIndex:dt}=oe,At=d.icon.placedSymbolArray,ot=Pe.icon.isHidden()?1:0;Tt>=0&&(le(d.icon,Le,rt?Zi:Ze),At.get(Tt).hidden=ot),dt>=0&&(le(d.icon,oe.numVerticalIconVertices,Vt?Zi:Ze),At.get(dt).hidden=ot)}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){const Ze=d.collisionArrays[pe];if(Ze){let Tt=new g.pointGeometry(0,0),dt=!0;if(Ze.textBox||Ze.verticalTextBox){if(G){const ot=this.variableOffsets[Ee];ot?(Tt=pp(ot.anchor,ot.width,ot.height,ot.textOffset,ot.textScale),q&&Tt._rotate(J?this.transform.angle:-this.transform.angle)):dt=!1}E&&(dt=!Pe.clipped),Ze.textBox&&Ms(d.textCollisionBox.collisionVertexArray,Pe.text.placed,!dt||rt,Tt.x,Tt.y),Ze.verticalTextBox&&Ms(d.textCollisionBox.collisionVertexArray,Pe.text.placed,!dt||Vt,Tt.x,Tt.y)}const At=dt&&Boolean(!Vt&&Ze.verticalIconBox);Ze.iconBox&&Ms(d.iconCollisionBox.collisionVertexArray,Pe.icon.placed,At,re?Tt.x:0,re?Tt.y:0),Ze.verticalIconBox&&Ms(d.iconCollisionBox.collisionVertexArray,Pe.icon.placed,!At,re?Tt.x:0,re?Tt.y:0)}}}if(d.fullyClipped=0===he,d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){const pe=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=pe.invProjMatrix,d.placementViewportMatrix=pe.viewportMatrix,d.collisionCircleArray=pe.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}}symbolFadeChange(d){return 0===this.fadeDuration?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(d){return Math.max(0,(this.transform.zoom-d)/1.5)}hasTransitions(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(d,m){const x=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*x>d}setStale(){this.stale=!0}}function Ms(v,d,m,x,T){v.emplaceBack(d?1:0,m?1:0,x||0,T||0),v.emplaceBack(d?1:0,m?1:0,x||0,T||0),v.emplaceBack(d?1:0,m?1:0,x||0,T||0),v.emplaceBack(d?1:0,m?1:0,x||0,T||0)}const qy=Math.pow(2,25),Zf=Math.pow(2,24),gr=Math.pow(2,17),Jd=Math.pow(2,16),$g=Math.pow(2,9),eh=Math.pow(2,8),rs=Math.pow(2,1);function ms(v){if(0===v.opacity&&!v.placed)return 0;if(1===v.opacity&&v.placed)return 4294967295;const d=v.placed?1:0,m=Math.floor(127*v.opacity);return m*qy+d*Zf+m*gr+d*Jd+m*$g+d*eh+m*rs+d}const Zi=0;class Ql{constructor(d){this._sortAcrossTiles="viewport-y"!==d.layout.get("symbol-z-order")&&void 0!==d.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(d,m,x,T,E){const k=this._bucketParts;for(;this._currentTileIndex<d.length;)if(m.getBucketParts(k,T,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort((O,B)=>O.sortKey-B.sortKey));this._currentPartIndex<k.length;){const O=k[this._currentPartIndex];if(m.placeLayerBucketPart(O,this._seenCrossTileIDs,x,0===O.symbolInstanceStart),this._currentPartIndex++,E())return!0}return!1}}class mp{constructor(d,m,x,T,E,k,O,B){this.placement=new nr(d,E,k,O,B),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(d,m,x){const T=g.exported.now(),E=()=>{const k=g.exported.now()-T;return!this._forceFullPlacement&&k>2};for(;this._currentPlacementIndex>=0;){const k=m[d[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if("symbol"===k.type&&(!k.minzoom||k.minzoom<=O)&&(!k.maxzoom||k.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new Ql(k)),this._inProgressLayer.continuePlacement(x[k.source],this.placement,this._showCollisionBoxes,k,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(d){return this.placement.commit(d),this.placement}}const Kf=512/g.EXTENT/2;class tn{constructor(d,m,x){this.tileID=d,this.indexedSymbolInstances={},this.bucketInstanceId=x;for(let T=0;T<m.length;T++){const E=m.get(T),k=E.key;this.indexedSymbolInstances[k]||(this.indexedSymbolInstances[k]=[]),this.indexedSymbolInstances[k].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,d)})}}getScaledCoordinates(d,m){const x=Kf/Math.pow(2,m.canonical.z-this.tileID.canonical.z);return{x:Math.floor((m.canonical.x*g.EXTENT+d.tileAnchorX)*x),y:Math.floor((m.canonical.y*g.EXTENT+d.tileAnchorY)*x)}}findMatches(d,m,x){const T=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let E=0;E<d.length;E++){const k=d.get(E);if(k.crossTileID)continue;const O=this.indexedSymbolInstances[k.key];if(!O)continue;const B=this.getScaledCoordinates(k,m);for(const G of O)if(Math.abs(G.coord.x-B.x)<=T&&Math.abs(G.coord.y-B.y)<=T&&!x[G.crossTileID]){x[G.crossTileID]=!0,k.crossTileID=G.crossTileID;break}}}}class Gg{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class yn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(d){const m=Math.round((d-this.lng)/360);if(0!==m)for(const x in this.indexes){const T=this.indexes[x],E={};for(const k in T){const O=T[k];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+m),E[O.tileID.key]=O}this.indexes[x]=E}this.lng=d}addBucket(d,m,x){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(let E=0;E<m.symbolInstances.length;E++)m.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});const T=this.usedCrossTileIDs[d.overscaledZ];for(const E in this.indexes){const k=this.indexes[E];if(Number(E)>d.overscaledZ)for(const O in k){const B=k[O];B.tileID.isChildOf(d)&&B.findMatches(m.symbolInstances,d,T)}else{const O=k[d.scaledTo(Number(E)).key];O&&O.findMatches(m.symbolInstances,d,T)}}for(let E=0;E<m.symbolInstances.length;E++){const k=m.symbolInstances.get(E);k.crossTileID||(k.crossTileID=x.generate(),T[k.crossTileID]=!0)}return void 0===this.indexes[d.overscaledZ]&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new tn(d,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(d,m){for(const x in m.indexedSymbolInstances)for(const T of m.indexedSymbolInstances[x])delete this.usedCrossTileIDs[d][T.crossTileID]}removeStaleBuckets(d){let m=!1;for(const x in this.indexes){const T=this.indexes[x];for(const E in T)d[T[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,T[E]),delete T[E],m=!0)}return m}}class th{constructor(){this.layerIndexes={},this.crossTileIDs=new Gg,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(d,m,x,T){let E=this.layerIndexes[d.id];void 0===E&&(E=this.layerIndexes[d.id]=new yn);let k=!1;const O={};"globe"!==T.name&&E.handleWrapJump(x);for(const B of m){const G=B.getBucket(d);G&&d.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(B.tileID,G,this.crossTileIDs)&&(k=!0),O[G.bucketInstanceId]=!0)}return E.removeStaleBuckets(O)&&(k=!0),k}pruneUnusedLayers(d){const m={};d.forEach(x=>{m[x]=!0});for(const x in this.layerIndexes)m[x]||delete this.layerIndexes[x]}}const nh=(v,d)=>g.emitValidationErrors(v,d&&d.filter(m=>"source.canvas"!==m.identifier)),Rc=g.pick(Rn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Jl=g.pick(Rn,["setCenter","setZoom","setBearing","setPitch"]),gp={version:8,layers:[],sources:{}},Tl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class gs extends g.Evented{constructor(d,m={}){super(),this.map=d,this.dispatcher=new Us($n(),this),this.imageManager=new ln,this.imageManager.setEventedParent(this),this.glyphManager=new g.GlyphManager(d._requestManager,m.localFontFamily?g.LocalGlyphMode.all:m.localIdeographFontFamily?g.LocalGlyphMode.ideographs:g.LocalGlyphMode.none,m.localFontFamily||m.localIdeographFontFamily),this.crossTileSymbolIndex=new th,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",g.getReferrer());const x=this;this._rtlTextPluginCallback=gs.registerForPluginStateChange(T=>{x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},(E,k)=>{if(g.triggerPluginCompletionEvent(E),k&&k.every(O=>O))for(const O in x._sourceCaches){const B=x._sourceCaches[O],G=B.getSource().type;"vector"!==G&&"geojson"!==G||B.reload()}})}),this.on("data",T=>{if("source"!==T.dataType||"metadata"!==T.sourceDataType)return;const E=this.getSource(T.sourceId);if(E&&E.vectorLayerIds)for(const k in this._layers){const O=this._layers[k];O.source===E.id&&this._validateLayer(O)}})}loadURL(d,m={}){this.fire(new g.Event("dataloading",{dataType:"style"}));const x="boolean"==typeof m.validate?m.validate:!g.isMapboxURL(d);d=this.map._requestManager.normalizeStyleURL(d,m.accessToken);const T=this.map._requestManager.transformRequest(d,g.ResourceType.Style);this._request=g.getJSON(T,(E,k)=>{this._request=null,E?this.fire(new g.ErrorEvent(E)):k&&this._load(k,x)})}loadJSON(d,m={}){this.fire(new g.Event("dataloading",{dataType:"style"})),this._request=g.exported.frame(()=>{this._request=null,this._load(d,!1!==m.validate)})}loadEmpty(){this.fire(new g.Event("dataloading",{dataType:"style"})),this._load(gp,!1)}_updateLayerCount(d,m){const x=m?1:-1;d.is3D()&&(this._num3DLayers+=x),"circle"===d.type&&(this._numCircleLayers+=x),"symbol"===d.type&&(this._numSymbolLayers+=x)}_load(d,m){if(m&&nh(this,g.validateStyle(d)))return;this._loaded=!0,this.stylesheet=g.clone$1(d),this._updateMapProjection();for(const T in d.sources)this.addSource(T,d.sources[T],{validate:!1});this._changed=!1,d.sprite?this._loadSprite(d.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(d.glyphs);const x=Vi(this.stylesheet.layers);this._order=x.map(T=>T.id),this._layers={},this._serializedLayers={};for(let T of x)T=g.createStyleLayer(T),T.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ao(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new g.Event("data",{dataType:"style"})),this.fire(new g.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(d){d?this.stylesheet.projection=d:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(d){this._spriteRequest=function(m,x,T){let E,k,O;const B=g.exported.devicePixelRatio>1?"@2x":"";let G=g.getJSON(x.transformRequest(x.normalizeSpriteURL(m,B,".json"),g.ResourceType.SpriteJSON),(re,de)=>{G=null,O||(O=re,E=de,J())}),q=g.getImage(x.transformRequest(x.normalizeSpriteURL(m,B,".png"),g.ResourceType.SpriteImage),(re,de)=>{q=null,O||(O=re,k=de,J())});function J(){if(O)T(O);else if(E&&k){const re=g.exported.getImageData(k),de={};for(const le in E){const{width:he,height:pe,x:oe,y:Ce,sdf:xe,pixelRatio:Ee,stretchX:Le,stretchY:Pe,content:Fe}=E[le],$e=new g.RGBAImage({width:he,height:pe});g.RGBAImage.copy(re,$e,{x:oe,y:Ce},{x:0,y:0},{width:he,height:pe}),de[le]={data:$e,pixelRatio:Ee,sdf:xe,stretchX:Le,stretchY:Pe,content:Fe}}T(null,de)}}return{cancel(){G&&(G.cancel(),G=null),q&&(q.cancel(),q=null)}}}(d,this.map._requestManager,(m,x)=>{if(this._spriteRequest=null,m)this.fire(new g.ErrorEvent(m));else if(x)for(const T in x)this.imageManager.addImage(T,x[T]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new g.Event("data",{dataType:"style"}))})}_validateLayer(d){const m=this.getSource(d.source);if(!m)return;const x=d.sourceLayer;x&&("geojson"===m.type||m.vectorLayerIds&&-1===m.vectorLayerIds.indexOf(x))&&this.fire(new g.ErrorEvent(new Error(`Source layer "${x}" does not exist on source "${m.id}" as specified by style layer "${d.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const d in this._sourceCaches)if(!this._sourceCaches[d].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(d){const m=[];for(const x of d){const T=this._layers[x];"custom"!==T.type&&m.push(T.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const d in this._sourceCaches)if(this._sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(d){return!!this.terrain&&("function"==typeof d.isLayerDraped?d.isLayerDraped():Tl[d.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(d){if(!this._loaded)return;const m=this._changed;if(this._changed){const T=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(T.length||E.length)&&this._updateWorkerLayers(T,E);for(const k in this._updatedSources){const O=this._updatedSources[k];"reload"===O?this._reloadSource(k):"clear"===O&&this._clearSource(k)}this._updateTilesForChangedImages();for(const k in this._updatedPaintProps)this._layers[k].updateTransitions(d);this.light.updateTransitions(d),this.fog&&this.fog.updateTransitions(d),this._resetUpdates()}const x={};for(const T in this._sourceCaches){const E=this._sourceCaches[T];x[T]=E.used,E.used=!1}for(const T of this._order){const E=this._layers[T];if(E.recalculate(d,this._availableImages),!E.isHidden(d.zoom)){const O=this._getLayerSourceCache(E);O&&(O.used=!0)}const k=this.map.painter;if(k){const O=E.getProgramIds();if(!O)continue;const B=E.getProgramConfiguration(d.zoom);for(const G of O)k.useProgram(G,B)}}for(const T in x){const E=this._sourceCaches[T];x[T]!==E.used&&E.getSource().fire(new g.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E.getSource().id}))}this.light.recalculate(d),this.terrain&&this.terrain.recalculate(d),this.fog&&this.fog.recalculate(d),this.z=d.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new g.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const d=Object.keys(this._changedImages);if(d.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],d);this._changedImages={}}}_updateWorkerLayers(d,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(d),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(d){if(this._checkLoaded(),nh(this,g.validateStyle(d)))return!1;(d=g.clone$1(d)).layers=Vi(d.layers);const m=function(T,E){if(!T)return[{command:Rn.setStyle,args:[E]}];let k=[];try{if(!se(T.version,E.version))return[{command:Rn.setStyle,args:[E]}];se(T.center,E.center)||k.push({command:Rn.setCenter,args:[E.center]}),se(T.zoom,E.zoom)||k.push({command:Rn.setZoom,args:[E.zoom]}),se(T.bearing,E.bearing)||k.push({command:Rn.setBearing,args:[E.bearing]}),se(T.pitch,E.pitch)||k.push({command:Rn.setPitch,args:[E.pitch]}),se(T.sprite,E.sprite)||k.push({command:Rn.setSprite,args:[E.sprite]}),se(T.glyphs,E.glyphs)||k.push({command:Rn.setGlyphs,args:[E.glyphs]}),se(T.transition,E.transition)||k.push({command:Rn.setTransition,args:[E.transition]}),se(T.light,E.light)||k.push({command:Rn.setLight,args:[E.light]}),se(T.fog,E.fog)||k.push({command:Rn.setFog,args:[E.fog]}),se(T.projection,E.projection)||k.push({command:Rn.setProjection,args:[E.projection]});const O={},B=[];!function(J,re,de,le){let he;for(he in re=re||{},J=J||{})J.hasOwnProperty(he)&&(re.hasOwnProperty(he)||go(he,de,le));for(he in re)re.hasOwnProperty(he)&&(J.hasOwnProperty(he)?se(J[he],re[he])||("geojson"===J[he].type&&"geojson"===re[he].type&&Ya(J,re,he)?de.push({command:Rn.setGeoJSONSourceData,args:[he,re[he].data]}):wl(he,re,de,le)):qi(he,re,de))}(T.sources,E.sources,B,O);const G=[];T.layers&&T.layers.forEach(J=>{J.source&&O[J.source]?k.push({command:Rn.removeLayer,args:[J.id]}):G.push(J)});let q=T.terrain;q&&O[q.source]&&(k.push({command:Rn.setTerrain,args:[void 0]}),q=void 0),k=k.concat(B),se(q,E.terrain)||k.push({command:Rn.setTerrain,args:[E.terrain]}),function(J,re,de){re=re||[];const le=(J=J||[]).map(Cl),he=re.map(Cl),pe=J.reduce(Jo,{}),oe=re.reduce(Jo,{}),Ce=le.slice(),xe=Object.create(null);let Ee,Le,Pe,Fe,$e,it,rt;for(Ee=0,Le=0;Ee<le.length;Ee++)Pe=le[Ee],oe.hasOwnProperty(Pe)?Le++:(de.push({command:Rn.removeLayer,args:[Pe]}),Ce.splice(Ce.indexOf(Pe,Le),1));for(Ee=0,Le=0;Ee<he.length;Ee++)Pe=he[he.length-1-Ee],Ce[Ce.length-1-Ee]!==Pe&&(pe.hasOwnProperty(Pe)?(de.push({command:Rn.removeLayer,args:[Pe]}),Ce.splice(Ce.lastIndexOf(Pe,Ce.length-Le),1)):Le++,it=Ce[Ce.length-Ee],de.push({command:Rn.addLayer,args:[oe[Pe],it]}),Ce.splice(Ce.length-Ee,0,Pe),xe[Pe]=!0);for(Ee=0;Ee<he.length;Ee++)if(Pe=he[Ee],Fe=pe[Pe],$e=oe[Pe],!xe[Pe]&&!se(Fe,$e))if(se(Fe.source,$e.source)&&se(Fe["source-layer"],$e["source-layer"])&&se(Fe.type,$e.type)){for(rt in yt(Fe.layout,$e.layout,de,Pe,null,Rn.setLayoutProperty),yt(Fe.paint,$e.paint,de,Pe,null,Rn.setPaintProperty),se(Fe.filter,$e.filter)||de.push({command:Rn.setFilter,args:[Pe,$e.filter]}),se(Fe.minzoom,$e.minzoom)&&se(Fe.maxzoom,$e.maxzoom)||de.push({command:Rn.setLayerZoomRange,args:[Pe,$e.minzoom,$e.maxzoom]}),Fe)Fe.hasOwnProperty(rt)&&"layout"!==rt&&"paint"!==rt&&"filter"!==rt&&"metadata"!==rt&&"minzoom"!==rt&&"maxzoom"!==rt&&(0===rt.indexOf("paint.")?yt(Fe[rt],$e[rt],de,Pe,rt.slice(6),Rn.setPaintProperty):se(Fe[rt],$e[rt])||de.push({command:Rn.setLayerProperty,args:[Pe,rt,$e[rt]]}));for(rt in $e)$e.hasOwnProperty(rt)&&!Fe.hasOwnProperty(rt)&&"layout"!==rt&&"paint"!==rt&&"filter"!==rt&&"metadata"!==rt&&"minzoom"!==rt&&"maxzoom"!==rt&&(0===rt.indexOf("paint.")?yt(Fe[rt],$e[rt],de,Pe,rt.slice(6),Rn.setPaintProperty):se(Fe[rt],$e[rt])||de.push({command:Rn.setLayerProperty,args:[Pe,rt,$e[rt]]}))}else de.push({command:Rn.removeLayer,args:[Pe]}),it=Ce[Ce.lastIndexOf(Pe)+1],de.push({command:Rn.addLayer,args:[$e,it]})}(G,E.layers,k)}catch(O){console.warn("Unable to compute style diff:",O),k=[{command:Rn.setStyle,args:[E]}]}return k}(this.serialize(),d).filter(T=>!(T.command in Jl));if(0===m.length)return!1;const x=m.filter(T=>!(T.command in Rc));if(x.length>0)throw new Error(`Unimplemented: ${x.map(T=>T.command).join(", ")}.`);return m.forEach(T=>{"setTransition"!==T.command&&"setProjection"!==T.command&&this[T.command].apply(this,T.args)}),this.stylesheet=d,this._updateMapProjection(),!0}addImage(d,m){return this.getImage(d)?this.fire(new g.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(d,m),this._afterImageUpdated(d),this)}updateImage(d,m){this.imageManager.updateImage(d,m)}getImage(d){return this.imageManager.getImage(d)}removeImage(d){return this.getImage(d)?(this.imageManager.removeImage(d),this._afterImageUpdated(d),this):this.fire(new g.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(d){this._availableImages=this.imageManager.listImages(),this._changedImages[d]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new g.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(d,m,x={}){if(this._checkLoaded(),void 0!==this.getSource(d))throw new Error("There is already a source with this ID");if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(g.validateSource,`sources.${d}`,m,null,x))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const T=We(d,m,this.dispatcher,this);T.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(d),source:T.serialize(),sourceId:d}));const E=k=>{const O=(k?"symbol:":"other:")+d,B=this._sourceCaches[O]=new g.SourceCache(O,T,k);(k?this._symbolSourceCaches:this._otherSourceCaches)[d]=B,B.style=this,B.onAdd(this.map)};E(!1),"vector"!==m.type&&"geojson"!==m.type||E(!0),T.onAdd&&T.onAdd(this.map),this._changed=!0}removeSource(d){this._checkLoaded();const m=this.getSource(d);if(!m)throw new Error("There is no source with this ID");for(const T in this._layers)if(this._layers[T].source===d)return this.fire(new g.ErrorEvent(new Error(`Source "${d}" cannot be removed while layer "${T}" is using it.`)));if(this.terrain&&this.terrain.get().source===d)return this.fire(new g.ErrorEvent(new Error(`Source "${d}" cannot be removed while terrain is using it.`)));const x=this._getSourceCaches(d);for(const T of x)delete this._sourceCaches[T.id],delete this._updatedSources[T.id],T.fire(new g.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:T.getSource().id})),T.setEventedParent(null),T.clearTiles();return delete this._otherSourceCaches[d],delete this._symbolSourceCaches[d],m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(d,m){this._checkLoaded(),this.getSource(d).setData(m),this._changed=!0}getSource(d){const m=this._getSourceCache(d);return m&&m.getSource()}_getSources(){const d=[];for(const m in this._otherSourceCaches){const x=this._getSourceCache(m);x&&d.push(x.getSource())}return d}addLayer(d,m,x={}){this._checkLoaded();const T=d.id;if(this.getLayer(T))return void this.fire(new g.ErrorEvent(new Error(`Layer with id "${T}" already exists on this map`)));let E;if("custom"===d.type){if(nh(this,g.validateCustomStyleLayer(d)))return;E=g.createStyleLayer(d)}else{if("object"==typeof d.source&&(this.addSource(T,d.source),d=g.clone$1(d),d=g.extend(d,{source:T})),this._validate(g.validateLayer,`layers.${T}`,d,{arrayIndex:-1},x))return;E=g.createStyleLayer(d),this._validateLayer(E),E.setEventedParent(this,{layer:{id:T}}),this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}const k=m?this._order.indexOf(m):this._order.length;if(m&&-1===k)return void this.fire(new g.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`)));this._order.splice(k,0,T),this._layerOrderChanged=!0,this._layers[T]=E;const O=this._getLayerSourceCache(E);if(this._removedLayers[T]&&E.source&&O&&"custom"!==E.type){const B=this._removedLayers[T];delete this._removedLayers[T],B.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",O.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(d,m){if(this._checkLoaded(),this._changed=!0,!this._layers[d])return void this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be moved.`)));if(d===m)return;const x=this._order.indexOf(d);this._order.splice(x,1);const T=m?this._order.indexOf(m):this._order.length;m&&-1===T?this.fire(new g.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`))):(this._order.splice(T,0,d),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(d){this._checkLoaded();const m=this._layers[d];if(!m)return void this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be removed.`)));m.setEventedParent(null),this._updateLayerCount(m,!1);const x=this._order.indexOf(d);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[d]=m,delete this._layers[d],delete this._serializedLayers[d],delete this._updatedLayers[d],delete this._updatedPaintProps[d],m.onRemove&&m.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(d){return this._layers[d]}hasLayer(d){return d in this._layers}hasLayerType(d){for(const m in this._layers)if(this._layers[m].type===d)return!0;return!1}setLayerZoomRange(d,m,x){this._checkLoaded();const T=this.getLayer(d);T?T.minzoom===m&&T.maxzoom===x||(null!=m&&(T.minzoom=m),null!=x&&(T.maxzoom=x),this._updateLayer(T)):this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(d,m,x={}){this._checkLoaded();const T=this.getLayer(d);if(T){if(!se(T.filter,m))return null==m?(T.filter=void 0,void this._updateLayer(T)):void(this._validate(g.validateFilter,`layers.${T.id}.filter`,m,{layerType:T.type},x)||(T.filter=g.clone$1(m),this._updateLayer(T)))}else this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be filtered.`)))}getFilter(d){const m=this.getLayer(d);return m&&g.clone$1(m.filter)}setLayoutProperty(d,m,x,T={}){this._checkLoaded();const E=this.getLayer(d);E?se(E.getLayoutProperty(m),x)||(E.setLayoutProperty(m,x,T),this._updateLayer(E)):this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(d,m){const x=this.getLayer(d);if(x)return x.getLayoutProperty(m);this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style.`)))}setPaintProperty(d,m,x,T={}){this._checkLoaded();const E=this.getLayer(d);E?se(E.getPaintProperty(m),x)||(E.setPaintProperty(m,x,T)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[d]=!0):this.fire(new g.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(d,m){const x=this.getLayer(d);return x&&x.getPaintProperty(m)}setFeatureState(d,m){this._checkLoaded();const x=d.source,T=d.sourceLayer,E=this.getSource(x);if(!E)return void this.fire(new g.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const k=E.type;if("geojson"===k&&T)return void this.fire(new g.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===k&&!T)return void this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===d.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(x);for(const B of O)B.setFeatureState(T,d.id,m)}removeFeatureState(d,m){this._checkLoaded();const x=d.source,T=this.getSource(x);if(!T)return void this.fire(new g.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const E=T.type,k="vector"===E?d.sourceLayer:void 0;if("vector"===E&&!k)return void this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&"string"!=typeof d.id&&"number"!=typeof d.id)return void this.fire(new g.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(x);for(const B of O)B.removeFeatureState(k,d.id,m)}getFeatureState(d){this._checkLoaded();const m=d.source,x=d.sourceLayer,T=this.getSource(m);if(T){if("vector"!==T.type||x)return void 0===d.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(m)[0].getFeatureState(x,d.id);this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new g.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return g.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const d={};for(const m in this._sourceCaches){const x=this._sourceCaches[m].getSource();d[x.id]||(d[x.id]=x.serialize())}return g.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:d,layers:this._serializeLayers(this._order)},m=>void 0!==m)}_updateLayer(d){this._updatedLayers[d.id]=!0;const m=this._getLayerSourceCache(d);d.source&&!this._updatedSources[d.source]&&m&&"raster"!==m.getSource().type&&(this._updatedSources[d.source]="reload",m.pause()),this._changed=!0,d.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(d){const m=k=>"fill-extrusion"===this._layers[k].type,x={},T=[];for(let k=this._order.length-1;k>=0;k--){const O=this._order[k];if(m(O)){x[O]=k;for(const B of d){const G=B[O];if(G)for(const q of G)T.push(q)}}}T.sort((k,O)=>O.intersectionZ-k.intersectionZ);const E=[];for(let k=this._order.length-1;k>=0;k--){const O=this._order[k];if(m(O))for(let B=T.length-1;B>=0;B--){const G=T[B].feature;if(x[G.layer.id]<k)break;E.push(G),T.pop()}else for(const B of d){const G=B[O];if(G)for(const q of G)E.push(q.feature)}}return E}queryRenderedFeatures(d,m,x){m&&m.filter&&this._validate(g.validateFilter,"queryRenderedFeatures.filter",m.filter,null,m);const T={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new g.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const B of m.layers){const G=this._layers[B];if(!G)return this.fire(new g.ErrorEvent(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];T[G.source]=!0}}const E=[];m.availableImages=this._availableImages;const k=m&&m.layers?m.layers.some(B=>{const G=this.getLayer(B);return G&&G.is3D()}):this.has3DLayers(),O=si.createFromScreenPoints(d,x);for(const B in this._sourceCaches){const G=this._sourceCaches[B].getSource().id;m.layers&&!T[G]||E.push(nt(this._sourceCaches[B],this._layers,this._serializedLayers,O,m,x,k,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(B,G,q,J,re,de,le){const he={},pe=de.queryRenderedSymbols(J),oe=[];for(const Ce of Object.keys(pe).map(Number))oe.push(le[Ce]);oe.sort(nn);for(const Ce of oe){const xe=Ce.featureIndex.lookupSymbolFeatures(pe[Ce.bucketInstanceId],G,Ce.bucketIndex,Ce.sourceLayerIndex,re.filter,re.layers,re.availableImages,B);for(const Ee in xe){const Le=he[Ee]=he[Ee]||[],Pe=xe[Ee];Pe.sort((Fe,$e)=>{const it=Ce.featureSortOrder;if(it){const rt=it.indexOf(Fe.featureIndex);return it.indexOf($e.featureIndex)-rt}return $e.featureIndex-Fe.featureIndex});for(const Fe of Pe)Le.push(Fe)}}for(const Ce in he)he[Ce].forEach(xe=>{const Ee=xe.feature,Le=q(B[Ce]).getFeatureState(Ee.layer["source-layer"],Ee.id);Ee.source=Ee.layer.source,Ee.layer["source-layer"]&&(Ee.sourceLayer=Ee.layer["source-layer"]),Ee.state=Le});return he}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(d,m){m&&m.filter&&this._validate(g.validateFilter,"querySourceFeatures.filter",m.filter,null,m);const x=this._getSourceCaches(d);let T=[];for(const E of x)T=T.concat(Ct(E,m));return T}addSourceType(d,m,x){return gs.getSourceType(d)?x(new Error(`A source type called "${d}" already exists.`)):(gs.setSourceType(d,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:d,url:m.workerSourceURL},x):x(null,null))}getLight(){return this.light.getLight()}setLight(d,m={}){this._checkLoaded();const x=this.light.getLight();let T=!1;for(const k in d)if(!se(d[k],x[k])){T=!0;break}if(!T)return;const E=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(d,m),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(d,m=1){if(this._checkLoaded(),!d)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===m){if("object"==typeof d.source){const x="terrain-dem-src";this.addSource(x,d.source),d=g.clone$1(d),d=g.extend(d,{source:x})}if(this._validate(g.validateTerrain,"terrain",d))return}if(!this.terrain||this.terrain&&m!==this.terrain.drapeRenderMode)this._createTerrain(d,m);else{const x=this.terrain,T=x.get();for(const E of Object.keys(g.spec.terrain))!d.hasOwnProperty(E)&&g.spec.terrain[E].default&&(d[E]=g.spec.terrain[E].default);for(const E in d)if(!se(d[E],T[E])){x.set(d),this.stylesheet.terrain=d;const k=this._setTransitionParameters({duration:0});x.updateTransitions(k);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(d){const m=this.fog=new Gl(d,this.map.transform);this.stylesheet.fog=d;const x=this._setTransitionParameters({duration:0});m.updateTransitions(x)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const d of this.map._markers)d._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(d){if(this._checkLoaded(),!d)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog,x=m.get();0===Object.keys(d).length&&m.set(d);for(const T in d)if(!se(d[T],x[T])){m.set(d),this.stylesheet.fog=d;const E=this._setTransitionParameters({duration:0});m.updateTransitions(E);break}}else this._createFog(d);this._markersNeedUpdate=!0}_setTransitionParameters(d){return{now:g.exported.now(),transition:g.extend(d,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const d=this._order.filter(x=>this.isLayerDraped(this._layers[x])),m=this._order.filter(x=>!this.isLayerDraped(this._layers[x]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...d),this._drapedFirstOrder.push(...m)}_createTerrain(d,m){const x=this.terrain=new mr(d,m);this.stylesheet.terrain=d,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const T=this._setTransitionParameters({duration:0});x.updateTransitions(T)}_force3DLayerUpdate(){for(const d in this._layers){const m=this._layers[d];"fill-extrusion"===m.type&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const d in this._layers){const m=this._layers[d];"symbol"===m.type&&this._updateLayer(m)}}_validate(d,m,x,T,E={}){return(!E||!1!==E.validate)&&nh(this,d.call(g.validateStyle,g.extend({key:m,style:this.serialize(),value:x,styleSpec:g.spec},T)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),g.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this._sourceCaches)this._sourceCaches[d].clearTiles(),this._sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(d){const m=this._getSourceCaches(d);for(const x of m)x.clearTiles()}_reloadSource(d){const m=this._getSourceCaches(d);for(const x of m)x.resume(),x.reload()}_reloadSources(){for(const d of this._getSources())d.reload&&d.reload()}_updateSources(d){for(const m in this._sourceCaches)this._sourceCaches[m].update(d)}_generateCollisionBoxes(){for(const d in this._sourceCaches){const m=this._sourceCaches[d];m.resume(),m.reload()}}_updatePlacement(d,m,x,T,E=!1){let k=!1,O=!1;const B={};for(const G of this._order){const q=this._layers[G];if("symbol"!==q.type)continue;if(!B[q.source]){const re=this._getLayerSourceCache(q);if(!re)continue;B[q.source]=re.getRenderableIds(!0).map(de=>re.getTileByID(de)).sort((de,le)=>le.tileID.overscaledZ-de.tileID.overscaledZ||(de.tileID.isLessThan(le.tileID)?-1:1))}const J=this.crossTileSymbolIndex.addLayer(q,B[q.source],d.center.lng,d.projection);k=k||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),E=E||this._layerOrderChanged||0===x,this._layerOrderChanged&&this.fire(new g.Event("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(g.exported.now(),d.zoom))&&(this.pauseablePlacement=new mp(d,this._order,E,m,x,T,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,B),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(g.exported.now()),O=!0),k&&this.pauseablePlacement.placement.setStale()),O||k)for(const G of this._order){const q=this._layers[G];"symbol"===q.type&&this.placement.updateLayerOpacities(q,B[q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(g.exported.now())}_releaseSymbolFadeTiles(){for(const d in this._sourceCaches)this._sourceCaches[d].releaseSymbolFadeTiles()}getImages(d,m,x){this.imageManager.getImages(m.icons,x),this._updateTilesForChangedImages();const T=E=>{E&&E.setDependencies(m.tileID.key,m.type,m.icons)};T(this._otherSourceCaches[m.source]),T(this._symbolSourceCaches[m.source])}getGlyphs(d,m,x){this.glyphManager.getGlyphs(m.stacks,x)}getResource(d,m,x){return g.makeRequest(m,x)}_getSourceCache(d){return this._otherSourceCaches[d]}_getLayerSourceCache(d){return"symbol"===d.type?this._symbolSourceCaches[d.source]:this._otherSourceCaches[d.source]}_getSourceCaches(d){const m=[];return this._otherSourceCaches[d]&&m.push(this._otherSourceCaches[d]),this._symbolSourceCaches[d]&&m.push(this._symbolSourceCaches[d]),m}_isSourceCacheLoaded(d){const m=this._getSourceCaches(d);return 0===m.length?(this.fire(new g.ErrorEvent(new Error(`There is no source with ID '${d}'`))),!1):m.every(x=>x.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}gs.getSourceType=function(v){return qe[v]},gs.setSourceType=function(v,d){qe[v]=d},gs.registerForPluginStateChange=g.registerForPluginStateChange;var Fc="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Xf="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Wg="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Jn="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",_p="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Yf={},ks={};const Nc=[];Gu(Fc,Nc),Gu(Wg,Nc),Gu(Jn,Nc),Gu(_p,Nc),Yf=Fi("",Wg),ks=Fi(_p,Jn);const Zy=Fi("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),ko=Fc,Qf="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var qg={background:Fi("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Fi("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Fi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Fi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Fi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Fi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Fi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Fi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Fi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Fi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Fi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Fi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Fi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Fi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Fi("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Fi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Fi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Fi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Fi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Fi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Fi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Fi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Fi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Fi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Fi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Fi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Xf),skyboxGradient:Fi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Xf),skyboxCapture:Fi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Fi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Fi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function Gu(v,d){const m=v.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let x of m)if(x=x.trim(),"#"===x[0]&&x.includes("if")&&!x.includes("endif")){x=x.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const T=x.split(" ");for(const E of T)d.includes(E)||d.push(E)}}function Fi(v,d){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=d.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),T={},E=[...Nc];return Gu(v,E),Gu(d,E),{fragmentSource:v=v.replace(m,(k,O,B,G,q)=>(T[q]=!0,"define"===O?`\n#ifndef HAS_UNIFORM_u_${q}\nvarying ${B} ${G} ${q};\n#else\nuniform ${B} ${G} u_${q};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${q}\n    ${B} ${G} ${q} = u_${q};\n#endif\n`)),vertexSource:d=d.replace(m,(k,O,B,G,q)=>{const J="float"===G?"vec2":"vec4",re=q.match(/color/)?"color":J;return T[q]?"define"===O?`\n#ifndef HAS_UNIFORM_u_${q}\nuniform lowp float u_${q}_t;\nattribute ${B} ${J} a_${q};\nvarying ${B} ${G} ${q};\n#else\nuniform ${B} ${G} u_${q};\n#endif\n`:"vec4"===re?`\n#ifndef HAS_UNIFORM_u_${q}\n    ${q} = a_${q};\n#else\n    ${B} ${G} ${q} = u_${q};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${q}\n    ${q} = unpack_mix_${re}(a_${q}, u_${q}_t);\n#else\n    ${B} ${G} ${q} = u_${q};\n#endif\n`:"define"===O?`\n#ifndef HAS_UNIFORM_u_${q}\nuniform lowp float u_${q}_t;\nattribute ${B} ${J} a_${q};\n#else\nuniform ${B} ${G} u_${q};\n#endif\n`:"vec4"===re?`\n#ifndef HAS_UNIFORM_u_${q}\n    ${B} ${G} ${q} = a_${q};\n#else\n    ${B} ${G} ${q} = u_${q};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${q}\n    ${B} ${G} ${q} = unpack_mix_${re}(a_${q}, u_${q}_t);\n#else\n    ${B} ${G} ${q} = u_${q};\n#endif\n`}),staticAttributes:x,usedDefines:E}}class zc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(d,m,x,T,E,k,O){this.context=d;let B=this.boundPaintVertexBuffers.length!==T.length;for(let q=0;!B&&q<T.length;q++)this.boundPaintVertexBuffers[q]!==T[q]&&(B=!0);let G=this.boundDynamicVertexBuffers.length!==O.length;for(let q=0;!G&&q<O.length;q++)this.boundDynamicVertexBuffers[q]!==O[q]&&(G=!0);if(!d.extVertexArrayObject||!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==x||B||G||this.boundIndexBuffer!==E||this.boundVertexOffset!==k)this.freshBind(m,x,T,E,k,O);else{d.bindVertexArrayOES.set(this.vao);for(const q of O)q&&q.bind();E&&E.dynamicDraw&&E.bind()}}freshBind(d,m,x,T,E,k){let O;const B=d.numAttributes,G=this.context,q=G.gl;if(G.extVertexArrayObject)this.vao&&this.destroy(),this.vao=G.extVertexArrayObject.createVertexArrayOES(),G.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=d,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=T,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=k;else{O=G.currentNumAttributes||0;for(let J=B;J<O;J++)q.disableVertexAttribArray(J)}m.enableAttributes(q,d),m.bind(),m.setVertexAttribPointers(q,d,E);for(const J of x)J.enableAttributes(q,d),J.bind(),J.setVertexAttribPointers(q,d,E);for(const J of k)J&&(J.enableAttributes(q,d),J.bind(),J.setVertexAttribPointers(q,d,E));T&&T.bind(),G.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Wu(v,d){const m=Math.pow(2,d.canonical.z),x=d.canonical.y;return[new g.MercatorCoordinate(0,x/m).toLngLat().lat,new g.MercatorCoordinate(0,(x+1)/m).toLngLat().lat]}function ih(v,d,m,x,T,E,k){const O=v.context,B=O.gl,G=m.fbo;if(!G)return;v.prepareDrawTile();const q=v.useProgram("hillshade");O.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,G.colorAttachment.get());const J=((he,pe,oe,Ce)=>{const xe=oe.paint.get("hillshade-shadow-color"),Ee=oe.paint.get("hillshade-highlight-color"),Le=oe.paint.get("hillshade-accent-color");let Pe=oe.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===oe.paint.get("hillshade-illumination-anchor")&&(Pe-=he.transform.angle);const Fe=!he.options.moving;return{u_matrix:Ce||he.transform.calculateProjMatrix(pe.tileID.toUnwrapped(),Fe),u_image:0,u_latrange:Wu(0,pe.tileID),u_light:[oe.paint.get("hillshade-exaggeration"),Pe],u_shadow:xe,u_highlight:Ee,u_accent:Le}})(v,m,x,v.terrain?d.projMatrix:null);v.prepareDrawProgram(O,q,d.toUnwrapped());const{tileBoundsBuffer:re,tileBoundsIndexBuffer:de,tileBoundsSegments:le}=v.getTileBoundsBuffers(m);q.draw(O,B.TRIANGLES,T,E,k,g.CullFaceMode.disabled,J,x.id,re,de,le)}function oh(v,d,m){if(!d.needsDEMTextureUpload)return;const x=v.context,T=x.gl;x.pixelStoreUnpackPremultiplyAlpha.set(!1),d.demTexture=d.demTexture||v.getTileTexture(m.stride);const E=m.getPixels();d.demTexture?d.demTexture.update(E,{premultiply:!1}):d.demTexture=new g.Texture(x,E,T.RGBA,{premultiply:!1}),d.needsDEMTextureUpload=!1}function yp(v,d,m,x,T,E){const k=v.context,O=k.gl;if(!d.dem)return;const B=d.dem;if(k.activeTexture.set(O.TEXTURE1),oh(v,d,B),!d.demTexture)return;d.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const G=B.dim;k.activeTexture.set(O.TEXTURE0);let q=d.fbo;if(!q){const le=new g.Texture(k,{width:G,height:G,data:null},O.RGBA);le.bind(O.LINEAR,O.CLAMP_TO_EDGE),q=d.fbo=k.createFramebuffer(G,G,!0),q.colorAttachment.set(le.texture)}k.bindFramebuffer.set(q.framebuffer),k.viewport.set([0,0,G,G]);const{tileBoundsBuffer:J,tileBoundsIndexBuffer:re,tileBoundsSegments:de}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw(k,O.TRIANGLES,x,T,E,g.CullFaceMode.disabled,((le,he)=>{const pe=he.stride,oe=g.create();return g.ortho(oe,0,g.EXTENT,-g.EXTENT,0,0,1),g.translate(oe,oe,[0,-g.EXTENT,0]),{u_matrix:oe,u_image:1,u_dimension:[pe,pe],u_zoom:le.overscaledZ,u_unpack:he.unpackVector}})(d.tileID,B),m.id,J,re,de),d.needsHillshadePrepare=!1}const rh=v=>({u_matrix:new g.UniformMatrix4f(v),u_image0:new g.Uniform1i(v),u_skirt_height:new g.Uniform1f(v)}),Bc=(v,d)=>({u_matrix:v,u_image0:0,u_skirt_height:d}),Sl=(v,d,m,x,T,E,k,O,B,G,q,J,re,de,le)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:d,u_normalize_matrix:Float32Array.from(x),u_merc_matrix:m,u_zoom_transition:T,u_merc_center:E,u_image0:0,u_frustum_tl:k,u_frustum_tr:O,u_frustum_br:B,u_frustum_bl:G,u_globe_pos:q,u_globe_radius:J,u_viewport:re,u_grid_matrix:le?Float32Array.from(le):new Float32Array(9),u_skirt_height:de});function Jf(v,d){return null!=v&&null!=d&&!(!v.hasData()||!d.hasData())&&null!=v.demTexture&&null!=d.demTexture&&v.tileID.key!==d.tileID.key}const Rt=new class{constructor(){this.operations={}}newMorphing(v,d,m,x,T){if(v in this.operations){const E=this.operations[v];E.to.tileID.key!==m.tileID.key&&(E.queued=m)}else this.operations[v]={startTime:x,phase:0,duration:T,from:d,to:m,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const d=this.operations[v];return{from:d.from,to:d.to,phase:d.phase}}update(v){for(const d in this.operations){const m=this.operations[d];for(m.phase=(v-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,v)){delete this.operations[d];break}}}_nextOp(v,d){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=d,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},ec={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function ai(v){return 6*Math.pow(1.5,22-v)}function qu(v,d){const m=1<<v.z;return!d&&(0===v.x||v.x===m-1)||0===v.y||v.y===m-1}const ki=v=>({u_matrix:v});function El(v,d,m,x,T){if(T>0){const E=g.exported.now(),k=(E-v.timeAdded)/T,O=d?(E-d.timeAdded)/T:-1,B=m.getSource(),G=x.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),q=!d||Math.abs(d.tileID.overscaledZ-G)>Math.abs(v.tileID.overscaledZ-G),J=q&&v.refreshedUponExpiration?1:g.clamp(q?k:1-O,0,1);return v.refreshedUponExpiration&&k>=1&&(v.refreshedUponExpiration=!1),d?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}class Zg extends g.SourceCache{constructor(d){const m={type:"raster-dem",maxzoom:d.transform.maxZoom},x=new Us($n(),null),T=We("mock-dem",m,x,d.style);super("mock-dem",T,!1),T.setEventedParent(this),this._sourceLoaded=!0}_loadTile(d,m){d.state="loaded",m(null)}}class Kg extends g.SourceCache{constructor(d){const m=We("proxy",{type:"geojson",maxzoom:d.transform.maxZoom},new Us($n(),null),d.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=d,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(d,m,x){if(d.freezeTileCoverage)return;this.transform=d;const T=d.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,k)=>{if(E[k.key]="",!this._tiles[k.key]){const O=new g.Tile(k,this._source.tileSize*k.overscaleFactor(),d.tileZoom);O.state="loaded",this._tiles[k.key]=O}return E},{});for(const E in this._tiles)E in T||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(d){const m=this.proxyCachedFBO[d];if(void 0!==m){const x=Object.values(m);this.renderCachePool.push(...x),delete this.proxyCachedFBO[d]}}deallocRenderCache(){this.renderCache.forEach(d=>d.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class em extends g.OverscaledTileID{constructor(d,m,x){super(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y),this.proxyTileKey=m,this.projMatrix=x}}class el extends g.Elevation{constructor(d,m){super(),this.painter=d,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[x,T,E]=function(B){const G=new g.StructArrayLayout2i4,q=new g.StructArrayLayout3ui6,J=131;G.reserve(17161),q.reserve(33800);const re=g.EXTENT/128,de=g.EXTENT+re/2,le=de+re;for(let pe=-re;pe<le;pe+=re)for(let oe=-re;oe<le;oe+=re){const Ce=oe<0||oe>de||pe<0||pe>de?24575:0,xe=g.clamp(Math.round(oe),0,g.EXTENT),Ee=g.clamp(Math.round(pe),0,g.EXTENT);G.emplaceBack(xe+Ce,Ee)}const he=(pe,oe)=>{const Ce=oe*J+pe;q.emplaceBack(Ce+1,Ce,Ce+J),q.emplaceBack(Ce+J,Ce+J+1,Ce+1)};for(let pe=1;pe<129;pe++)for(let oe=1;oe<129;oe++)he(oe,pe);return[0,129].forEach(pe=>{for(let oe=0;oe<130;oe++)he(oe,pe),he(pe,oe)}),[G,q,32768]}(),k=d.context;this.gridBuffer=k.createVertexBuffer(x,g.posAttributes.members),this.gridIndexBuffer=k.createIndexBuffer(T),this.gridSegments=g.SegmentVector.simpleSegment(0,0,x.length,T.length),this.gridNoSkirtSegments=g.SegmentVector.simpleSegment(0,0,x.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Kg(m.map),this.orthoMatrix=g.create(),g.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,g.EXTENT,0,g.EXTENT,0,1);const O=k.gl;this._overlapStencilMode=new g.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=d.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Zg(m.map)}set style(d){d.on("data",this._onStyleDataEvent.bind(this)),d.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=d,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(d,m,x){if(d&&d.terrain){this._style!==d&&(this.style=d),this.enabled=!0;const T=d.terrain.properties;this.sourceCache=0===d.terrain.drapeRenderMode?this._mockSourceCache:d._getSourceCache(T.get("source")),this._exaggeration=T.get("exaggeration");const E=()=>{this.sourceCache.used&&g.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const k=this.getScaledDemTileSize();this.sourceCache.update(m,k,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,E(),this._initializing=!0),E(),m.updateElevation(!0,x),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(d){this._findCoveringTileCache[d]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const d=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==d.efficiency&&g.warnOnce(`Terrain render cache efficiency is not optimal (${d.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${d.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(d){d.coord&&"source"===d.dataType?this._clearRenderCacheForTile(d.sourceCacheId,d.coord):"style"===d.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const d in this._style._sourceCaches)this._style._sourceCaches[d].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(d=>d.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const d=2*this.proxySourceCache.getSource().tileSize;return[d,d]}set useVertexMorphing(d){this._useVertexMorphing=d}updateTileBinding(d){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,x=this.painter.transform;this._initializing&&(this._initializing=0===x._centerAltitude&&-1===this.getAtPointOrZero(g.MercatorCoordinate.fromLngLat(x.center),-1),this._emptyDEMTextureDirty=!this._initializing);const T=this.proxyCoords=m.getIds().map(B=>{const G=m.getTileByID(B).tileID;return G.projMatrix=x.calculateProjMatrix(G.toUnwrapped()),G});(function(B,G){const q=G.transform.pointCoordinate(G.transform.getCameraPoint()),J=new g.pointGeometry(q.x,q.y);B.sort((re,de)=>{if(de.overscaledZ-re.overscaledZ)return de.overscaledZ-re.overscaledZ;const le=new g.pointGeometry(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),he=new g.pointGeometry(de.canonical.x+(1<<de.canonical.z)*de.wrap,de.canonical.y),pe=J.mult(1<<re.canonical.z);return pe.x-=.5,pe.y-=.5,pe.distSqr(le)-pe.distSqr(he)})})(T,this.painter),this._previousZoom=x.zoom;const E=this.proxyToSource||{};this.proxyToSource={},T.forEach(B=>{this.proxyToSource[B.key]={}}),this.terrainTileForTile={};const k=this._style._sourceCaches;for(const B in k){const G=k[B];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,d[B],E),G.usedForTerrain))continue;const q=d[B];G.getSource().reparseOverscaled&&this._assignTerrainTiles(q)}this.proxiedCoords[m.id]=T.map(B=>new em(B,B.key,this.orthoMatrix)),this._assignTerrainTiles(T),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1,this._updateTimestamp=g.exported.now();const O={};this._visibleDemTiles=[];for(const B of this.proxyCoords){const G=this.terrainTileForTile[B.key];if(!G)continue;const q=G.tileID.key;q in O||(this._visibleDemTiles.push(G),O[q]=q)}}_assignTerrainTiles(d){this._initializing||d.forEach(m=>{if(this.terrainTileForTile[m.key])return;const x=this._findTileCoveringTileID(m,this.sourceCache);x&&(this.terrainTileForTile[m.key]=x)})}_prepareDEMTextures(){const d=this.painter.context,m=d.gl;for(const x in this.terrainTileForTile){const T=this.terrainTileForTile[x],E=T.dem;!E||T.demTexture&&!T.needsDEMTextureUpload||(d.activeTexture.set(m.TEXTURE1),oh(this.painter,T,E))}}_prepareDemTileUniforms(d,m,x,T){if(!m||null==m.demTexture)return!1;const E=d.tileID.canonical,k=Math.pow(2,m.tileID.canonical.z-E.z),O=T||"";return x[`u_dem_tl${O}`]=[E.x*k%1,E.y*k%1],x[`u_dem_scale${O}`]=k,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const d=this.painter.context,m=d.gl;if(!this._emptyDepthBufferTexture){const x=new g.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new g.Texture(d,x,m.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let d=0;const m=this._visibleDemTiles.reduce((x,T)=>{if(!T.dem)return x;const E=T.dem.tree.minimums[0];return E>0&&d++,x+E},0);return d?m/d:0}_updateEmptyDEMTexture(){const d=this.painter.context,m=d.gl;d.activeTexture.set(m.TEXTURE2);const x=this._getLoadedAreaMinimum(),T=new g.RGBAImage({width:1,height:1},new Uint8Array(g.DEMData.pack(x,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(T,{premultiply:!1}):E=this._emptyDEMTexture=new g.Texture(d,T,m.RGBA,{premultiply:!1}),E}setupElevationDraw(d,m,x){const T=this.painter.context,E=T.gl,k=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:g.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var O;k.u_dem_size=this.sourceCache.getSource().tileSize,k.u_exaggeration=this.exaggeration();let B=null,G=null,q=1;if(x&&x.morphing&&this._useVertexMorphing){const J=x.morphing.srcDemTile,re=x.morphing.dstDemTile;q=x.morphing.phase,J&&re&&(this._prepareDemTileUniforms(d,J,k,"_prev")&&(G=J),this._prepareDemTileUniforms(d,re,k)&&(B=re))}if(G&&B?(T.activeTexture.set(E.TEXTURE2),B.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),T.activeTexture.set(E.TEXTURE4),G.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),k.u_dem_lerp=q):(B=this.terrainTileForTile[d.tileID.key],T.activeTexture.set(E.TEXTURE2),(this._prepareDemTileUniforms(d,B,k)?B.demTexture:this.emptyDEMTexture).bind(E.NEAREST,E.CLAMP_TO_EDGE)),T.activeTexture.set(E.TEXTURE3),x&&x.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(k.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),k.u_depth_size_inv=[1,1]),x&&x.useMeterToDem&&B){const J=(1<<B.tileID.canonical.z)*g.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;k.u_meter_to_dem=J}if(x&&x.labelPlaneMatrixInv&&(k.u_label_plane_matrix_inv=x.labelPlaneMatrixInv),m.setTerrainUniformValues(T,k),"globe"===this.painter.transform.projection.name){const J=this.globeUniformValues(this.painter.transform,d.tileID.canonical,x&&x.useDenormalizedUpVectorScale);m.setGlobeUniformValues(T,J)}}globeUniformValues(d,m,x){const T=d.projection;return{u_tile_tl_up:T.upVector(m,0,0),u_tile_tr_up:T.upVector(m,g.EXTENT,0),u_tile_br_up:T.upVector(m,g.EXTENT,g.EXTENT),u_tile_bl_up:T.upVector(m,0,g.EXTENT),u_tile_up_scale:x?g.globeMetersToEcef(1):T.upVectorScale(m,d.center.lat,d.worldSize).metersToTile}}renderToBackBuffer(d){const m=this.painter,x=this.painter.context;0!==d.length&&(x.bindFramebuffer.set(null),x.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(T,E,k,O,B){if("globe"===T.transform.projection.name)!function(G,q,J,re,de){const le=G.context,he=le.gl;let pe,oe;const Ce=G.options.showTerrainWireframe?2:0,xe=G.transform,Ee=g.globeUseCustomAntiAliasing(G,le,xe),Le=(At,ot)=>{if(oe===At)return;const je=[ec[At],"PROJECTION_GLOBE_VIEW"];Ee&&je.push("CUSTOM_ANTIALIASING"),ot&&je.push(ec[Ce]),pe=G.useProgram("globeRaster",null,je),oe=At},Pe=G.colorModeForRenderPass(),Fe=new g.DepthMode(he.LEQUAL,g.DepthMode.ReadWrite,G.depthRangeFor3D);Rt.update(de);const $e=g.calculateGlobeMercatorMatrix(xe),it=[g.mercatorXfromLng(xe.center.lng),g.mercatorYfromLat(xe.center.lat)],rt=Ce?[!1,!0]:[!1],Vt=G.globeSharedBuffers,Ze=[xe.width*g.exported.devicePixelRatio,xe.height*g.exported.devicePixelRatio],Tt=Float32Array.from(xe.globeMatrix),dt={useDenormalizedUpVectorScale:!0};if(rt.forEach(At=>{const ot=G.transform,je=ai(ot.zoom)*q.exaggeration();oe=-1;const ct=At?he.LINES:he.TRIANGLES;for(const Dt of re){const Ot=J.getTile(Dt),vn=g.StencilMode.disabled,li=q.prevTerrainTileForTile[Dt.key],hn=q.terrainTileForTile[Dt.key];Jf(li,hn)&&Rt.newMorphing(Dt.key,li,hn,de,250),le.activeTexture.set(he.TEXTURE0),Ot.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);const Jt=Rt.getMorphValuesForProxy(Dt.key),Sn=Jt?1:0;Jt&&g.extend$1(dt,{morphing:{srcDemTile:Jt.from,dstDemTile:Jt.to,phase:g.easeCubicInOut(Jt.phase)}});const Ci=g.tileCornersToBounds(Dt.canonical),In=g.getLatitudinalLod(Ci.getCenter().lat),Yi=g.getGridMatrix(Dt.canonical,Ci,In,ot.worldSize/ot._pixelsPerMercatorPixel),Qi=g.globeNormalizeECEF(g.globeTileBounds(Dt.canonical)),yo=Sl(ot.projMatrix,Tt,$e,Qi,g.globeToMercatorTransition(ot.zoom),it,ot.frustumCorners.TL,ot.frustumCorners.TR,ot.frustumCorners.BR,ot.frustumCorners.BL,ot.globeCenterInViewSpace,ot.globeRadius,Ze,je,Yi);if(Le(Sn,At),q.setupElevationDraw(Ot,pe,dt),G.prepareDrawProgram(le,pe,Dt.toUnwrapped()),Vt){const[io,cr,ys]=At?Vt.getWirefameBuffers(G.context,In):Vt.getGridBuffers(In,0!==je);pe.draw(le,ct,Fe,vn,Pe,g.CullFaceMode.backCCW,yo,"globe_raster",io,cr,ys)}}}),Vt){const At=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ee&&At.push("CUSTOM_ANTIALIASING"),pe=G.useProgram("globeRaster",null,At);for(const ot of re){const{x:je,y:ct,z:Dt}=ot.canonical,Ot=0===ct,vn=ct===(1<<Dt)-1,[li,hn,Jt,Sn]=Vt.getPoleBuffers(Dt);if(Sn&&(Ot||vn)){const Ci=J.getTile(ot);le.activeTexture.set(he.TEXTURE0),Ci.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);let In=g.globePoleMatrixForTile(Dt,je,xe);const Yi=g.globeNormalizeECEF(g.globeTileBounds(ot.canonical)),Qi=(yo,io)=>yo.draw(le,he.TRIANGLES,Fe,g.StencilMode.disabled,Pe,g.CullFaceMode.disabled,Sl(xe.projMatrix,In,In,Yi,0,it,xe.frustumCorners.TL,xe.frustumCorners.TR,xe.frustumCorners.BR,xe.frustumCorners.BL,xe.globeCenterInViewSpace,xe.globeRadius,Ze,0),"globe_pole_raster",io,Jt,Sn);q.setupElevationDraw(Ci,pe,dt),G.prepareDrawProgram(le,pe,ot.toUnwrapped()),Ot&&Qi(pe,li),vn&&(In=g.scale(g.create(),In,[1,-1,1]),Qi(pe,hn))}}}}(T,E,k,O,B);else{const G=T.context,q=G.gl;let J,re;const de=T.options.showTerrainWireframe?2:0,le=(xe,Ee)=>{if(re===xe)return;const Le=[ec[xe]];Ee&&Le.push(ec[de]),J=T.useProgram("terrainRaster",null,Le),re=xe},he=T.colorModeForRenderPass(),pe=new g.DepthMode(q.LEQUAL,g.DepthMode.ReadWrite,T.depthRangeFor3D);Rt.update(B);const oe=T.transform,Ce=ai(oe.zoom)*E.exaggeration();(de?[!1,!0]:[!1]).forEach(xe=>{re=-1;const Ee=xe?q.LINES:q.TRIANGLES,[Le,Pe]=xe?E.getWirefameBuffer():[E.gridIndexBuffer,E.gridSegments];for(const Fe of O){const $e=k.getTile(Fe),it=g.StencilMode.disabled,rt=E.prevTerrainTileForTile[Fe.key],Vt=E.terrainTileForTile[Fe.key];Jf(rt,Vt)&&Rt.newMorphing(Fe.key,rt,Vt,B,250),G.activeTexture.set(q.TEXTURE0),$e.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST);const Ze=Rt.getMorphValuesForProxy(Fe.key),Tt=Ze?1:0;let dt;Ze&&(dt={morphing:{srcDemTile:Ze.from,dstDemTile:Ze.to,phase:g.easeCubicInOut(Ze.phase)}});const At=Bc(Fe.projMatrix,qu(Fe.canonical,oe.renderWorldCopies)?Ce/10:Ce);le(Tt,xe),E.setupElevationDraw($e,J,dt),T.prepareDrawProgram(G,J,Fe.toUnwrapped()),J.draw(G,Ee,pe,it,he,g.CullFaceMode.backCCW,At,"terrain_raster",E.gridBuffer,Le,Pe)}})}}(m,this,this.proxySourceCache,d,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),d.splice(0,d.length))}renderBatch(d){if(0===this._drapedRenderBatches.length)return d+1;this.renderingToTexture=!0;const m=this.painter,x=this.painter.context,T=this.proxySourceCache,E=this.proxiedCoords[T.id],k=this._drapedRenderBatches.shift(),O=[],B=m.style.order;let G=0;for(const q of E){const J=T.getTileByID(q.proxyTileKey),re=T.proxyCachedFBO[q.key]?T.proxyCachedFBO[q.key][d]:void 0,de=void 0!==re?T.renderCache[re]:this.pool[G++],le=void 0!==re;if(J.texture=de.tex,le&&!de.dirty){O.push(J.tileID);continue}let he;x.bindFramebuffer.set(de.fb.framebuffer),this.renderedToTile=!1,de.dirty&&(x.clear({color:g.Color.transparent,stencil:0}),de.dirty=!1);for(let pe=k.start;pe<=k.end;++pe){const oe=m.style._layers[B[pe]];if(oe.isHidden(m.transform.zoom))continue;const Ce=m.style._getLayerSourceCache(oe),xe=Ce?this.proxyToSource[q.key][Ce.id]:[q];if(!xe)continue;const Ee=xe;x.viewport.set([0,0,de.fb.width,de.fb.height]),he!==(Ce?Ce.id:null)&&(this._setupStencil(de,xe,oe,Ce),he=Ce?Ce.id:null),m.renderLayer(m,Ce,oe,Ee)}this.renderedToTile?(de.dirty=!0,O.push(J.tileID)):le||--G,5===G&&(G=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,x.bindFramebuffer.set(null),x.viewport.set([0,0,m.width,m.height]),k.end+1}postRender(){}renderCacheEfficiency(d){const m=d.order.length;if(0===m)return{efficiency:100};let x,T=0,E=0,k=!1;for(let O=0;O<m;++O){const B=d._layers[d.order[O]];this._style.isLayerDraped(B)?(k&&++T,++E):k||(k=!0,x=B.id)}return 0===E?{efficiency:100}:{efficiency:100*(1-T/E),firstUndrapedLayer:x}}getMinElevationBelowMSL(){let d=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{d=Math.min(d,m.dem.tree.minimums[0])}),0===d?d:(d-30)*this._exaggeration}raycast(d,m,x){if(!this._visibleDemTiles)return null;const T=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const k=E.tileID,O=1<<k.overscaledZ,{x:B,y:G}=k.canonical,q=B/O,J=(B+1)/O,re=G/O,de=(G+1)/O;return{minx:q,miny:re,maxx:J,maxy:de,t:E.dem.tree.raycastRoot(q,re,J,de,d,m,x),tile:E}});T.sort((E,k)=>(null!==E.t?E.t:Number.MAX_VALUE)-(null!==k.t?k.t:Number.MAX_VALUE));for(const E of T){if(null==E.t)return null;const k=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,d,m,x);if(null!=k)return k}return null}_createFBO(){const d=this.painter.context,m=d.gl,x=this.drapeBufferSize;d.activeTexture.set(m.TEXTURE0);const T=new g.Texture(d,{width:x[0],height:x[1],data:null},m.RGBA);T.bind(m.LINEAR,m.CLAMP_TO_EDGE);const E=d.createFramebuffer(x[0],x[1],!1);return E.colorAttachment.set(T.texture),E.depthAttachment=new Xd(d,E.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=d.createRenderbuffer(d.gl.DEPTH_STENCIL,x[0],x[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),d.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),d.extTextureFilterAnisotropic&&!d.extTextureFilterAnisotropicForceOff&&m.texParameterf(m.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax),{fb:E,tex:T,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d].hasTransition())return!0;return this._style.order.some(d=>{const m=this._style._layers[d],x=m.isHidden(this.painter.transform.zoom);return"custom"===m.type?!x&&m.shouldRedrape():!x&&m.hasTransition()})}_clearLineLayersFromRenderCache(){let d=!1;for(const x of this._style._getSources())if(x instanceof Q){d=!0;break}if(!d)return;const m={};for(let x=0;x<this._style.order.length;++x){const T=this._style._layers[this._style.order[x]],E=this._style._getLayerSourceCache(T);if(E&&!m[E.id]&&!T.isHidden(this.painter.transform.zoom)&&"line"===T.type&&T.widthExpression()instanceof g.ZoomDependentExpression){m[E.id]=!0;for(const k of this.proxyCoords){const O=this.proxyToSource[k.key][E.id];if(O)for(const B of O)this._clearRenderCacheForTile(E.id,B)}}}}_clearRasterLayersFromRenderCache(){let d=!1;for(const x in this._style._sourceCaches)if(this._style._sourceCaches[x]._source instanceof ne){d=!0;break}if(!d)return;const m={};for(let x=0;x<this._style.order.length;++x){const T=this._style._layers[this._style.order[x]],E=this._style._getLayerSourceCache(T);if(!E||m[E.id]||T.isHidden(this.painter.transform.zoom)||"raster"!==T.type)continue;const k=T.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const B=this.proxyToSource[O.key][E.id];if(B)for(const G of B){const q=El(E.getTile(G),E.findLoadedParent(G,0),E,this.painter.transform,k);(1!==q.opacity||0!==q.mix)&&this._clearRenderCacheForTile(E.id,G)}}}}_setupDrapedRenderBatches(){const d=this._style.order,m=d.length;if(0===m)return;const x=[];let T,E=0,k=this._style._layers[d[E]];for(;!this._style.isLayerDraped(k)&&k.isHidden(this.painter.transform.zoom)&&++E<m;)k=this._style._layers[d[E]];for(;E<m;++E){const O=this._style._layers[d[E]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?void 0===T&&(T=E):void 0!==T&&(x.push({start:T,end:E-1}),T=void 0))}void 0!==T&&x.push({start:T,end:E-1}),this._drapedRenderBatches=x}_setupRenderCache(d){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const k=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let O=0;O<k.length;++O){const B=Object.values(k[O]);m.renderCachePool.push(...B)}}return}this._clearRasterLayersFromRenderCache();const x=this.proxyCoords,T=this._tilesDirty;for(let k=x.length-1;k>=0;k--){const O=x[k];if(m.getTileByID(O.key),void 0!==m.proxyCachedFBO[O.key]){const B=d[O.key],G=this.proxyToSource[O.key];let q=0;for(const J in G){const re=G[J],de=B[J];if(!de||de.length!==re.length||re.some((le,he)=>le!==de[he]||T[J]&&T[J].hasOwnProperty(le.key))){q=-1;break}++q}for(const J in m.proxyCachedFBO[O.key])m.renderCache[m.proxyCachedFBO[O.key][J]].dirty=q<0||q!==Object.values(B).length}}const E=[...this._drapedRenderBatches];E.sort((k,O)=>O.end-O.start-(k.end-k.start));for(const k of E)for(const O of x){if(m.proxyCachedFBO[O.key])continue;let B=m.renderCachePool.pop();void 0===B&&m.renderCache.length<50&&(B=m.renderCache.length,m.renderCache.push(this._createFBO())),void 0!==B&&(m.proxyCachedFBO[O.key]={},m.proxyCachedFBO[O.key][k.start]=B,m.renderCache[B].dirty=!0)}this._tilesDirty={}}_setupStencil(d,m,x,T){if(!T||!this._sourceTilesOverlap[T.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,k=E.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let O;if(x.isTileClipped())O=m.length,this._overlapStencilMode.test={func:k.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:k.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,x.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(d){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[d.key]),this._overlapStencilMode):g.StencilMode.disabled}_renderTileClippingMasks(d,m){const x=this.painter,T=this.painter.context,E=T.gl;x._tileClippingMaskIDs={},T.setColorMode(g.ColorMode.disabled),T.setDepthMode(g.DepthMode.disabled);const k=x.useProgram("clippingMask");for(const O of d){const B=x._tileClippingMaskIDs[O.key]=--m;k.draw(T,E.TRIANGLES,g.DepthMode.disabled,new g.StencilMode({func:E.ALWAYS,mask:0},B,255,E.KEEP,E.KEEP,E.REPLACE),g.ColorMode.disabled,g.CullFaceMode.disabled,ki(O.projMatrix),"$clipping",x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}pointCoordinate(d){const m=this.painter.transform;if(d.x<0||d.x>m.width||d.y<0||d.y>m.height)return null;const x=[d.x,d.y,1,1];g.transformMat4$1(x,x,m.pixelMatrixInverse),g.scale$1(x,x,1/x[3]),x[0]/=m.worldSize,x[1]/=m.worldSize;const T=m._camera.position,E=g.mercatorZfromAltitude(1,m.center.lat),k=[T[0],T[1],T[2]/E,0],O=g.subtract([],x.slice(0,3),k);g.normalize(O,O);const B=this.raycast(k,O,this._exaggeration);return null!==B&&B?(g.scaleAndAdd(k,k,O,B),k[3]=k[2],k[2]*=E,k):null}drawDepth(){const d=this.painter,m=d.context,x=this.proxySourceCache,T=Math.ceil(d.width),E=Math.ceil(d.height);if(!this._depthFBO||this._depthFBO.width===T&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const k=m.gl,O=m.createFramebuffer(T,E,!0);m.activeTexture.set(k.TEXTURE0);const B=new g.Texture(m,{width:T,height:E,data:null},k.RGBA);B.bind(k.NEAREST,k.CLAMP_TO_EDGE),O.colorAttachment.set(B.texture);const G=m.createRenderbuffer(m.gl.DEPTH_COMPONENT16,T,E);O.depthAttachment.set(G),this._depthFBO=O,this._depthTexture=B}m.bindFramebuffer.set(this._depthFBO.framebuffer),m.viewport.set([0,0,T,E]),function(k,O,B,G){if("globe"===k.transform.projection.name)return;const q=k.context,J=q.gl;q.clear({depth:1});const re=k.useProgram("terrainDepth"),de=new g.DepthMode(J.LESS,g.DepthMode.ReadWrite,k.depthRangeFor3D);for(const le of G){const he=B.getTile(le),pe=Bc(le.projMatrix,0);O.setupElevationDraw(he,re),re.draw(q,J.TRIANGLES,de,g.StencilMode.disabled,g.ColorMode.unblended,g.CullFaceMode.backCCW,pe,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(d,this,x,this.proxyCoords)}_setupProxiedCoordsForOrtho(d,m,x){if(d.getSource()instanceof Re)return this._setupProxiedCoordsForImageSource(d,m,x);this._findCoveringTileCache[d.id]=this._findCoveringTileCache[d.id]||{};const T=this.proxiedCoords[d.id]=[],E=this.proxyCoords;for(let O=0;O<E.length;O++){const B=E[O],G=this._findTileCoveringTileID(B,d);if(G){const q=this._createProxiedId(B,G,x[B.key]&&x[B.key][d.id]);T.push(q),this.proxyToSource[B.key][d.id]=[q]}}let k=!1;for(let O=0;O<m.length;O++){const B=d.getTile(m[O]);if(!B||!B.hasData())continue;const G=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==B.tileID.canonical.z){const q=this.proxyToSource[G.tileID.key][d.id],J=this._createProxiedId(G.tileID,B,x[G.tileID.key]&&x[G.tileID.key][d.id]);q?q.splice(q.length-1,0,J):this.proxyToSource[G.tileID.key][d.id]=[J],T.push(J),k=!0}}this._sourceTilesOverlap[d.id]=k}_setupProxiedCoordsForImageSource(d,m,x){if(!d.getSource().loaded())return;const T=this.proxiedCoords[d.id]=[],E=this.proxyCoords,k=d.getSource(),O=new g.pointGeometry(k.tileID.x,k.tileID.y)._div(1<<k.tileID.z),B=k.coordinates.map(g.MercatorCoordinate.fromLngLat).reduce((q,J)=>(q.min.x=Math.min(q.min.x,J.x-O.x),q.min.y=Math.min(q.min.y,J.y-O.y),q.max.x=Math.max(q.max.x,J.x-O.x),q.max.y=Math.max(q.max.y,J.y-O.y),q),{min:new g.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new g.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(q,J)=>{const re=q.wrap+q.canonical.x/(1<<q.canonical.z),de=q.canonical.y/(1<<q.canonical.z),le=g.EXTENT/(1<<q.canonical.z),he=J.wrap+J.canonical.x/(1<<J.canonical.z),pe=J.canonical.y/(1<<J.canonical.z);return re+le<he+B.min.x||re>he+B.max.x||de+le<pe+B.min.y||de>pe+B.max.y};for(let q=0;q<E.length;q++){const J=E[q];for(let re=0;re<m.length;re++){const de=d.getTile(m[re]);if(!de||!de.hasData()||G(J,de.tileID))continue;const le=this._createProxiedId(J,de,x[J.key]&&x[J.key][d.id]),he=this.proxyToSource[J.key][d.id];he?he.push(le):this.proxyToSource[J.key][d.id]=[le],T.push(le)}}}_createProxiedId(d,m,x){let T=this.orthoMatrix;if(x){const E=x.find(k=>k.key===m.tileID.key);if(E)return E}if(m.tileID.key!==d.key){const E=d.canonical.z-m.tileID.canonical.z;let k,O,B;T=g.create();const G=m.tileID.wrap-d.wrap<<d.overscaledZ;E>0?(k=g.EXTENT>>E,O=k*((m.tileID.canonical.x<<E)-d.canonical.x+G),B=k*((m.tileID.canonical.y<<E)-d.canonical.y)):(k=g.EXTENT<<-E,O=g.EXTENT*(m.tileID.canonical.x-(d.canonical.x+G<<-E)),B=g.EXTENT*(m.tileID.canonical.y-(d.canonical.y<<-E))),g.ortho(T,0,k,0,k,0,1),g.translate(T,T,[O,B,0])}return new em(m.tileID,d.key,T)}_findTileCoveringTileID(d,m){let x=m.getTile(d);if(x&&x.hasData())return x;const T=this._findCoveringTileCache[m.id],E=T[d.key];if(x=E?m.getTileByID(E):null,x&&x.hasData()||null===E)return x;let k=x?x.tileID:d,O=k.overscaledZ;const B=m.getSource().minzoom,G=[];if(!E){const J=m.getSource().maxzoom;if(d.canonical.z>=J){const re=d.canonical.z-J;m.getSource().reparseOverscaled?(O=Math.max(d.canonical.z+2,m.transform.tileZoom),k=new g.OverscaledTileID(O,d.wrap,J,d.canonical.x>>re,d.canonical.y>>re)):0!==re&&(O=J,k=new g.OverscaledTileID(O,d.wrap,J,d.canonical.x>>re,d.canonical.y>>re))}k.key!==d.key&&(G.push(k.key),x=m.getTile(k))}const q=J=>{G.forEach(re=>{T[re]=J}),G.length=0};for(O-=1;O>=B&&(!x||!x.hasData());O--){x&&q(x.tileID.key);const J=k.calculateScaledKey(O);if(x=m.getTileByID(J),x&&x.hasData())break;const re=T[J];if(null===re)break;void 0===re?G.push(J):x=m.getTileByID(re)}return q(x?x.tileID.key:null),x&&x.hasData()?x:null}findDEMTileFor(d){return this.enabled?this._findTileCoveringTileID(d,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(d,m){let x=this._tilesDirty[d];x||(x=this._tilesDirty[d]={}),x[m.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const d=function(m){let x=0;const T=new g.StructArrayLayout2ui4,E=131;for(let k=1;k<129;k++){for(let O=1;O<129;O++)x=k*E+O,T.emplaceBack(x,x+1),T.emplaceBack(x,x+E),T.emplaceBack(x+1,x+E),128===k&&T.emplaceBack(x+E,x+E+1);T.emplaceBack(x+1,x+1+E)}return T}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(d),this.wireframeSegments=g.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,d.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class ra{static cacheKey(d,m,x,T){let E=`${m}${T?T.cacheKey:""}`;for(const k of x)d.usedDefines.includes(k)&&(E+=`/${k}`);return E}constructor(d,m,x,T,E,k){const O=d.gl;this.program=O.createProgram();const B=function(oe){const Ce=[];for(let xe=0;xe<oe.length;xe++){if(null===oe[xe])continue;const Ee=oe[xe].split(" ");Ce.push(Ee.pop())}return Ce}(x.staticAttributes),G=T?T.getBinderAttributes():[],q=B.concat(G);let J=T?T.defines():[];J=J.concat(k.map(oe=>`#define ${oe}`));const re=d.isWebGL2?"#version 300 es\n":"",de=re+J.concat(d.extStandardDerivatives&&0===re.length?"#extension GL_OES_standard_derivatives : enable\n".concat(Qf):Qf,Qf,ko,Zy.fragmentSource,ks.fragmentSource,x.fragmentSource).join("\n"),le=re+J.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",ko,Zy.vertexSource,ks.vertexSource,Yf.vertexSource,x.vertexSource).join("\n"),he=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(he,de),O.compileShader(he),O.attachShader(this.program,he);const pe=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(pe,le),O.compileShader(pe),O.attachShader(this.program,pe),this.attributes={},this.numAttributes=q.length;for(let oe=0;oe<this.numAttributes;oe++)q[oe]&&(O.bindAttribLocation(this.program,oe,q[oe]),this.attributes[q[oe]]=oe);O.linkProgram(this.program),O.deleteShader(pe),O.deleteShader(he),this.fixedUniforms=E(d),this.binderUniforms=T?T.getUniforms(d):[],k.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new g.Uniform1i(oe=d),u_dem_prev:new g.Uniform1i(oe),u_dem_unpack:new g.Uniform4f(oe),u_dem_tl:new g.Uniform2f(oe),u_dem_scale:new g.Uniform1f(oe),u_dem_tl_prev:new g.Uniform2f(oe),u_dem_scale_prev:new g.Uniform1f(oe),u_dem_size:new g.Uniform1f(oe),u_dem_lerp:new g.Uniform1f(oe),u_exaggeration:new g.Uniform1f(oe),u_depth:new g.Uniform1i(oe),u_depth_size_inv:new g.Uniform2f(oe),u_meter_to_dem:new g.Uniform1f(oe),u_label_plane_matrix_inv:new g.UniformMatrix4f(oe)}),k.includes("GLOBE")&&(this.globeUniforms=(oe=>({u_tile_tl_up:new g.Uniform3f(oe),u_tile_tr_up:new g.Uniform3f(oe),u_tile_br_up:new g.Uniform3f(oe),u_tile_bl_up:new g.Uniform3f(oe),u_tile_up_scale:new g.Uniform1f(oe)}))(d)),k.includes("FOG")&&(this.fogUniforms=(oe=>({u_fog_matrix:new g.UniformMatrix4f(oe),u_fog_range:new g.Uniform2f(oe),u_fog_color:new g.Uniform4f(oe),u_fog_horizon_blend:new g.Uniform1f(oe),u_fog_temporal_offset:new g.Uniform1f(oe),u_frustum_tl:new g.Uniform3f(oe),u_frustum_tr:new g.Uniform3f(oe),u_frustum_br:new g.Uniform3f(oe),u_frustum_bl:new g.Uniform3f(oe),u_globe_pos:new g.Uniform3f(oe),u_globe_radius:new g.Uniform1f(oe),u_globe_transition:new g.Uniform1f(oe),u_is_globe:new g.Uniform1i(oe),u_viewport:new g.Uniform2f(oe)}))(d))}var oe}setTerrainUniformValues(d,m){if(!this.terrainUniforms)return;const x=this.terrainUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const T in m)x[T]&&x[T].set(this.program,T,m[T])}}setGlobeUniformValues(d,m){if(!this.globeUniforms)return;const x=this.globeUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const T in m)x[T]&&x[T].set(this.program,T,m[T])}}setFogUniformValues(d,m){if(!this.fogUniforms)return;const x=this.fogUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const T in m)x[T].set(this.program,T,m[T])}}draw(d,m,x,T,E,k,O,B,G,q,J,re,de,le,he){const pe=d.gl;if(this.failedToCreate)return;d.program.set(this.program),d.setDepthMode(x),d.setStencilMode(T),d.setColorMode(E),d.setCullFace(k);for(const Ce of Object.keys(this.fixedUniforms))this.fixedUniforms[Ce].set(this.program,Ce,O[Ce]);le&&le.setUniforms(this.program,d,this.binderUniforms,re,{zoom:de});const oe={[pe.LINES]:2,[pe.TRIANGLES]:3,[pe.LINE_STRIP]:1}[m];for(const Ce of J.get()){const xe=Ce.vaos||(Ce.vaos={});(xe[B]||(xe[B]=new zc)).bind(d,this,G,le?le.getPaintVertexBuffers():[],q,Ce.vertexOffset,he||[]),pe.drawElements(m,Ce.primitiveLength*oe,pe.UNSIGNED_SHORT,Ce.primitiveOffset*oe*2)}}}function sa(v,d){const m=Math.pow(2,d.tileID.overscaledZ),x=d.tileSize*Math.pow(2,v.transform.tileZoom)/m,T=x*(d.tileID.canonical.x+d.tileID.wrap*m),E=x*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_tile_units_to_pixels:1/fs(d,1,v.transform.tileZoom),u_pixel_coord_upper:[T>>16,E>>16],u_pixel_coord_lower:[65535&T,65535&E]}}const Il=g.create(),Xi=(v,d,m,x,T,E,k,O,B,G,q)=>{const J=d.style.light,re=J.properties.get("position"),de=[re.x,re.y,re.z],le=g.create$1();"viewport"===J.properties.get("anchor")&&(g.fromRotation(le,-d.transform.angle),g.transformMat3(de,de,le));const he=J.properties.get("color"),pe=d.transform,oe={u_matrix:v,u_lightpos:de,u_lightintensity:J.properties.get("intensity"),u_lightcolor:[he.r,he.g,he.b],u_vertical_gradient:+m,u_opacity:x,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Il,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:T,u_edge_radius:E};return"globe"===pe.projection.name&&(oe.u_tile_id=[k.canonical.x,k.canonical.y,1<<k.canonical.z],oe.u_zoom_transition=B,oe.u_inv_rot_matrix=q,oe.u_merc_center=G,oe.u_up_dir=pe.projection.upVector(new g.CanonicalTileID(0,0,0),G[0]*g.EXTENT,G[1]*g.EXTENT),oe.u_height_lift=O),oe},Zu=(v,d,m,x,T,E,k,O,B,G,q,J)=>{const re=Xi(v,d,m,x,T,E,k,B,G,q,J),de={u_height_factor:-Math.pow(2,k.overscaledZ)/O.tileSize/8};return g.extend(re,sa(d,O),de)},Ku=v=>({u_matrix:v}),Xu=(v,d,m)=>g.extend(Ku(v),sa(d,m)),tm=(v,d)=>({u_matrix:v,u_world:d}),tl=(v,d,m,x)=>g.extend(Xu(v,d,m),{u_world:x}),sh=g.create(),ah=(v,d,m,x,T,E)=>{const k=v.transform,O="globe"===k.projection.name;let B;if("map"===E.paint.get("circle-pitch-alignment"))if(O){const q=g.globePixelsToTileUnits(k.zoom,d.canonical)*k._pixelsPerMercatorPixel;B=Float32Array.from([q,0,0,q])}else B=k.calculatePixelsToTileUnitsMatrix(m);else B=new Float32Array([k.pixelsToGLUnits[0],0,0,k.pixelsToGLUnits[1]]);const G={u_camera_to_center_distance:k.cameraToCenterDistance,u_matrix:v.translatePosMatrix(d.projMatrix,m,E.paint.get("circle-translate"),E.paint.get("circle-translate-anchor")),u_device_pixel_ratio:g.exported.devicePixelRatio,u_extrude_scale:B,u_inv_rot_matrix:sh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){G.u_inv_rot_matrix=x,G.u_merc_center=T,G.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],G.u_zoom_transition=g.globeToMercatorTransition(k.zoom);const q=T[0]*g.EXTENT,J=T[1]*g.EXTENT;G.u_up_dir=k.projection.upVector(new g.CanonicalTileID(0,0,0),q,J)}return G},Qt=v=>{const d=[];return"map"===v.paint.get("circle-pitch-alignment")&&d.push("PITCH_WITH_MAP"),"map"===v.paint.get("circle-pitch-scale")&&d.push("SCALE_WITH_MAP"),d},vp=(v,d,m,x)=>{const T=g.EXTENT/m.tileSize;return{u_matrix:v,u_camera_to_center_distance:d.getCameraToCenterDistance(x),u_extrude_scale:[d.pixelsToGLUnits[0]/T,d.pixelsToGLUnits[1]/T]}},Yu=(v,d,m=1)=>({u_matrix:v,u_color:d,u_overlay:0,u_overlay_scale:m}),bp=g.create(),pn=(v,d,m,x,T,E,k)=>{const O=v.transform,B="globe"===O.projection.name,G=B?g.globePixelsToTileUnits(O.zoom,d.canonical)*O._pixelsPerMercatorPixel:fs(m,1,E),q={u_matrix:d.projMatrix,u_extrude_scale:G,u_intensity:k,u_inv_rot_matrix:bp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(B){q.u_inv_rot_matrix=x,q.u_merc_center=T,q.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],q.u_zoom_transition=g.globeToMercatorTransition(O.zoom);const J=T[0]*g.EXTENT,re=T[1]*g.EXTENT;q.u_up_dir=O.projection.upVector(new g.CanonicalTileID(0,0,0),J,re)}return q},nm=(v,d,m,x,T,E,k)=>{const O=v.transform,B=O.calculatePixelsToTileUnitsMatrix(d);return{u_matrix:Hr(v,d,m,x),u_pixels_to_tile_units:B,u_device_pixel_ratio:E,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:no(m)?d.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:On(d,v.transform),u_alpha_discard_threshold:0,u_trim_offset:k}},im=(v,d,m,x,T)=>{const E=v.transform;return{u_matrix:Hr(v,d,m,x),u_texsize:d.imageAtlasTexture.size,u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(d),u_device_pixel_ratio:T,u_image:0,u_tile_units_to_pixels:On(d,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function On(v,d){return 1/fs(v,1,d.tileZoom)}function Hr(v,d,m,x){return v.translatePosMatrix(x||d.tileID.projMatrix,d,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function no(v){const d=v.paint.get("line-dasharray").value;return d.value||"constant"!==d.kind}const ss=(v,d,m,x,T,E)=>{return{u_matrix:v,u_tl_parent:d,u_scale_parent:m,u_fade_t:x.mix,u_opacity:x.opacity*T.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:T.paint.get("raster-brightness-min"),u_brightness_high:T.paint.get("raster-brightness-max"),u_saturation_factor:(O=T.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(k=T.paint.get("raster-contrast"),k>0?1/(1-k):1+k),u_spin_weights:$r(T.paint.get("raster-hue-rotate")),u_perspective_transform:E};var k,O};function $r(v){v*=Math.PI/180;const d=Math.sin(v),m=Math.cos(v);return[(2*m+1)/3,(-Math.sqrt(3)*d-m+1)/3,(Math.sqrt(3)*d-m+1)/3]}const Vc=g.create(),Gr=(v,d,m,x,T,E,k,O,B,G,q,J,re,de,le,he)=>{const pe=T.transform,oe={u_is_size_zoom_constant:+("constant"===v||"source"===v),u_is_size_feature_constant:+("constant"===v||"camera"===v),u_size_t:d?d.uSizeT:0,u_size:d?d.uSize:0,u_camera_to_center_distance:pe.cameraToCenterDistance,u_rotate_symbol:+m,u_aspect_ratio:pe.width/pe.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:k,u_coord_matrix:O,u_is_text:+B,u_pitch_with_map:+x,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Vc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Vc,u_up_vector:[0,-1,0]};return"globe"===he.name&&(oe.u_tile_id=[q.canonical.x,q.canonical.y,1<<q.canonical.z],oe.u_zoom_transition=J,oe.u_inv_rot_matrix=de,oe.u_merc_center=re,oe.u_camera_forward=pe._camera.forward(),oe.u_ecef_origin=g.globeECEFOrigin(pe.globeMatrix,q.toUnwrapped()),oe.u_tile_matrix=Float32Array.from(pe.globeMatrix),oe.u_up_vector=le),oe},nl=(v,d,m,x,T,E,k,O,B,G,q,J,re,de,le,he,pe)=>g.extend(Gr(v,d,m,x,T,E,k,O,B,G,J,re,de,le,he,pe),{u_gamma_scale:x?T.transform.cameraToCenterDistance*Math.cos(T.terrain?0:T.transform._pitch):1,u_device_pixel_ratio:g.exported.devicePixelRatio,u_is_halo:+q}),Tn=(v,d,m,x,T,E,k,O,B,G,q,J,re,de,le,he)=>g.extend(nl(v,d,m,x,T,E,k,O,!0,B,!0,q,J,re,de,le,he),{u_texsize_icon:G,u_texture_icon:1}),Di=(v,d,m)=>({u_matrix:v,u_opacity:d,u_color:m}),jo=(v,d,m,x,T)=>g.extend(function(E,k,O){const B=k.imageManager.getPattern(E.toString()),{width:G,height:q}=k.imageManager.getPixelSize(),J=Math.pow(2,O.tileID.overscaledZ),re=O.tileSize*Math.pow(2,k.transform.tileZoom)/J,de=re*(O.tileID.canonical.x+O.tileID.wrap*J),le=re*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:B.tl,u_pattern_br:B.br,u_texsize:[G,q],u_pattern_size:B.displaySize,u_tile_units_to_pixels:1/fs(O,1,k.transform.tileZoom),u_pixel_coord_upper:[de>>16,le>>16],u_pixel_coord_lower:[65535&de,65535&le]}}(x,m,T),{u_matrix:v,u_opacity:d}),Ea={fillExtrusion:v=>({u_matrix:new g.UniformMatrix4f(v),u_lightpos:new g.Uniform3f(v),u_lightintensity:new g.Uniform1f(v),u_lightcolor:new g.Uniform3f(v),u_vertical_gradient:new g.Uniform1f(v),u_opacity:new g.Uniform1f(v),u_edge_radius:new g.Uniform1f(v),u_ao:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_up_dir:new g.Uniform3f(v),u_height_lift:new g.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_lightpos:new g.Uniform3f(v),u_lightintensity:new g.Uniform1f(v),u_lightcolor:new g.Uniform3f(v),u_vertical_gradient:new g.Uniform1f(v),u_height_factor:new g.Uniform1f(v),u_edge_radius:new g.Uniform1f(v),u_ao:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_up_dir:new g.Uniform3f(v),u_height_lift:new g.Uniform1f(v),u_image:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_pixel_coord_upper:new g.Uniform2f(v),u_pixel_coord_lower:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v),u_opacity:new g.Uniform1f(v)}),fill:v=>({u_matrix:new g.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_image:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_pixel_coord_upper:new g.Uniform2f(v),u_pixel_coord_lower:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v)}),fillOutline:v=>({u_matrix:new g.UniformMatrix4f(v),u_world:new g.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_world:new g.Uniform2f(v),u_image:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_pixel_coord_upper:new g.Uniform2f(v),u_pixel_coord_lower:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new g.Uniform1f(v),u_extrude_scale:new g.UniformMatrix2f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_up_dir:new g.Uniform3f(v)}),collisionBox:v=>({u_matrix:new g.UniformMatrix4f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_extrude_scale:new g.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new g.UniformMatrix4f(v),u_inv_matrix:new g.UniformMatrix4f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_viewport_size:new g.Uniform2f(v)}),debug:v=>({u_color:new g.UniformColor(v),u_matrix:new g.UniformMatrix4f(v),u_overlay:new g.Uniform1i(v),u_overlay_scale:new g.Uniform1f(v)}),clippingMask:v=>({u_matrix:new g.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new g.Uniform1f(v),u_intensity:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_up_dir:new g.Uniform3f(v)}),heatmapTexture:v=>({u_image:new g.Uniform1i(v),u_color_ramp:new g.Uniform1i(v),u_opacity:new g.Uniform1f(v)}),hillshade:v=>({u_matrix:new g.UniformMatrix4f(v),u_image:new g.Uniform1i(v),u_latrange:new g.Uniform2f(v),u_light:new g.Uniform2f(v),u_shadow:new g.UniformColor(v),u_highlight:new g.UniformColor(v),u_accent:new g.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new g.UniformMatrix4f(v),u_image:new g.Uniform1i(v),u_dimension:new g.Uniform2f(v),u_zoom:new g.Uniform1f(v),u_unpack:new g.Uniform4f(v)}),line:v=>({u_matrix:new g.UniformMatrix4f(v),u_pixels_to_tile_units:new g.UniformMatrix2f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_units_to_pixels:new g.Uniform2f(v),u_dash_image:new g.Uniform1i(v),u_gradient_image:new g.Uniform1i(v),u_image_height:new g.Uniform1f(v),u_texsize:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v),u_alpha_discard_threshold:new g.Uniform1f(v),u_trim_offset:new g.Uniform2f(v)}),linePattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_texsize:new g.Uniform2f(v),u_pixels_to_tile_units:new g.UniformMatrix2f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_image:new g.Uniform1i(v),u_units_to_pixels:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v),u_alpha_discard_threshold:new g.Uniform1f(v)}),raster:v=>({u_matrix:new g.UniformMatrix4f(v),u_tl_parent:new g.Uniform2f(v),u_scale_parent:new g.Uniform1f(v),u_fade_t:new g.Uniform1f(v),u_opacity:new g.Uniform1f(v),u_image0:new g.Uniform1i(v),u_image1:new g.Uniform1i(v),u_brightness_low:new g.Uniform1f(v),u_brightness_high:new g.Uniform1f(v),u_saturation_factor:new g.Uniform1f(v),u_contrast_factor:new g.Uniform1f(v),u_spin_weights:new g.Uniform3f(v),u_perspective_transform:new g.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new g.Uniform1i(v),u_is_size_feature_constant:new g.Uniform1i(v),u_size_t:new g.Uniform1f(v),u_size:new g.Uniform1f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_rotate_symbol:new g.Uniform1i(v),u_aspect_ratio:new g.Uniform1f(v),u_fade_change:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_label_plane_matrix:new g.UniformMatrix4f(v),u_coord_matrix:new g.UniformMatrix4f(v),u_is_text:new g.Uniform1i(v),u_pitch_with_map:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_camera_forward:new g.Uniform3f(v),u_tile_matrix:new g.UniformMatrix4f(v),u_up_vector:new g.Uniform3f(v),u_ecef_origin:new g.Uniform3f(v),u_texture:new g.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new g.Uniform1i(v),u_is_size_feature_constant:new g.Uniform1i(v),u_size_t:new g.Uniform1f(v),u_size:new g.Uniform1f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_rotate_symbol:new g.Uniform1i(v),u_aspect_ratio:new g.Uniform1f(v),u_fade_change:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_label_plane_matrix:new g.UniformMatrix4f(v),u_coord_matrix:new g.UniformMatrix4f(v),u_is_text:new g.Uniform1i(v),u_pitch_with_map:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_texture:new g.Uniform1i(v),u_gamma_scale:new g.Uniform1f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_tile_id:new g.Uniform3f(v),u_zoom_transition:new g.Uniform1f(v),u_inv_rot_matrix:new g.UniformMatrix4f(v),u_merc_center:new g.Uniform2f(v),u_camera_forward:new g.Uniform3f(v),u_tile_matrix:new g.UniformMatrix4f(v),u_up_vector:new g.Uniform3f(v),u_ecef_origin:new g.Uniform3f(v),u_is_halo:new g.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new g.Uniform1i(v),u_is_size_feature_constant:new g.Uniform1i(v),u_size_t:new g.Uniform1f(v),u_size:new g.Uniform1f(v),u_camera_to_center_distance:new g.Uniform1f(v),u_rotate_symbol:new g.Uniform1i(v),u_aspect_ratio:new g.Uniform1f(v),u_fade_change:new g.Uniform1f(v),u_matrix:new g.UniformMatrix4f(v),u_label_plane_matrix:new g.UniformMatrix4f(v),u_coord_matrix:new g.UniformMatrix4f(v),u_is_text:new g.Uniform1i(v),u_pitch_with_map:new g.Uniform1i(v),u_texsize:new g.Uniform2f(v),u_texsize_icon:new g.Uniform2f(v),u_texture:new g.Uniform1i(v),u_texture_icon:new g.Uniform1i(v),u_gamma_scale:new g.Uniform1f(v),u_device_pixel_ratio:new g.Uniform1f(v),u_is_halo:new g.Uniform1i(v)}),background:v=>({u_matrix:new g.UniformMatrix4f(v),u_opacity:new g.Uniform1f(v),u_color:new g.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new g.UniformMatrix4f(v),u_opacity:new g.Uniform1f(v),u_image:new g.Uniform1i(v),u_pattern_tl:new g.Uniform2f(v),u_pattern_br:new g.Uniform2f(v),u_texsize:new g.Uniform2f(v),u_pattern_size:new g.Uniform2f(v),u_pixel_coord_upper:new g.Uniform2f(v),u_pixel_coord_lower:new g.Uniform2f(v),u_tile_units_to_pixels:new g.Uniform1f(v)}),terrainRaster:rh,terrainDepth:rh,skybox:v=>({u_matrix:new g.UniformMatrix4f(v),u_sun_direction:new g.Uniform3f(v),u_cubemap:new g.Uniform1i(v),u_opacity:new g.Uniform1f(v),u_temporal_offset:new g.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new g.UniformMatrix4f(v),u_color_ramp:new g.Uniform1i(v),u_center_direction:new g.Uniform3f(v),u_radius:new g.Uniform1f(v),u_opacity:new g.Uniform1f(v),u_temporal_offset:new g.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new g.UniformMatrix3f(v),u_sun_direction:new g.Uniform3f(v),u_sun_intensity:new g.Uniform1f(v),u_color_tint_r:new g.Uniform4f(v),u_color_tint_m:new g.Uniform4f(v),u_luminance:new g.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new g.UniformMatrix4f(v),u_globe_matrix:new g.UniformMatrix4f(v),u_normalize_matrix:new g.UniformMatrix4f(v),u_merc_matrix:new g.UniformMatrix4f(v),u_zoom_transition:new g.Uniform1f(v),u_merc_center:new g.Uniform2f(v),u_image0:new g.Uniform1i(v),u_grid_matrix:new g.UniformMatrix3f(v),u_skirt_height:new g.Uniform1f(v),u_frustum_tl:new g.Uniform3f(v),u_frustum_tr:new g.Uniform3f(v),u_frustum_br:new g.Uniform3f(v),u_frustum_bl:new g.Uniform3f(v),u_globe_pos:new g.Uniform3f(v),u_globe_radius:new g.Uniform1f(v),u_viewport:new g.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new g.Uniform3f(v),u_frustum_tr:new g.Uniform3f(v),u_frustum_br:new g.Uniform3f(v),u_frustum_bl:new g.Uniform3f(v),u_horizon:new g.Uniform1f(v),u_transition:new g.Uniform1f(v),u_fadeout_range:new g.Uniform1f(v),u_color:new g.Uniform4f(v),u_high_color:new g.Uniform4f(v),u_space_color:new g.Uniform4f(v),u_star_intensity:new g.Uniform1f(v),u_star_density:new g.Uniform1f(v),u_star_size:new g.Uniform1f(v),u_temporal_offset:new g.Uniform1f(v),u_horizon_angle:new g.Uniform1f(v),u_rotation_matrix:new g.UniformMatrix4f(v)})};let Hs;function Wr(v,d,m,x,T,E,k){const O=v.context,B=O.gl,G=v.transform,q=v.useProgram("collisionBox"),J=[];let re=0,de=0;for(let Ee=0;Ee<x.length;Ee++){const Le=x[Ee],Pe=d.getTile(Le),Fe=Pe.getBucket(m);if(!Fe)continue;const $e=hi(Le,Fe,G);let it=$e;0===T[0]&&0===T[1]||(it=v.translatePosMatrix($e,Pe,T,E));const rt=k?Fe.textCollisionBox:Fe.iconCollisionBox,Vt=Fe.collisionCircleArray;if(Vt.length>0){const Ze=g.create(),Tt=it;g.mul(Ze,Fe.placementInvProjMatrix,G.glCoordMatrix),g.mul(Ze,Ze,Fe.placementViewportMatrix),J.push({circleArray:Vt,circleOffset:de,transform:Tt,invTransform:Ze,projection:Fe.getProjection()}),re+=Vt.length/4,de=re}rt&&(v.terrain&&v.terrain.setupElevationDraw(Pe,q),q.draw(O,B.LINES,g.DepthMode.disabled,g.StencilMode.disabled,v.colorModeForRenderPass(),g.CullFaceMode.disabled,vp(it,G,Pe,Fe.getProjection()),m.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,null,G.zoom,null,[rt.collisionVertexBuffer,rt.collisionVertexBufferExt]))}if(!k||!J.length)return;const le=v.useProgram("collisionCircle"),he=new g.StructArrayLayout2f1f2i16;he.resize(4*re),he._trim();let pe=0;for(const Ee of J)for(let Le=0;Le<Ee.circleArray.length/4;Le++){const Pe=4*Le,Fe=Ee.circleArray[Pe+0],$e=Ee.circleArray[Pe+1],it=Ee.circleArray[Pe+2],rt=Ee.circleArray[Pe+3];he.emplace(pe++,Fe,$e,it,rt,0),he.emplace(pe++,Fe,$e,it,rt,1),he.emplace(pe++,Fe,$e,it,rt,2),he.emplace(pe++,Fe,$e,it,rt,3)}(!Hs||Hs.length<2*re)&&(Hs=function(Ee){const Le=2*Ee,Pe=new g.StructArrayLayout3ui6;Pe.resize(Le),Pe._trim();for(let Fe=0;Fe<Le;Fe++){const $e=6*Fe;Pe.uint16[$e+0]=4*Fe+0,Pe.uint16[$e+1]=4*Fe+1,Pe.uint16[$e+2]=4*Fe+2,Pe.uint16[$e+3]=4*Fe+2,Pe.uint16[$e+4]=4*Fe+3,Pe.uint16[$e+5]=4*Fe+0}return Pe}(re));const oe=O.createIndexBuffer(Hs,!0),Ce=O.createVertexBuffer(he,g.collisionCircleLayout.members,!0);for(const Ee of J){const Le={u_matrix:Ee.transform,u_inv_matrix:Ee.invTransform,u_camera_to_center_distance:(xe=G).getCameraToCenterDistance(Ee.projection),u_viewport_size:[xe.width,xe.height]};le.draw(O,B.TRIANGLES,g.DepthMode.disabled,g.StencilMode.disabled,v.colorModeForRenderPass(),g.CullFaceMode.disabled,Le,m.id,Ce,oe,g.SegmentVector.simpleSegment(0,2*Ee.circleOffset,Ee.circleArray.length,Ee.circleArray.length/2),null,G.zoom)}var xe;Ce.destroy(),oe.destroy()}const tc=g.create();function Xo({width:v,height:d,anchor:m,textOffset:x,textScale:T},E){const{horizontalAlign:k,verticalAlign:O}=g.getAnchorAlignment(m),B=-(k-.5)*v,G=-(O-.5)*d,q=g.evaluateVariableOffset(m,x);return new g.pointGeometry((B/T+q[0])*E,(G/T+q[1])*E)}function Dl(v,d,m,x,T,E,k,O,B,G,q){const J=v.text.placedSymbolArray,re=v.text.dynamicLayoutVertexArray,de=v.icon.dynamicLayoutVertexArray,le={},he=v.getProjection(),pe=to(O,he,E),oe=E.elevation,Ce=he.upVectorScale(O.canonical,E.center.lat,E.worldSize).metersToTile;re.clear();for(let xe=0;xe<J.length;xe++){const Ee=J.get(xe),{tileAnchorX:Le,tileAnchorY:Pe,numGlyphs:Fe}=Ee,it=Ee.hidden||!Ee.crossTileID||v.allowVerticalPlacement&&!Ee.placedOrientation?null:x[Ee.crossTileID];if(it){let rt=0,Vt=0,Ze=0;if(oe){const vn=oe?oe.getAtTileOffset(O,Le,Pe):0,[li,hn,Jt]=he.upVector(O.canonical,Le,Pe);rt=vn*li*Ce,Vt=vn*hn*Ce,Ze=vn*Jt*Ce}let[Tt,dt,At,ot]=Zt(Ee.projectedAnchorX+rt,Ee.projectedAnchorY+Vt,Ee.projectedAnchorZ+Ze,m?pe:k);const je=wi(E.getCameraToCenterDistance(he),ot);let ct=T.evaluateSizeForFeature(v.textSizeData,G,Ee)*je/g.ONE_EM;m&&(ct*=v.tilePixelRatio/B);const Dt=Xo(it,ct);m?(({x:Tt,y:dt,z:At}=he.projectTilePoint(Le+Dt.x,Pe+Dt.y,O.canonical)),[Tt,dt,At]=Zt(Tt+rt,dt+Vt,At+Ze,k)):(d&&Dt._rotate(-E.angle),Tt+=Dt.x,dt+=Dt.y,At=0);const Ot=v.allowVerticalPlacement&&Ee.placedOrientation===g.WritingMode.vertical?Math.PI/2:0;for(let vn=0;vn<Fe;vn++)g.addDynamicAttributes(re,Tt,dt,At,Ot);q&&Ee.associatedIconIndex>=0&&(le[Ee.associatedIconIndex]={x:Tt,y:dt,z:At,angle:Ot})}else _o(Fe,re)}if(q){de.clear();const xe=v.icon.placedSymbolArray;for(let Ee=0;Ee<xe.length;Ee++){const Le=xe.get(Ee),{numGlyphs:Pe}=Le,Fe=le[Ee];if(Le.hidden||!Fe)_o(Pe,de);else{const{x:$e,y:it,z:rt,angle:Vt}=Fe;for(let Ze=0;Ze<Pe;Ze++)g.addDynamicAttributes(de,$e,it,rt,Vt)}}v.icon.dynamicLayoutVertexBuffer.updateData(de)}v.text.dynamicLayoutVertexBuffer.updateData(re)}function xp(v,d,m){return m.iconsInText&&d?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function Mi(v,d,m,x,T,E,k,O,B,G,q,J){const re=v.context,de=re.gl,le=v.transform,he="map"===O,pe="map"===B,oe=he&&"point"!==m.layout.get("symbol-placement"),Ce=he&&!pe&&!oe,xe=void 0!==m.layout.get("symbol-sort-key").constantOr(1);let Ee=!1;const Le=v.depthModeForSublayer(0,g.DepthMode.ReadOnly),Pe=[g.mercatorXfromLng(le.center.lng),g.mercatorYfromLat(le.center.lat)],Fe=m.layout.get("text-variable-anchor"),$e="globe"===le.projection.name,it=[],rt=[0,-1,0];let Vt=rt;!$e&&!le.mercatorFromTransition||he||(Vt=function(Ze){const Tt=Ze._camera.getWorldToCamera(Ze.worldSize,1),dt=g.multiply([],Tt,Ze.globeMatrix);g.invert(dt,dt);const At=[0,0,0],ot=[0,1,0,0];return g.transformMat4$1(ot,ot,dt),At[0]=ot[0],At[1]=ot[1],At[2]=ot[2],g.normalize(At,At),At}(le));for(const Ze of x){const Tt=d.getTile(Ze),dt=Tt.getBucket(m);if(!dt||"mercator"===dt.projection.name&&$e)continue;const At=T?dt.text:dt.icon;if(!At||dt.fullyClipped||!At.segments.get().length)continue;const ot=At.programConfigurations.get(m.id),je=T||dt.sdfIcons,ct=T?dt.textSizeData:dt.iconSizeData,Dt=pe||0!==le.pitch,Ot=g.evaluateSizeForZoom(ct,le.zoom);let vn,li,hn,Jt,Sn=[0,0],Ci=null;if(T)li=Tt.glyphAtlasTexture,hn=de.LINEAR,vn=Tt.glyphAtlasTexture.size,dt.iconsInText&&(Sn=Tt.imageAtlasTexture.size,Ci=Tt.imageAtlasTexture,Jt=Dt||v.options.rotating||v.options.zooming||"composite"===ct.kind||"camera"===ct.kind?de.LINEAR:de.NEAREST);else{const Ls=1!==m.layout.get("icon-size").constantOr(0)||dt.iconsNeedLinear;li=Tt.imageAtlasTexture,hn=je||v.options.rotating||v.options.zooming||Ls||Dt?de.LINEAR:de.NEAREST,vn=Tt.imageAtlasTexture.size}const In="globe"===dt.projection.name,Yi=In?Vt:rt,Qi=In?g.globeToMercatorTransition(le.zoom):0,yo=to(Ze,dt.getProjection(),le),io=le.calculatePixelsToTileUnitsMatrix(Tt),cr=Uu(yo,Tt.tileID.canonical,pe,he,le,dt.getProjection(),io),ys=v.terrain&&pe&&oe?g.invert(g.create(),cr):tc,la=Lc(yo,Tt.tileID.canonical,pe,he,le,dt.getProjection(),io),Pl=Fe&&dt.hasTextData(),Gi="none"!==m.layout.get("icon-text-fit")&&Pl&&dt.hasIconData();if(oe){const Ls=le.elevation,Ws=Ls?Ls.getAtTileOffsetFunc(Ze,le.center.lat,le.worldSize,dt.getProjection()):null,Ll=er(yo,Tt.tileID.canonical,pe,he,le,dt.getProjection(),io);oa(dt,yo,v,T,Ll,la,pe,G,Ws,Ze)}const bo=oe||T&&Fe||Gi,Pi=v.translatePosMatrix(yo,Tt,E,k),No=bo?tc:cr,Kr=v.translatePosMatrix(la,Tt,E,k,!0),xo=dt.getProjection().createInversionMatrix(le,Ze.canonical),Pr=[];v.terrainRenderModeElevated()&&pe&&Pr.push("PITCH_WITH_MAP_TERRAIN"),In&&Pr.push("PROJECTION_GLOBE_VIEW"),bo&&Pr.push("PROJECTED_POS_ON_VIEWPORT");const as=je&&0!==m.paint.get(T?"text-halo-width":"icon-halo-width").constantOr(1);let Ol;Ol=je?dt.iconsInText?Tn(ct.kind,Ot,Ce,pe,v,Pi,No,Kr,vn,Sn,Ze,Qi,Pe,xo,Yi,dt.getProjection()):nl(ct.kind,Ot,Ce,pe,v,Pi,No,Kr,T,vn,!0,Ze,Qi,Pe,xo,Yi,dt.getProjection()):Gr(ct.kind,Ot,Ce,pe,v,Pi,No,Kr,T,vn,Ze,Qi,Pe,xo,Yi,dt.getProjection());const Yc={program:v.useProgram(xp(je,T,dt),ot,Pr),buffers:At,uniformValues:Ol,atlasTexture:li,atlasTextureIcon:Ci,atlasInterpolation:hn,atlasInterpolationIcon:Jt,isSDF:je,hasHalo:as,tile:Tt,labelPlaneMatrixInv:ys};if(xe&&dt.canOverlap){Ee=!0;const Ls=At.segments.get();for(const Ws of Ls)it.push({segments:new g.SegmentVector([Ws]),sortKey:Ws.sortKey,state:Yc})}else it.push({segments:At.segments,sortKey:0,state:Yc})}Ee&&it.sort((Ze,Tt)=>Ze.sortKey-Tt.sortKey);for(const Ze of it){const Tt=Ze.state;if(v.terrain&&v.terrain.setupElevationDraw(Tt.tile,Tt.program,{useDepthForOcclusion:!$e,labelPlaneMatrixInv:Tt.labelPlaneMatrixInv}),re.activeTexture.set(de.TEXTURE0),Tt.atlasTexture.bind(Tt.atlasInterpolation,de.CLAMP_TO_EDGE),Tt.atlasTextureIcon&&(re.activeTexture.set(de.TEXTURE1),Tt.atlasTextureIcon&&Tt.atlasTextureIcon.bind(Tt.atlasInterpolationIcon,de.CLAMP_TO_EDGE)),Tt.isSDF){const dt=Tt.uniformValues;Tt.hasHalo&&(dt.u_is_halo=1,wp(Tt.buffers,Ze.segments,m,v,Tt.program,Le,q,J,dt)),dt.u_is_halo=0}wp(Tt.buffers,Ze.segments,m,v,Tt.program,Le,q,J,Tt.uniformValues)}}function wp(v,d,m,x,T,E,k,O,B){const G=x.context,q=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];T.draw(G,G.gl.TRIANGLES,E,k,O,g.CullFaceMode.disabled,B,m.id,v.layoutVertexBuffer,v.indexBuffer,d,m.paint,x.transform.zoom,v.programConfigurations.get(m.id),q)}function Qu(v,d,m,x,T,E,k){const O=v.context.gl,B=m.paint.get("fill-pattern"),G=B&&B.constantOr(1);let q,J,re,de,le;k?(J=G&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=O.LINES):(J=G?"fillPattern":"fill",q=O.TRIANGLES);for(const he of x){const pe=d.getTile(he);if(G&&!pe.patternsLoaded())continue;const oe=pe.getBucket(m);if(!oe)continue;v.prepareDrawTile();const Ce=oe.programConfigurations.get(m.id),xe=v.useProgram(J,Ce);G&&(v.context.activeTexture.set(O.TEXTURE0),pe.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ce.updatePaintBuffers());const Ee=B.constantOr(null);if(Ee&&pe.imageAtlas){const Pe=pe.imageAtlas.patternPositions[Ee.toString()];Pe&&Ce.setConstantPatternPositions(Pe)}const Le=v.translatePosMatrix(he.projMatrix,pe,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(k){de=oe.indexBuffer2,le=oe.segments2;const Pe=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];re="fillOutlinePattern"===J&&G?tl(Le,v,pe,Pe):tm(Le,Pe)}else de=oe.indexBuffer,le=oe.segments,re=G?Xu(Le,v,pe):Ku(Le);v.prepareDrawProgram(v.context,xe,he.toUnwrapped()),xe.draw(v.context,q,T,v.stencilModeForClipping(he),E,g.CullFaceMode.disabled,re,m.id,oe.layoutVertexBuffer,de,le,m.paint,v.transform.zoom,Ce)}}function Cp(v,d,m,x,T,E,k){const O=v.context,B=O.gl,G=v.transform,q=m.paint.get("fill-extrusion-pattern"),J=q.constantOr(1),re=m.paint.get("fill-extrusion-opacity"),de=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),m.paint.get("fill-extrusion-ambient-occlusion-radius")],le=m.layout.get("fill-extrusion-edge-radius"),he="globe"===G.projection.name?g.fillExtrusionHeightLift():0,pe="globe"===G.projection.name,oe=pe?g.globeToMercatorTransition(G.zoom):0,Ce=[g.mercatorXfromLng(G.center.lng),g.mercatorYfromLat(G.center.lat)],xe=[];pe&&xe.push("PROJECTION_GLOBE_VIEW"),de[0]>0&&xe.push("FAUX_AO");for(const Ee of x){const Le=d.getTile(Ee),Pe=Le.getBucket(m);if(!Pe||Pe.projection.name!==G.projection.name)continue;const Fe=Pe.programConfigurations.get(m.id),$e=v.useProgram(J?"fillExtrusionPattern":"fillExtrusion",Fe,xe);if(v.terrain){const At=v.terrain;if(v.style.terrainSetForDrapingOnly())At.setupElevationDraw(Le,$e,{useMeterToDem:!0});else{if(!Pe.enableTerrain)continue;if(At.setupElevationDraw(Le,$e,{useMeterToDem:!0}),Ju(O,d,Ee,Pe,m,At),!Pe.centroidVertexBuffer){const ot=$e.attributes.a_centroid_pos;void 0!==ot&&B.vertexAttrib2f(ot,0,0)}}}J&&(v.context.activeTexture.set(B.TEXTURE0),Le.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Fe.updatePaintBuffers());const it=q.constantOr(null);if(it&&Le.imageAtlas){const At=Le.imageAtlas.patternPositions[it.toString()];At&&Fe.setConstantPatternPositions(At)}const rt=v.translatePosMatrix(Ee.projMatrix,Le,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),Vt=G.projection.createInversionMatrix(G,Ee.canonical),Ze=m.paint.get("fill-extrusion-vertical-gradient"),Tt=J?Zu(rt,v,Ze,re,de,le,Ee,Le,he,oe,Ce,Vt):Xi(rt,v,Ze,re,de,le,Ee,he,oe,Ce,Vt);v.prepareDrawProgram(O,$e,Ee.toUnwrapped());const dt=[];v.terrain&&dt.push(Pe.centroidVertexBuffer),pe&&dt.push(Pe.layoutVertexExtBuffer),$e.draw(O,O.gl.TRIANGLES,T,E,k,g.CullFaceMode.backCCW,Tt,m.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,m.paint,v.transform.zoom,Fe,dt)}}function Ju(v,d,m,x,T,E){const k=[oe=>{let Ce=oe.canonical.x-1,xe=oe.wrap;return Ce<0&&(Ce=(1<<oe.canonical.z)-1,xe--),new g.OverscaledTileID(oe.overscaledZ,xe,oe.canonical.z,Ce,oe.canonical.y)},oe=>{let Ce=oe.canonical.x+1,xe=oe.wrap;return Ce===1<<oe.canonical.z&&(Ce=0,xe++),new g.OverscaledTileID(oe.overscaledZ,xe,oe.canonical.z,Ce,oe.canonical.y)},oe=>new g.OverscaledTileID(oe.overscaledZ,oe.wrap,oe.canonical.z,oe.canonical.x,(0===oe.canonical.y?1<<oe.canonical.z:oe.canonical.y)-1),oe=>new g.OverscaledTileID(oe.overscaledZ,oe.wrap,oe.canonical.z,oe.canonical.x,oe.canonical.y===(1<<oe.canonical.z)-1?0:oe.canonical.y+1)],O=oe=>{const Ce=d.getSource().minzoom,xe=Le=>{const Pe=d.getTileByID(Le);if(Pe&&Pe.hasData())return Pe.getBucket(T)},Ee=[0,-1,1];for(const Le of Ee){if(oe.overscaledZ+Le<Ce)continue;const Pe=xe(oe.calculateScaledKey(oe.overscaledZ+Le));if(Pe)return Pe}},B=[0,0,0],G=(oe,Ce)=>(B[0]=Math.min(oe.min.y,Ce.min.y),B[1]=Math.max(oe.max.y,Ce.max.y),B[2]=g.EXTENT-Ce.min.x>oe.max.x?Ce.min.x-g.EXTENT:oe.max.x,B),q=(oe,Ce)=>(B[0]=Math.min(oe.min.x,Ce.min.x),B[1]=Math.max(oe.max.x,Ce.max.x),B[2]=g.EXTENT-Ce.min.y>oe.max.y?Ce.min.y-g.EXTENT:oe.max.y,B),J=[(oe,Ce)=>G(oe,Ce),(oe,Ce)=>G(Ce,oe),(oe,Ce)=>q(oe,Ce),(oe,Ce)=>q(Ce,oe)],re=new g.pointGeometry(0,0);let de,le,he;const pe=(oe,Ce,xe,Ee,Le)=>{const Pe=[[Ee?xe:oe,Ee?oe:xe,0],[Ee?xe:Ce,Ee?Ce:xe,0]],Fe=Le<0?g.EXTENT+Le:Le,$e=[Ee?Fe:(oe+Ce)/2,Ee?(oe+Ce)/2:Fe,0];return 0===xe&&Le<0||0!==xe&&Le>0?E.getForTilePoints(he,[$e],!0,le):Pe.push($e),E.getForTilePoints(m,Pe,!0,de),Math.max(Pe[0][2],Pe[1][2],$e[2])/E.exaggeration()};for(let oe=0;oe<4;oe++){const Ce=(oe<2?1:5)-oe,xe=x.borders[oe];if(0===xe.length)continue;const Ee=he=k[oe](m),Le=O(Ee);if(!(Le&&Le instanceof g.FillExtrusionBucket&&Le.enableTerrain)||x.borderDoneWithNeighborZ[oe]===Le.canonical.z&&Le.borderDoneWithNeighborZ[Ce]===x.canonical.z||(le=E.findDEMTileFor(Ee),!le||!le.dem))continue;if(!de){const it=E.findDEMTileFor(m);if(!it||!it.dem)return;de=it}const Pe=Le.borders[Ce];let Fe=0;const $e=Le.borderDoneWithNeighborZ[Ce]!==x.canonical.z;if(x.canonical.z===Le.canonical.z){for(let it=0;it<xe.length;it++){const rt=x.featuresOnBorder[xe[it]],Vt=rt.borders[oe];let Ze;for(;Fe<Pe.length&&(Ze=Le.featuresOnBorder[Pe[Fe]],!(Ze.borders[Ce][1]>Vt[0]+3));)$e&&Le.encodeCentroid(void 0,Ze,!1),Fe++;if(Ze&&Fe<Pe.length){const Tt=Fe;let dt=0;for(;!(Ze.borders[Ce][0]>Vt[1]-3)&&(dt++,++Fe!==Pe.length);)Ze=Le.featuresOnBorder[Pe[Fe]];if(Ze=Le.featuresOnBorder[Pe[Tt]],rt.intersectsCount()>1||Ze.intersectsCount()>1||1!==dt){1!==dt&&(Fe=Tt),x.encodeCentroid(void 0,rt,!1),$e&&Le.encodeCentroid(void 0,Ze,!1);continue}const At=J[oe](rt,Ze),ot=oe%2?g.EXTENT-1:0;re.x=pe(At[0],Math.min(g.EXTENT-1,At[1]),ot,oe<2,At[2]),re.y=0,x.encodeCentroid(re,rt,!1),$e&&Le.encodeCentroid(re,Ze,!1)}else x.encodeCentroid(void 0,rt,!1)}x.borderDoneWithNeighborZ[oe]=Le.canonical.z,x.needsCentroidUpdate=!0,$e&&(Le.borderDoneWithNeighborZ[Ce]=x.canonical.z,Le.needsCentroidUpdate=!0)}else{for(const it of xe)x.encodeCentroid(void 0,x.featuresOnBorder[it],!1);if($e){for(const it of Pe)Le.encodeCentroid(void 0,Le.featuresOnBorder[it],!1);Le.borderDoneWithNeighborZ[Ce]=x.canonical.z,Le.needsCentroidUpdate=!0}x.borderDoneWithNeighborZ[oe]=Le.canonical.z,x.needsCentroidUpdate=!0}}(x.needsCentroidUpdate||!x.centroidVertexBuffer&&0!==x.centroidVertexArray.length)&&x.uploadCentroid(v)}const kr=new g.Color(1,0,0,1),Uc=new g.Color(0,1,0,1),jc=new g.Color(0,0,1,1),Ia=new g.Color(1,0,1,1),ed=new g.Color(0,1,1,1);function Tp(v,d,m){const x=v.context,T=v.transform,E=x.gl,k="globe"===T.projection.name,O=k?["PROJECTION_GLOBE_VIEW"]:null;let B=m.projMatrix;if(k&&g.globeToMercatorTransition(T.zoom)>0){const rt=g.transitionTileAABBinECEF(m.canonical,T),Vt=g.globeDenormalizeECEF(rt);B=g.multiply(new Float32Array(16),T.globeMatrix,Vt),g.multiply(B,T.projMatrix,B)}const G=v.useProgram("debug",null,O),q=d.getTileByID(m.key);v.terrain&&v.terrain.setupElevationDraw(q,G);const J=g.DepthMode.disabled,re=g.StencilMode.disabled,de=v.colorModeForRenderPass();x.activeTexture.set(E.TEXTURE0),v.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),k?q._makeGlobeTileDebugBuffers(v.context,T):q._makeDebugTileBoundsBuffers(v.context,T.projection);const he=q._tileDebugBuffer||v.debugBuffer,pe=q._tileDebugIndexBuffer||v.debugIndexBuffer,oe=q._tileDebugSegments||v.debugSegments;G.draw(x,E.LINE_STRIP,J,re,de,g.CullFaceMode.disabled,Yu(B,g.Color.red),"$debug",he,pe,oe,null,null,null,[q._globeTileDebugBorderBuffer]);const Ce=q.latestRawTileData,xe=Math.floor((Ce&&Ce.byteLength||0)/1024),Ee=d.getTile(m).tileSize,Le=512/Math.min(Ee,512)*(m.overscaledZ/T.zoom)*.5;let Pe=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Pe+=` => ${m.overscaledZ}`),Pe+=` ${xe}kb`,function(rt,Vt){rt.initDebugOverlayCanvas();const Ze=rt.debugOverlayCanvas,Tt=rt.context.gl,dt=rt.debugOverlayCanvas.getContext("2d");dt.clearRect(0,0,Ze.width,Ze.height),dt.shadowColor="white",dt.shadowBlur=2,dt.lineWidth=1.5,dt.strokeStyle="white",dt.textBaseline="top",dt.font="bold 36px Open Sans, sans-serif",dt.fillText(Vt,5,5),dt.strokeText(Vt,5,5),rt.debugOverlayTexture.update(Ze),rt.debugOverlayTexture.bind(Tt.LINEAR,Tt.CLAMP_TO_EDGE)}(v,Pe);const Fe=q._tileDebugTextBuffer||v.debugBuffer,$e=q._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,it=q._tileDebugTextSegments||v.debugSegments;G.draw(x,E.TRIANGLES,J,re,g.ColorMode.alphaBlended,g.CullFaceMode.disabled,Yu(B,g.Color.transparent,Le),"$debug",Fe,$e,it,null,null,null,[q._globeTileDebugTextBuffer])}function co(v,d,m,x){Hc(v,0,d+m/2,v.transform.width,m,x)}function lh(v,d,m,x){Hc(v,d-m/2,0,m,v.transform.height,x)}function Hc(v,d,m,x,T,E){const k=v.context,O=k.gl;O.enable(O.SCISSOR_TEST),O.scissor(d*g.exported.devicePixelRatio,m*g.exported.devicePixelRatio,x*g.exported.devicePixelRatio,T*g.exported.devicePixelRatio),k.clear({color:E}),O.disable(O.SCISSOR_TEST)}const $c=g.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ml}=$c;function aa(v,d,m,x){v.emplaceBack(d,m,x)}class kl{constructor(d){this.vertexArray=new g.StructArrayLayout3f12,this.indices=new g.StructArrayLayout3ui6,aa(this.vertexArray,-1,-1,1),aa(this.vertexArray,1,-1,1),aa(this.vertexArray,-1,1,1),aa(this.vertexArray,1,1,1),aa(this.vertexArray,-1,-1,-1),aa(this.vertexArray,1,-1,-1),aa(this.vertexArray,-1,1,-1),aa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=d.createVertexBuffer(this.vertexArray,Ml),this.indexBuffer=d.createIndexBuffer(this.indices),this.segment=g.SegmentVector.simpleSegment(0,0,36,12)}}function ei(v,d,m,x,T,E){const k=v.gl,O=d.paint.get("sky-atmosphere-color"),B=d.paint.get("sky-atmosphere-halo-color"),G=d.paint.get("sky-atmosphere-sun-intensity"),q={u_matrix_3f:g.fromMat4(g.create$1(),x),u_sun_direction:T,u_sun_intensity:G,u_color_tint_r:[(le=O).r,le.g,le.b,le.a],u_color_tint_m:[(he=B).r,he.g,he.b,he.a],u_luminance:5e-5};var le,he;k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_CUBE_MAP_POSITIVE_X+E,d.skyboxTexture,0),m.draw(v,k.TRIANGLES,g.DepthMode.disabled,g.StencilMode.disabled,g.ColorMode.unblended,g.CullFaceMode.frontCW,q,"skyboxCapture",d.skyboxGeometry.vertexBuffer,d.skyboxGeometry.indexBuffer,d.skyboxGeometry.segment)}const om=g.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class $s{constructor(d){const m=new g.StructArrayLayout5f20;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const x=new g.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,3,0),this.vertexBuffer=d.createVertexBuffer(m,om.members),this.indexBuffer=d.createIndexBuffer(x),this.segments=g.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Gs={symbol:function(v,d,m,x,T){if("translucent"!==v.renderPass)return;const E=g.StencilMode.disabled,k=v.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(O,B,G,q,J,re,de){const le=B.transform,he="map"===J,pe="map"===re;for(const oe of O){const Ce=q.getTile(oe),xe=Ce.getBucket(G);if(!xe||!xe.text||!xe.text.segments.get().length)continue;const Ee=g.evaluateSizeForZoom(xe.textSizeData,le.zoom),Le=to(oe,xe.getProjection(),le),Pe=le.calculatePixelsToTileUnitsMatrix(Ce),Fe=Uu(Le,Ce.tileID.canonical,pe,he,le,xe.getProjection(),Pe),$e="none"!==G.layout.get("icon-text-fit")&&xe.hasIconData();if(Ee){const it=Math.pow(2,le.zoom-Ce.tileID.overscaledZ);Dl(xe,he,pe,de,g.symbolSize,le,Fe,oe,it,Ee,$e)}}}(x,v,m,d,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),T),0!==m.paint.get("icon-opacity").constantOr(1)&&Mi(v,d,m,x,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),E,k),0!==m.paint.get("text-opacity").constantOr(1)&&Mi(v,d,m,x,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),E,k),d.map.showCollisionBoxes&&(Wr(v,d,m,x,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),Wr(v,d,m,x,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(v,d,m,x){if("translucent"!==v.renderPass)return;const T=m.paint.get("circle-opacity"),E=m.paint.get("circle-stroke-width"),k=m.paint.get("circle-stroke-opacity"),O=void 0!==m.layout.get("circle-sort-key").constantOr(1);if(0===T.constantOr(1)&&(0===E.constantOr(1)||0===k.constantOr(1)))return;const B=v.context,G=B.gl,q=v.transform,J=v.depthModeForSublayer(0,g.DepthMode.ReadOnly),re=g.StencilMode.disabled,de=v.colorModeForRenderPass(),le="globe"===q.projection.name,he=[g.mercatorXfromLng(q.center.lng),g.mercatorYfromLat(q.center.lat)],pe=[];for(let Ce=0;Ce<x.length;Ce++){const xe=x[Ce],Ee=d.getTile(xe),Le=Ee.getBucket(m);if(!Le||Le.projection.name!==q.projection.name)continue;const Pe=Le.programConfigurations.get(m.id),Fe=Qt(m);le&&Fe.push("PROJECTION_GLOBE_VIEW");const $e=v.useProgram("circle",Pe,Fe),it=Le.layoutVertexBuffer,rt=Le.globeExtVertexBuffer,Vt=Le.indexBuffer,Ze=q.projection.createInversionMatrix(q,xe.canonical),Tt={programConfiguration:Pe,program:$e,layoutVertexBuffer:it,globeExtVertexBuffer:rt,indexBuffer:Vt,uniformValues:ah(v,xe,Ee,Ze,he,m),tile:Ee};if(O){const dt=Le.segments.get();for(const At of dt)pe.push({segments:new g.SegmentVector([At]),sortKey:At.sortKey,state:Tt})}else pe.push({segments:Le.segments,sortKey:0,state:Tt})}O&&pe.sort((Ce,xe)=>Ce.sortKey-xe.sortKey);const oe={useDepthForOcclusion:!le};for(const Ce of pe){const{programConfiguration:xe,program:Ee,layoutVertexBuffer:Le,globeExtVertexBuffer:Pe,indexBuffer:Fe,uniformValues:$e,tile:it}=Ce.state,rt=Ce.segments;v.terrain&&v.terrain.setupElevationDraw(it,Ee,oe),v.prepareDrawProgram(B,Ee,it.tileID.toUnwrapped()),Ee.draw(B,G.TRIANGLES,J,re,de,g.CullFaceMode.disabled,$e,m.id,Le,Fe,rt,m.paint,q.zoom,xe,[Pe])}},heatmap:function(v,d,m,x){if(0!==m.paint.get("heatmap-opacity"))if("offscreen"===v.renderPass){const T=v.context,E=T.gl,k=g.StencilMode.disabled,O=new g.ColorMode([E.ONE,E.ONE],g.Color.transparent,[!0,!0,!0,!0]);(function(de,le,he,pe){const oe=de.gl,Ce=le.width*pe,xe=le.height*pe;de.activeTexture.set(oe.TEXTURE1),de.viewport.set([0,0,Ce,xe]);let Ee=he.heatmapFbo;if(!Ee||Ee&&(Ee.width!==Ce||Ee.height!==xe)){Ee&&Ee.destroy();const Le=oe.createTexture();oe.bindTexture(oe.TEXTURE_2D,Le),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_S,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_T,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MIN_FILTER,oe.LINEAR),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MAG_FILTER,oe.LINEAR),Ee=he.heatmapFbo=de.createFramebuffer(Ce,xe,!1),function(Pe,Fe,$e,it,rt,Vt){const Ze=Pe.gl;Ze.texImage2D(Ze.TEXTURE_2D,0,Pe.isWebGL2&&Pe.extRenderToTextureHalfFloat?Ze.RGBA16F:Ze.RGBA,rt,Vt,0,Ze.RGBA,Pe.extRenderToTextureHalfFloat?Pe.isWebGL2?Ze.HALF_FLOAT:Pe.extTextureHalfFloat.HALF_FLOAT_OES:Ze.UNSIGNED_BYTE,null),it.colorAttachment.set($e)}(de,0,Le,Ee,Ce,xe)}else oe.bindTexture(oe.TEXTURE_2D,Ee.colorAttachment.get()),de.bindFramebuffer.set(Ee.framebuffer)})(T,v,m,"globe"===v.transform.projection.name?.5:.25),T.clear({color:g.Color.transparent});const B=v.transform,G="globe"===B.projection.name,q=G?["PROJECTION_GLOBE_VIEW"]:null,J=G?g.CullFaceMode.frontCCW:g.CullFaceMode.disabled,re=[g.mercatorXfromLng(B.center.lng),g.mercatorYfromLat(B.center.lat)];for(let de=0;de<x.length;de++){const le=x[de];if(d.hasRenderableParent(le))continue;const he=d.getTile(le),pe=he.getBucket(m);if(!pe||pe.projection.name!==B.projection.name)continue;const oe=pe.programConfigurations.get(m.id),Ce=v.useProgram("heatmap",oe,q),{zoom:xe}=v.transform;v.terrain&&v.terrain.setupElevationDraw(he,Ce),v.prepareDrawProgram(T,Ce,le.toUnwrapped());const Ee=B.projection.createInversionMatrix(B,le.canonical);Ce.draw(T,E.TRIANGLES,g.DepthMode.disabled,k,O,J,pn(v,le,he,Ee,re,xe,m.paint.get("heatmap-intensity")),m.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,m.paint,v.transform.zoom,oe,G?[pe.globeExtVertexBuffer]:null)}T.viewport.set([0,0,v.width,v.height])}else"translucent"===v.renderPass&&(v.context.setColorMode(v.colorModeForRenderPass()),function(T,E){const k=T.context,O=k.gl,B=E.heatmapFbo;if(!B)return;k.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,B.colorAttachment.get()),k.activeTexture.set(O.TEXTURE1);let G=E.colorRampTexture;G||(G=E.colorRampTexture=new g.Texture(k,E.colorRamp,O.RGBA)),G.bind(O.LINEAR,O.CLAMP_TO_EDGE),T.useProgram("heatmapTexture").draw(k,O.TRIANGLES,g.DepthMode.disabled,g.StencilMode.disabled,T.colorModeForRenderPass(),g.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:E.paint.get("heatmap-opacity")},E.id,T.viewportBuffer,T.quadTriangleIndexBuffer,T.viewportSegments,E.paint,T.transform.zoom)}(v,m))},line:function(v,d,m,x){if("translucent"!==v.renderPass)return;const T=m.paint.get("line-opacity"),E=m.paint.get("line-width");if(0===T.constantOr(1)||0===E.constantOr(1))return;const k=v.depthModeForSublayer(0,g.DepthMode.ReadOnly),O=v.colorModeForRenderPass(),B=v.terrain&&v.terrain.renderingToTexture?1:g.exported.devicePixelRatio,G=m.paint.get("line-dasharray"),q=G.constantOr(1),J=m.layout.get("line-cap"),re=m.paint.get("line-pattern"),de=re.constantOr(1),le=m.paint.get("line-gradient"),he=de?"linePattern":"line",pe=v.context,oe=pe.gl,Ce=(Ee=>{const Le=[];no(Ee)&&Le.push("RENDER_LINE_DASH"),Ee.paint.get("line-gradient")&&Le.push("RENDER_LINE_GRADIENT");const Pe=Ee.paint.get("line-trim-offset");0===Pe[0]&&0===Pe[1]||Le.push("RENDER_LINE_TRIM_OFFSET");const Fe=Ee.paint.get("line-pattern").constantOr(1),$e=1!==Ee.paint.get("line-opacity").constantOr(1);return!Fe&&$e&&Le.push("RENDER_LINE_ALPHA_DISCARD"),Le})(m);let xe=Ce.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(xe=!1);for(const Ee of x){const Le=d.getTile(Ee);if(de&&!Le.patternsLoaded())continue;const Pe=Le.getBucket(m);if(!Pe)continue;v.prepareDrawTile();const Fe=Pe.programConfigurations.get(m.id),$e=v.useProgram(he,Fe,Ce),it=re.constantOr(null);if(it&&Le.imageAtlas){const je=Le.imageAtlas.patternPositions[it.toString()];je&&Fe.setConstantPatternPositions(je)}const rt=G.constantOr(null),Vt=J.constantOr(null);if(!de&&rt&&Vt&&Le.lineAtlas){const je=Le.lineAtlas.getDash(rt,Vt);je&&Fe.setConstantPatternPositions(je)}let[Ze,Tt]=m.paint.get("line-trim-offset");("round"===Vt||"square"===Vt)&&Ze!==Tt&&(0===Ze&&(Ze-=1),1===Tt&&(Tt+=1));const dt=v.terrain?Ee.projMatrix:null,At=de?im(v,Le,m,dt,B):nm(v,Le,m,dt,Pe.lineClipsArray.length,B,[Ze,Tt]);if(le){const je=Pe.gradients[m.id];let ct=je.texture;if(m.gradientVersion!==je.version){let Dt=256;if(m.stepInterpolant){const Ot=d.getSource().maxzoom,vn=Ee.canonical.z===Ot?Math.ceil(1<<v.transform.maxZoom-Ee.canonical.z):1;Dt=g.clamp(g.nextPowerOfTwo(Pe.maxLineLength/g.EXTENT*1024*vn),256,pe.maxTextureSize)}je.gradient=g.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:Dt,image:je.gradient||void 0,clips:Pe.lineClipsArray}),je.texture?je.texture.update(je.gradient):je.texture=new g.Texture(pe,je.gradient,oe.RGBA),je.version=m.gradientVersion,ct=je.texture}pe.activeTexture.set(oe.TEXTURE1),ct.bind(m.stepInterpolant?oe.NEAREST:oe.LINEAR,oe.CLAMP_TO_EDGE)}q&&(pe.activeTexture.set(oe.TEXTURE0),Le.lineAtlasTexture.bind(oe.LINEAR,oe.REPEAT),Fe.updatePaintBuffers()),de&&(pe.activeTexture.set(oe.TEXTURE0),Le.imageAtlasTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),Fe.updatePaintBuffers()),v.prepareDrawProgram(pe,$e,Ee.toUnwrapped());const ot=je=>{$e.draw(pe,oe.TRIANGLES,k,je,O,g.CullFaceMode.disabled,At,m.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,m.paint,v.transform.zoom,Fe,[Pe.layoutVertexBuffer2])};if(xe){const je=v.stencilModeForClipping(Ee).ref;0===je&&v.terrain&&pe.clear({stencil:0});const ct={func:oe.EQUAL,mask:255};At.u_alpha_discard_threshold=.8,ot(new g.StencilMode(ct,je,255,oe.KEEP,oe.KEEP,oe.INVERT)),At.u_alpha_discard_threshold=0,ot(new g.StencilMode(ct,je,255,oe.KEEP,oe.KEEP,oe.KEEP))}else ot(v.stencilModeForClipping(Ee))}xe&&(v.resetStencilClippingMasks(),v.terrain&&pe.clear({stencil:0}))},fill:function(v,d,m,x){const T=m.paint.get("fill-color"),E=m.paint.get("fill-opacity");if(0===E.constantOr(1))return;const k=v.colorModeForRenderPass(),O=m.paint.get("fill-pattern"),B=v.opaquePassEnabledForLayer()&&!O.constantOr(1)&&1===T.constantOr(g.Color.transparent).a&&1===E.constantOr(0)?"opaque":"translucent";if(v.renderPass===B){const G=v.depthModeForSublayer(1,"opaque"===v.renderPass?g.DepthMode.ReadWrite:g.DepthMode.ReadOnly);Qu(v,d,m,x,G,k,!1)}if("translucent"===v.renderPass&&m.paint.get("fill-antialias")){const G=v.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,g.DepthMode.ReadOnly);Qu(v,d,m,x,G,k,!0)}},"fill-extrusion":function(v,d,m,x){const T=m.paint.get("fill-extrusion-opacity");if(0!==T&&"translucent"===v.renderPass){const E=new g.DepthMode(v.context.gl.LEQUAL,g.DepthMode.ReadWrite,v.depthRangeFor3D);if(1!==T||m.paint.get("fill-extrusion-pattern").constantOr(1))Cp(v,d,m,x,E,g.StencilMode.disabled,g.ColorMode.disabled),Cp(v,d,m,x,E,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const k=v.colorModeForRenderPass();Cp(v,d,m,x,E,g.StencilMode.disabled,k)}}},hillshade:function(v,d,m,x){if("offscreen"!==v.renderPass&&"translucent"!==v.renderPass)return;const T=v.context,E=v.depthModeForSublayer(0,g.DepthMode.ReadOnly),k=v.colorModeForRenderPass(),O=v.terrain&&v.terrain.renderingToTexture,[B,G]="translucent"!==v.renderPass||O?[{},x]:v.stencilConfigForOverlap(x);for(const q of G){const J=d.getTile(q);if(J.needsHillshadePrepare&&"offscreen"===v.renderPass)yp(v,J,m,E,g.StencilMode.disabled,k);else if("translucent"===v.renderPass){const re=O&&v.terrain?v.terrain.stencilModeForRTTOverlap(q):B[q.overscaledZ];ih(v,q,J,m,E,re,k)}}T.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,d,m,x,T,E){if("translucent"!==v.renderPass||0===m.paint.get("raster-opacity")||!x.length)return;const k=v.context,O=k.gl,B=d.getSource(),G=v.useProgram("raster"),q=v.colorModeForRenderPass(),J=v.terrain&&v.terrain.renderingToTexture,[re,de]=B instanceof Re||J?[{},x]:v.stencilConfigForOverlap(x),le=de[de.length-1].overscaledZ,he=!v.options.moving;for(const pe of de){const oe=J?g.DepthMode.disabled:v.depthModeForSublayer(pe.overscaledZ-le,1===m.paint.get("raster-opacity")?g.DepthMode.ReadWrite:g.DepthMode.ReadOnly,O.LESS),Ce=pe.toUnwrapped(),xe=d.getTile(pe);if(J&&(!xe||!xe.hasData()))continue;const Ee=J?pe.projMatrix:v.transform.calculateProjMatrix(Ce,he),Le=v.terrain&&J?v.terrain.stencilModeForRTTOverlap(pe):re[pe.overscaledZ],Pe=E?0:m.paint.get("raster-fade-duration");xe.registerFadeDuration(Pe);const Fe=d.findLoadedParent(pe,0),$e=El(xe,Fe,d,v.transform,Pe);let it,rt;v.terrain&&v.terrain.prepareDrawTile();const Vt="nearest"===m.paint.get("raster-resampling")?O.NEAREST:O.LINEAR;k.activeTexture.set(O.TEXTURE0),xe.texture.bind(Vt,O.CLAMP_TO_EDGE),k.activeTexture.set(O.TEXTURE1),Fe?(Fe.texture.bind(Vt,O.CLAMP_TO_EDGE),it=Math.pow(2,Fe.tileID.overscaledZ-xe.tileID.overscaledZ),rt=[xe.tileID.canonical.x*it%1,xe.tileID.canonical.y*it%1]):xe.texture.bind(Vt,O.CLAMP_TO_EDGE);const Ze=ss(Ee,rt||[0,0],it||1,$e,m,B instanceof Re?B.perspectiveTransform:[0,0]);if(v.prepareDrawProgram(k,G,Ce),B instanceof Re)B.boundsBuffer&&B.boundsSegments&&G.draw(k,O.TRIANGLES,oe,g.StencilMode.disabled,q,g.CullFaceMode.disabled,Ze,m.id,B.boundsBuffer,v.quadTriangleIndexBuffer,B.boundsSegments);else{const{tileBoundsBuffer:Tt,tileBoundsIndexBuffer:dt,tileBoundsSegments:At}=v.getTileBoundsBuffers(xe);G.draw(k,O.TRIANGLES,oe,Le,q,g.CullFaceMode.disabled,Ze,m.id,Tt,dt,At)}}v.resetStencilClippingMasks()},background:function(v,d,m,x){const T=m.paint.get("background-color"),E=m.paint.get("background-opacity");if(0===E)return;const k=v.context,O=k.gl,B=v.transform,G=B.tileSize,q=m.paint.get("background-pattern");if(v.isPatternMissing(q))return;const J=!q&&1===T.a&&1===E&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==J)return;const re=g.StencilMode.disabled,de=v.depthModeForSublayer(0,"opaque"===J?g.DepthMode.ReadWrite:g.DepthMode.ReadOnly),le=v.colorModeForRenderPass(),he=v.useProgram(q?"backgroundPattern":"background");let pe,oe=x;oe||(pe=v.getBackgroundTiles(),oe=Object.values(pe).map(Ce=>Ce.tileID)),q&&(k.activeTexture.set(O.TEXTURE0),v.imageManager.bind(v.context));for(const Ce of oe){const xe=Ce.toUnwrapped(),Ee=x?Ce.projMatrix:v.transform.calculateProjMatrix(xe);v.prepareDrawTile();const Le=d?d.getTile(Ce):pe?pe[Ce.key]:new g.Tile(Ce,G,B.zoom,v),Pe=q?jo(Ee,E,v,q,{tileID:Ce,tileSize:G}):Di(Ee,E,T);v.prepareDrawProgram(k,he,xe);const{tileBoundsBuffer:Fe,tileBoundsIndexBuffer:$e,tileBoundsSegments:it}=v.getTileBoundsBuffers(Le);he.draw(k,O.TRIANGLES,de,re,le,g.CullFaceMode.disabled,Pe,m.id,Fe,$e,it)}},sky:function(v,d,m){const x=v.transform,T="mercator"===x.projection.name||"globe"===x.projection.name?1:g.smoothstep(7,8,x.zoom),E=m.paint.get("sky-opacity")*T;if(0===E)return;const k=v.context,O=m.paint.get("sky-type"),B=new g.DepthMode(k.gl.LEQUAL,g.DepthMode.ReadOnly,[0,1]),G=v.frameCounter/1e3%1;"atmosphere"===O?"offscreen"===v.renderPass?m.needsSkyboxCapture(v)&&(function(q,J,re,de){const le=q.context,he=le.gl;let pe=J.skyboxFbo;if(!pe){pe=J.skyboxFbo=le.createFramebuffer(32,32,!1),J.skyboxGeometry=new kl(le),J.skyboxTexture=le.gl.createTexture(),he.bindTexture(he.TEXTURE_CUBE_MAP,J.skyboxTexture),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MAG_FILTER,he.LINEAR);for(let Ee=0;Ee<6;++Ee)he.texImage2D(he.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,he.RGBA,32,32,0,he.RGBA,he.UNSIGNED_BYTE,null)}le.bindFramebuffer.set(pe.framebuffer),le.viewport.set([0,0,32,32]);const oe=J.getCenter(q,!0),Ce=q.useProgram("skyboxCapture"),xe=new Float64Array(16);g.identity(xe),g.rotateY(xe,xe,.5*-Math.PI),ei(le,J,Ce,xe,oe,0),g.identity(xe),g.rotateY(xe,xe,.5*Math.PI),ei(le,J,Ce,xe,oe,1),g.identity(xe),g.rotateX(xe,xe,.5*-Math.PI),ei(le,J,Ce,xe,oe,2),g.identity(xe),g.rotateX(xe,xe,.5*Math.PI),ei(le,J,Ce,xe,oe,3),g.identity(xe),ei(le,J,Ce,xe,oe,4),g.identity(xe),g.rotateY(xe,xe,Math.PI),ei(le,J,Ce,xe,oe,5),le.viewport.set([0,0,q.width,q.height])}(v,m),m.markSkyboxValid(v)):"sky"===v.renderPass&&function(q,J,re,de,le){const he=q.context,pe=he.gl,oe=q.transform,Ce=q.useProgram("skybox");he.activeTexture.set(pe.TEXTURE0),pe.bindTexture(pe.TEXTURE_CUBE_MAP,J.skyboxTexture);const xe={u_matrix:oe.skyboxMatrix,u_sun_direction:J.getCenter(q,!1),u_cubemap:0,u_opacity:de,u_temporal_offset:le};q.prepareDrawProgram(he,Ce),Ce.draw(he,pe.TRIANGLES,re,g.StencilMode.disabled,q.colorModeForRenderPass(),g.CullFaceMode.backCW,xe,"skybox",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)}(v,m,B,E,G):"gradient"===O&&"sky"===v.renderPass&&function(q,J,re,de,le){const he=q.context,pe=he.gl,oe=q.transform,Ce=q.useProgram("skyboxGradient");J.skyboxGeometry||(J.skyboxGeometry=new kl(he)),he.activeTexture.set(pe.TEXTURE0);let xe=J.colorRampTexture;xe||(xe=J.colorRampTexture=new g.Texture(he,J.colorRamp,pe.RGBA)),xe.bind(pe.LINEAR,pe.CLAMP_TO_EDGE);const Ee=(Le=oe.skyboxMatrix,Pe=J.getCenter(q,!1),Fe=J.paint.get("sky-gradient-radius"),$e=de,it=le,{u_matrix:Le,u_color_ramp:0,u_center_direction:Pe,u_radius:g.degToRad(Fe),u_opacity:$e,u_temporal_offset:it});var Le,Pe,Fe,$e,it;q.prepareDrawProgram(he,Ce),Ce.draw(he,pe.TRIANGLES,re,g.StencilMode.disabled,q.colorModeForRenderPass(),g.CullFaceMode.backCW,Ee,"skyboxGradient",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)}(v,m,B,E,G)},debug:function(v,d,m){for(let x=0;x<m.length;x++)Tp(v,d,m[x])},custom:function(v,d,m,x){const T=v.context,E=m.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||"offscreen"===v.renderPass)&&m.isLayerDraped()){if("offscreen"===v.renderPass){const k=E.prerender;if(k){if(v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),"globe"===v.transform.projection.name){const O=v.transform.pointMerc;k.call(E,T.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),g.globeToMercatorTransition(v.transform.zoom),[O.x,O.y],v.transform.pixelsPerMeterRatio)}else k.call(E,T.gl,v.transform.customLayerMatrix());T.setDirty(),v.setBaseState()}}else if("translucent"===v.renderPass){if(v.terrain&&v.terrain.renderingToTexture){const O=E.renderToTile;if(O){const B=x[0].canonical,G=new g.MercatorCoordinate(B.x+x[0].wrap*(1<<B.z),B.y,B.z);T.setDepthMode(g.DepthMode.disabled),T.setStencilMode(g.StencilMode.disabled),T.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),O.call(E,T.gl,G),T.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),T.setStencilMode(g.StencilMode.disabled);const k="3d"===E.renderingMode?new g.DepthMode(v.context.gl.LEQUAL,g.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,g.DepthMode.ReadOnly);if(T.setDepthMode(k),"globe"===v.transform.projection.name){const O=v.transform.pointMerc;E.render(T.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),g.globeToMercatorTransition(v.transform.zoom),[O.x,O.y],v.transform.pixelsPerMeterRatio)}else E.render(T.gl,v.transform.customLayerMatrix());T.setDirty(),v.setBaseState(),T.bindFramebuffer.set(null)}}else g.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Gc{constructor(d,m,x=!1){this.context=new ye(d,x),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=g.SourceCache.maxUnderzooming+g.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new th,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(d,m){const x=!!d&&!!d.terrain&&this.transform.projection.supportsTerrain;if(!(x||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new el(this,d));const T=this._terrain;this.transform.elevation=x?T:null,T.update(d,this.transform,m)}_updateFog(d){const m=d.fog;if(!m||"globe"===this.transform.projection.name||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[x,T]=m.getFovAdjustedRange(this.transform._fov);if(x>T)return void(this.transform.fogCullDistSq=null);const E=x+.78*(T-x);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(d,m){if(this.width=d*g.exported.devicePixelRatio,this.height=m*g.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style.order)this.style._layers[x].resize()}setup(){const d=this.context,m=new g.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(g.EXTENT,0),m.emplaceBack(0,g.EXTENT),m.emplaceBack(g.EXTENT,g.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(m,g.posAttributes.members),this.tileExtentSegments=g.SegmentVector.simpleSegment(0,0,4,2);const x=new g.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(g.EXTENT,0),x.emplaceBack(0,g.EXTENT),x.emplaceBack(g.EXTENT,g.EXTENT),this.debugBuffer=d.createVertexBuffer(x,g.posAttributes.members),this.debugSegments=g.SegmentVector.simpleSegment(0,0,4,5);const T=new g.StructArrayLayout2i4;T.emplaceBack(-1,-1),T.emplaceBack(1,-1),T.emplaceBack(-1,1),T.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(T,g.posAttributes.members),this.viewportSegments=g.SegmentVector.simpleSegment(0,0,4,2);const E=new g.StructArrayLayout4i8;E.emplaceBack(0,0,0,0),E.emplaceBack(g.EXTENT,0,g.EXTENT,0),E.emplaceBack(0,g.EXTENT,0,g.EXTENT),E.emplaceBack(g.EXTENT,g.EXTENT,g.EXTENT,g.EXTENT),this.mercatorBoundsBuffer=d.createVertexBuffer(E,g.boundsAttributes.members),this.mercatorBoundsSegments=g.SegmentVector.simpleSegment(0,0,4,2);const k=new g.StructArrayLayout3ui6;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(k);const O=new g.StructArrayLayout1ui2;for(const G of[0,1,3,2,0])O.emplaceBack(G);this.debugIndexBuffer=d.createIndexBuffer(O),this.emptyTexture=new g.Texture(d,new g.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),d.gl.RGBA),this.identityMat=g.create();const B=this.context.gl;this.stencilClearMode=new g.StencilMode({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO),this.loadTimeStamps.push(g.window.performance.now()),this.atmosphereBuffer=new $s(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(d){return d._makeTileBoundsBuffers(this.context,this.transform.projection),d._tileBoundsBuffer?{tileBoundsBuffer:d._tileBoundsBuffer,tileBoundsIndexBuffer:d._tileBoundsIndexBuffer,tileBoundsSegments:d._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const d=this.context,m=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(d,m.TRIANGLES,g.DepthMode.disabled,this.stencilClearMode,g.ColorMode.disabled,g.CullFaceMode.disabled,ki(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(d,m,x){if(!m||this.currentStencilSource===m.id||!d.isTileClipped()||!x||0===x.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const B of x)if(void 0===this._tileClippingMaskIDs[B.key]){O=!0;break}if(!O)return}this.currentStencilSource=m.id;const T=this.context,E=T.gl;this.nextStencilID+x.length>256&&this.clearStencil(),T.setColorMode(g.ColorMode.disabled),T.setDepthMode(g.DepthMode.disabled);const k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of x){const B=m.getTile(O),G=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:q,tileBoundsIndexBuffer:J,tileBoundsSegments:re}=this.getTileBoundsBuffers(B);k.draw(T,E.TRIANGLES,g.DepthMode.disabled,new g.StencilMode({func:E.ALWAYS,mask:0},G,255,E.KEEP,E.KEEP,E.REPLACE),g.ColorMode.disabled,g.CullFaceMode.disabled,ki(O.projMatrix),"$clipping",q,J,re)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const d=this.nextStencilID++,m=this.context.gl;return new g.StencilMode({func:m.NOTEQUAL,mask:255},d,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(d){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(d);const m=this.context.gl;return new g.StencilMode({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(d){const m=this.context.gl,x=d.sort((k,O)=>O.overscaledZ-k.overscaledZ),T=x[x.length-1].overscaledZ,E=x[0].overscaledZ-T+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const k={};for(let O=0;O<E;O++)k[O+T]=new g.StencilMode({func:m.GEQUAL,mask:255},O+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=E,[k,x]}return[{[T]:g.StencilMode.disabled},x]}colorModeForRenderPass(){const d=this.context.gl;return this._showOverdrawInspector?new g.ColorMode([d.CONSTANT_COLOR,d.ONE],new g.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?g.ColorMode.unblended:g.ColorMode.alphaBlended}depthModeForSublayer(d,m,x){if(!this.opaquePassEnabledForLayer())return g.DepthMode.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new g.DepthMode(x||this.context.gl.LEQUAL,m,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(d,m){this.style=d,this.options=m,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(g.exported.now()),this.imageManager.beginFrame();const x=this.style.order,T=this.style._sourceCaches;for(const B in T){const G=T[B];G.used&&G.prepare(this.context)}const E={},k={},O={};for(const B in T){const G=T[B];E[B]=G.getVisibleCoordinates(),k[B]=E[B].slice().reverse(),O[B]=G.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<x.length;B++)if(this.style._layers[x[B]].is3D()){this.opaquePassCutoff=B;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new g.GlobeSharedBuffers(this.context)),g.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const B of x){const G=this.style._layers[B],q=d._getLayerSourceCache(G);if(!G.hasOffscreenPass()||G.isHidden(this.transform.zoom))continue;const J=q?k[q.id]:void 0;("custom"===G.type||G.isSky()||J&&J.length)&&this.renderLayer(this,q,G,J)}if(this.depthRangeFor3D=[0,1-(d.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:m.showOverdrawInspector?g.Color.black:g.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[x[this.currentLayer]],G=d._getLayerSourceCache(B);if(B.isSky())continue;const q=G?k[G.id]:void 0;this._renderTileClippingMasks(B,G,q),this.renderLayer(this,G,B,q)}if(this.style.fog&&this.transform.projection.supportsFog&&function(B,G){const q=B.context,J=q.gl,re=B.transform,de=new g.DepthMode(J.LEQUAL,g.DepthMode.ReadOnly,[0,1]),le=B.useProgram("globeAtmosphere",null,"globe"===re.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),he=g.globeToMercatorTransition(re.zoom),pe=G.properties.get("color").toArray01(),oe=G.properties.get("high-color").toArray01(),Ce=G.properties.get("space-color").toArray01PremultipliedAlpha(),xe=g.identity$1([]);g.rotateY$1(xe,xe,-g.degToRad(re._center.lng)),g.rotateX$1(xe,xe,g.degToRad(re._center.lat)),g.rotateZ$1(xe,xe,re.angle),g.rotateX$1(xe,xe,-re._pitch);const Ee=g.fromQuat(new Float32Array(16),xe),Le=g.mapValue(G.properties.get("star-intensity"),0,1,0,.25),Fe=g.mapValue(G.properties.get("horizon-blend"),0,1,5e-4,.25),$e=g.globeUseCustomAntiAliasing(B,q,re)&&5e-4===Fe?re.worldSize/(2*Math.PI*1.025)-1:re.globeRadius,it=B.frameCounter/1e3%1,rt=g.length(re.globeCenterInViewSpace),Vt=Math.sqrt(Math.pow(rt,2)-Math.pow($e,2)),Ze=Math.acos(Vt/rt),Tt={u_frustum_tl:re.frustumCorners.TL,u_frustum_tr:re.frustumCorners.TR,u_frustum_br:re.frustumCorners.BR,u_frustum_bl:re.frustumCorners.BL,u_horizon:re.frustumCorners.horizon,u_transition:he,u_fadeout_range:Fe,u_color:pe,u_high_color:oe,u_space_color:Ce,u_star_intensity:Le,u_star_size:5*g.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:it,u_horizon_angle:Ze,u_rotation_matrix:Ee};B.prepareDrawProgram(q,le);const dt=B.atmosphereBuffer;dt&&le.draw(q,J.TRIANGLES,de,g.StencilMode.disabled,g.ColorMode.alphaBlended,g.CullFaceMode.backCW,Tt,"skybox",dt.vertexBuffer,dt.indexBuffer,dt.segments)}(this,this.style.fog),this.renderPass="sky",(g.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const B=this.style._layers[x[this.currentLayer]],G=d._getLayerSourceCache(B);B.isSky()&&this.renderLayer(this,G,B,G?k[G.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;){const B=this.style._layers[x[this.currentLayer]],G=d._getLayerSourceCache(B);if(B.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(B)){if(B.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const q=G?("symbol"===B.type?O:k)[G.id]:void 0;this._renderTileClippingMasks(B,G,G?E[G.id]:void 0),this.renderLayer(this,G,B,q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let B=null;g.values(this.style._layers).forEach(G=>{const q=d._getLayerSourceCache(G);q&&!G.isHidden(this.transform.zoom)&&(!B||B.getSource().maxzoom<q.getSource().maxzoom)&&(B=q)}),B&&this.options.showTileBoundaries&&Gs.debug(this,B,B.getVisibleCoordinates())}this.options.showPadding&&function(B){const G=B.transform.padding;co(B,B.transform.height-(G.top||0),3,kr),co(B,G.bottom||0,3,Uc),lh(B,G.left||0,3,jc),lh(B,B.transform.width-(G.right||0),3,Ia);const q=B.transform.centerPoint;var J,re,de,le;Hc(J=B,(re=q.x)-1,(de=B.transform.height-q.y)-10,2,20,le=ed),Hc(J,re-10,de-1,20,2,le)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(g.window.performance.now()),this.saveCanvasCopy())}}renderLayer(d,m,x,T){x.isHidden(this.transform.zoom)||("background"===x.type||"sky"===x.type||"custom"===x.type||T&&T.length)&&(this.id=x.id,this.gpuTimingStart(x),(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes(x.type)||d.terrain&&"custom"===x.type)&&Gs[x.type](d,m,x,T,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(d){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let x=this.gpuTimers[d.id];x||(x=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),x.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const d=this.context.extTimerQuery,m=d.createQueryEXT();this.deferredRenderGpuTimeQueries.push(m),d.beginQueryEXT(d.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}collectGpuTimers(){const d=this.gpuTimers;return this.gpuTimers={},d}collectDeferredRenderGpuQueries(){const d=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],d}queryGpuTimers(d){const m={};for(const x in d){const T=d[x],E=this.context.extTimerQuery,k=E.getQueryObjectEXT(T.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(T.query),m[x]=k}return m}queryGpuTimeDeferredRender(d){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery;let x=0;for(const T of d)x+=m.getQueryObjectEXT(T,m.QUERY_RESULT_EXT)/1e6,m.deleteQueryEXT(T);return x}translatePosMatrix(d,m,x,T,E){if(!x[0]&&!x[1])return d;const k=E?"map"===T?this.transform.angle:0:"viewport"===T?-this.transform.angle:0;if(k){const G=Math.sin(k),q=Math.cos(k);x=[x[0]*q-x[1]*G,x[0]*G+x[1]*q]}const O=[E?x[0]:fs(m,x[0],this.transform.zoom),E?x[1]:fs(m,x[1],this.transform.zoom),0],B=new Float32Array(16);return g.translate(B,d,O),B}saveTileTexture(d){const m=this._tileTextures[d.size[0]];m?m.push(d):this._tileTextures[d.size[0]]=[d]}getTileTexture(d){const m=this._tileTextures[d];return m&&m.length>0?m.pop():null}isPatternMissing(d){return null===d||void 0!==d&&!this.imageManager.getPattern(d.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const d=this.terrain&&this.terrain.renderingToTexture,m=this.terrain&&0===this.terrain.exaggeration(),x=this.style&&this.style.fog,T=[];return this.terrainRenderModeElevated()&&T.push("TERRAIN"),"globe"===this.transform.projection.name&&T.push("GLOBE"),m&&T.push("ZERO_EXAGGERATION"),x&&!d&&0!==x.getOpacity(this.transform.pitch)&&T.push("FOG"),d&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}useProgram(d,m,x){this.cache=this.cache||{};const T=x||[],E=this.currentGlobalDefines().concat(T),k=ra.cacheKey(qg[d],d,E,m);return this.cache[k]||(this.cache[k]=new ra(this.context,d,qg[d],m,Ea[d],E)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=g.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new g.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(d,m,x){if(this.terrain&&this.terrain.renderingToTexture)return;const T=this.style.fog;if(T){const E=T.getOpacity(this.transform.pitch),k=((O,B,G,q,J,re,de,le,he,pe,oe)=>{const Ce=O.transform,xe=B.properties.get("color").toArray01();xe[3]=q;const Ee=O.frameCounter/1e3%1;return{u_fog_matrix:G?Ce.calculateFogTileMatrix(G):O.identityMat,u_fog_range:B.getFovAdjustedRange(Ce._fov),u_fog_color:xe,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_temporal_offset:Ee,u_frustum_tl:J,u_frustum_tr:re,u_frustum_br:de,u_frustum_bl:le,u_globe_pos:he,u_globe_radius:pe,u_viewport:oe,u_globe_transition:g.globeToMercatorTransition(Ce.zoom),u_is_globe:+("globe"===Ce.projection.name)}})(this,T,x,E,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*g.exported.devicePixelRatio,this.transform.height*g.exported.devicePixelRatio]);m.setFogUniformValues(d,k)}}setTileLoadedFlag(d){this.tileLoaded=d}saveCanvasCopy(){const d=this.canvasCopy();d&&(this.frameCopies.push(d),this.tileLoaded=!1)}canvasCopy(){const d=this.context.gl,m=d.createTexture();return d.bindTexture(d.TEXTURE_2D,m),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,0,0,d.drawingBufferWidth,d.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const d=this.style&&this.style.fog;return!!d&&0!==d.getOpacity(this.transform.pitch)}getBackgroundTiles(){const d=this._backgroundTiles,m=this._backgroundTiles={},x=this.transform.coveringTiles({tileSize:512});for(const T of x)m[T.key]=d[T.key]||new g.Tile(T,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}}class Wc{constructor(d=0,m=0,x=0,T=0){if(isNaN(d)||d<0||isNaN(m)||m<0||isNaN(x)||x<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=m,this.left=x,this.right=T}interpolate(d,m,x){return null!=m.top&&null!=d.top&&(this.top=g.number(d.top,m.top,x)),null!=m.bottom&&null!=d.bottom&&(this.bottom=g.number(d.bottom,m.bottom,x)),null!=m.left&&null!=d.left&&(this.left=g.number(d.left,m.left,x)),null!=m.right&&null!=d.right&&(this.right=g.number(d.right,m.right,x)),this}getCenter(d,m){const x=g.clamp((this.left+d-this.right)/2,0,d),T=g.clamp((this.top+m-this.bottom)/2,0,m);return new g.pointGeometry(x,T)}equals(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right}clone(){return new Wc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ch(v,d){const m=g.getColumn(v,3);g.fromQuat(v,d),g.setColumn(v,3,m)}function As(v,d){const m=g.identity$1([]);return g.rotateZ$1(m,m,-d),g.rotateX$1(m,m,-v),m}function Xg(v,d){const m=[v[0],v[1],0],x=[d[0],d[1],0];if(g.length(m)>=1e-15){const k=g.normalize([],m);g.scale$2(x,k,g.dot(x,k)),d[0]=x[0],d[1]=x[1]}const T=g.cross([],d,v);if(g.len(T)<1e-15)return null;const E=Math.atan2(-T[1],T[0]);return As(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),E)}class rm{constructor(d,m){this.position=d,this.orientation=m}get position(){return this._position}set position(d){if(d){const m=d instanceof g.MercatorCoordinate?d:new g.MercatorCoordinate(d[0],d[1],d[2]);this._renderWorldCopies&&(m.x=g.wrap(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(d,m){if(this.orientation=null,!this.position)return;const x=this._elevation?this._elevation.getAtPointOrZero(g.MercatorCoordinate.fromLngLat(d)):0,T=this.position,E=g.MercatorCoordinate.fromLngLat(d,x),k=[E.x-T.x,E.y-T.y,E.z-T.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=Xg(k,m)}setPitchBearing(d,m){this.orientation=As(g.degToRad(d),g.degToRad(-m))}}class td{constructor(d,m){this._transform=g.identity([]),this.orientation=m,this.position=d}get mercatorPosition(){const d=this.position;return new g.MercatorCoordinate(d[0],d[1],d[2])}get position(){const d=g.getColumn(this._transform,3);return[d[0],d[1],d[2]]}set position(d){var m;d&&g.setColumn(this._transform,3,[(m=d)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(d){this._orientation=d||g.identity$1([]),d&&ch(this._transform,this._orientation)}getPitchBearing(){const d=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2])}}setPitchBearing(d,m){this._orientation=As(d,m),ch(this._transform,this._orientation)}forward(){const d=g.getColumn(this._transform,2);return[-d[0],-d[1],-d[2]]}up(){const d=g.getColumn(this._transform,1);return[-d[0],-d[1],-d[2]]}right(){const d=g.getColumn(this._transform,0);return[d[0],d[1],d[2]]}getCameraToWorld(d,m){const x=new Float64Array(16);return g.invert(x,this.getWorldToCamera(d,m)),x}getWorldToCameraPosition(d,m,x){const T=this.position;g.scale$2(T,T,-d);const E=new Float64Array(16);return g.fromScaling(E,[x,x,x]),g.translate(E,E,T),E[10]*=m,E}getWorldToCamera(d,m){const x=new Float64Array(16),T=new Float64Array(4),E=this.position;return g.conjugate(T,this._orientation),g.scale$2(E,E,-d),g.fromQuat(x,T),g.translate(x,x,E),x[1]*=-1,x[5]*=-1,x[9]*=-1,x[13]*=-1,x[8]*=m,x[9]*=m,x[10]*=m,x[11]*=m,x}getCameraToClipPerspective(d,m,x,T){const E=new Float64Array(16);return g.perspective(E,d,m,x,T),E}getDistanceToElevation(d,m=!1){const x=0===d?0:g.mercatorZfromAltitude(d,m?g.latFromMercatorY(this.position[1]):this.position[1]),T=this.forward();return(x-this.position[2])/T[2]}clone(){return new td([...this.position],[...this.orientation])}}function nd(v,d){const m=id(v.projection,v.zoom,v.width,v.height),x=function(E,k,O,B,G){const q=new g.LngLat(O.lng-180*od,O.lat),J=new g.LngLat(O.lng+180*od,O.lat),re=E.project(q.lng,q.lat),de=E.project(J.lng,J.lat),le=-Math.atan2(de.y-re.y,de.x-re.x),he=g.MercatorCoordinate.fromLngLat(O);he.y=g.clamp(he.y,-.999975,.999975);const pe=he.toLngLat(),oe=E.project(pe.lng,pe.lat),Ce=g.MercatorCoordinate.fromLngLat(pe);Ce.x+=od;const xe=Ce.toLngLat(),Ee=E.project(xe.lng,xe.lat),Le=Ep(Ee.x-oe.x,Ee.y-oe.y,le),Pe=g.MercatorCoordinate.fromLngLat(pe);Pe.y+=od;const Fe=Pe.toLngLat(),$e=E.project(Fe.lng,Fe.lat),it=Ep($e.x-oe.x,$e.y-oe.y,le),rt=Math.abs(Le.x)/Math.abs(it.y),Vt=g.identity([]);g.rotateZ(Vt,Vt,-le*(1-(G?0:B)));const Ze=g.identity([]);return g.scale(Ze,Ze,[1,1-(1-rt)*B,1]),Ze[4]=-it.x/it.y*B,g.rotateZ(Ze,Ze,le),g.multiply(Ze,Vt,Ze),Ze}(v.projection,0,v.center,m,d),T=sm(v);return g.scale(x,x,[T,T,1]),x}function sm(v){const d=v.projection,m=id(v.projection,v.zoom,v.width,v.height),x=Sp(d,v.center),T=Sp(d,g.LngLat.convert(d.center));return Math.pow(2,x*m+(1-m)*T)}function id(v,d,m,x,T=1/0){const E=v.range;if(!E)return 0;const k=Math.min(T,Math.max(m,x)),O=Math.log(k/1024)/Math.LN2;return g.smoothstep(E[0]+O,E[1]+O,d)}const od=1/4e4;function Sp(v,d){const m=g.clamp(d.lat,-g.MAX_MERCATOR_LATITUDE,g.MAX_MERCATOR_LATITUDE),x=new g.LngLat(d.lng-180*od,m),T=new g.LngLat(d.lng+180*od,m),E=v.project(x.lng,m),k=v.project(T.lng,m),O=g.MercatorCoordinate.fromLngLat(x),B=g.MercatorCoordinate.fromLngLat(T),G=k.x-E.x,q=k.y-E.y,J=B.x-O.x,re=B.y-O.y,de=Math.sqrt((J*J+re*re)/(G*G+q*q));return Math.log(de)/Math.LN2}function Ep(v,d,m){const x=Math.cos(m),T=Math.sin(m);return{x:v*x-d*T,y:v*T+d*x}}class on{constructor(d,m,x,T,E,k,O){this.tileSize=512,this._renderWorldCopies=void 0===E||E,this._minZoom=d||0,this._maxZoom=m||22,this._minPitch=x??0,this._maxPitch=T??60,this.setProjection(k),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new g.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Wc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new td,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const d=new on(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return d._elevation=this._elevation,d._centerAltitude=this._centerAltitude,d._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,d.tileSize=this.tileSize,d.mercatorFromTransition=this.mercatorFromTransition,d.width=this.width,d.height=this.height,d.cameraElevationReference=this.cameraElevationReference,d._center=this._center,d._setZoom(this.zoom),d._seaLevelZoom=this._seaLevelZoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._nearZ=this._nearZ,d._farZ=this._farZ,d._averageElevation=this._averageElevation,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._camera=this._camera.clone(),d._calcMatrices(),d.freezeTileCoverage=this.freezeTileCoverage,d.frustumCorners=this.frustumCorners,d}get elevation(){return this._elevation}set elevation(d){this._elevation!==d&&(this._elevation=d,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(d,m=!1){const x=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||x)&&this._updateCameraOnTerrain(),(d||x)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return g.pick(this.projection,["name","center","parallels"])}setProjection(d){this.projectionOptions=d||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=g.getProjection(this.projectionOptions);const x=!se(m,this.getProjection());return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setMercatorFromTransition(){const d=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=g.getProjection({name:"mercator"});const m=d!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))}get maxZoom(){return this._maxZoom}set maxZoom(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))}get minPitch(){return this._minPitch}set minPitch(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))}get maxPitch(){return this._maxPitch}set maxPitch(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(d){void 0===d?d=!0:null===d&&(d=!1),this._renderWorldCopies=d}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get cameraWorldSize(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return g.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new g.pointGeometry(this.width,this.height)}get bearing(){return g.wrap(this.rotation,-180,180)}set bearing(d){this.rotation=d}get rotation(){return-this.angle/Math.PI*180}set rotation(d){const m=-d*Math.PI/180;var x,T,E,k,O,B,G,q,J,re;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(x=new g.ARRAY_TYPE(4),g.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x),T=this.rotationMatrix,k=this.angle,O=(E=this.rotationMatrix)[0],B=E[1],G=E[2],q=E[3],J=Math.sin(k),re=Math.cos(k),T[0]=O*re+G*J,T[1]=B*re+q*J,T[2]=O*-J+G*re,T[3]=B*-J+q*re)}get pitch(){return this._pitch/Math.PI*180}set pitch(d){const m=g.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const d=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/d)}set fov(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=g.degToRad(d),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(d){this._averageElevation=d,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(d){const m=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(d){this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const d=this._elevation;this._centerAltitude=d.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=d.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const d=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],x=this.horizonLineFromTop();let T=0,E=0;for(let k=0;k<m.length;k++){const O=new g.pointGeometry(m[k][0]*this.width,x+m[k][1]*(this.height-x)),B=d.pointCoordinate(O);if(!B)continue;const G=1/Math.hypot(B[0]-this._camera.position[0],B[1]-this._camera.position[1]);T+=B[3]*G,E+=G}return 0===E?NaN:T/E}get center(){return this._center}set center(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const d=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),x=this.pixelsPerMeter/this.worldSize*m,T=this._mercatorZfromZoom(d),E=this._mercatorZfromZoom(this._maxZoom),k=Math.max(T-x,E);this._setZoom(this._zoomFromMercatorZ(k))}get padding(){return this._edgeInsets.toJSON()}set padding(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())}computeZoomRelativeTo(d){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,d.toAltitude()));let x;x=d.z<this._camera.position[2]?[m.x,m.y,m.z]:[d.x,d.y,d.z];const T=g.length(g.sub([],this._camera.position,x));return g.clamp(this._zoomFromMercatorZ(T),this._minZoom,this._maxZoom)}setFreeCameraOptions(d){if(!this.height||!d.position&&!d.orientation)return;this._updateCameraState();let m=!1;if(d.orientation&&!g.exactEquals(d.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(d.orientation)),d.position){const x=[d.position.x,d.position.y,d.position.z];g.exactEquals$1(x,this._camera.position)||(this._setCameraPosition(x),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const d=this._camera.position,m=new rm;return m.position=new g.MercatorCoordinate(d[0],d[1],d[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(d){if(!g.length$1(d))return!1;g.normalize$1(d,d);const m=g.transformQuat([],[0,0,-1],d),x=g.transformQuat([],[0,-1,0],d);if(x[2]<0)return!1;const T=Xg(m,x);return!!T&&(this._camera.orientation=T,!0)}_setCameraPosition(d){const m=this.zoomScale(this.minZoom)*this.tileSize,x=this.zoomScale(this.maxZoom)*this.tileSize,T=this.cameraToCenterDistance;d[2]=g.clamp(d[2],T/x,T/m),this._camera.position=d}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(d){return this._edgeInsets.equals(d)}interpolatePadding(d,m,x){this._unmodified=!1,this._edgeInsets.interpolate(d,m,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(d){const m=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(d){const m=[new g.UnwrappedTileID(0,d)];if(this.renderWorldCopies){const x=this.pointCoordinate(new g.pointGeometry(0,0)),T=this.pointCoordinate(new g.pointGeometry(this.width,0)),E=this.pointCoordinate(new g.pointGeometry(this.width,this.height)),k=this.pointCoordinate(new g.pointGeometry(0,this.height)),O=Math.floor(Math.min(x.x,T.x,E.x,k.x)),B=Math.floor(Math.max(x.x,T.x,E.x,k.x)),G=1;for(let q=O-G;q<=B+G;q++)0!==q&&m.push(new g.UnwrappedTileID(q,d))}return m}coveringTiles(d){let m=this.coveringZoomLevel(d);const x=m,T=this.elevation&&!d.isTerrainDEM,E="mercator"===this.projection.name;if(void 0!==d.minzoom&&m<d.minzoom)return[];void 0!==d.maxzoom&&m>d.maxzoom&&(m=d.maxzoom);const k=this.locationCoordinate(this.center),O=this.center.lat,B=1<<m,G=[B*k.x,B*k.y,0],q="globe"===this.projection.name,J=!q,re=g.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,J),de=q?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),le=B*g.mercatorZfromAltitude(1,this.center.lat),he=this._camera.position[2]/g.mercatorZfromAltitude(1,this.center.lat),pe=[B*de.x,B*de.y,he*(J?1:le)],oe=this.cameraToCenterDistance/d.tileSize*(d.roundZoom?1:.502),Ce=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?m:0,xe=d.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ee=d.isTerrainDEM?-xe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Le=this.projection.isReprojectedInTileSpace?sm(this):1,Pe=ot=>{const ct=new g.MercatorCoordinate(ot.x+25e-6,ot.y,ot.z),Dt=new g.MercatorCoordinate(ot.x,ot.y+25e-6,ot.z),Ot=ot.toLngLat(),vn=ct.toLngLat(),li=Dt.toLngLat(),hn=this.locationCoordinate(Ot),Jt=this.locationCoordinate(vn),Sn=this.locationCoordinate(li),Ci=Math.hypot(Jt.x-hn.x,Jt.y-hn.y),In=Math.hypot(Sn.x-hn.x,Sn.y-hn.y);return Math.sqrt(Ci*In)*Le/25e-6},Fe=ot=>{const je=xe,ct=Ee;return{aabb:g.tileAABB(this,B,0,0,0,ot,ct,je,this.projection),zoom:0,x:0,y:0,minZ:ct,maxZ:je,wrap:ot,fullyVisible:!1}},$e=[];let it=[];const rt=m,Vt=d.reparseOverscaled?x:m,Ze=ot=>ot*ot,Tt=Ze((he-this._centerAltitude)*le),dt=ot=>{if(!this._elevation||!ot.tileID||!E)return;const je=this._elevation.getMinMaxForTile(ot.tileID),ct=ot.aabb;je?(ct.min[2]=je.min,ct.max[2]=je.max,ct.center[2]=(ct.min[2]+ct.max[2])/2):(ot.shouldSplit=At(ot),ot.shouldSplit||(ct.min[2]=ct.max[2]=ct.center[2]=this._centerAltitude))},At=ot=>{if(ot.zoom<Ce)return!0;if(ot.zoom===rt)return!1;if(null!=ot.shouldSplit)return ot.shouldSplit;const je=ot.aabb.distanceX(pe),ct=ot.aabb.distanceY(pe);let Dt=Tt,Ot=1;if(q){Dt=Ze(ot.aabb.distanceZ(pe));const hn=Math.pow(2,ot.zoom),Jt=g.latFromMercatorY((ot.y+1)/hn),Sn=g.latFromMercatorY(ot.y/hn),Ci=Math.min(Math.max(O,Jt),Sn),In=g.circumferenceAtLatitude(Ci)/g.circumferenceAtLatitude(O);if(Ot=Ci===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,In/this._mercatorScaleRatio),this.zoom<=g.GLOBE_ZOOM_THRESHOLD_MIN&&ot.zoom===rt-1&&In>=.9)return!0}else if(T&&(Dt=Ze(ot.aabb.distanceZ(pe)*le)),this.projection.isReprojectedInTileSpace&&x<=5){const hn=Math.pow(2,ot.zoom),Jt=Pe(new g.MercatorCoordinate((ot.x+.5)/hn,(ot.y+.5)/hn));Ot=Jt>.85?1:Jt}const vn=je*je+ct*ct+Dt;return vn<Ze((1<<rt-ot.zoom)*oe*Ot*((hn,Jt)=>{if(Jt*Ze(.707)<hn)return 1;const Sn=Math.sqrt(Jt/hn);return Sn/(1.4144271570014144+(Math.pow(1.1,Sn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Dt,Tt),vn))};if(this.renderWorldCopies)for(let ot=1;ot<=3;ot++)$e.push(Fe(-ot)),$e.push(Fe(ot));for($e.push(Fe(0));$e.length>0;){const ot=$e.pop(),je=ot.x,ct=ot.y;let Dt=ot.fullyVisible;if(!Dt){const Ot=ot.aabb.intersects(re);if(0===Ot)continue;Dt=2===Ot}if(ot.zoom!==rt&&At(ot))for(let Ot=0;Ot<4;Ot++){const vn=(je<<1)+Ot%2,li=(ct<<1)+(Ot>>1),hn={aabb:E?ot.aabb.quadrant(Ot):g.tileAABB(this,B,ot.zoom+1,vn,li,ot.wrap,ot.minZ,ot.maxZ,this.projection),zoom:ot.zoom+1,x:vn,y:li,wrap:ot.wrap,fullyVisible:Dt,tileID:void 0,shouldSplit:void 0,minZ:ot.minZ,maxZ:ot.maxZ};T&&!q&&(hn.tileID=new g.OverscaledTileID(ot.zoom+1===rt?Vt:ot.zoom+1,ot.wrap,ot.zoom+1,vn,li),dt(hn)),$e.push(hn)}else{const Ot=ot.zoom===rt?Vt:ot.zoom;if(d.minzoom&&d.minzoom>Ot)continue;const vn=G[0]-(.5+je+(ot.wrap<<ot.zoom))*(1<<m-ot.zoom),li=G[1]-.5-ct,hn=ot.tileID?ot.tileID:new g.OverscaledTileID(Ot,ot.wrap,ot.zoom,je,ct);it.push({tileID:hn,distanceSq:vn*vn+li*li})}}if(this.fogCullDistSq){const ot=this.fogCullDistSq,je=this.horizonLineFromTop();it=it.filter(ct=>{const Dt=[0,0,0,1],Ot=[g.EXTENT,g.EXTENT,0,1],vn=this.calculateFogTileMatrix(ct.tileID.toUnwrapped());g.transformMat4$1(Dt,Dt,vn),g.transformMat4$1(Ot,Ot,vn);const li=g.getAABBPointSquareDist(Dt,Ot);if(0===li)return!0;let hn=!1;const Jt=this._elevation;if(Jt&&li>ot&&0!==je){const Sn=this.calculateProjMatrix(ct.tileID.toUnwrapped());let Ci;d.isTerrainDEM||(Ci=Jt.getMinMaxForTile(ct.tileID)),Ci||(Ci={min:Ee,max:xe});const In=g.furthestTileCorner(this.rotation),Yi=[In[0]*g.EXTENT,In[1]*g.EXTENT,Ci.max];g.transformMat4(Yi,Yi,Sn),hn=(1-Yi[1])*this.height*.5<je}return li<ot||hn})}return it.sort((ot,je)=>ot.distanceSq-je.distanceSq).map(ot=>ot.tileID)}resize(d,m){this.width=d,this.height=m,this.pixelsToGLUnits=[2/d,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(d){return Math.pow(2,d)}scaleZoom(d){return Math.log(d)/Math.LN2}project(d){const m=g.clamp(d.lat,-g.MAX_MERCATOR_LATITUDE,g.MAX_MERCATOR_LATITUDE),x=this.projection.project(d.lng,m);return new g.pointGeometry(x.x*this.worldSize,x.y*this.worldSize)}unproject(d){return this.projection.unproject(d.x/this.worldSize,d.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/g.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(d,m){let x,T;const E=this.centerPoint;if("globe"===this.projection.name){const O=this.worldSize;x=(m.x-E.x)/O,T=(m.y-E.y)/O}else{const O=this.pointCoordinate(m),B=this.pointCoordinate(E);x=O.x-B.x,T=O.y-B.y}const k=this.locationCoordinate(d);this.setLocation(new g.MercatorCoordinate(k.x-x,k.y-T))}setLocation(d){this.center=this.coordinateLocation(d),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(d){return this.projection.locationPoint(this,d)}locationPoint3D(d){return this.projection.locationPoint(this,d,!0)}pointLocation(d){return this.coordinateLocation(this.pointCoordinate(d))}pointLocation3D(d){return this.coordinateLocation(this.pointCoordinate3D(d))}locationCoordinate(d,m){const x=m?g.mercatorZfromAltitude(m,d.lat):void 0,T=this.projection.project(d.lng,d.lat);return new g.MercatorCoordinate(T.x,T.y,x)}coordinateLocation(d){return this.projection.unproject(d.x,d.y)}pointRayIntersection(d,m){const x=m??this._centerAltitude,T=[d.x,d.y,0,1],E=[d.x,d.y,1,1];g.transformMat4$1(T,T,this.pixelMatrixInverse),g.transformMat4$1(E,E,this.pixelMatrixInverse);const k=E[3];g.scale$1(T,T,1/T[3]),g.scale$1(E,E,1/k);const O=T[2],B=E[2];return{p0:T,p1:E,t:O===B?0:(x-O)/(B-O)}}screenPointToMercatorRay(d){const m=[d.x,d.y,0,1],x=[d.x,d.y,1,1];return g.transformMat4$1(m,m,this.pixelMatrixInverse),g.transformMat4$1(x,x,this.pixelMatrixInverse),g.scale$1(m,m,1/m[3]),g.scale$1(x,x,1/x[3]),m[2]=g.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,x[2]=g.mercatorZfromAltitude(x[2],this._center.lat)*this.worldSize,g.scale$1(m,m,1/this.worldSize),g.scale$1(x,x,1/this.worldSize),new g.Ray([m[0],m[1],m[2]],g.normalize([],g.sub([],x,m)))}rayIntersectionCoordinate(d){const{p0:m,p1:x,t:T}=d,E=g.mercatorZfromAltitude(m[2],this._center.lat),k=g.mercatorZfromAltitude(x[2],this._center.lat);return new g.MercatorCoordinate(g.number(m[0],x[0],T)/this.worldSize,g.number(m[1],x[1],T)/this.worldSize,g.number(E,k,T))}pointCoordinate(d,m=this._centerAltitude){return this.projection.pointCoordinate(this,d.x,d.y,m)}pointCoordinate3D(d){if(!this.elevation)return this.pointCoordinate(d);let m=this.projection.pointCoordinate3D(this,d.x,d.y);if(m)return new g.MercatorCoordinate(m[0],m[1],m[2]);let x=0,T=this.horizonLineFromTop();if(d.y>T)return this.pointCoordinate(d);const E=.02*T,k=d.clone();for(let O=0;O<10&&T-x>E;O++){k.y=g.number(x,T,.66);const B=this.projection.pointCoordinate3D(this,k.x,k.y);B?(T=k.y,m=B):x=k.y}return m?new g.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(d)}isPointAboveHorizon(d){return this.projection.isPointAboveHorizon(this,d)}_coordinatePoint(d,m){const x=m&&this.elevation?this.elevation.getAtPointOrZero(d,this._centerAltitude):this._centerAltitude,T=[d.x*this.worldSize,d.y*this.worldSize,x+d.toAltitude(),1];return g.transformMat4$1(T,T,this.pixelMatrix),T[3]>0?new g.pointGeometry(T[0]/T[3],T[1]/T[3]):new g.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:d,left:m}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,E=this.pointLocation3D(new g.pointGeometry(m,d)),k=this.pointLocation3D(new g.pointGeometry(T,d)),O=this.pointLocation3D(new g.pointGeometry(T,x)),B=this.pointLocation3D(new g.pointGeometry(m,x));let G=Math.min(E.lng,k.lng,O.lng,B.lng),q=Math.max(E.lng,k.lng,O.lng,B.lng),J=Math.min(E.lat,k.lat,O.lat,B.lat),re=Math.max(E.lat,k.lat,O.lat,B.lat);const de=Math.pow(2,-this.zoom)/16*270,le="globe"===this.projection.name?1:4,he=(pe,oe,Ce,xe,Ee)=>{const Le=(pe+Ce)/2,Pe=(oe+xe)/2,Fe=new g.pointGeometry(Le,Pe),{lng:$e,lat:it}=this.pointLocation3D(Fe),rt=Math.max(0,G-$e,J-it,$e-q,it-re);G=Math.min(G,$e),q=Math.max(q,$e),J=Math.min(J,it),re=Math.max(re,it),(Ee<le||rt>de)&&(he(pe,oe,Le,Pe,Ee+1),he(Le,Pe,Ce,xe,Ee+1))};if(he(m,d,T,d,1),he(T,d,T,x,1),he(T,x,m,x,1),he(m,x,m,d,1),"globe"===this.projection.name){const[pe,oe]=g.polesInViewport(this);pe?(re=90,q=180,G=-180):oe&&(J=-90,q=180,G=-180)}return new g.LngLatBounds(new g.LngLat(G,J),new g.LngLat(q,re))}_getBoundsRectangular(d,m){const{top:x,left:T}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,k=this.width-this._edgeInsets.right,O=new g.pointGeometry(T,x),B=new g.pointGeometry(k,x),G=new g.pointGeometry(k,E),q=new g.pointGeometry(T,E);let J=this.pointCoordinate(O,d),re=this.pointCoordinate(B,d);const de=this.pointCoordinate(G,m),le=this.pointCoordinate(q,m),he=(pe,oe)=>(oe.y-pe.y)/(oe.x-pe.x);return J.y>1&&re.y>=0?J=new g.MercatorCoordinate((1-le.y)/he(le,J)+le.x,1):J.y<0&&re.y<=1&&(J=new g.MercatorCoordinate(-le.y/he(le,J)+le.x,0)),re.y>1&&J.y>=0?re=new g.MercatorCoordinate((1-de.y)/he(de,re)+de.x,1):re.y<0&&J.y<=1&&(re=new g.MercatorCoordinate(-de.y/he(de,re)+de.x,0)),(new g.LngLatBounds).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(de))}_getBoundsRectangularTerrain(){const d=this.elevation;if(!d.visibleDemTiles.length||d.isUsingMockSource())return this._getBoundsRectangular(0,0);const m=d.visibleDemTiles.reduce((x,T)=>{if(T.dem){const E=T.dem.tree;x.min=Math.min(x.min,E.minimums[0]),x.max=Math.max(x.max,E.maximums[0])}return x},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(m.min*d.exaggeration(),m.max*d.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(d=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,x=this.height/2-m*(1-this._horizonShift);return d?Math.max(0,x):x}getMaxBounds(){return this.maxBounds}setMaxBounds(d){this.maxBounds=d,this.minLat=-g.MAX_MERCATOR_LATITUDE,this.maxLat=g.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,d&&(this.minLat=d.getSouth(),this.maxLat=d.getNorth(),this.minLng=d.getWest(),this.maxLng=d.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=g.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=g.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=g.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=g.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(d,m){return this.projection.createTileMatrix(this,m,d)}calculateDistanceTileData(d){const m=d.key,x=this._distanceTileDataCache;if(x[m])return x[m];const T=d.canonical,E=1/this.height,k=this.cameraWorldSize,O=k/this.zoomScale(T.z),B=(T.x+Math.pow(2,T.z)*d.wrap)*O,G=T.y*O,q=this.point;q.x*=k/this.worldSize,q.y*=k/this.worldSize;const J=this.angle,re=Math.sin(-J),de=-Math.cos(-J);return x[m]={bearing:[re,de],center:[(q.x-B)*E,(q.y-G)*E],scale:O/g.EXTENT*E},x[m]}calculateFogTileMatrix(d){const m=d.key,x=this._fogTileMatrixCache;if(x[m])return x[m];const T=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,d);return g.multiply(T,this.worldToFogMatrix,T),x[m]=new Float32Array(T),x[m]}calculateProjMatrix(d,m=!1){const x=d.key,T=m?this._alignedProjMatrixCache:this._projMatrixCache;if(T[x])return T[x];const E=this.calculatePosMatrix(d,this.worldSize);return g.multiply(E,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.alignedProjMatrix:this.projMatrix,E),T[x]=new Float32Array(E),T[x]}calculatePixelsToTileUnitsMatrix(d){const m=d.tileID.key,x=this._pixelsToTileUnitsCache;if(x[m])return x[m];const T=function(E,k){const{scale:O}=E.tileTransform,B=O*g.EXTENT/(E.tileSize*Math.pow(2,k.zoom-E.tileID.overscaledZ+E.tileID.canonical.z));return G=new Float32Array(4),re=(q=k.inverseAdjustmentMatrix)[1],de=q[2],le=q[3],pe=(J=[B,B])[1],G[0]=q[0]*(he=J[0]),G[1]=re*he,G[2]=de*pe,G[3]=le*pe,G;var G,q,J,re,de,le,he,pe}(d,this);return x[m]=T,x[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const d=1/this.worldSize,m=g.fromScaling([],[d,d,d]);return g.multiply(m,m,this.globeMatrix),m}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const d=this._elevation;this._updateCameraState();const m=g.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(m),T=this._camera.forward(),E=g.mercatorZfromAltitude(1,this._center.lat);x[2]/=E,T[2]/=E,g.normalize(T,T);const k=d.raycast(x,T,d.exaggeration());if(k){const O=g.scaleAndAdd([],x,T,k),B=new g.MercatorCoordinate(O[0],O[1],g.mercatorZfromAltitude(O[2],g.latFromMercatorY(O[1]))),G=(B.z+g.length([B.x-x[0],B.y-x[1],B.z-x[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=B.toAltitude(),this._center=this.coordinateLocation(B),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(d=!1){if(!this._elevation)return;const m=this._elevation,x=g.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,T=this._computeCameraPosition(x),E=m.getAtPointOrZero(new g.MercatorCoordinate(...T)),k=this.pixelsPerMeter/this.worldSize*E,O=this._minimumHeightOverTerrain(),B=T[2]-k;if(B<=O)if(B<0||d){const G=this.locationCoordinate(this._center,this._centerAltitude),q=[T[0],T[1],G.z-T[2]],J=g.length(q);q[2]-=(O-B)/this._pixelsPerMercatorPixel;const re=g.length(q);if(0===re)return;g.scale$2(q,q,J/re*this._pixelsPerMercatorPixel),this._camera.position=[T[0],T[1],G.z*this._pixelsPerMercatorPixel-q[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const d="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||d){const re=this.center;return re.lat=g.clamp(re.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!d)&&(re.lng=g.clamp(re.lng,this.minLng,this.maxLng)),this.center=re,void(this._constraining=!1)}const m=this._unmodified,{x,y:T}=this.point;let E=0,k=x,O=T;const B=this.width/2,G=this.height/2,q=this.worldMinY*this.scale,J=this.worldMaxY*this.scale;if(T-G<q&&(O=q+G),T+G>J&&(O=J-G),J-q<this.height&&(E=Math.max(E,this.height/(J-q)),O=(J+q)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const re=this.worldMinX*this.scale,de=this.worldMaxX*this.scale,le=this.worldSize/2-(re+de)/2;k=(x+le+this.worldSize)%this.worldSize-le,k-B<re&&(k=re+B),k+B>de&&(k=de-B),de-re<this.width&&(E=Math.max(E,this.width/(de-re)),k=(de+re)/2)}k===x&&O===T||(this.center=this.unproject(new g.pointGeometry(k,O))),E&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let d=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(d=Math.max(d,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),d}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const d=this.centerOffset,m=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=g.mercatorZfromAltitude(1,this.center.lat)/g.mercatorZfromAltitude(1,g.GLOBE_SCALE_MATCH_LATITUDE));const x=id(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T="meters"===this.projection.zAxisUnit?m:1,E=this._camera.getWorldToCamera(this.worldSize,T),k=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);k[8]=2*-d.x/this.width,k[9]=2*d.y/this.height;let O=g.mul([],k,E);if(this.projection.isReprojectedInTileSpace){const Pe=this.locationCoordinate(this.center),Fe=g.identity([]);g.translate(Fe,Fe,[Pe.x*this.worldSize,Pe.y*this.worldSize,0]),g.multiply(Fe,Fe,nd(this)),g.translate(Fe,Fe,[-Pe.x*this.worldSize,-Pe.y*this.worldSize,0]),g.multiply(O,O,Fe),this.inverseAdjustmentMatrix=function($e){const it=nd($e,!0);return wt([],[it[0],it[1],it[4],it[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=g.scale([],O,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=O,this.invProjMatrix=g.invert(new Float64Array(16),this.projMatrix);const B=g.invert([],k);this.frustumCorners=g.FrustumCorners.fromInvProjectionMatrix(B,this.horizonLineFromTop(),this.height);const G=new Float32Array(16);g.identity(G),g.scale(G,G,[1,-1,1]),g.rotateX(G,G,this._pitch),g.rotateZ(G,G,this.angle);const q=g.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),J=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;q[8]=2*-d.x/this.width,q[9]=2*(d.y+J)/this.height,this.skyboxMatrix=g.multiply(G,q,G);const re=this.point,de=re.x,le=re.y,he=this.width%2/2,pe=this.height%2/2,oe=Math.cos(this.angle),Ce=Math.sin(this.angle),xe=de-Math.round(de)+oe*he+Ce*pe,Ee=le-Math.round(le)+oe*pe+Ce*he,Le=new Float64Array(O);if(g.translate(Le,Le,[xe>.5?xe-1:xe,Ee>.5?Ee-1:Ee,0]),this.alignedProjMatrix=Le,O=g.create(),g.scale(O,O,[this.width/2,-this.height/2,1]),g.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=g.create(),g.scale(O,O,[1,-1,1]),g.translate(O,O,[-1,-1,0]),g.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=g.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},O=g.invert(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=O,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=g.calculateGlobeMatrix(this);const Pe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=g.transformMat4(Pe,Pe,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=O;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const d=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,x=this._camera.position,T=1/this.height/this._pixelsPerMercatorPixel,E=[d,d,m];g.scale$2(E,E,T),g.scale$2(x,x,-1),g.multiply$2(x,x,E);const k=g.create();g.translate(k,k,x),g.scale(k,k,E),this.mercatorFogMatrix=k,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(d,m,T)}_computeCameraPosition(d){const m=(d=d||this.pixelsPerMeter)/this.pixelsPerMeter,x=this._camera.forward(),T=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-d/this.worldSize*this._centerAltitude;return[T.x/this.worldSize-x[0]*E,T.y/this.worldSize-x[1]*E,d/this.worldSize*this._centerAltitude-x[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(d){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),x=this._camera.position[2],T=d[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),T>0&&(E=Math.min((m-x)/T,1)),this._camera.position=g.scaleAndAdd([],this._camera.position,d,E),this._updateStateFromCamera()}_updateStateFromCamera(){const d=this._camera.position,m=this._camera.forward(),{pitch:x,bearing:T}=this._camera.getPitchBearing(),E=g.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,k=this._mercatorZfromZoom(this._maxZoom)*Math.cos(g.degToRad(this._maxPitch)),O=Math.max((d[2]-E)/Math.cos(x),k),B=this._zoomFromMercatorZ(O);g.scaleAndAdd(d,d,m,O),this._pitch=g.clamp(x,g.degToRad(this.minPitch),g.degToRad(this.maxPitch)),this.angle=g.wrap(T,-Math.PI,Math.PI),this._setZoom(g.clamp(B,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new g.MercatorCoordinate(d[0],d[1],d[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(d){return Math.pow(2,d)*this.tileSize}_mercatorZfromZoom(d){return this.cameraToCenterDistance/this._worldSizeFromZoom(d)}_minimumHeightOverTerrain(){const d=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(d)}_zoomFromMercatorZ(d){return this.scaleZoom(this.cameraToCenterDistance/(d*this.tileSize))}zoomFromMercatorZAdjusted(d){let m=0,x=g.GLOBE_ZOOM_THRESHOLD_MAX,T=0,E=1/0;for(;x-m>1e-6&&x>m;){const k=m+.5*(x-m),O=this.tileSize*Math.pow(2,k),B=this.getCameraToCenterDistance(this.projection,k,O),G=this.scaleZoom(B/(d*this.tileSize)),q=Math.abs(k-G);q<E&&(E=q,T=k),k<G?m=k:x=k}return T}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(g.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(d,m){const x=Math.min(d.x,m.x),T=Math.max(d.x,m.x),E=Math.min(d.y,m.y),k=Math.max(d.y,m.y);if(E<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const O=[new g.pointGeometry(x,E),new g.pointGeometry(T,k),new g.pointGeometry(x,k),new g.pointGeometry(T,E)],B=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const q of O){const J=this.pointRayIntersection(q);if(J.t<0)return!0;const re=this.rayIntersectionCoordinate(J);if(re.x<B||re.y<0||re.x>G||re.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+g.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new g.pointGeometry(0,0),new g.pointGeometry(this.width,this.height))}zoomDeltaToMovement(d,m){const x=g.length(g.sub([],this._camera.position,d)),T=this._zoomFromMercatorZ(x)+m;return x-this._mercatorZfromZoom(T)}getCameraPoint(){if("globe"===this.projection.name){const d=function([m,x,T],E){const k=[m,x,T,1];g.transformMat4$1(k,k,E);const O=k[3]=Math.max(k[3],1e-6);return k[0]/=O,k[1]/=O,k[2]/=O,k}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new g.pointGeometry(d[0],d[1])}{const d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new g.pointGeometry(0,d))}}getCameraToCenterDistance(d,m=this.zoom,x=this.worldSize){const T=id(d,m,this.width,this.height,1024),E=d.pixelSpaceConversion(this.center.lat,x,T);return.5/Math.tan(.5*this._fov)*this.height*E}getWorldToCameraMatrix(){const d=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&g.multiply(d,d,this.globeMatrix),d}}function Da(v,d){let m=!1,x=null;const T=()=>{x=null,m&&(v(),x=setTimeout(T,d),m=!1)};return()=>(m=!0,x||T(),x)}class Ky{constructor(d){this._hashName=d&&encodeURIComponent(d),g.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Da(this._updateHashUnthrottled.bind(this),300)}addTo(d){return this._map=d,g.window.addEventListener("hashchange",this._onHashChange,!1),d.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),g.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const d=this._map;if(!d)return"";const m=Yg(d);if(this._hashName){const x=this._hashName;let T=!1;const E=g.window.location.hash.slice(1).split("&").map(k=>{const O=k.split("=")[0];return O===x?(T=!0,`${O}=${m}`):k}).filter(k=>k);return T||E.push(`${x}=${m}`),`#${E.join("&")}`}return`#${m}`}_getCurrentHash(){const d=g.window.location.hash.replace("#","");if(this._hashName){let m;return d.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(m=x)}),(m&&m[1]||"").split("/")}return d.split("/")}_onHashChange(){const d=this._map;if(!d)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(x=>isNaN(x))){const x=d.dragRotate.isEnabled()&&d.touchZoomRotate.isEnabled()?+(m[3]||0):d.getBearing();return d.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:x,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){const d=g.window.location.href.replace(/(#.+)?$/,this.getHashString());g.window.history.replaceState(g.window.history.state,null,d)}}function Yg(v,d){const m=v.getCenter(),x=Math.round(100*v.getZoom())/100,T=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,T),k=Math.round(m.lng*E)/E,O=Math.round(m.lat*E)/E,B=v.getBearing(),G=v.getPitch();let q=d?`/${k}/${O}/${x}`:`${x}/${O}/${k}`;return(B||G)&&(q+="/"+Math.round(10*B)/10),G&&(q+=`/${Math.round(G)}`),q}const Ip={linearity:.3,easing:g.bezier(0,0,.3,1)},uh=g.extend({deceleration:2500,maxSpeed:1400},Ip),Xy=g.extend({deceleration:20,maxSpeed:1400},Ip),dh=g.extend({deceleration:1e3,maxSpeed:360},Ip),Dp=g.extend({deceleration:1e3,maxSpeed:90},Ip);class am{constructor(d){this._map=d,this.clear()}clear(){this._inertiaBuffer=[]}record(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:g.exported.now(),settings:d})}_drainInertiaBuffer(){const d=this._inertiaBuffer,m=g.exported.now();for(;d.length>0&&m-d[0].time>160;)d.shift()}_onMoveEnd(d){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const m={zoom:0,bearing:0,pitch:0,pan:new g.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)m.zoom+=E.zoomDelta||0,m.bearing+=E.bearingDelta||0,m.pitch+=E.pitchDelta||0,E.panDelta&&m.pan._add(E.panDelta),E.around&&(m.around=E.around),E.pinchAround&&(m.pinchAround=E.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(m.pan.mag()){const E=kp(m.pan.mag(),x,g.extend({},uh,d||{}));T.offset=m.pan.mult(E.amount/m.pan.mag()),T.center=this._map.transform.center,Mp(T,E)}if(m.zoom){const E=kp(m.zoom,x,Xy);T.zoom=this._map.transform.zoom+E.amount,Mp(T,E)}if(m.bearing){const E=kp(m.bearing,x,dh);T.bearing=this._map.transform.bearing+g.clamp(E.amount,-179,179),Mp(T,E)}if(m.pitch){const E=kp(m.pitch,x,Dp);T.pitch=this._map.transform.pitch+E.amount,Mp(T,E)}if(T.zoom||T.bearing){const E=void 0===m.pinchAround?m.around:m.pinchAround;T.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),T.noMoveStart=!0,T}}function Mp(v,d){(!v.duration||v.duration<d.duration)&&(v.duration=d.duration,v.easing=d.easing)}function kp(v,d,m){const{maxSpeed:x,linearity:T,deceleration:E}=m,k=g.clamp(v*T/(d/1e3),-x,x),O=Math.abs(k)/(E*T);return{easing:m.easing,duration:1e3*O,amount:k*(O/2)}}class Ho extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,m,x,T={}){const E=Ue(m.getCanvasContainer(),x),k=m.unproject(E);super(d,g.extend({point:E,lngLat:k,originalEvent:x},T)),this._defaultPrevented=!1,this.target=m}}class Ap extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,m,x){const T="touchend"===d?x.changedTouches:x.touches,E=st(m.getCanvasContainer(),T),k=E.map(B=>m.unproject(B)),O=E.reduce((B,G,q,J)=>B.add(G.div(J.length)),new g.pointGeometry(0,0));super(d,{points:E,point:O,lngLats:k,lngLat:m.unproject(O),originalEvent:x}),this._defaultPrevented=!1}}class _r extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,m,x){super(d,{originalEvent:x}),this._defaultPrevented=!1}}class lm{constructor(d,m){this._map=d,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(d){return this._firePreventable(new _r(d.type,this._map,d))}mousedown(d,m){return this._mousedownPos=m,this._firePreventable(new Ho(d.type,this._map,d))}mouseup(d){this._map.fire(new Ho(d.type,this._map,d))}preclick(d){const m=g.extend({},d);m.type="preclick",this._map.fire(new Ho(m.type,this._map,m))}click(d,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(d),this._map.fire(new Ho(d.type,this._map,d)))}dblclick(d){return this._firePreventable(new Ho(d.type,this._map,d))}mouseover(d){this._map.fire(new Ho(d.type,this._map,d))}mouseout(d){this._map.fire(new Ho(d.type,this._map,d))}touchstart(d){return this._firePreventable(new Ap(d.type,this._map,d))}touchmove(d){this._map.fire(new Ap(d.type,this._map,d))}touchend(d){this._map.fire(new Ap(d.type,this._map,d))}touchcancel(d){this._map.fire(new Ap(d.type,this._map,d))}_firePreventable(d){if(this._map.fire(d),d.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pp{constructor(d){this._map=d}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(d){this._map.fire(new Ho(d.type,this._map,d))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ho("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new Ho(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cm{constructor(d,m){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(d,m){this.isEnabled()&&d.shiftKey&&0===d.button&&(qt(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(d,m){if(!this._active)return;const x=m,T=this._startPos,E=this._lastPos;if(!T||!E||E.equals(x)||!this._box&&x.dist(T)<this._clickTolerance)return;this._lastPos=x,this._box||(this._box=Xe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));const k=Math.min(T.x,x.x),O=Math.max(T.x,x.x),B=Math.min(T.y,x.y),G=Math.max(T.y,x.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${k}px,${B}px)`,this._box.style.width=O-k+"px",this._box.style.height=G-B+"px")})}mouseupWindow(d,m){if(!this._active)return;const x=this._startPos,T=m;if(x&&0===d.button){if(this.reset(),ft(),x.x!==T.x||x.y!==T.y)return this._map.fire(new g.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:E=>E.fitScreenCoordinates(x,T,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",d)}}keydown(d){this._active&&27===d.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",d))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),jt(),delete this._startPos,delete this._lastPos}_fireEvent(d,m){return this._map.fire(new g.Event(d,{originalEvent:m}))}}function hh(v,d){const m={};for(let x=0;x<v.length;x++)m[v[x].identifier]=d[x];return m}class um{constructor(d){this.reset(),this.numTouches=d.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(d,m,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=d.timeStamp),x.length===this.numTouches&&(this.centroid=function(T){const E=new g.pointGeometry(0,0);for(const k of T)E._add(k);return E.div(T.length)}(m),this.touches=hh(x,m)))}touchmove(d,m,x){if(this.aborted||!this.centroid)return;const T=hh(x,m);for(const E in this.touches){const O=T[E];(!O||O.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(d,m,x){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),0===x.length){const T=!this.aborted&&this.centroid;if(this.reset(),T)return T}}}class rd{constructor(d){this.singleTap=new um(d),this.numTaps=d.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(d,m,x){this.singleTap.touchstart(d,m,x)}touchmove(d,m,x){this.singleTap.touchmove(d,m,x)}touchend(d,m,x){const T=this.singleTap.touchend(d,m,x);if(T){const E=d.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(T)<30;if(E&&k||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=T,this.count===this.numTaps)return this.reset(),T}}}class ph{constructor(){this._zoomIn=new rd({numTouches:1,numTaps:2}),this._zoomOut=new rd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(d,m,x){this._zoomIn.touchstart(d,m,x),this._zoomOut.touchstart(d,m,x)}touchmove(d,m,x){this._zoomIn.touchmove(d,m,x),this._zoomOut.touchmove(d,m,x)}touchend(d,m,x){const T=this._zoomIn.touchend(d,m,x),E=this._zoomOut.touchend(d,m,x);return T?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(T)},{originalEvent:d})}):E?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(E)},{originalEvent:d})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Qg={0:1,2:2};class _s{constructor(d){this.reset(),this._clickTolerance=d.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(d,m){return!1}_move(d,m){return{}}mousedown(d,m){if(this._lastPoint)return;const x=He(d);this._correctButton(d,x)&&(this._lastPoint=m,this._eventButton=x)}mousemoveWindow(d,m){const x=this._lastPoint;if(x)if(d.preventDefault(),null!=this._eventButton&&function(T,E){const k=Qg[E];return void 0===T.buttons||(T.buttons&k)!==k}(d,this._eventButton))this.reset();else if(this._moved||!(m.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(x,m)}mouseupWindow(d){this._lastPoint&&He(d)===this._eventButton&&(this._moved&&ft(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dm extends _s{mousedown(d,m){super.mousedown(d,m),this._lastPoint&&(this._active=!0)}_correctButton(d,m){return 0===m&&!d.ctrlKey}_move(d,m){return{around:m,panDelta:m.sub(d)}}}class Op extends _s{_correctButton(d,m){return 0===m&&d.ctrlKey||2===m}_move(d,m){const x=.8*(m.x-d.x);if(x)return this._active=!0,{bearingDelta:x}}contextmenu(d){d.preventDefault()}}class yr extends _s{_correctButton(d,m){return 0===m&&d.ctrlKey||2===m}_move(d,m){const x=-.5*(m.y-d.y);if(x)return this._active=!0,{pitchDelta:x}}contextmenu(d){d.preventDefault()}}class sd{constructor(d,m){this._map=d,this._el=d.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),g.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new g.pointGeometry(0,0)}touchstart(d,m,x){return this._calculateTransform(d,m,x)}touchmove(d,m,x){if(this._active&&!(x.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===x.length&&!g.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return d.cancelable&&d.preventDefault(),this._calculateTransform(d,m,x)}}touchend(d,m,x){this._calculateTransform(d,m,x),this._active&&x.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(d,m,x){x.length>0&&(this._active=!0);const T=hh(x,m),E=new g.pointGeometry(0,0),k=new g.pointGeometry(0,0);let O=0;for(const G in T){const q=T[G],J=this._touches[G];J&&(E._add(q),k._add(q.sub(J)),O++,T[G]=q)}if(this._touches=T,O<this._minTouches||!k.mag())return;const B=k.div(O);return this._sum._add(B),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(O),panDelta:B}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Xe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class qc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(d){}_move(d,m,x){return{}}touchstart(d,m,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([m[0],m[1]]))}touchmove(d,m,x){const T=this._firstTwoTouches;if(!T)return;d.preventDefault();const[E,k]=T,O=qr(x,m,E),B=qr(x,m,k);if(!O||!B)return;const G=this._aroundCenter?null:O.add(B).div(2);return this._move([O,B],G,d)}touchend(d,m,x){if(!this._firstTwoTouches)return;const[T,E]=this._firstTwoTouches,k=qr(x,m,T),O=qr(x,m,E);k&&O||(this._active&&ft(),this.reset())}touchcancel(){this.reset()}enable(d){this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function qr(v,d,m){for(let x=0;x<v.length;x++)if(v[x].identifier===m)return d[x]}function Jg(v,d){return Math.log(v/d)/Math.LN2}class hm extends qc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(d){this._startDistance=this._distance=d[0].dist(d[1])}_move(d,m){const x=this._distance;if(this._distance=d[0].dist(d[1]),this._active||!(Math.abs(Jg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Jg(this._distance,x),pinchAround:m}}}function nc(v,d){return 180*v.angleWith(d)/Math.PI}class Ps extends qc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(d){this._startVector=this._vector=d[0].sub(d[1]),this._minDiameter=d[0].dist(d[1])}_move(d,m){const x=this._vector;if(this._vector=d[0].sub(d[1]),x&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:nc(this._vector,x),pinchAround:m}}_isBelowThreshold(d){this._minDiameter=Math.min(this._minDiameter,d.mag());const m=25/(Math.PI*this._minDiameter)*360,x=this._startVector;if(!x)return!1;const T=nc(d,x);return Math.abs(T)<m}}function Lp(v){return Math.abs(v.y)>Math.abs(v.x)}class vr extends qc{constructor(d){super(),this._map=d}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(d){this._lastPoints=d,Lp(d[0].sub(d[1]))&&(this._valid=!1)}_move(d,m,x){const T=this._lastPoints;if(!T)return;const E=d[0].sub(T[0]),k=d[1].sub(T[1]);return this._map._cooperativeGestures&&!g.isFullscreen()&&x.touches.length<3||(this._valid=this.gestureBeginsVertically(E,k,x.timeStamp),!this._valid)?void 0:(this._lastPoints=d,this._active=!0,{pitchDelta:(E.y+k.y)/2*-.5})}gestureBeginsVertically(d,m,x){if(void 0!==this._valid)return this._valid;const T=d.mag()>=2,E=m.mag()>=2;if(!T&&!E)return;if(!T||!E)return null==this._firstMove&&(this._firstMove=x),x-this._firstMove<100&&void 0;const k=d.y>0==m.y>0;return Lp(d)&&Lp(m)&&k}}const Yy={panStep:100,bearingStep:15,pitchStep:10};class Al{constructor(){const d=Yy;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(d){if(d.altKey||d.ctrlKey||d.metaKey)return;let m=0,x=0,T=0,E=0,k=0;switch(d.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:d.shiftKey?x=-1:(d.preventDefault(),E=-1);break;case 39:d.shiftKey?x=1:(d.preventDefault(),E=1);break;case 38:d.shiftKey?T=1:(d.preventDefault(),k=-1);break;case 40:d.shiftKey?T=-1:(d.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(x=0,T=0),{cameraAnimation:O=>{const B=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:e_,zoom:m?Math.round(B)+m*(d.shiftKey?2:1):B,bearing:O.getBearing()+x*this._bearingStep,pitch:O.getPitch()+T*this._pitchStep,offset:[-E*this._panStep,-k*this._panStep],center:O.getCenter()},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function e_(v){return v*(2-v)}const Rp=4.000244140625;class ni{constructor(d,m){this._map=d,this._el=d.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,g.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(d){this._defaultZoomRate=d}setWheelZoomRate(d){this._wheelZoomRate=d}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(d){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(d.ctrlKey||d.metaKey||this.isZooming()||g.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=d.deltaMode===g.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY;const x=g.exported.now(),T=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,0!==m&&m%Rp==0?this._type="wheel":0!==m&&Math.abs(m)<4?this._type="trackpad":T>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(T*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),d.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=d,this._delta-=m,this._active||this._start(d)),d.preventDefault()}_onTimeout(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)}_start(d){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=Ue(this._el,d);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const d=this._map.transform;"wheel"===this._type&&d.projection.wrap&&(d._center.lng>=180||d._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>d._terrainEnabled()&&this._aroundCoord?d.computeZoomRelativeTo(this._aroundCoord):d.zoom;if(0!==this._delta){const B="wheel"===this._type&&Math.abs(this._delta)>Rp?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&0!==G&&(G=1/G);const q=m(),J=Math.pow(2,q),re="number"==typeof this._targetZoom?d.zoomScale(this._targetZoom):J;this._targetZoom=Math.min(d.maxZoom,Math.max(d.minZoom,d.scaleZoom(re*G))),"wheel"===this._type&&(this._startZoom=q,this._easing=this._smoothOutEasing(200)),this._delta=0}const x="number"==typeof this._targetZoom?this._targetZoom:m(),T=this._startZoom,E=this._easing;let k,O=!1;if("wheel"===this._type&&T&&E){const B=Math.min((g.exported.now()-this._lastWheelEventTime)/200,1),G=E(B);k=g.number(T,x,G),B<1?this._frameId||(this._frameId=!0):O=!0}else k=x,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:k-m(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(d){let m=g.ease;if(this._prevEase){const x=this._prevEase,T=(g.exported.now()-x.start)/x.duration,E=x.easing(T+.01)-x.easing(T),k=.27/Math.sqrt(E*E+1e-4)*.01,O=Math.sqrt(.0729-k*k);m=g.bezier(k,O,.25,1)}return this._prevEase={start:g.exported.now(),duration:d,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Xe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(g.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class pm{constructor(d,m){this._clickZoom=d,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fh{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(d,m){return d.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:x.getZoom()+(d.shiftKey?-1:1),around:x.unproject(m)},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class il{constructor(){this._tap=new rd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(d,m,x){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=m[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(d,m,x))}touchmove(d,m,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const T=m[0],E=T.y-this._swipePoint.y;return this._swipePoint=T,d.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(d,m,x)}touchend(d,m,x){this._tapTime?this._swipePoint&&0===x.length&&this.reset():this._tap.touchend(d,m,x)&&(this._tapTime=d.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fp{constructor(d,m,x){this._el=d,this._mousePan=m,this._touchPan=x}enable(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class dn{constructor(d,m,x){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=m,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class fm{constructor(d,m,x,T){this._el=d,this._touchZoom=m,this._touchRotate=x,this._tapDragZoom=T,this._rotationDisabled=!1,this._enabled=!0}enable(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const mh=v=>v.zoom||v.drag||v.pitch||v.rotate;class gh extends g.Event{}class zt{constructor(){this.constants=[1,1,.01],this.radius=0}setup(d,m){const x=g.sub([],m,d);this.radius=g.length(x[2]<0?g.div([],x,this.constants):[x[0],x[1],0])}projectRay(d){g.div(d,d,this.constants),g.normalize(d,d),g.mul$1(d,d,this.constants);const m=g.scale$2([],d,this.radius);if(m[2]>0){const x=g.scale$2([],[0,0,1],g.dot(m,[0,0,1])),T=g.scale$2([],g.normalize([],[m[0],m[1],0]),this.radius),E=g.add([],m,g.scale$2([],g.sub([],g.add([],T,x),m),2));m[0]=E[0],m[1]=E[1]}return m}}function Ni(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class be{constructor(d,m){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new am(d),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new zt,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),g.bindAll(["handleEvent","handleWindowEvent"],this);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[g.window.document,"mousemove",{capture:!0}],[g.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[g.window,"blur",void 0]];for(const[T,E,k]of this._listeners)T.addEventListener(E,T===g.window.document?this.handleWindowEvent:this.handleEvent,k)}destroy(){for(const[d,m,x]of this._listeners)d.removeEventListener(m,d===g.window.document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(d){const m=this._map,x=m.getCanvasContainer();this._add("mapEvent",new lm(m,d));const T=m.boxZoom=new cm(m,d);this._add("boxZoom",T);const E=new ph,k=new fh;m.doubleClickZoom=new pm(k,E),this._add("tapZoom",E),this._add("clickZoom",k);const O=new il;this._add("tapDragZoom",O);const B=m.touchPitch=new vr(m);this._add("touchPitch",B);const G=new Op(d),q=new yr(d);m.dragRotate=new dn(d,G,q),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",q,["mouseRotate"]);const J=new dm(d),re=new sd(m,d);m.dragPan=new Fp(x,J,re),this._add("mousePan",J),this._add("touchPan",re,["touchZoom","touchRotate"]);const de=new Ps,le=new hm;m.touchZoomRotate=new fm(x,le,de,O),this._add("touchRotate",de,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Pp(m));const he=m.scrollZoom=new ni(m,this);this._add("scrollZoom",he,["mousePan"]);const pe=m.keyboard=new Al;this._add("keyboard",pe);for(const oe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])d.interactive&&d[oe]&&m[oe].enable(d[oe])}_add(d,m,x){this._handlers.push({handlerName:d,handler:m,allowed:x}),this._handlersById[d]=m}stop(d){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}}isActive(){for(const{handler:d}of this._handlers)if(d.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!mh(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(d,m,x){for(const T in d)if(T!==x&&(!m||m.indexOf(T)<0))return!0;return!1}handleWindowEvent(d){this.handleEvent(d,`${d.type}Window`)}_getMapTouches(d){const m=[];for(const x of d)this._el.contains(x.target)&&m.push(x);return m}handleEvent(d,m){this._updatingCamera=!0;const x="renderFrame"===d.type,T=x?void 0:d,E={needsRenderFrame:!1},k={},O={},B=d.touches?this._getMapTouches(d.touches):void 0,G=B?st(this._el,B):x?void 0:Ue(this._el,d);for(const{handlerName:re,handler:de,allowed:le}of this._handlers){if(!de.isEnabled())continue;let he;this._blockedByActive(O,le,re)?de.reset():de[m||d.type]&&(he=de[m||d.type](d,G,B),this.mergeHandlerResult(E,k,he,re,T),he&&he.needsRenderFrame&&this._triggerRenderFrame()),(he||de.isActive())&&(O[re]=de)}const q={};for(const re in this._previousActiveHandlers)O[re]||(q[re]=T);this._previousActiveHandlers=O,(Object.keys(q).length||Ni(E))&&(this._changes.push([E,k,q]),this._triggerRenderFrame()),(Object.keys(O).length||Ni(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=E;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))}mergeHandlerResult(d,m,x,T,E){if(!x)return;g.extend(d,x);const k={handlerName:T,originalEvent:x.originalEvent||E};void 0!==x.zoomDelta&&(m.zoom=k),void 0!==x.panDelta&&(m.drag=k),void 0!==x.pitchDelta&&(m.pitch=k),void 0!==x.bearingDelta&&(m.rotate=k)}_applyChanges(){const d={},m={},x={};for(const[T,E,k]of this._changes)T.panDelta&&(d.panDelta=(d.panDelta||new g.pointGeometry(0,0))._add(T.panDelta)),T.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+T.pitchDelta),void 0!==T.around&&(d.around=T.around),void 0!==T.aroundCoord&&(d.aroundCoord=T.aroundCoord),void 0!==T.pinchAround&&(d.pinchAround=T.pinchAround),T.noInertia&&(d.noInertia=T.noInertia),g.extend(m,E),g.extend(x,k);this._updateMapTransform(d,m,x),this._changes=[]}_updateMapTransform(d,m,x){const T=this._map,E=T.transform,k=Ce=>[Ce.x,Ce.y,Ce.z];if((Ce=>{const xe=this._eventsInProgress.drag;return xe&&!this._handlersById[xe.handlerName].isActive()})()&&!Ni(d)){const Ce=E.zoom;E.cameraElevationReference="sea",E.recenterOnTerrain(),E.cameraElevationReference="ground",Ce!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&T._stop(!0),!Ni(d))return void this._fireEvents(m,x,!0);let{panDelta:O,zoomDelta:B,bearingDelta:G,pitchDelta:q,around:J,aroundCoord:re,pinchAround:de}=d;E._isCameraConstrained&&(B>0&&(B=0),E._isCameraConstrained=!1),void 0!==de&&(J=de),(B||(Ce=>m.drag&&!this._eventsInProgress.drag)())&&J&&(this._dragOrigin=k(E.pointCoordinate3D(J)),this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",T._stop(!0),J=J||T.transform.centerPoint,G&&(E.bearing+=G),q&&(E.pitch+=q),E._updateCameraState();const le=[0,0,0];if(O)if("mercator"===E.projection.name){const Ce=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(J).dir),xe=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(J.sub(O)).dir);le[0]=xe[0]-Ce[0],le[1]=xe[1]-Ce[1]}else{const Ce=E.pointCoordinate(J);if("globe"===E.projection.name){O=O.rotate(-E.angle);const xe=E._pixelsPerMercatorPixel/E.worldSize;le[0]=-O.x*g.mercatorScale(g.latFromMercatorY(Ce.y))*xe,le[1]=-O.y*g.mercatorScale(E.center.lat)*xe}else{const xe=E.pointCoordinate(J.sub(O));Ce&&xe&&(le[0]=xe.x-Ce.x,le[1]=xe.y-Ce.y)}}const he=E.zoom,pe=[0,0,0];if(B){const Ce=k(re||E.pointCoordinate3D(J)),xe={dir:g.normalize([],g.sub([],Ce,E._camera.position))};if(xe.dir[2]<0){const Ee=E.zoomDeltaToMovement(Ce,B);g.scale$2(pe,xe.dir,Ee)}}const oe=g.add(le,le,pe);E._translateCameraConstrained(oe),B&&Math.abs(E.zoom-he)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(m,x,!0)}_fireEvents(d,m,x){const T=mh(this._eventsInProgress),E=mh(d),k={};for(const q in d){const{originalEvent:J}=d[q];this._eventsInProgress[q]||(k[`${q}start`]=J),this._eventsInProgress[q]=d[q]}!T&&E&&this._fireEvent("movestart",E.originalEvent);for(const q in k)this._fireEvent(q,k[q]);E&&this._fireEvent("move",E.originalEvent);for(const q in d){const{originalEvent:J}=d[q];this._fireEvent(q,J)}const O={};let B;for(const q in this._eventsInProgress){const{handlerName:J,originalEvent:re}=this._eventsInProgress[q];this._handlersById[J].isActive()||(delete this._eventsInProgress[q],B=m[J]||re,O[`${q}end`]=B)}for(const q in O)this._fireEvent(q,O[q]);const G=mh(this._eventsInProgress);if(x&&(T||E)&&!G){this._updatingCamera=!0;const q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),J=re=>0!==re&&-this._bearingSnap<re&&re<this._bearingSnap;q?(J(q.bearing||this._map.getBearing())&&(q.bearing=0),this._map.easeTo(q,{originalEvent:B})):(this._map.fire(new g.Event("moveend",{originalEvent:B})),J(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(d,m){this._map.fire(new g.Event(d,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(d=>{this._frameId=void 0,this.handleEvent(new gh("renderFrame",{timeStamp:d})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const ve="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ar extends g.Evented{constructor(d,m){super(),this._moving=!1,this._zooming=!1,this.transform=d,this._bearingSnap=m.bearingSnap,g.bindAll(["_renderFrameCallback"],this)}getCenter(){return new g.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(d,m){return this.jumpTo({center:d},m)}panBy(d,m,x){return d=g.pointGeometry.convert(d).mult(-1),this.panTo(this.transform.center,g.extend({offset:d},m),x)}panTo(d,m,x){return this.easeTo(g.extend({center:d},m),x)}getZoom(){return this.transform.zoom}setZoom(d,m){return this.jumpTo({zoom:d},m),this}zoomTo(d,m,x){return this.easeTo(g.extend({zoom:d},m),x)}zoomIn(d,m){return this.zoomTo(this.getZoom()+1,d,m),this}zoomOut(d,m){return this.zoomTo(this.getZoom()-1,d,m),this}getBearing(){return this.transform.bearing}setBearing(d,m){return this.jumpTo({bearing:d},m),this}getPadding(){return this.transform.padding}setPadding(d,m){return this.jumpTo({padding:d},m),this}rotateTo(d,m,x){return this.easeTo(g.extend({bearing:d},m),x)}resetNorth(d,m){return this.rotateTo(0,g.extend({duration:1e3},d),m),this}resetNorthPitch(d,m){return this.easeTo(g.extend({bearing:0,pitch:0,duration:1e3},d),m),this}snapToNorth(d,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(d,m):this}getPitch(){return this.transform.pitch}setPitch(d,m){return this.jumpTo({pitch:d},m),this}cameraForBounds(d,m){d=g.LngLatBounds.convert(d);const x=m&&m.bearing||0,T=m&&m.pitch||0,E=d.getNorthWest(),k=d.getSouthEast();return this._cameraForBounds(this.transform,E,k,x,T,m)}_extendCameraOptions(d){const m={top:0,bottom:0,right:0,left:0};if("number"==typeof(d=g.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding){const x=d.padding;d.padding={top:x,bottom:x,right:x,left:x}}return d.padding=g.extend(m,d.padding),d}_minimumAABBFrustumDistance(d,m){const x=m.max[0]-m.min[0],T=m.max[1]-m.min[1];return x/T>d.aspect?x/(2*Math.tan(.5*d.fovX)*d.aspect):T/(2*Math.tan(.5*d.fovY)*d.aspect)}_cameraForBoundsOnGlobe(d,m,x,T,E,k){const O=d.clone(),B=this._extendCameraOptions(k);O.bearing=T,O.pitch=E;const G=g.LngLat.convert(m),q=g.LngLat.convert(x),J=.5*(G.lat+q.lat),re=.5*(G.lng+q.lng),de=g.latLngToECEF(J,re),le=g.normalize([],de),he=g.normalize([],g.cross([],le,[0,1,0])),pe=g.cross([],he,le),oe=[he[0],he[1],he[2],0,pe[0],pe[1],pe[2],0,le[0],le[1],le[2],0,0,0,0,1],Ce=[de,g.latLngToECEF(G.lat,G.lng),g.latLngToECEF(q.lat,G.lng),g.latLngToECEF(q.lat,q.lng),g.latLngToECEF(G.lat,q.lng),g.latLngToECEF(J,G.lng),g.latLngToECEF(J,q.lng),g.latLngToECEF(G.lat,re),g.latLngToECEF(q.lat,re)];let xe=g.Aabb.fromPoints(Ce.map(Dt=>[g.dot(he,Dt),g.dot(pe,Dt),g.dot(le,Dt)]));const Ee=g.transformMat4([],xe.center,oe);0===g.squaredLength(Ee)&&g.set(Ee,0,0,1),g.normalize(Ee,Ee),g.scale$2(Ee,Ee,g.GLOBE_RADIUS),O.center=g.ecefToLatLng(Ee);const Le=O.getWorldToCameraMatrix(),Pe=g.invert(new Float64Array(16),Le);xe=g.Aabb.applyTransform(xe,g.multiply([],Le,oe)),g.transformMat4(Ee,Ee,Le);const Fe=.5*(xe.max[2]-xe.min[2]),$e=this._minimumAABBFrustumDistance(O,xe),it=g.scale$2([],[0,0,1],Fe),rt=g.add(it,Ee,it),Vt=$e+(0===O.pitch?0:g.distance(Ee,rt)),Ze=O.globeCenterInViewSpace,Tt=g.sub([],Ee,[Ze[0],Ze[1],Ze[2]]);g.normalize(Tt,Tt),g.scale$2(Tt,Tt,Vt);const dt=g.add([],Ee,Tt);g.transformMat4(dt,dt,Pe);const At=g.earthRadius/g.GLOBE_RADIUS,ot=g.length(dt),je=g.mercatorZfromAltitude(Math.max(ot*At-g.earthRadius,Number.EPSILON),0),ct=Math.min(O.zoomFromMercatorZAdjusted(je),B.maxZoom);return ct>.5*(g.GLOBE_ZOOM_THRESHOLD_MIN+g.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"mercator"}),O.zoom=ct,this._cameraForBounds(O,m,x,T,E,k)):{center:O.center,zoom:ct,bearing:T,pitch:E}}queryTerrainElevation(d,m){const x=this.transform.elevation;return x?(m=g.extend({},{exaggerated:!0},m),x.getAtPoint(g.MercatorCoordinate.fromLngLat(d),null,m.exaggerated)):null}_cameraForBounds(d,m,x,T,E,k){if("globe"===d.projection.name)return this._cameraForBoundsOnGlobe(d,m,x,T,E,k);const O=d.clone(),B=this._extendCameraOptions(k),G=O.padding;O.bearing=T,O.pitch=E;const q=g.LngLat.convert(m),J=g.LngLat.convert(x),re=new g.LngLat(q.lng,J.lat),de=new g.LngLat(J.lng,q.lat),le=O.project(q),he=O.project(J),pe=this.queryTerrainElevation(q),oe=this.queryTerrainElevation(J),Ce=this.queryTerrainElevation(re),xe=this.queryTerrainElevation(de),Ee=[[le.x,le.y,Math.min(pe||0,oe||0,Ce||0,xe||0)],[he.x,he.y,Math.max(pe||0,oe||0,Ce||0,xe||0)]];let Le=g.Aabb.fromPoints(Ee);const Pe=O.getWorldToCameraMatrix(),Fe=g.invert(new Float64Array(16),Pe);Le=g.Aabb.applyTransform(Le,Pe);const $e=g.sub([],Le.max,Le.min),it=G.left||0,rt=G.right||0,Vt=G.bottom||0,Ze=G.top||0,{left:Tt,right:dt,top:At,bottom:ot}=B.padding,je=.5*(it+rt),ct=.5*(Ze+Vt),Dt=Math.min(O.scaleZoom(O.scale*Math.min((O.width-(it+rt+Tt+dt))/$e[0],(O.height-(Vt+Ze+ot+At))/$e[1])),B.maxZoom),Ot=O.scale/O.zoomScale(Dt);Le=new g.Aabb([Le.min[0]-(Tt+je)*Ot,Le.min[1]-(ot+ct)*Ot,Le.min[2]],[Le.max[0]+(dt+je)*Ot,Le.max[1]+(At+ct)*Ot,Le.max[2]]);const vn=.5*$e[2],li=this._minimumAABBFrustumDistance(O,Le),hn=[0,0,1,0];g.transformMat4$1(hn,hn,Pe),g.normalize$2(hn,hn);const Jt=g.scale$2([],hn,li+vn),Sn=g.add([],Le.center,Jt),Ci=("number"==typeof B.offset.x&&"number"==typeof B.offset.y?new g.pointGeometry(B.offset.x,B.offset.y):g.pointGeometry.convert(B.offset)).rotate(-g.degToRad(T));Le.center[0]-=Ci.x*Ot,Le.center[1]+=Ci.y*Ot,g.transformMat4(Le.center,Le.center,Fe),g.transformMat4(Sn,Sn,Fe);const In=[Le.center[0],Le.center[1],Sn[2]*O.pixelsPerMeter];g.scale$2(In,In,1/O.worldSize);const Yi=g.lngFromMercatorX(In[0]),Qi=g.latFromMercatorY(In[1]),yo=Math.min(O._zoomFromMercatorZ(In[2]),B.maxZoom),io=new g.LngLat(Yi,Qi);return O.mercatorFromTransition&&yo<.5*(g.GLOBE_ZOOM_THRESHOLD_MIN+g.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"globe"}),O.zoom=yo,this._cameraForBounds(O,m,x,T,E,k)):{center:io,zoom:yo,bearing:T,pitch:E}}fitBounds(d,m,x){const T=this.cameraForBounds(d,m);return this._fitInternal(T,m,x)}fitScreenCoordinates(d,m,x,T,E){const k=g.pointGeometry.convert(d),O=g.pointGeometry.convert(m),B=new g.pointGeometry(Math.min(k.x,O.x),Math.min(k.y,O.y)),G=new g.pointGeometry(Math.max(k.x,O.x),Math.max(k.y,O.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(k,O))return this;const q=this.transform.pointLocation3D(B),J=this.transform.pointLocation3D(G),re=this.transform.pointLocation3D(new g.pointGeometry(B.x,G.y)),de=this.transform.pointLocation3D(new g.pointGeometry(G.x,B.y)),le=[Math.min(q.lng,J.lng,re.lng,de.lng),Math.min(q.lat,J.lat,re.lat,de.lat)],he=[Math.max(q.lng,J.lng,re.lng,de.lng),Math.max(q.lat,J.lat,re.lat,de.lat)],pe=T&&T.pitch?T.pitch:this.getPitch(),oe=this._cameraForBounds(this.transform,le,he,x,pe,T);return this._fitInternal(oe,T,E)}_fitInternal(d,m,x){return d?(delete(m=g.extend(d,m)).padding,m.linear?this.easeTo(m,x):this.flyTo(m,x)):this}jumpTo(d,m){this.stop();const x=d.preloadOnly?this.transform.clone():this.transform;let T=!1,E=!1,k=!1;return"zoom"in d&&x.zoom!==+d.zoom&&(T=!0,x.zoom=+d.zoom),void 0!==d.center&&(x.center=g.LngLat.convert(d.center)),"bearing"in d&&x.bearing!==+d.bearing&&(E=!0,x.bearing=+d.bearing),"pitch"in d&&x.pitch!==+d.pitch&&(k=!0,x.pitch=+d.pitch),null==d.padding||x.isPaddingEqual(d.padding)||(x.padding=d.padding),d.preloadOnly?(this._preloadTiles(x),this):(this.fire(new g.Event("movestart",m)).fire(new g.Event("move",m)),T&&this.fire(new g.Event("zoomstart",m)).fire(new g.Event("zoom",m)).fire(new g.Event("zoomend",m)),E&&this.fire(new g.Event("rotatestart",m)).fire(new g.Event("rotate",m)).fire(new g.Event("rotateend",m)),k&&this.fire(new g.Event("pitchstart",m)).fire(new g.Event("pitch",m)).fire(new g.Event("pitchend",m)),this.fire(new g.Event("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||g.warnOnce(ve),this.transform.getFreeCameraOptions()}setFreeCameraOptions(d,m){const x=this.transform;if(!x.projection.supportsFreeCamera)return g.warnOnce(ve),this;this.stop();const T=x.zoom,E=x.pitch,k=x.bearing;x.setFreeCameraOptions(d);const O=T!==x.zoom,B=E!==x.pitch,G=k!==x.bearing;return this.fire(new g.Event("movestart",m)).fire(new g.Event("move",m)),O&&this.fire(new g.Event("zoomstart",m)).fire(new g.Event("zoom",m)).fire(new g.Event("zoomend",m)),G&&this.fire(new g.Event("rotatestart",m)).fire(new g.Event("rotate",m)).fire(new g.Event("rotateend",m)),B&&this.fire(new g.Event("pitchstart",m)).fire(new g.Event("pitch",m)).fire(new g.Event("pitchend",m)),this.fire(new g.Event("moveend",m)),this}easeTo(d,m){this._stop(!1,d.easeId),(!1===(d=g.extend({offset:[0,0],duration:500,easing:g.ease},d)).animate||!d.essential&&g.exported.prefersReducedMotion)&&(d.duration=0);const x=this.transform,T=this.getZoom(),E=this.getBearing(),k=this.getPitch(),O=this.getPadding(),B="zoom"in d?+d.zoom:T,G="bearing"in d?this._normalizeBearing(d.bearing,E):E,q="pitch"in d?+d.pitch:k,J="padding"in d?d.padding:x.padding,re=g.pointGeometry.convert(d.offset);let de,le,he;if("globe"===x.projection.name){const it=g.MercatorCoordinate.fromLngLat(x.center),rt=re.rotate(-x.angle);it.x+=rt.x/x.worldSize,it.y+=rt.y/x.worldSize;const Vt=it.toLngLat(),Ze=g.LngLat.convert(d.center||Vt);this._normalizeCenter(Ze),de=x.centerPoint.add(rt),le=new g.pointGeometry(it.x,it.y).mult(x.worldSize),he=new g.pointGeometry(g.mercatorXfromLng(Ze.lng),g.mercatorYfromLat(Ze.lat)).mult(x.worldSize).sub(le)}else{de=x.centerPoint.add(re);const it=x.pointLocation(de),rt=g.LngLat.convert(d.center||it);this._normalizeCenter(rt),le=x.project(it),he=x.project(rt).sub(le)}const pe=x.zoomScale(B-T);let oe,Ce;d.around&&(oe=g.LngLat.convert(d.around),Ce=x.locationPoint(oe));const xe=this._zooming||B!==T,Ee=this._rotating||E!==G,Le=this._pitching||q!==k,Pe=!x.isPaddingEqual(J),Fe=it=>rt=>{if(xe&&(it.zoom=g.number(T,B,rt)),Ee&&(it.bearing=g.number(E,G,rt)),Le&&(it.pitch=g.number(k,q,rt)),Pe&&(it.interpolatePadding(O,J,rt),de=it.centerPoint.add(re)),oe)it.setLocationAtPoint(oe,Ce);else{const Vt=it.zoomScale(it.zoom-T),Ze=B>T?Math.min(2,pe):Math.max(.5,pe),Tt=Math.pow(Ze,1-rt),dt=it.unproject(le.add(he.mult(rt*Tt)).mult(Vt));it.setLocationAtPoint(it.renderWorldCopies?dt.wrap():dt,de)}return d.preloadOnly||this._fireMoveEvents(m),it};if(d.preloadOnly){const it=this._emulate(Fe,d.duration,x);return this._preloadTiles(it),this}const $e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=xe,this._rotating=Ee,this._pitching=Le,this._padding=Pe,this._easeId=d.easeId,this._prepareEase(m,d.noMoveStart,$e),this._ease(Fe(x),it=>{x.recenterOnTerrain(),this._afterEase(m,it)},d),this}_prepareEase(d,m,x={}){this._moving=!0,this.transform.cameraElevationReference="sea",m||x.moving||this.fire(new g.Event("movestart",d)),this._zooming&&!x.zooming&&this.fire(new g.Event("zoomstart",d)),this._rotating&&!x.rotating&&this.fire(new g.Event("rotatestart",d)),this._pitching&&!x.pitching&&this.fire(new g.Event("pitchstart",d))}_fireMoveEvents(d){this.fire(new g.Event("move",d)),this._zooming&&this.fire(new g.Event("zoom",d)),this._rotating&&this.fire(new g.Event("rotate",d)),this._pitching&&this.fire(new g.Event("pitch",d))}_afterEase(d,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const x=this._zooming,T=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new g.Event("zoomend",d)),T&&this.fire(new g.Event("rotateend",d)),E&&this.fire(new g.Event("pitchend",d)),this.fire(new g.Event("moveend",d))}flyTo(d,m){if(!d.essential&&g.exported.prefersReducedMotion){const Dt=g.pick(d,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Dt,m)}this.stop(),d=g.extend({offset:[0,0],speed:1.2,curve:1.42,easing:g.ease},d);const x=this.transform,T=this.getZoom(),E=this.getBearing(),k=this.getPitch(),O=this.getPadding(),B="zoom"in d?g.clamp(+d.zoom,x.minZoom,x.maxZoom):T,G="bearing"in d?this._normalizeBearing(d.bearing,E):E,q="pitch"in d?+d.pitch:k,J="padding"in d?d.padding:x.padding,re=x.zoomScale(B-T),de=g.pointGeometry.convert(d.offset);let le=x.centerPoint.add(de);const he=x.pointLocation(le),pe=g.LngLat.convert(d.center||he);this._normalizeCenter(pe);const oe=x.project(he),Ce=x.project(pe).sub(oe);let xe=d.curve;const Ee=Math.max(x.width,x.height),Le=Ee/re,Pe=Ce.mag();if("minZoom"in d){const Dt=g.clamp(Math.min(d.minZoom,T,B),x.minZoom,x.maxZoom),Ot=Ee/x.zoomScale(Dt-T);xe=Math.sqrt(Ot/Pe*2)}const Fe=xe*xe;function $e(Dt){const Ot=(Le*Le-Ee*Ee+(Dt?-1:1)*Fe*Fe*Pe*Pe)/(2*(Dt?Le:Ee)*Fe*Pe);return Math.log(Math.sqrt(Ot*Ot+1)-Ot)}function it(Dt){return(Math.exp(Dt)-Math.exp(-Dt))/2}function rt(Dt){return(Math.exp(Dt)+Math.exp(-Dt))/2}const Vt=$e(0);let Ze=function(Dt){return rt(Vt)/rt(Vt+xe*Dt)},Tt=function(Dt){return Ee*((rt(Vt)*(it(Ot=Vt+xe*Dt)/rt(Ot))-it(Vt))/Fe)/Pe;var Ot},dt=($e(1)-Vt)/xe;if(Math.abs(Pe)<1e-6||!isFinite(dt)){if(Math.abs(Ee-Le)<1e-6)return this.easeTo(d,m);const Dt=Le<Ee?-1:1;dt=Math.abs(Math.log(Le/Ee))/xe,Tt=function(){return 0},Ze=function(Ot){return Math.exp(Dt*xe*Ot)}}d.duration="duration"in d?+d.duration:1e3*dt/("screenSpeed"in d?+d.screenSpeed/xe:+d.speed),d.maxDuration&&d.duration>d.maxDuration&&(d.duration=0);const At=E!==G,ot=q!==k,je=!x.isPaddingEqual(J),ct=Dt=>Ot=>{const vn=Ot*dt,li=1/Ze(vn);Dt.zoom=1===Ot?B:T+Dt.scaleZoom(li),At&&(Dt.bearing=g.number(E,G,Ot)),ot&&(Dt.pitch=g.number(k,q,Ot)),je&&(Dt.interpolatePadding(O,J,Ot),le=Dt.centerPoint.add(de));const hn=1===Ot?pe:Dt.unproject(oe.add(Ce.mult(Tt(vn))).mult(li));return Dt.setLocationAtPoint(Dt.renderWorldCopies?hn.wrap():hn,le),Dt._updateCameraOnTerrain(),d.preloadOnly||this._fireMoveEvents(m),Dt};if(d.preloadOnly){const Dt=this._emulate(ct,d.duration,x);return this._preloadTiles(Dt),this}return this._zooming=!0,this._rotating=At,this._pitching=ot,this._padding=je,this._prepareEase(m,!1),this._ease(ct(x),()=>this._afterEase(m),d),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(d,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const x=this._onEaseEnd;this._onEaseEnd=void 0,x.call(this,m)}if(!d){const x=this.handlers;x&&x.stop(!1)}return this}_ease(d,m,x){!1===x.animate||0===x.duration?(d(1),m()):(this._easeStart=g.exported.now(),this._easeOptions=x,this._onEaseFrame=d,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const d=Math.min((g.exported.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(d)),d<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(d,m){d=g.wrap(d,-180,180);const x=Math.abs(d-m);return Math.abs(d-360-m)<x&&(d-=360),Math.abs(d+360-m)<x&&(d+=360),d}_normalizeCenter(d){const m=this.transform;if(!m.renderWorldCopies||m.maxBounds)return;const x=d.lng-m.center.lng;d.lng+=x>180?-360:x<-180?360:0}_emulate(d,m,x){const T=Math.ceil(15*m/1e3),E=[],k=d(x.clone());for(let O=0;O<=T;O++){const B=k(O/T);E.push(B.clone())}return E}}class Np{constructor(d={}){this.options=d,g.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(d){const m=this.options&&this.options.compact;return this._map=d,this._container=Xe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Xe("button","mapboxgl-ctrl-attrib-button",this._container),Xe("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Xe("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===m&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(d,m){const x=this._map._getUIString(`AttributionControl.${m}`);d.setAttribute("aria-label",x),d.removeAttribute("title"),d.firstElementChild&&d.firstElementChild.setAttribute("title",x)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||g.config.ACCESS_TOKEN}];if(d){const x=m.reduce((T,E,k)=>(E.value&&(T+=`${E.key}=${E.value}${k<m.length-1?"&":""}`),T),"?");d.href=`${g.config.FEEDBACK_URL}/${x}#${Yg(this._map,!0)}`,d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}}_updateData(d){!d||"metadata"!==d.sourceDataType&&"visibility"!==d.sourceDataType&&"style"!==d.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let d=[];if(this._map.style.stylesheet){const T=this._map.style.stylesheet;this.styleOwner=T.owner,this.styleId=T.id}const m=this._map.style._sourceCaches;for(const T in m){const E=m[T];if(E.used){const k=E.getSource();k.attribution&&d.indexOf(k.attribution)<0&&d.push(k.attribution)}}d.sort((T,E)=>T.length-E.length),d=d.filter((T,E)=>{for(let k=E+1;k<d.length;k++)if(d[k].indexOf(T)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=[...this.options.customAttribution,...d]:d.unshift(this.options.customAttribution));const x=d.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,d.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Zc{constructor(){g.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(d){this._map=d,this._container=Xe("div","mapboxgl-ctrl");const m=Xe("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(d){d&&"metadata"!==d.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const d=this._map.style._sourceCaches;if(0===Object.entries(d).length)return!0;for(const m in d){const x=d[m].getSource();if(x.hasOwnProperty("mapbox_logo")&&!x.mapbox_logo)return!1}return!0}_updateCompact(){const d=this._container.children;if(d.length){const m=d[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class Os{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(d){const m=++this._id;return this._queue.push({callback:d,id:m,cancelled:!1}),m}remove(d){const m=this._currentlyRunning,x=m?this._queue.concat(m):this._queue;for(const T of x)if(T.id===d)return void(T.cancelled=!0)}run(d=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const x of m)if(!x.cancelled&&(x.callback(d),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function ad(v,d,m){if(v=new g.LngLat(v.lng,v.lat),d){const x=new g.LngLat(v.lng-360,v.lat),T=new g.LngLat(v.lng+360,v.lat),E=360*Math.ceil(Math.abs(v.lng-m.center.lng)/360),k=m.locationPoint(v).distSqr(d),O=d.x<0||d.y<0||d.x>m.width||d.y>m.height;m.locationPoint(x).distSqr(d)<k&&(O||Math.abs(x.lng-m.center.lng)<E)?v=x:m.locationPoint(T).distSqr(d)<k&&(O||Math.abs(T.lng-m.center.lng)<E)&&(v=T)}for(;Math.abs(v.lng-m.center.lng)>180;){const x=m.locationPoint(v);if(x.x>=0&&x.y>=0&&x.x<=m.width&&x.y<=m.height)break;v.lng>m.center.lng?v.lng-=360:v.lng+=360}return v}const ic={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class zp extends g.Evented{constructor(d,m){if(super(),(d instanceof g.window.HTMLElement||m)&&(d=g.extend({element:d},m)),g.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._scale=d&&d.scale||1,this._draggable=d&&d.draggable||!1,this._clickTolerance=d&&d.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=d&&d.rotation||0,this._rotationAlignment=d&&d.rotationAlignment||"auto",this._pitchAlignment=d&&d.pitchAlignment&&d.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=d&&d.occludedOpacity||.2,d&&d.element)this._element=d.element,this._offset=g.pointGeometry.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=Xe("div");const T=41,E=27,k=Bt("svg",{display:"block",height:T*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${T}`},this._element),O=Bt("radialGradient",{id:"shadowGradient"},Bt("defs",{},k));Bt("stop",{offset:"10%","stop-opacity":.4},O),Bt("stop",{offset:"100%","stop-opacity":.05},O),Bt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},k),Bt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},k),Bt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},k),Bt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},k),this._offset=g.pointGeometry.convert(d&&d.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",T=>{T.preventDefault()}),this._element.addEventListener("mousedown",T=>{T.preventDefault()});const x=this._element.classList;for(const T in ic)x.remove(`mapboxgl-marker-anchor-${T}`);x.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(d){return d===this._map||(this.remove(),this._map=d,d.getCanvasContainer().appendChild(this._element),d.on("move",this._updateMoving),d.on("moveend",this._update),d.on("remove",this._clearFadeTimer),d._addMarker(this),this.setDraggable(this._draggable),this._update(),d.on("click",this._onMapClick)),this}remove(){const d=this._map;return d&&(d.off("click",this._onMapClick),d.off("move",this._updateMoving),d.off("moveend",this._update),d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler),d.off("mouseup",this._onUp),d.off("touchend",this._onUp),d.off("mousemove",this._onMove),d.off("touchmove",this._onMove),d.off("remove",this._clearFadeTimer),d._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=g.LngLat.convert(d),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(d){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),d){if(!("offset"in d.options)){const T=Math.sqrt(Math.pow(13.5,2)/2);d.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[T,-1*(24.6+T)],"bottom-right":[-T,-1*(24.6+T)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=d,d._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(d){const m=d.code,x=d.charCode||d.keyCode;"Space"!==m&&"Enter"!==m&&32!==x&&13!==x||this.togglePopup()}_onMapClick(d){const m=d.originalEvent.target,x=this._element;this._popup&&(m===x||x.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const d=this._popup;return d?(d.isOpen()?(d.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(d.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const d=this._map,m=this._pos;if(!d||!m)return!1;const x=d.unproject(m),T=d.getFreeCameraOptions();if(!T.position)return!1;const E=T.position.toLngLat();return E.distanceTo(x)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const d=this._map;if(!d)return;const m=this._pos;if(!m||m.x<0||m.x>d.transform.width||m.y<0||m.y>d.transform.height)return void this._clearFadeTimer();const x=d.unproject(m);let T;d._showingGlobe()&&g.isLngLatBehindGlobe(d.transform,this._lngLat)?T=0:(T=1-d._queryFogOpacity(x),d.transform._terrainEnabled()&&d.getTerrain()&&this._behindTerrain()&&(T*=this._occludedOpacity)),this._element.style.opacity=`${T}`,this._element.style.pointerEvents=T>0?"auto":"none",this._popup&&this._popup._setOpacity(T),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const d=this._pos;if(!d||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${d.x}px,${d.y}px)\n            ${ic[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${m.x}px,${m.y}px)\n        `}_calculateXYTransform(){const d=this._pos,m=this._map,x=this.getPitchAlignment();if(!m||!d||"map"!==x)return"";if(!m._showingGlobe()){const B=m.getPitch();return B?`rotateX(${B}deg)`:""}const T=g.radToDeg(g.globeTiltAtLngLat(m.transform,this._lngLat)),E=d.sub(g.globeCenterToScreenPoint(m.transform)),k=Math.abs(E.x)+Math.abs(E.y);if(0===k)return"";const O=T/k;return`rotateX(${-E.y*O}deg) rotateY(${E.x*O}deg)`}_calculateZTransform(){const d=this._pos,m=this._map;if(!m||!d)return"";let x=0;const T=this.getRotationAlignment();if("map"===T)if(m._showingGlobe()){const E=m.project(new g.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),k=m.project(new g.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(E);x=g.radToDeg(Math.atan2(k.y,k.x))-90}else x=-m.getBearing();else if("horizon"===T){const E=g.smoothstep(4,6,m.getZoom()),k=g.globeCenterToScreenPoint(m.transform);k.y+=E*m.transform.height;const O=d.sub(k),B=g.radToDeg(Math.atan2(O.y,O.x));x=(B>90?B-270:B+90)*(1-E)}return x+=this._rotation,x?`rotateZ(${x}deg)`:""}_update(d){g.window.cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=ad(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),!0===d?this._updateFrameId=g.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(d){return this._offset=g.pointGeometry.convert(d),this._update(),this}_onMove(d){const m=this._map;if(!m)return;const x=this._pointerdownPos,T=this._positionDelta;if(x&&T){if(!this._isDragging){const E=this._clickTolerance||m._clickTolerance;if(d.point.dist(x)<E)return;this._isDragging=!0}this._pos=d.point.sub(T),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new g.Event("dragstart"))),this.fire(new g.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const d=this._map;d&&(d.off("mousemove",this._onMove),d.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new g.Event("dragend")),this._state="inactive"}_addDragHandler(d){const m=this._map,x=this._pos;m&&x&&this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(x),this._pointerdownPos=d.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(d){this._draggable=!!d;const m=this._map;return m&&(d?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(d){return this._rotation=d||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(d){return this._rotationAlignment=d||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(d){return this._pitchAlignment=d||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(d){return this._occludedOpacity=d||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Qy={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},mm=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Zr(v=new g.pointGeometry(0,0),d="bottom"){if("number"==typeof v){const m=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(d){case"top":return new g.pointGeometry(0,v);case"top-left":return new g.pointGeometry(m,m);case"top-right":return new g.pointGeometry(-m,m);case"bottom":return new g.pointGeometry(0,-v);case"bottom-left":return new g.pointGeometry(m,-m);case"bottom-right":return new g.pointGeometry(-m,-m);case"left":return new g.pointGeometry(v,0);case"right":return new g.pointGeometry(-v,0)}return new g.pointGeometry(0,0)}return v instanceof g.pointGeometry||Array.isArray(v)?g.pointGeometry.convert(v):g.pointGeometry.convert(v[d]||[0,0])}class ol{constructor(d){this.jumpTo(d)}getValue(d){if(d<=this._startTime)return this._start;if(d>=this._endTime)return this._end;const m=g.easeCubicInOut((d-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(d){return d>=this._startTime&&d<=this._endTime}jumpTo(d){this._startTime=-1/0,this._endTime=-1/0,this._start=d,this._end=d}easeTo(d,m,x){this._start=this.getValue(m),this._end=d,this._startTime=m,this._endTime=m+x}}const gm={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Kc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ma={showCompass:!0,showZoom:!0,visualizePitch:!1};class t_{constructor(d,m,x=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new Op({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,x&&(this.mousePitch=new yr({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),g.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(d,m){this.mouseRotate.mousedown(d,m),this.mousePitch&&this.mousePitch.mousedown(d,m),qt()}move(d,m){const x=this.map,T=this.mouseRotate.mousemoveWindow(d,m),E=T&&T.bearingDelta;if(E&&x.setBearing(x.getBearing()+E),this.mousePitch){const k=this.mousePitch.mousemoveWindow(d,m),O=k&&k.pitchDelta;O&&x.setPitch(x.getPitch()+O)}}off(){const d=this.element;d.removeEventListener("mousedown",this.mousedown),d.removeEventListener("touchstart",this.touchstart,{passive:!1}),d.removeEventListener("touchmove",this.touchmove),d.removeEventListener("touchend",this.touchend),d.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){jt(),g.window.removeEventListener("mousemove",this.mousemove),g.window.removeEventListener("mouseup",this.mouseup)}mousedown(d){this.down(g.extend({},d,{ctrlKey:!0,preventDefault:()=>d.preventDefault()}),Ue(this.element,d)),g.window.addEventListener("mousemove",this.mousemove),g.window.addEventListener("mouseup",this.mouseup)}mousemove(d){this.move(d,Ue(this.element,d))}mouseup(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()}touchstart(d){1!==d.targetTouches.length?this.reset():(this._startPos=this._lastPos=st(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>d.preventDefault()},this._startPos))}touchmove(d){1!==d.targetTouches.length?this.reset():(this._lastPos=st(this.element,d.targetTouches)[0],this.move({preventDefault:()=>d.preventDefault()},this._lastPos))}touchend(d){0===d.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const _m={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},n_={maxWidth:100,unit:"metric"};function i_(v,d,m){const x=ld(d),T=x/d,E={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[m];this._map._requestDomTask(()=>{this._container.style.width=v*T+"px",this._container.innerHTML=`${x}&nbsp;${E}`})}function ld(v){const d=Math.pow(10,`${Math.floor(v)}`.length-1);let m=v/d;return m=m>=10?10:m>=5?5:m>=3?3:m>=2?2:m>=1?1:function(x){const T=Math.pow(10,Math.ceil(-Math.log(x)/Math.LN10));return Math.round(x*T)/T}(m),d*m}const Xc={version:g.version,supported:Je,setRTLTextPlugin:g.setRTLTextPlugin,getRTLTextPluginStatus:g.getRTLTextPluginStatus,Map:class extends Ar{constructor(v){if(g.LivePerformanceUtils.mark(g.PerformanceMarkers.create),null!=(v=g.extend({},Kc,v)).minZoom&&null!=v.maxZoom&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=v.minPitch&&null!=v.maxPitch&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=v.minPitch&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=v.maxPitch&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&g.isSafariWithAntialiasingBug(g.window)&&(v.antialias=!1,g.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new on(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new Os,this._domRenderTaskQueue=new Os,this._controls=[],this._markers=[],this._popups=[],this._mapId=g.uniqueId(),this._locale=g.extend({},gm,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ol(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new g.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,"string"==typeof v.container){if(this._container=g.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof g.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&g.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),g.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==g.window&&(g.window.addEventListener("online",this._onWindowOnline,!1),g.window.addEventListener("resize",this._onWindowResize,!1),g.window.addEventListener("orientationchange",this._onWindowResize,!1),g.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),g.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new be(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new Ky("string"==typeof v.hash&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,g.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new Np({customAttribution:v.customAttribution})),this._logoControl=new Zc,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update("style"===d.dataType),this.fire(new g.Event(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new g.Event(`${d.dataType}dataloading`,d))})}_getMapId(){return this._mapId}addControl(v,d){if(void 0===d&&(d=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=v.onAdd(this);this._controls.push(v);const x=this._controlPositions[d];return-1!==d.indexOf("bottom")?x.insertBefore(m,x.firstChild):x.appendChild(m),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const d=this._controls.indexOf(v);return d>-1&&this._controls.splice(d,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const d=!this._moving;return d&&this.fire(new g.Event("movestart",v)).fire(new g.Event("move",v)),this.fire(new g.Event("resize",v)),d&&this.fire(new g.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(g.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new g.Event("zoomstart")).fire(new g.Event("zoom")).fire(new g.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new g.Event("zoomstart")).fire(new g.Event("zoom")).fire(new g.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new g.Event("pitchstart")).fire(new g.Event("pitch")).fire(new g.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new g.Event("pitchstart")).fire(new g.Event("pitch")).fire(new g.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return"auto"===v?g.window.navigator.language:Array.isArray(v)?0===v.length?void 0:v.map(d=>"auto"===d?g.window.navigator.language:d):v}setLanguage(v){const d=this._parseLanguage(v);if(!this.style||d===this._language)return this;this._language=d,this.style._reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(v){return this._lazyInitEmptyStyle(),v?"string"==typeof v&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const v=this.transform,d=v.projection.name;let m;"globe"===d&&v.zoom>=g.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),m=!0):"mercator"===d&&v.zoom<g.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,d){return this._updateProjection(v||d||{name:"mercator"})}_updateProjection(v){let d;if(d="globe"===v.name&&this.transform.zoom>=g.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),d){this.painter.clearBackgroundTiles();for(const m in this.style._sourceCaches)this.style._sourceCaches[m].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(g.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(g.pointGeometry.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,d,m){if("mouseenter"===v||"mouseover"===v){let x=!1;const T=k=>{const O=d.filter(G=>this.getLayer(G)),B=O.length?this.queryRenderedFeatures(k.point,{layers:O}):[];B.length?x||(x=!0,m.call(this,new Ho(v,this,k.originalEvent,{features:B}))):x=!1},E=()=>{x=!1};return{layers:new Set(d),listener:m,delegates:{mousemove:T,mouseout:E}}}if("mouseleave"===v||"mouseout"===v){let x=!1;const T=k=>{const O=d.filter(B=>this.getLayer(B));(O.length?this.queryRenderedFeatures(k.point,{layers:O}):[]).length?x=!0:x&&(x=!1,m.call(this,new Ho(v,this,k.originalEvent)))},E=k=>{x&&(x=!1,m.call(this,new Ho(v,this,k.originalEvent)))};return{layers:new Set(d),listener:m,delegates:{mousemove:T,mouseout:E}}}{const x=T=>{const E=d.filter(O=>this.getLayer(O)),k=E.length?this.queryRenderedFeatures(T.point,{layers:E}):[];k.length&&(T.features=k,m.call(this,T),delete T.features)};return{layers:new Set(d),listener:m,delegates:{[v]:x}}}}on(v,d,m){if(void 0===m)return super.on(v,d);Array.isArray(d)||(d=[d]);const x=this._createDelegatedListener(v,d,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(x);for(const T in x.delegates)this.on(T,x.delegates[T]);return this}once(v,d,m){if(void 0===m)return super.once(v,d);Array.isArray(d)||(d=[d]);const x=this._createDelegatedListener(v,d,m);for(const T in x.delegates)this.once(T,x.delegates[T]);return this}off(v,d,m){if(void 0===m)return super.off(v,d);d=new Set(Array.isArray(d)?d:[d]);const x=(E,k)=>{if(E.size!==k.size)return!1;for(const O of E)if(!k.has(O))return!1;return!0},T=this._delegatedListeners?this._delegatedListeners[v]:void 0;return T&&(E=>{for(let k=0;k<E.length;k++){const O=E[k];if(O.listener===m&&x(O.layers,d)){for(const B in O.delegates)this.off(B,O.delegates[B]);return E.splice(k,1),this}}})(T),this}queryRenderedFeatures(v,d){return this.style?(void 0!==d||void 0===v||v instanceof g.pointGeometry||Array.isArray(v)||(d=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],d=d||{},this.transform)):[]}querySourceFeatures(v,d){return this.style.querySourceFeatures(v,d)}setStyle(v,d){return!1!==(d=g.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},d)).diff&&d.localIdeographFontFamily===this._localIdeographFontFamily&&d.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._localFontFamily=d.localFontFamily,this._updateStyle(v,d))}_getUIString(v){const d=this._locale[v];if(null==d)throw new Error(`Missing UI string '${v}'`);return d}_updateStyle(v,d){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new gs(this,d||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof v?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new gs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,d){if("string"==typeof v){const m=this._requestManager.normalizeStyleURL(v),x=this._requestManager.transformRequest(m,g.ResourceType.Style);g.getJSON(x,(T,E)=>{T?this.fire(new g.ErrorEvent(T)):E&&this._updateDiff(E,d)})}else"object"==typeof v&&this._updateDiff(v,d)}_updateDiff(v,d){try{this.style.setState(v)&&this._update(!0)}catch(m){g.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(v,d)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(g.warnOnce("There is no style added to the map."),!1)}addSource(v,d){return this._lazyInitEmptyStyle(),this.style.addSource(v,d),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const d in v){const m=v[d]._tiles;for(const x in m){const T=m[x];if("loaded"!==T.state&&"errored"!==T.state)return!1}}return!0}addSourceType(v,d,m){this._lazyInitEmptyStyle(),this.style.addSourceType(v,d,m)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,d,{pixelRatio:m=1,sdf:x=!1,stretchX:T,stretchY:E,content:k}={}){if(this._lazyInitEmptyStyle(),d instanceof g.window.HTMLImageElement||g.window.ImageBitmap&&d instanceof g.window.ImageBitmap){const{width:O,height:B,data:G}=g.exported.getImageData(d);this.style.addImage(v,{data:new g.RGBAImage({width:O,height:B},G),pixelRatio:m,stretchX:T,stretchY:E,content:k,sdf:x,version:0})}else if(void 0===d.width||void 0===d.height)this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:B}=d,G=d;this.style.addImage(v,{data:new g.RGBAImage({width:O,height:B},new Uint8Array(G.data)),pixelRatio:m,stretchX:T,stretchY:E,content:k,sdf:x,version:0,userImage:G}),G.onAdd&&G.onAdd(this,v)}}updateImage(v,d){const m=this.style.getImage(v);if(!m)return void this.fire(new g.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=d instanceof g.window.HTMLImageElement||g.window.ImageBitmap&&d instanceof g.window.ImageBitmap?g.exported.getImageData(d):d,{width:T,height:E}=x;void 0!==T&&void 0!==E?T===m.data.width&&E===m.data.height?(m.data.replace(x.data,!(d instanceof g.window.HTMLImageElement||g.window.ImageBitmap&&d instanceof g.window.ImageBitmap)),this.style.updateImage(v,m)):this.fire(new g.ErrorEvent(new Error(`The width and height of the updated image (${T}, ${E})\n                must be that same as the previous version of the image\n                (${m.data.width}, ${m.data.height})`))):this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new g.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,d){g.getImage(this._requestManager.transformRequest(v,g.ResourceType.Image),(m,x)=>{d(m,x instanceof g.window.HTMLImageElement?g.exported.getImageData(x):x)})}listImages(){return this.style.listImages()}addLayer(v,d){return this._lazyInitEmptyStyle(),this.style.addLayer(v,d),this._update(!0)}moveLayer(v,d){return this.style.moveLayer(v,d),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,d,m){return this.style.setLayerZoomRange(v,d,m),this._update(!0)}setFilter(v,d,m={}){return this.style.setFilter(v,d,m),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,d,m,x={}){return this.style.setPaintProperty(v,d,m,x),this._update(!0)}getPaintProperty(v,d){return this.style.getPaintProperty(v,d)}setLayoutProperty(v,d,m,x={}){return this.style.setLayoutProperty(v,d,m,x),this._update(!0)}getLayoutProperty(v,d){return this.style.getLayoutProperty(v,d)}setLight(v,d={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,d),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(g.LngLat.convert(v),this.transform):0}setFeatureState(v,d){return this.style.setFeatureState(v,d),this._update()}removeFeatureState(v,d){return this.style.removeFeatureState(v,d),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,d=this._container.getBoundingClientRect().height||300;let m,x,T,E=this._container;for(;E&&(!x||!T);){const k=g.window.getComputedStyle(E).transform;k&&"none"!==k&&(m=k.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&"0"!==m[0]&&"1"!==m[0]&&(x=m[0]),m[3]&&"0"!==m[3]&&"1"!==m[3]&&(T=m[3])),E=E.parentElement}this._containerWidth=x?Math.abs(v/x):v,this._containerHeight=T?Math.abs(d/T):d}_detectMissingCSS(){"rgb(250, 128, 114)"!==g.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&g.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=Xe("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const d=this._canvasContainer=Xe("div","mapboxgl-canvas-container",v);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=Xe("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=Xe("div","mapboxgl-control-container",v),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(T=>{x[T]=Xe("div",`mapboxgl-ctrl-${T}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,d){const m=g.exported.devicePixelRatio||1;this._canvas.width=m*Math.ceil(v),this._canvas.height=m*Math.ceil(d),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${d}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const d=this._markers.indexOf(v);-1!==d&&this._markers.splice(d,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const d=this._popups.indexOf(v);-1!==d&&this._popups.splice(d,1)}_setupPainter(){const v=g.extend({},Je.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._useWebGL2&&this._canvas.getContext("webgl2",v),m=d||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);m?(this._useWebGL2&&!d&&g.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),g.storeAuthState(m,!0),this.painter=new Gc(m,this.transform,!!d),this.on("data",x=>{"source"===x.dataType&&this.painter.setTileLoadedFlag(!0)}),g.exported$1.testSupport(m)):this.fire(new g.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new g.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new g.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let d;const m=this.painter.context.extTimerQuery,x=g.exported.now();if(this.listens("gpu-timing-frame")&&(d=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,d)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],g.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],g.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,B=this.transform.pitch,G=g.exported.now(),q=new g.EvaluationParameters(O,{now:G,fadeDuration:T,pitch:B,transition:this.style.getTransition()});this.style.update(q)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(x),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(x),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new g.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new g.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),d){const O=g.exported.now()-x;m.endQueryEXT(m.TIME_ELAPSED_EXT,d),setTimeout(()=>{const B=m.getQueryObjectEXT(d,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(d),this.fire(new g.Event("gpu-timing-frame",{cpuTime:O,gpuTime:B})),g.window.performance.mark("frame-gpu",{startTime:x,detail:{gpuTime:B}})},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const B=this.painter.queryGpuTimers(O);this.fire(new g.Event("gpu-timing-layer",{layerTimes:B}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const B=this.painter.queryGpuTimeDeferredRender(O);this.fire(new g.Event("gpu-timing-deferred-render",{gpuTime:B}))},50)}const k=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(k||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(E=this._updateAverageElevation(x,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new g.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const B=this._calculateSpeedIndex();this.fire(new g.Event("speedindexcompleted",{speedIndex:B})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,g.LivePerformanceUtils.mark(g.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&g.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const d of this._markers)v&&!this.getRenderWorldCopies()&&(d._lngLat=d._lngLat.wrap()),d._update();for(const d of this._popups)!v||this.getRenderWorldCopies()||d._trackPointer||(d._lngLat=d._lngLat.wrap()),d._update()}_updateAverageElevation(v,d=!1){const m=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&m(0);if((d||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const x=this.transform.averageElevation;let T=this.transform.sampleAverageElevation(),E=!1;this.transform.elevation&&(E=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=v;const k=Math.abs(x-T);if(k>1){if(this._isInitialLoad||E)return this._averageElevation.jumpTo(T),m(T);this._averageElevation.easeTo(T,v,300)}else if(k>1e-4)return this._averageElevation.jumpTo(T),m(T)}return!!this._averageElevation.isEasing(v)&&m(this._averageElevation.getValue(v))}_authenticate(){g.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===g.AUTH_ERR_MSG||401===v.status)){const d=this.painter.context.gl;g.storeAuthState(d,!1),this._logoControl instanceof Zc&&this._logoControl._updateLogo(),d&&d.clear(d.DEPTH_BUFFER_BIT|d.COLOR_BUFFER_BIT|d.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new g.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),g.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),d=this.painter.getCanvasCopiesAndTimestamps();d.timeStamps.push(performance.now());const m=this.painter.context.gl,x=m.createFramebuffer();function T(E){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,E,0);const k=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,k),k}return m.bindFramebuffer(m.FRAMEBUFFER,x),this._canvasPixelComparison(T(v),d.canvasCopies.map(T),d.timeStamps)}_canvasPixelComparison(v,d,m){let x=m[1]-m[0];const T=v.length/4;for(let E=0;E<d.length;E++){const k=d[E];let O=0;for(let B=0;B<k.length;B+=4)k[B]===v[B]&&k[B+1]===v[B+1]&&k[B+2]===v[B+2]&&k[B+3]===v[B+3]&&(O+=1);x+=(m[E+2]-m[E+1])*(1-O/T)}return x}remove(){this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==g.window&&(g.window.removeEventListener("resize",this._onWindowResize,!1),g.window.removeEventListener("orientationchange",this._onWindowResize,!1),g.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),g.window.removeEventListener("online",this._onWindowOnline,!1),g.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),g.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new g.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=g.exported.frame(d=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(d)}))}_preloadTiles(v){const d=this.style?Object.values(this.style._sourceCaches):[];return g.asyncAll(d,(m,x)=>m._preloadTiles(v,x),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){"hidden"===g.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,d){g.setCacheLimits(v,d)}get version(){return g.version}},NavigationControl:class{constructor(v){this.options=g.extend({},Ma,v),this._container=Xe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",d=>d.preventDefault()),this.options.showZoom&&(g.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",d=>{this._map&&this._map.zoomIn({},{originalEvent:d})}),Xe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",d=>{this._map&&this._map.zoomOut({},{originalEvent:d})}),Xe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(g.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",d=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:d}):m.resetNorth({},{originalEvent:d}))}),this._compassIcon=Xe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const d=v.getZoom(),m=d===v.getMaxZoom(),x=d===v.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=d)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new t_(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,d){const m=Xe("button",v,this._container);return m.type="button",m.addEventListener("click",d),m}_setButtonTitle(v,d){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${d}`);v.setAttribute("aria-label",m),v.firstElementChild&&v.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends g.Evented{constructor(v){super(),this.options=g.extend({geolocation:g.window.navigator.geolocation},_m,v),g.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Da(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=Xe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const d=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,v(m)};void 0!==this._supportsGeolocation?v(this._supportsGeolocation):void 0!==g.window.navigator.permissions?g.window.navigator.permissions.query({name:"geolocation"}).then(m=>d("denied"!==m.state)).catch(()=>d()):d()}_isOutOfMapMaxBounds(v){const d=this._map.getMaxBounds(),m=v.coords;return!!d&&(m.longitude<d.getWest()||m.longitude>d.getEast()||m.latitude<d.getSouth()||m.latitude>d.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new g.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(v),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new g.Event("geolocate",v)),this._finish()}}_updateCamera(v){const d=new g.LngLat(v.coords.longitude,v.coords.latitude),m=v.coords.accuracy,x=this._map.getBearing(),T=g.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(m),T,{geolocateSource:!0})}_updateMarker(v){if(v){const d=new g.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,d=g.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,m=Math.ceil(2*this._accuracy*d);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(1===v.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===v.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new g.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=Xe("button","mapboxgl-ctrl-geolocate",this._container),Xe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===v){g.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Xe("div","mapboxgl-user-location"),this._dotElement.appendChild(Xe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Xe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new zp({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Xe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new zp({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||"ACTIVE_LOCK"!==this._watchState||d.originalEvent&&"resize"===d.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new g.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:!0===v.absolute&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return g.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new g.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new g.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new g.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{g.window.addEventListener("ondeviceorientationabsolute"in g.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==g.window.DeviceMotionEvent&&"function"==typeof g.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(d=>{"granted"===d&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),g.window.removeEventListener("deviceorientation",this._onDeviceOrientation),g.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Np,ScaleControl:class{constructor(v){this.options=g.extend({},n_,v),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=i_.bind(this)),g.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,d=this._map,m=d._containerHeight/2,x=d._containerWidth/2-v/2,T=d.unproject([x,m]),E=d.unproject([x+v,m]),k=T.distanceTo(E);if("imperial"===this.options.unit){const O=3.2808*k;O>5280?this._setScale(v,O/5280,"mile"):this._setScale(v,O,"foot")}else"nautical"===this.options.unit?this._setScale(v,k/1852,"nautical-mile"):k>=1e3?this._setScale(v,k/1e3,"kilometer"):this._setScale(v,k,"meter")}_setScale(v,d,m){const x=ld(d),T=x/d;this._map._requestDomTask(()=>{this._container.style.width=v*T+"px",this._container.innerHTML="nautical-mile"!==m?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:m}).format(x):`${x}&nbsp;nm`})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=Xe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof g.window.HTMLElement?this._container=v.container:g.warnOnce("Full screen control 'container' must be a DOM element.")),g.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in g.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in g.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=Xe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",g.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,g.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!g.window.document.fullscreenEnabled&&!g.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=Xe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Xe("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),g.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(g.window.document.fullscreenElement||g.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?g.window.document.exitFullscreen?g.window.document.exitFullscreen():g.window.document.webkitCancelFullScreen&&g.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends g.Evented{constructor(v){super(),this.options=g.extend(Object.create(Qy),v),g.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new g.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new g.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=g.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const d=this._map;return d&&(d.on("move",this._update),d.off("mousemove",this._onMouseEvent),d._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(g.window.document.createTextNode(v))}setHTML(v){const d=g.window.document.createDocumentFragment(),m=g.window.document.createElement("body");let x;for(m.innerHTML=v;x=m.firstChild,x;)d.appendChild(x);return this.setDOMContent(d)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let d=this._content;if(d)for(;d.hasChildNodes();)d.firstChild&&d.removeChild(d.firstChild);else d=this._content=Xe("div","mapboxgl-popup-content",this._container||void 0);if(d.appendChild(v),this.options.closeButton){const m=this._closeButton=Xe("button","mapboxgl-popup-close-button",d);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let d;return this._classList.delete(v)?d=!1:(this._classList.add(v),d=!0),this._updateClassList(),d}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const d=this._map,m=this._container,x=this._pos;if(!d||!m||!x)return"bottom";const T=m.offsetWidth,E=m.offsetHeight,k=x.x<T/2,O=x.x>d.transform.width-T/2;if(x.y+v<E)return k?"top-left":O?"top-right":"top";if(x.y>d.transform.height-E){if(k)return"bottom-left";if(O)return"bottom-right"}return k?"left":O?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const d=[...this._classList];d.push("mapboxgl-popup"),this._anchor&&d.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&d.push("mapboxgl-popup-track-pointer"),v.className=d.join(" ")}_update(v){const d=this._map,m=this._content;if(!d||!this._lngLat&&!this._trackPointer||!m)return;let x=this._container;if(x||(x=this._container=Xe("div","mapboxgl-popup",d.getContainer()),this._tip=Xe("div","mapboxgl-popup-tip",x),x.appendChild(m)),this.options.maxWidth&&x.style.maxWidth!==this.options.maxWidth&&(x.style.maxWidth=this.options.maxWidth),d.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ad(this._lngLat,this._pos,d.transform)),!this._trackPointer||v){const T=this._pos=this._trackPointer&&v?v:d.project(this._lngLat),E=Zr(this.options.offset),k=this._anchor=this._getAnchor(E.y),O=Zr(this.options.offset,k),B=T.add(O).round();d._requestDomTask(()=>{this._container&&k&&(this._container.style.transform=`${ic[k]} translate(${B.x}px,${B.y}px)`)})}if(!this._marker&&d._showingGlobe()){const T=g.isLngLatBehindGlobe(d.transform,this._lngLat)?0:1;this._setOpacity(T)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(mm);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:zp,Style:gs,LngLat:g.LngLat,LngLatBounds:g.LngLatBounds,Point:g.pointGeometry,MercatorCoordinate:g.MercatorCoordinate,FreeCameraOptions:rm,Evented:g.Evented,config:g.config,prewarm:function(){$n().acquire(Mn)},clearPrewarmedResources:function(){const v=An;v&&(v.isPreloaded()&&1===v.numActive()?(v.release(Mn),An=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return g.config.ACCESS_TOKEN},set accessToken(v){g.config.ACCESS_TOKEN=v},get baseApiUrl(){return g.config.API_URL},set baseApiUrl(v){g.config.API_URL=v},get workerCount(){return mn.workerCount},set workerCount(v){mn.workerCount=v},get maxParallelImageRequests(){return g.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){g.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){g.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:g.exported.setNow,restoreNow:g.exported.restoreNow};return Xc}),vt}()},775:function(an){var vt;vt=function(){var rn="",pt=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function vt(Je){return Je.match(pt)||[]}function Ge(Je){return{language:(Je=vt(Je))[1]||rn,extlang:Je[2]||rn,script:Je[3]||rn,region:Je[4]||rn}}function g(Je,Ke,Ve){Object.defineProperty(Je,Ke,{value:Ve,enumerable:!0})}function se(Je,Ke,Ve){function Xe(Bt){return vt(Bt)[Je]||rn}g(Xe,"pattern",Ke),g(Ge,Ve,Xe)}return se(1,/^[a-zA-Z]{2,3}$/,"language"),se(2,/^[a-zA-Z]{3}$/,"extlang"),se(3,/^[a-zA-Z]{4}$/,"script"),se(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),g(Ge,"split",function _t(Je){return vt(Je).filter(function(Ke,Ve){return Ke&&Ve})}),Ge},an.exports?an.exports=vt():this.subtag=vt()},562:(an,rn,pt)=>{"use strict";var vt=pt(576);an.exports=vt,typeof window<"u"&&(window.Suggestions=vt)},554:an=>{"use strict";var rn=function(pt){return this.component=pt,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,pt.el.parentNode.insertBefore(this.wrapper,pt.el.nextSibling),this};rn.prototype.show=function(){this.element.style.display="block"},rn.prototype.hide=function(){this.element.style.display="none"},rn.prototype.add=function(pt){this.items.push(pt)},rn.prototype.clear=function(){this.items=[],this.active=0},rn.prototype.isEmpty=function(){return!this.items.length},rn.prototype.isVisible=function(){return"block"===this.element.style.display},rn.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var pt=0;pt<this.items.length;pt++)this.drawItem(this.items[pt],this.active===pt);this.show()}else this.hide()},rn.prototype.drawItem=function(pt,vt){var _t=document.createElement("li"),Ge=document.createElement("a");vt&&(_t.className+=" active"),Ge.innerHTML=pt.string,_t.appendChild(Ge),this.element.appendChild(_t),_t.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),_t.addEventListener("mouseup",function(){this.handleMouseUp.call(this,pt)}.bind(this))},rn.prototype.handleMouseUp=function(pt){this.selectingListItem=!1,this.component.value(pt.original),this.clear(),this.draw()},rn.prototype.move=function(pt){this.active=pt,this.draw()},rn.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},rn.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},rn.prototype.drawError=function(pt){var vt=document.createElement("li");vt.innerHTML=pt,this.element.appendChild(vt),this.show()},an.exports=rn},576:(an,rn,pt)=>{"use strict";var vt=pt(703),_t=pt(780),Ge=pt(554),g=function(se,Je,Ke){return this.options=vt({minLength:2,limit:5,filter:!0,hideOnBlur:!0},Ke=Ke||{}),this.el=se,this.data=Je||[],this.list=new Ge(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(Ve){this.handleKeyUp(Ve.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(Ve){this.handleKeyDown(Ve)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(Ve){this.handlePaste(Ve)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};g.prototype.handleKeyUp=function(se){40===se||38===se||27===se||13===se||9===se||this.handleInputChange(this.el.value)},g.prototype.handleKeyDown=function(se){switch(se.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&se.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},g.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},g.prototype.handlePaste=function(se){if(se.clipboardData)this.handleInputChange(se.clipboardData.getData("Text"));else{var Je=this;setTimeout(function(){Je.handleInputChange(se.target.value)},100)}},g.prototype.handleInputChange=function(se){this.query=this.normalize(se),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates(function(Je){for(var Ke=0;Ke<Je.length&&(this.list.add(Je[Ke]),Ke!==this.options.limit-1);Ke++);this.list.draw()}.bind(this))},g.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},g.prototype.update=function(se){this.data=se,this.handleKeyUp()},g.prototype.clear=function(){this.data=[],this.list.clear()},g.prototype.normalize=function(se){return se.toLowerCase()},g.prototype.match=function(se,Je){return se.indexOf(Je)>-1},g.prototype.value=function(se){if(this.selected=se,this.el.value=this.getItemValue(se),document.createEvent){var Je=document.createEvent("HTMLEvents");Je.initEvent("change",!0,!1),this.el.dispatchEvent(Je)}else this.el.fireEvent("onchange")},g.prototype.getCandidates=function(se){var Je={pre:"<strong>",post:"</strong>",extract:function(Ve){return this.getItemValue(Ve)}.bind(this)};se(this.options.filter?_t.filter(this.query,this.data,Je).map(function(Ve){return{original:Ve.original,string:this.render(Ve.original,Ve.string)}}.bind(this)):this.data.map(function(Ve){return{original:Ve,string:this.render(Ve)}}.bind(this)))},g.prototype.getItemValue=function(se){return se},g.prototype.render=function(se,Je){if(Je)return Je;for(var Ke=this.getItemValue(se.original?se.original:se),Ve=this.normalize(Ke),Xe=Ve.lastIndexOf(this.query);Xe>-1;){var Bt=Xe+this.query.length;Ke=Ke.slice(0,Xe)+"<strong>"+Ke.slice(Xe,Bt)+"</strong>"+Ke.slice(Bt),Xe=Ve.slice(0,Xe).lastIndexOf(this.query)}return Ke},g.prototype.renderError=function(se){this.list.drawError(se)},an.exports=g},703:an=>{an.exports=function pt(){for(var vt={},_t=0;_t<arguments.length;_t++){var Ge=arguments[_t];for(var g in Ge)rn.call(Ge,g)&&(vt[g]=Ge[g])}return vt};var rn=Object.prototype.hasOwnProperty},652:(an,rn,pt)=>{"use strict";pt.d(rn,{x0:()=>g});let g=(se=21)=>crypto.getRandomValues(new Uint8Array(se)).reduce((Je,Ke)=>Je+((Ke&=63)<36?Ke.toString(36):Ke<62?(Ke-26).toString(36).toUpperCase():Ke>62?"-":"_"),"")}},an=>{an(an.s=726)}]);